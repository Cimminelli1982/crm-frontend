/*! For license information please see main.b48588c5.js.LICENSE.txt */
(()=>{var e={162:function(e,t,o){"use strict";var n=this&&this.__assign||function(){return n=Object.assign||function(e){for(var t,o=1,n=arguments.length;o<n;o++)for(var r in t=arguments[o])Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e},n.apply(this,arguments)},r=this&&this.__createBinding||(Object.create?function(e,t,o,n){void 0===n&&(n=o),Object.defineProperty(e,n,{enumerable:!0,get:function(){return t[o]}})}:function(e,t,o,n){void 0===n&&(n=o),e[n]=t[o]}),i=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),a=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var o in e)"default"!==o&&Object.prototype.hasOwnProperty.call(e,o)&&r(t,e,o);return i(t,e),t},s=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.CellCompState=void 0;var l=o(7079),c=a(o(5043)),d=o(8242),u=s(o(1853)),p=s(o(2168)),h=o(9201),f=o(3183),g=o(9724);!function(e){e[e.ShowValue=0]="ShowValue",e[e.EditValue=1]="EditValue"}(t.CellCompState||(t.CellCompState={}));t.default=c.memo((function(e){var t=c.useContext(h.BeansContext).context,o=e.cellCtrl,r=e.printLayout,i=e.editingRow,a=c.useState(),s=a[0],m=a[1],y=c.useState(),v=y[0],b=y[1],x=c.useState(1),w=x[0],C=x[1],_=c.useState(),S=_[0],E=_[1],k=c.useState(),j=k[0],A=k[1],R=c.useState(),O=R[0],T=R[1],D=c.useState(),P=D[0],N=D[1],I=c.useState(),M=I[0],L=I[1],F=c.useState(!1),G=F[0],z=F[1],H=c.useState(!1),B=H[0],V=H[1],$=c.useState(!1),U=$[0],W=$[1],q=c.useState(),K=q[0],Y=q[1],J=c.useMemo((function(){return o.isForceWrapper()}),[]),X=c.useRef(null),Q=c.useRef(null),Z=c.useRef(),ee=c.useRef(),te=c.useRef(),oe=c.useState(0),ne=oe[0],re=oe[1],ie=c.useCallback((function(e){te.current=e,re((function(e){return e+1}))}),[]),ae=c.useRef(),se=c.useState(0),le=se[0],ce=se[1],de=c.useCallback((function(e){ae.current=e,ce((function(e){return e+1}))}),[]),ue=J||null!=s&&(G||U||B),pe=c.useCallback((function(e,t){(ee.current=t,t)&&(!function(e,t,o){var n=o.getColumn();if(!e&&t.isPopup&&t.isPopup()){var r="AG Grid: Found an issue in column "+n.getColId()+". If using React, specify an editor is a popup using colDef.cellEditorPopup=true. AG Grid React cannot depend on the editor component specifying if it's in a popup (via the isPopup() method on the editor), as React needs to know this information BEFORE the component is created.";l._.doOnce((function(){return console.warn(r)}),"jsEditorComp-isPopup-"+o.getColumn().getColId())}if(e&&t.getPopupPosition&&null!=t.getPopupPosition()){var i="AG Grid: Found an issue in column "+n.getColId()+". If using React, specify an editor popup position using colDef.cellEditorPopupPosition=true. AG Grid React cannot depend on the editor component specifying it's position (via the getPopupPosition() method on the editor), as React needs to know this information BEFORE the component is created.";l._.doOnce((function(){return console.warn(i)}),"jsEditorComp-getPopupPosition-"+o.getColumn().getColId())}}(e,t,o),t.isCancelBeforeStart&&t.isCancelBeforeStart()&&setTimeout((function(){o.stopEditing(!0),o.focusCell(!0)})))}),[]),he=c.useCallback((function(e){return pe(!0,e)}),[]),fe=c.useCallback((function(e){return pe(!1,e)}),[]),ge=c.useMemo((function(){return new l.CssClassManager((function(){return X.current}))}),[]);p.default(s,ue,ae.current,le,Z,X);var me=c.useRef();c.useLayoutEffect((function(){var e=me.current,t=s;if(me.current=s,null!=e&&null!=e.compDetails&&null!=t&&null!=t.compDetails){var o=e.compDetails,n=t.compDetails;if(o.componentClass==n.componentClass)if(null!=Q.current&&null!=Q.current.refresh)1!=Q.current.refresh(n.params)&&C((function(e){return e+1}))}}),[s]),c.useLayoutEffect((function(){if(v&&!v.compDetails.componentFromFramework){var e=v.compDetails,o=!0===v.popup,n=f.createSyncJsComp(e);if(n){var r=n.getGui();if(pe(o,n),!o){var i=(J?te:X).current;null===i||void 0===i||i.appendChild(r),n.afterGuiAttached&&n.afterGuiAttached()}return Y(n),function(){t.destroyBean(n),pe(o,void 0),Y(void 0),r&&r.parentElement&&r.parentElement.removeChild(r)}}}}),[v]),c.useLayoutEffect((function(){if(o&&t&&te.current&&ue){var e=[],n=function(o){if(o){var n=o.getGui();te.current.insertAdjacentElement("afterbegin",n),e.push((function(){t.destroyBean(o),l._.removeFromParent(n)}))}return o};if(G)n(o.createSelectionCheckbox());return U&&n(o.createDndSource()),B&&n(o.createRowDragComp()),function(){return e.forEach((function(e){return e()}))}}}),[ue,U,B,G,ne]),g.useLayoutEffectOnce((function(){if(o){var e={addOrRemoveCssClass:function(e,t){return ge.addOrRemoveCssClass(e,t)},setUserStyles:function(e){return E(e)},getFocusableElement:function(){return X.current},setTabIndex:function(e){return A(e)},setRole:function(e){return T(e)},setColId:function(e){return N(e)},setTitle:function(e){return L(e)},setIncludeSelection:function(e){return z(e)},setIncludeRowDrag:function(e){return V(e)},setIncludeDndSource:function(e){return W(e)},getCellEditor:function(){return ee.current||null},getCellRenderer:function(){return Q.current?Q.current:Z.current},getParentOfValue:function(){return ae.current?ae.current:te.current?te.current:X.current},setRenderDetails:function(e,t,o){m({value:t,compDetails:e,force:o})},setEditDetails:function(e,t,o){e?(b({compDetails:e,popup:t,popupPosition:o}),t||m(void 0)):b(void 0)}},t=te.current||void 0;o.setComp(e,X.current,t,r,i)}}));var ye=c.useMemo((function(){return!!(s&&s.compDetails&&s.compDetails.componentFromFramework&&d.isComponentStateless(s.compDetails.componentClass))}),[s]);c.useEffect((function(){var e;X.current&&(ge.addOrRemoveCssClass("ag-cell-value",!ue),ge.addOrRemoveCssClass("ag-cell-inline-editing",!!v&&!v.popup),ge.addOrRemoveCssClass("ag-cell-popup-editing",!!v&&!!v.popup),ge.addOrRemoveCssClass("ag-cell-not-inline-editing",!v||!!v.popup),null===(e=o.getRowCtrl())||void 0===e||e.setInlineEditingCss(!!v))}));var ve=c.useMemo((function(){return o.getInstanceId()}),[]),be=function(){return c.default.createElement(c.default.Fragment,null,null!=s&&function(e,t,o,r,i,a,s){var l=e.compDetails,d=e.value,u=!l,p=l&&l.componentFromFramework,h=l&&l.componentClass,f=(null===d||void 0===d?void 0:d.toString)?d.toString():d,g=function(){return c.default.createElement(c.default.Fragment,null,u&&c.default.createElement(c.default.Fragment,null,f),p&&!a&&c.default.createElement(h,n({},l.params,{key:t,ref:r})),p&&a&&c.default.createElement(h,n({},l.params,{key:t})))};return c.default.createElement(c.default.Fragment,null,i?c.default.createElement("span",{role:"presentation",id:"cell-"+o,className:"ag-cell-value",ref:s},g()):g())}(s,w,ve,Q,ue,ye,de),null!=v&&function(e,t,o,r,i,a){var s=e.compDetails,l=s.componentClass,d=s.componentFromFramework&&!e.popup,p=s.componentFromFramework&&e.popup,h=!s.componentFromFramework&&e.popup;return c.default.createElement(c.default.Fragment,null,d&&c.default.createElement(l,n({},e.compDetails.params,{ref:t})),p&&c.default.createElement(u.default,{editDetails:e,cellCtrl:i,eParentCell:r,wrappedContent:c.default.createElement(l,n({},e.compDetails.params,{ref:o}))}),h&&a&&c.default.createElement(u.default,{editDetails:e,cellCtrl:i,eParentCell:r,jsChildComp:a}))}(v,fe,he,X.current,o,K))};return c.default.createElement("div",{ref:X,style:S,tabIndex:j,role:O,"col-id":P,title:M},ue?c.default.createElement("div",{className:"ag-cell-wrapper",role:"presentation",ref:ie},be()):be())}))},219:(e,t,o)=>{"use strict";var n=o(3763),r={childContextTypes:!0,contextType:!0,contextTypes:!0,defaultProps:!0,displayName:!0,getDefaultProps:!0,getDerivedStateFromError:!0,getDerivedStateFromProps:!0,mixins:!0,propTypes:!0,type:!0},i={name:!0,length:!0,prototype:!0,caller:!0,callee:!0,arguments:!0,arity:!0},a={$$typeof:!0,compare:!0,defaultProps:!0,displayName:!0,propTypes:!0,type:!0},s={};function l(e){return n.isMemo(e)?a:s[e.$$typeof]||r}s[n.ForwardRef]={$$typeof:!0,render:!0,defaultProps:!0,displayName:!0,propTypes:!0},s[n.Memo]=a;var c=Object.defineProperty,d=Object.getOwnPropertyNames,u=Object.getOwnPropertySymbols,p=Object.getOwnPropertyDescriptor,h=Object.getPrototypeOf,f=Object.prototype;e.exports=function e(t,o,n){if("string"!==typeof o){if(f){var r=h(o);r&&r!==f&&e(t,r,n)}var a=d(o);u&&(a=a.concat(u(o)));for(var s=l(t),g=l(o),m=0;m<a.length;++m){var y=a[m];if(!i[y]&&(!n||!n[y])&&(!g||!g[y])&&(!s||!s[y])){var v=p(o,y);try{c(t,y,v)}catch(b){}}}}return t}},296:function(e,t,o){"use strict";var n=this&&this.__createBinding||(Object.create?function(e,t,o,n){void 0===n&&(n=o),Object.defineProperty(e,n,{enumerable:!0,get:function(){return t[o]}})}:function(e,t,o,n){void 0===n&&(n=o),e[n]=t[o]}),r=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),i=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var o in e)"default"!==o&&Object.prototype.hasOwnProperty.call(e,o)&&n(t,e,o);return r(t,e),t},a=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var s=o(7079),l=i(o(5043)),c=o(9201),d=a(o(1564)),u=a(o(7355)),p=a(o(2908)),h=o(9724),f=o(8242);t.default=l.memo((function(e){var t=e.context,o=l.useState(""),n=o[0],r=o[1],i=l.useState(""),a=i[0],g=i[1],m=l.useState(""),y=m[0],v=m[1],b=l.useState(null),x=b[0],w=b[1],C=l.useState(null),_=C[0],S=C[1],E=l.useState(!1),k=E[0],j=E[1],A=l.useState(),R=A[0],O=A[1],T=l.useRef(null),D=l.useRef(null),P=l.useRef(),N=l.useRef(null),I=l.useRef((function(){})),M=l.useCallback((function(){}),[]),L=l.useMemo((function(){return t.getBean("beans")}),[]);u.default(" AG Grid ",D),h.useLayoutEffectOnce((function(){var e=T.current=t.createBean(new s.GridCtrl);return function(){t.destroyBean(e),T.current=null}})),h.useLayoutEffectOnce((function(){var e=T.current;I.current=e.focusInnerElement.bind(e);var t={destroyGridUi:function(){},setRtlClass:r,addOrRemoveKeyboardFocusClass:function(e){return g(e?s.FocusService.AG_KEYBOARD_FOCUS:"")},forceFocusOutOfContainer:function(){P.current.forceFocusOutOfContainer()},updateLayoutClasses:v,getFocusableContainers:function(){var e=[],t=D.current.querySelector(".ag-root"),o=D.current.querySelector(".ag-side-bar:not(.ag-hidden)");return t&&e.push(t),o&&e.push(o),e},setCursor:w,setUserSelect:S};e.setComp(t,D.current,D.current),j(!0)})),l.useEffect((function(){if(R){var e=T.current,o=[],n=L.agStackComponentsRegistry,r=n.getComponentClass("AG-GRID-HEADER-DROP-ZONES"),i=n.getComponentClass("AG-SIDE-BAR"),a=n.getComponentClass("AG-STATUS-BAR"),s=n.getComponentClass("AG-WATERMARK"),l=n.getComponentClass("AG-PAGINATION"),c=[],d=D.current,u=N.current;if(e.showDropZones()&&r){var p=t.createBean(new r),h=p.getGui();d.insertAdjacentElement("afterbegin",h),c.push(h),o.push(p)}if(e.showSideBar()&&i){var f=t.createBean(new i),g=(h=f.getGui(),u.querySelector(".ag-tab-guard-bottom"));g&&(g.insertAdjacentElement("beforebegin",h),c.push(h)),o.push(f)}if(e.showStatusBar()&&a){var m=t.createBean(new a);h=m.getGui();d.insertAdjacentElement("beforeend",h),c.push(h),o.push(m)}if(l){var y=t.createBean(new l);h=y.getGui();d.insertAdjacentElement("beforeend",h),c.push(h),o.push(y)}if(e.showWatermark()&&s){var v=t.createBean(new s);h=v.getGui();d.insertAdjacentElement("beforeend",h),c.push(h),o.push(v)}return function(){t.destroyBeans(o),c.forEach((function(e){e.parentElement&&e.parentElement.removeChild(e)}))}}}),[R]);var F=l.useMemo((function(){return f.classesList("ag-root-wrapper",n,a,y)}),[n,a,y]),G=l.useMemo((function(){return f.classesList("ag-root-wrapper-body","ag-focus-managed",y)}),[y]),z=l.useMemo((function(){return{userSelect:null!=_?_:"",WebkitUserSelect:null!=_?_:"",cursor:null!=x?x:""}}),[_,x]),H=N.current,B=l.useCallback((function(e){P.current=e,O(!0)}),[]);return l.default.createElement("div",{ref:D,className:F,style:z,role:"presentation"},l.default.createElement("div",{className:G,ref:N,role:"presentation"},k&&H&&l.default.createElement(c.BeansContext.Provider,{value:L},l.default.createElement(p.default,{ref:B,eFocusableElement:H,onTabKeyDown:M,gridCtrl:T.current},l.default.createElement(d.default,null)))))}))},400:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.version=void 0,t.version="0.0.0-automated"},446:function(e){e.exports=function(){"use strict";var e=1e3,t=6e4,o=36e5,n="millisecond",r="second",i="minute",a="hour",s="day",l="week",c="month",d="quarter",u="year",p="date",h="Invalid Date",f=/^(\d{4})[-/]?(\d{1,2})?[-/]?(\d{0,2})[Tt\s]*(\d{1,2})?:?(\d{1,2})?:?(\d{1,2})?[.:]?(\d+)?$/,g=/\[([^\]]+)]|Y{1,4}|M{1,4}|D{1,2}|d{1,4}|H{1,2}|h{1,2}|a|A|m{1,2}|s{1,2}|Z{1,2}|SSS/g,m={name:"en",weekdays:"Sunday_Monday_Tuesday_Wednesday_Thursday_Friday_Saturday".split("_"),months:"January_February_March_April_May_June_July_August_September_October_November_December".split("_"),ordinal:function(e){var t=["th","st","nd","rd"],o=e%100;return"["+e+(t[(o-20)%10]||t[o]||t[0])+"]"}},y=function(e,t,o){var n=String(e);return!n||n.length>=t?e:""+Array(t+1-n.length).join(o)+e},v={s:y,z:function(e){var t=-e.utcOffset(),o=Math.abs(t),n=Math.floor(o/60),r=o%60;return(t<=0?"+":"-")+y(n,2,"0")+":"+y(r,2,"0")},m:function e(t,o){if(t.date()<o.date())return-e(o,t);var n=12*(o.year()-t.year())+(o.month()-t.month()),r=t.clone().add(n,c),i=o-r<0,a=t.clone().add(n+(i?-1:1),c);return+(-(n+(o-r)/(i?r-a:a-r))||0)},a:function(e){return e<0?Math.ceil(e)||0:Math.floor(e)},p:function(e){return{M:c,y:u,w:l,d:s,D:p,h:a,m:i,s:r,ms:n,Q:d}[e]||String(e||"").toLowerCase().replace(/s$/,"")},u:function(e){return void 0===e}},b="en",x={};x[b]=m;var w="$isDayjsObject",C=function(e){return e instanceof k||!(!e||!e[w])},_=function e(t,o,n){var r;if(!t)return b;if("string"==typeof t){var i=t.toLowerCase();x[i]&&(r=i),o&&(x[i]=o,r=i);var a=t.split("-");if(!r&&a.length>1)return e(a[0])}else{var s=t.name;x[s]=t,r=s}return!n&&r&&(b=r),r||!n&&b},S=function(e,t){if(C(e))return e.clone();var o="object"==typeof t?t:{};return o.date=e,o.args=arguments,new k(o)},E=v;E.l=_,E.i=C,E.w=function(e,t){return S(e,{locale:t.$L,utc:t.$u,x:t.$x,$offset:t.$offset})};var k=function(){function m(e){this.$L=_(e.locale,null,!0),this.parse(e),this.$x=this.$x||e.x||{},this[w]=!0}var y=m.prototype;return y.parse=function(e){this.$d=function(e){var t=e.date,o=e.utc;if(null===t)return new Date(NaN);if(E.u(t))return new Date;if(t instanceof Date)return new Date(t);if("string"==typeof t&&!/Z$/i.test(t)){var n=t.match(f);if(n){var r=n[2]-1||0,i=(n[7]||"0").substring(0,3);return o?new Date(Date.UTC(n[1],r,n[3]||1,n[4]||0,n[5]||0,n[6]||0,i)):new Date(n[1],r,n[3]||1,n[4]||0,n[5]||0,n[6]||0,i)}}return new Date(t)}(e),this.init()},y.init=function(){var e=this.$d;this.$y=e.getFullYear(),this.$M=e.getMonth(),this.$D=e.getDate(),this.$W=e.getDay(),this.$H=e.getHours(),this.$m=e.getMinutes(),this.$s=e.getSeconds(),this.$ms=e.getMilliseconds()},y.$utils=function(){return E},y.isValid=function(){return!(this.$d.toString()===h)},y.isSame=function(e,t){var o=S(e);return this.startOf(t)<=o&&o<=this.endOf(t)},y.isAfter=function(e,t){return S(e)<this.startOf(t)},y.isBefore=function(e,t){return this.endOf(t)<S(e)},y.$g=function(e,t,o){return E.u(e)?this[t]:this.set(o,e)},y.unix=function(){return Math.floor(this.valueOf()/1e3)},y.valueOf=function(){return this.$d.getTime()},y.startOf=function(e,t){var o=this,n=!!E.u(t)||t,d=E.p(e),h=function(e,t){var r=E.w(o.$u?Date.UTC(o.$y,t,e):new Date(o.$y,t,e),o);return n?r:r.endOf(s)},f=function(e,t){return E.w(o.toDate()[e].apply(o.toDate("s"),(n?[0,0,0,0]:[23,59,59,999]).slice(t)),o)},g=this.$W,m=this.$M,y=this.$D,v="set"+(this.$u?"UTC":"");switch(d){case u:return n?h(1,0):h(31,11);case c:return n?h(1,m):h(0,m+1);case l:var b=this.$locale().weekStart||0,x=(g<b?g+7:g)-b;return h(n?y-x:y+(6-x),m);case s:case p:return f(v+"Hours",0);case a:return f(v+"Minutes",1);case i:return f(v+"Seconds",2);case r:return f(v+"Milliseconds",3);default:return this.clone()}},y.endOf=function(e){return this.startOf(e,!1)},y.$set=function(e,t){var o,l=E.p(e),d="set"+(this.$u?"UTC":""),h=(o={},o[s]=d+"Date",o[p]=d+"Date",o[c]=d+"Month",o[u]=d+"FullYear",o[a]=d+"Hours",o[i]=d+"Minutes",o[r]=d+"Seconds",o[n]=d+"Milliseconds",o)[l],f=l===s?this.$D+(t-this.$W):t;if(l===c||l===u){var g=this.clone().set(p,1);g.$d[h](f),g.init(),this.$d=g.set(p,Math.min(this.$D,g.daysInMonth())).$d}else h&&this.$d[h](f);return this.init(),this},y.set=function(e,t){return this.clone().$set(e,t)},y.get=function(e){return this[E.p(e)]()},y.add=function(n,d){var p,h=this;n=Number(n);var f=E.p(d),g=function(e){var t=S(h);return E.w(t.date(t.date()+Math.round(e*n)),h)};if(f===c)return this.set(c,this.$M+n);if(f===u)return this.set(u,this.$y+n);if(f===s)return g(1);if(f===l)return g(7);var m=(p={},p[i]=t,p[a]=o,p[r]=e,p)[f]||1,y=this.$d.getTime()+n*m;return E.w(y,this)},y.subtract=function(e,t){return this.add(-1*e,t)},y.format=function(e){var t=this,o=this.$locale();if(!this.isValid())return o.invalidDate||h;var n=e||"YYYY-MM-DDTHH:mm:ssZ",r=E.z(this),i=this.$H,a=this.$m,s=this.$M,l=o.weekdays,c=o.months,d=o.meridiem,u=function(e,o,r,i){return e&&(e[o]||e(t,n))||r[o].slice(0,i)},p=function(e){return E.s(i%12||12,e,"0")},f=d||function(e,t,o){var n=e<12?"AM":"PM";return o?n.toLowerCase():n};return n.replace(g,(function(e,n){return n||function(e){switch(e){case"YY":return String(t.$y).slice(-2);case"YYYY":return E.s(t.$y,4,"0");case"M":return s+1;case"MM":return E.s(s+1,2,"0");case"MMM":return u(o.monthsShort,s,c,3);case"MMMM":return u(c,s);case"D":return t.$D;case"DD":return E.s(t.$D,2,"0");case"d":return String(t.$W);case"dd":return u(o.weekdaysMin,t.$W,l,2);case"ddd":return u(o.weekdaysShort,t.$W,l,3);case"dddd":return l[t.$W];case"H":return String(i);case"HH":return E.s(i,2,"0");case"h":return p(1);case"hh":return p(2);case"a":return f(i,a,!0);case"A":return f(i,a,!1);case"m":return String(a);case"mm":return E.s(a,2,"0");case"s":return String(t.$s);case"ss":return E.s(t.$s,2,"0");case"SSS":return E.s(t.$ms,3,"0");case"Z":return r}return null}(e)||r.replace(":","")}))},y.utcOffset=function(){return 15*-Math.round(this.$d.getTimezoneOffset()/15)},y.diff=function(n,p,h){var f,g=this,m=E.p(p),y=S(n),v=(y.utcOffset()-this.utcOffset())*t,b=this-y,x=function(){return E.m(g,y)};switch(m){case u:f=x()/12;break;case c:f=x();break;case d:f=x()/3;break;case l:f=(b-v)/6048e5;break;case s:f=(b-v)/864e5;break;case a:f=b/o;break;case i:f=b/t;break;case r:f=b/e;break;default:f=b}return h?f:E.a(f)},y.daysInMonth=function(){return this.endOf(c).$D},y.$locale=function(){return x[this.$L]},y.locale=function(e,t){if(!e)return this.$L;var o=this.clone(),n=_(e,t,!0);return n&&(o.$L=n),o},y.clone=function(){return E.w(this.$d,this)},y.toDate=function(){return new Date(this.valueOf())},y.toJSON=function(){return this.isValid()?this.toISOString():null},y.toISOString=function(){return this.$d.toISOString()},y.toString=function(){return this.$d.toUTCString()},m}(),j=k.prototype;return S.prototype=j,[["$ms",n],["$s",r],["$m",i],["$H",a],["$W",s],["$M",c],["$y",u],["$D",p]].forEach((function(e){j[e[1]]=function(t){return this.$g(t,e[0],e[1])}})),S.extend=function(e,t){return e.$i||(e(t,k,S),e.$i=!0),S},S.locale=_,S.isDayjs=C,S.unix=function(e){return S(1e3*e)},S.en=x[b],S.Ls=x,S.p={},S}()},478:(e,t,o)=>{"use strict";o.d(t,{A:()=>S});var n=o(5043),r=o(2963),i=o.n(r),a=o(1009),s=o(5315),l=o(1529),c=o(579);const d=l.Ay.div`
  display: flex;
  justify-content: space-between;
  align-items: center;
  margin-bottom: 15px;
  padding-bottom: 15px;
  border-bottom: 1px solid #333;

  h2 {
    margin: 0;
    font-size: 1.25rem;
    color: #00ff00;
    font-weight: 600;
  }

  button {
    background: none;
    border: none;
    cursor: pointer;
    color: #ffffff;
    padding: 4px;
    border-radius: 4px;
    
    &:hover {
      color: #ff5555;
    }
  }
`,u=l.Ay.div`
  margin-bottom: 15px;
`,p=l.Ay.h3`
  font-size: 16px;
  font-weight: bold;
  color: #00ff00;
  margin-bottom: 12px;
  display: flex;
  align-items: center;
  gap: 8px;
`,h=l.Ay.div`
  display: flex;
  flex-wrap: wrap;
  gap: 8px;
  margin-bottom: 16px;
  padding: 5px 0;
  min-height: 32px;
`,f=l.Ay.div`
  display: inline-flex;
  align-items: center;
  padding: 4px 8px;
  font-size: 0.75rem;
  border-radius: 4px;
  background-color: #222;
  color: #00ff00;
  font-weight: 500;
  margin-right: 0.25rem;
  margin-bottom: 0.25rem;
  border: 1px solid #00ff00;
  gap: 6px;
  max-width: 200px;

  span {
    white-space: nowrap;
    overflow: hidden;
    text-overflow: ellipsis;
    max-width: 150px;
  }

  button {
    background: none;
    border: none;
    padding: 0;
    display: inline-flex;
    align-items: center;
    justify-content: center;
    margin-left: 0.25rem;
    color: #00ff00;
    cursor: pointer;
    
    &:hover { 
      color: #ff5555; 
    }
  }
`,g=l.Ay.div`
  position: relative;
  margin-bottom: 16px;
  width: 90%;
`,m=l.Ay.input`
  width: 100%;
  padding: 10px;
  padding-left: 36px;
  border: 1px solid #444;
  border-radius: 4px;
  font-size: 14px;
  color: #eee;
  background-color: #222;
  transition: all 0.2s;

  &:focus {
    outline: none;
    border-color: #00ff00;
  }

  &:hover {
    background-color: #333;
  }
`,y=l.Ay.div`
  position: absolute;
  left: 12px;
  top: 50%;
  transform: translateY(-50%);
  color: #999;
`,v=l.Ay.div`
  margin-top: 8px;
  border: 1px solid #444;
  border-radius: 4px;
  max-height: 200px;
  overflow-y: auto;
  background-color: #222;
`,b=l.Ay.button`
  width: 100%;
  text-align: left;
  padding: 8px 12px;
  background: none;
  border: none;
  border-bottom: 1px solid #333;
  cursor: pointer;
  font-size: 0.875rem;
  color: #eee;
  transition: background-color 0.2s;
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;

  &:last-child {
    border-bottom: none;
  }

  &:hover {
    background-color: #333;
    color: #00ff00;
  }
`,x=l.Ay.button`
  display: inline-flex;
  align-items: center;
  gap: 6px;
  padding: 8px 16px;
  background-color: #333;
  color: #00ff00;
  border: none;
  border-radius: 4px;
  font-size: 0.875rem;
  cursor: pointer;
  transition: all 0.2s;
  width: 100%;
  text-align: left;

  &:hover {
    background-color: #444;
  }

  &:disabled {
    opacity: 0.5;
    cursor: not-allowed;
  }
`,w=l.Ay.div`
  padding: 8px 12px;
  border-radius: 4px;
  font-size: 12px;
  margin-top: 12px;
  
  &.success {
    background-color: rgba(0, 255, 0, 0.1);
    color: #00ff00;
  }
  
  &.error {
    background-color: rgba(255, 70, 70, 0.2);
    color: #ff9999;
  }
`,C=l.Ay.div`
  display: flex;
  justify-content: flex-end;
  gap: 10px;
  margin-top: 15px;
`,_=l.Ay.button`
  padding: 8px 16px;
  border-radius: 4px;
  font-size: 0.875rem;
  font-weight: 500;
  cursor: pointer;
  transition: all 0.2s;
  display: flex;
  align-items: center;
  gap: 8px;
  
  &.primary {
    background-color: #00ff00;
    color: black;
    border: none;
    
    &:hover {
      background-color: #00dd00;
    }

    &:disabled {
      opacity: 0.5;
      cursor: not-allowed;
    }
  }
  
  &.secondary {
    background-color: transparent;
    color: #ccc;
    border: 1px solid #555;
    
    &:hover {
      background-color: #333;
    }
  }
`,S=e=>{let{isOpen:t,onRequestClose:o,contact:r,meeting:l,deal:S,onTagAdded:E,onTagRemoved:k}=e;const[j,A]=(0,n.useState)([]),[R,O]=(0,n.useState)(""),[T,D]=(0,n.useState)([]),[P,N]=(0,n.useState)(!1),[I,M]=(0,n.useState)({type:"",text:""}),[L,F]=(0,n.useState)(!1),G=!!l,z=G?l.id:null===r||void 0===r?void 0:r.contact_id;console.log("TagsModal context:",{isMeetingContext:G,entityId:z,meetingInfo:l,contactInfo:r,isOpen:t});const H=async()=>{try{console.log(`Fetching tags for ${G?"meeting":"contact"} with ID: ${z}`);const e=G?"meetings_tags":"contact_tags",t=G?"meeting_id":"contact_id";console.log(`Querying table: ${e}, idField: ${t}, id: ${z}`);let{data:o,error:n}=await s.supabase.from(e).select("*").eq(t,z);if(console.log("Raw tag connections data:",o),n)throw console.error("Error fetching raw tags:",n),n;if(o&&o.length>0){const e=o.map((e=>e.tag_id)).filter((e=>e));if(console.log("Found tag IDs:",e),0===e.length)return console.log("No valid tag IDs found, clearing currentTags"),void A([]);let t;const{data:n,error:r}=await s.supabase.from("tags").select("*").in("tag_id",e);if(r){console.error("Error fetching tag details:",r);const{data:o,error:n}=await s.supabase.from("tags").select("*").in("id",e);if(n)throw console.error("Alternative tag fetch also failed:",n),r;console.log("Alternative tag fetch succeeded:",o),t=o}else t=n;console.log("Tags details:",t);const i=o.map((e=>{var o;const n=null===(o=t)||void 0===o?void 0:o.find((t=>t.id===e.tag_id||t.tag_id===e.tag_id));return{id:e.entry_id||e.id,tag_id:e.tag_id,name:(null===n||void 0===n?void 0:n.name)||(null===n||void 0===n?void 0:n.tag_name)||"Unknown tag"}})).filter((e=>"Unknown tag"!==e.name));console.log("Setting currentTags to:",i),A(i)}else console.log("No tags found, clearing currentTags"),A([])}catch(e){console.error("Error fetching tags:",e),M({type:"error",text:"Failed to load tags"}),A([])}};(0,n.useEffect)((()=>{t&&z&&H()}),[t,z]),(0,n.useEffect)((()=>{R.length>=2?((async e=>{try{let t=s.supabase.from("tags").select("*");e&&(t=t.ilike("name",`%${e}%`));const{data:o,error:n}=await t.limit(10);if(n)throw n;console.log("Raw tag suggestions from DB:",o);const r=o.map((e=>({...e,tag_id:e.tag_id||e.id,name:e.name||e.tag_name||"Unnamed Tag"}))).filter((e=>!j.some((t=>t.tag_id===e.tag_id))));console.log("Filtered tag suggestions:",r),D(r)}catch(t){console.error("Error fetching suggestions:",t)}})(R),F(!0)):(D([]),F(!1))}),[R]);return(0,c.jsx)(i(),{isOpen:t,onRequestClose:o,style:{content:{top:"50%",left:"50%",right:"auto",bottom:"auto",marginRight:"-50%",transform:"translate(-50%, -50%)",padding:"20px",border:"1px solid #333",backgroundColor:"#121212",color:"#e0e0e0",borderRadius:"8px",boxShadow:"0 4px 20px rgba(0, 0, 0, 0.6)",maxWidth:"500px",width:"90%",minHeight:"360px"},overlay:{backgroundColor:"rgba(0, 0, 0, 0.75)",zIndex:1e3}},children:(0,c.jsxs)("div",{style:{padding:"1rem"},children:[(0,c.jsxs)(d,{children:[(0,c.jsx)("h2",{children:"Manage Tags"}),(0,c.jsx)("button",{onClick:o,"aria-label":"Close modal",children:(0,c.jsx)(a.yGN,{size:20})})]}),(0,c.jsxs)(u,{children:[(0,c.jsx)(p,{children:"Current Tags"}),(0,c.jsxs)(h,{children:[j.map((e=>{const t=(e.name,{bg:"#222",text:"#00ff00",border:"#00ff00"});return(0,c.jsxs)(f,{color:t.bg,textColor:t.text,children:[(0,c.jsx)("span",{title:e.name,children:e.name.length>25?`${e.name.substring(0,25)}...`:e.name}),(0,c.jsx)("button",{onClick:()=>(async e=>{try{N(!0),console.log(`Removing tag ID ${e.tag_id} from ${G?"meeting":"contact"} ${z}`);const t=G?"meetings_tags":"contact_tags",o=G?"meeting_id":"contact_id",{error:n}=await s.supabase.from(t).delete().eq(o,z).eq("tag_id",e.tag_id);if(n)throw console.error("Delete error:",n),n;await H(),k&&"function"===typeof k&&k(e),M({type:"success",text:"Tag removed successfully"})}catch(t){console.error("Error removing tag:",t),M({type:"error",text:"Failed to remove tag"})}finally{N(!1)}})(e),disabled:P,children:(0,c.jsx)(a.yGN,{size:14})})]},e.id)})),0===j.length&&(0,c.jsx)("span",{style:{color:"#6c757d",fontStyle:"italic",padding:"4px"},children:"No tags assigned"})]})]}),(0,c.jsxs)(u,{children:[(0,c.jsx)(p,{children:"Add Tags"}),(0,c.jsxs)(g,{children:[(0,c.jsx)(y,{children:(0,c.jsx)(a.CKj,{size:16})}),(0,c.jsx)(m,{type:"text",value:R,onChange:e=>O(e.target.value),placeholder:"Search or create new tag..."})]}),L&&(0,c.jsxs)(v,{children:[T.map((e=>(0,c.jsxs)(b,{onClick:()=>(async e=>{try{N(!0),console.log("Full tag object to add:",e);const t=e.tag_id||e.id;if(console.log(`Adding tag ${t} to ${G?"meeting":"contact"} ${z}`),!z)throw console.error("Missing entity ID. Cannot add tag."),new Error("Missing entity ID");if(!t)throw console.error("Missing tag ID. Cannot add tag."),new Error("Missing tag ID");const o=G?"meetings_tags":"contact_tags",n=G?"meeting_id":"contact_id",r={tag_id:t};r[n]=z,console.log("Inserting data:",r,"into table:",o),console.log(`Testing table permissions for ${o}`);const{data:i,error:a}=await s.supabase.from(o).select("*").limit(1);a?console.error(`Permission test for ${o} failed:`,a):console.log(`Permission test for ${o} passed. Sample data:`,i),console.log(`Checking if tag ${t} is already associated with ${n}=${z}`);const{data:l,error:c}=await s.supabase.from(o).select("*").eq(n,z).eq("tag_id",t);if(c)throw console.error("Error checking existing tag:",c),c;if(console.log("Existing tag check result:",l),l&&l.length>0)return console.log("Tag already exists for this entity, skipping insertion"),M({type:"success",text:"Tag already exists"}),await H(),O(""),void F(!1);console.log("About to insert tag connection with data:",{tableName:o,idFieldName:n,entityId:z,tagId:t,fullInsertData:r});const{data:d,error:u}=await s.supabase.from(o).insert(r).select();if(u)throw console.error("Insert error:",u),u;console.log("Insert successful, result:",d),await H(),E&&"function"===typeof E&&E({tag_id:e.tag_id||e.id,name:e.name||e.tag_name||"Unnamed Tag"}),O(""),F(!1),M({type:"success",text:"Tag added successfully"})}catch(t){console.error("Error adding tag:",t),console.error("Error details:",t.message,t.code,t.details),M({type:"error",text:`Failed to add tag: ${t.message||"Unknown error"}`})}finally{N(!1)}})(e),disabled:P,children:[e.name," ",e.tag_id||e.id?"":"(Missing ID)"]},e.tag_id||e.id))),R.trim()&&!T.find((e=>e.name.toLowerCase()===R.toLowerCase()))&&(0,c.jsxs)(x,{onClick:async()=>{if(R.trim())try{if(N(!0),console.log(`Creating new tag "${R}" for ${G?"meeting":"contact"}`),!z)throw console.error("Missing entity ID. Cannot add tag."),new Error("Missing entity ID");let i,a=[];try{const{data:e,error:t}=await s.supabase.from("tags").select("*").ilike("name",R.trim());!t&&e&&(a=e)}catch(e){console.error("Error searching for existing tags (continuing anyway):",e)}if(a&&a.length>0){console.log("Tag with this name already exists, using existing tag");const e=a[0];i={...e,tag_id:e.tag_id||e.id},console.log("Using existing tag with ID:",i.tag_id)}else try{const{data:e,error:t}=await s.supabase.from("tags").insert({name:R.trim()}).select();if(t)throw console.error("Error creating tag:",t),t;if(console.log("New tag created:",e),!(e&&e.length>0))throw new Error("Tag created but no data returned");i={...e[0],tag_id:e[0].tag_id||e[0].id},console.log("New tag has ID:",i.tag_id)}catch(t){console.error("Failed to create tag with standard approach:",t);try{const{data:e,error:t}=await s.supabase.from("tags").insert({name:R.trim()}).select();if(t)throw t;if(!(e&&e.length>0))throw new Error("Tag created but no data returned");i={...e[0],tag_id:e[0].tag_id||e[0].id,name:R.trim()}}catch(o){throw console.error("Failed to create tag with fallback approach:",o),o}}const l=G?"meetings_tags":"contact_tags",c=G?"meeting_id":"contact_id";let d=!0;try{const{data:e,error:t}=await s.supabase.from(l).select("*").eq(c,z).eq("tag_id",i.tag_id);if(!t&&e&&e.length>0)return console.log("Tag already associated with this entity"),d=!1,M({type:"success",text:"Tag already exists"}),await H(),O(""),F(!1),void(E&&"function"===typeof E&&E({tag_id:i.tag_id,name:i.name||i.tag_name||R.trim()}))}catch(n){console.error("Error checking existing connection (continuing anyway):",n)}if(d){const e={tag_id:i.tag_id};e[c]=z,console.log("Connecting tag:",e);try{const{error:t}=await s.supabase.from(l).insert(e);if(t)throw console.error("Error connecting tag:",t),t}catch(r){throw console.error("Failed to insert tag connection:",r),r}await H(),E&&"function"===typeof E&&E({tag_id:i.tag_id,name:i.name||i.tag_name||R.trim()}),O(""),F(!1),M({type:"success",text:a&&a.length>0?"Existing tag added successfully":"New tag created and added successfully"})}}catch(i){console.error("Error creating tag:",i),M({type:"error",text:"Failed to create tag"})}finally{N(!1)}},disabled:P,children:[(0,c.jsx)(a.GGD,{size:14}),'Create "',R,'"']})]})]}),I.text&&(0,c.jsx)(w,{className:I.type,children:I.text}),(0,c.jsx)(C,{children:(0,c.jsx)(_,{className:"primary",onClick:o,children:"Done"})}),P&&(0,c.jsx)("div",{style:{textAlign:"center",marginTop:"10px"},children:(0,c.jsx)("div",{className:"spinner",style:{width:"20px",height:"20px",border:"3px solid #222",borderTop:"3px solid #00ff00",borderRadius:"50%",animation:"spin 1s linear infinite"}})})]})})},E=document.createElement("style");E.innerHTML="\n  @keyframes spin {\n    0% { transform: rotate(0deg); }\n    100% { transform: rotate(360deg); }\n  }\n",document.head.appendChild(E)},579:(e,t,o)=>{"use strict";e.exports=o(1153)},585:(e,t,o)=>{"use strict";o.d(t,{A:()=>O});var n=o(5043),r=o(1529),i=o(2963),a=o.n(i),s=o(1009),l=o(3768),c=o(579);a().setAppElement("#root");const d=r.Ay.div`
  display: flex;
  justify-content: space-between;
  align-items: center;
  padding-bottom: 15px;
  margin-bottom: 20px;
  border-bottom: 1px solid #333;

  h2 {
    color: #00ff00;
    margin: 0;
    font-size: 1.2rem;
    font-family: 'Courier New', monospace;
  }
`,u=r.Ay.div`
  position: absolute;
  top: 100%;
  left: 0;
  right: 0;
  max-height: 150px;
  overflow-y: auto;
  background-color: #1a1a1a;
  border: 1px solid #333;
  border-top: none;
  border-radius: 0 0 4px 4px;
  box-shadow: 0 4px 8px rgba(0, 0, 0, 0.3);
  z-index: 1000;
  
  &::-webkit-scrollbar {
    width: 6px;
  }
  
  &::-webkit-scrollbar-track {
    background: #222;
  }
  
  &::-webkit-scrollbar-thumb {
    background-color: #00ff00;
    border-radius: 3px;
  }
`,p=r.Ay.div`
  padding: 8px 12px;
  cursor: pointer;
  color: #ccc;
  
  &:hover {
    background-color: #333;
    color: #00ff00;
  }
  
  &.highlight {
    background-color: #333;
    color: #00ff00;
  }
`,h=r.Ay.button`
  background: none;
  border: none;
  color: #00ff00;
  font-size: 1.2rem;
  cursor: pointer;
  display: flex;
  align-items: center;
  justify-content: center;
  
  &:hover {
    color: #00cc00;
  }
`,f=r.Ay.div`
  display: flex;
  flex-direction: column;
  gap: 20px;
  width: 100%;
  padding: 0 15px;
  max-height: calc(100vh - 250px);
  overflow-y: auto;
  padding-right: 25px; /* Add space for scrollbar */
  margin-right: -10px; /* Compensate for extra padding */
  
  &::-webkit-scrollbar {
    width: 8px;
  }
  
  &::-webkit-scrollbar-track {
    background: #222;
    border-radius: 4px;
  }
  
  &::-webkit-scrollbar-thumb {
    background-color: #00ff00;
    border-radius: 4px;
    border: 1px solid #333;
  }
  
  &::-webkit-scrollbar-thumb:hover {
    background-color: #00cc00;
  }
`,g=r.Ay.div`
  display: flex;
  flex-direction: column;
  gap: 6px;
`,m=r.Ay.label`
  color: #00ff00;
  font-size: 13px;
  display: flex;
  align-items: center;
  gap: 6px;
  
  svg {
    opacity: 0.8;
  }
`,y="\n  background-color: #1a1a1a;\n  border: 1px solid #333;\n  border-radius: 4px;\n  color: #ccc;\n  padding: 10px 12px;\n  font-size: 14px;\n  width: 100%;\n  height: 42px; /* Fixed height for consistent appearance */\n  box-sizing: border-box;\n  \n  &:focus {\n    border-color: #00ff00;\n    outline: none;\n    box-shadow: 0 0 0 1px rgba(0, 255, 0, 0.3);\n  }\n  \n  &::placeholder {\n    color: #555;\n  }\n",v=r.Ay.input`
  ${y}
  
  &:disabled {
    background-color: #222;
    color: #666;
    cursor: not-allowed;
  }
`,b=r.Ay.select`
  ${y}
  cursor: pointer;
  appearance: none;
  background-image: url("data:image/svg+xml;charset=utf-8,%3Csvg xmlns='http://www.w3.org/2000/svg' width='16' height='16' viewBox='0 0 24 24' fill='none' stroke='%2300ff00' stroke-width='2' stroke-linecap='round' stroke-linejoin='round'%3E%3Cpolyline points='6 9 12 15 18 9'/%3E%3C/svg%3E");
  background-repeat: no-repeat;
  background-position: right 10px center;
  padding-right: 30px; /* Make room for the dropdown arrow */
  
  option {
    background-color: #1a1a1a;
    color: #ccc;
  }
`,x=r.Ay.textarea`
  ${y}
  min-height: 100px;
  height: auto;
  resize: vertical;
`,w=r.Ay.div`
  color: #ff5555;
  font-size: 12px;
  margin-top: 4px;
  display: flex;
  align-items: center;
  gap: 4px;
  
  svg {
    flex-shrink: 0;
  }
`,C=r.Ay.div`
  display: flex;
  flex-wrap: wrap;
  gap: 8px;
  margin-top: 10px;
`,_=r.Ay.div`
  background-color: rgba(0, 255, 0, 0.1);
  color: #00ff00;
  font-size: 12px;
  padding: 5px 10px;
  border-radius: 12px;
  display: inline-flex;
  align-items: center;
  gap: 5px;
  
  button {
    background: none;
    border: none;
    color: #00ff00;
    font-size: 14px;
    cursor: pointer;
    padding: 0;
    display: flex;
    align-items: center;
    justify-content: center;
    margin-left: 3px;
    text-shadow: 0 0 5px rgba(0, 255, 0, 0.5);
    
    &:hover {
      color: #00cc00;
      text-shadow: 0 0 8px rgba(0, 255, 0, 0.8);
    }
  }
`,S=(r.Ay.button`
  background-color: transparent;
  color: #00ff00;
  border: 1px dashed #00ff00;
  border-radius: 12px;
  padding: 5px 10px;
  font-size: 12px;
  cursor: pointer;
  display: flex;
  align-items: center;
  gap: 5px;
  
  &:hover {
    background-color: rgba(0, 255, 0, 0.05);
  }
`,r.Ay.div`
  display: flex;
  justify-content: flex-end;
  gap: 15px;
  padding: 20px 0;
  border-top: 1px solid #333;
  margin-top: 20px;
`),E=r.Ay.button`
  background-color: rgba(0, 255, 0, 0.1);
  color: #00ff00;
  border: 1px solid #00ff00;
  padding: 10px 20px;
  border-radius: 4px;
  cursor: pointer;
  display: flex;
  align-items: center;
  gap: 8px;
  transition: all 0.2s;
  
  &:hover {
    background-color: rgba(0, 255, 0, 0.2);
    box-shadow: 0 0 8px rgba(0, 255, 0, 0.3);
  }
  
  &:disabled {
    opacity: 0.5;
    cursor: not-allowed;
    background-color: rgba(0, 255, 0, 0.05);
    &:hover {
      box-shadow: none;
    }
  }
`,k=r.Ay.button`
  background-color: transparent;
  color: #cccccc;
  border: 1px solid #555;
  padding: 10px 20px;
  border-radius: 4px;
  cursor: pointer;
  display: flex;
  align-items: center;
  gap: 8px;
  
  &:hover {
    background-color: #333;
  }
`,j=r.Ay.div`
  display: flex;
  gap: 20px;
  width: 100%;
  
  @media (max-width: 768px) {
    flex-direction: column;
  }
  
  > div {
    flex: 1;
    min-width: 0; /* Prevents flex children from overflowing */
  }
`,A=r.Ay.div`
  font-size: 15px;
  color: #00ff00;
  margin: 15px 0 10px 0;
  padding-bottom: 5px;
  border-bottom: 1px solid #333;
  display: flex;
  align-items: center;
  
  svg {
    margin-right: 8px;
  }
`,R=r.Ay.div`
  color: #888;
  font-size: 12px;
  margin-top: 4px;
  font-style: italic;
`,O=e=>{let{isOpen:t,onClose:r,dealData:i,onSave:y}=e;const[O,T]=(0,n.useState)({opportunity:"",source_category:"Not Set",category:"Inbox",stage:"Lead",description:"",total_investment:"",attachment:null,tags:[]}),[D,P]=(0,n.useState)({}),[N,I]=(0,n.useState)(!1),[M,L]=(0,n.useState)(""),[F,G]=(0,n.useState)([]),[z,H]=(0,n.useState)(!1);(0,n.useEffect)((()=>{if(i){T({opportunity:i.opportunity||"",source_category:i.source_category||"Not Set",category:i.category||"Inbox",stage:i.stage||"Lead",description:i.description||"",total_investment:i.total_investment?String(i.total_investment):"",attachment:null,tags:[]});(async()=>{try{const{supabase:e}=await Promise.resolve().then(o.bind(o,5315)),{data:t,error:n}=await e.from("deal_tags").select("tags:tag_id(name)").eq("deal_id",i.deal_id);if(n)throw n;const r=t.filter((e=>e.tags)).map((e=>e.tags.name));T((e=>({...e,tags:r})));const{data:a,error:s}=await e.from("tags").select("name").order("name");if(s)throw s;G(a.map((e=>e.name)))}catch(e){console.error("Error fetching tags:",e),l.Ay.error("Failed to load tags")}})(),P({})}}),[i,t]);const B=e=>{const{name:t,value:o,type:n,files:r}=e.target;T("file"===n?e=>({...e,[t]:r&&r.length>0?r[0]:null}):e=>({...e,[t]:o})),D[t]&&P((e=>({...e,[t]:null})))},V=async()=>{if((()=>{const e={};return O.opportunity.trim()||(e.opportunity="Deal name is required"),O.total_investment&&isNaN(Number(O.total_investment))&&(e.total_investment="Investment amount must be a valid number"),P(e),0===Object.keys(e).length})()){I(!0);try{const t={...i,opportunity:O.opportunity,source_category:O.source_category,category:O.category,stage:O.stage,description:O.description,total_investment:O.total_investment?Number(O.total_investment):null,last_modified_at:(new Date).toISOString(),last_modified_by:"User"},{supabase:n}=await Promise.resolve().then(o.bind(o,5315)),{error:a}=await n.from("deals").update(t).eq("deal_id",i.deal_id);if(a)throw a;try{const{data:e,error:t}=await n.from("deal_tags").select("tag_id, tags:tag_id(name)").eq("deal_id",i.deal_id);if(t)throw t;const o=e.filter((e=>e.tags)).map((e=>e.tags.name)),r=O.tags.filter((e=>!o.includes(e))),a=e.filter((e=>e.tags&&!O.tags.includes(e.tags.name))).map((e=>e.tag_id));if(a.length>0){const{error:e}=await n.from("deal_tags").delete().eq("deal_id",i.deal_id).in("tag_id",a);if(e)throw e}for(const s of r){let e;const{data:t,error:o}=await n.from("tags").select("tag_id").eq("name",s).single();if(o&&"PGRST116"!==o.code)throw o;if(t)e=t.tag_id;else{const{data:t,error:o}=await n.from("tags").insert({name:s}).select("tag_id").single();if(o)throw o;e=t.tag_id}const{error:r}=await n.from("deal_tags").insert({deal_id:i.deal_id,tag_id:e});if(r)throw r}}catch(e){console.error("Error managing tags:",e),l.Ay.warning("Deal updated but there was an issue with the tags")}l.Ay.success("Deal updated successfully"),y&&y(t),r()}catch(t){console.error("Error updating deal:",t),l.Ay.error(`Failed to update deal: ${t.message||"Unknown error"}`)}finally{I(!1)}}};return(0,c.jsxs)(a(),{isOpen:t,onRequestClose:r,style:{content:{top:"50%",left:"50%",right:"auto",bottom:"auto",marginRight:"-50%",transform:"translate(-50%, -50%)",padding:"25px",width:"805px",maxWidth:"90%",height:"85vh",maxHeight:"85vh",backgroundColor:"#121212",border:"1px solid #333",borderRadius:"8px",boxShadow:"0 4px 20px rgba(0, 0, 0, 0.6)",color:"#e0e0e0",zIndex:1001,overflow:"hidden",display:"flex",flexDirection:"column"},overlay:{backgroundColor:"rgba(0, 0, 0, 0.75)",zIndex:1e3}},children:[(0,c.jsxs)(d,{children:[(0,c.jsx)("h2",{children:"Edit Deal"}),(0,c.jsxs)("div",{style:{display:"flex",gap:"10px"},children:[(0,c.jsx)(E,{onClick:V,disabled:N,style:{padding:"5px 10px",height:"auto"},children:N?"Saving...":(0,c.jsx)(s.Bc_,{})}),(0,c.jsx)(h,{onClick:r,children:(0,c.jsx)(s.yGN,{})})]})]}),(0,c.jsxs)(f,{children:[(0,c.jsxs)(A,{children:[(0,c.jsx)(s.S8s,{size:16})," Basic Information"]}),(0,c.jsxs)(g,{children:[(0,c.jsxs)(m,{htmlFor:"opportunity",children:[(0,c.jsx)(s.S8s,{size:14})," Deal Name"]}),(0,c.jsx)(v,{id:"opportunity",name:"opportunity",value:O.opportunity,onChange:B,placeholder:"Enter deal name"}),D.opportunity&&(0,c.jsxs)(w,{children:[(0,c.jsx)(s.eHT,{size:12})," ",D.opportunity]})]}),(0,c.jsxs)(j,{children:[(0,c.jsxs)(g,{children:[(0,c.jsxs)(m,{htmlFor:"category",children:[(0,c.jsx)(s.Wm,{size:14})," Category"]}),(0,c.jsx)(b,{id:"category",name:"category",value:O.category,onChange:B,children:["Inbox","Startup","Fund","Real Estate","Private Debt","Private Equity","Other"].map((e=>(0,c.jsx)("option",{value:e,children:e},e)))})]}),(0,c.jsxs)(g,{children:[(0,c.jsxs)(m,{htmlFor:"stage",children:[(0,c.jsx)(s.z1n,{size:14})," Stage"]}),(0,c.jsx)(b,{id:"stage",name:"stage",value:O.stage,onChange:B,children:["Lead","Evaluating","Closing","Invested","Monitoring","Passed"].map((e=>(0,c.jsx)("option",{value:e,children:e},e)))})]})]}),(0,c.jsxs)(j,{children:[(0,c.jsxs)(g,{children:[(0,c.jsxs)(m,{htmlFor:"source_category",children:[(0,c.jsx)(s.wIk,{size:14})," Source"]}),(0,c.jsx)(b,{id:"source_category",name:"source_category",value:O.source_category,onChange:B,children:["Not Set","Cold Contacting","Introduction"].map((e=>(0,c.jsx)("option",{value:e,children:e},e)))})]}),(0,c.jsxs)(g,{children:[(0,c.jsxs)(m,{htmlFor:"total_investment",children:[(0,c.jsx)(s.z8N,{size:14})," Investment Amount"]}),(0,c.jsx)(v,{id:"total_investment",name:"total_investment",value:O.total_investment,onChange:B,placeholder:"Enter investment amount",type:"text"}),D.total_investment&&(0,c.jsxs)(w,{children:[(0,c.jsx)(s.eHT,{size:12})," ",D.total_investment]}),(0,c.jsx)(R,{children:"Enter numeric value only (no currency symbols)"})]})]}),(0,c.jsxs)(j,{children:[(0,c.jsxs)(g,{children:[(0,c.jsxs)(m,{htmlFor:"attachment",children:[(0,c.jsx)(s._mV,{size:14})," Attachment"]}),(0,c.jsx)(v,{id:"attachment",name:"attachment",type:"file",onChange:B,accept:"*/*"}),(0,c.jsx)(R,{children:"Upload a file to attach to this deal"})]}),(0,c.jsxs)(g,{children:[(0,c.jsxs)(m,{htmlFor:"tags",children:[(0,c.jsx)(s.cnX,{size:14})," Tags"]}),(0,c.jsxs)("div",{style:{display:"flex",gap:"10px",width:"100%",position:"relative"},children:[(0,c.jsx)(v,{id:"tags",placeholder:"Search or add tag and press Enter",value:M,onChange:e=>{const t=e.target.value;L(t),(e=>{if(!e)return void H(!1);const t=F.filter((t=>t.toLowerCase().includes(e.toLowerCase())&&!O.tags.includes(t)));H(t.length>0)})(t)},onKeyPress:e=>{"Enter"===e.key&&(e.preventDefault(),(async()=>{M.trim()&&!O.tags.includes(M.trim())&&(T({...O,tags:[...O.tags,M.trim()]}),L(""),H(!1))})())},autoComplete:"off"}),z&&M.trim()&&(0,c.jsx)(u,{children:F.filter((e=>e.toLowerCase().includes(M.toLowerCase())&&!O.tags.includes(e))).slice(0,8).map(((e,t)=>(0,c.jsx)(p,{onClick:()=>(e=>{O.tags.includes(e)||T({...O,tags:[...O.tags,e]}),L(""),H(!1)})(e),children:e},t)))})]}),(0,c.jsx)(R,{children:"Press Enter to add multiple tags"}),O.tags.length>0&&(0,c.jsx)(C,{style:{marginTop:"10px"},children:O.tags.map((e=>(0,c.jsxs)(_,{children:[e,(0,c.jsx)("button",{onClick:()=>{return t=e,void T({...O,tags:O.tags.filter((e=>e!==t))});var t},children:(0,c.jsx)(s.yGN,{size:12})})]},e)))})]})]}),(0,c.jsxs)(g,{children:[(0,c.jsxs)(m,{htmlFor:"description",children:[(0,c.jsx)(s.S8s,{size:14})," Description"]}),(0,c.jsx)(x,{id:"description",name:"description",value:O.description,onChange:B,placeholder:"Enter description"})]})]}),(0,c.jsxs)(S,{children:[(0,c.jsxs)(k,{onClick:r,children:[(0,c.jsx)(s.yGN,{})," Cancel"]}),(0,c.jsx)(E,{onClick:V,disabled:N,children:N?"Saving...":(0,c.jsxs)(c.Fragment,{children:[(0,c.jsx)(s.Bc_,{})," Save Changes"]})})]})]})}},766:(e,t,o)=>{e.exports=function(){function e(t,o,n){function r(a,s){if(!o[a]){if(!t[a]){if(i)return i(a,!0);var l=new Error("Cannot find module '"+a+"'");throw l.code="MODULE_NOT_FOUND",l}var c=o[a]={exports:{}};t[a][0].call(c.exports,(function(e){return r(t[a][1][e]||e)}),c,c.exports,e,t,o,n)}return o[a].exports}for(var i=void 0,a=0;a<n.length;a++)r(n[a]);return r}return e}()({1:[function(e,t,o){"use strict";var n,r="undefined"!==typeof window?window:"undefined"!==typeof self?self:null;n=r?"signal"in new Request("https://airtable.com")?r.AbortController:e("abortcontroller-polyfill/dist/cjs-ponyfill").AbortController:e("abort-controller"),t.exports=n},{"abort-controller":20,"abortcontroller-polyfill/dist/cjs-ponyfill":19}],2:[function(e,t,o){"use strict";var n=function(){function e(e,t,o){this.error=e,this.message=t,this.statusCode=o}return e.prototype.toString=function(){return[this.message,"(",this.error,")",this.statusCode?"[Http code "+this.statusCode+"]":""].join("")},e}();t.exports=n},{}],3:[function(e,t,o){"use strict";var n=this&&this.__assign||function(){return n=Object.assign||function(e){for(var t,o=1,n=arguments.length;o<n;o++)for(var r in t=arguments[o])Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e},n.apply(this,arguments)},r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}},i=r(e("lodash/get")),a=r(e("lodash/isPlainObject")),s=r(e("lodash/keys")),l=r(e("./fetch")),c=r(e("./abort-controller")),d=r(e("./object_to_query_param_string")),u=r(e("./airtable_error")),p=r(e("./table")),h=r(e("./http_headers")),f=r(e("./run_action")),g=r(e("./package_version")),m=r(e("./exponential_backoff_with_jitter")),y="Airtable.js/"+g.default,v=function(){function e(e,t){this._airtable=e,this._id=t}return e.prototype.table=function(e){return new p.default(this,null,e)},e.prototype.makeRequest=function(e){var t,o=this;void 0===e&&(e={});var r=i.default(e,"method","GET").toUpperCase(),a=this._airtable._endpointUrl+"/v"+this._airtable._apiVersionMajor+"/"+this._id+i.default(e,"path","/")+"?"+d.default(i.default(e,"qs",{})),s=new c.default,p={method:r,headers:this._getRequestHeaders(Object.assign({},this._airtable._customHeaders,null!==(t=e.headers)&&void 0!==t?t:{})),signal:s.signal};"body"in e&&b(r)&&(p.body=JSON.stringify(e.body));var h=setTimeout((function(){s.abort()}),this._airtable._requestTimeout);return new Promise((function(t,r){l.default(a,p).then((function(a){if(clearTimeout(h),429!==a.status||o._airtable._noRetryIfRateLimited)a.json().then((function(e){var n=o._checkStatusForError(a.status,e)||x(a.status,e);n?r(n):t({statusCode:a.status,headers:a.headers,body:e})})).catch((function(){var e=x(a.status);r(e)}));else{var s=i.default(e,"_numAttempts",0),l=m.default(s);setTimeout((function(){var i=n(n({},e),{_numAttempts:s+1});o.makeRequest(i).then(t).catch(r)}),l)}})).catch((function(e){clearTimeout(h),e=new u.default("CONNECTION_ERROR",e.message,null),r(e)}))}))},e.prototype.runAction=function(e,t,o,n,r){f.default(this,e,t,o,n,r,0)},e.prototype._getRequestHeaders=function(e){var t=new h.default;t.set("Authorization","Bearer "+this._airtable._apiKey),t.set("User-Agent",y),t.set("Content-Type","application/json");for(var o=0,n=s.default(e);o<n.length;o++){var r=n[o];t.set(r,e[r])}return t.toJSON()},e.prototype._checkStatusForError=function(e,t){var o=(null!==t&&void 0!==t?t:{error:{}}).error,n=void 0===o?{}:o,r=n.type,i=n.message;return 401===e?new u.default("AUTHENTICATION_REQUIRED","You should provide valid api key to perform this operation",e):403===e?new u.default("NOT_AUTHORIZED","You are not authorized to perform this operation",e):404===e?new u.default("NOT_FOUND",null!==i&&void 0!==i?i:"Could not find what you are looking for",e):413===e?new u.default("REQUEST_TOO_LARGE","Request body is too large",e):422===e?new u.default(null!==r&&void 0!==r?r:"UNPROCESSABLE_ENTITY",null!==i&&void 0!==i?i:"The operation cannot be processed",e):429===e?new u.default("TOO_MANY_REQUESTS","You have made too many requests in a short period of time. Please retry your request later",e):500===e?new u.default("SERVER_ERROR","Try again. If the problem persists, contact support.",e):503===e?new u.default("SERVICE_UNAVAILABLE","The service is temporarily unavailable. Please retry shortly.",e):e>=400?new u.default(null!==r&&void 0!==r?r:"UNEXPECTED_ERROR",null!==i&&void 0!==i?i:"An unexpected error occurred",e):null},e.prototype.doCall=function(e){return this.table(e)},e.prototype.getId=function(){return this._id},e.createFunctor=function(t,o){var n=new e(t,o),r=function(e){return n.doCall(e)};return r._base=n,r.table=n.table.bind(n),r.makeRequest=n.makeRequest.bind(n),r.runAction=n.runAction.bind(n),r.getId=n.getId.bind(n),r},e}();function b(e){return"GET"!==e&&"DELETE"!==e}function x(e,t){return a.default(t)?null:new u.default("UNEXPECTED_ERROR","The response from Airtable was invalid JSON. Please try again soon.",e)}t.exports=v},{"./abort-controller":1,"./airtable_error":2,"./exponential_backoff_with_jitter":6,"./fetch":7,"./http_headers":9,"./object_to_query_param_string":11,"./package_version":12,"./run_action":16,"./table":17,"lodash/get":77,"lodash/isPlainObject":89,"lodash/keys":93}],4:[function(e,t,o){"use strict";function n(e,t,o){return void 0===o&&(o=void 0),function(){for(var n,r=[],i=0;i<arguments.length;i++)r[i]=arguments[i];if("function"!==typeof r[n=void 0===o?r.length>0?r.length-1:0:o]){for(var a=[],s=Math.max(r.length,n),l=0;l<s;l++)a.push(r[l]);return new Promise((function(o,n){a.push((function(e,t){e?n(e):o(t)})),e.apply(t,a)}))}e.apply(t,r)}}t.exports=n},{}],5:[function(e,t,o){"use strict";var n={};function r(e,t,o){return function(){for(var r=[],i=0;i<arguments.length;i++)r[i]=arguments[i];n[t]||(n[t]=!0,console.warn(o)),e.apply(this,r)}}t.exports=r},{}],6:[function(e,t,o){"use strict";var n=(this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}})(e("./internal_config.json"));function r(e){var t=n.default.INITIAL_RETRY_DELAY_IF_RATE_LIMITED*Math.pow(2,e),o=Math.min(n.default.MAX_RETRY_DELAY_IF_RATE_LIMITED,t);return Math.random()*o}t.exports=r},{"./internal_config.json":10}],7:[function(e,t,o){"use strict";var n=(this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}})(e("node-fetch")),r="undefined"!==typeof window?window:"undefined"!==typeof self?self:null;t.exports=r?r.fetch.bind(r):n.default},{"node-fetch":20}],8:[function(e,t,o){"use strict";function n(e,t){return Object.prototype.hasOwnProperty.call(e,t)}t.exports=n},{}],9:[function(e,t,o){"use strict";var n=(this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}})(e("lodash/keys")),r="undefined"!==typeof window,i=function(){function e(){this._headersByLowercasedKey={}}return e.prototype.set=function(e,t){var o=e.toLowerCase();"x-airtable-user-agent"===o&&(o="user-agent",e="User-Agent"),this._headersByLowercasedKey[o]={headerKey:e,headerValue:t}},e.prototype.toJSON=function(){for(var e={},t=0,o=n.default(this._headersByLowercasedKey);t<o.length;t++){var i=o[t],a=this._headersByLowercasedKey[i];e[r&&"user-agent"===i?"X-Airtable-User-Agent":a.headerKey]=a.headerValue}return e},e}();t.exports=i},{"lodash/keys":93}],10:[function(e,t,o){t.exports={INITIAL_RETRY_DELAY_IF_RATE_LIMITED:5e3,MAX_RETRY_DELAY_IF_RATE_LIMITED:6e5}},{}],11:[function(e,t,o){"use strict";var n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}},r=n(e("lodash/isArray")),i=n(e("lodash/isNil")),a=n(e("lodash/keys"));function s(e,t,o){if(r.default(t))for(var n=0;n<t.length;n++){var i=t[n];/\[\]$/.test(e)?o(e,i):s(e+"["+("object"===typeof i&&null!==i?n:"")+"]",i,o)}else if("object"===typeof t)for(var l=0,c=a.default(t);l<c.length;l++){var d=c[l];s(e+"["+d+"]",i=t[d],o)}else o(e,t)}function l(e){for(var t=[],o=function(e,o){o=i.default(o)?"":o,t.push(encodeURIComponent(e)+"="+encodeURIComponent(o))},n=0,r=a.default(e);n<r.length;n++){var l=r[n];s(l,e[l],o)}return t.join("&").replace(/%20/g,"+")}t.exports=l},{"lodash/isArray":79,"lodash/isNil":85,"lodash/keys":93}],12:[function(e,t,o){"use strict";t.exports="0.12.2"},{}],13:[function(e,t,o){"use strict";var n=this&&this.__assign||function(){return n=Object.assign||function(e){for(var t,o=1,n=arguments.length;o<n;o++)for(var r in t=arguments[o])Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e},n.apply(this,arguments)},r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}},i=r(e("lodash/isFunction")),a=r(e("lodash/keys")),s=r(e("./record")),l=r(e("./callback_to_promise")),c=r(e("./has")),d=e("./query_params"),u=r(e("./object_to_query_param_string")),p=function(){function e(e,t){this._table=e,this._params=t,this.firstPage=l.default(h,this),this.eachPage=l.default(f,this,1),this.all=l.default(g,this)}return e.validateParams=function(t){for(var o={},n=[],r=[],i=0,s=a.default(t);i<s.length;i++){var l=s[i],d=t[l];if(c.default(e.paramValidators,l)){var u=(0,e.paramValidators[l])(d);u.pass?o[l]=d:r.push(u.error)}else n.push(l)}return{validParams:o,ignoredKeys:n,errors:r}},e.paramValidators=d.paramValidators,e}();function h(e){if(!i.default(e))throw new Error("The first parameter to `firstPage` must be a function");this.eachPage((function(t){e(null,t)}),(function(t){e(t,null)}))}function f(e,t){var o=this;if(!i.default(e))throw new Error("The first parameter to `eachPage` must be a function");if(!i.default(t)&&void 0!==t)throw new Error("The second parameter to `eachPage` must be a function or undefined");var r,a,l=n({},this._params),c="/"+this._table._urlEncodedNameOrId()+"?"+u.default(l),p={},h=null;if("post"===l.method||c.length>d.URL_CHARACTER_LENGTH_LIMIT){h=l,r="post",a="/"+this._table._urlEncodedNameOrId()+"/listRecords";for(var f=0,g=Object.keys(l);f<g.length;f++){var m=g[f];d.shouldListRecordsParamBePassedAsParameter(m)?p[m]=l[m]:h[m]=l[m]}}else r="get",p=l,a="/"+this._table._urlEncodedNameOrId();var y=function(){o._table._base.runAction(r,a,p,h,(function(n,r,i){if(n)t(n,null);else{var a=void 0;i.offset?(l.offset=i.offset,a=y):a=function(){t(null)};var c=i.records.map((function(e){return new s.default(o._table,null,e)}));e(c,a)}}))};y()}function g(e){if(!i.default(e))throw new Error("The first parameter to `all` must be a function");var t=[];this.eachPage((function(e,o){t.push.apply(t,e),o()}),(function(o){o?e(o,null):e(null,t)}))}t.exports=p},{"./callback_to_promise":4,"./has":8,"./object_to_query_param_string":11,"./query_params":14,"./record":15,"lodash/isFunction":83,"lodash/keys":93}],14:[function(e,t,o){"use strict";var n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(o,"__esModule",{value:!0}),o.shouldListRecordsParamBePassedAsParameter=o.URL_CHARACTER_LENGTH_LIMIT=o.paramValidators=void 0;var r=n(e("./typecheck")),i=n(e("lodash/isString")),a=n(e("lodash/isNumber")),s=n(e("lodash/isPlainObject")),l=n(e("lodash/isBoolean"));o.paramValidators={fields:r.default(r.default.isArrayOf(i.default),"the value for `fields` should be an array of strings"),filterByFormula:r.default(i.default,"the value for `filterByFormula` should be a string"),maxRecords:r.default(a.default,"the value for `maxRecords` should be a number"),pageSize:r.default(a.default,"the value for `pageSize` should be a number"),offset:r.default(a.default,"the value for `offset` should be a number"),sort:r.default(r.default.isArrayOf((function(e){return s.default(e)&&i.default(e.field)&&(void 0===e.direction||["asc","desc"].includes(e.direction))})),'the value for `sort` should be an array of sort objects. Each sort object must have a string `field` value, and an optional `direction` value that is "asc" or "desc".'),view:r.default(i.default,"the value for `view` should be a string"),cellFormat:r.default((function(e){return i.default(e)&&["json","string"].includes(e)}),'the value for `cellFormat` should be "json" or "string"'),timeZone:r.default(i.default,"the value for `timeZone` should be a string"),userLocale:r.default(i.default,"the value for `userLocale` should be a string"),method:r.default((function(e){return i.default(e)&&["get","post"].includes(e)}),'the value for `method` should be "get" or "post"'),returnFieldsByFieldId:r.default(l.default,"the value for `returnFieldsByFieldId` should be a boolean"),recordMetadata:r.default(r.default.isArrayOf(i.default),"the value for `recordMetadata` should be an array of strings")},o.URL_CHARACTER_LENGTH_LIMIT=15e3,o.shouldListRecordsParamBePassedAsParameter=function(e){return"timeZone"===e||"userLocale"===e}},{"./typecheck":18,"lodash/isBoolean":81,"lodash/isNumber":86,"lodash/isPlainObject":89,"lodash/isString":90}],15:[function(e,t,o){"use strict";var n=this&&this.__assign||function(){return n=Object.assign||function(e){for(var t,o=1,n=arguments.length;o<n;o++)for(var r in t=arguments[o])Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e},n.apply(this,arguments)},r=(this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}})(e("./callback_to_promise")),i=function(){function e(e,t,o){this._table=e,this.id=t||o.id,o&&(this.commentCount=o.commentCount),this.setRawJson(o),this.save=r.default(a,this),this.patchUpdate=r.default(s,this),this.putUpdate=r.default(l,this),this.destroy=r.default(c,this),this.fetch=r.default(d,this),this.updateFields=this.patchUpdate,this.replaceFields=this.putUpdate}return e.prototype.getId=function(){return this.id},e.prototype.get=function(e){return this.fields[e]},e.prototype.set=function(e,t){this.fields[e]=t},e.prototype.setRawJson=function(e){this._rawJson=e,this.fields=this._rawJson&&this._rawJson.fields||{}},e}();function a(e){this.putUpdate(this.fields,e)}function s(e,t,o){var r=this;o||(o=t,t={});var i=n({fields:e},t);this._table._base.runAction("patch","/"+this._table._urlEncodedNameOrId()+"/"+this.id,{},i,(function(e,t,n){e?o(e):(r.setRawJson(n),o(null,r))}))}function l(e,t,o){var r=this;o||(o=t,t={});var i=n({fields:e},t);this._table._base.runAction("put","/"+this._table._urlEncodedNameOrId()+"/"+this.id,{},i,(function(e,t,n){e?o(e):(r.setRawJson(n),o(null,r))}))}function c(e){var t=this;this._table._base.runAction("delete","/"+this._table._urlEncodedNameOrId()+"/"+this.id,{},null,(function(o){o?e(o):e(null,t)}))}function d(e){var t=this;this._table._base.runAction("get","/"+this._table._urlEncodedNameOrId()+"/"+this.id,{},null,(function(o,n,r){o?e(o):(t.setRawJson(r),e(null,t))}))}t.exports=i},{"./callback_to_promise":4}],16:[function(e,t,o){"use strict";var n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}},r=n(e("./exponential_backoff_with_jitter")),i=n(e("./object_to_query_param_string")),a=n(e("./package_version")),s=n(e("./fetch")),l=n(e("./abort-controller")),c="Airtable.js/"+a.default;function d(e,t,o,n,a,u,p){var h=e._airtable._endpointUrl+"/v"+e._airtable._apiVersionMajor+"/"+e._id+o+"?"+i.default(n),f={authorization:"Bearer "+e._airtable._apiKey,"x-api-version":e._airtable._apiVersion,"x-airtable-application-id":e.getId(),"content-type":"application/json"};"undefined"!==typeof window?f["x-airtable-user-agent"]=c:f["User-Agent"]=c;var g=new l.default,m=t.toUpperCase(),y={method:m,headers:f,signal:g.signal};null!==a&&("GET"===m||"HEAD"===m?console.warn("body argument to runAction are ignored with GET or HEAD requests"):y.body=JSON.stringify(a));var v=setTimeout((function(){g.abort()}),e._airtable._requestTimeout);s.default(h,y).then((function(i){if(clearTimeout(v),429!==i.status||e._airtable._noRetryIfRateLimited)i.json().then((function(t){var o=e._checkStatusForError(i.status,t),n={};Object.keys(i).forEach((function(e){n[e]=i[e]})),n.body=t,n.statusCode=i.status,u(o,n,t)})).catch((function(){u(e._checkStatusForError(i.status))}));else{var s=r.default(p);setTimeout((function(){d(e,t,o,n,a,u,p+1)}),s)}})).catch((function(e){clearTimeout(v),u(e)}))}t.exports=d},{"./abort-controller":1,"./exponential_backoff_with_jitter":6,"./fetch":7,"./object_to_query_param_string":11,"./package_version":12}],17:[function(e,t,o){"use strict";var n=this&&this.__assign||function(){return n=Object.assign||function(e){for(var t,o=1,n=arguments.length;o<n;o++)for(var r in t=arguments[o])Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e},n.apply(this,arguments)},r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}},i=r(e("lodash/isPlainObject")),a=r(e("./deprecate")),s=r(e("./query")),l=e("./query_params"),c=r(e("./object_to_query_param_string")),d=r(e("./record")),u=r(e("./callback_to_promise")),p=function(){function e(e,t,o){if(!t&&!o)throw new Error("Table name or table ID is required");this._base=e,this.id=t,this.name=o,this.find=u.default(this._findRecordById,this),this.select=this._selectRecords.bind(this),this.create=u.default(this._createRecords,this),this.update=u.default(this._updateRecords.bind(this,!1),this),this.replace=u.default(this._updateRecords.bind(this,!0),this),this.destroy=u.default(this._destroyRecord,this),this.list=a.default(this._listRecords.bind(this),"table.list","Airtable: `list()` is deprecated. Use `select()` instead."),this.forEach=a.default(this._forEachRecord.bind(this),"table.forEach","Airtable: `forEach()` is deprecated. Use `select()` instead.")}return e.prototype._findRecordById=function(e,t){new d.default(this,e).fetch(t)},e.prototype._selectRecords=function(e){if(void 0===e&&(e={}),arguments.length>1&&console.warn("Airtable: `select` takes only one parameter, but it was given "+arguments.length+" parameters. Use `eachPage` or `firstPage` to fetch records."),i.default(e)){var t=s.default.validateParams(e);if(t.errors.length){var o=t.errors.map((function(e){return"  * "+e}));throw new Error("Airtable: invalid parameters for `select`:\n"+o.join("\n"))}return t.ignoredKeys.length&&console.warn("Airtable: the following parameters to `select` will be ignored: "+t.ignoredKeys.join(", ")),new s.default(this,t.validParams)}throw new Error("Airtable: the parameter for `select` should be a plain object or undefined.")},e.prototype._urlEncodedNameOrId=function(){return this.id||encodeURIComponent(this.name)},e.prototype._createRecords=function(e,t,o){var r,i=this,a=Array.isArray(e);o||(o=t,t={}),r=n(a?{records:e}:{fields:e},t),this._base.runAction("post","/"+this._urlEncodedNameOrId()+"/",{},r,(function(e,t,n){var r;e?o(e):(r=a?n.records.map((function(e){return new d.default(i,e.id,e)})):new d.default(i,n.id,n),o(null,r))}))},e.prototype._updateRecords=function(e,t,o,r,a){var s,l=this;if(Array.isArray(t)){var c=t;s=i.default(o)?o:{},a=r||o;var u=e?"put":"patch",p=n({records:c},s);this._base.runAction(u,"/"+this._urlEncodedNameOrId()+"/",{},p,(function(e,t,o){if(e)a(e);else{var n=o.records.map((function(e){return new d.default(l,e.id,e)}));a(null,n)}}))}else{var h=t,f=o;s=i.default(r)?r:{},a=a||r;var g=new d.default(this,h);e?g.putUpdate(f,s,a):g.patchUpdate(f,s,a)}},e.prototype._destroyRecord=function(e,t){var o=this;if(Array.isArray(e)){var n={records:e};this._base.runAction("delete","/"+this._urlEncodedNameOrId(),n,null,(function(e,n,r){if(e)t(e);else{var i=r.records.map((function(e){var t=e.id;return new d.default(o,t,null)}));t(null,i)}}))}else new d.default(this,e).destroy(t)},e.prototype._listRecords=function(e,t,o,r){var i=this;r||(r=o,o={});var a,s,u="/"+this._urlEncodedNameOrId()+"?"+c.default(o),p={},h=null;if("function"!==typeof o&&"post"===o.method||u.length>l.URL_CHARACTER_LENGTH_LIMIT){a="/"+this._urlEncodedNameOrId()+"/listRecords",h=n(n({},e&&{pageSize:e}),t&&{offset:t}),s="post";for(var f=0,g=Object.keys(o);f<g.length;f++){var m=g[f];l.shouldListRecordsParamBePassedAsParameter(m)?p[m]=o[m]:h[m]=o[m]}}else s="get",a="/"+this._urlEncodedNameOrId()+"/",p=n({limit:e,offset:t},o);this._base.runAction(s,a,p,h,(function(e,t,o){if(e)r(e);else{var n=o.records.map((function(e){return new d.default(i,null,e)}));r(null,n,o.offset)}}))},e.prototype._forEachRecord=function(t,o,n){var r=this;2===arguments.length&&(n=o,o=t,t={});var i=e.__recordsPerPageForIteration||100,a=null,s=function(){r._listRecords(i,a,t,(function(e,t,r){if(e)n(e);else{for(var i=0;i<t.length;i++)o(t[i]);r?(a=r,s()):n()}}))};s()},e}();t.exports=p},{"./callback_to_promise":4,"./deprecate":5,"./object_to_query_param_string":11,"./query":13,"./query_params":14,"./record":15,"lodash/isPlainObject":89}],18:[function(e,t,o){"use strict";function n(e,t){return function(o){return e(o)?{pass:!0}:{pass:!1,error:t}}}n.isOneOf=function(e){return e.includes.bind(e)},n.isArrayOf=function(e){return function(t){return Array.isArray(t)&&t.every(e)}},t.exports=n},{}],19:[function(e,t,o){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function r(e,t){for(var o=0;o<t.length;o++){var n=t[o];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function i(e,t,o){return t&&r(e.prototype,t),o&&r(e,o),e}function a(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&l(e,t)}function s(e){return s=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},s(e)}function l(e,t){return l=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},l(e,t)}function c(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function d(e,t){return!t||"object"!==typeof t&&"function"!==typeof t?c(e):t}function u(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=s(e)););return e}function p(e,t,o){return p="undefined"!==typeof Reflect&&Reflect.get?Reflect.get:function(e,t,o){var n=u(e,t);if(n){var r=Object.getOwnPropertyDescriptor(n,t);return r.get?r.get.call(o):r.value}},p(e,t,o||e)}Object.defineProperty(o,"__esModule",{value:!0});var h=function(){function e(){n(this,e),Object.defineProperty(this,"listeners",{value:{},writable:!0,configurable:!0})}return i(e,[{key:"addEventListener",value:function(e,t){e in this.listeners||(this.listeners[e]=[]),this.listeners[e].push(t)}},{key:"removeEventListener",value:function(e,t){if(e in this.listeners)for(var o=this.listeners[e],n=0,r=o.length;n<r;n++)if(o[n]===t)return void o.splice(n,1)}},{key:"dispatchEvent",value:function(e){var t=this;if(e.type in this.listeners){for(var o=function(o){setTimeout((function(){return o.call(t,e)}))},n=this.listeners[e.type],r=0,i=n.length;r<i;r++)o(n[r]);return!e.defaultPrevented}}}]),e}(),f=function(e){function t(){var e;return n(this,t),(e=d(this,s(t).call(this))).listeners||h.call(c(e)),Object.defineProperty(c(e),"aborted",{value:!1,writable:!0,configurable:!0}),Object.defineProperty(c(e),"onabort",{value:null,writable:!0,configurable:!0}),e}return a(t,e),i(t,[{key:"toString",value:function(){return"[object AbortSignal]"}},{key:"dispatchEvent",value:function(e){"abort"===e.type&&(this.aborted=!0,"function"===typeof this.onabort&&this.onabort.call(this,e)),p(s(t.prototype),"dispatchEvent",this).call(this,e)}}]),t}(h),g=function(){function e(){n(this,e),Object.defineProperty(this,"signal",{value:new f,writable:!0,configurable:!0})}return i(e,[{key:"abort",value:function(){var e;try{e=new Event("abort")}catch(t){"undefined"!==typeof document?document.createEvent?(e=document.createEvent("Event")).initEvent("abort",!1,!1):(e=document.createEventObject()).type="abort":e={type:"abort",bubbles:!1,cancelable:!1}}this.signal.dispatchEvent(e)}},{key:"toString",value:function(){return"[object AbortController]"}}]),e}();function m(e){return e.__FORCE_INSTALL_ABORTCONTROLLER_POLYFILL?(console.log("__FORCE_INSTALL_ABORTCONTROLLER_POLYFILL=true is set, will force install polyfill"),!0):"function"===typeof e.Request&&!e.Request.prototype.hasOwnProperty("signal")||!e.AbortController}function y(e){"function"===typeof e&&(e={fetch:e});var t=e,o=t.fetch,n=t.Request,r=void 0===n?o.Request:n,i=t.AbortController,a=t.__FORCE_INSTALL_ABORTCONTROLLER_POLYFILL,s=void 0!==a&&a;if(!m({fetch:o,Request:r,AbortController:i,__FORCE_INSTALL_ABORTCONTROLLER_POLYFILL:s}))return{fetch:o,Request:l};var l=r;(l&&!l.prototype.hasOwnProperty("signal")||s)&&((l=function(e,t){var o;t&&t.signal&&(o=t.signal,delete t.signal);var n=new r(e,t);return o&&Object.defineProperty(n,"signal",{writable:!1,enumerable:!1,configurable:!0,value:o}),n}).prototype=r.prototype);var c=o;return{fetch:function(e,t){var o=l&&l.prototype.isPrototypeOf(e)?e.signal:t?t.signal:void 0;if(o){var n;try{n=new DOMException("Aborted","AbortError")}catch(i){(n=new Error("Aborted")).name="AbortError"}if(o.aborted)return Promise.reject(n);var r=new Promise((function(e,t){o.addEventListener("abort",(function(){return t(n)}),{once:!0})}));return t&&t.signal&&delete t.signal,Promise.race([r,c(e,t)])}return c(e,t)},Request:l}}"undefined"!==typeof Symbol&&Symbol.toStringTag&&(g.prototype[Symbol.toStringTag]="AbortController",f.prototype[Symbol.toStringTag]="AbortSignal"),o.AbortController=g,o.AbortSignal=f,o.abortableFetch=y},{}],20:[function(e,t,o){},{}],21:[function(e,t,o){var n=e("./_hashClear"),r=e("./_hashDelete"),i=e("./_hashGet"),a=e("./_hashHas"),s=e("./_hashSet");function l(e){var t=-1,o=null==e?0:e.length;for(this.clear();++t<o;){var n=e[t];this.set(n[0],n[1])}}l.prototype.clear=n,l.prototype.delete=r,l.prototype.get=i,l.prototype.has=a,l.prototype.set=s,t.exports=l},{"./_hashClear":46,"./_hashDelete":47,"./_hashGet":48,"./_hashHas":49,"./_hashSet":50}],22:[function(e,t,o){var n=e("./_listCacheClear"),r=e("./_listCacheDelete"),i=e("./_listCacheGet"),a=e("./_listCacheHas"),s=e("./_listCacheSet");function l(e){var t=-1,o=null==e?0:e.length;for(this.clear();++t<o;){var n=e[t];this.set(n[0],n[1])}}l.prototype.clear=n,l.prototype.delete=r,l.prototype.get=i,l.prototype.has=a,l.prototype.set=s,t.exports=l},{"./_listCacheClear":56,"./_listCacheDelete":57,"./_listCacheGet":58,"./_listCacheHas":59,"./_listCacheSet":60}],23:[function(e,t,o){var n=e("./_getNative")(e("./_root"),"Map");t.exports=n},{"./_getNative":42,"./_root":72}],24:[function(e,t,o){var n=e("./_mapCacheClear"),r=e("./_mapCacheDelete"),i=e("./_mapCacheGet"),a=e("./_mapCacheHas"),s=e("./_mapCacheSet");function l(e){var t=-1,o=null==e?0:e.length;for(this.clear();++t<o;){var n=e[t];this.set(n[0],n[1])}}l.prototype.clear=n,l.prototype.delete=r,l.prototype.get=i,l.prototype.has=a,l.prototype.set=s,t.exports=l},{"./_mapCacheClear":61,"./_mapCacheDelete":62,"./_mapCacheGet":63,"./_mapCacheHas":64,"./_mapCacheSet":65}],25:[function(e,t,o){var n=e("./_root").Symbol;t.exports=n},{"./_root":72}],26:[function(e,t,o){var n=e("./_baseTimes"),r=e("./isArguments"),i=e("./isArray"),a=e("./isBuffer"),s=e("./_isIndex"),l=e("./isTypedArray"),c=Object.prototype.hasOwnProperty;function d(e,t){var o=i(e),d=!o&&r(e),u=!o&&!d&&a(e),p=!o&&!d&&!u&&l(e),h=o||d||u||p,f=h?n(e.length,String):[],g=f.length;for(var m in e)!t&&!c.call(e,m)||h&&("length"==m||u&&("offset"==m||"parent"==m)||p&&("buffer"==m||"byteLength"==m||"byteOffset"==m)||s(m,g))||f.push(m);return f}t.exports=d},{"./_baseTimes":35,"./_isIndex":51,"./isArguments":78,"./isArray":79,"./isBuffer":82,"./isTypedArray":92}],27:[function(e,t,o){function n(e,t){for(var o=-1,n=null==e?0:e.length,r=Array(n);++o<n;)r[o]=t(e[o],o,e);return r}t.exports=n},{}],28:[function(e,t,o){var n=e("./eq");function r(e,t){for(var o=e.length;o--;)if(n(e[o][0],t))return o;return-1}t.exports=r},{"./eq":76}],29:[function(e,t,o){var n=e("./_castPath"),r=e("./_toKey");function i(e,t){for(var o=0,i=(t=n(t,e)).length;null!=e&&o<i;)e=e[r(t[o++])];return o&&o==i?e:void 0}t.exports=i},{"./_castPath":38,"./_toKey":74}],30:[function(e,t,o){var n=e("./_Symbol"),r=e("./_getRawTag"),i=e("./_objectToString"),a="[object Null]",s="[object Undefined]",l=n?n.toStringTag:void 0;function c(e){return null==e?void 0===e?s:a:l&&l in Object(e)?r(e):i(e)}t.exports=c},{"./_Symbol":25,"./_getRawTag":44,"./_objectToString":70}],31:[function(e,t,o){var n=e("./_baseGetTag"),r=e("./isObjectLike"),i="[object Arguments]";function a(e){return r(e)&&n(e)==i}t.exports=a},{"./_baseGetTag":30,"./isObjectLike":88}],32:[function(e,t,o){var n=e("./isFunction"),r=e("./_isMasked"),i=e("./isObject"),a=e("./_toSource"),s=/[\\^$.*+?()[\]{}|]/g,l=/^\[object .+?Constructor\]$/,c=Function.prototype,d=Object.prototype,u=c.toString,p=d.hasOwnProperty,h=RegExp("^"+u.call(p).replace(s,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");function f(e){return!(!i(e)||r(e))&&(n(e)?h:l).test(a(e))}t.exports=f},{"./_isMasked":54,"./_toSource":75,"./isFunction":83,"./isObject":87}],33:[function(e,t,o){var n=e("./_baseGetTag"),r=e("./isLength"),i=e("./isObjectLike"),a="[object Arguments]",s="[object Array]",l="[object Boolean]",c="[object Date]",d="[object Error]",u="[object Function]",p="[object Map]",h="[object Number]",f="[object Object]",g="[object RegExp]",m="[object Set]",y="[object String]",v="[object WeakMap]",b="[object ArrayBuffer]",x="[object DataView]",w="[object Float64Array]",C="[object Int8Array]",_="[object Int16Array]",S="[object Int32Array]",E="[object Uint8Array]",k="[object Uint8ClampedArray]",j="[object Uint16Array]",A="[object Uint32Array]",R={};function O(e){return i(e)&&r(e.length)&&!!R[n(e)]}R["[object Float32Array]"]=R[w]=R[C]=R[_]=R[S]=R[E]=R[k]=R[j]=R[A]=!0,R[a]=R[s]=R[b]=R[l]=R[x]=R[c]=R[d]=R[u]=R[p]=R[h]=R[f]=R[g]=R[m]=R[y]=R[v]=!1,t.exports=O},{"./_baseGetTag":30,"./isLength":84,"./isObjectLike":88}],34:[function(e,t,o){var n=e("./_isPrototype"),r=e("./_nativeKeys"),i=Object.prototype.hasOwnProperty;function a(e){if(!n(e))return r(e);var t=[];for(var o in Object(e))i.call(e,o)&&"constructor"!=o&&t.push(o);return t}t.exports=a},{"./_isPrototype":55,"./_nativeKeys":68}],35:[function(e,t,o){function n(e,t){for(var o=-1,n=Array(e);++o<e;)n[o]=t(o);return n}t.exports=n},{}],36:[function(e,t,o){var n=e("./_Symbol"),r=e("./_arrayMap"),i=e("./isArray"),a=e("./isSymbol"),s=1/0,l=n?n.prototype:void 0,c=l?l.toString:void 0;function d(e){if("string"==typeof e)return e;if(i(e))return r(e,d)+"";if(a(e))return c?c.call(e):"";var t=e+"";return"0"==t&&1/e==-s?"-0":t}t.exports=d},{"./_Symbol":25,"./_arrayMap":27,"./isArray":79,"./isSymbol":91}],37:[function(e,t,o){function n(e){return function(t){return e(t)}}t.exports=n},{}],38:[function(e,t,o){var n=e("./isArray"),r=e("./_isKey"),i=e("./_stringToPath"),a=e("./toString");function s(e,t){return n(e)?e:r(e,t)?[e]:i(a(e))}t.exports=s},{"./_isKey":52,"./_stringToPath":73,"./isArray":79,"./toString":96}],39:[function(e,t,o){var n=e("./_root")["__core-js_shared__"];t.exports=n},{"./_root":72}],40:[function(e,t,n){(function(e){var o="object"==typeof e&&e&&e.Object===Object&&e;t.exports=o}).call(this,"undefined"!==typeof o.g?o.g:"undefined"!==typeof self?self:"undefined"!==typeof window?window:{})},{}],41:[function(e,t,o){var n=e("./_isKeyable");function r(e,t){var o=e.__data__;return n(t)?o["string"==typeof t?"string":"hash"]:o.map}t.exports=r},{"./_isKeyable":53}],42:[function(e,t,o){var n=e("./_baseIsNative"),r=e("./_getValue");function i(e,t){var o=r(e,t);return n(o)?o:void 0}t.exports=i},{"./_baseIsNative":32,"./_getValue":45}],43:[function(e,t,o){var n=e("./_overArg")(Object.getPrototypeOf,Object);t.exports=n},{"./_overArg":71}],44:[function(e,t,o){var n=e("./_Symbol"),r=Object.prototype,i=r.hasOwnProperty,a=r.toString,s=n?n.toStringTag:void 0;function l(e){var t=i.call(e,s),o=e[s];try{e[s]=void 0;var n=!0}catch(l){}var r=a.call(e);return n&&(t?e[s]=o:delete e[s]),r}t.exports=l},{"./_Symbol":25}],45:[function(e,t,o){function n(e,t){return null==e?void 0:e[t]}t.exports=n},{}],46:[function(e,t,o){var n=e("./_nativeCreate");function r(){this.__data__=n?n(null):{},this.size=0}t.exports=r},{"./_nativeCreate":67}],47:[function(e,t,o){function n(e){var t=this.has(e)&&delete this.__data__[e];return this.size-=t?1:0,t}t.exports=n},{}],48:[function(e,t,o){var n=e("./_nativeCreate"),r="__lodash_hash_undefined__",i=Object.prototype.hasOwnProperty;function a(e){var t=this.__data__;if(n){var o=t[e];return o===r?void 0:o}return i.call(t,e)?t[e]:void 0}t.exports=a},{"./_nativeCreate":67}],49:[function(e,t,o){var n=e("./_nativeCreate"),r=Object.prototype.hasOwnProperty;function i(e){var t=this.__data__;return n?void 0!==t[e]:r.call(t,e)}t.exports=i},{"./_nativeCreate":67}],50:[function(e,t,o){var n=e("./_nativeCreate"),r="__lodash_hash_undefined__";function i(e,t){var o=this.__data__;return this.size+=this.has(e)?0:1,o[e]=n&&void 0===t?r:t,this}t.exports=i},{"./_nativeCreate":67}],51:[function(e,t,o){var n=9007199254740991,r=/^(?:0|[1-9]\d*)$/;function i(e,t){var o=typeof e;return!!(t=null==t?n:t)&&("number"==o||"symbol"!=o&&r.test(e))&&e>-1&&e%1==0&&e<t}t.exports=i},{}],52:[function(e,t,o){var n=e("./isArray"),r=e("./isSymbol"),i=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,a=/^\w*$/;function s(e,t){if(n(e))return!1;var o=typeof e;return!("number"!=o&&"symbol"!=o&&"boolean"!=o&&null!=e&&!r(e))||a.test(e)||!i.test(e)||null!=t&&e in Object(t)}t.exports=s},{"./isArray":79,"./isSymbol":91}],53:[function(e,t,o){function n(e){var t=typeof e;return"string"==t||"number"==t||"symbol"==t||"boolean"==t?"__proto__"!==e:null===e}t.exports=n},{}],54:[function(e,t,o){var n=e("./_coreJsData"),r=function(){var e=/[^.]+$/.exec(n&&n.keys&&n.keys.IE_PROTO||"");return e?"Symbol(src)_1."+e:""}();function i(e){return!!r&&r in e}t.exports=i},{"./_coreJsData":39}],55:[function(e,t,o){var n=Object.prototype;function r(e){var t=e&&e.constructor;return e===("function"==typeof t&&t.prototype||n)}t.exports=r},{}],56:[function(e,t,o){function n(){this.__data__=[],this.size=0}t.exports=n},{}],57:[function(e,t,o){var n=e("./_assocIndexOf"),r=Array.prototype.splice;function i(e){var t=this.__data__,o=n(t,e);return!(o<0)&&(o==t.length-1?t.pop():r.call(t,o,1),--this.size,!0)}t.exports=i},{"./_assocIndexOf":28}],58:[function(e,t,o){var n=e("./_assocIndexOf");function r(e){var t=this.__data__,o=n(t,e);return o<0?void 0:t[o][1]}t.exports=r},{"./_assocIndexOf":28}],59:[function(e,t,o){var n=e("./_assocIndexOf");function r(e){return n(this.__data__,e)>-1}t.exports=r},{"./_assocIndexOf":28}],60:[function(e,t,o){var n=e("./_assocIndexOf");function r(e,t){var o=this.__data__,r=n(o,e);return r<0?(++this.size,o.push([e,t])):o[r][1]=t,this}t.exports=r},{"./_assocIndexOf":28}],61:[function(e,t,o){var n=e("./_Hash"),r=e("./_ListCache"),i=e("./_Map");function a(){this.size=0,this.__data__={hash:new n,map:new(i||r),string:new n}}t.exports=a},{"./_Hash":21,"./_ListCache":22,"./_Map":23}],62:[function(e,t,o){var n=e("./_getMapData");function r(e){var t=n(this,e).delete(e);return this.size-=t?1:0,t}t.exports=r},{"./_getMapData":41}],63:[function(e,t,o){var n=e("./_getMapData");function r(e){return n(this,e).get(e)}t.exports=r},{"./_getMapData":41}],64:[function(e,t,o){var n=e("./_getMapData");function r(e){return n(this,e).has(e)}t.exports=r},{"./_getMapData":41}],65:[function(e,t,o){var n=e("./_getMapData");function r(e,t){var o=n(this,e),r=o.size;return o.set(e,t),this.size+=o.size==r?0:1,this}t.exports=r},{"./_getMapData":41}],66:[function(e,t,o){var n=e("./memoize"),r=500;function i(e){var t=n(e,(function(e){return o.size===r&&o.clear(),e})),o=t.cache;return t}t.exports=i},{"./memoize":94}],67:[function(e,t,o){var n=e("./_getNative")(Object,"create");t.exports=n},{"./_getNative":42}],68:[function(e,t,o){var n=e("./_overArg")(Object.keys,Object);t.exports=n},{"./_overArg":71}],69:[function(e,t,o){var n=e("./_freeGlobal"),r="object"==typeof o&&o&&!o.nodeType&&o,i=r&&"object"==typeof t&&t&&!t.nodeType&&t,a=i&&i.exports===r&&n.process,s=function(){try{var e=i&&i.require&&i.require("util").types;return e||a&&a.binding&&a.binding("util")}catch(t){}}();t.exports=s},{"./_freeGlobal":40}],70:[function(e,t,o){var n=Object.prototype.toString;function r(e){return n.call(e)}t.exports=r},{}],71:[function(e,t,o){function n(e,t){return function(o){return e(t(o))}}t.exports=n},{}],72:[function(e,t,o){var n=e("./_freeGlobal"),r="object"==typeof self&&self&&self.Object===Object&&self,i=n||r||Function("return this")();t.exports=i},{"./_freeGlobal":40}],73:[function(e,t,o){var n=e("./_memoizeCapped"),r=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,i=/\\(\\)?/g,a=n((function(e){var t=[];return 46===e.charCodeAt(0)&&t.push(""),e.replace(r,(function(e,o,n,r){t.push(n?r.replace(i,"$1"):o||e)})),t}));t.exports=a},{"./_memoizeCapped":66}],74:[function(e,t,o){var n=e("./isSymbol"),r=1/0;function i(e){if("string"==typeof e||n(e))return e;var t=e+"";return"0"==t&&1/e==-r?"-0":t}t.exports=i},{"./isSymbol":91}],75:[function(e,t,o){var n=Function.prototype.toString;function r(e){if(null!=e){try{return n.call(e)}catch(t){}try{return e+""}catch(t){}}return""}t.exports=r},{}],76:[function(e,t,o){function n(e,t){return e===t||e!==e&&t!==t}t.exports=n},{}],77:[function(e,t,o){var n=e("./_baseGet");function r(e,t,o){var r=null==e?void 0:n(e,t);return void 0===r?o:r}t.exports=r},{"./_baseGet":29}],78:[function(e,t,o){var n=e("./_baseIsArguments"),r=e("./isObjectLike"),i=Object.prototype,a=i.hasOwnProperty,s=i.propertyIsEnumerable,l=n(function(){return arguments}())?n:function(e){return r(e)&&a.call(e,"callee")&&!s.call(e,"callee")};t.exports=l},{"./_baseIsArguments":31,"./isObjectLike":88}],79:[function(e,t,o){var n=Array.isArray;t.exports=n},{}],80:[function(e,t,o){var n=e("./isFunction"),r=e("./isLength");function i(e){return null!=e&&r(e.length)&&!n(e)}t.exports=i},{"./isFunction":83,"./isLength":84}],81:[function(e,t,o){var n=e("./_baseGetTag"),r=e("./isObjectLike"),i="[object Boolean]";function a(e){return!0===e||!1===e||r(e)&&n(e)==i}t.exports=a},{"./_baseGetTag":30,"./isObjectLike":88}],82:[function(e,t,o){var n=e("./_root"),r=e("./stubFalse"),i="object"==typeof o&&o&&!o.nodeType&&o,a=i&&"object"==typeof t&&t&&!t.nodeType&&t,s=a&&a.exports===i?n.Buffer:void 0,l=(s?s.isBuffer:void 0)||r;t.exports=l},{"./_root":72,"./stubFalse":95}],83:[function(e,t,o){var n=e("./_baseGetTag"),r=e("./isObject"),i="[object AsyncFunction]",a="[object Function]",s="[object GeneratorFunction]",l="[object Proxy]";function c(e){if(!r(e))return!1;var t=n(e);return t==a||t==s||t==i||t==l}t.exports=c},{"./_baseGetTag":30,"./isObject":87}],84:[function(e,t,o){var n=9007199254740991;function r(e){return"number"==typeof e&&e>-1&&e%1==0&&e<=n}t.exports=r},{}],85:[function(e,t,o){function n(e){return null==e}t.exports=n},{}],86:[function(e,t,o){var n=e("./_baseGetTag"),r=e("./isObjectLike"),i="[object Number]";function a(e){return"number"==typeof e||r(e)&&n(e)==i}t.exports=a},{"./_baseGetTag":30,"./isObjectLike":88}],87:[function(e,t,o){function n(e){var t=typeof e;return null!=e&&("object"==t||"function"==t)}t.exports=n},{}],88:[function(e,t,o){function n(e){return null!=e&&"object"==typeof e}t.exports=n},{}],89:[function(e,t,o){var n=e("./_baseGetTag"),r=e("./_getPrototype"),i=e("./isObjectLike"),a="[object Object]",s=Function.prototype,l=Object.prototype,c=s.toString,d=l.hasOwnProperty,u=c.call(Object);function p(e){if(!i(e)||n(e)!=a)return!1;var t=r(e);if(null===t)return!0;var o=d.call(t,"constructor")&&t.constructor;return"function"==typeof o&&o instanceof o&&c.call(o)==u}t.exports=p},{"./_baseGetTag":30,"./_getPrototype":43,"./isObjectLike":88}],90:[function(e,t,o){var n=e("./_baseGetTag"),r=e("./isArray"),i=e("./isObjectLike"),a="[object String]";function s(e){return"string"==typeof e||!r(e)&&i(e)&&n(e)==a}t.exports=s},{"./_baseGetTag":30,"./isArray":79,"./isObjectLike":88}],91:[function(e,t,o){var n=e("./_baseGetTag"),r=e("./isObjectLike"),i="[object Symbol]";function a(e){return"symbol"==typeof e||r(e)&&n(e)==i}t.exports=a},{"./_baseGetTag":30,"./isObjectLike":88}],92:[function(e,t,o){var n=e("./_baseIsTypedArray"),r=e("./_baseUnary"),i=e("./_nodeUtil"),a=i&&i.isTypedArray,s=a?r(a):n;t.exports=s},{"./_baseIsTypedArray":33,"./_baseUnary":37,"./_nodeUtil":69}],93:[function(e,t,o){var n=e("./_arrayLikeKeys"),r=e("./_baseKeys"),i=e("./isArrayLike");function a(e){return i(e)?n(e):r(e)}t.exports=a},{"./_arrayLikeKeys":26,"./_baseKeys":34,"./isArrayLike":80}],94:[function(e,t,o){var n=e("./_MapCache"),r="Expected a function";function i(e,t){if("function"!=typeof e||null!=t&&"function"!=typeof t)throw new TypeError(r);var o=function(){var n=arguments,r=t?t.apply(this,n):n[0],i=o.cache;if(i.has(r))return i.get(r);var a=e.apply(this,n);return o.cache=i.set(r,a)||i,a};return o.cache=new(i.Cache||n),o}i.Cache=n,t.exports=i},{"./_MapCache":24}],95:[function(e,t,o){function n(){return!1}t.exports=n},{}],96:[function(e,t,o){var n=e("./_baseToString");function r(e){return null==e?"":n(e)}t.exports=r},{"./_baseToString":36}],airtable:[function(e,t,o){"use strict";var n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}},r=n(e("./base")),i=n(e("./record")),a=n(e("./table")),s=n(e("./airtable_error")),l=function(){function e(t){void 0===t&&(t={});var o=e.default_config(),n=t.apiVersion||e.apiVersion||o.apiVersion;if(Object.defineProperties(this,{_apiKey:{value:t.apiKey||e.apiKey||o.apiKey},_apiVersion:{value:n},_apiVersionMajor:{value:n.split(".")[0]},_customHeaders:{value:t.customHeaders||{}},_endpointUrl:{value:t.endpointUrl||e.endpointUrl||o.endpointUrl},_noRetryIfRateLimited:{value:t.noRetryIfRateLimited||e.noRetryIfRateLimited||o.noRetryIfRateLimited},_requestTimeout:{value:t.requestTimeout||e.requestTimeout||o.requestTimeout}}),!this._apiKey)throw new Error("An API key is required to connect to Airtable")}return e.prototype.base=function(e){return r.default.createFunctor(this,e)},e.default_config=function(){return{endpointUrl:"https://api.airtable.com",apiVersion:"0.1.0",apiKey:"",noRetryIfRateLimited:!1,requestTimeout:3e5}},e.configure=function(t){var o=t.apiKey,n=t.endpointUrl,r=t.apiVersion,i=t.noRetryIfRateLimited,a=t.requestTimeout;e.apiKey=o,e.endpointUrl=n,e.apiVersion=r,e.noRetryIfRateLimited=i,e.requestTimeout=a},e.base=function(t){return(new e).base(t)},e.Base=r.default,e.Record=i.default,e.Table=a.default,e.Error=s.default,e}();t.exports=l},{"./airtable_error":2,"./base":3,"./record":15,"./table":17}]},{},["airtable"])("airtable")},933:(e,t,o)=>{"use strict";o.r(t),o.d(t,{default:()=>w});var n=o(5043),r=o(3216),i=o(1529),a=o(5315),s=(o(3768),o(1009)),l=o(579);const c=i.Ay.div`
  padding: 50px 40px 20px 20px;
  max-width: 1400px;
  margin: 0 auto;
`,d=i.Ay.div`
  display: flex;
  justify-content: flex-start;
  align-items: center;
  margin-bottom: 20px;
  padding-bottom: 20px;
  border-bottom: 1px solid #333;
`,u=(i.Ay.h1`
  color: #00ff00;
  margin: 0;
  font-family: 'Courier New', monospace;
`,i.Ay.button`
  background-color: #222;
  color: #00ff00;
  border: 1px solid #00ff00;
  padding: 8px 12px;
  border-radius: 4px;
  cursor: pointer;
  display: inline-flex;
  align-items: center;
  gap: 6px;
  margin-left: 8px;
  
  &:hover {
    background-color: #333;
  }
`),p=i.Ay.div`
  display: flex;
  flex-direction: column;
  align-items: center;
  justify-content: center;
  height: 70vh;
  color: #00ff00;
`,h=i.Ay.div`
  background-color: rgba(255, 70, 70, 0.2);
  border: 1px solid #ff4646;
  color: #ff9999;
  padding: 12px;
  border-radius: 4px;
  margin-bottom: 20px;
  display: flex;
  align-items: center;
  gap: 10px;
`,f=i.Ay.div`
  display: grid;
  grid-template-columns: 1fr;
  gap: 15px;
`,g=i.Ay.div`
  border: 1px solid #333;
  border-radius: 8px;
  padding: 15px;
  background-color: #222;
  display: flex;
  justify-content: space-between;
  align-items: center;
  cursor: pointer;
  
  &:hover {
    background-color: #333;
  }
`,m=i.Ay.div`
  flex: 1;
`,y=i.Ay.h3`
  margin: 0 0 8px 0;
  color: #00ff00;
`,v=i.Ay.div`
  color: #999;
  font-size: 0.85rem;
`,b=i.Ay.div`
  margin-top: 5px;
  font-style: italic;
  color: #ccc;
`,x=i.Ay.div`
  text-align: center;
  padding: 40px;
  color: #999;
  font-style: italic;
`,w=()=>{const e=(0,r.Zp)(),[t,o]=(0,n.useState)([]),[i,w]=(0,n.useState)(!0),[C,_]=(0,n.useState)(null);(0,n.useEffect)((()=>{S()}),[]);const S=async()=>{w(!0),_(null);try{const{data:e,error:t}=await a.supabase.from("contact_duplicates").select("\n          duplicate_id,\n          primary_contact_id,\n          duplicate_contact_id,\n          detected_at,\n          notes,\n          status,\n          primary_contact:contacts!primary_contact_id(first_name, last_name),\n          duplicate_contact:contacts!duplicate_contact_id(first_name, last_name)\n        ").order("detected_at",{ascending:!1});if(t)throw t;const n=e?e.filter((e=>{const t=e.primary_contact||{},o=e.duplicate_contact||{};return t.first_name&&o.first_name&&t.last_name&&o.last_name&&t.first_name.toLowerCase()===o.first_name.toLowerCase()&&t.last_name.toLowerCase()===o.last_name.toLowerCase()})):[];o(n)}catch(e){console.error("Error loading duplicates:",e),_("Failed to load duplicate contacts. Please try again.")}finally{w(!1)}},E=t=>{sessionStorage.setItem("workflow_contact_id",t.primary_contact_id),e(`/contacts/workflow/${t.primary_contact_id}`)};return i?(0,l.jsx)(c,{children:(0,l.jsx)(p,{children:(0,l.jsx)("div",{children:"Loading duplicates..."})})}):(0,l.jsxs)(c,{children:[(0,l.jsx)(d,{children:(0,l.jsxs)(u,{onClick:S,children:[(0,l.jsx)(s.jTZ,{})," Refresh"]})}),C&&(0,l.jsxs)(h,{children:[(0,l.jsx)(s.eHT,{}),(0,l.jsx)("div",{children:C})]}),0===t.length?(0,l.jsx)(x,{children:"No duplicate contacts found"}):(0,l.jsx)(f,{children:t.map((e=>{var t,o,n,r,i;return(0,l.jsxs)(g,{onClick:()=>E(e),children:[(0,l.jsxs)(m,{children:[(0,l.jsxs)(y,{children:[(null===(t=e.primary_contact)||void 0===t?void 0:t.first_name)||"Unknown"," ",(null===(o=e.primary_contact)||void 0===o?void 0:o.last_name)||""," & ",(null===(n=e.duplicate_contact)||void 0===n?void 0:n.first_name)||"Unknown"," ",(null===(r=e.duplicate_contact)||void 0===r?void 0:r.last_name)||""]}),(0,l.jsxs)(v,{children:["Detected: ",(i=e.detected_at,i?new Date(i).toLocaleString():"-")]}),e.notes&&(0,l.jsx)(b,{children:e.notes})]}),(0,l.jsxs)(u,{onClick:t=>{t.stopPropagation(),E(e)},children:[(0,l.jsx)(s.SG1,{})," Edit and Match"]})]},e.duplicate_id)}))})]})}},954:(e,t,o)=>{"use strict";o.r(t),o.d(t,{default:()=>P});var n=o(5043),r=o(3216),i=o(1529),a=o(5315),s=o(8136),l=o(1009),c=o(2963),d=o.n(c),u=(o(3768),o(579));const p=i.Ay.div`
  padding: 10px 0 0 0; /* Add just a bit of top padding */
  min-height: 100vh; /* Full viewport height */
  height: auto;
  display: flex;
  flex-direction: column;
  width: 100%;
  
  .clickable-cell {
    cursor: pointer;
  }
  
  .ag-row {
    cursor: pointer;
  }
  
  .action-cell-no-click {
    z-index: 5;
  }
`,h=(i.Ay.h1`
  color: #00ff00;
  margin-bottom: 20px;
  font-family: 'Courier New', monospace;
`,i.Ay.div`
  color: #ff3333;
  background-color: #330000;
  padding: 15px;
  border-radius: 4px;
  margin-bottom: 20px;
`),f=i.Ay.div`
  color: #00ff00;
  text-align: center;
  padding: 40px;
  font-family: monospace;
  display: flex;
  flex-direction: column;
  align-items: center;
  justify-content: center;
  height: 400px;
`,g=i.Ay.div`
  width: 300px;
  height: 8px;
  background-color: #111;
  margin: 20px 0;
  border-radius: 4px;
  overflow: hidden;
  position: relative;
  box-shadow: 0 0 10px rgba(0, 255, 0, 0.2);
  
  &:before {
    content: "";
    position: absolute;
    top: 0;
    left: 0;
    height: 100%;
    width: 30%;
    background-color: #00ff00;
    animation: pulse 1.5s ease-in-out infinite;
    box-shadow: 0 0 20px #00ff00;
    border-radius: 4px;
  }
  
  @keyframes pulse {
    0% {
      left: -30%;
      opacity: 0.8;
    }
    100% {
      left: 100%;
      opacity: 0.2;
    }
  }
`,m=i.Ay.div`
  margin-top: 15px;
  color: #00ff00;
  text-shadow: 0 0 5px rgba(0, 255, 0, 0.5);
  letter-spacing: 1px;
  font-size: 16px;
  opacity: 0.9;
  animation: blink 1.5s ease-in-out infinite alternate;
  
  @keyframes blink {
    from { opacity: 0.6; }
    to { opacity: 1; }
  }
`,y=i.Ay.div`
  font-family: 'Courier New', monospace;
  font-size: 14px;
  color: #00ff00;
  text-align: center;
  margin-top: 30px;
  height: 100px;
  width: 300px;
  overflow: hidden;
  position: relative;
  
  &:after {
    content: "01001100 01101111 01100001 01100100 01101001 01101110 01100111 00100000 01000011 01101111 01101110 01110100 01100001 01100011 01110100 01110011 00101110 00101110 00101110";
    position: absolute;
    top: 0;
    left: 0;
    height: 100%;
    width: 100%;
    background: linear-gradient(to bottom, transparent, #000 80%);
    display: flex;
    flex-wrap: wrap;
    justify-content: center;
    opacity: 0.7;
    text-shadow: 0 0 5px #00ff00;
    animation: matrix 5s linear infinite;
  }
  
  @keyframes matrix {
    0% { transform: translateY(-60px); }
    100% { transform: translateY(60px); }
  }
`,v=(i.Ay.span`
  display: inline-block;
  background-color: ${e=>e.bg||"#222"};
  color: ${e=>e.color||"#00ff00"};
  border: 1px solid ${e=>e.borderColor||"#00ff00"};
  padding: 2px 6px;
  margin-right: 3px;
  border-radius: 4px;
  font-size: 11px;
`,i.Ay.button`
  background-color: ${e=>e.bg||"#222"};
  color: ${e=>e.color||"#00ff00"};
  border: 1px solid ${e=>e.borderColor||"#00ff00"};
  padding: 6px 10px;
  margin: 0 4px;
  border-radius: 4px;
  font-size: 0.75rem;
  display: inline-flex;
  align-items: center;
  gap: 4px;
  cursor: pointer;
  transition: all 0.2s;
  
  &:hover {
    opacity: 0.8;
    background-color: ${e=>e.hoverBg||"#333"};
  }
`,i.Ay.div`
  display: flex;
  justify-content: space-between;
  align-items: center;
  padding-bottom: 15px;
  margin-bottom: 20px;
  border-bottom: 1px solid #333;

  h2 {
    color: #00ff00;
    margin: 0;
    font-size: 1.2rem;
    font-family: 'Courier New', monospace;
  }
`),b=i.Ay.button`
  background: none;
  border: none;
  color: #ff5555;
  font-size: 1.2rem;
  cursor: pointer;
  display: flex;
  align-items: center;
  justify-content: center;
  
  &:hover {
    color: #ff0000;
  }
`,x=i.Ay.div`
  margin-bottom: 20px;
  color: #cccccc;
  font-size: 0.9rem;
`,w=(i.Ay.div`
  background-color: #1a1a1a;
  padding: 10px 15px;
  border-radius: 4px;
  margin-bottom: 20px;
  border: 1px solid #333;
`,i.Ay.div`
  font-size: 0.85rem;
  color: #00ff00;
  margin-bottom: 10px;
  font-weight: bold;
  display: flex;
  align-items: center;
  gap: 6px;
  
  svg {
    font-size: 16px;
  }
`,i.Ay.div`
  margin-bottom: 25px;
`),C=i.Ay.div`
  display: grid;
  grid-template-columns: repeat(3, 1fr);
  gap: 10px;
  margin-top: 10px;
  
  @media (max-width: 768px) {
    grid-template-columns: repeat(2, 1fr);
  }
  
  @media (max-width: 480px) {
    grid-template-columns: 1fr;
  }
`,_=i.Ay.div`
  display: flex;
  align-items: center;
  color: #cccccc;
`,S=i.Ay.input`
  margin-right: 8px;
  cursor: pointer;
  width: 16px;
  height: 16px;
  appearance: none;
  border: 1px solid #00ff00;
  background: #222;
  border-radius: 3px;
  position: relative;
  
  &:checked {
    background: #00ff00;
    
    &:after {
      content: '';
      position: absolute;
      left: 5px;
      top: 2px;
      width: 4px;
      height: 8px;
      border: solid #000;
      border-width: 0 2px 2px 0;
      transform: rotate(45deg);
    }
  }
`,E=i.Ay.div`
  background-color: #1a1a1a;
  padding: 15px;
  border-radius: 4px;
  margin-bottom: 20px;
  border: 1px solid #333;
`,k=i.Ay.div`
  margin-bottom: 10px;
  
  &:last-child {
    margin-bottom: 0;
  }
`,j=i.Ay.span`
  color: #999;
  margin-right: 10px;
  font-size: 0.8rem;
`,A=i.Ay.span`
  color: #cccccc;
  font-weight: normal;
`,R=(i.Ay.div`
  display: flex;
  align-items: center;
  gap: 10px;
  background-color: rgba(255, 85, 85, 0.2);
  border: 1px solid #ff5555;
  color: #ff9999;
  padding: 10px 15px;
  border-radius: 4px;
  margin-bottom: 20px;
  
  svg {
    color: #ff5555;
    font-size: 1.2rem;
    flex-shrink: 0;
  }
`,i.Ay.div`
  display: flex;
  justify-content: flex-end;
  gap: 15px;
  margin-top: 30px;
`),O=i.Ay.button`
  background-color: #ff5555;
  color: white;
  border: none;
  padding: 10px 20px;
  border-radius: 4px;
  font-weight: bold;
  cursor: pointer;
  display: flex;
  align-items: center;
  gap: 8px;
  
  &:hover {
    background-color: #ff3333;
  }
  
  &:disabled {
    background-color: #772727;
    cursor: not-allowed;
    opacity: 0.7;
  }
`,T=i.Ay.button`
  background-color: transparent;
  color: #cccccc;
  border: 1px solid #555;
  padding: 10px 20px;
  border-radius: 4px;
  cursor: pointer;
  display: flex;
  align-items: center;
  gap: 8px;
  
  &:hover {
    background-color: #333;
  }
`,D=e=>{const t=n.useRef(null),o=n.useRef(null),r=n.useRef(null);n.useEffect((()=>{const n=t.current,i=o.current,a=r.current;if(!n||!i||!a)return;const s=t=>(t.stopPropagation(),t.preventDefault(),t.stopImmediatePropagation(),setTimeout((()=>{e.onSpam&&e.onSpam(e.data)}),10),!1),l=t=>(t.stopPropagation(),t.preventDefault(),t.stopImmediatePropagation(),setTimeout((()=>{e.onSkip&&e.onSkip(e.data)}),10),!1),c=t=>(t.stopPropagation(),t.preventDefault(),t.stopImmediatePropagation(),setTimeout((()=>{e.onAddToCRM&&e.onAddToCRM(e.data)}),10),!1);return n.addEventListener("click",s,!0),i.addEventListener("click",l,!0),a.addEventListener("click",c,!0),()=>{n.removeEventListener("click",s,!0),i.removeEventListener("click",l,!0),a.removeEventListener("click",c,!0)}}),[e]);const i={backgroundColor:"#222",padding:"3px 6px",borderRadius:"4px",fontSize:"0.7rem",display:"inline-flex",alignItems:"center",justifyContent:"center",gap:"3px",cursor:"pointer",transition:"all 0.2s",whiteSpace:"nowrap",height:"18px",lineHeight:"1",boxSizing:"border-box",margin:"0 3px"};return(0,u.jsxs)("div",{className:"action-buttons-container",style:{display:"flex",justifyContent:"space-between",alignItems:"center",height:"100%",width:"100%",padding:"8px 0 0 0",margin:0,boxSizing:"border-box"},onClick:e=>{e.stopPropagation(),e.preventDefault()},children:[(0,u.jsxs)("div",{ref:t,style:{...i,color:"#ff5555",border:"1px solid #ff5555"},children:[(0,u.jsx)(l.IXo,{size:10})," Spam"]}),(0,u.jsxs)("div",{ref:o,style:{...i,color:"#ff9900",border:"1px solid #ff9900"},children:[(0,u.jsx)(l.yGN,{size:10})," Skip"]}),(0,u.jsxs)("div",{ref:r,style:{...i,color:"#55ff55",border:"1px solid #55ff55"},children:[(0,u.jsx)(l.A3x,{size:10})," Add to CRM"]})]})};d().setAppElement("#root");const P=()=>{const[e,t]=(0,n.useState)([]),[o,i]=(0,n.useState)(!0),[c,P]=(0,n.useState)(null),[N,I]=(0,n.useState)(null),[M,L]=(0,n.useState)(!1),[F,G]=(0,n.useState)(!1),[z,H]=(0,n.useState)(!1),[B,V]=(0,n.useState)(null),[$,U]=(0,n.useState)(null),[W,q]=(0,n.useState)({chatCount:0,contactChatsCount:0,interactionsCount:0,emailsCount:0,emailParticipantsCount:0,emailThreadsCount:0,tagsCount:0,citiesCount:0,companiesCount:0,notesCount:0,attachmentsCount:0,contactEmailsCount:0,contactMobilesCount:0,dealsCount:0,meetingsCount:0,investmentsCount:0,kitCount:0,lastInteraction:null}),[K,Y]=(0,n.useState)({deleteChat:!0,deleteContactChats:!0,deleteInteractions:!0,deleteEmails:!0,deleteEmailParticipants:!0,deleteEmailThreads:!0,deleteTags:!0,deleteCities:!0,deleteCompanies:!0,deleteNotes:!0,deleteAttachments:!0,deleteContactEmails:!0,deleteContactMobiles:!0,deleteDeals:!0,deleteMeetings:!0,deleteInvestments:!0,deleteKit:!0,addToSpam:!0,addMobileToSpam:!0}),[J,X]=(0,n.useState)(!1),Q=(0,r.Zp)(),Z=e=>{const{name:t,checked:o}=e.target;Y((e=>({...e,[t]:o})))},ee=e=>{(async e=>{V(e);try{const[t,o,n,r,i,s,l,c,d,u,p,h,f,g,m,y,v,b]=await Promise.all([a.supabase.from("chat").select("id",{count:"exact",head:!0}).eq("contact_id",e.contact_id),a.supabase.from("contact_chats").select("id",{count:"exact",head:!0}).eq("contact_id",e.contact_id),a.supabase.from("interactions").select("interaction_id",{count:"exact",head:!0}).eq("contact_id",e.contact_id),a.supabase.from("emails").select("email_id",{count:"exact",head:!0}).eq("sender_contact_id",e.contact_id),a.supabase.from("email_participants").select("participant_id",{count:"exact",head:!0}).eq("contact_id",e.contact_id),a.supabase.from("contact_email_threads").select("email_thread_id",{count:"exact",head:!0}).eq("contact_id",e.contact_id),a.supabase.from("contact_tags").select("entry_id",{count:"exact",head:!0}).eq("contact_id",e.contact_id),a.supabase.from("contact_cities").select("entry_id",{count:"exact",head:!0}).eq("contact_id",e.contact_id),a.supabase.from("contact_companies").select("contact_companies_id",{count:"exact",head:!0}).eq("contact_id",e.contact_id),a.supabase.from("notes_contacts").select("note_contact_id",{count:"exact",head:!0}).eq("contact_id",e.contact_id),a.supabase.from("attachments").select("attachment_id",{count:"exact",head:!0}).eq("contact_id",e.contact_id),a.supabase.from("contact_emails").select("email_id",{count:"exact",head:!0}).eq("contact_id",e.contact_id),a.supabase.from("contact_mobiles").select("mobile_id",{count:"exact",head:!0}).eq("contact_id",e.contact_id),a.supabase.from("deals_contacts").select("deals_contacts_id",{count:"exact",head:!0}).eq("contact_id",e.contact_id),a.supabase.from("meeting_contacts").select("meeting_contact_id",{count:"exact",head:!0}).eq("contact_id",e.contact_id),a.supabase.from("investments_contacts").select("investments_contacts_id",{count:"exact",head:!0}).eq("contact_id",e.contact_id),a.supabase.from("keep_in_touch").select("id",{count:"exact",head:!0}).eq("contact_id",e.contact_id),a.supabase.from("interactions").select("interaction_id, interaction_type, direction, interaction_date, summary").eq("contact_id",e.contact_id).order("interaction_date",{ascending:!1}).limit(1)]);q({chatCount:t.count||0,contactChatsCount:o.count||0,interactionsCount:n.count||0,emailsCount:r.count||0,emailParticipantsCount:i.count||0,emailThreadsCount:s.count||0,tagsCount:l.count||0,citiesCount:c.count||0,companiesCount:d.count||0,notesCount:u.count||0,attachmentsCount:p.count||0,contactEmailsCount:h.count||0,contactMobilesCount:f.count||0,dealsCount:g.count||0,meetingsCount:m.count||0,investmentsCount:y.count||0,kitCount:v.count||0,lastInteraction:b.data&&b.data.length>0?b.data[0]:null}),H(!0)}catch(t){console.error("Error fetching associated data counts:",t),P(`Failed to get related record counts: ${t.message||"Unknown error"}`)}})(e)},te=e=>{U(e)},oe=e=>{Q("/inbox?source=category"),sessionStorage.setItem("workflow_contact_id",e.contact_id)},ne=e=>{if(!e.data)return"";return`${e.data.first_name||""} ${e.data.last_name||""}`.trim()||"(No name)"},re=(0,n.useMemo)((()=>[{headerName:"Name",field:"name",valueGetter:ne,minWidth:200,filter:"agTextColumnFilter",floatingFilter:!1,sortable:!0,pinned:"left"},{headerName:"Last Interaction",field:"last_interaction_at",valueFormatter:e=>e.value?new Date(e.value).toLocaleDateString():"-",minWidth:110,width:110,filter:"agDateColumnFilter",floatingFilter:!1,sortable:!0},{headerName:"Mobile",field:"mobile",valueGetter:e=>e.data?e.data.mobile||"-":"",minWidth:120,width:120,filter:"agTextColumnFilter",floatingFilter:!1,sortable:!0,cellRenderer:e=>{const t=e.value||"-";return"-"===t?t:(0,u.jsx)("span",{style:{color:"#cccccc"},children:t})}},{headerName:"Email",field:"email",valueGetter:e=>e.data?e.data.email||"-":"",minWidth:250,filter:"agTextColumnFilter",floatingFilter:!1,sortable:!0,cellRenderer:e=>{const t=e.value||"-";return"-"===t?t:(0,u.jsx)("span",{style:{color:"#cccccc"},children:t})}},{headerName:"Actions",width:260,minWidth:260,field:"actions",cellRenderer:D,cellRendererParams:{onSpam:ee,onSkip:te,onAddToCRM:oe},sortable:!1,filter:!1,suppressSizeToFit:!0,cellClass:"action-cell-no-click"}]),[ee,te,oe]),ie=(0,n.useMemo)((()=>({resizable:!0,cellClass:"clickable-cell"})),[]),ae=n.useCallback((e=>{console.log("Grid is ready"),I(e.api),setTimeout((()=>{e.api.sizeColumnsToFit()}),0)}),[]),se=n.useCallback((e=>{e.column&&"actions"===e.column.colId?console.log("Ignoring click on actions cell"):(console.log("Row clicked, navigating to workflow page",e.data),e.data&&e.data.contact_id&&(Q("/inbox?source=category"),sessionStorage.setItem("workflow_contact_id",e.data.contact_id)))}),[Q]);return(0,n.useEffect)((()=>{M||(console.log("Initiating data fetch"),(async()=>{try{i(!0),P(null);const o=async function(e){let t,o=arguments.length>1&&void 0!==arguments[1]?arguments[1]:3,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1e3;for(let i=0;i<o;i++)try{return await e()}catch(r){console.log(`Attempt ${i+1} failed, retrying in ${n}ms...`,r),t=r,await new Promise((e=>setTimeout(e,n))),n*=1.5}throw t},n=new Date;n.setDate(n.getDate()-60);const r=n.toISOString(),{count:s,error:l}=await o((async()=>a.supabase.from("contacts").select("*",{count:"exact",head:!0}).eq("category","Inbox").gte("last_interaction_at",r)));if(l)throw l;if(console.log(`Total Inbox contacts: ${s}`),0===s)return t([]),i(!1),L(!0),void G(!0);const c=async(e,t)=>(console.log(`Fetching batch from ${e} to ${t}`),o((async()=>a.supabase.from("contacts").select("\n              contact_id, \n              first_name, \n              last_name, \n              category,\n              score, \n              last_interaction_at,\n              created_at\n            ").eq("category","Inbox").gte("last_interaction_at",r).order("last_interaction_at",{ascending:!1}).range(e,t))));let d=[];const u=500;let p=0,h=0;const f=Math.min(s,4e3);for(let t=0;t<f;t+=u)try{i(`Loading contacts... ${Math.min(t+u,s)}/${s}`);const{data:e,error:o}=await c(t,t+u-1);if(o){if(console.error(`Error fetching contacts batch from ${t} to ${t+u-1}:`,o),h++,h>3)throw new Error(`Too many failed batches (${h}). Last error: ${o.message}`);continue}e&&e.length>0&&(d=[...d,...e],p+=e.length)}catch(e){if(console.error(`Error in batch fetch loop at index ${t}:`,e),0===p)throw e;break}console.log(`Successfully fetched ${p} contacts in ${Math.ceil(p/u)} batches with ${h} failed batches`);const g=d;if(!g||0===g.length)return t([]),void i(!1);const m=g.map((e=>e.contact_id)).filter(Boolean);if(0===m.length)return t(g),void i(!1);i("Loading related data (companies, tags, cities)...");const y=async function(t,o,n){let r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:100;console.log(`Fetching ${t} data for ${n.length} contacts in batches of ${r}`);let a=[];for(let s=0;s<n.length;s+=r){const l=n.slice(s,s+r);try{const{data:e,error:c}=await o.in("contact_id",l);if(c)throw c;a=[...a,...e||[]],i(`Loading ${t} data... ${Math.min(s+r,n.length)}/${n.length}`)}catch(e){console.error(`Error fetching batch of ${t} data:`,e)}}return{data:a}},v=async function(t,o,n,r,s){let l=arguments.length>5&&void 0!==arguments[5]?arguments[5]:100;console.log(`Fetching ${t} details for ${r.length} entities in batches of ${l}`);let c=[];for(let d=0;d<r.length;d+=l){const u=r.slice(d,d+l);try{const{data:e,error:p}=await a.supabase.from(o).select(s).in(n,u);if(p)throw p;c=[...c,...e||[]],i(`Loading ${t} details... ${Math.min(d+l,r.length)}/${r.length}`)}catch(e){console.error(`Error fetching batch of ${t} details:`,e)}}return{data:c}};try{const[e,o,n,r,s]=await Promise.all([y("companies",a.supabase.from("contact_companies").select("contact_id, company_id"),m),y("tags",a.supabase.from("contact_tags").select("contact_id, tag_id"),m),y("cities",a.supabase.from("contact_cities").select("contact_id, city_id"),m),y("emails",a.supabase.from("contact_emails").select("contact_id, email, is_primary"),m),y("mobiles",a.supabase.from("contact_mobiles").select("contact_id, mobile, is_primary"),m)]),l=[...new Set((e.data||[]).map((e=>e.company_id)).filter(Boolean))],c=[...new Set((o.data||[]).map((e=>e.tag_id)).filter(Boolean))],d=[...new Set((n.data||[]).map((e=>e.city_id)).filter(Boolean))];i("Loading details for related data...");const[u,p,h]=await Promise.all([l.length>0?v("companies","companies","company_id",l,"company_id, name, website"):{data:[]},c.length>0?v("tags","tags","tag_id",c,"tag_id, name"):{data:[]},d.length>0?v("cities","cities","city_id",d,"city_id, name"):{data:[]}]);i("Processing data and preparing contacts...");const f=g.map(((t,a)=>{var l,c;if(!t||!t.contact_id)return console.warn("Skipping invalid contact:",t),null;a>0&&a%1e3===0&&i(`Processing contacts... ${a}/${g.length}`);const d=(e.data||[]).filter((e=>(null===e||void 0===e?void 0:e.contact_id)===t.contact_id)),f=(o.data||[]).filter((e=>(null===e||void 0===e?void 0:e.contact_id)===t.contact_id)),m=(n.data||[]).filter((e=>(null===e||void 0===e?void 0:e.contact_id)===t.contact_id)),y=(r.data||[]).filter((e=>(null===e||void 0===e?void 0:e.contact_id)===t.contact_id)),v=(s.data||[]).filter((e=>(null===e||void 0===e?void 0:e.contact_id)===t.contact_id)),b=y.find((e=>null===e||void 0===e?void 0:e.is_primary)),x=(null===b||void 0===b?void 0:b.email)||(y.length>0?null===(l=y[0])||void 0===l?void 0:l.email:null),w=v.find((e=>null===e||void 0===e?void 0:e.is_primary)),C=(null===w||void 0===w?void 0:w.mobile)||(v.length>0?null===(c=v[0])||void 0===c?void 0:c.mobile:null),_=d.map((e=>{var t;if(null===e||void 0===e||!e.company_id)return null;const o=null===(t=u.data)||void 0===t?void 0:t.find((t=>(null===t||void 0===t?void 0:t.company_id)===e.company_id));return o?{id:o.company_id,name:o.name||"Unknown",website:o.website}:null})).filter(Boolean),S=f.map((e=>{var t;if(null===e||void 0===e||!e.tag_id)return null;const o=null===(t=p.data)||void 0===t?void 0:t.find((t=>(null===t||void 0===t?void 0:t.tag_id)===e.tag_id));return o?{id:o.tag_id,name:o.name||"Unknown Tag"}:null})).filter(Boolean),E=m.map((e=>{var t;if(null===e||void 0===e||!e.city_id)return null;const o=null===(t=h.data)||void 0===t?void 0:t.find((t=>(null===t||void 0===t?void 0:t.city_id)===e.city_id));return o?{id:o.city_id,name:o.name||"Unknown Location"}:null})).filter(Boolean);return{...t,id:t.contact_id,email:x||null,mobile:C||null,companies:_||[],tags:S||[],cities:E||[]}})).filter(Boolean);console.log(`Successfully processed ${f.length} contacts out of ${g.length} total`),t(f),i(!1),L(!0),setTimeout((()=>{G(!0)}),800)}catch(e){console.error("Error loading related data:",e);const o=g.map((e=>({...e,id:e.contact_id,companies:[],tags:[],cities:[]})));t(o),i(!1),L(!0),setTimeout((()=>{G(!0)}),800)}}catch(e){console.error("Error fetching contacts:",e),P(e.message),i(!1)}})())}),[M]),(0,n.useEffect)((()=>{if(!N)return;const e=()=>{N.sizeColumnsToFit()};return window.addEventListener("resize",e,{passive:!0}),()=>{window.removeEventListener("resize",e,{passive:!0})}}),[N]),(0,u.jsxs)(p,{children:[c&&(0,u.jsxs)(h,{children:["Error: ",c]}),!1!==o?(0,u.jsxs)(f,{children:[(0,u.jsx)(m,{children:"string"===typeof o?o.replace(/Loading .+ \d+\/\d+/,"Initializing Matrix"):"Accessing Contact Database..."}),(0,u.jsx)(g,{}),(0,u.jsx)(y,{})]}):F||c?0!==e.length||c?(0,u.jsx)("div",{className:"ag-theme-alpine",style:{height:"calc(100vh - 120px)",width:"calc(100% - 30px)",overflow:"auto",margin:"15px 15px 0 15px",marginTop:"30px",opacity:F?1:0,transition:"opacity 0.5s ease-in-out","--ag-background-color":"#121212","--ag-odd-row-background-color":"#1a1a1a","--ag-header-background-color":"#222222","--ag-header-foreground-color":"#00ff00","--ag-foreground-color":"#e0e0e0","--ag-row-hover-color":"#2a2a2a","--ag-border-color":"#333333"},children:(0,u.jsx)(s.W,{rowData:e,columnDefs:re,defaultColDef:ie,onGridReady:ae,onRowClicked:se,rowSelection:"single",animateRows:!0,pagination:!0,paginationPageSize:100,suppressCellFocus:!0,enableCellTextSelection:!0,rowHeight:42,domLayout:"autoHeight",paginationAutoPageSize:!0})}):(0,u.jsxs)("div",{style:{padding:"40px",textAlign:"center",color:"#00ff00",background:"#121212",borderRadius:"8px",fontSize:"24px",fontWeight:"bold",display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",height:"300px"},children:[(0,u.jsx)("div",{style:{marginBottom:"15px"},children:"All records processed \ud83d\ude0a"}),(0,u.jsx)("div",{style:{fontSize:"48px",marginBottom:"20px"},children:"\u2713"})]}):(0,u.jsxs)(f,{children:[(0,u.jsx)(m,{children:"Preparing interface..."}),(0,u.jsx)(g,{}),(0,u.jsx)(y,{})]}),(0,u.jsx)(d(),{isOpen:null!==$,onRequestClose:()=>U(null),shouldCloseOnOverlayClick:!1,style:{content:{top:"50%",left:"50%",right:"auto",bottom:"auto",marginRight:"-50%",transform:"translate(-50%, -50%)",padding:"25px",maxWidth:"400px",width:"90%",backgroundColor:"#121212",border:"1px solid #333",borderRadius:"8px",boxShadow:"0 4px 20px rgba(0, 0, 0, 0.6)",color:"#e0e0e0",zIndex:1001},overlay:{backgroundColor:"rgba(0, 0, 0, 0.75)",zIndex:1e3}},children:$&&(0,u.jsxs)(u.Fragment,{children:[(0,u.jsxs)(v,{children:[(0,u.jsx)("h2",{style:{color:"#ff9900"},children:"Confirm Skip"}),(0,u.jsx)(b,{onClick:()=>U(null),disabled:o,children:(0,u.jsx)(l.yGN,{})})]}),(0,u.jsxs)("div",{style:{margin:"15px 0"},children:[(0,u.jsx)("p",{style:{marginBottom:"20px"},children:'Are you sure you want to mark this contact as "Skip"?'}),(0,u.jsx)(E,{children:(0,u.jsx)(k,{children:(0,u.jsxs)(A,{children:[$.first_name," ",$.last_name,$.email?` (${$.email})`:$.mobile?` (${$.mobile})`:""]})})})]}),(0,u.jsxs)(R,{children:[(0,u.jsx)(T,{onClick:()=>U(null),disabled:o,children:"Cancel"}),(0,u.jsx)(O,{onClick:async()=>{if(!$)return;const e=$;try{i(!0);const{error:o}=await a.supabase.from("contacts").update({category:"Skip"}).eq("contact_id",e.contact_id);if(o)throw o;t((t=>t.filter((t=>t.contact_id!==e.contact_id)))),U(null),i(!1),console.log("Contact marked as Skip:",e.contact_id)}catch(o){console.error("Error marking contact as Skip:",o),P(`Failed to mark contact as Skip: ${o.message||"Unknown error"}`),i(!1)}},disabled:o,style:{backgroundColor:"#ff9900"},children:o?"Processing...":"Mark as Skip"})]})]})}),(0,u.jsxs)(d(),{isOpen:z,onRequestClose:()=>H(!1),shouldCloseOnOverlayClick:!1,style:{content:{top:"50%",left:"50%",right:"auto",bottom:"auto",marginRight:"-50%",transform:"translate(-50%, -50%)",padding:"25px",maxWidth:"600px",width:"90%",backgroundColor:"#121212",border:"1px solid #333",borderRadius:"8px",boxShadow:"0 4px 20px rgba(0, 0, 0, 0.6)",color:"#e0e0e0",zIndex:1001},overlay:{backgroundColor:"rgba(0, 0, 0, 0.75)",zIndex:1e3}},children:[(0,u.jsxs)(v,{children:[(0,u.jsx)("h2",{children:"Delete Contact and Associated Data"}),(0,u.jsx)(b,{onClick:()=>H(!1),disabled:J,children:(0,u.jsx)(l.yGN,{})})]}),B&&(0,u.jsxs)(u.Fragment,{children:[(0,u.jsx)(E,{children:(0,u.jsx)(k,{children:(0,u.jsxs)(A,{children:[B.first_name," ",B.last_name,B.email?` (${B.email})`:B.mobile?` (${B.mobile})`:""]})})}),(0,u.jsxs)(k,{style:{marginTop:"15px",marginBottom:"15px"},children:[(0,u.jsx)(j,{children:"Last Interaction:"}),(0,u.jsx)(A,{children:W.lastInteraction?W.lastInteraction.summary:"None"})]}),(0,u.jsx)(x,{children:"Select which items to delete:"}),(0,u.jsx)(w,{children:(0,u.jsxs)(C,{children:[W.interactionsCount>0&&(0,u.jsxs)(_,{children:[(0,u.jsx)(S,{type:"checkbox",id:"deleteInteractions",name:"deleteInteractions",checked:K.deleteInteractions,onChange:Z,disabled:J}),(0,u.jsxs)("label",{htmlFor:"deleteInteractions",children:["Interactions (",W.interactionsCount,")"]})]}),W.emailsCount>0&&(0,u.jsxs)(_,{children:[(0,u.jsx)(S,{type:"checkbox",id:"deleteEmails",name:"deleteEmails",checked:K.deleteEmails,onChange:Z,disabled:J}),(0,u.jsxs)("label",{htmlFor:"deleteEmails",children:["Emails (",W.emailsCount,")"]})]}),W.emailParticipantsCount>0&&(0,u.jsxs)(_,{children:[(0,u.jsx)(S,{type:"checkbox",id:"deleteEmailParticipants",name:"deleteEmailParticipants",checked:K.deleteEmailParticipants,onChange:Z,disabled:J}),(0,u.jsxs)("label",{htmlFor:"deleteEmailParticipants",children:["Email Participants (",W.emailParticipantsCount,")"]})]}),W.emailThreadsCount>0&&(0,u.jsxs)(_,{children:[(0,u.jsx)(S,{type:"checkbox",id:"deleteEmailThreads",name:"deleteEmailThreads",checked:K.deleteEmailThreads,onChange:Z,disabled:J}),(0,u.jsxs)("label",{htmlFor:"deleteEmailThreads",children:["Email Threads (",W.emailThreadsCount,")"]})]}),W.contactEmailsCount>0&&(0,u.jsxs)(_,{children:[(0,u.jsx)(S,{type:"checkbox",id:"deleteContactEmails",name:"deleteContactEmails",checked:K.deleteContactEmails,onChange:Z,disabled:J}),(0,u.jsxs)("label",{htmlFor:"deleteContactEmails",children:["Email Addresses (",W.contactEmailsCount,")"]})]}),W.contactMobilesCount>0&&(0,u.jsxs)(_,{children:[(0,u.jsx)(S,{type:"checkbox",id:"deleteContactMobiles",name:"deleteContactMobiles",checked:K.deleteContactMobiles,onChange:Z,disabled:J}),(0,u.jsxs)("label",{htmlFor:"deleteContactMobiles",children:["Mobile Numbers (",W.contactMobilesCount,")"]})]}),W.chatCount>0&&(0,u.jsxs)(_,{children:[(0,u.jsx)(S,{type:"checkbox",id:"deleteChat",name:"deleteChat",checked:K.deleteChat,onChange:Z,disabled:J}),(0,u.jsxs)("label",{htmlFor:"deleteChat",children:["Chat messages (",W.chatCount,")"]})]}),W.contactChatsCount>0&&(0,u.jsxs)(_,{children:[(0,u.jsx)(S,{type:"checkbox",id:"deleteContactChats",name:"deleteContactChats",checked:K.deleteContactChats,onChange:Z,disabled:J}),(0,u.jsxs)("label",{htmlFor:"deleteContactChats",children:["Chat Links (",W.contactChatsCount,")"]})]}),W.notesCount>0&&(0,u.jsxs)(_,{children:[(0,u.jsx)(S,{type:"checkbox",id:"deleteNotes",name:"deleteNotes",checked:K.deleteNotes,onChange:Z,disabled:J}),(0,u.jsxs)("label",{htmlFor:"deleteNotes",children:["Notes (",W.notesCount,")"]})]}),W.attachmentsCount>0&&(0,u.jsxs)(_,{children:[(0,u.jsx)(S,{type:"checkbox",id:"deleteAttachments",name:"deleteAttachments",checked:K.deleteAttachments,onChange:Z,disabled:J}),(0,u.jsxs)("label",{htmlFor:"deleteAttachments",children:["Attachments (",W.attachmentsCount,")"]})]}),W.tagsCount>0&&(0,u.jsxs)(_,{children:[(0,u.jsx)(S,{type:"checkbox",id:"deleteTags",name:"deleteTags",checked:K.deleteTags,onChange:Z,disabled:J}),(0,u.jsxs)("label",{htmlFor:"deleteTags",children:["Tags (",W.tagsCount,")"]})]}),W.citiesCount>0&&(0,u.jsxs)(_,{children:[(0,u.jsx)(S,{type:"checkbox",id:"deleteCities",name:"deleteCities",checked:K.deleteCities,onChange:Z,disabled:J}),(0,u.jsxs)("label",{htmlFor:"deleteCities",children:["Cities (",W.citiesCount,")"]})]}),W.companiesCount>0&&(0,u.jsxs)(_,{children:[(0,u.jsx)(S,{type:"checkbox",id:"deleteCompanies",name:"deleteCompanies",checked:K.deleteCompanies,onChange:Z,disabled:J}),(0,u.jsxs)("label",{htmlFor:"deleteCompanies",children:["Companies (",W.companiesCount,")"]})]}),W.dealsCount>0&&(0,u.jsxs)(_,{children:[(0,u.jsx)(S,{type:"checkbox",id:"deleteDeals",name:"deleteDeals",checked:K.deleteDeals,onChange:Z,disabled:J}),(0,u.jsxs)("label",{htmlFor:"deleteDeals",children:["Deals (",W.dealsCount,")"]})]}),W.meetingsCount>0&&(0,u.jsxs)(_,{children:[(0,u.jsx)(S,{type:"checkbox",id:"deleteMeetings",name:"deleteMeetings",checked:K.deleteMeetings,onChange:Z,disabled:J}),(0,u.jsxs)("label",{htmlFor:"deleteMeetings",children:["Meetings (",W.meetingsCount,")"]})]}),W.investmentsCount>0&&(0,u.jsxs)(_,{children:[(0,u.jsx)(S,{type:"checkbox",id:"deleteInvestments",name:"deleteInvestments",checked:K.deleteInvestments,onChange:Z,disabled:J}),(0,u.jsxs)("label",{htmlFor:"deleteInvestments",children:["Investments (",W.investmentsCount,")"]})]}),W.kitCount>0&&(0,u.jsxs)(_,{children:[(0,u.jsx)(S,{type:"checkbox",id:"deleteKit",name:"deleteKit",checked:K.deleteKit,onChange:Z,disabled:J}),(0,u.jsxs)("label",{htmlFor:"deleteKit",children:["Keep In Touch (",W.kitCount,")"]})]}),B.mobile&&W.whatsappCount>0&&(0,u.jsxs)(_,{children:[(0,u.jsx)(S,{type:"checkbox",id:"deleteWhatsapp",name:"deleteWhatsapp",checked:K.deleteWhatsapp,onChange:Z,disabled:J}),(0,u.jsxs)("label",{htmlFor:"deleteWhatsapp",children:["WhatsApp Data (",W.whatsappCount,")"]})]}),B.email&&(0,u.jsxs)(_,{children:[(0,u.jsx)(S,{type:"checkbox",id:"addToSpam",name:"addToSpam",checked:K.addToSpam,onChange:Z,disabled:J}),(0,u.jsx)("label",{htmlFor:"addToSpam",children:"Add email to spam list"})]}),B.mobile&&(0,u.jsxs)(_,{children:[(0,u.jsx)(S,{type:"checkbox",id:"addMobileToSpam",name:"addMobileToSpam",checked:K.addMobileToSpam,onChange:Z,disabled:J}),(0,u.jsx)("label",{htmlFor:"addMobileToSpam",children:"Add mobile to WhatsApp spam list"})]})]})}),(0,u.jsxs)(R,{children:[(0,u.jsxs)(T,{onClick:()=>H(!1),disabled:J,children:[(0,u.jsx)(l.yGN,{})," Cancel"]}),(0,u.jsx)(O,{onClick:async()=>{if(B)try{if(X(!0),K.addToSpam&&B.email){const{error:e}=await a.supabase.from("emails_spam").insert([{email:B.email,counter:1}]);e&&console.error("Error adding to spam list:",e)}if(K.addMobileToSpam&&B.mobile){const{error:e}=await a.supabase.from("whatsapp_spam").insert([{mobile_number:B.mobile,counter:1,created_at:(new Date).toISOString(),last_modified_at:(new Date).toISOString()}]);e&&console.error("Error adding to WhatsApp spam list:",e)}const e=[];if(K.deleteChat&&W.chatCount>0&&e.push(a.supabase.from("chat").delete().eq("contact_id",B.contact_id)),K.deleteInteractions&&W.interactionsCount>0&&e.push(a.supabase.from("interactions").delete().eq("contact_id",B.contact_id)),K.deleteEmails&&W.emailsCount>0){const{data:t}=await a.supabase.from("emails").select("email_id").eq("sender_contact_id",B.contact_id);if(t&&t.length>0){const o=t.map((e=>e.email_id));e.push(a.supabase.from("email_participants").delete().in("email_id",o)),e.push(a.supabase.from("emails").delete().eq("sender_contact_id",B.contact_id))}}K.deleteEmailThreads&&W.emailThreadsCount>0&&e.push(a.supabase.from("contact_email_threads").delete().eq("contact_id",B.contact_id)),K.deleteContactEmails&&W.contactEmailsCount>0&&e.push(a.supabase.from("contact_emails").delete().eq("contact_id",B.contact_id)),K.deleteContactMobiles&&W.contactMobilesCount>0&&e.push(a.supabase.from("contact_mobiles").delete().eq("contact_id",B.contact_id)),K.deleteNotes&&W.notesCount>0&&e.push(a.supabase.from("notes_contacts").delete().eq("contact_id",B.contact_id)),K.deleteAttachments&&W.attachmentsCount>0&&e.push(a.supabase.from("attachments").delete().eq("contact_id",B.contact_id)),K.deleteTags&&W.tagsCount>0&&e.push(a.supabase.from("contact_tags").delete().eq("contact_id",B.contact_id)),K.deleteCities&&W.citiesCount>0&&e.push(a.supabase.from("contact_cities").delete().eq("contact_id",B.contact_id)),K.deleteCompanies&&W.companiesCount>0&&e.push(a.supabase.from("contact_companies").delete().eq("contact_id",B.contact_id)),K.deleteContactChats&&W.contactChatsCount>0&&e.push(a.supabase.from("contact_chats").delete().eq("contact_id",B.contact_id)),K.deleteWhatsapp&&B.mobile&&W.whatsappCount>0&&e.push(a.supabase.from("whatsapp_inbox").delete().eq("contact_number",B.mobile)),K.deleteDeals&&W.dealsCount>0&&e.push(a.supabase.from("deals_contacts").delete().eq("contact_id",B.contact_id)),K.deleteMeetings&&W.meetingsCount>0&&e.push(a.supabase.from("meeting_contacts").delete().eq("contact_id",B.contact_id)),K.deleteInvestments&&W.investmentsCount>0&&e.push(a.supabase.from("investments_contacts").delete().eq("contact_id",B.contact_id)),K.deleteKit&&W.kitCount>0&&e.push(a.supabase.from("keep_in_touch").delete().eq("contact_id",B.contact_id)),await Promise.all(e);const{error:o}=await a.supabase.from("contacts").delete().eq("contact_id",B.contact_id);if(o)throw o;t((e=>e.filter((e=>e.contact_id!==B.contact_id)))),H(!1),V(null),X(!1)}catch(e){console.error("Error deleting contact:",e),P(`Failed to delete contact: ${e.message||"Unknown error"}`),X(!1)}},disabled:J,children:J?"Deleting...":(0,u.jsxs)(u.Fragment,{children:[(0,u.jsx)(l.IXo,{})," Delete Contact"]})})]})]})]})]})}},1009:(e,t,o)=>{"use strict";o.d(t,{A3x:()=>p,Bc_:()=>Z,CKj:()=>ee,EPw:()=>T,GGD:()=>X,H9b:()=>c,HaR:()=>E,Hbo:()=>x,HzC:()=>$,IXo:()=>re,JXP:()=>le,K7R:()=>R,ND1:()=>U,Oge:()=>te,Ohp:()=>y,Ojn:()=>b,QFc:()=>J,Q_v:()=>ie,QuH:()=>A,Qz2:()=>P,S8s:()=>L,SG1:()=>S,TwU:()=>B,V5Y:()=>I,Vap:()=>k,VeH:()=>D,WXf:()=>_,Wjy:()=>z,Wm:()=>H,X6_:()=>W,YrT:()=>h,YyZ:()=>O,_Y7:()=>M,_mV:()=>Y,a4x:()=>C,ayE:()=>G,cfS:()=>ce,cnX:()=>ne,dyV:()=>l,eHT:()=>a,est:()=>K,fK4:()=>f,fOo:()=>m,icx:()=>N,irw:()=>g,jH2:()=>j,jTZ:()=>Q,kRp:()=>s,mEP:()=>q,nxz:()=>v,p45:()=>ae,pHD:()=>V,qYx:()=>d,q_G:()=>de,usP:()=>oe,vq3:()=>se,wIk:()=>u,y3G:()=>i,yGN:()=>ue,yx1:()=>F,z1n:()=>r,z8N:()=>w});var n=o(6688);function r(e){return(0,n.k5)({tag:"svg",attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"polyline",attr:{points:"22 12 18 12 15 21 9 3 6 12 2 12"}}]})(e)}function i(e){return(0,n.k5)({tag:"svg",attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"circle",attr:{cx:"12",cy:"12",r:"10"}},{tag:"line",attr:{x1:"12",y1:"8",x2:"12",y2:"12"}},{tag:"line",attr:{x1:"12",y1:"16",x2:"12.01",y2:"16"}}]})(e)}function a(e){return(0,n.k5)({tag:"svg",attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"path",attr:{d:"M10.29 3.86L1.82 18a2 2 0 0 0 1.71 3h16.94a2 2 0 0 0 1.71-3L13.71 3.86a2 2 0 0 0-3.42 0z"}},{tag:"line",attr:{x1:"12",y1:"9",x2:"12",y2:"13"}},{tag:"line",attr:{x1:"12",y1:"17",x2:"12.01",y2:"17"}}]})(e)}function s(e){return(0,n.k5)({tag:"svg",attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"line",attr:{x1:"19",y1:"12",x2:"5",y2:"12"}},{tag:"polyline",attr:{points:"12 19 5 12 12 5"}}]})(e)}function l(e){return(0,n.k5)({tag:"svg",attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"line",attr:{x1:"5",y1:"12",x2:"19",y2:"12"}},{tag:"polyline",attr:{points:"12 5 19 12 12 19"}}]})(e)}function c(e){return(0,n.k5)({tag:"svg",attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"path",attr:{d:"M4 19.5A2.5 2.5 0 0 1 6.5 17H20"}},{tag:"path",attr:{d:"M6.5 2H20v20H6.5A2.5 2.5 0 0 1 4 19.5v-15A2.5 2.5 0 0 1 6.5 2z"}}]})(e)}function d(e){return(0,n.k5)({tag:"svg",attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"rect",attr:{x:"2",y:"7",width:"20",height:"14",rx:"2",ry:"2"}},{tag:"path",attr:{d:"M16 21V5a2 2 0 0 0-2-2h-4a2 2 0 0 0-2 2v16"}}]})(e)}function u(e){return(0,n.k5)({tag:"svg",attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"rect",attr:{x:"3",y:"4",width:"18",height:"18",rx:"2",ry:"2"}},{tag:"line",attr:{x1:"16",y1:"2",x2:"16",y2:"6"}},{tag:"line",attr:{x1:"8",y1:"2",x2:"8",y2:"6"}},{tag:"line",attr:{x1:"3",y1:"10",x2:"21",y2:"10"}}]})(e)}function p(e){return(0,n.k5)({tag:"svg",attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"path",attr:{d:"M22 11.08V12a10 10 0 1 1-5.93-9.14"}},{tag:"polyline",attr:{points:"22 4 12 14.01 9 11.01"}}]})(e)}function h(e){return(0,n.k5)({tag:"svg",attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"polyline",attr:{points:"20 6 9 17 4 12"}}]})(e)}function f(e){return(0,n.k5)({tag:"svg",attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"polyline",attr:{points:"6 9 12 15 18 9"}}]})(e)}function g(e){return(0,n.k5)({tag:"svg",attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"polyline",attr:{points:"15 18 9 12 15 6"}}]})(e)}function m(e){return(0,n.k5)({tag:"svg",attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"polyline",attr:{points:"9 18 15 12 9 6"}}]})(e)}function y(e){return(0,n.k5)({tag:"svg",attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"circle",attr:{cx:"12",cy:"12",r:"10"}},{tag:"polyline",attr:{points:"12 6 12 12 16 14"}}]})(e)}function v(e){return(0,n.k5)({tag:"svg",attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"rect",attr:{x:"9",y:"9",width:"13",height:"13",rx:"2",ry:"2"}},{tag:"path",attr:{d:"M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"}}]})(e)}function b(e){return(0,n.k5)({tag:"svg",attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"rect",attr:{x:"4",y:"4",width:"16",height:"16",rx:"2",ry:"2"}},{tag:"rect",attr:{x:"9",y:"9",width:"6",height:"6"}},{tag:"line",attr:{x1:"9",y1:"1",x2:"9",y2:"4"}},{tag:"line",attr:{x1:"15",y1:"1",x2:"15",y2:"4"}},{tag:"line",attr:{x1:"9",y1:"20",x2:"9",y2:"23"}},{tag:"line",attr:{x1:"15",y1:"20",x2:"15",y2:"23"}},{tag:"line",attr:{x1:"20",y1:"9",x2:"23",y2:"9"}},{tag:"line",attr:{x1:"20",y1:"14",x2:"23",y2:"14"}},{tag:"line",attr:{x1:"1",y1:"9",x2:"4",y2:"9"}},{tag:"line",attr:{x1:"1",y1:"14",x2:"4",y2:"14"}}]})(e)}function x(e){return(0,n.k5)({tag:"svg",attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"ellipse",attr:{cx:"12",cy:"5",rx:"9",ry:"3"}},{tag:"path",attr:{d:"M21 12c0 1.66-4 3-9 3s-9-1.34-9-3"}},{tag:"path",attr:{d:"M3 5v14c0 1.66 4 3 9 3s9-1.34 9-3V5"}}]})(e)}function w(e){return(0,n.k5)({tag:"svg",attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"line",attr:{x1:"12",y1:"1",x2:"12",y2:"23"}},{tag:"path",attr:{d:"M17 5H9.5a3.5 3.5 0 0 0 0 7h5a3.5 3.5 0 0 1 0 7H6"}}]})(e)}function C(e){return(0,n.k5)({tag:"svg",attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"path",attr:{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"}},{tag:"polyline",attr:{points:"7 10 12 15 17 10"}},{tag:"line",attr:{x1:"12",y1:"15",x2:"12",y2:"3"}}]})(e)}function _(e){return(0,n.k5)({tag:"svg",attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"path",attr:{d:"M17 3a2.828 2.828 0 1 1 4 4L7.5 20.5 2 22l1.5-5.5L17 3z"}}]})(e)}function S(e){return(0,n.k5)({tag:"svg",attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"path",attr:{d:"M11 4H4a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7"}},{tag:"path",attr:{d:"M18.5 2.5a2.121 2.121 0 0 1 3 3L12 15l-4 1 1-4 9.5-9.5z"}}]})(e)}function E(e){return(0,n.k5)({tag:"svg",attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"path",attr:{d:"M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6"}},{tag:"polyline",attr:{points:"15 3 21 3 21 9"}},{tag:"line",attr:{x1:"10",y1:"14",x2:"21",y2:"3"}}]})(e)}function k(e){return(0,n.k5)({tag:"svg",attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"path",attr:{d:"M1 12s4-8 11-8 11 8 11 8-4 8-11 8-11-8-11-8z"}},{tag:"circle",attr:{cx:"12",cy:"12",r:"3"}}]})(e)}function j(e){return(0,n.k5)({tag:"svg",attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"path",attr:{d:"M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"}},{tag:"polyline",attr:{points:"14 2 14 8 20 8"}},{tag:"line",attr:{x1:"16",y1:"13",x2:"8",y2:"13"}},{tag:"line",attr:{x1:"16",y1:"17",x2:"8",y2:"17"}},{tag:"polyline",attr:{points:"10 9 9 9 8 9"}}]})(e)}function A(e){return(0,n.k5)({tag:"svg",attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"path",attr:{d:"M13 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V9z"}},{tag:"polyline",attr:{points:"13 2 13 9 20 9"}}]})(e)}function R(e){return(0,n.k5)({tag:"svg",attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"polygon",attr:{points:"22 3 2 3 10 12.46 10 19 14 21 14 12.46 22 3"}}]})(e)}function O(e){return(0,n.k5)({tag:"svg",attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"polyline",attr:{points:"20 12 20 22 4 22 4 12"}},{tag:"rect",attr:{x:"2",y:"7",width:"20",height:"5"}},{tag:"line",attr:{x1:"12",y1:"22",x2:"12",y2:"7"}},{tag:"path",attr:{d:"M12 7H7.5a2.5 2.5 0 0 1 0-5C11 2 12 7 12 7z"}},{tag:"path",attr:{d:"M12 7h4.5a2.5 2.5 0 0 0 0-5C13 2 12 7 12 7z"}}]})(e)}function T(e){return(0,n.k5)({tag:"svg",attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"circle",attr:{cx:"18",cy:"18",r:"3"}},{tag:"circle",attr:{cx:"6",cy:"6",r:"3"}},{tag:"path",attr:{d:"M6 21V9a9 9 0 0 0 9 9"}}]})(e)}function D(e){return(0,n.k5)({tag:"svg",attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"circle",attr:{cx:"12",cy:"12",r:"10"}},{tag:"line",attr:{x1:"2",y1:"12",x2:"22",y2:"12"}},{tag:"path",attr:{d:"M12 2a15.3 15.3 0 0 1 4 10 15.3 15.3 0 0 1-4 10 15.3 15.3 0 0 1-4-10 15.3 15.3 0 0 1 4-10z"}}]})(e)}function P(e){return(0,n.k5)({tag:"svg",attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"line",attr:{x1:"4",y1:"9",x2:"20",y2:"9"}},{tag:"line",attr:{x1:"4",y1:"15",x2:"20",y2:"15"}},{tag:"line",attr:{x1:"10",y1:"3",x2:"8",y2:"21"}},{tag:"line",attr:{x1:"16",y1:"3",x2:"14",y2:"21"}}]})(e)}function N(e){return(0,n.k5)({tag:"svg",attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"path",attr:{d:"M20.84 4.61a5.5 5.5 0 0 0-7.78 0L12 5.67l-1.06-1.06a5.5 5.5 0 0 0-7.78 7.78l1.06 1.06L12 21.23l7.78-7.78 1.06-1.06a5.5 5.5 0 0 0 0-7.78z"}}]})(e)}function I(e){return(0,n.k5)({tag:"svg",attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"path",attr:{d:"M3 9l9-7 9 7v11a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z"}},{tag:"polyline",attr:{points:"9 22 9 12 15 12 15 22"}}]})(e)}function M(e){return(0,n.k5)({tag:"svg",attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"polyline",attr:{points:"22 12 16 12 14 15 10 15 8 12 2 12"}},{tag:"path",attr:{d:"M5.45 5.11L2 12v6a2 2 0 0 0 2 2h16a2 2 0 0 0 2-2v-6l-3.45-6.89A2 2 0 0 0 16.76 4H7.24a2 2 0 0 0-1.79 1.11z"}}]})(e)}function L(e){return(0,n.k5)({tag:"svg",attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"circle",attr:{cx:"12",cy:"12",r:"10"}},{tag:"line",attr:{x1:"12",y1:"16",x2:"12",y2:"12"}},{tag:"line",attr:{x1:"12",y1:"8",x2:"12.01",y2:"8"}}]})(e)}function F(e){return(0,n.k5)({tag:"svg",attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"path",attr:{d:"M15 7h3a5 5 0 0 1 5 5 5 5 0 0 1-5 5h-3m-6 0H6a5 5 0 0 1-5-5 5 5 0 0 1 5-5h3"}},{tag:"line",attr:{x1:"8",y1:"12",x2:"16",y2:"12"}}]})(e)}function G(e){return(0,n.k5)({tag:"svg",attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"path",attr:{d:"M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"}},{tag:"path",attr:{d:"M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"}}]})(e)}function z(e){return(0,n.k5)({tag:"svg",attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"path",attr:{d:"M16 8a6 6 0 0 1 6 6v7h-4v-7a2 2 0 0 0-2-2 2 2 0 0 0-2 2v7h-4v-7a6 6 0 0 1 6-6z"}},{tag:"rect",attr:{x:"2",y:"9",width:"4",height:"12"}},{tag:"circle",attr:{cx:"4",cy:"4",r:"2"}}]})(e)}function H(e){return(0,n.k5)({tag:"svg",attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"line",attr:{x1:"8",y1:"6",x2:"21",y2:"6"}},{tag:"line",attr:{x1:"8",y1:"12",x2:"21",y2:"12"}},{tag:"line",attr:{x1:"8",y1:"18",x2:"21",y2:"18"}},{tag:"line",attr:{x1:"3",y1:"6",x2:"3.01",y2:"6"}},{tag:"line",attr:{x1:"3",y1:"12",x2:"3.01",y2:"12"}},{tag:"line",attr:{x1:"3",y1:"18",x2:"3.01",y2:"18"}}]})(e)}function B(e){return(0,n.k5)({tag:"svg",attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"line",attr:{x1:"12",y1:"2",x2:"12",y2:"6"}},{tag:"line",attr:{x1:"12",y1:"18",x2:"12",y2:"22"}},{tag:"line",attr:{x1:"4.93",y1:"4.93",x2:"7.76",y2:"7.76"}},{tag:"line",attr:{x1:"16.24",y1:"16.24",x2:"19.07",y2:"19.07"}},{tag:"line",attr:{x1:"2",y1:"12",x2:"6",y2:"12"}},{tag:"line",attr:{x1:"18",y1:"12",x2:"22",y2:"12"}},{tag:"line",attr:{x1:"4.93",y1:"19.07",x2:"7.76",y2:"16.24"}},{tag:"line",attr:{x1:"16.24",y1:"7.76",x2:"19.07",y2:"4.93"}}]})(e)}function V(e){return(0,n.k5)({tag:"svg",attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"path",attr:{d:"M4 4h16c1.1 0 2 .9 2 2v12c0 1.1-.9 2-2 2H4c-1.1 0-2-.9-2-2V6c0-1.1.9-2 2-2z"}},{tag:"polyline",attr:{points:"22,6 12,13 2,6"}}]})(e)}function $(e){return(0,n.k5)({tag:"svg",attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"path",attr:{d:"M21 10c0 7-9 13-9 13s-9-6-9-13a9 9 0 0 1 18 0z"}},{tag:"circle",attr:{cx:"12",cy:"10",r:"3"}}]})(e)}function U(e){return(0,n.k5)({tag:"svg",attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"line",attr:{x1:"3",y1:"12",x2:"21",y2:"12"}},{tag:"line",attr:{x1:"3",y1:"6",x2:"21",y2:"6"}},{tag:"line",attr:{x1:"3",y1:"18",x2:"21",y2:"18"}}]})(e)}function W(e){return(0,n.k5)({tag:"svg",attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"path",attr:{d:"M21 11.5a8.38 8.38 0 0 1-.9 3.8 8.5 8.5 0 0 1-7.6 4.7 8.38 8.38 0 0 1-3.8-.9L3 21l1.9-5.7a8.38 8.38 0 0 1-.9-3.8 8.5 8.5 0 0 1 4.7-7.6 8.38 8.38 0 0 1 3.8-.9h.5a8.48 8.48 0 0 1 8 8v.5z"}}]})(e)}function q(e){return(0,n.k5)({tag:"svg",attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"path",attr:{d:"M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z"}}]})(e)}function K(e){return(0,n.k5)({tag:"svg",attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"line",attr:{x1:"16.5",y1:"9.4",x2:"7.5",y2:"4.21"}},{tag:"path",attr:{d:"M21 16V8a2 2 0 0 0-1-1.73l-7-4a2 2 0 0 0-2 0l-7 4A2 2 0 0 0 3 8v8a2 2 0 0 0 1 1.73l7 4a2 2 0 0 0 2 0l7-4A2 2 0 0 0 21 16z"}},{tag:"polyline",attr:{points:"3.27 6.96 12 12.01 20.73 6.96"}},{tag:"line",attr:{x1:"12",y1:"22.08",x2:"12",y2:"12"}}]})(e)}function Y(e){return(0,n.k5)({tag:"svg",attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"path",attr:{d:"M21.44 11.05l-9.19 9.19a6 6 0 0 1-8.49-8.49l9.19-9.19a4 4 0 0 1 5.66 5.66l-9.2 9.19a2 2 0 0 1-2.83-2.83l8.49-8.48"}}]})(e)}function J(e){return(0,n.k5)({tag:"svg",attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"path",attr:{d:"M22 16.92v3a2 2 0 0 1-2.18 2 19.79 19.79 0 0 1-8.63-3.07 19.5 19.5 0 0 1-6-6 19.79 19.79 0 0 1-3.07-8.67A2 2 0 0 1 4.11 2h3a2 2 0 0 1 2 1.72 12.84 12.84 0 0 0 .7 2.81 2 2 0 0 1-.45 2.11L8.09 9.91a16 16 0 0 0 6 6l1.27-1.27a2 2 0 0 1 2.11-.45 12.84 12.84 0 0 0 2.81.7A2 2 0 0 1 22 16.92z"}}]})(e)}function X(e){return(0,n.k5)({tag:"svg",attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"line",attr:{x1:"12",y1:"5",x2:"12",y2:"19"}},{tag:"line",attr:{x1:"5",y1:"12",x2:"19",y2:"12"}}]})(e)}function Q(e){return(0,n.k5)({tag:"svg",attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"polyline",attr:{points:"23 4 23 10 17 10"}},{tag:"polyline",attr:{points:"1 20 1 14 7 14"}},{tag:"path",attr:{d:"M3.51 9a9 9 0 0 1 14.85-3.36L23 10M1 14l4.64 4.36A9 9 0 0 0 20.49 15"}}]})(e)}function Z(e){return(0,n.k5)({tag:"svg",attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"path",attr:{d:"M19 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h11l5 5v11a2 2 0 0 1-2 2z"}},{tag:"polyline",attr:{points:"17 21 17 13 7 13 7 21"}},{tag:"polyline",attr:{points:"7 3 7 8 15 8"}}]})(e)}function ee(e){return(0,n.k5)({tag:"svg",attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"circle",attr:{cx:"11",cy:"11",r:"8"}},{tag:"line",attr:{x1:"21",y1:"21",x2:"16.65",y2:"16.65"}}]})(e)}function te(e){return(0,n.k5)({tag:"svg",attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"polygon",attr:{points:"5 4 15 12 5 20 5 4"}},{tag:"line",attr:{x1:"19",y1:"5",x2:"19",y2:"19"}}]})(e)}function oe(e){return(0,n.k5)({tag:"svg",attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"polygon",attr:{points:"12 2 15.09 8.26 22 9.27 17 14.14 18.18 21.02 12 17.77 5.82 21.02 7 14.14 2 9.27 8.91 8.26 12 2"}}]})(e)}function ne(e){return(0,n.k5)({tag:"svg",attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"path",attr:{d:"M20.59 13.41l-7.17 7.17a2 2 0 0 1-2.83 0L2 12V2h10l8.59 8.59a2 2 0 0 1 0 2.82z"}},{tag:"line",attr:{x1:"7",y1:"7",x2:"7.01",y2:"7"}}]})(e)}function re(e){return(0,n.k5)({tag:"svg",attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"polyline",attr:{points:"3 6 5 6 21 6"}},{tag:"path",attr:{d:"M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6m3 0V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2"}},{tag:"line",attr:{x1:"10",y1:"11",x2:"10",y2:"17"}},{tag:"line",attr:{x1:"14",y1:"11",x2:"14",y2:"17"}}]})(e)}function ie(e){return(0,n.k5)({tag:"svg",attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"polyline",attr:{points:"3 6 5 6 21 6"}},{tag:"path",attr:{d:"M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6m3 0V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2"}}]})(e)}function ae(e){return(0,n.k5)({tag:"svg",attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"path",attr:{d:"M16 21v-2a4 4 0 0 0-4-4H5a4 4 0 0 0-4 4v2"}},{tag:"circle",attr:{cx:"8.5",cy:"7",r:"4"}},{tag:"polyline",attr:{points:"17 11 19 13 23 9"}}]})(e)}function se(e){return(0,n.k5)({tag:"svg",attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"path",attr:{d:"M16 21v-2a4 4 0 0 0-4-4H5a4 4 0 0 0-4 4v2"}},{tag:"circle",attr:{cx:"8.5",cy:"7",r:"4"}},{tag:"line",attr:{x1:"20",y1:"8",x2:"20",y2:"14"}},{tag:"line",attr:{x1:"23",y1:"11",x2:"17",y2:"11"}}]})(e)}function le(e){return(0,n.k5)({tag:"svg",attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"path",attr:{d:"M20 21v-2a4 4 0 0 0-4-4H8a4 4 0 0 0-4 4v2"}},{tag:"circle",attr:{cx:"12",cy:"7",r:"4"}}]})(e)}function ce(e){return(0,n.k5)({tag:"svg",attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"path",attr:{d:"M17 21v-2a4 4 0 0 0-4-4H5a4 4 0 0 0-4 4v2"}},{tag:"circle",attr:{cx:"9",cy:"7",r:"4"}},{tag:"path",attr:{d:"M23 21v-2a4 4 0 0 0-3-3.87"}},{tag:"path",attr:{d:"M16 3.13a4 4 0 0 1 0 7.75"}}]})(e)}function de(e){return(0,n.k5)({tag:"svg",attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"circle",attr:{cx:"12",cy:"12",r:"10"}},{tag:"line",attr:{x1:"15",y1:"9",x2:"9",y2:"15"}},{tag:"line",attr:{x1:"9",y1:"9",x2:"15",y2:"15"}}]})(e)}function ue(e){return(0,n.k5)({tag:"svg",attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"line",attr:{x1:"18",y1:"6",x2:"6",y2:"18"}},{tag:"line",attr:{x1:"6",y1:"6",x2:"18",y2:"18"}}]})(e)}},1111:(e,t)=>{"use strict";t.J=void 0,function(e){e.IdentityCheck="IdentityCheck",e.DeepValueCheck="DeepValueCheck",e.NoCheck="NoCheck"}(t.J||(t.J={}))},1153:(e,t,o)=>{"use strict";var n=o(5043),r=Symbol.for("react.element"),i=Symbol.for("react.fragment"),a=Object.prototype.hasOwnProperty,s=n.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,l={key:!0,ref:!0,__self:!0,__source:!0};function c(e,t,o){var n,i={},c=null,d=null;for(n in void 0!==o&&(c=""+o),void 0!==t.key&&(c=""+t.key),void 0!==t.ref&&(d=t.ref),t)a.call(t,n)&&!l.hasOwnProperty(n)&&(i[n]=t[n]);if(e&&e.defaultProps)for(n in t=e.defaultProps)void 0===i[n]&&(i[n]=t[n]);return{$$typeof:r,type:e,key:c,ref:d,props:i,_owner:s.current}}t.Fragment=i,t.jsx=c,t.jsxs=c},1210:function(e,t,o){"use strict";var n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const r=n(o(8829)),i=n(o(5736)),a=o(5745);class s{constructor(e){let{headers:t={},schema:o,fetch:n}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};this.url=e,this.headers=Object.assign(Object.assign({},a.DEFAULT_HEADERS),t),this.schemaName=o,this.fetch=n}from(e){const t=new URL(`${this.url}/${e}`);return new r.default(t,{headers:Object.assign({},this.headers),schema:this.schemaName,fetch:this.fetch})}schema(e){return new s(this.url,{headers:this.headers,schema:e,fetch:this.fetch})}rpc(e){let t,o=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},{head:n=!1,get:r=!1,count:a}=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};const s=new URL(`${this.url}/rpc/${e}`);let l;n||r?(t=n?"HEAD":"GET",Object.entries(o).filter((e=>{let[t,o]=e;return void 0!==o})).map((e=>{let[t,o]=e;return[t,Array.isArray(o)?`{${o.join(",")}}`:`${o}`]})).forEach((e=>{let[t,o]=e;s.searchParams.append(t,o)}))):(t="POST",l=o);const c=Object.assign({},this.headers);return a&&(c.Prefer=`count=${a}`),new i.default({method:t,url:s,headers:c,schema:this.schemaName,body:l,fetch:this.fetch,allowEmpty:!1})}}t.default=s},1292:(e,t,o)=>{"use strict";o.d(t,{A:()=>S});var n=o(5043),r=o(2963),i=o.n(r),a=o(1009),s=o(5315),l=o(1529),c=o(579);const d=l.Ay.div`
  display: flex;
  justify-content: space-between;
  align-items: center;
  margin-bottom: 15px;
  padding-bottom: 15px;
  border-bottom: 1px solid #333;

  h2 {
    margin: 0;
    font-size: 1.25rem;
    color: #00ff00;
    font-weight: 600;
  }

  button {
    background: none;
    border: none;
    cursor: pointer;
    color: #ffffff;
    padding: 4px;
    border-radius: 4px;
    
    &:hover {
      color: #ff5555;
    }
  }
`,u=l.Ay.div`
  margin-bottom: 15px;
`,p=l.Ay.h3`
  font-size: 16px;
  font-weight: bold;
  color: #00ff00;
  margin-bottom: 12px;
  display: flex;
  align-items: center;
  gap: 8px;
`,h=l.Ay.div`
  display: flex;
  flex-wrap: wrap;
  gap: 8px;
  margin-bottom: 16px;
  padding: 5px 0;
  min-height: 32px;
`,f=l.Ay.div`
  display: inline-flex;
  align-items: center;
  padding: 4px 8px;
  background-color: #222;
  color: #00ff00;
  border: 1px solid #00ff00;
  border-radius: 4px;
  font-size: 0.875rem;
  gap: 6px;
  max-width: 200px;

  span {
    white-space: nowrap;
    overflow: hidden;
    text-overflow: ellipsis;
    max-width: 150px;
  }

  button {
    background: none;
    border: none;
    padding: 2px;
    cursor: pointer;
    color: #00ff00;
    opacity: 0.7;
    display: flex;
    align-items: center;
    justify-content: center;
    flex-shrink: 0;

    &:hover {
      opacity: 1;
      color: #ff5555;
    }
  }
`,g=l.Ay.div`
  position: relative;
  margin-bottom: 16px;
  width: 90%;
`,m=l.Ay.div`
  position: absolute;
  left: 10px;
  top: 50%;
  transform: translateY(-50%);
  color: #999;
`,y=l.Ay.input`
  width: 100%;
  padding: 10px 10px 10px 35px;
  border: 1px solid #444;
  background-color: #222;
  color: #eee;
  border-radius: 4px;
  font-size: 0.875rem;
  outline: none;
  transition: border-color 0.2s;

  &:focus {
    border-color: #00ff00;
  }
`,v=l.Ay.div`
  position: relative;
  margin-top: 5px;
  border: 1px solid #444;
  border-radius: 4px;
  max-height: 200px;
  overflow-y: auto;
  background-color: #222;
  box-shadow: 0 4px 6px rgba(0, 0, 0, 0.3);
  z-index: 10;
`,b=l.Ay.button`
  width: 100%;
  text-align: left;
  padding: 8px 12px;
  border: none;
  background: none;
  cursor: pointer;
  font-size: 0.875rem;
  color: #eee;
  transition: background-color 0.2s;
  display: flex;
  align-items: center;
  justify-content: space-between;

  &:hover {
    background-color: #333;
    color: #00ff00;
  }

  &:not(:last-child) {
    border-bottom: 1px solid #333;
  }
`,x=l.Ay.button`
  width: 100%;
  text-align: left;
  padding: 8px 12px;
  border: none;
  background-color: #333;
  cursor: pointer;
  font-size: 0.875rem;
  color: #00ff00;
  display: flex;
  align-items: center;
  gap: 5px;
  transition: background-color 0.2s;

  &:hover {
    background-color: #444;
  }
`,w=l.Ay.div`
  padding: 10px;
  border-radius: 4px;
  margin-bottom: 15px;
  font-size: 0.875rem;

  &.success {
    background-color: #d1fae5;
    color: #065f46;
  }

  &.error {
    background-color: #fee2e2;
    color: #b91c1c;
  }
`,C=l.Ay.div`
  display: flex;
  justify-content: flex-end;
  gap: 10px;
  margin-top: 20px;
`,_=l.Ay.button`
  padding: 8px 16px;
  border-radius: 4px;
  font-size: 0.875rem;
  font-weight: 500;
  cursor: pointer;
  transition: all 0.2s;
  display: flex;
  align-items: center;
  gap: 8px;

  &.primary {
    background-color: #00ff00;
    color: black;
    border: none;

    &:hover {
      background-color: #00dd00;
    }
  }

  &.secondary {
    background-color: transparent;
    color: #ccc;
    border: 1px solid #555;

    &:hover {
      background-color: #333;
    }
  }

  &:disabled {
    opacity: 0.5;
    cursor: not-allowed;
  }
`,S=e=>{let{isOpen:t,onRequestClose:o,contact:r,onCityAdded:l,onCityRemoved:S}=e;const[E,k]=(0,n.useState)([]),[j,A]=(0,n.useState)(""),[R,O]=(0,n.useState)([]),[T,D]=(0,n.useState)(!1),[P,N]=(0,n.useState)({type:"",text:""}),[I,M]=(0,n.useState)(!1),L=async()=>{try{console.log("Fetching related cities for contact ID:",r.contact_id);const{data:e,error:t}=await s.supabase.from("contact_cities").select("\n          city_id,\n          cities:city_id(city_id, name)\n        ").eq("contact_id",r.contact_id);if(t)throw t;console.log("Raw city data from DB:",e);const o=e.map((e=>{var t;return{id:e.city_id,name:(null===(t=e.cities)||void 0===t?void 0:t.name)||"Unknown City"}}));if(0===o.length&&e.length>0){console.log("Cities data format mismatch, trying alternative format");const t=await Promise.all(e.map((async e=>{try{const{data:t}=await s.supabase.from("cities").select("city_id, name").eq("city_id",e.city_id).single();return{id:e.city_id,name:(null===t||void 0===t?void 0:t.name)||"Unknown City"}}catch(t){return console.error("Error fetching individual city:",t),{id:e.city_id,name:"Failed to load"}}})));if(t.length>0)return console.log("Using alternative cities format:",t),void k(t)}console.log("Formatted cities:",o),k(o)}catch(e){console.error("Error fetching related cities:",e),N({type:"error",text:"Failed to load cities"})}};(0,n.useEffect)((()=>{t&&r&&L()}),[t,r]),(0,n.useEffect)((()=>{j.length>=2?((async e=>{try{if(e.length<2)return void O([]);const{data:t,error:o}=await s.supabase.from("cities").select("*").ilike("name",`%${e}%`).limit(10);if(o)throw o;console.log("City suggestions from DB:",t);const n=t.filter((e=>(console.log("Checking if city is already connected:",e),!E.some((t=>(console.log("  Comparing with related city:",t),t.id===e.city_id))))));O(n)}catch(t){console.error("Error fetching city suggestions:",t)}})(j),M(!0)):(O([]),M(!1))}),[j]);const F=async e=>{try{let o;if(D(!0),console.log("Adding city:",e),console.log("Full Contact Object:",r),console.log("Contact ID:",null===r||void 0===r?void 0:r.contact_id),console.log("Contact Keys:",Object.keys(r||{})),r.contact_id)o=r.contact_id;else{if(!r.id)throw console.error("Cannot find contact ID in contact object:",r),new Error("Invalid contact ID - missing from contact object");o=r.id}console.log("Using contact ID:",o),console.log("City to add:",e);const{data:n,error:i}=await s.supabase.from("contact_cities").select("contact_id, city_id").eq("contact_id",o).eq("city_id",e.city_id||e.id);if(i)throw console.error("Error checking existing city:",i),i;if(console.log("Existing check result:",n),n&&n.length>0)return console.log("City already linked:",n),void N({type:"info",text:"This city is already linked to the contact"});const a={contact_id:o,city_id:e.city_id||e.id,created_at:(new Date).toISOString()};console.log("Creating new association:",a);const{data:c,error:d}=await s.supabase.from("contact_cities").insert(a).select();if(d)throw console.error("Error inserting city:",d),d;if(console.log("Successfully added city:",c),l&&"function"===typeof l){var t;const o={city_id:e.city_id||e.id,name:e.name,entry_id:(null===(t=c[0])||void 0===t?void 0:t.entry_id)||`temp-${Date.now()}`};console.log("Notifying parent about new city:",o),l(o)}await L(),A(""),M(!1),N({type:"success",text:"City linked successfully"})}catch(o){console.error("Error linking city:",o),N({type:"error",text:`Failed to link city: ${o.message}`})}finally{D(!1)}};return(0,n.useEffect)((()=>{P.text&&setTimeout((()=>{N({type:"",text:""})}),3e3)}),[P]),(0,c.jsx)(i(),{isOpen:t,onRequestClose:o,style:{content:{top:"50%",left:"50%",right:"auto",bottom:"auto",marginRight:"-50%",transform:"translate(-50%, -50%)",padding:"20px",border:"1px solid #333",backgroundColor:"#121212",color:"#e0e0e0",borderRadius:"8px",boxShadow:"0 4px 20px rgba(0, 0, 0, 0.6)",maxWidth:"500px",width:"90%",minHeight:"360px"},overlay:{backgroundColor:"rgba(0, 0, 0, 0.75)",zIndex:1e3}},children:(0,c.jsxs)("div",{style:{padding:"1rem"},children:[(0,c.jsxs)(d,{children:[(0,c.jsx)("h2",{children:"Manage Cities"}),(0,c.jsx)("button",{onClick:o,"aria-label":"Close modal",children:(0,c.jsx)(a.yGN,{size:20})})]}),(0,c.jsxs)(u,{children:[(0,c.jsx)(p,{children:"Related Cities"}),(0,c.jsxs)(h,{children:[E.map((e=>{const t={bg:"#222",text:"#00ff00",border:"#00ff00"};return(0,c.jsxs)(f,{color:t.bg,textColor:t.text,children:[(0,c.jsx)("span",{title:e.name,children:e.name}),(0,c.jsx)("button",{onClick:()=>(async e=>{try{D(!0);const{error:t}=await s.supabase.from("contact_cities").delete().eq("contact_id",r.contact_id).eq("city_id",e.id);if(t)throw t;k(E.filter((t=>t.id!==e.id))),S&&"function"===typeof S&&(console.log("Notifying parent about removed city:",e),S(e)),N({type:"success",text:"City unlinked successfully"})}catch(t){console.error("Error unlinking city:",t),N({type:"error",text:"Failed to unlink city"})}finally{D(!1)}})(e),disabled:T,title:"Unlink city",children:(0,c.jsx)(a.yGN,{size:14})})]},e.id)})),0===E.length&&(0,c.jsx)("span",{style:{color:"#6c757d",fontStyle:"italic",padding:"4px"},children:"No cities linked"})]})]}),(0,c.jsxs)(u,{children:[(0,c.jsx)(p,{children:"Add Cities"}),(0,c.jsxs)(g,{children:[(0,c.jsx)(m,{children:(0,c.jsx)(a.CKj,{size:16})}),(0,c.jsx)(y,{type:"text",value:j,onChange:e=>A(e.target.value),placeholder:"Search for a city (type at least 2 letters)..."})]}),I&&(0,c.jsxs)(v,{children:[R.map((e=>(0,c.jsx)(b,{onClick:()=>F(e),disabled:T,children:e.name},e.id))),0===R.length&&j.length>=2&&(0,c.jsx)("div",{style:{padding:"8px 12px",color:"#6c757d",fontSize:"0.875rem"},children:"No cities found"}),j.length>=2&&(0,c.jsxs)(x,{onClick:async()=>{try{D(!0);const{data:e,error:t}=await s.supabase.from("cities").insert({name:j.trim(),country:"Unknown",created_at:(new Date).toISOString()}).select();if(t)throw t;e&&e[0]&&await F(e[0])}catch(e){console.error("Error creating city:",e),N({type:"error",text:"Failed to create city"})}finally{D(!1)}},disabled:T,children:[(0,c.jsx)(a.GGD,{size:14}),'Create "',j,'" as new city']})]})]}),P.text&&(0,c.jsx)(w,{className:P.type,children:P.text}),(0,c.jsx)(C,{children:(0,c.jsx)(_,{className:"primary",onClick:o,children:"Done"})}),T&&(0,c.jsx)("div",{style:{textAlign:"center",marginTop:"10px"},children:(0,c.jsx)("div",{className:"spinner",style:{width:"20px",height:"20px",border:"3px solid #f3f3f3",borderTop:"3px solid #007BFF",borderRadius:"50%",animation:"spin 1s linear infinite"}})})]})})},E=document.createElement("style");E.innerHTML="\n  @keyframes spin {\n    0% { transform: rotate(0deg); }\n    100% { transform: rotate(360deg); }\n  }\n",document.head.appendChild(E)},1387:(e,t,o)=>{"use strict";function n(){return n=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var o=arguments[t];for(var n in o)Object.prototype.hasOwnProperty.call(o,n)&&(e[n]=o[n])}return e},n.apply(this,arguments)}var r;o.d(t,{AO:()=>u,Gh:()=>M,HS:()=>L,Oi:()=>s,Rr:()=>p,VV:()=>B,aE:()=>oe,pX:()=>V,pb:()=>D,rc:()=>r,tH:()=>H,ue:()=>y,yD:()=>I,zR:()=>a}),function(e){e.Pop="POP",e.Push="PUSH",e.Replace="REPLACE"}(r||(r={}));const i="popstate";function a(e){return void 0===e&&(e={}),h((function(e,t){let{pathname:o,search:n,hash:r}=e.location;return d("",{pathname:o,search:n,hash:r},t.state&&t.state.usr||null,t.state&&t.state.key||"default")}),(function(e,t){return"string"===typeof t?t:u(t)}),null,e)}function s(e,t){if(!1===e||null===e||"undefined"===typeof e)throw new Error(t)}function l(e,t){if(!e){"undefined"!==typeof console&&console.warn(t);try{throw new Error(t)}catch(o){}}}function c(e,t){return{usr:e.state,key:e.key,idx:t}}function d(e,t,o,r){return void 0===o&&(o=null),n({pathname:"string"===typeof e?e:e.pathname,search:"",hash:""},"string"===typeof t?p(t):t,{state:o,key:t&&t.key||r||Math.random().toString(36).substr(2,8)})}function u(e){let{pathname:t="/",search:o="",hash:n=""}=e;return o&&"?"!==o&&(t+="?"===o.charAt(0)?o:"?"+o),n&&"#"!==n&&(t+="#"===n.charAt(0)?n:"#"+n),t}function p(e){let t={};if(e){let o=e.indexOf("#");o>=0&&(t.hash=e.substr(o),e=e.substr(0,o));let n=e.indexOf("?");n>=0&&(t.search=e.substr(n),e=e.substr(0,n)),e&&(t.pathname=e)}return t}function h(e,t,o,a){void 0===a&&(a={});let{window:l=document.defaultView,v5Compat:p=!1}=a,h=l.history,f=r.Pop,g=null,m=y();function y(){return(h.state||{idx:null}).idx}function v(){f=r.Pop;let e=y(),t=null==e?null:e-m;m=e,g&&g({action:f,location:x.location,delta:t})}function b(e){let t="null"!==l.location.origin?l.location.origin:l.location.href,o="string"===typeof e?e:u(e);return o=o.replace(/ $/,"%20"),s(t,"No window.location.(origin|href) available to create URL for href: "+o),new URL(o,t)}null==m&&(m=0,h.replaceState(n({},h.state,{idx:m}),""));let x={get action(){return f},get location(){return e(l,h)},listen(e){if(g)throw new Error("A history only accepts one active listener");return l.addEventListener(i,v),g=e,()=>{l.removeEventListener(i,v),g=null}},createHref:e=>t(l,e),createURL:b,encodeLocation(e){let t=b(e);return{pathname:t.pathname,search:t.search,hash:t.hash}},push:function(e,t){f=r.Push;let n=d(x.location,e,t);o&&o(n,e),m=y()+1;let i=c(n,m),a=x.createHref(n);try{h.pushState(i,"",a)}catch(s){if(s instanceof DOMException&&"DataCloneError"===s.name)throw s;l.location.assign(a)}p&&g&&g({action:f,location:x.location,delta:1})},replace:function(e,t){f=r.Replace;let n=d(x.location,e,t);o&&o(n,e),m=y();let i=c(n,m),a=x.createHref(n);h.replaceState(i,"",a),p&&g&&g({action:f,location:x.location,delta:0})},go:e=>h.go(e)};return x}var f;!function(e){e.data="data",e.deferred="deferred",e.redirect="redirect",e.error="error"}(f||(f={}));const g=new Set(["lazy","caseSensitive","path","id","index","children"]);function m(e,t,o,r){return void 0===o&&(o=[]),void 0===r&&(r={}),e.map(((e,i)=>{let a=[...o,String(i)],l="string"===typeof e.id?e.id:a.join("-");if(s(!0!==e.index||!e.children,"Cannot specify children on an index route"),s(!r[l],'Found a route id collision on id "'+l+"\".  Route id's must be globally unique within Data Router usages"),function(e){return!0===e.index}(e)){let o=n({},e,t(e),{id:l});return r[l]=o,o}{let o=n({},e,t(e),{id:l,children:void 0});return r[l]=o,e.children&&(o.children=m(e.children,t,a,r)),o}}))}function y(e,t,o){return void 0===o&&(o="/"),v(e,t,o,!1)}function v(e,t,o,n){let r=D(("string"===typeof t?p(t):t).pathname||"/",o);if(null==r)return null;let i=b(e);!function(e){e.sort(((e,t)=>e.score!==t.score?t.score-e.score:function(e,t){let o=e.length===t.length&&e.slice(0,-1).every(((e,o)=>e===t[o]));return o?e[e.length-1]-t[t.length-1]:0}(e.routesMeta.map((e=>e.childrenIndex)),t.routesMeta.map((e=>e.childrenIndex)))))}(i);let a=null;for(let s=0;null==a&&s<i.length;++s){let e=T(r);a=R(i[s],e,n)}return a}function b(e,t,o,n){void 0===t&&(t=[]),void 0===o&&(o=[]),void 0===n&&(n="");let r=(e,r,i)=>{let a={relativePath:void 0===i?e.path||"":i,caseSensitive:!0===e.caseSensitive,childrenIndex:r,route:e};a.relativePath.startsWith("/")&&(s(a.relativePath.startsWith(n),'Absolute route path "'+a.relativePath+'" nested under path "'+n+'" is not valid. An absolute child route path must start with the combined path of all its parent routes.'),a.relativePath=a.relativePath.slice(n.length));let l=L([n,a.relativePath]),c=o.concat(a);e.children&&e.children.length>0&&(s(!0!==e.index,'Index routes must not have child routes. Please remove all child routes from route path "'+l+'".'),b(e.children,t,c,l)),(null!=e.path||e.index)&&t.push({path:l,score:A(l,e.index),routesMeta:c})};return e.forEach(((e,t)=>{var o;if(""!==e.path&&null!=(o=e.path)&&o.includes("?"))for(let n of x(e.path))r(e,t,n);else r(e,t)})),t}function x(e){let t=e.split("/");if(0===t.length)return[];let[o,...n]=t,r=o.endsWith("?"),i=o.replace(/\?$/,"");if(0===n.length)return r?[i,""]:[i];let a=x(n.join("/")),s=[];return s.push(...a.map((e=>""===e?i:[i,e].join("/")))),r&&s.push(...a),s.map((t=>e.startsWith("/")&&""===t?"/":t))}const w=/^:[\w-]+$/,C=3,_=2,S=1,E=10,k=-2,j=e=>"*"===e;function A(e,t){let o=e.split("/"),n=o.length;return o.some(j)&&(n+=k),t&&(n+=_),o.filter((e=>!j(e))).reduce(((e,t)=>e+(w.test(t)?C:""===t?S:E)),n)}function R(e,t,o){void 0===o&&(o=!1);let{routesMeta:n}=e,r={},i="/",a=[];for(let s=0;s<n.length;++s){let e=n[s],l=s===n.length-1,c="/"===i?t:t.slice(i.length)||"/",d=O({path:e.relativePath,caseSensitive:e.caseSensitive,end:l},c),u=e.route;if(!d&&l&&o&&!n[n.length-1].route.index&&(d=O({path:e.relativePath,caseSensitive:e.caseSensitive,end:!1},c)),!d)return null;Object.assign(r,d.params),a.push({params:r,pathname:L([i,d.pathname]),pathnameBase:F(L([i,d.pathnameBase])),route:u}),"/"!==d.pathnameBase&&(i=L([i,d.pathnameBase]))}return a}function O(e,t){"string"===typeof e&&(e={path:e,caseSensitive:!1,end:!0});let[o,n]=function(e,t,o){void 0===t&&(t=!1);void 0===o&&(o=!0);l("*"===e||!e.endsWith("*")||e.endsWith("/*"),'Route path "'+e+'" will be treated as if it were "'+e.replace(/\*$/,"/*")+'" because the `*` character must always follow a `/` in the pattern. To get rid of this warning, please change the route path to "'+e.replace(/\*$/,"/*")+'".');let n=[],r="^"+e.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,((e,t,o)=>(n.push({paramName:t,isOptional:null!=o}),o?"/?([^\\/]+)?":"/([^\\/]+)")));e.endsWith("*")?(n.push({paramName:"*"}),r+="*"===e||"/*"===e?"(.*)$":"(?:\\/(.+)|\\/*)$"):o?r+="\\/*$":""!==e&&"/"!==e&&(r+="(?:(?=\\/|$))");let i=new RegExp(r,t?void 0:"i");return[i,n]}(e.path,e.caseSensitive,e.end),r=t.match(o);if(!r)return null;let i=r[0],a=i.replace(/(.)\/+$/,"$1"),s=r.slice(1);return{params:n.reduce(((e,t,o)=>{let{paramName:n,isOptional:r}=t;if("*"===n){let e=s[o]||"";a=i.slice(0,i.length-e.length).replace(/(.)\/+$/,"$1")}const l=s[o];return e[n]=r&&!l?void 0:(l||"").replace(/%2F/g,"/"),e}),{}),pathname:i,pathnameBase:a,pattern:e}}function T(e){try{return e.split("/").map((e=>decodeURIComponent(e).replace(/\//g,"%2F"))).join("/")}catch(t){return l(!1,'The URL path "'+e+'" could not be decoded because it is is a malformed URL segment. This is probably due to a bad percent encoding ('+t+")."),e}}function D(e,t){if("/"===t)return e;if(!e.toLowerCase().startsWith(t.toLowerCase()))return null;let o=t.endsWith("/")?t.length-1:t.length,n=e.charAt(o);return n&&"/"!==n?null:e.slice(o)||"/"}function P(e,t,o,n){return"Cannot include a '"+e+"' character in a manually specified `to."+t+"` field ["+JSON.stringify(n)+"].  Please separate it out to the `to."+o+'` field. Alternatively you may provide the full path as a string in <Link to="..."> and the router will parse it for you.'}function N(e){return e.filter(((e,t)=>0===t||e.route.path&&e.route.path.length>0))}function I(e,t){let o=N(e);return t?o.map(((e,t)=>t===o.length-1?e.pathname:e.pathnameBase)):o.map((e=>e.pathnameBase))}function M(e,t,o,r){let i;void 0===r&&(r=!1),"string"===typeof e?i=p(e):(i=n({},e),s(!i.pathname||!i.pathname.includes("?"),P("?","pathname","search",i)),s(!i.pathname||!i.pathname.includes("#"),P("#","pathname","hash",i)),s(!i.search||!i.search.includes("#"),P("#","search","hash",i)));let a,l=""===e||""===i.pathname,c=l?"/":i.pathname;if(null==c)a=o;else{let e=t.length-1;if(!r&&c.startsWith("..")){let t=c.split("/");for(;".."===t[0];)t.shift(),e-=1;i.pathname=t.join("/")}a=e>=0?t[e]:"/"}let d=function(e,t){void 0===t&&(t="/");let{pathname:o,search:n="",hash:r=""}="string"===typeof e?p(e):e,i=o?o.startsWith("/")?o:function(e,t){let o=t.replace(/\/+$/,"").split("/");return e.split("/").forEach((e=>{".."===e?o.length>1&&o.pop():"."!==e&&o.push(e)})),o.length>1?o.join("/"):"/"}(o,t):t;return{pathname:i,search:G(n),hash:z(r)}}(i,a),u=c&&"/"!==c&&c.endsWith("/"),h=(l||"."===c)&&o.endsWith("/");return d.pathname.endsWith("/")||!u&&!h||(d.pathname+="/"),d}const L=e=>e.join("/").replace(/\/\/+/g,"/"),F=e=>e.replace(/\/+$/,"").replace(/^\/*/,"/"),G=e=>e&&"?"!==e?e.startsWith("?")?e:"?"+e:"",z=e=>e&&"#"!==e?e.startsWith("#")?e:"#"+e:"";class H extends Error{}class B{constructor(e,t,o,n){void 0===n&&(n=!1),this.status=e,this.statusText=t||"",this.internal=n,o instanceof Error?(this.data=o.toString(),this.error=o):this.data=o}}function V(e){return null!=e&&"number"===typeof e.status&&"string"===typeof e.statusText&&"boolean"===typeof e.internal&&"data"in e}const $=["post","put","patch","delete"],U=new Set($),W=["get",...$],q=new Set(W),K=new Set([301,302,303,307,308]),Y=new Set([307,308]),J={state:"idle",location:void 0,formMethod:void 0,formAction:void 0,formEncType:void 0,formData:void 0,json:void 0,text:void 0},X={state:"idle",data:void 0,formMethod:void 0,formAction:void 0,formEncType:void 0,formData:void 0,json:void 0,text:void 0},Q={state:"unblocked",proceed:void 0,reset:void 0,location:void 0},Z=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,ee=e=>({hasErrorBoundary:Boolean(e.hasErrorBoundary)}),te="remix-router-transitions";function oe(e){const t=e.window?e.window:"undefined"!==typeof window?window:void 0,o="undefined"!==typeof t&&"undefined"!==typeof t.document&&"undefined"!==typeof t.document.createElement,i=!o;let a;if(s(e.routes.length>0,"You must provide a non-empty routes array to createRouter"),e.mapRouteProperties)a=e.mapRouteProperties;else if(e.detectErrorBoundary){let t=e.detectErrorBoundary;a=e=>({hasErrorBoundary:t(e)})}else a=ee;let c,u,p,h={},g=m(e.routes,a,void 0,h),b=e.basename||"/",x=e.dataStrategy||pe,w=e.patchRoutesOnNavigation,C=n({v7_fetcherPersist:!1,v7_normalizeFormMethod:!1,v7_partialHydration:!1,v7_prependBasename:!1,v7_relativeSplatPath:!1,v7_skipActionErrorRevalidation:!1},e.future),_=null,S=new Set,E=null,k=null,j=null,A=null!=e.hydrationData,R=y(g,e.history.location,b),O=!1,T=null;if(null==R&&!w){let t=ke(404,{pathname:e.history.location.pathname}),{matches:o,route:n}=Ee(g);R=o,T={[n.id]:t}}if(R&&!e.hydrationData){ct(R,g,e.history.location.pathname).active&&(R=null)}if(R)if(R.some((e=>e.route.lazy)))u=!1;else if(R.some((e=>e.route.loader)))if(C.v7_partialHydration){let t=e.hydrationData?e.hydrationData.loaderData:null,o=e.hydrationData?e.hydrationData.errors:null;if(o){let e=R.findIndex((e=>void 0!==o[e.route.id]));u=R.slice(0,e+1).every((e=>!se(e.route,t,o)))}else u=R.every((e=>!se(e.route,t,o)))}else u=null!=e.hydrationData;else u=!0;else if(u=!1,R=[],C.v7_partialHydration){let t=ct(null,g,e.history.location.pathname);t.active&&t.matches&&(O=!0,R=t.matches)}let P,N,I={historyAction:e.history.action,location:e.history.location,matches:R,initialized:u,navigation:J,restoreScrollPosition:null==e.hydrationData&&null,preventScrollReset:!1,revalidation:"idle",loaderData:e.hydrationData&&e.hydrationData.loaderData||{},actionData:e.hydrationData&&e.hydrationData.actionData||null,errors:e.hydrationData&&e.hydrationData.errors||T,fetchers:new Map,blockers:new Map},M=r.Pop,L=!1,F=!1,G=new Map,z=null,H=!1,B=!1,$=[],U=new Set,W=new Map,q=0,K=-1,oe=new Map,ie=new Set,le=new Map,ce=new Map,ue=new Set,ve=new Map,be=new Map;function xe(e,t){void 0===t&&(t={}),I=n({},I,e);let o=[],r=[];C.v7_fetcherPersist&&I.fetchers.forEach(((e,t)=>{"idle"===e.state&&(ue.has(t)?r.push(t):o.push(t))})),ue.forEach((e=>{I.fetchers.has(e)||W.has(e)||r.push(e)})),[...S].forEach((e=>e(I,{deletedFetchers:r,viewTransitionOpts:t.viewTransitionOpts,flushSync:!0===t.flushSync}))),C.v7_fetcherPersist?(o.forEach((e=>I.fetchers.delete(e))),r.forEach((e=>Xe(e)))):r.forEach((e=>ue.delete(e)))}function Ae(t,o,i){var a,s;let l,{flushSync:d}=void 0===i?{}:i,u=null!=I.actionData&&null!=I.navigation.formMethod&&Me(I.navigation.formMethod)&&"loading"===I.navigation.state&&!0!==(null==(a=t.state)?void 0:a._isRedirect);l=o.actionData?Object.keys(o.actionData).length>0?o.actionData:null:u?I.actionData:null;let p=o.loaderData?Ce(I.loaderData,o.loaderData,o.matches||[],o.errors):I.loaderData,h=I.blockers;h.size>0&&(h=new Map(h),h.forEach(((e,t)=>h.set(t,Q))));let f,m=!0===L||null!=I.navigation.formMethod&&Me(I.navigation.formMethod)&&!0!==(null==(s=t.state)?void 0:s._isRedirect);if(c&&(g=c,c=void 0),H||M===r.Pop||(M===r.Push?e.history.push(t,t.state):M===r.Replace&&e.history.replace(t,t.state)),M===r.Pop){let e=G.get(I.location.pathname);e&&e.has(t.pathname)?f={currentLocation:I.location,nextLocation:t}:G.has(t.pathname)&&(f={currentLocation:t,nextLocation:I.location})}else if(F){let e=G.get(I.location.pathname);e?e.add(t.pathname):(e=new Set([t.pathname]),G.set(I.location.pathname,e)),f={currentLocation:I.location,nextLocation:t}}xe(n({},o,{actionData:l,loaderData:p,historyAction:M,location:t,initialized:!0,navigation:J,revalidation:"idle",restoreScrollPosition:lt(t,o.matches||I.matches),preventScrollReset:m,blockers:h}),{viewTransitionOpts:f,flushSync:!0===d}),M=r.Pop,L=!1,F=!1,H=!1,B=!1,$=[]}async function Pe(t,o,i){P&&P.abort(),P=null,M=t,H=!0===(i&&i.startUninterruptedRevalidation),function(e,t){if(E&&j){let o=st(e,t);E[o]=j()}}(I.location,I.matches),L=!0===(i&&i.preventScrollReset),F=!0===(i&&i.enableViewTransition);let a=c||g,s=i&&i.overrideNavigation,l=null!=i&&i.initialHydration&&I.matches&&I.matches.length>0&&!O?I.matches:y(a,o,b),d=!0===(i&&i.flushSync);if(l&&I.initialized&&!B&&function(e,t){if(e.pathname!==t.pathname||e.search!==t.search)return!1;if(""===e.hash)return""!==t.hash;if(e.hash===t.hash)return!0;if(""!==t.hash)return!0;return!1}(I.location,o)&&!(i&&i.submission&&Me(i.submission.formMethod)))return void Ae(o,{matches:l},{flushSync:d});let u=ct(l,a,o.pathname);if(u.active&&u.matches&&(l=u.matches),!l){let{error:e,notFoundMatches:t,route:n}=it(o.pathname);return void Ae(o,{matches:t,loaderData:{},errors:{[n.id]:e}},{flushSync:d})}P=new AbortController;let p,h=ye(e.history,o,P.signal,i&&i.submission);if(i&&i.pendingError)p=[Se(l).route.id,{type:f.error,error:i.pendingError}];else if(i&&i.submission&&Me(i.submission.formMethod)){let t=await async function(e,t,o,n,i,a){void 0===a&&(a={});qe();let s,l=function(e,t){let o={state:"submitting",location:e,formMethod:t.formMethod,formAction:t.formAction,formEncType:t.formEncType,formData:t.formData,json:t.json,text:t.text};return o}(t,o);if(xe({navigation:l},{flushSync:!0===a.flushSync}),i){let o=await dt(n,t.pathname,e.signal);if("aborted"===o.type)return{shortCircuited:!0};if("error"===o.type){let e=Se(o.partialMatches).route.id;return{matches:o.partialMatches,pendingActionResult:[e,{type:f.error,error:o.error}]}}if(!o.matches){let{notFoundMatches:e,error:o,route:n}=it(t.pathname);return{matches:e,pendingActionResult:[n.id,{type:f.error,error:o}]}}n=o.matches}let c=He(n,t);if(c.route.action||c.route.lazy){if(s=(await ze("action",I,e,[c],n,null))[c.route.id],e.signal.aborted)return{shortCircuited:!0}}else s={type:f.error,error:ke(405,{method:e.method,pathname:t.pathname,routeId:c.route.id})};if(De(s)){let t;if(a&&null!=a.replace)t=a.replace;else{t=me(s.response.headers.get("Location"),new URL(e.url),b)===I.location.pathname+I.location.search}return await Ie(e,s,!0,{submission:o,replace:t}),{shortCircuited:!0}}if(Oe(s))throw ke(400,{type:"defer-action"});if(Te(s)){let e=Se(n,c.route.id);return!0!==(a&&a.replace)&&(M=r.Push),{matches:n,pendingActionResult:[e.route.id,s]}}return{matches:n,pendingActionResult:[c.route.id,s]}}(h,o,i.submission,l,u.active,{replace:i.replace,flushSync:d});if(t.shortCircuited)return;if(t.pendingActionResult){let[e,n]=t.pendingActionResult;if(Te(n)&&V(n.error)&&404===n.error.status)return P=null,void Ae(o,{matches:t.matches,loaderData:{},errors:{[e]:n.error}})}l=t.matches||l,p=t.pendingActionResult,s=Ve(o,i.submission),d=!1,u.active=!1,h=ye(e.history,h.url,h.signal)}let{shortCircuited:m,matches:v,loaderData:x,errors:w}=await async function(t,o,r,i,a,s,l,d,u,p,h){let f=a||Ve(o,s),m=s||l||Be(f),y=!H&&(!C.v7_partialHydration||!u);if(i){if(y){let e=Ne(h);xe(n({navigation:f},void 0!==e?{actionData:e}:{}),{flushSync:p})}let e=await dt(r,o.pathname,t.signal);if("aborted"===e.type)return{shortCircuited:!0};if("error"===e.type){let t=Se(e.partialMatches).route.id;return{matches:e.partialMatches,loaderData:{},errors:{[t]:e.error}}}if(!e.matches){let{error:e,notFoundMatches:t,route:n}=it(o.pathname);return{matches:t,loaderData:{},errors:{[n.id]:e}}}r=e.matches}let v=c||g,[x,w]=ae(e.history,I,r,m,o,C.v7_partialHydration&&!0===u,C.v7_skipActionErrorRevalidation,B,$,U,ue,le,ie,v,b,h);if(at((e=>!(r&&r.some((t=>t.route.id===e)))||x&&x.some((t=>t.route.id===e)))),K=++q,0===x.length&&0===w.length){let e=et();return Ae(o,n({matches:r,loaderData:{},errors:h&&Te(h[1])?{[h[0]]:h[1].error}:null},_e(h),e?{fetchers:new Map(I.fetchers)}:{}),{flushSync:p}),{shortCircuited:!0}}if(y){let e={};if(!i){e.navigation=f;let t=Ne(h);void 0!==t&&(e.actionData=t)}w.length>0&&(e.fetchers=function(e){return e.forEach((e=>{let t=I.fetchers.get(e.key),o=$e(void 0,t?t.data:void 0);I.fetchers.set(e.key,o)})),new Map(I.fetchers)}(w)),xe(e,{flushSync:p})}w.forEach((e=>{Qe(e.key),e.controller&&W.set(e.key,e.controller)}));let _=()=>w.forEach((e=>Qe(e.key)));P&&P.signal.addEventListener("abort",_);let{loaderResults:S,fetcherResults:E}=await We(I,r,x,w,t);if(t.signal.aborted)return{shortCircuited:!0};P&&P.signal.removeEventListener("abort",_);w.forEach((e=>W.delete(e.key)));let k=je(S);if(k)return await Ie(t,k.result,!0,{replace:d}),{shortCircuited:!0};if(k=je(E),k)return ie.add(k.key),await Ie(t,k.result,!0,{replace:d}),{shortCircuited:!0};let{loaderData:j,errors:A}=we(I,r,S,h,w,E,ve);ve.forEach(((e,t)=>{e.subscribe((o=>{(o||e.done)&&ve.delete(t)}))})),C.v7_partialHydration&&u&&I.errors&&(A=n({},I.errors,A));let R=et(),O=tt(K),T=R||O||w.length>0;return n({matches:r,loaderData:j,errors:A},T?{fetchers:new Map(I.fetchers)}:{})}(h,o,l,u.active,s,i&&i.submission,i&&i.fetcherSubmission,i&&i.replace,i&&!0===i.initialHydration,d,p);m||(P=null,Ae(o,n({matches:v||l},_e(p),{loaderData:x,errors:w})))}function Ne(e){return e&&!Te(e[1])?{[e[0]]:e[1].data}:I.actionData?0===Object.keys(I.actionData).length?null:I.actionData:void 0}async function Ie(i,a,l,c){let{submission:u,fetcherSubmission:p,preventScrollReset:h,replace:f}=void 0===c?{}:c;a.response.headers.has("X-Remix-Revalidate")&&(B=!0);let g=a.response.headers.get("Location");s(g,"Expected a Location header on the redirect Response"),g=me(g,new URL(i.url),b);let m=d(I.location,g,{_isRedirect:!0});if(o){let o=!1;if(a.response.headers.has("X-Remix-Reload-Document"))o=!0;else if(Z.test(g)){const n=e.history.createURL(g);o=n.origin!==t.location.origin||null==D(n.pathname,b)}if(o)return void(f?t.location.replace(g):t.location.assign(g))}P=null;let y=!0===f||a.response.headers.has("X-Remix-Replace")?r.Replace:r.Push,{formMethod:v,formAction:x,formEncType:w}=I.navigation;!u&&!p&&v&&x&&w&&(u=Be(I.navigation));let C=u||p;if(Y.has(a.response.status)&&C&&Me(C.formMethod))await Pe(y,m,{submission:n({},C,{formAction:g}),preventScrollReset:h||L,enableViewTransition:l?F:void 0});else{let e=Ve(m,u);await Pe(y,m,{overrideNavigation:e,fetcherSubmission:p,preventScrollReset:h||L,enableViewTransition:l?F:void 0})}}async function ze(e,t,o,n,r,i){let s,l={};try{s=await he(x,e,t,o,n,r,i,h,a)}catch(c){return n.forEach((e=>{l[e.route.id]={type:f.error,error:c}})),l}for(let[a,d]of Object.entries(s))if(Re(d)){let e=d.result;l[a]={type:f.redirect,response:ge(e,o,a,r,b,C.v7_relativeSplatPath)}}else l[a]=await fe(d);return l}async function We(t,o,n,r,i){let a=t.matches,s=ze("loader",t,i,n,o,null),l=Promise.all(r.map((async o=>{if(o.matches&&o.match&&o.controller){let n=(await ze("loader",t,ye(e.history,o.path,o.controller.signal),[o.match],o.matches,o.key))[o.match.route.id];return{[o.key]:n}}return Promise.resolve({[o.key]:{type:f.error,error:ke(404,{pathname:o.path})}})}))),c=await s,d=(await l).reduce(((e,t)=>Object.assign(e,t)),{});return await Promise.all([Le(o,c,i.signal,a,t.loaderData),Fe(o,d,r)]),{loaderResults:c,fetcherResults:d}}function qe(){B=!0,$.push(...at()),le.forEach(((e,t)=>{W.has(t)&&U.add(t),Qe(t)}))}function Ke(e,t,o){void 0===o&&(o={}),I.fetchers.set(e,t),xe({fetchers:new Map(I.fetchers)},{flushSync:!0===(o&&o.flushSync)})}function Ye(e,t,o,n){void 0===n&&(n={});let r=Se(I.matches,t);Xe(e),xe({errors:{[r.route.id]:o},fetchers:new Map(I.fetchers)},{flushSync:!0===(n&&n.flushSync)})}function Je(e){return ce.set(e,(ce.get(e)||0)+1),ue.has(e)&&ue.delete(e),I.fetchers.get(e)||X}function Xe(e){let t=I.fetchers.get(e);!W.has(e)||t&&"loading"===t.state&&oe.has(e)||Qe(e),le.delete(e),oe.delete(e),ie.delete(e),C.v7_fetcherPersist&&ue.delete(e),U.delete(e),I.fetchers.delete(e)}function Qe(e){let t=W.get(e);t&&(t.abort(),W.delete(e))}function Ze(e){for(let t of e){let e=Ue(Je(t).data);I.fetchers.set(t,e)}}function et(){let e=[],t=!1;for(let o of ie){let n=I.fetchers.get(o);s(n,"Expected fetcher: "+o),"loading"===n.state&&(ie.delete(o),e.push(o),t=!0)}return Ze(e),t}function tt(e){let t=[];for(let[o,n]of oe)if(n<e){let e=I.fetchers.get(o);s(e,"Expected fetcher: "+o),"loading"===e.state&&(Qe(o),oe.delete(o),t.push(o))}return Ze(t),t.length>0}function ot(e){I.blockers.delete(e),be.delete(e)}function nt(e,t){let o=I.blockers.get(e)||Q;s("unblocked"===o.state&&"blocked"===t.state||"blocked"===o.state&&"blocked"===t.state||"blocked"===o.state&&"proceeding"===t.state||"blocked"===o.state&&"unblocked"===t.state||"proceeding"===o.state&&"unblocked"===t.state,"Invalid blocker state transition: "+o.state+" -> "+t.state);let n=new Map(I.blockers);n.set(e,t),xe({blockers:n})}function rt(e){let{currentLocation:t,nextLocation:o,historyAction:n}=e;if(0===be.size)return;be.size>1&&l(!1,"A router only supports one blocker at a time");let r=Array.from(be.entries()),[i,a]=r[r.length-1],s=I.blockers.get(i);return s&&"proceeding"===s.state?void 0:a({currentLocation:t,nextLocation:o,historyAction:n})?i:void 0}function it(e){let t=ke(404,{pathname:e}),o=c||g,{matches:n,route:r}=Ee(o);return at(),{notFoundMatches:n,route:r,error:t}}function at(e){let t=[];return ve.forEach(((o,n)=>{e&&!e(n)||(o.cancel(),t.push(n),ve.delete(n))})),t}function st(e,t){if(k){return k(e,t.map((e=>function(e,t){let{route:o,pathname:n,params:r}=e;return{id:o.id,pathname:n,params:r,data:t[o.id],handle:o.handle}}(e,I.loaderData))))||e.key}return e.key}function lt(e,t){if(E){let o=st(e,t),n=E[o];if("number"===typeof n)return n}return null}function ct(e,t,o){if(w){if(!e){return{active:!0,matches:v(t,o,b,!0)||[]}}if(Object.keys(e[0].params).length>0){return{active:!0,matches:v(t,o,b,!0)}}}return{active:!1,matches:null}}async function dt(e,t,o,n){if(!w)return{type:"success",matches:e};let r=e;for(;;){let e=null==c,s=c||g,l=h;try{await w({signal:o,path:t,matches:r,fetcherKey:n,patch:(e,t)=>{o.aborted||de(e,t,s,l,a)}})}catch(i){return{type:"error",error:i,partialMatches:r}}finally{e&&!o.aborted&&(g=[...g])}if(o.aborted)return{type:"aborted"};let d=y(s,t,b);if(d)return{type:"success",matches:d};let u=v(s,t,b,!0);if(!u||r.length===u.length&&r.every(((e,t)=>e.route.id===u[t].route.id)))return{type:"success",matches:null};r=u}}return p={get basename(){return b},get future(){return C},get state(){return I},get routes(){return g},get window(){return t},initialize:function(){if(_=e.history.listen((t=>{let{action:o,location:n,delta:r}=t;if(N)return N(),void(N=void 0);l(0===be.size||null!=r,"You are trying to use a blocker on a POP navigation to a location that was not created by @remix-run/router. This will fail silently in production. This can happen if you are navigating outside the router via `window.history.pushState`/`window.location.hash` instead of using router navigation APIs.  This can also happen if you are using createHashRouter and the user manually changes the URL.");let i=rt({currentLocation:I.location,nextLocation:n,historyAction:o});if(i&&null!=r){let t=new Promise((e=>{N=e}));return e.history.go(-1*r),void nt(i,{state:"blocked",location:n,proceed(){nt(i,{state:"proceeding",proceed:void 0,reset:void 0,location:n}),t.then((()=>e.history.go(r)))},reset(){let e=new Map(I.blockers);e.set(i,Q),xe({blockers:e})}})}return Pe(o,n)})),o){!function(e,t){try{let o=e.sessionStorage.getItem(te);if(o){let e=JSON.parse(o);for(let[o,n]of Object.entries(e||{}))n&&Array.isArray(n)&&t.set(o,new Set(n||[]))}}catch(o){}}(t,G);let e=()=>function(e,t){if(t.size>0){let n={};for(let[e,o]of t)n[e]=[...o];try{e.sessionStorage.setItem(te,JSON.stringify(n))}catch(o){l(!1,"Failed to save applied view transitions in sessionStorage ("+o+").")}}}(t,G);t.addEventListener("pagehide",e),z=()=>t.removeEventListener("pagehide",e)}return I.initialized||Pe(r.Pop,I.location,{initialHydration:!0}),p},subscribe:function(e){return S.add(e),()=>S.delete(e)},enableScrollRestoration:function(e,t,o){if(E=e,j=t,k=o||null,!A&&I.navigation===J){A=!0;let e=lt(I.location,I.matches);null!=e&&xe({restoreScrollPosition:e})}return()=>{E=null,j=null,k=null}},navigate:async function t(o,i){if("number"===typeof o)return void e.history.go(o);let a=ne(I.location,I.matches,b,C.v7_prependBasename,o,C.v7_relativeSplatPath,null==i?void 0:i.fromRouteId,null==i?void 0:i.relative),{path:s,submission:l,error:c}=re(C.v7_normalizeFormMethod,!1,a,i),u=I.location,p=d(I.location,s,i&&i.state);p=n({},p,e.history.encodeLocation(p));let h=i&&null!=i.replace?i.replace:void 0,f=r.Push;!0===h?f=r.Replace:!1===h||null!=l&&Me(l.formMethod)&&l.formAction===I.location.pathname+I.location.search&&(f=r.Replace);let g=i&&"preventScrollReset"in i?!0===i.preventScrollReset:void 0,m=!0===(i&&i.flushSync),y=rt({currentLocation:u,nextLocation:p,historyAction:f});if(!y)return await Pe(f,p,{submission:l,pendingError:c,preventScrollReset:g,replace:i&&i.replace,enableViewTransition:i&&i.viewTransition,flushSync:m});nt(y,{state:"blocked",location:p,proceed(){nt(y,{state:"proceeding",proceed:void 0,reset:void 0,location:p}),t(o,i)},reset(){let e=new Map(I.blockers);e.set(y,Q),xe({blockers:e})}})},fetch:function(t,o,n,r){if(i)throw new Error("router.fetch() was called during the server render, but it shouldn't be. You are likely calling a useFetcher() method in the body of your component. Try moving it to a useEffect or a callback.");Qe(t);let a=!0===(r&&r.flushSync),l=c||g,d=ne(I.location,I.matches,b,C.v7_prependBasename,n,C.v7_relativeSplatPath,o,null==r?void 0:r.relative),u=y(l,d,b),p=ct(u,l,d);if(p.active&&p.matches&&(u=p.matches),!u)return void Ye(t,o,ke(404,{pathname:d}),{flushSync:a});let{path:h,submission:f,error:m}=re(C.v7_normalizeFormMethod,!0,d,r);if(m)return void Ye(t,o,m,{flushSync:a});let v=He(u,h),x=!0===(r&&r.preventScrollReset);f&&Me(f.formMethod)?async function(t,o,n,r,i,a,l,d,u){function p(e){if(!e.route.action&&!e.route.lazy){let e=ke(405,{method:u.formMethod,pathname:n,routeId:o});return Ye(t,o,e,{flushSync:l}),!0}return!1}if(qe(),le.delete(t),!a&&p(r))return;let h=I.fetchers.get(t);Ke(t,function(e,t){let o={state:"submitting",formMethod:e.formMethod,formAction:e.formAction,formEncType:e.formEncType,formData:e.formData,json:e.json,text:e.text,data:t?t.data:void 0};return o}(u,h),{flushSync:l});let f=new AbortController,m=ye(e.history,n,f.signal,u);if(a){let e=await dt(i,new URL(m.url).pathname,m.signal,t);if("aborted"===e.type)return;if("error"===e.type)return void Ye(t,o,e.error,{flushSync:l});if(!e.matches)return void Ye(t,o,ke(404,{pathname:n}),{flushSync:l});if(p(r=He(i=e.matches,n)))return}W.set(t,f);let v=q,x=await ze("action",I,m,[r],i,t),w=x[r.route.id];if(m.signal.aborted)return void(W.get(t)===f&&W.delete(t));if(C.v7_fetcherPersist&&ue.has(t)){if(De(w)||Te(w))return void Ke(t,Ue(void 0))}else{if(De(w))return W.delete(t),K>v?void Ke(t,Ue(void 0)):(ie.add(t),Ke(t,$e(u)),Ie(m,w,!1,{fetcherSubmission:u,preventScrollReset:d}));if(Te(w))return void Ye(t,o,w.error)}if(Oe(w))throw ke(400,{type:"defer-action"});let _=I.navigation.location||I.location,S=ye(e.history,_,f.signal),E=c||g,k="idle"!==I.navigation.state?y(E,I.navigation.location,b):I.matches;s(k,"Didn't find any matches after fetcher action");let j=++q;oe.set(t,j);let A=$e(u,w.data);I.fetchers.set(t,A);let[R,O]=ae(e.history,I,k,u,_,!1,C.v7_skipActionErrorRevalidation,B,$,U,ue,le,ie,E,b,[r.route.id,w]);O.filter((e=>e.key!==t)).forEach((e=>{let t=e.key,o=I.fetchers.get(t),n=$e(void 0,o?o.data:void 0);I.fetchers.set(t,n),Qe(t),e.controller&&W.set(t,e.controller)})),xe({fetchers:new Map(I.fetchers)});let T=()=>O.forEach((e=>Qe(e.key)));f.signal.addEventListener("abort",T);let{loaderResults:D,fetcherResults:N}=await We(I,k,R,O,S);if(f.signal.aborted)return;f.signal.removeEventListener("abort",T),oe.delete(t),W.delete(t),O.forEach((e=>W.delete(e.key)));let L=je(D);if(L)return Ie(S,L.result,!1,{preventScrollReset:d});if(L=je(N),L)return ie.add(L.key),Ie(S,L.result,!1,{preventScrollReset:d});let{loaderData:F,errors:G}=we(I,k,D,void 0,O,N,ve);if(I.fetchers.has(t)){let e=Ue(w.data);I.fetchers.set(t,e)}tt(j),"loading"===I.navigation.state&&j>K?(s(M,"Expected pending action"),P&&P.abort(),Ae(I.navigation.location,{matches:k,loaderData:F,errors:G,fetchers:new Map(I.fetchers)})):(xe({errors:G,loaderData:Ce(I.loaderData,F,k,G),fetchers:new Map(I.fetchers)}),B=!1)}(t,o,h,v,u,p.active,a,x,f):(le.set(t,{routeId:o,path:h}),async function(t,o,n,r,i,a,l,c,d){let u=I.fetchers.get(t);Ke(t,$e(d,u?u.data:void 0),{flushSync:l});let p=new AbortController,h=ye(e.history,n,p.signal);if(a){let e=await dt(i,new URL(h.url).pathname,h.signal,t);if("aborted"===e.type)return;if("error"===e.type)return void Ye(t,o,e.error,{flushSync:l});if(!e.matches)return void Ye(t,o,ke(404,{pathname:n}),{flushSync:l});r=He(i=e.matches,n)}W.set(t,p);let f=q,g=await ze("loader",I,h,[r],i,t),m=g[r.route.id];Oe(m)&&(m=await Ge(m,h.signal,!0)||m);W.get(t)===p&&W.delete(t);if(h.signal.aborted)return;if(ue.has(t))return void Ke(t,Ue(void 0));if(De(m))return K>f?void Ke(t,Ue(void 0)):(ie.add(t),void await Ie(h,m,!1,{preventScrollReset:c}));if(Te(m))return void Ye(t,o,m.error);s(!Oe(m),"Unhandled fetcher deferred data"),Ke(t,Ue(m.data))}(t,o,h,v,u,p.active,a,x,f))},revalidate:function(){qe(),xe({revalidation:"loading"}),"submitting"!==I.navigation.state&&("idle"!==I.navigation.state?Pe(M||I.historyAction,I.navigation.location,{overrideNavigation:I.navigation,enableViewTransition:!0===F}):Pe(I.historyAction,I.location,{startUninterruptedRevalidation:!0}))},createHref:t=>e.history.createHref(t),encodeLocation:t=>e.history.encodeLocation(t),getFetcher:Je,deleteFetcher:function(e){let t=(ce.get(e)||0)-1;t<=0?(ce.delete(e),ue.add(e),C.v7_fetcherPersist||Xe(e)):ce.set(e,t),xe({fetchers:new Map(I.fetchers)})},dispose:function(){_&&_(),z&&z(),S.clear(),P&&P.abort(),I.fetchers.forEach(((e,t)=>Xe(t))),I.blockers.forEach(((e,t)=>ot(t)))},getBlocker:function(e,t){let o=I.blockers.get(e)||Q;return be.get(e)!==t&&be.set(e,t),o},deleteBlocker:ot,patchRoutes:function(e,t){let o=null==c;de(e,t,c||g,h,a),o&&(g=[...g],xe({}))},_internalFetchControllers:W,_internalActiveDeferreds:ve,_internalSetRoutes:function(e){h={},c=m(e,a,void 0,h)}},p}Symbol("deferred");function ne(e,t,o,n,r,i,a,s){let l,c;if(a){l=[];for(let e of t)if(l.push(e),e.route.id===a){c=e;break}}else l=t,c=t[t.length-1];let d=M(r||".",I(l,i),D(e.pathname,o)||e.pathname,"path"===s);if(null==r&&(d.search=e.search,d.hash=e.hash),(null==r||""===r||"."===r)&&c){let e=ze(d.search);if(c.route.index&&!e)d.search=d.search?d.search.replace(/^\?/,"?index&"):"?index";else if(!c.route.index&&e){let e=new URLSearchParams(d.search),t=e.getAll("index");e.delete("index"),t.filter((e=>e)).forEach((t=>e.append("index",t)));let o=e.toString();d.search=o?"?"+o:""}}return n&&"/"!==o&&(d.pathname="/"===d.pathname?o:L([o,d.pathname])),u(d)}function re(e,t,o,n){if(!n||!function(e){return null!=e&&("formData"in e&&null!=e.formData||"body"in e&&void 0!==e.body)}(n))return{path:o};if(n.formMethod&&!Ie(n.formMethod))return{path:o,error:ke(405,{method:n.formMethod})};let r,i,a=()=>({path:o,error:ke(400,{type:"invalid-body"})}),l=n.formMethod||"get",c=e?l.toUpperCase():l.toLowerCase(),d=Ae(o);if(void 0!==n.body){if("text/plain"===n.formEncType){if(!Me(c))return a();let e="string"===typeof n.body?n.body:n.body instanceof FormData||n.body instanceof URLSearchParams?Array.from(n.body.entries()).reduce(((e,t)=>{let[o,n]=t;return""+e+o+"="+n+"\n"}),""):String(n.body);return{path:o,submission:{formMethod:c,formAction:d,formEncType:n.formEncType,formData:void 0,json:void 0,text:e}}}if("application/json"===n.formEncType){if(!Me(c))return a();try{let e="string"===typeof n.body?JSON.parse(n.body):n.body;return{path:o,submission:{formMethod:c,formAction:d,formEncType:n.formEncType,formData:void 0,json:e,text:void 0}}}catch(g){return a()}}}if(s("function"===typeof FormData,"FormData is not available in this environment"),n.formData)r=ve(n.formData),i=n.formData;else if(n.body instanceof FormData)r=ve(n.body),i=n.body;else if(n.body instanceof URLSearchParams)r=n.body,i=be(r);else if(null==n.body)r=new URLSearchParams,i=new FormData;else try{r=new URLSearchParams(n.body),i=be(r)}catch(g){return a()}let h={formMethod:c,formAction:d,formEncType:n&&n.formEncType||"application/x-www-form-urlencoded",formData:i,json:void 0,text:void 0};if(Me(h.formMethod))return{path:o,submission:h};let f=p(o);return t&&f.search&&ze(f.search)&&r.append("index",""),f.search="?"+r,{path:u(f),submission:h}}function ie(e,t,o){void 0===o&&(o=!1);let n=e.findIndex((e=>e.route.id===t));return n>=0?e.slice(0,o?n+1:n):e}function ae(e,t,o,r,i,a,s,l,c,d,u,p,h,f,g,m){let v=m?Te(m[1])?m[1].error:m[1].data:void 0,b=e.createURL(t.location),x=e.createURL(i),w=o;a&&t.errors?w=ie(o,Object.keys(t.errors)[0],!0):m&&Te(m[1])&&(w=ie(o,m[0]));let C=m?m[1].statusCode:void 0,_=s&&C&&C>=400,S=w.filter(((e,o)=>{let{route:i}=e;if(i.lazy)return!0;if(null==i.loader)return!1;if(a)return se(i,t.loaderData,t.errors);if(function(e,t,o){let n=!t||o.route.id!==t.route.id,r=void 0===e[o.route.id];return n||r}(t.loaderData,t.matches[o],e)||c.some((t=>t===e.route.id)))return!0;let s=t.matches[o],d=e;return ce(e,n({currentUrl:b,currentParams:s.params,nextUrl:x,nextParams:d.params},r,{actionResult:v,actionStatus:C,defaultShouldRevalidate:!_&&(l||b.pathname+b.search===x.pathname+x.search||b.search!==x.search||le(s,d))}))})),E=[];return p.forEach(((e,i)=>{if(a||!o.some((t=>t.route.id===e.routeId))||u.has(i))return;let s=y(f,e.path,g);if(!s)return void E.push({key:i,routeId:e.routeId,path:e.path,matches:null,match:null,controller:null});let c=t.fetchers.get(i),p=He(s,e.path),m=!1;h.has(i)?m=!1:d.has(i)?(d.delete(i),m=!0):m=c&&"idle"!==c.state&&void 0===c.data?l:ce(p,n({currentUrl:b,currentParams:t.matches[t.matches.length-1].params,nextUrl:x,nextParams:o[o.length-1].params},r,{actionResult:v,actionStatus:C,defaultShouldRevalidate:!_&&l})),m&&E.push({key:i,routeId:e.routeId,path:e.path,matches:s,match:p,controller:new AbortController})})),[S,E]}function se(e,t,o){if(e.lazy)return!0;if(!e.loader)return!1;let n=null!=t&&void 0!==t[e.id],r=null!=o&&void 0!==o[e.id];return!(!n&&r)&&("function"===typeof e.loader&&!0===e.loader.hydrate||!n&&!r)}function le(e,t){let o=e.route.path;return e.pathname!==t.pathname||null!=o&&o.endsWith("*")&&e.params["*"]!==t.params["*"]}function ce(e,t){if(e.route.shouldRevalidate){let o=e.route.shouldRevalidate(t);if("boolean"===typeof o)return o}return t.defaultShouldRevalidate}function de(e,t,o,n,r){var i;let a;if(e){let t=n[e];s(t,"No route found to patch children into: routeId = "+e),t.children||(t.children=[]),a=t.children}else a=o;let l=m(t.filter((e=>!a.some((t=>ue(e,t))))),r,[e||"_","patch",String((null==(i=a)?void 0:i.length)||"0")],n);a.push(...l)}function ue(e,t){return"id"in e&&"id"in t&&e.id===t.id||e.index===t.index&&e.path===t.path&&e.caseSensitive===t.caseSensitive&&(!(e.children&&0!==e.children.length||t.children&&0!==t.children.length)||e.children.every(((e,o)=>{var n;return null==(n=t.children)?void 0:n.some((t=>ue(e,t)))})))}async function pe(e){let{matches:t}=e,o=t.filter((e=>e.shouldLoad));return(await Promise.all(o.map((e=>e.resolve())))).reduce(((e,t,n)=>Object.assign(e,{[o[n].route.id]:t})),{})}async function he(e,t,o,r,i,a,c,d,u,p){let h=a.map((e=>e.route.lazy?async function(e,t,o){if(!e.lazy)return;let r=await e.lazy();if(!e.lazy)return;let i=o[e.id];s(i,"No route found in manifest");let a={};for(let n in r){let e=void 0!==i[n]&&"hasErrorBoundary"!==n;l(!e,'Route "'+i.id+'" has a static property "'+n+'" defined but its lazy function is also returning a value for this property. The lazy route property "'+n+'" will be ignored.'),e||g.has(n)||(a[n]=r[n])}Object.assign(i,a),Object.assign(i,n({},t(i),{lazy:void 0}))}(e.route,u,d):void 0)),m=a.map(((e,o)=>{let a=h[o],l=i.some((t=>t.route.id===e.route.id));return n({},e,{shouldLoad:l,resolve:async o=>(o&&"GET"===r.method&&(e.route.lazy||e.route.loader)&&(l=!0),l?async function(e,t,o,n,r,i){let a,l,c=n=>{let a,s=new Promise(((e,t)=>a=t));l=()=>a(),t.signal.addEventListener("abort",l);let c=r=>"function"!==typeof n?Promise.reject(new Error('You cannot call the handler for a route which defines a boolean "'+e+'" [routeId: '+o.route.id+"]")):n({request:t,params:o.params,context:i},...void 0!==r?[r]:[]),d=(async()=>{try{return{type:"data",result:await(r?r((e=>c(e))):c())}}catch(e){return{type:"error",result:e}}})();return Promise.race([d,s])};try{let r=o.route[e];if(n)if(r){let e,[t]=await Promise.all([c(r).catch((t=>{e=t})),n]);if(void 0!==e)throw e;a=t}else{if(await n,r=o.route[e],!r){if("action"===e){let e=new URL(t.url),n=e.pathname+e.search;throw ke(405,{method:t.method,pathname:n,routeId:o.route.id})}return{type:f.data,result:void 0}}a=await c(r)}else{if(!r){let e=new URL(t.url);throw ke(404,{pathname:e.pathname+e.search})}a=await c(r)}s(void 0!==a.result,"You defined "+("action"===e?"an action":"a loader")+' for route "'+o.route.id+"\" but didn't return anything from your `"+e+"` function. Please return a value or `null`.")}catch(d){return{type:f.error,result:d}}finally{l&&t.signal.removeEventListener("abort",l)}return a}(t,r,e,a,o,p):Promise.resolve({type:f.data,result:void 0}))})})),y=await e({matches:m,request:r,params:a[0].params,fetcherKey:c,context:p});try{await Promise.all(h)}catch(v){}return y}async function fe(e){let{result:t,type:o}=e;if(Ne(t)){let e;try{let o=t.headers.get("Content-Type");e=o&&/\bapplication\/json\b/.test(o)?null==t.body?null:await t.json():await t.text()}catch(u){return{type:f.error,error:u}}return o===f.error?{type:f.error,error:new B(t.status,t.statusText,e),statusCode:t.status,headers:t.headers}:{type:f.data,data:e,statusCode:t.status,headers:t.headers}}var n,r,i,a,s,l,c,d;return o===f.error?Pe(t)?t.data instanceof Error?{type:f.error,error:t.data,statusCode:null==(i=t.init)?void 0:i.status,headers:null!=(a=t.init)&&a.headers?new Headers(t.init.headers):void 0}:{type:f.error,error:new B((null==(n=t.init)?void 0:n.status)||500,void 0,t.data),statusCode:V(t)?t.status:void 0,headers:null!=(r=t.init)&&r.headers?new Headers(t.init.headers):void 0}:{type:f.error,error:t,statusCode:V(t)?t.status:void 0}:function(e){let t=e;return t&&"object"===typeof t&&"object"===typeof t.data&&"function"===typeof t.subscribe&&"function"===typeof t.cancel&&"function"===typeof t.resolveData}(t)?{type:f.deferred,deferredData:t,statusCode:null==(s=t.init)?void 0:s.status,headers:(null==(l=t.init)?void 0:l.headers)&&new Headers(t.init.headers)}:Pe(t)?{type:f.data,data:t.data,statusCode:null==(c=t.init)?void 0:c.status,headers:null!=(d=t.init)&&d.headers?new Headers(t.init.headers):void 0}:{type:f.data,data:t}}function ge(e,t,o,n,r,i){let a=e.headers.get("Location");if(s(a,"Redirects returned/thrown from loaders/actions must have a Location header"),!Z.test(a)){let s=n.slice(0,n.findIndex((e=>e.route.id===o))+1);a=ne(new URL(t.url),s,r,!0,a,i),e.headers.set("Location",a)}return e}function me(e,t,o){if(Z.test(e)){let n=e,r=n.startsWith("//")?new URL(t.protocol+n):new URL(n),i=null!=D(r.pathname,o);if(r.origin===t.origin&&i)return r.pathname+r.search+r.hash}return e}function ye(e,t,o,n){let r=e.createURL(Ae(t)).toString(),i={signal:o};if(n&&Me(n.formMethod)){let{formMethod:e,formEncType:t}=n;i.method=e.toUpperCase(),"application/json"===t?(i.headers=new Headers({"Content-Type":t}),i.body=JSON.stringify(n.json)):"text/plain"===t?i.body=n.text:"application/x-www-form-urlencoded"===t&&n.formData?i.body=ve(n.formData):i.body=n.formData}return new Request(r,i)}function ve(e){let t=new URLSearchParams;for(let[o,n]of e.entries())t.append(o,"string"===typeof n?n:n.name);return t}function be(e){let t=new FormData;for(let[o,n]of e.entries())t.append(o,n);return t}function xe(e,t,o,n,r){let i,a={},l=null,c=!1,d={},u=o&&Te(o[1])?o[1].error:void 0;return e.forEach((o=>{if(!(o.route.id in t))return;let p=o.route.id,h=t[p];if(s(!De(h),"Cannot handle redirect results in processLoaderData"),Te(h)){let t=h.error;if(void 0!==u&&(t=u,u=void 0),l=l||{},r)l[p]=t;else{let o=Se(e,p);null==l[o.route.id]&&(l[o.route.id]=t)}a[p]=void 0,c||(c=!0,i=V(h.error)?h.error.status:500),h.headers&&(d[p]=h.headers)}else Oe(h)?(n.set(p,h.deferredData),a[p]=h.deferredData.data,null==h.statusCode||200===h.statusCode||c||(i=h.statusCode),h.headers&&(d[p]=h.headers)):(a[p]=h.data,h.statusCode&&200!==h.statusCode&&!c&&(i=h.statusCode),h.headers&&(d[p]=h.headers))})),void 0!==u&&o&&(l={[o[0]]:u},a[o[0]]=void 0),{loaderData:a,errors:l,statusCode:i||200,loaderHeaders:d}}function we(e,t,o,r,i,a,l){let{loaderData:c,errors:d}=xe(t,o,r,l,!1);return i.forEach((t=>{let{key:o,match:r,controller:i}=t,l=a[o];if(s(l,"Did not find corresponding fetcher result"),!i||!i.signal.aborted)if(Te(l)){let t=Se(e.matches,null==r?void 0:r.route.id);d&&d[t.route.id]||(d=n({},d,{[t.route.id]:l.error})),e.fetchers.delete(o)}else if(De(l))s(!1,"Unhandled fetcher revalidation redirect");else if(Oe(l))s(!1,"Unhandled fetcher deferred data");else{let t=Ue(l.data);e.fetchers.set(o,t)}})),{loaderData:c,errors:d}}function Ce(e,t,o,r){let i=n({},t);for(let n of o){let o=n.route.id;if(t.hasOwnProperty(o)?void 0!==t[o]&&(i[o]=t[o]):void 0!==e[o]&&n.route.loader&&(i[o]=e[o]),r&&r.hasOwnProperty(o))break}return i}function _e(e){return e?Te(e[1])?{actionData:{}}:{actionData:{[e[0]]:e[1].data}}:{}}function Se(e,t){return(t?e.slice(0,e.findIndex((e=>e.route.id===t))+1):[...e]).reverse().find((e=>!0===e.route.hasErrorBoundary))||e[0]}function Ee(e){let t=1===e.length?e[0]:e.find((e=>e.index||!e.path||"/"===e.path))||{id:"__shim-error-route__"};return{matches:[{params:{},pathname:"",pathnameBase:"",route:t}],route:t}}function ke(e,t){let{pathname:o,routeId:n,method:r,type:i,message:a}=void 0===t?{}:t,s="Unknown Server Error",l="Unknown @remix-run/router error";return 400===e?(s="Bad Request",r&&o&&n?l="You made a "+r+' request to "'+o+'" but did not provide a `loader` for route "'+n+'", so there is no way to handle the request.':"defer-action"===i?l="defer() is not supported in actions":"invalid-body"===i&&(l="Unable to encode submission body")):403===e?(s="Forbidden",l='Route "'+n+'" does not match URL "'+o+'"'):404===e?(s="Not Found",l='No route matches URL "'+o+'"'):405===e&&(s="Method Not Allowed",r&&o&&n?l="You made a "+r.toUpperCase()+' request to "'+o+'" but did not provide an `action` for route "'+n+'", so there is no way to handle the request.':r&&(l='Invalid request method "'+r.toUpperCase()+'"')),new B(e||500,s,new Error(l),!0)}function je(e){let t=Object.entries(e);for(let o=t.length-1;o>=0;o--){let[e,n]=t[o];if(De(n))return{key:e,result:n}}}function Ae(e){return u(n({},"string"===typeof e?p(e):e,{hash:""}))}function Re(e){return Ne(e.result)&&K.has(e.result.status)}function Oe(e){return e.type===f.deferred}function Te(e){return e.type===f.error}function De(e){return(e&&e.type)===f.redirect}function Pe(e){return"object"===typeof e&&null!=e&&"type"in e&&"data"in e&&"init"in e&&"DataWithResponseInit"===e.type}function Ne(e){return null!=e&&"number"===typeof e.status&&"string"===typeof e.statusText&&"object"===typeof e.headers&&"undefined"!==typeof e.body}function Ie(e){return q.has(e.toLowerCase())}function Me(e){return U.has(e.toLowerCase())}async function Le(e,t,o,n,r){let i=Object.entries(t);for(let a=0;a<i.length;a++){let[s,l]=i[a],c=e.find((e=>(null==e?void 0:e.route.id)===s));if(!c)continue;let d=n.find((e=>e.route.id===c.route.id)),u=null!=d&&!le(d,c)&&void 0!==(r&&r[c.route.id]);Oe(l)&&u&&await Ge(l,o,!1).then((e=>{e&&(t[s]=e)}))}}async function Fe(e,t,o){for(let n=0;n<o.length;n++){let{key:r,routeId:i,controller:a}=o[n],l=t[r];e.find((e=>(null==e?void 0:e.route.id)===i))&&(Oe(l)&&(s(a,"Expected an AbortController for revalidating fetcher deferred result"),await Ge(l,a.signal,!0).then((e=>{e&&(t[r]=e)}))))}}async function Ge(e,t,o){if(void 0===o&&(o=!1),!await e.deferredData.resolveData(t)){if(o)try{return{type:f.data,data:e.deferredData.unwrappedData}}catch(n){return{type:f.error,error:n}}return{type:f.data,data:e.deferredData.data}}}function ze(e){return new URLSearchParams(e).getAll("index").some((e=>""===e))}function He(e,t){let o="string"===typeof t?p(t).search:t.search;if(e[e.length-1].route.index&&ze(o||""))return e[e.length-1];let n=N(e);return n[n.length-1]}function Be(e){let{formMethod:t,formAction:o,formEncType:n,text:r,formData:i,json:a}=e;if(t&&o&&n)return null!=r?{formMethod:t,formAction:o,formEncType:n,formData:void 0,json:void 0,text:r}:null!=i?{formMethod:t,formAction:o,formEncType:n,formData:i,json:void 0,text:void 0}:void 0!==a?{formMethod:t,formAction:o,formEncType:n,formData:void 0,json:a,text:void 0}:void 0}function Ve(e,t){if(t){return{state:"loading",location:e,formMethod:t.formMethod,formAction:t.formAction,formEncType:t.formEncType,formData:t.formData,json:t.json,text:t.text}}return{state:"loading",location:e,formMethod:void 0,formAction:void 0,formEncType:void 0,formData:void 0,json:void 0,text:void 0}}function $e(e,t){if(e){return{state:"loading",formMethod:e.formMethod,formAction:e.formAction,formEncType:e.formEncType,formData:e.formData,json:e.json,text:e.text,data:t}}return{state:"loading",formMethod:void 0,formAction:void 0,formEncType:void 0,formData:void 0,json:void 0,text:void 0,data:t}}function Ue(e){return{state:"idle",formMethod:void 0,formAction:void 0,formEncType:void 0,formData:void 0,json:void 0,text:void 0,data:e}}},1439:(e,t,o)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var o=arguments[t];for(var n in o)Object.prototype.hasOwnProperty.call(o,n)&&(e[n]=o[n])}return e},r="function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"===typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},i=function(){function e(e,t){for(var o=0;o<t.length;o++){var n=t[o];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,o,n){return o&&e(t.prototype,o),n&&e(t,n),t}}(),a=o(5043),s=m(o(5173)),l=g(o(1774)),c=m(o(2206)),d=g(o(6619)),u=g(o(4841)),p=o(8821),h=m(p),f=m(o(2959));function g(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o]);return t.default=e,t}function m(e){return e&&e.__esModule?e:{default:e}}o(6062);var y={overlay:"ReactModal__Overlay",content:"ReactModal__Content"},v=0,b=function(e){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var o=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!==typeof t&&"function"!==typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return o.setOverlayRef=function(e){o.overlay=e,o.props.overlayRef&&o.props.overlayRef(e)},o.setContentRef=function(e){o.content=e,o.props.contentRef&&o.props.contentRef(e)},o.afterClose=function(){var e=o.props,t=e.appElement,n=e.ariaHideApp,r=e.htmlOpenClassName,i=e.bodyOpenClassName,a=e.parentSelector,s=a&&a().ownerDocument||document;i&&u.remove(s.body,i),r&&u.remove(s.getElementsByTagName("html")[0],r),n&&v>0&&0===(v-=1)&&d.show(t),o.props.shouldFocusAfterRender&&(o.props.shouldReturnFocusAfterClose?(l.returnFocus(o.props.preventScroll),l.teardownScopedFocus()):l.popWithoutFocus()),o.props.onAfterClose&&o.props.onAfterClose(),f.default.deregister(o)},o.open=function(){o.beforeOpen(),o.state.afterOpen&&o.state.beforeClose?(clearTimeout(o.closeTimer),o.setState({beforeClose:!1})):(o.props.shouldFocusAfterRender&&(l.setupScopedFocus(o.node),l.markForFocusLater()),o.setState({isOpen:!0},(function(){o.openAnimationFrame=requestAnimationFrame((function(){o.setState({afterOpen:!0}),o.props.isOpen&&o.props.onAfterOpen&&o.props.onAfterOpen({overlayEl:o.overlay,contentEl:o.content})}))})))},o.close=function(){o.props.closeTimeoutMS>0?o.closeWithTimeout():o.closeWithoutTimeout()},o.focusContent=function(){return o.content&&!o.contentHasFocus()&&o.content.focus({preventScroll:!0})},o.closeWithTimeout=function(){var e=Date.now()+o.props.closeTimeoutMS;o.setState({beforeClose:!0,closesAt:e},(function(){o.closeTimer=setTimeout(o.closeWithoutTimeout,o.state.closesAt-Date.now())}))},o.closeWithoutTimeout=function(){o.setState({beforeClose:!1,isOpen:!1,afterOpen:!1,closesAt:null},o.afterClose)},o.handleKeyDown=function(e){(function(e){return"Tab"===e.code||9===e.keyCode})(e)&&(0,c.default)(o.content,e),o.props.shouldCloseOnEsc&&function(e){return"Escape"===e.code||27===e.keyCode}(e)&&(e.stopPropagation(),o.requestClose(e))},o.handleOverlayOnClick=function(e){null===o.shouldClose&&(o.shouldClose=!0),o.shouldClose&&o.props.shouldCloseOnOverlayClick&&(o.ownerHandlesClose()?o.requestClose(e):o.focusContent()),o.shouldClose=null},o.handleContentOnMouseUp=function(){o.shouldClose=!1},o.handleOverlayOnMouseDown=function(e){o.props.shouldCloseOnOverlayClick||e.target!=o.overlay||e.preventDefault()},o.handleContentOnClick=function(){o.shouldClose=!1},o.handleContentOnMouseDown=function(){o.shouldClose=!1},o.requestClose=function(e){return o.ownerHandlesClose()&&o.props.onRequestClose(e)},o.ownerHandlesClose=function(){return o.props.onRequestClose},o.shouldBeClosed=function(){return!o.state.isOpen&&!o.state.beforeClose},o.contentHasFocus=function(){return document.activeElement===o.content||o.content.contains(document.activeElement)},o.buildClassName=function(e,t){var n="object"===("undefined"===typeof t?"undefined":r(t))?t:{base:y[e],afterOpen:y[e]+"--after-open",beforeClose:y[e]+"--before-close"},i=n.base;return o.state.afterOpen&&(i=i+" "+n.afterOpen),o.state.beforeClose&&(i=i+" "+n.beforeClose),"string"===typeof t&&t?i+" "+t:i},o.attributesFromObject=function(e,t){return Object.keys(t).reduce((function(o,n){return o[e+"-"+n]=t[n],o}),{})},o.state={afterOpen:!1,beforeClose:!1},o.shouldClose=null,o.moveFromContentToOverlay=null,o}return function(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),i(t,[{key:"componentDidMount",value:function(){this.props.isOpen&&this.open()}},{key:"componentDidUpdate",value:function(e,t){this.props.isOpen&&!e.isOpen?this.open():!this.props.isOpen&&e.isOpen&&this.close(),this.props.shouldFocusAfterRender&&this.state.isOpen&&!t.isOpen&&this.focusContent()}},{key:"componentWillUnmount",value:function(){this.state.isOpen&&this.afterClose(),clearTimeout(this.closeTimer),cancelAnimationFrame(this.openAnimationFrame)}},{key:"beforeOpen",value:function(){var e=this.props,t=e.appElement,o=e.ariaHideApp,n=e.htmlOpenClassName,r=e.bodyOpenClassName,i=e.parentSelector,a=i&&i().ownerDocument||document;r&&u.add(a.body,r),n&&u.add(a.getElementsByTagName("html")[0],n),o&&(v+=1,d.hide(t)),f.default.register(this)}},{key:"render",value:function(){var e=this.props,t=e.id,o=e.className,r=e.overlayClassName,i=e.defaultStyles,a=e.children,s=o?{}:i.content,l=r?{}:i.overlay;if(this.shouldBeClosed())return null;var c={ref:this.setOverlayRef,className:this.buildClassName("overlay",r),style:n({},l,this.props.style.overlay),onClick:this.handleOverlayOnClick,onMouseDown:this.handleOverlayOnMouseDown},d=n({id:t,ref:this.setContentRef,style:n({},s,this.props.style.content),className:this.buildClassName("content",o),tabIndex:"-1",onKeyDown:this.handleKeyDown,onMouseDown:this.handleContentOnMouseDown,onMouseUp:this.handleContentOnMouseUp,onClick:this.handleContentOnClick,role:this.props.role,"aria-label":this.props.contentLabel},this.attributesFromObject("aria",n({modal:!0},this.props.aria)),this.attributesFromObject("data",this.props.data||{}),{"data-testid":this.props.testId}),u=this.props.contentElement(d,a);return this.props.overlayElement(c,u)}}]),t}(a.Component);b.defaultProps={style:{overlay:{},content:{}},defaultStyles:{}},b.propTypes={isOpen:s.default.bool.isRequired,defaultStyles:s.default.shape({content:s.default.object,overlay:s.default.object}),style:s.default.shape({content:s.default.object,overlay:s.default.object}),className:s.default.oneOfType([s.default.string,s.default.object]),overlayClassName:s.default.oneOfType([s.default.string,s.default.object]),parentSelector:s.default.func,bodyOpenClassName:s.default.string,htmlOpenClassName:s.default.string,ariaHideApp:s.default.bool,appElement:s.default.oneOfType([s.default.instanceOf(h.default),s.default.instanceOf(p.SafeHTMLCollection),s.default.instanceOf(p.SafeNodeList),s.default.arrayOf(s.default.instanceOf(h.default))]),onAfterOpen:s.default.func,onAfterClose:s.default.func,onRequestClose:s.default.func,closeTimeoutMS:s.default.number,shouldFocusAfterRender:s.default.bool,shouldCloseOnOverlayClick:s.default.bool,shouldReturnFocusAfterClose:s.default.bool,preventScroll:s.default.bool,role:s.default.string,contentLabel:s.default.string,aria:s.default.object,data:s.default.object,children:s.default.node,shouldCloseOnEsc:s.default.bool,overlayRef:s.default.func,contentRef:s.default.func,id:s.default.string,overlayElement:s.default.func,contentElement:s.default.func,testId:s.default.string},t.default=b,e.exports=t.default},1497:(e,t,o)=>{"use strict";var n=o(3218);function r(){}function i(){}i.resetWarningCache=r,e.exports=function(){function e(e,t,o,r,i,a){if(a!==n){var s=new Error("Calling PropTypes validators directly is not supported by the `prop-types` package. Use PropTypes.checkPropTypes() to call them. Read more at http://fb.me/use-check-prop-types");throw s.name="Invariant Violation",s}}function t(){return e}e.isRequired=e;var o={array:e,bigint:e,bool:e,func:e,number:e,object:e,string:e,symbol:e,any:e,arrayOf:t,element:e,elementType:e,instanceOf:t,node:e,objectOf:t,oneOf:t,oneOfType:t,shape:t,exact:t,checkPropTypes:i,resetWarningCache:r};return o.PropTypes=o,o}},1525:function(e,t,o){"use strict";var n=this&&this.__assign||function(){return n=Object.assign||function(e){for(var t,o=1,n=arguments.length;o<n;o++)for(var r in t=arguments[o])Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e},n.apply(this,arguments)},r=this&&this.__createBinding||(Object.create?function(e,t,o,n){void 0===n&&(n=o),Object.defineProperty(e,n,{enumerable:!0,get:function(){return t[o]}})}:function(e,t,o,n){void 0===n&&(n=o),e[n]=t[o]}),i=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),a=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var o in e)"default"!==o&&Object.prototype.hasOwnProperty.call(e,o)&&r(t,e,o);return i(t,e),t};Object.defineProperty(t,"__esModule",{value:!0});var s=a(o(5043)),l=o(8242),c=o(9201),d=o(2430),u=o(9724);t.default=s.forwardRef((function(e,t){var o=s.useContext(c.BeansContext),r=o.ctrlsFactory,i=o.context,a=o.gridOptionsService,p=o.resizeObserverService,h=o.clientSideRowModel,f=o.serverSideRowModel,g=s.useState(new l.CssClasses),m=g[0],y=g[1],v=s.useState(new l.CssClasses),b=v[0],x=v[1],w=s.useState(),C=w[0],_=w[1],S=s.useState(),E=S[0],k=S[1],j=s.useRef(),A=s.useRef(null),R=s.useMemo((function(){return m.toString()+" ag-details-row"}),[m]),O=s.useMemo((function(){return b.toString()+" ag-details-grid"}),[b]);t&&s.useImperativeHandle(t,(function(){return{refresh:function(){return j.current.refresh()}}})),u.useLayoutEffectOnce((function(){e.template&&"string"===typeof e.template&&console.warn("AG Grid: detailCellRendererParams.template is not supported by React - this only works with frameworks that work against String templates. To change the template, please provide your own React Detail Cell Renderer.")})),u.useLayoutEffectOnce((function(){var t={addOrRemoveCssClass:function(e,t){return y((function(o){return o.setClass(e,t)}))},addOrRemoveDetailGridCssClass:function(e,t){return x((function(o){return o.setClass(e,t)}))},setDetailGrid:function(e){return _(e)},setRowData:function(e){return k(e)},getGui:function(){return A.current}},o=r.getInstance("detailCellRenderer");if(o){var n;if(i.createBean(o),o.init(t,e),j.current=o,a.is("detailRowAutoHeight")){var s=function(){if(null!=A.current){var t=A.current.clientHeight;if(null!=t&&t>0){setTimeout((function(){e.node.setRowHeight(t),h?h.onRowHeightChanged():f&&f.onRowHeightChanged()}),0)}}};n=p.observeResize(A.current,s),s()}return function(){i.destroyBean(o),n&&n()}}}));var T=s.useCallback((function(e,t){j.current.registerDetailWithMaster(e,t)}),[]);return s.default.createElement("div",{className:R,ref:A},C&&s.default.createElement(d.AgGridReactUi,n({className:O},C,{rowData:E,setGridApi:T})))}))},1529:(e,t,o)=>{"use strict";o.d(t,{DU:()=>Yt,Ay:()=>qt});var n=function(){return n=Object.assign||function(e){for(var t,o=1,n=arguments.length;o<n;o++)for(var r in t=arguments[o])Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e},n.apply(this,arguments)};Object.create;function r(e,t,o){if(o||2===arguments.length)for(var n,r=0,i=t.length;r<i;r++)!n&&r in t||(n||(n=Array.prototype.slice.call(t,0,r)),n[r]=t[r]);return e.concat(n||Array.prototype.slice.call(t))}Object.create;"function"===typeof SuppressedError&&SuppressedError;var i=o(5043),a=o(7324),s=o.n(a),l="-ms-",c="-moz-",d="-webkit-",u="comm",p="rule",h="decl",f="@keyframes",g=Math.abs,m=String.fromCharCode,y=Object.assign;function v(e){return e.trim()}function b(e,t){return(e=t.exec(e))?e[0]:e}function x(e,t,o){return e.replace(t,o)}function w(e,t,o){return e.indexOf(t,o)}function C(e,t){return 0|e.charCodeAt(t)}function _(e,t,o){return e.slice(t,o)}function S(e){return e.length}function E(e){return e.length}function k(e,t){return t.push(e),e}function j(e,t){return e.filter((function(e){return!b(e,t)}))}var A=1,R=1,O=0,T=0,D=0,P="";function N(e,t,o,n,r,i,a,s){return{value:e,root:t,parent:o,type:n,props:r,children:i,line:A,column:R,length:a,return:"",siblings:s}}function I(e,t){return y(N("",null,null,"",null,null,0,e.siblings),e,{length:-e.length},t)}function M(e){for(;e.root;)e=I(e.root,{children:[e]});k(e,e.siblings)}function L(){return D=T>0?C(P,--T):0,R--,10===D&&(R=1,A--),D}function F(){return D=T<O?C(P,T++):0,R++,10===D&&(R=1,A++),D}function G(){return C(P,T)}function z(){return T}function H(e,t){return _(P,e,t)}function B(e){switch(e){case 0:case 9:case 10:case 13:case 32:return 5;case 33:case 43:case 44:case 47:case 62:case 64:case 126:case 59:case 123:case 125:return 4;case 58:return 3;case 34:case 39:case 40:case 91:return 2;case 41:case 93:return 1}return 0}function V(e){return A=R=1,O=S(P=e),T=0,[]}function $(e){return P="",e}function U(e){return v(H(T-1,K(91===e?e+2:40===e?e+1:e)))}function W(e){for(;(D=G())&&D<33;)F();return B(e)>2||B(D)>3?"":" "}function q(e,t){for(;--t&&F()&&!(D<48||D>102||D>57&&D<65||D>70&&D<97););return H(e,z()+(t<6&&32==G()&&32==F()))}function K(e){for(;F();)switch(D){case e:return T;case 34:case 39:34!==e&&39!==e&&K(D);break;case 40:41===e&&K(e);break;case 92:F()}return T}function Y(e,t){for(;F()&&e+D!==57&&(e+D!==84||47!==G()););return"/*"+H(t,T-1)+"*"+m(47===e?e:F())}function J(e){for(;!B(G());)F();return H(e,T)}function X(e,t){for(var o="",n=0;n<e.length;n++)o+=t(e[n],n,e,t)||"";return o}function Q(e,t,o,n){switch(e.type){case"@layer":if(e.children.length)break;case"@import":case h:return e.return=e.return||e.value;case u:return"";case f:return e.return=e.value+"{"+X(e.children,n)+"}";case p:if(!S(e.value=e.props.join(",")))return""}return S(o=X(e.children,n))?e.return=e.value+"{"+o+"}":""}function Z(e,t,o){switch(function(e,t){return 45^C(e,0)?(((t<<2^C(e,0))<<2^C(e,1))<<2^C(e,2))<<2^C(e,3):0}(e,t)){case 5103:return d+"print-"+e+e;case 5737:case 4201:case 3177:case 3433:case 1641:case 4457:case 2921:case 5572:case 6356:case 5844:case 3191:case 6645:case 3005:case 6391:case 5879:case 5623:case 6135:case 4599:case 4855:case 4215:case 6389:case 5109:case 5365:case 5621:case 3829:return d+e+e;case 4789:return c+e+e;case 5349:case 4246:case 4810:case 6968:case 2756:return d+e+c+e+l+e+e;case 5936:switch(C(e,t+11)){case 114:return d+e+l+x(e,/[svh]\w+-[tblr]{2}/,"tb")+e;case 108:return d+e+l+x(e,/[svh]\w+-[tblr]{2}/,"tb-rl")+e;case 45:return d+e+l+x(e,/[svh]\w+-[tblr]{2}/,"lr")+e}case 6828:case 4268:case 2903:return d+e+l+e+e;case 6165:return d+e+l+"flex-"+e+e;case 5187:return d+e+x(e,/(\w+).+(:[^]+)/,d+"box-$1$2"+l+"flex-$1$2")+e;case 5443:return d+e+l+"flex-item-"+x(e,/flex-|-self/g,"")+(b(e,/flex-|baseline/)?"":l+"grid-row-"+x(e,/flex-|-self/g,""))+e;case 4675:return d+e+l+"flex-line-pack"+x(e,/align-content|flex-|-self/g,"")+e;case 5548:return d+e+l+x(e,"shrink","negative")+e;case 5292:return d+e+l+x(e,"basis","preferred-size")+e;case 6060:return d+"box-"+x(e,"-grow","")+d+e+l+x(e,"grow","positive")+e;case 4554:return d+x(e,/([^-])(transform)/g,"$1"+d+"$2")+e;case 6187:return x(x(x(e,/(zoom-|grab)/,d+"$1"),/(image-set)/,d+"$1"),e,"")+e;case 5495:case 3959:return x(e,/(image-set\([^]*)/,d+"$1$`$1");case 4968:return x(x(e,/(.+:)(flex-)?(.*)/,d+"box-pack:$3"+l+"flex-pack:$3"),/s.+-b[^;]+/,"justify")+d+e+e;case 4200:if(!b(e,/flex-|baseline/))return l+"grid-column-align"+_(e,t)+e;break;case 2592:case 3360:return l+x(e,"template-","")+e;case 4384:case 3616:return o&&o.some((function(e,o){return t=o,b(e.props,/grid-\w+-end/)}))?~w(e+(o=o[t].value),"span",0)?e:l+x(e,"-start","")+e+l+"grid-row-span:"+(~w(o,"span",0)?b(o,/\d+/):+b(o,/\d+/)-+b(e,/\d+/))+";":l+x(e,"-start","")+e;case 4896:case 4128:return o&&o.some((function(e){return b(e.props,/grid-\w+-start/)}))?e:l+x(x(e,"-end","-span"),"span ","")+e;case 4095:case 3583:case 4068:case 2532:return x(e,/(.+)-inline(.+)/,d+"$1$2")+e;case 8116:case 7059:case 5753:case 5535:case 5445:case 5701:case 4933:case 4677:case 5533:case 5789:case 5021:case 4765:if(S(e)-1-t>6)switch(C(e,t+1)){case 109:if(45!==C(e,t+4))break;case 102:return x(e,/(.+:)(.+)-([^]+)/,"$1"+d+"$2-$3$1"+c+(108==C(e,t+3)?"$3":"$2-$3"))+e;case 115:return~w(e,"stretch",0)?Z(x(e,"stretch","fill-available"),t,o)+e:e}break;case 5152:case 5920:return x(e,/(.+?):(\d+)(\s*\/\s*(span)?\s*(\d+))?(.*)/,(function(t,o,n,r,i,a,s){return l+o+":"+n+s+(r?l+o+"-span:"+(i?a:+a-+n)+s:"")+e}));case 4949:if(121===C(e,t+6))return x(e,":",":"+d)+e;break;case 6444:switch(C(e,45===C(e,14)?18:11)){case 120:return x(e,/(.+:)([^;\s!]+)(;|(\s+)?!.+)?/,"$1"+d+(45===C(e,14)?"inline-":"")+"box$3$1"+d+"$2$3$1"+l+"$2box$3")+e;case 100:return x(e,":",":"+l)+e}break;case 5719:case 2647:case 2135:case 3927:case 2391:return x(e,"scroll-","scroll-snap-")+e}return e}function ee(e,t,o,n){if(e.length>-1&&!e.return)switch(e.type){case h:return void(e.return=Z(e.value,e.length,o));case f:return X([I(e,{value:x(e.value,"@","@"+d)})],n);case p:if(e.length)return function(e,t){return e.map(t).join("")}(o=e.props,(function(t){switch(b(t,n=/(::plac\w+|:read-\w+)/)){case":read-only":case":read-write":M(I(e,{props:[x(t,/:(read-\w+)/,":-moz-$1")]})),M(I(e,{props:[t]})),y(e,{props:j(o,n)});break;case"::placeholder":M(I(e,{props:[x(t,/:(plac\w+)/,":"+d+"input-$1")]})),M(I(e,{props:[x(t,/:(plac\w+)/,":-moz-$1")]})),M(I(e,{props:[x(t,/:(plac\w+)/,l+"input-$1")]})),M(I(e,{props:[t]})),y(e,{props:j(o,n)})}return""}))}}function te(e){return $(oe("",null,null,null,[""],e=V(e),0,[0],e))}function oe(e,t,o,n,r,i,a,s,l){for(var c=0,d=0,u=a,p=0,h=0,f=0,y=1,v=1,b=1,_=0,E="",j=r,A=i,R=n,O=E;v;)switch(f=_,_=F()){case 40:if(108!=f&&58==C(O,u-1)){-1!=w(O+=x(U(_),"&","&\f"),"&\f",g(c?s[c-1]:0))&&(b=-1);break}case 34:case 39:case 91:O+=U(_);break;case 9:case 10:case 13:case 32:O+=W(f);break;case 92:O+=q(z()-1,7);continue;case 47:switch(G()){case 42:case 47:k(re(Y(F(),z()),t,o,l),l);break;default:O+="/"}break;case 123*y:s[c++]=S(O)*b;case 125*y:case 59:case 0:switch(_){case 0:case 125:v=0;case 59+d:-1==b&&(O=x(O,/\f/g,"")),h>0&&S(O)-u&&k(h>32?ie(O+";",n,o,u-1,l):ie(x(O," ","")+";",n,o,u-2,l),l);break;case 59:O+=";";default:if(k(R=ne(O,t,o,c,d,r,s,E,j=[],A=[],u,i),i),123===_)if(0===d)oe(O,t,R,R,j,i,u,s,A);else switch(99===p&&110===C(O,3)?100:p){case 100:case 108:case 109:case 115:oe(e,R,R,n&&k(ne(e,R,R,0,0,r,s,E,r,j=[],u,A),A),r,A,u,s,n?j:A);break;default:oe(O,R,R,R,[""],A,0,s,A)}}c=d=h=0,y=b=1,E=O="",u=a;break;case 58:u=1+S(O),h=f;default:if(y<1)if(123==_)--y;else if(125==_&&0==y++&&125==L())continue;switch(O+=m(_),_*y){case 38:b=d>0?1:(O+="\f",-1);break;case 44:s[c++]=(S(O)-1)*b,b=1;break;case 64:45===G()&&(O+=U(F())),p=G(),d=u=S(E=O+=J(z())),_++;break;case 45:45===f&&2==S(O)&&(y=0)}}return i}function ne(e,t,o,n,r,i,a,s,l,c,d,u){for(var h=r-1,f=0===r?i:[""],m=E(f),y=0,b=0,w=0;y<n;++y)for(var C=0,S=_(e,h+1,h=g(b=a[y])),k=e;C<m;++C)(k=v(b>0?f[C]+" "+S:x(S,/&\f/g,f[C])))&&(l[w++]=k);return N(e,t,o,0===r?p:s,l,c,d,u)}function re(e,t,o,n){return N(e,t,o,u,m(D),_(e,2,-2),0,n)}function ie(e,t,o,n,r){return N(e,t,o,h,_(e,0,n),_(e,n+1,-1),n,r)}var ae={animationIterationCount:1,aspectRatio:1,borderImageOutset:1,borderImageSlice:1,borderImageWidth:1,boxFlex:1,boxFlexGroup:1,boxOrdinalGroup:1,columnCount:1,columns:1,flex:1,flexGrow:1,flexPositive:1,flexShrink:1,flexNegative:1,flexOrder:1,gridRow:1,gridRowEnd:1,gridRowSpan:1,gridRowStart:1,gridColumn:1,gridColumnEnd:1,gridColumnSpan:1,gridColumnStart:1,msGridRow:1,msGridRowSpan:1,msGridColumn:1,msGridColumnSpan:1,fontWeight:1,lineHeight:1,opacity:1,order:1,orphans:1,tabSize:1,widows:1,zIndex:1,zoom:1,WebkitLineClamp:1,fillOpacity:1,floodOpacity:1,stopOpacity:1,strokeDasharray:1,strokeDashoffset:1,strokeMiterlimit:1,strokeOpacity:1,strokeWidth:1},se="undefined"!=typeof process&&void 0!=={NODE_ENV:"production",PUBLIC_URL:"",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0,REACT_APP_SUPABASE_URL:"https://efazuvegwxouysfcgwja.supabase.co",REACT_APP_SUPABASE_ANON_KEY:"eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImVmYXp1dmVnd3hvdXlzZmNnd2phIiwicm9sZSI6ImFub24iLCJpYXQiOjE3MzU5Mjk1MjcsImV4cCI6MjA1MTUwNTUyN30.1G5n0CyQEHGeE1XaJld_PbpstUFd0Imaao6N8MUmfvE"}&&({NODE_ENV:"production",PUBLIC_URL:"",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0,REACT_APP_SUPABASE_URL:"https://efazuvegwxouysfcgwja.supabase.co",REACT_APP_SUPABASE_ANON_KEY:"eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImVmYXp1dmVnd3hvdXlzZmNnd2phIiwicm9sZSI6ImFub24iLCJpYXQiOjE3MzU5Mjk1MjcsImV4cCI6MjA1MTUwNTUyN30.1G5n0CyQEHGeE1XaJld_PbpstUFd0Imaao6N8MUmfvE"}.REACT_APP_SC_ATTR||{NODE_ENV:"production",PUBLIC_URL:"",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0,REACT_APP_SUPABASE_URL:"https://efazuvegwxouysfcgwja.supabase.co",REACT_APP_SUPABASE_ANON_KEY:"eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImVmYXp1dmVnd3hvdXlzZmNnd2phIiwicm9sZSI6ImFub24iLCJpYXQiOjE3MzU5Mjk1MjcsImV4cCI6MjA1MTUwNTUyN30.1G5n0CyQEHGeE1XaJld_PbpstUFd0Imaao6N8MUmfvE"}.SC_ATTR)||"data-styled",le="active",ce="data-styled-version",de="6.1.15",ue="/*!sc*/\n",pe="undefined"!=typeof window&&"HTMLElement"in window,he=Boolean("boolean"==typeof SC_DISABLE_SPEEDY?SC_DISABLE_SPEEDY:"undefined"!=typeof process&&void 0!=={NODE_ENV:"production",PUBLIC_URL:"",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0,REACT_APP_SUPABASE_URL:"https://efazuvegwxouysfcgwja.supabase.co",REACT_APP_SUPABASE_ANON_KEY:"eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImVmYXp1dmVnd3hvdXlzZmNnd2phIiwicm9sZSI6ImFub24iLCJpYXQiOjE3MzU5Mjk1MjcsImV4cCI6MjA1MTUwNTUyN30.1G5n0CyQEHGeE1XaJld_PbpstUFd0Imaao6N8MUmfvE"}&&void 0!=={NODE_ENV:"production",PUBLIC_URL:"",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0,REACT_APP_SUPABASE_URL:"https://efazuvegwxouysfcgwja.supabase.co",REACT_APP_SUPABASE_ANON_KEY:"eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImVmYXp1dmVnd3hvdXlzZmNnd2phIiwicm9sZSI6ImFub24iLCJpYXQiOjE3MzU5Mjk1MjcsImV4cCI6MjA1MTUwNTUyN30.1G5n0CyQEHGeE1XaJld_PbpstUFd0Imaao6N8MUmfvE"}.REACT_APP_SC_DISABLE_SPEEDY&&""!=={NODE_ENV:"production",PUBLIC_URL:"",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0,REACT_APP_SUPABASE_URL:"https://efazuvegwxouysfcgwja.supabase.co",REACT_APP_SUPABASE_ANON_KEY:"eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImVmYXp1dmVnd3hvdXlzZmNnd2phIiwicm9sZSI6ImFub24iLCJpYXQiOjE3MzU5Mjk1MjcsImV4cCI6MjA1MTUwNTUyN30.1G5n0CyQEHGeE1XaJld_PbpstUFd0Imaao6N8MUmfvE"}.REACT_APP_SC_DISABLE_SPEEDY?"false"!=={NODE_ENV:"production",PUBLIC_URL:"",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0,REACT_APP_SUPABASE_URL:"https://efazuvegwxouysfcgwja.supabase.co",REACT_APP_SUPABASE_ANON_KEY:"eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImVmYXp1dmVnd3hvdXlzZmNnd2phIiwicm9sZSI6ImFub24iLCJpYXQiOjE3MzU5Mjk1MjcsImV4cCI6MjA1MTUwNTUyN30.1G5n0CyQEHGeE1XaJld_PbpstUFd0Imaao6N8MUmfvE"}.REACT_APP_SC_DISABLE_SPEEDY&&{NODE_ENV:"production",PUBLIC_URL:"",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0,REACT_APP_SUPABASE_URL:"https://efazuvegwxouysfcgwja.supabase.co",REACT_APP_SUPABASE_ANON_KEY:"eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImVmYXp1dmVnd3hvdXlzZmNnd2phIiwicm9sZSI6ImFub24iLCJpYXQiOjE3MzU5Mjk1MjcsImV4cCI6MjA1MTUwNTUyN30.1G5n0CyQEHGeE1XaJld_PbpstUFd0Imaao6N8MUmfvE"}.REACT_APP_SC_DISABLE_SPEEDY:"undefined"!=typeof process&&void 0!=={NODE_ENV:"production",PUBLIC_URL:"",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0,REACT_APP_SUPABASE_URL:"https://efazuvegwxouysfcgwja.supabase.co",REACT_APP_SUPABASE_ANON_KEY:"eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImVmYXp1dmVnd3hvdXlzZmNnd2phIiwicm9sZSI6ImFub24iLCJpYXQiOjE3MzU5Mjk1MjcsImV4cCI6MjA1MTUwNTUyN30.1G5n0CyQEHGeE1XaJld_PbpstUFd0Imaao6N8MUmfvE"}&&void 0!=={NODE_ENV:"production",PUBLIC_URL:"",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0,REACT_APP_SUPABASE_URL:"https://efazuvegwxouysfcgwja.supabase.co",REACT_APP_SUPABASE_ANON_KEY:"eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImVmYXp1dmVnd3hvdXlzZmNnd2phIiwicm9sZSI6ImFub24iLCJpYXQiOjE3MzU5Mjk1MjcsImV4cCI6MjA1MTUwNTUyN30.1G5n0CyQEHGeE1XaJld_PbpstUFd0Imaao6N8MUmfvE"}.SC_DISABLE_SPEEDY&&""!=={NODE_ENV:"production",PUBLIC_URL:"",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0,REACT_APP_SUPABASE_URL:"https://efazuvegwxouysfcgwja.supabase.co",REACT_APP_SUPABASE_ANON_KEY:"eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImVmYXp1dmVnd3hvdXlzZmNnd2phIiwicm9sZSI6ImFub24iLCJpYXQiOjE3MzU5Mjk1MjcsImV4cCI6MjA1MTUwNTUyN30.1G5n0CyQEHGeE1XaJld_PbpstUFd0Imaao6N8MUmfvE"}.SC_DISABLE_SPEEDY&&("false"!=={NODE_ENV:"production",PUBLIC_URL:"",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0,REACT_APP_SUPABASE_URL:"https://efazuvegwxouysfcgwja.supabase.co",REACT_APP_SUPABASE_ANON_KEY:"eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImVmYXp1dmVnd3hvdXlzZmNnd2phIiwicm9sZSI6ImFub24iLCJpYXQiOjE3MzU5Mjk1MjcsImV4cCI6MjA1MTUwNTUyN30.1G5n0CyQEHGeE1XaJld_PbpstUFd0Imaao6N8MUmfvE"}.SC_DISABLE_SPEEDY&&{NODE_ENV:"production",PUBLIC_URL:"",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0,REACT_APP_SUPABASE_URL:"https://efazuvegwxouysfcgwja.supabase.co",REACT_APP_SUPABASE_ANON_KEY:"eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImVmYXp1dmVnd3hvdXlzZmNnd2phIiwicm9sZSI6ImFub24iLCJpYXQiOjE3MzU5Mjk1MjcsImV4cCI6MjA1MTUwNTUyN30.1G5n0CyQEHGeE1XaJld_PbpstUFd0Imaao6N8MUmfvE"}.SC_DISABLE_SPEEDY)),fe={},ge=(new Set,Object.freeze([])),me=Object.freeze({});function ye(e,t,o){return void 0===o&&(o=me),e.theme!==o.theme&&e.theme||t||o.theme}var ve=new Set(["a","abbr","address","area","article","aside","audio","b","base","bdi","bdo","big","blockquote","body","br","button","canvas","caption","cite","code","col","colgroup","data","datalist","dd","del","details","dfn","dialog","div","dl","dt","em","embed","fieldset","figcaption","figure","footer","form","h1","h2","h3","h4","h5","h6","header","hgroup","hr","html","i","iframe","img","input","ins","kbd","keygen","label","legend","li","link","main","map","mark","menu","menuitem","meta","meter","nav","noscript","object","ol","optgroup","option","output","p","param","picture","pre","progress","q","rp","rt","ruby","s","samp","script","section","select","small","source","span","strong","style","sub","summary","sup","table","tbody","td","textarea","tfoot","th","thead","time","tr","track","u","ul","use","var","video","wbr","circle","clipPath","defs","ellipse","foreignObject","g","image","line","linearGradient","marker","mask","path","pattern","polygon","polyline","radialGradient","rect","stop","svg","text","tspan"]),be=/[!"#$%&'()*+,./:;<=>?@[\\\]^`{|}~-]+/g,xe=/(^-|-$)/g;function we(e){return e.replace(be,"-").replace(xe,"")}var Ce=/(a)(d)/gi,_e=52,Se=function(e){return String.fromCharCode(e+(e>25?39:97))};function Ee(e){var t,o="";for(t=Math.abs(e);t>_e;t=t/_e|0)o=Se(t%_e)+o;return(Se(t%_e)+o).replace(Ce,"$1-$2")}var ke,je=function(e,t){for(var o=t.length;o;)e=33*e^t.charCodeAt(--o);return e},Ae=function(e){return je(5381,e)};function Re(e){return Ee(Ae(e)>>>0)}function Oe(e){return e.displayName||e.name||"Component"}function Te(e){return"string"==typeof e&&!0}var De="function"==typeof Symbol&&Symbol.for,Pe=De?Symbol.for("react.memo"):60115,Ne=De?Symbol.for("react.forward_ref"):60112,Ie={childContextTypes:!0,contextType:!0,contextTypes:!0,defaultProps:!0,displayName:!0,getDefaultProps:!0,getDerivedStateFromError:!0,getDerivedStateFromProps:!0,mixins:!0,propTypes:!0,type:!0},Me={name:!0,length:!0,prototype:!0,caller:!0,callee:!0,arguments:!0,arity:!0},Le={$$typeof:!0,compare:!0,defaultProps:!0,displayName:!0,propTypes:!0,type:!0},Fe=((ke={})[Ne]={$$typeof:!0,render:!0,defaultProps:!0,displayName:!0,propTypes:!0},ke[Pe]=Le,ke);function Ge(e){return("type"in(t=e)&&t.type.$$typeof)===Pe?Le:"$$typeof"in e?Fe[e.$$typeof]:Ie;var t}var ze=Object.defineProperty,He=Object.getOwnPropertyNames,Be=Object.getOwnPropertySymbols,Ve=Object.getOwnPropertyDescriptor,$e=Object.getPrototypeOf,Ue=Object.prototype;function We(e,t,o){if("string"!=typeof t){if(Ue){var n=$e(t);n&&n!==Ue&&We(e,n,o)}var r=He(t);Be&&(r=r.concat(Be(t)));for(var i=Ge(e),a=Ge(t),s=0;s<r.length;++s){var l=r[s];if(!(l in Me||o&&o[l]||a&&l in a||i&&l in i)){var c=Ve(t,l);try{ze(e,l,c)}catch(e){}}}}return e}function qe(e){return"function"==typeof e}function Ke(e){return"object"==typeof e&&"styledComponentId"in e}function Ye(e,t){return e&&t?"".concat(e," ").concat(t):e||t||""}function Je(e,t){if(0===e.length)return"";for(var o=e[0],n=1;n<e.length;n++)o+=t?t+e[n]:e[n];return o}function Xe(e){return null!==e&&"object"==typeof e&&e.constructor.name===Object.name&&!("props"in e&&e.$$typeof)}function Qe(e,t,o){if(void 0===o&&(o=!1),!o&&!Xe(e)&&!Array.isArray(e))return t;if(Array.isArray(t))for(var n=0;n<t.length;n++)e[n]=Qe(e[n],t[n]);else if(Xe(t))for(var n in t)e[n]=Qe(e[n],t[n]);return e}function Ze(e,t){Object.defineProperty(e,"toString",{value:t})}function et(e){for(var t=[],o=1;o<arguments.length;o++)t[o-1]=arguments[o];return new Error("An error occurred. See https://github.com/styled-components/styled-components/blob/main/packages/styled-components/src/utils/errors.md#".concat(e," for more information.").concat(t.length>0?" Args: ".concat(t.join(", ")):""))}var tt=function(){function e(e){this.groupSizes=new Uint32Array(512),this.length=512,this.tag=e}return e.prototype.indexOfGroup=function(e){for(var t=0,o=0;o<e;o++)t+=this.groupSizes[o];return t},e.prototype.insertRules=function(e,t){if(e>=this.groupSizes.length){for(var o=this.groupSizes,n=o.length,r=n;e>=r;)if((r<<=1)<0)throw et(16,"".concat(e));this.groupSizes=new Uint32Array(r),this.groupSizes.set(o),this.length=r;for(var i=n;i<r;i++)this.groupSizes[i]=0}for(var a=this.indexOfGroup(e+1),s=(i=0,t.length);i<s;i++)this.tag.insertRule(a,t[i])&&(this.groupSizes[e]++,a++)},e.prototype.clearGroup=function(e){if(e<this.length){var t=this.groupSizes[e],o=this.indexOfGroup(e),n=o+t;this.groupSizes[e]=0;for(var r=o;r<n;r++)this.tag.deleteRule(o)}},e.prototype.getGroup=function(e){var t="";if(e>=this.length||0===this.groupSizes[e])return t;for(var o=this.groupSizes[e],n=this.indexOfGroup(e),r=n+o,i=n;i<r;i++)t+="".concat(this.tag.getRule(i)).concat(ue);return t},e}(),ot=new Map,nt=new Map,rt=1,it=function(e){if(ot.has(e))return ot.get(e);for(;nt.has(rt);)rt++;var t=rt++;return ot.set(e,t),nt.set(t,e),t},at=function(e,t){rt=t+1,ot.set(e,t),nt.set(t,e)},st="style[".concat(se,"][").concat(ce,'="').concat(de,'"]'),lt=new RegExp("^".concat(se,'\\.g(\\d+)\\[id="([\\w\\d-]+)"\\].*?"([^"]*)')),ct=function(e,t,o){for(var n,r=o.split(","),i=0,a=r.length;i<a;i++)(n=r[i])&&e.registerName(t,n)},dt=function(e,t){for(var o,n=(null!==(o=t.textContent)&&void 0!==o?o:"").split(ue),r=[],i=0,a=n.length;i<a;i++){var s=n[i].trim();if(s){var l=s.match(lt);if(l){var c=0|parseInt(l[1],10),d=l[2];0!==c&&(at(d,c),ct(e,d,l[3]),e.getTag().insertRules(c,r)),r.length=0}else r.push(s)}}},ut=function(e){for(var t=document.querySelectorAll(st),o=0,n=t.length;o<n;o++){var r=t[o];r&&r.getAttribute(se)!==le&&(dt(e,r),r.parentNode&&r.parentNode.removeChild(r))}};function pt(){return o.nc}var ht=function(e){var t=document.head,o=e||t,n=document.createElement("style"),r=function(e){var t=Array.from(e.querySelectorAll("style[".concat(se,"]")));return t[t.length-1]}(o),i=void 0!==r?r.nextSibling:null;n.setAttribute(se,le),n.setAttribute(ce,de);var a=pt();return a&&n.setAttribute("nonce",a),o.insertBefore(n,i),n},ft=function(){function e(e){this.element=ht(e),this.element.appendChild(document.createTextNode("")),this.sheet=function(e){if(e.sheet)return e.sheet;for(var t=document.styleSheets,o=0,n=t.length;o<n;o++){var r=t[o];if(r.ownerNode===e)return r}throw et(17)}(this.element),this.length=0}return e.prototype.insertRule=function(e,t){try{return this.sheet.insertRule(t,e),this.length++,!0}catch(e){return!1}},e.prototype.deleteRule=function(e){this.sheet.deleteRule(e),this.length--},e.prototype.getRule=function(e){var t=this.sheet.cssRules[e];return t&&t.cssText?t.cssText:""},e}(),gt=function(){function e(e){this.element=ht(e),this.nodes=this.element.childNodes,this.length=0}return e.prototype.insertRule=function(e,t){if(e<=this.length&&e>=0){var o=document.createTextNode(t);return this.element.insertBefore(o,this.nodes[e]||null),this.length++,!0}return!1},e.prototype.deleteRule=function(e){this.element.removeChild(this.nodes[e]),this.length--},e.prototype.getRule=function(e){return e<this.length?this.nodes[e].textContent:""},e}(),mt=function(){function e(e){this.rules=[],this.length=0}return e.prototype.insertRule=function(e,t){return e<=this.length&&(this.rules.splice(e,0,t),this.length++,!0)},e.prototype.deleteRule=function(e){this.rules.splice(e,1),this.length--},e.prototype.getRule=function(e){return e<this.length?this.rules[e]:""},e}(),yt=pe,vt={isServer:!pe,useCSSOMInjection:!he},bt=function(){function e(e,t,o){void 0===e&&(e=me),void 0===t&&(t={});var r=this;this.options=n(n({},vt),e),this.gs=t,this.names=new Map(o),this.server=!!e.isServer,!this.server&&pe&&yt&&(yt=!1,ut(this)),Ze(this,(function(){return function(e){for(var t=e.getTag(),o=t.length,n="",r=function(o){var r=function(e){return nt.get(e)}(o);if(void 0===r)return"continue";var i=e.names.get(r),a=t.getGroup(o);if(void 0===i||!i.size||0===a.length)return"continue";var s="".concat(se,".g").concat(o,'[id="').concat(r,'"]'),l="";void 0!==i&&i.forEach((function(e){e.length>0&&(l+="".concat(e,","))})),n+="".concat(a).concat(s,'{content:"').concat(l,'"}').concat(ue)},i=0;i<o;i++)r(i);return n}(r)}))}return e.registerId=function(e){return it(e)},e.prototype.rehydrate=function(){!this.server&&pe&&ut(this)},e.prototype.reconstructWithOptions=function(t,o){return void 0===o&&(o=!0),new e(n(n({},this.options),t),this.gs,o&&this.names||void 0)},e.prototype.allocateGSInstance=function(e){return this.gs[e]=(this.gs[e]||0)+1},e.prototype.getTag=function(){return this.tag||(this.tag=(e=function(e){var t=e.useCSSOMInjection,o=e.target;return e.isServer?new mt(o):t?new ft(o):new gt(o)}(this.options),new tt(e)));var e},e.prototype.hasNameForId=function(e,t){return this.names.has(e)&&this.names.get(e).has(t)},e.prototype.registerName=function(e,t){if(it(e),this.names.has(e))this.names.get(e).add(t);else{var o=new Set;o.add(t),this.names.set(e,o)}},e.prototype.insertRules=function(e,t,o){this.registerName(e,t),this.getTag().insertRules(it(e),o)},e.prototype.clearNames=function(e){this.names.has(e)&&this.names.get(e).clear()},e.prototype.clearRules=function(e){this.getTag().clearGroup(it(e)),this.clearNames(e)},e.prototype.clearTag=function(){this.tag=void 0},e}(),xt=/&/g,wt=/^\s*\/\/.*$/gm;function Ct(e,t){return e.map((function(e){return"rule"===e.type&&(e.value="".concat(t," ").concat(e.value),e.value=e.value.replaceAll(",",",".concat(t," ")),e.props=e.props.map((function(e){return"".concat(t," ").concat(e)}))),Array.isArray(e.children)&&"@keyframes"!==e.type&&(e.children=Ct(e.children,t)),e}))}function _t(e){var t,o,n,r=void 0===e?me:e,i=r.options,a=void 0===i?me:i,s=r.plugins,l=void 0===s?ge:s,c=function(e,n,r){return r.startsWith(o)&&r.endsWith(o)&&r.replaceAll(o,"").length>0?".".concat(t):e},d=l.slice();d.push((function(e){e.type===p&&e.value.includes("&")&&(e.props[0]=e.props[0].replace(xt,o).replace(n,c))})),a.prefix&&d.push(ee),d.push(Q);var u=function(e,r,i,s){void 0===r&&(r=""),void 0===i&&(i=""),void 0===s&&(s="&"),t=s,o=r,n=new RegExp("\\".concat(o,"\\b"),"g");var l=e.replace(wt,""),c=te(i||r?"".concat(i," ").concat(r," { ").concat(l," }"):l);a.namespace&&(c=Ct(c,a.namespace));var u,p=[];return X(c,function(e){var t=E(e);return function(o,n,r,i){for(var a="",s=0;s<t;s++)a+=e[s](o,n,r,i)||"";return a}}(d.concat((u=function(e){return p.push(e)},function(e){e.root||(e=e.return)&&u(e)})))),p};return u.hash=l.length?l.reduce((function(e,t){return t.name||et(15),je(e,t.name)}),5381).toString():"",u}var St=new bt,Et=_t(),kt=i.createContext({shouldForwardProp:void 0,styleSheet:St,stylis:Et}),jt=(kt.Consumer,i.createContext(void 0));function At(){return(0,i.useContext)(kt)}function Rt(e){var t=(0,i.useState)(e.stylisPlugins),o=t[0],n=t[1],r=At().styleSheet,a=(0,i.useMemo)((function(){var t=r;return e.sheet?t=e.sheet:e.target&&(t=t.reconstructWithOptions({target:e.target},!1)),e.disableCSSOMInjection&&(t=t.reconstructWithOptions({useCSSOMInjection:!1})),t}),[e.disableCSSOMInjection,e.sheet,e.target,r]),l=(0,i.useMemo)((function(){return _t({options:{namespace:e.namespace,prefix:e.enableVendorPrefixes},plugins:o})}),[e.enableVendorPrefixes,e.namespace,o]);(0,i.useEffect)((function(){s()(o,e.stylisPlugins)||n(e.stylisPlugins)}),[e.stylisPlugins]);var c=(0,i.useMemo)((function(){return{shouldForwardProp:e.shouldForwardProp,styleSheet:a,stylis:l}}),[e.shouldForwardProp,a,l]);return i.createElement(kt.Provider,{value:c},i.createElement(jt.Provider,{value:l},e.children))}var Ot=function(){function e(e,t){var o=this;this.inject=function(e,t){void 0===t&&(t=Et);var n=o.name+t.hash;e.hasNameForId(o.id,n)||e.insertRules(o.id,n,t(o.rules,n,"@keyframes"))},this.name=e,this.id="sc-keyframes-".concat(e),this.rules=t,Ze(this,(function(){throw et(12,String(o.name))}))}return e.prototype.getName=function(e){return void 0===e&&(e=Et),this.name+e.hash},e}(),Tt=function(e){return e>="A"&&e<="Z"};function Dt(e){for(var t="",o=0;o<e.length;o++){var n=e[o];if(1===o&&"-"===n&&"-"===e[0])return e;Tt(n)?t+="-"+n.toLowerCase():t+=n}return t.startsWith("ms-")?"-"+t:t}var Pt=function(e){return null==e||!1===e||""===e},Nt=function(e){var t,o,n=[];for(var i in e){var a=e[i];e.hasOwnProperty(i)&&!Pt(a)&&(Array.isArray(a)&&a.isCss||qe(a)?n.push("".concat(Dt(i),":"),a,";"):Xe(a)?n.push.apply(n,r(r(["".concat(i," {")],Nt(a),!1),["}"],!1)):n.push("".concat(Dt(i),": ").concat((t=i,null==(o=a)||"boolean"==typeof o||""===o?"":"number"!=typeof o||0===o||t in ae||t.startsWith("--")?String(o).trim():"".concat(o,"px")),";")))}return n};function It(e,t,o,n){return Pt(e)?[]:Ke(e)?[".".concat(e.styledComponentId)]:qe(e)?!qe(r=e)||r.prototype&&r.prototype.isReactComponent||!t?[e]:It(e(t),t,o,n):e instanceof Ot?o?(e.inject(o,n),[e.getName(n)]):[e]:Xe(e)?Nt(e):Array.isArray(e)?Array.prototype.concat.apply(ge,e.map((function(e){return It(e,t,o,n)}))):[e.toString()];var r}function Mt(e){for(var t=0;t<e.length;t+=1){var o=e[t];if(qe(o)&&!Ke(o))return!1}return!0}var Lt=Ae(de),Ft=function(){function e(e,t,o){this.rules=e,this.staticRulesId="",this.isStatic=(void 0===o||o.isStatic)&&Mt(e),this.componentId=t,this.baseHash=je(Lt,t),this.baseStyle=o,bt.registerId(t)}return e.prototype.generateAndInjectStyles=function(e,t,o){var n=this.baseStyle?this.baseStyle.generateAndInjectStyles(e,t,o):"";if(this.isStatic&&!o.hash)if(this.staticRulesId&&t.hasNameForId(this.componentId,this.staticRulesId))n=Ye(n,this.staticRulesId);else{var r=Je(It(this.rules,e,t,o)),i=Ee(je(this.baseHash,r)>>>0);if(!t.hasNameForId(this.componentId,i)){var a=o(r,".".concat(i),void 0,this.componentId);t.insertRules(this.componentId,i,a)}n=Ye(n,i),this.staticRulesId=i}else{for(var s=je(this.baseHash,o.hash),l="",c=0;c<this.rules.length;c++){var d=this.rules[c];if("string"==typeof d)l+=d;else if(d){var u=Je(It(d,e,t,o));s=je(s,u+c),l+=u}}if(l){var p=Ee(s>>>0);t.hasNameForId(this.componentId,p)||t.insertRules(this.componentId,p,o(l,".".concat(p),void 0,this.componentId)),n=Ye(n,p)}}return n},e}(),Gt=i.createContext(void 0);Gt.Consumer;var zt={};new Set;function Ht(e,t,o){var r=Ke(e),a=e,s=!Te(e),l=t.attrs,c=void 0===l?ge:l,d=t.componentId,u=void 0===d?function(e,t){var o="string"!=typeof e?"sc":we(e);zt[o]=(zt[o]||0)+1;var n="".concat(o,"-").concat(Re(de+o+zt[o]));return t?"".concat(t,"-").concat(n):n}(t.displayName,t.parentComponentId):d,p=t.displayName,h=void 0===p?function(e){return Te(e)?"styled.".concat(e):"Styled(".concat(Oe(e),")")}(e):p,f=t.displayName&&t.componentId?"".concat(we(t.displayName),"-").concat(t.componentId):t.componentId||u,g=r&&a.attrs?a.attrs.concat(c).filter(Boolean):c,m=t.shouldForwardProp;if(r&&a.shouldForwardProp){var y=a.shouldForwardProp;if(t.shouldForwardProp){var v=t.shouldForwardProp;m=function(e,t){return y(e,t)&&v(e,t)}}else m=y}var b=new Ft(o,f,r?a.componentStyle:void 0);function x(e,t){return function(e,t,o){var r=e.attrs,a=e.componentStyle,s=e.defaultProps,l=e.foldedComponentIds,c=e.styledComponentId,d=e.target,u=i.useContext(Gt),p=At(),h=e.shouldForwardProp||p.shouldForwardProp,f=ye(t,u,s)||me,g=function(e,t,o){for(var r,i=n(n({},t),{className:void 0,theme:o}),a=0;a<e.length;a+=1){var s=qe(r=e[a])?r(i):r;for(var l in s)i[l]="className"===l?Ye(i[l],s[l]):"style"===l?n(n({},i[l]),s[l]):s[l]}return t.className&&(i.className=Ye(i.className,t.className)),i}(r,t,f),m=g.as||d,y={};for(var v in g)void 0===g[v]||"$"===v[0]||"as"===v||"theme"===v&&g.theme===f||("forwardedAs"===v?y.as=g.forwardedAs:h&&!h(v,m)||(y[v]=g[v]));var b=function(e,t){var o=At();return e.generateAndInjectStyles(t,o.styleSheet,o.stylis)}(a,g),x=Ye(l,c);return b&&(x+=" "+b),g.className&&(x+=" "+g.className),y[Te(m)&&!ve.has(m)?"class":"className"]=x,o&&(y.ref=o),(0,i.createElement)(m,y)}(w,e,t)}x.displayName=h;var w=i.forwardRef(x);return w.attrs=g,w.componentStyle=b,w.displayName=h,w.shouldForwardProp=m,w.foldedComponentIds=r?Ye(a.foldedComponentIds,a.styledComponentId):"",w.styledComponentId=f,w.target=r?a.target:e,Object.defineProperty(w,"defaultProps",{get:function(){return this._foldedDefaultProps},set:function(e){this._foldedDefaultProps=r?function(e){for(var t=[],o=1;o<arguments.length;o++)t[o-1]=arguments[o];for(var n=0,r=t;n<r.length;n++)Qe(e,r[n],!0);return e}({},a.defaultProps,e):e}}),Ze(w,(function(){return".".concat(w.styledComponentId)})),s&&We(w,e,{attrs:!0,componentStyle:!0,displayName:!0,foldedComponentIds:!0,shouldForwardProp:!0,styledComponentId:!0,target:!0}),w}function Bt(e,t){for(var o=[e[0]],n=0,r=t.length;n<r;n+=1)o.push(t[n],e[n+1]);return o}var Vt=function(e){return Object.assign(e,{isCss:!0})};function $t(e){for(var t=[],o=1;o<arguments.length;o++)t[o-1]=arguments[o];if(qe(e)||Xe(e))return Vt(It(Bt(ge,r([e],t,!0))));var n=e;return 0===t.length&&1===n.length&&"string"==typeof n[0]?It(n):Vt(It(Bt(n,t)))}function Ut(e,t,o){if(void 0===o&&(o=me),!t)throw et(1,t);var i=function(n){for(var i=[],a=1;a<arguments.length;a++)i[a-1]=arguments[a];return e(t,o,$t.apply(void 0,r([n],i,!1)))};return i.attrs=function(r){return Ut(e,t,n(n({},o),{attrs:Array.prototype.concat(o.attrs,r).filter(Boolean)}))},i.withConfig=function(r){return Ut(e,t,n(n({},o),r))},i}var Wt=function(e){return Ut(Ht,e)},qt=Wt;ve.forEach((function(e){qt[e]=Wt(e)}));var Kt=function(){function e(e,t){this.rules=e,this.componentId=t,this.isStatic=Mt(e),bt.registerId(this.componentId+1)}return e.prototype.createStyles=function(e,t,o,n){var r=n(Je(It(this.rules,t,o,n)),""),i=this.componentId+e;o.insertRules(i,i,r)},e.prototype.removeStyles=function(e,t){t.clearRules(this.componentId+e)},e.prototype.renderStyles=function(e,t,o,n){e>2&&bt.registerId(this.componentId+e),this.removeStyles(e,o),this.createStyles(e,t,o,n)},e}();function Yt(e){for(var t=[],o=1;o<arguments.length;o++)t[o-1]=arguments[o];var a=$t.apply(void 0,r([e],t,!1)),s="sc-global-".concat(Re(JSON.stringify(a))),l=new Kt(a,s),c=function(e){var t=At(),o=i.useContext(Gt),n=i.useRef(t.styleSheet.allocateGSInstance(s)).current;return t.styleSheet.server&&d(n,e,t.styleSheet,o,t.stylis),i.useLayoutEffect((function(){if(!t.styleSheet.server)return d(n,e,t.styleSheet,o,t.stylis),function(){return l.removeStyles(n,t.styleSheet)}}),[n,e,t.styleSheet,o,t.stylis]),null};function d(e,t,o,r,i){if(l.isStatic)l.renderStyles(e,fe,o,i);else{var a=n(n({},t),{theme:ye(t,r,c.defaultProps)});l.renderStyles(e,a,o,i)}}return i.memo(c)}(function(){function e(){var e=this;this._emitSheetCSS=function(){var t=e.instance.toString();if(!t)return"";var o=pt(),n=Je([o&&'nonce="'.concat(o,'"'),"".concat(se,'="true"'),"".concat(ce,'="').concat(de,'"')].filter(Boolean)," ");return"<style ".concat(n,">").concat(t,"</style>")},this.getStyleTags=function(){if(e.sealed)throw et(2);return e._emitSheetCSS()},this.getStyleElement=function(){var t;if(e.sealed)throw et(2);var o=e.instance.toString();if(!o)return[];var r=((t={})[se]="",t[ce]=de,t.dangerouslySetInnerHTML={__html:o},t),a=pt();return a&&(r.nonce=a),[i.createElement("style",n({},r,{key:"sc-0-0"}))]},this.seal=function(){e.sealed=!0},this.instance=new bt({isServer:!0}),this.sealed=!1}e.prototype.collectStyles=function(e){if(this.sealed)throw et(2);return i.createElement(Rt,{sheet:this.instance},e)},e.prototype.interleaveWithNodeStream=function(e){throw et(3)}})(),"__sc-".concat(se,"__")},1564:function(e,t,o){"use strict";var n=this&&this.__createBinding||(Object.create?function(e,t,o,n){void 0===n&&(n=o),Object.defineProperty(e,n,{enumerable:!0,get:function(){return t[o]}})}:function(e,t,o,n){void 0===n&&(n=o),e[n]=t[o]}),r=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),i=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var o in e)"default"!==o&&Object.prototype.hasOwnProperty.call(e,o)&&n(t,e,o);return r(t,e),t},a=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var s=o(7079),l=i(o(5043)),c=o(9201),d=a(o(2511)),u=a(o(7355)),p=a(o(6325)),h=o(9724),f=o(8242);t.default=l.memo((function(){var e=l.useContext(c.BeansContext),t=e.context,o=e.agStackComponentsRegistry,n=e.resizeObserverService,r=l.useState(""),i=r[0],a=r[1],g=l.useState(0),m=g[0],y=g[1],v=l.useState(0),b=v[0],x=v[1],w=l.useState("0px"),C=w[0],_=w[1],S=l.useState("0px"),E=S[0],k=S[1],j=l.useState("100%"),A=j[0],R=j[1],O=l.useState(""),T=O[0],D=O[1],P=l.useState(""),N=P[0],I=P[1],M=l.useState(null),L=M[0],F=M[1],G=l.useState(""),z=G[0],H=G[1],B=l.useState(null),V=B[0],$=B[1],U=l.useState("ag-layout-normal"),W=U[0],q=U[1],K=l.useMemo((function(){return new s.CssClassManager((function(){return Y.current}))}),[]),Y=l.useRef(null),J=l.useRef(null),X=l.useRef(null),Q=l.useRef(null),Z=l.useRef(null),ee=l.useRef(null);u.default(" AG Grid Body ",Y),u.default(" AG Pinned Top ",J),u.default(" AG Sticky Top ",X),u.default(" AG Middle ",Z),u.default(" AG Pinned Bottom ",ee),h.useLayoutEffectOnce((function(){var e=[],r=[];if(t){var i=function(n){var r=o.getComponentClass(n),i=t.createBean(new r);return e.push(i),i};Y.current.appendChild(document.createComment(" AG Fake Horizontal Scroll ")),Y.current.appendChild(i("AG-FAKE-HORIZONTAL-SCROLL").getGui()),Y.current.appendChild(document.createComment(" AG Overlay Wrapper ")),Y.current.appendChild(i("AG-OVERLAY-WRAPPER").getGui()),Q.current.appendChild(document.createComment(" AG Fake Vertical Scroll ")),Q.current.appendChild(i("AG-FAKE-VERTICAL-SCROLL").getGui());var l={setRowAnimationCssOnBodyViewport:a,setColumnCount:function(e){return s._.setAriaColCount(Y.current,e)},setRowCount:function(e){return s._.setAriaRowCount(Y.current,e)},setTopHeight:y,setBottomHeight:x,setStickyTopHeight:_,setStickyTopTop:k,setStickyTopWidth:R,setTopDisplay:D,setBottomDisplay:I,setColumnMovingCss:function(e,t){return K.addOrRemoveCssClass(e,t)},updateLayoutClasses:q,setAlwaysVerticalScrollClass:F,setPinnedTopBottomOverflowY:H,setCellSelectableCss:$,setBodyViewportWidth:function(e){return Z.current.style.width=e},registerBodyViewportResizeListener:function(e){var t=n.observeResize(Z.current,e);r.push((function(){return t()}))}},c=t.createBean(new s.GridBodyCtrl);return e.push(c),c.setComp(l,Y.current,Z.current,J.current,ee.current,X.current),function(){t.destroyBeans(e),r.forEach((function(e){return e()}))}}}));var te=l.useMemo((function(){return f.classesList("ag-root","ag-unselectable",W)}),[W]),oe=l.useMemo((function(){return f.classesList("ag-body-viewport",i,W,L,V)}),[i,W,L,V]),ne=l.useMemo((function(){return f.classesList("ag-body",W)}),[W]),re=l.useMemo((function(){return f.classesList("ag-body-clipper",W)}),[W]),ie=l.useMemo((function(){return f.classesList("ag-floating-top",V)}),[V]),ae=l.useMemo((function(){return f.classesList("ag-sticky-top",V)}),[V]),se=l.useMemo((function(){return f.classesList("ag-floating-bottom",V)}),[V]),le=l.useMemo((function(){return{height:m,minHeight:m,display:T,overflowY:z}}),[m,T,z]),ce=l.useMemo((function(){return{height:C,top:E,width:A}}),[C,E,A]),de=l.useMemo((function(){return{height:b,minHeight:b,display:N,overflowY:z}}),[b,N,z]),ue=function(e){return l.default.createElement(p.default,{name:e,key:e+"-container"})},pe=function(e){var t=e.section,o=e.children,n=e.className,r=e.style;return l.default.createElement("div",{ref:t,className:n,role:"presentation",style:r},o.map(ue))};return l.default.createElement("div",{ref:Y,className:te,role:"treegrid"},l.default.createElement(d.default,null),pe({section:J,className:ie,style:le,children:[s.RowContainerName.TOP_LEFT,s.RowContainerName.TOP_CENTER,s.RowContainerName.TOP_RIGHT,s.RowContainerName.TOP_FULL_WIDTH]}),l.default.createElement("div",{className:ne,ref:Q,role:"presentation"},l.default.createElement("div",{className:re,role:"presentation"},pe({section:Z,className:oe,children:[s.RowContainerName.LEFT,s.RowContainerName.CENTER,s.RowContainerName.RIGHT,s.RowContainerName.FULL_WIDTH]}))),pe({section:X,className:ae,style:ce,children:[s.RowContainerName.STICKY_TOP_LEFT,s.RowContainerName.STICKY_TOP_CENTER,s.RowContainerName.STICKY_TOP_RIGHT,s.RowContainerName.STICKY_TOP_FULL_WIDTH]}),pe({section:ee,className:se,style:de,children:[s.RowContainerName.BOTTOM_LEFT,s.RowContainerName.BOTTOM_CENTER,s.RowContainerName.BOTTOM_RIGHT,s.RowContainerName.BOTTOM_FULL_WIDTH]}))}))},1774:(e,t,o)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.resetState=function(){a=[]},t.log=function(){0},t.handleBlur=c,t.handleFocus=d,t.markForFocusLater=function(){a.push(document.activeElement)},t.returnFocus=function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=null;try{return void(0!==a.length&&(t=a.pop()).focus({preventScroll:e}))}catch(o){console.warn(["You tried to return focus to",t,"but it is not in the DOM anymore"].join(" "))}},t.popWithoutFocus=function(){a.length>0&&a.pop()},t.setupScopedFocus=function(e){s=e,window.addEventListener?(window.addEventListener("blur",c,!1),document.addEventListener("focus",d,!0)):(window.attachEvent("onBlur",c),document.attachEvent("onFocus",d))},t.teardownScopedFocus=function(){s=null,window.addEventListener?(window.removeEventListener("blur",c),document.removeEventListener("focus",d)):(window.detachEvent("onBlur",c),document.detachEvent("onFocus",d))};var n,r=o(4682),i=(n=r)&&n.__esModule?n:{default:n};var a=[],s=null,l=!1;function c(){l=!0}function d(){if(l){if(l=!1,!s)return;setTimeout((function(){s.contains(document.activeElement)||((0,i.default)(s)[0]||s).focus()}),0)}}},1853:function(e,t,o){"use strict";var n=this&&this.__createBinding||(Object.create?function(e,t,o,n){void 0===n&&(n=o),Object.defineProperty(e,n,{enumerable:!0,get:function(){return t[o]}})}:function(e,t,o,n){void 0===n&&(n=o),e[n]=t[o]}),r=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),i=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var o in e)"default"!==o&&Object.prototype.hasOwnProperty.call(e,o)&&n(t,e,o);return r(t,e),t};Object.defineProperty(t,"__esModule",{value:!0});var a=o(7079),s=i(o(5043)),l=o(7950),c=o(9201),d=o(9724);t.default=s.memo((function(e){var t=s.useState(),o=t[0],n=t[1],r=s.useContext(c.BeansContext),i=r.context,u=r.popupService,p=r.localeService,h=r.gridOptionsService;return d.useLayoutEffectOnce((function(){var t=e.editDetails,o=e.cellCtrl,r=e.eParentCell,s=t.compDetails,l=h.is("stopEditingWhenCellsLoseFocus"),c=i.createBean(new a.PopupEditorWrapper(s.params)),d=c.getGui();if(e.jsChildComp){var f=e.jsChildComp.getGui();f&&d.appendChild(f)}var g={column:o.getColumn(),rowNode:o.getRowNode(),type:"popupCellEditor",eventSource:r,ePopup:d,position:t.popupPosition,keepWithinBounds:!0},m=u.positionPopupByComponent.bind(u,g),y=p.getLocaleTextFunc(),v=u.addPopup({modal:l,eChild:d,closeOnEsc:!0,closedCallback:function(){o.onPopupEditorClosed()},anchorToElement:r,positionCallback:m,ariaLabel:y("ariaLabelCellEditor","Cell Editor")}),b=v?v.hideFunc:void 0;return n(c),e.jsChildComp&&e.jsChildComp.afterGuiAttached&&e.jsChildComp.afterGuiAttached(),function(){null!=b&&b(),i.destroyBean(c)}})),s.default.createElement(s.default.Fragment,null,o&&e.wrappedContent&&l.createPortal(e.wrappedContent,o.getGui()))}))},2115:(e,t,o)=>{"use strict";o.d(t,{N9:()=>V,oR:()=>P});var n=o(5043);function r(e){var t,o,n="";if("string"==typeof e||"number"==typeof e)n+=e;else if("object"==typeof e)if(Array.isArray(e)){var i=e.length;for(t=0;t<i;t++)e[t]&&(o=r(e[t]))&&(n&&(n+=" "),n+=o)}else for(o in e)e[o]&&(n&&(n+=" "),n+=o);return n}const i=function(){for(var e,t,o=0,n="",i=arguments.length;o<i;o++)(e=arguments[o])&&(t=r(e))&&(n&&(n+=" "),n+=t);return n};!function(e){if(!e||"undefined"==typeof document)return;let t=document.head||document.getElementsByTagName("head")[0],o=document.createElement("style");o.type="text/css",t.firstChild?t.insertBefore(o,t.firstChild):t.appendChild(o),o.styleSheet?o.styleSheet.cssText=e:o.appendChild(document.createTextNode(e))}(':root{--toastify-color-light: #fff;--toastify-color-dark: #121212;--toastify-color-info: #3498db;--toastify-color-success: #07bc0c;--toastify-color-warning: #f1c40f;--toastify-color-error: hsl(6, 78%, 57%);--toastify-color-transparent: rgba(255, 255, 255, .7);--toastify-icon-color-info: var(--toastify-color-info);--toastify-icon-color-success: var(--toastify-color-success);--toastify-icon-color-warning: var(--toastify-color-warning);--toastify-icon-color-error: var(--toastify-color-error);--toastify-container-width: fit-content;--toastify-toast-width: 320px;--toastify-toast-offset: 16px;--toastify-toast-top: max(var(--toastify-toast-offset), env(safe-area-inset-top));--toastify-toast-right: max(var(--toastify-toast-offset), env(safe-area-inset-right));--toastify-toast-left: max(var(--toastify-toast-offset), env(safe-area-inset-left));--toastify-toast-bottom: max(var(--toastify-toast-offset), env(safe-area-inset-bottom));--toastify-toast-background: #fff;--toastify-toast-padding: 14px;--toastify-toast-min-height: 64px;--toastify-toast-max-height: 800px;--toastify-toast-bd-radius: 6px;--toastify-toast-shadow: 0px 4px 12px rgba(0, 0, 0, .1);--toastify-font-family: sans-serif;--toastify-z-index: 9999;--toastify-text-color-light: #757575;--toastify-text-color-dark: #fff;--toastify-text-color-info: #fff;--toastify-text-color-success: #fff;--toastify-text-color-warning: #fff;--toastify-text-color-error: #fff;--toastify-spinner-color: #616161;--toastify-spinner-color-empty-area: #e0e0e0;--toastify-color-progress-light: linear-gradient(to right, #4cd964, #5ac8fa, #007aff, #34aadc, #5856d6, #ff2d55);--toastify-color-progress-dark: #bb86fc;--toastify-color-progress-info: var(--toastify-color-info);--toastify-color-progress-success: var(--toastify-color-success);--toastify-color-progress-warning: var(--toastify-color-warning);--toastify-color-progress-error: var(--toastify-color-error);--toastify-color-progress-bgo: .2}.Toastify__toast-container{z-index:var(--toastify-z-index);-webkit-transform:translate3d(0,0,var(--toastify-z-index));position:fixed;width:var(--toastify-container-width);box-sizing:border-box;color:#fff;display:flex;flex-direction:column}.Toastify__toast-container--top-left{top:var(--toastify-toast-top);left:var(--toastify-toast-left)}.Toastify__toast-container--top-center{top:var(--toastify-toast-top);left:50%;transform:translate(-50%);align-items:center}.Toastify__toast-container--top-right{top:var(--toastify-toast-top);right:var(--toastify-toast-right);align-items:end}.Toastify__toast-container--bottom-left{bottom:var(--toastify-toast-bottom);left:var(--toastify-toast-left)}.Toastify__toast-container--bottom-center{bottom:var(--toastify-toast-bottom);left:50%;transform:translate(-50%);align-items:center}.Toastify__toast-container--bottom-right{bottom:var(--toastify-toast-bottom);right:var(--toastify-toast-right);align-items:end}.Toastify__toast{--y: 0;position:relative;touch-action:none;width:var(--toastify-toast-width);min-height:var(--toastify-toast-min-height);box-sizing:border-box;margin-bottom:1rem;padding:var(--toastify-toast-padding);border-radius:var(--toastify-toast-bd-radius);box-shadow:var(--toastify-toast-shadow);max-height:var(--toastify-toast-max-height);font-family:var(--toastify-font-family);z-index:0;display:flex;flex:1 auto;align-items:center;word-break:break-word}@media only screen and (max-width: 480px){.Toastify__toast-container{width:100vw;left:env(safe-area-inset-left);margin:0}.Toastify__toast-container--top-left,.Toastify__toast-container--top-center,.Toastify__toast-container--top-right{top:env(safe-area-inset-top);transform:translate(0)}.Toastify__toast-container--bottom-left,.Toastify__toast-container--bottom-center,.Toastify__toast-container--bottom-right{bottom:env(safe-area-inset-bottom);transform:translate(0)}.Toastify__toast-container--rtl{right:env(safe-area-inset-right);left:initial}.Toastify__toast{--toastify-toast-width: 100%;margin-bottom:0;border-radius:0}}.Toastify__toast-container[data-stacked=true]{width:var(--toastify-toast-width)}.Toastify__toast--stacked{position:absolute;width:100%;transform:translate3d(0,var(--y),0) scale(var(--s));transition:transform .3s}.Toastify__toast--stacked[data-collapsed] .Toastify__toast-body,.Toastify__toast--stacked[data-collapsed] .Toastify__close-button{transition:opacity .1s}.Toastify__toast--stacked[data-collapsed=false]{overflow:visible}.Toastify__toast--stacked[data-collapsed=true]:not(:last-child)>*{opacity:0}.Toastify__toast--stacked:after{content:"";position:absolute;left:0;right:0;height:calc(var(--g) * 1px);bottom:100%}.Toastify__toast--stacked[data-pos=top]{top:0}.Toastify__toast--stacked[data-pos=bot]{bottom:0}.Toastify__toast--stacked[data-pos=bot].Toastify__toast--stacked:before{transform-origin:top}.Toastify__toast--stacked[data-pos=top].Toastify__toast--stacked:before{transform-origin:bottom}.Toastify__toast--stacked:before{content:"";position:absolute;left:0;right:0;bottom:0;height:100%;transform:scaleY(3);z-index:-1}.Toastify__toast--rtl{direction:rtl}.Toastify__toast--close-on-click{cursor:pointer}.Toastify__toast-icon{margin-inline-end:10px;width:22px;flex-shrink:0;display:flex}.Toastify--animate{animation-fill-mode:both;animation-duration:.5s}.Toastify--animate-icon{animation-fill-mode:both;animation-duration:.3s}.Toastify__toast-theme--dark{background:var(--toastify-color-dark);color:var(--toastify-text-color-dark)}.Toastify__toast-theme--light,.Toastify__toast-theme--colored.Toastify__toast--default{background:var(--toastify-color-light);color:var(--toastify-text-color-light)}.Toastify__toast-theme--colored.Toastify__toast--info{color:var(--toastify-text-color-info);background:var(--toastify-color-info)}.Toastify__toast-theme--colored.Toastify__toast--success{color:var(--toastify-text-color-success);background:var(--toastify-color-success)}.Toastify__toast-theme--colored.Toastify__toast--warning{color:var(--toastify-text-color-warning);background:var(--toastify-color-warning)}.Toastify__toast-theme--colored.Toastify__toast--error{color:var(--toastify-text-color-error);background:var(--toastify-color-error)}.Toastify__progress-bar-theme--light{background:var(--toastify-color-progress-light)}.Toastify__progress-bar-theme--dark{background:var(--toastify-color-progress-dark)}.Toastify__progress-bar--info{background:var(--toastify-color-progress-info)}.Toastify__progress-bar--success{background:var(--toastify-color-progress-success)}.Toastify__progress-bar--warning{background:var(--toastify-color-progress-warning)}.Toastify__progress-bar--error{background:var(--toastify-color-progress-error)}.Toastify__progress-bar-theme--colored.Toastify__progress-bar--info,.Toastify__progress-bar-theme--colored.Toastify__progress-bar--success,.Toastify__progress-bar-theme--colored.Toastify__progress-bar--warning,.Toastify__progress-bar-theme--colored.Toastify__progress-bar--error{background:var(--toastify-color-transparent)}.Toastify__close-button{color:#fff;position:absolute;top:6px;right:6px;background:transparent;outline:none;border:none;padding:0;cursor:pointer;opacity:.7;transition:.3s ease;z-index:1}.Toastify__toast--rtl .Toastify__close-button{left:6px;right:unset}.Toastify__close-button--light{color:#000;opacity:.3}.Toastify__close-button>svg{fill:currentColor;height:16px;width:14px}.Toastify__close-button:hover,.Toastify__close-button:focus{opacity:1}@keyframes Toastify__trackProgress{0%{transform:scaleX(1)}to{transform:scaleX(0)}}.Toastify__progress-bar{position:absolute;bottom:0;left:0;width:100%;height:100%;z-index:1;opacity:.7;transform-origin:left}.Toastify__progress-bar--animated{animation:Toastify__trackProgress linear 1 forwards}.Toastify__progress-bar--controlled{transition:transform .2s}.Toastify__progress-bar--rtl{right:0;left:initial;transform-origin:right;border-bottom-left-radius:initial}.Toastify__progress-bar--wrp{position:absolute;overflow:hidden;bottom:0;left:0;width:100%;height:5px;border-bottom-left-radius:var(--toastify-toast-bd-radius);border-bottom-right-radius:var(--toastify-toast-bd-radius)}.Toastify__progress-bar--wrp[data-hidden=true]{opacity:0}.Toastify__progress-bar--bg{opacity:var(--toastify-color-progress-bgo);width:100%;height:100%}.Toastify__spinner{width:20px;height:20px;box-sizing:border-box;border:2px solid;border-radius:100%;border-color:var(--toastify-spinner-color-empty-area);border-right-color:var(--toastify-spinner-color);animation:Toastify__spin .65s linear infinite}@keyframes Toastify__bounceInRight{0%,60%,75%,90%,to{animation-timing-function:cubic-bezier(.215,.61,.355,1)}0%{opacity:0;transform:translate3d(3000px,0,0)}60%{opacity:1;transform:translate3d(-25px,0,0)}75%{transform:translate3d(10px,0,0)}90%{transform:translate3d(-5px,0,0)}to{transform:none}}@keyframes Toastify__bounceOutRight{20%{opacity:1;transform:translate3d(-20px,var(--y),0)}to{opacity:0;transform:translate3d(2000px,var(--y),0)}}@keyframes Toastify__bounceInLeft{0%,60%,75%,90%,to{animation-timing-function:cubic-bezier(.215,.61,.355,1)}0%{opacity:0;transform:translate3d(-3000px,0,0)}60%{opacity:1;transform:translate3d(25px,0,0)}75%{transform:translate3d(-10px,0,0)}90%{transform:translate3d(5px,0,0)}to{transform:none}}@keyframes Toastify__bounceOutLeft{20%{opacity:1;transform:translate3d(20px,var(--y),0)}to{opacity:0;transform:translate3d(-2000px,var(--y),0)}}@keyframes Toastify__bounceInUp{0%,60%,75%,90%,to{animation-timing-function:cubic-bezier(.215,.61,.355,1)}0%{opacity:0;transform:translate3d(0,3000px,0)}60%{opacity:1;transform:translate3d(0,-20px,0)}75%{transform:translate3d(0,10px,0)}90%{transform:translate3d(0,-5px,0)}to{transform:translateZ(0)}}@keyframes Toastify__bounceOutUp{20%{transform:translate3d(0,calc(var(--y) - 10px),0)}40%,45%{opacity:1;transform:translate3d(0,calc(var(--y) + 20px),0)}to{opacity:0;transform:translate3d(0,-2000px,0)}}@keyframes Toastify__bounceInDown{0%,60%,75%,90%,to{animation-timing-function:cubic-bezier(.215,.61,.355,1)}0%{opacity:0;transform:translate3d(0,-3000px,0)}60%{opacity:1;transform:translate3d(0,25px,0)}75%{transform:translate3d(0,-10px,0)}90%{transform:translate3d(0,5px,0)}to{transform:none}}@keyframes Toastify__bounceOutDown{20%{transform:translate3d(0,calc(var(--y) - 10px),0)}40%,45%{opacity:1;transform:translate3d(0,calc(var(--y) + 20px),0)}to{opacity:0;transform:translate3d(0,2000px,0)}}.Toastify__bounce-enter--top-left,.Toastify__bounce-enter--bottom-left{animation-name:Toastify__bounceInLeft}.Toastify__bounce-enter--top-right,.Toastify__bounce-enter--bottom-right{animation-name:Toastify__bounceInRight}.Toastify__bounce-enter--top-center{animation-name:Toastify__bounceInDown}.Toastify__bounce-enter--bottom-center{animation-name:Toastify__bounceInUp}.Toastify__bounce-exit--top-left,.Toastify__bounce-exit--bottom-left{animation-name:Toastify__bounceOutLeft}.Toastify__bounce-exit--top-right,.Toastify__bounce-exit--bottom-right{animation-name:Toastify__bounceOutRight}.Toastify__bounce-exit--top-center{animation-name:Toastify__bounceOutUp}.Toastify__bounce-exit--bottom-center{animation-name:Toastify__bounceOutDown}@keyframes Toastify__zoomIn{0%{opacity:0;transform:scale3d(.3,.3,.3)}50%{opacity:1}}@keyframes Toastify__zoomOut{0%{opacity:1}50%{opacity:0;transform:translate3d(0,var(--y),0) scale3d(.3,.3,.3)}to{opacity:0}}.Toastify__zoom-enter{animation-name:Toastify__zoomIn}.Toastify__zoom-exit{animation-name:Toastify__zoomOut}@keyframes Toastify__flipIn{0%{transform:perspective(400px) rotateX(90deg);animation-timing-function:ease-in;opacity:0}40%{transform:perspective(400px) rotateX(-20deg);animation-timing-function:ease-in}60%{transform:perspective(400px) rotateX(10deg);opacity:1}80%{transform:perspective(400px) rotateX(-5deg)}to{transform:perspective(400px)}}@keyframes Toastify__flipOut{0%{transform:translate3d(0,var(--y),0) perspective(400px)}30%{transform:translate3d(0,var(--y),0) perspective(400px) rotateX(-20deg);opacity:1}to{transform:translate3d(0,var(--y),0) perspective(400px) rotateX(90deg);opacity:0}}.Toastify__flip-enter{animation-name:Toastify__flipIn}.Toastify__flip-exit{animation-name:Toastify__flipOut}@keyframes Toastify__slideInRight{0%{transform:translate3d(110%,0,0);visibility:visible}to{transform:translate3d(0,var(--y),0)}}@keyframes Toastify__slideInLeft{0%{transform:translate3d(-110%,0,0);visibility:visible}to{transform:translate3d(0,var(--y),0)}}@keyframes Toastify__slideInUp{0%{transform:translate3d(0,110%,0);visibility:visible}to{transform:translate3d(0,var(--y),0)}}@keyframes Toastify__slideInDown{0%{transform:translate3d(0,-110%,0);visibility:visible}to{transform:translate3d(0,var(--y),0)}}@keyframes Toastify__slideOutRight{0%{transform:translate3d(0,var(--y),0)}to{visibility:hidden;transform:translate3d(110%,var(--y),0)}}@keyframes Toastify__slideOutLeft{0%{transform:translate3d(0,var(--y),0)}to{visibility:hidden;transform:translate3d(-110%,var(--y),0)}}@keyframes Toastify__slideOutDown{0%{transform:translate3d(0,var(--y),0)}to{visibility:hidden;transform:translate3d(0,500px,0)}}@keyframes Toastify__slideOutUp{0%{transform:translate3d(0,var(--y),0)}to{visibility:hidden;transform:translate3d(0,-500px,0)}}.Toastify__slide-enter--top-left,.Toastify__slide-enter--bottom-left{animation-name:Toastify__slideInLeft}.Toastify__slide-enter--top-right,.Toastify__slide-enter--bottom-right{animation-name:Toastify__slideInRight}.Toastify__slide-enter--top-center{animation-name:Toastify__slideInDown}.Toastify__slide-enter--bottom-center{animation-name:Toastify__slideInUp}.Toastify__slide-exit--top-left,.Toastify__slide-exit--bottom-left{animation-name:Toastify__slideOutLeft;animation-timing-function:ease-in;animation-duration:.3s}.Toastify__slide-exit--top-right,.Toastify__slide-exit--bottom-right{animation-name:Toastify__slideOutRight;animation-timing-function:ease-in;animation-duration:.3s}.Toastify__slide-exit--top-center{animation-name:Toastify__slideOutUp;animation-timing-function:ease-in;animation-duration:.3s}.Toastify__slide-exit--bottom-center{animation-name:Toastify__slideOutDown;animation-timing-function:ease-in;animation-duration:.3s}@keyframes Toastify__spin{0%{transform:rotate(0)}to{transform:rotate(360deg)}}\n');var a=e=>"number"==typeof e&&!isNaN(e),s=e=>"string"==typeof e,l=e=>"function"==typeof e,c=e=>s(e)||l(e)?e:null,d=(e,t)=>!1===e||a(e)&&e>0?e:t,u=e=>(0,n.isValidElement)(e)||s(e)||l(e)||a(e);function p(e){let{enter:t,exit:o,appendPosition:r=!1,collapse:i=!0,collapseDuration:a=300}=e;return function(e){let{children:s,position:l,preventExitTransition:c,done:d,nodeRef:u,isIn:p,playToast:h}=e,f=r?`${t}--${l}`:t,g=r?`${o}--${l}`:o,m=(0,n.useRef)(0);return(0,n.useLayoutEffect)((()=>{let e=u.current,t=f.split(" "),o=n=>{n.target===u.current&&(h(),e.removeEventListener("animationend",o),e.removeEventListener("animationcancel",o),0===m.current&&"animationcancel"!==n.type&&e.classList.remove(...t))};e.classList.add(...t),e.addEventListener("animationend",o),e.addEventListener("animationcancel",o)}),[]),(0,n.useEffect)((()=>{let e=u.current,t=()=>{e.removeEventListener("animationend",t),i?function(e,t){let o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:300,{scrollHeight:n,style:r}=e;requestAnimationFrame((()=>{r.minHeight="initial",r.height=n+"px",r.transition=`all ${o}ms`,requestAnimationFrame((()=>{r.height="0",r.padding="0",r.margin="0",setTimeout(t,o)}))}))}(e,d,a):d()};p||(c?t():(m.current=1,e.className+=` ${g}`,e.addEventListener("animationend",t)))}),[p]),n.createElement(n.Fragment,null,s)}}function h(e,t){return{content:f(e.content,e.props),containerId:e.props.containerId,id:e.props.toastId,theme:e.props.theme,type:e.props.type,data:e.props.data||{},isLoading:e.props.isLoading,icon:e.props.icon,reason:e.removalReason,status:t}}function f(e,t){let o=arguments.length>2&&void 0!==arguments[2]&&arguments[2];return(0,n.isValidElement)(e)&&!s(e.type)?(0,n.cloneElement)(e,{closeToast:t.closeToast,toastProps:t,data:t.data,isPaused:o}):l(e)?e({closeToast:t.closeToast,toastProps:t,data:t.data,isPaused:o}):e}function g(e){let{delay:t,isRunning:o,closeToast:r,type:a="default",hide:s,className:c,controlledProgress:d,progress:u,rtl:p,isIn:h,theme:f}=e,g=s||d&&0===u,m={animationDuration:`${t}ms`,animationPlayState:o?"running":"paused"};d&&(m.transform=`scaleX(${u})`);let y=i("Toastify__progress-bar",d?"Toastify__progress-bar--controlled":"Toastify__progress-bar--animated",`Toastify__progress-bar-theme--${f}`,`Toastify__progress-bar--${a}`,{"Toastify__progress-bar--rtl":p}),v=l(c)?c({rtl:p,type:a,defaultClassName:y}):i(y,c),b={[d&&u>=1?"onTransitionEnd":"onAnimationEnd"]:d&&u<1?null:()=>{h&&r()}};return n.createElement("div",{className:"Toastify__progress-bar--wrp","data-hidden":g},n.createElement("div",{className:`Toastify__progress-bar--bg Toastify__progress-bar-theme--${f} Toastify__progress-bar--${a}`}),n.createElement("div",{role:"progressbar","aria-hidden":g?"true":"false","aria-label":"notification timer",className:v,style:m,...b}))}var m=1,y=()=>""+m++;function v(e,t,o){let n=1,r=0,i=[],s=[],l=t,p=new Map,f=new Set,g=()=>{s=Array.from(p.values()),f.forEach((e=>e()))},m=e=>{var t,o;null==(o=null==(t=e.props)?void 0:t.onClose)||o.call(t,e.removalReason),e.isActive=!1},y=e=>{if(null==e)p.forEach(m);else{let t=p.get(e);t&&m(t)}g()},v=e=>{var t,n;let{toastId:r,updateId:i}=e.props,a=null==i;e.staleId&&p.delete(e.staleId),e.isActive=!0,p.set(r,e),g(),o(h(e,a?"added":"updated")),a&&(null==(n=(t=e.props).onOpen)||n.call(t))};return{id:e,props:l,observe:e=>(f.add(e),()=>f.delete(e)),toggle:(e,t)=>{p.forEach((o=>{var n;(null==t||t===o.props.toastId)&&(null==(n=o.toggle)||n.call(o,e))}))},removeToast:y,toasts:p,clearQueue:()=>{r-=i.length,i=[]},buildToast:(t,s)=>{if((t=>{let{containerId:o,toastId:n,updateId:r}=t,i=o?o!==e:1!==e,a=p.has(n)&&null==r;return i||a})(s))return;let{toastId:f,updateId:m,data:b,staleId:x,delay:w}=s,C=null==m;C&&r++;let _={...l,style:l.toastStyle,key:n++,...Object.fromEntries(Object.entries(s).filter((e=>{let[t,o]=e;return null!=o}))),toastId:f,updateId:m,data:b,isIn:!1,className:c(s.className||l.toastClassName),progressClassName:c(s.progressClassName||l.progressClassName),autoClose:!s.isLoading&&d(s.autoClose,l.autoClose),closeToast(e){p.get(f).removalReason=e,y(f)},deleteToast(){let e=p.get(f);if(null!=e){if(o(h(e,"removed")),p.delete(f),r--,r<0&&(r=0),i.length>0)return void v(i.shift());g()}}};_.closeButton=l.closeButton,!1===s.closeButton||u(s.closeButton)?_.closeButton=s.closeButton:!0===s.closeButton&&(_.closeButton=!u(l.closeButton)||l.closeButton);let S={content:t,props:_,staleId:x};l.limit&&l.limit>0&&r>l.limit&&C?i.push(S):a(w)?setTimeout((()=>{v(S)}),w):v(S)},setProps(e){l=e},setToggle:(e,t)=>{let o=p.get(e);o&&(o.toggle=t)},isToastActive:e=>{var t;return null==(t=p.get(e))?void 0:t.isActive},getSnapshot:()=>s}}var b=new Map,x=[],w=new Set,C=e=>w.forEach((t=>t(e))),_=()=>b.size>0;function S(e,t){var o;if(t)return!(null==(o=b.get(t))||!o.isToastActive(e));let n=!1;return b.forEach((t=>{t.isToastActive(e)&&(n=!0)})),n}function E(e){if(_()){if(null==e||(e=>s(e)||a(e))(e))b.forEach((t=>{t.removeToast(e)}));else if(e&&("containerId"in e||"id"in e)){let t=b.get(e.containerId);t?t.removeToast(e.id):b.forEach((t=>{t.removeToast(e.id)}))}}else x=x.filter((t=>null!=e&&t.options.toastId!==e))}function k(e,t){u(e)&&(_()||x.push({content:e,options:t}),b.forEach((o=>{o.buildToast(e,t)})))}function j(e,t){b.forEach((o=>{(null==t||null==t||!t.containerId||(null==t?void 0:t.containerId)===o.id)&&o.toggle(e,null==t?void 0:t.id)}))}function A(e){let t=e.containerId||1;return{subscribe(o){let n=v(t,e,C);b.set(t,n);let r=n.observe(o);return x.forEach((e=>k(e.content,e.options))),x=[],()=>{r(),b.delete(t)}},setProps(e){var o;null==(o=b.get(t))||o.setProps(e)},getSnapshot(){var e;return null==(e=b.get(t))?void 0:e.getSnapshot()}}}function R(e){return e&&(s(e.toastId)||a(e.toastId))?e.toastId:y()}function O(e,t){return k(e,t),t.toastId}function T(e,t){return{...t,type:t&&t.type||e,toastId:R(t)}}function D(e){return(t,o)=>O(t,T(e,o))}function P(e,t){return O(e,T("default",t))}function N(e){let[t,o]=(0,n.useState)(!1),[r,i]=(0,n.useState)(!1),a=(0,n.useRef)(null),s=(0,n.useRef)({start:0,delta:0,removalDistance:0,canCloseOnClick:!0,canDrag:!1,didMove:!1}).current,{autoClose:l,pauseOnHover:c,closeToast:d,onClick:u,closeOnClick:p}=e;function h(){o(!0)}function f(){o(!1)}function g(o){let n=a.current;if(s.canDrag&&n){s.didMove=!0,t&&f(),"x"===e.draggableDirection?s.delta=o.clientX-s.start:s.delta=o.clientY-s.start,s.start!==o.clientX&&(s.canCloseOnClick=!1);let r="x"===e.draggableDirection?`${s.delta}px, var(--y)`:`0, calc(${s.delta}px + var(--y))`;n.style.transform=`translate3d(${r},0)`,n.style.opacity=""+(1-Math.abs(s.delta/s.removalDistance))}}function m(){document.removeEventListener("pointermove",g),document.removeEventListener("pointerup",m);let t=a.current;if(s.canDrag&&s.didMove&&t){if(s.canDrag=!1,Math.abs(s.delta)>s.removalDistance)return i(!0),e.closeToast(!0),void e.collapseAll();t.style.transition="transform 0.2s, opacity 0.2s",t.style.removeProperty("transform"),t.style.removeProperty("opacity")}}(function(e){var t;null==(t=b.get(e.containerId||1))||t.setToggle(e.id,e.fn)})({id:e.toastId,containerId:e.containerId,fn:o}),(0,n.useEffect)((()=>{if(e.pauseOnFocusLoss)return document.hasFocus()||f(),window.addEventListener("focus",h),window.addEventListener("blur",f),()=>{window.removeEventListener("focus",h),window.removeEventListener("blur",f)}}),[e.pauseOnFocusLoss]);let y={onPointerDown:function(t){if(!0===e.draggable||e.draggable===t.pointerType){s.didMove=!1,document.addEventListener("pointermove",g),document.addEventListener("pointerup",m);let o=a.current;s.canCloseOnClick=!0,s.canDrag=!0,o.style.transition="none","x"===e.draggableDirection?(s.start=t.clientX,s.removalDistance=o.offsetWidth*(e.draggablePercent/100)):(s.start=t.clientY,s.removalDistance=o.offsetHeight*(80===e.draggablePercent?1.5*e.draggablePercent:e.draggablePercent)/100)}},onPointerUp:function(t){let{top:o,bottom:n,left:r,right:i}=a.current.getBoundingClientRect();"touchend"!==t.nativeEvent.type&&e.pauseOnHover&&t.clientX>=r&&t.clientX<=i&&t.clientY>=o&&t.clientY<=n?f():h()}};return l&&c&&(y.onMouseEnter=f,e.stacked||(y.onMouseLeave=h)),p&&(y.onClick=e=>{u&&u(e),s.canCloseOnClick&&d(!0)}),{playToast:h,pauseToast:f,isRunning:t,preventExitTransition:r,toastRef:a,eventHandlers:y}}P.loading=(e,t)=>O(e,T("default",{isLoading:!0,autoClose:!1,closeOnClick:!1,closeButton:!1,draggable:!1,...t})),P.promise=function(e,t,o){let n,{pending:r,error:i,success:a}=t;r&&(n=s(r)?P.loading(r,o):P.loading(r.render,{...o,...r}));let c={isLoading:null,autoClose:null,closeOnClick:null,closeButton:null,draggable:null},d=(e,t,r)=>{if(null==t)return void P.dismiss(n);let i={type:e,...c,...o,data:r},a=s(t)?{render:t}:t;return n?P.update(n,{...i,...a}):P(a.render,{...i,...a}),r},u=l(e)?e():e;return u.then((e=>d("success",a,e))).catch((e=>d("error",i,e))),u},P.success=D("success"),P.info=D("info"),P.error=D("error"),P.warning=D("warning"),P.warn=P.warning,P.dark=(e,t)=>O(e,T("default",{theme:"dark",...t})),P.dismiss=function(e){E(e)},P.clearWaitingQueue=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};b.forEach((t=>{t.props.limit&&(!e.containerId||t.id===e.containerId)&&t.clearQueue()}))},P.isActive=S,P.update=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},o=((e,t)=>{let{containerId:o}=t;var n;return null==(n=b.get(o||1))?void 0:n.toasts.get(e)})(e,t);if(o){let{props:n,content:r}=o,i={delay:100,...n,...t,toastId:t.toastId||e,updateId:y()};i.toastId!==e&&(i.staleId=e);let a=i.render||r;delete i.render,O(a,i)}},P.done=e=>{P.update(e,{progress:1})},P.onChange=function(e){return w.add(e),()=>{w.delete(e)}},P.play=e=>j(!0,e),P.pause=e=>j(!1,e);var I="undefined"!=typeof window?n.useLayoutEffect:n.useEffect,M=e=>{let{theme:t,type:o,isLoading:r,...i}=e;return n.createElement("svg",{viewBox:"0 0 24 24",width:"100%",height:"100%",fill:"colored"===t?"currentColor":`var(--toastify-icon-color-${o})`,...i})};var L={info:function(e){return n.createElement(M,{...e},n.createElement("path",{d:"M12 0a12 12 0 1012 12A12.013 12.013 0 0012 0zm.25 5a1.5 1.5 0 11-1.5 1.5 1.5 1.5 0 011.5-1.5zm2.25 13.5h-4a1 1 0 010-2h.75a.25.25 0 00.25-.25v-4.5a.25.25 0 00-.25-.25h-.75a1 1 0 010-2h1a2 2 0 012 2v4.75a.25.25 0 00.25.25h.75a1 1 0 110 2z"}))},warning:function(e){return n.createElement(M,{...e},n.createElement("path",{d:"M23.32 17.191L15.438 2.184C14.728.833 13.416 0 11.996 0c-1.42 0-2.733.833-3.443 2.184L.533 17.448a4.744 4.744 0 000 4.368C1.243 23.167 2.555 24 3.975 24h16.05C22.22 24 24 22.044 24 19.632c0-.904-.251-1.746-.68-2.44zm-9.622 1.46c0 1.033-.724 1.823-1.698 1.823s-1.698-.79-1.698-1.822v-.043c0-1.028.724-1.822 1.698-1.822s1.698.79 1.698 1.822v.043zm.039-12.285l-.84 8.06c-.057.581-.408.943-.897.943-.49 0-.84-.367-.896-.942l-.84-8.065c-.057-.624.25-1.095.779-1.095h1.91c.528.005.84.476.784 1.1z"}))},success:function(e){return n.createElement(M,{...e},n.createElement("path",{d:"M12 0a12 12 0 1012 12A12.014 12.014 0 0012 0zm6.927 8.2l-6.845 9.289a1.011 1.011 0 01-1.43.188l-4.888-3.908a1 1 0 111.25-1.562l4.076 3.261 6.227-8.451a1 1 0 111.61 1.183z"}))},error:function(e){return n.createElement(M,{...e},n.createElement("path",{d:"M11.983 0a12.206 12.206 0 00-8.51 3.653A11.8 11.8 0 000 12.207 11.779 11.779 0 0011.8 24h.214A12.111 12.111 0 0024 11.791 11.766 11.766 0 0011.983 0zM10.5 16.542a1.476 1.476 0 011.449-1.53h.027a1.527 1.527 0 011.523 1.47 1.475 1.475 0 01-1.449 1.53h-.027a1.529 1.529 0 01-1.523-1.47zM11 12.5v-6a1 1 0 012 0v6a1 1 0 11-2 0z"}))},spinner:function(){return n.createElement("div",{className:"Toastify__spinner"})}};function F(e){let{theme:t,type:o,isLoading:r,icon:i}=e,a=null,s={theme:t,type:o};return!1===i||(l(i)?a=i({...s,isLoading:r}):(0,n.isValidElement)(i)?a=(0,n.cloneElement)(i,s):r?a=L.spinner():(e=>e in L)(o)&&(a=L[o](s))),a}var G=e=>{let{isRunning:t,preventExitTransition:o,toastRef:r,eventHandlers:a,playToast:s}=N(e),{closeButton:c,children:d,autoClose:u,onClick:p,type:h,hideProgressBar:m,closeToast:y,transition:v,position:b,className:x,style:w,progressClassName:C,updateId:_,role:S,progress:E,rtl:k,toastId:j,deleteToast:A,isIn:R,isLoading:O,closeOnClick:T,theme:D,ariaLabel:P}=e,I=i("Toastify__toast",`Toastify__toast-theme--${D}`,`Toastify__toast--${h}`,{"Toastify__toast--rtl":k},{"Toastify__toast--close-on-click":T}),M=l(x)?x({rtl:k,position:b,type:h,defaultClassName:I}):i(I,x),L=F(e),G=!!E||!u,z={closeToast:y,type:h,theme:D},H=null;return!1===c||(H=l(c)?c(z):(0,n.isValidElement)(c)?(0,n.cloneElement)(c,z):function(e){let{closeToast:t,theme:o,ariaLabel:r="close"}=e;return n.createElement("button",{className:`Toastify__close-button Toastify__close-button--${o}`,type:"button",onClick:e=>{e.stopPropagation(),t(!0)},"aria-label":r},n.createElement("svg",{"aria-hidden":"true",viewBox:"0 0 14 16"},n.createElement("path",{fillRule:"evenodd",d:"M7.71 8.23l3.75 3.75-1.48 1.48-3.75-3.75-3.75 3.75L1 11.98l3.75-3.75L1 4.48 2.48 3l3.75 3.75L9.98 3l1.48 1.48-3.75 3.75z"})))}(z)),n.createElement(v,{isIn:R,done:A,position:b,preventExitTransition:o,nodeRef:r,playToast:s},n.createElement("div",{id:j,tabIndex:0,onClick:p,"data-in":R,className:M,...a,style:w,ref:r,...R&&{role:S,"aria-label":P}},null!=L&&n.createElement("div",{className:i("Toastify__toast-icon",{"Toastify--animate-icon Toastify__zoom-enter":!O})},L),f(d,e,!t),H,!e.customProgressBar&&n.createElement(g,{..._&&!G?{key:`p-${_}`}:{},rtl:k,theme:D,delay:u,isRunning:t,isIn:R,closeToast:y,hide:m,type:h,className:C,controlledProgress:G,progress:E||0})))},z=function(e){return{enter:`Toastify--animate Toastify__${e}-enter`,exit:`Toastify--animate Toastify__${e}-exit`,appendPosition:arguments.length>1&&void 0!==arguments[1]&&arguments[1]}},H=p(z("bounce",!0)),B=(p(z("slide",!0)),p(z("zoom")),p(z("flip")),{position:"top-right",transition:H,autoClose:5e3,closeButton:!0,pauseOnHover:!0,pauseOnFocusLoss:!0,draggable:"touch",draggablePercent:80,draggableDirection:"x",role:"alert",theme:"light","aria-label":"Notifications Alt+T",hotKeys:e=>e.altKey&&"KeyT"===e.code});function V(e){let t={...B,...e},o=e.stacked,[r,a]=(0,n.useState)(!0),s=(0,n.useRef)(null),{getToastToRender:d,isToastActive:u,count:p}=function(e){var t;let{subscribe:o,getSnapshot:r,setProps:i}=(0,n.useRef)(A(e)).current;i(e);let a=null==(t=(0,n.useSyncExternalStore)(o,r,r))?void 0:t.slice();return{getToastToRender:function(t){if(!a)return[];let o=new Map;return e.newestOnTop&&a.reverse(),a.forEach((e=>{let{position:t}=e.props;o.has(t)||o.set(t,[]),o.get(t).push(e)})),Array.from(o,(e=>t(e[0],e[1])))},isToastActive:S,count:null==a?void 0:a.length}}(t),{className:h,style:f,rtl:g,containerId:m,hotKeys:y}=t;function v(e){let t=i("Toastify__toast-container",`Toastify__toast-container--${e}`,{"Toastify__toast-container--rtl":g});return l(h)?h({position:e,rtl:g,defaultClassName:t}):i(t,c(h))}function b(){o&&(a(!0),P.play())}return I((()=>{var e;if(o){let o=s.current.querySelectorAll('[data-in="true"]'),n=12,i=null==(e=t.position)?void 0:e.includes("top"),a=0,l=0;Array.from(o).reverse().forEach(((e,t)=>{let o=e;o.classList.add("Toastify__toast--stacked"),t>0&&(o.dataset.collapsed=`${r}`),o.dataset.pos||(o.dataset.pos=i?"top":"bot");let s=a*(r?.2:1)+(r?0:n*t);o.style.setProperty("--y",`${i?s:-1*s}px`),o.style.setProperty("--g",`${n}`),o.style.setProperty("--s",""+(1-(r?l:0))),a+=o.offsetHeight,l+=.025}))}}),[r,p,o]),(0,n.useEffect)((()=>{function e(e){var t;let o=s.current;y(e)&&(null==(t=o.querySelector('[tabIndex="0"]'))||t.focus(),a(!1),P.pause()),"Escape"===e.key&&(document.activeElement===o||null!=o&&o.contains(document.activeElement))&&(a(!0),P.play())}return document.addEventListener("keydown",e),()=>{document.removeEventListener("keydown",e)}}),[y]),n.createElement("section",{ref:s,className:"Toastify",id:m,onMouseEnter:()=>{o&&(a(!1),P.pause())},onMouseLeave:b,"aria-live":"polite","aria-atomic":"false","aria-relevant":"additions text","aria-label":t["aria-label"]},d(((e,t)=>{let r=t.length?{...f}:{...f,pointerEvents:"none"};return n.createElement("div",{tabIndex:-1,className:v(e),"data-stacked":o,style:r,key:`c-${e}`},t.map((e=>{let{content:t,props:r}=e;return n.createElement(G,{...r,stacked:o,collapseAll:b,isIn:u(r.toastId,r.containerId),key:`t-${r.key}`},t)})))})))}},2160:(e,t,o)=>{"use strict";var n=o(5043);function r(e){for(var t="https://reactjs.org/docs/error-decoder.html?invariant="+e,o=1;o<arguments.length;o++)t+="&args[]="+encodeURIComponent(arguments[o]);return"Minified React error #"+e+"; visit "+t+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var i=Object.prototype.hasOwnProperty,a=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,s={},l={};function c(e){return!!i.call(l,e)||!i.call(s,e)&&(a.test(e)?l[e]=!0:(s[e]=!0,!1))}function d(e,t,o,n,r,i,a){this.acceptsBooleans=2===t||3===t||4===t,this.attributeName=n,this.attributeNamespace=r,this.mustUseProperty=o,this.propertyName=e,this.type=t,this.sanitizeURL=i,this.removeEmptyString=a}var u={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach((function(e){u[e]=new d(e,0,!1,e,null,!1,!1)})),[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach((function(e){var t=e[0];u[t]=new d(t,1,!1,e[1],null,!1,!1)})),["contentEditable","draggable","spellCheck","value"].forEach((function(e){u[e]=new d(e,2,!1,e.toLowerCase(),null,!1,!1)})),["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach((function(e){u[e]=new d(e,2,!1,e,null,!1,!1)})),"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach((function(e){u[e]=new d(e,3,!1,e.toLowerCase(),null,!1,!1)})),["checked","multiple","muted","selected"].forEach((function(e){u[e]=new d(e,3,!0,e,null,!1,!1)})),["capture","download"].forEach((function(e){u[e]=new d(e,4,!1,e,null,!1,!1)})),["cols","rows","size","span"].forEach((function(e){u[e]=new d(e,6,!1,e,null,!1,!1)})),["rowSpan","start"].forEach((function(e){u[e]=new d(e,5,!1,e.toLowerCase(),null,!1,!1)}));var p=/[\-:]([a-z])/g;function h(e){return e[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach((function(e){var t=e.replace(p,h);u[t]=new d(t,1,!1,e,null,!1,!1)})),"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach((function(e){var t=e.replace(p,h);u[t]=new d(t,1,!1,e,"http://www.w3.org/1999/xlink",!1,!1)})),["xml:base","xml:lang","xml:space"].forEach((function(e){var t=e.replace(p,h);u[t]=new d(t,1,!1,e,"http://www.w3.org/XML/1998/namespace",!1,!1)})),["tabIndex","crossOrigin"].forEach((function(e){u[e]=new d(e,1,!1,e.toLowerCase(),null,!1,!1)})),u.xlinkHref=new d("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1),["src","href","action","formAction"].forEach((function(e){u[e]=new d(e,1,!1,e.toLowerCase(),null,!0,!0)}));var f={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},g=["Webkit","ms","Moz","O"];Object.keys(f).forEach((function(e){g.forEach((function(t){t=t+e.charAt(0).toUpperCase()+e.substring(1),f[t]=f[e]}))}));var m=/["'&<>]/;function y(e){if("boolean"===typeof e||"number"===typeof e)return""+e;e=""+e;var t=m.exec(e);if(t){var o,n="",r=0;for(o=t.index;o<e.length;o++){switch(e.charCodeAt(o)){case 34:t="&quot;";break;case 38:t="&amp;";break;case 39:t="&#x27;";break;case 60:t="&lt;";break;case 62:t="&gt;";break;default:continue}r!==o&&(n+=e.substring(r,o)),r=o+1,n+=t}e=r!==o?n+e.substring(r,o):n}return e}var v=/([A-Z])/g,b=/^ms-/,x=Array.isArray;function w(e,t){return{insertionMode:e,selectedValue:t}}var C=new Map;function _(e,t,o){if("object"!==typeof o)throw Error(r(62));for(var n in t=!0,o)if(i.call(o,n)){var a=o[n];if(null!=a&&"boolean"!==typeof a&&""!==a){if(0===n.indexOf("--")){var s=y(n);a=y((""+a).trim())}else{s=n;var l=C.get(s);void 0!==l||(l=y(s.replace(v,"-$1").toLowerCase().replace(b,"-ms-")),C.set(s,l)),s=l,a="number"===typeof a?0===a||i.call(f,n)?""+a:a+"px":y((""+a).trim())}t?(t=!1,e.push(' style="',s,":",a)):e.push(";",s,":",a)}}t||e.push('"')}function S(e,t,o,n){switch(o){case"style":return void _(e,t,n);case"defaultValue":case"defaultChecked":case"innerHTML":case"suppressContentEditableWarning":case"suppressHydrationWarning":return}if(!(2<o.length)||"o"!==o[0]&&"O"!==o[0]||"n"!==o[1]&&"N"!==o[1])if(null!==(t=u.hasOwnProperty(o)?u[o]:null)){switch(typeof n){case"function":case"symbol":return;case"boolean":if(!t.acceptsBooleans)return}switch(o=t.attributeName,t.type){case 3:n&&e.push(" ",o,'=""');break;case 4:!0===n?e.push(" ",o,'=""'):!1!==n&&e.push(" ",o,'="',y(n),'"');break;case 5:isNaN(n)||e.push(" ",o,'="',y(n),'"');break;case 6:!isNaN(n)&&1<=n&&e.push(" ",o,'="',y(n),'"');break;default:t.sanitizeURL&&(n=""+n),e.push(" ",o,'="',y(n),'"')}}else if(c(o)){switch(typeof n){case"function":case"symbol":return;case"boolean":if("data-"!==(t=o.toLowerCase().slice(0,5))&&"aria-"!==t)return}e.push(" ",o,'="',y(n),'"')}}function E(e,t,o){if(null!=t){if(null!=o)throw Error(r(60));if("object"!==typeof t||!("__html"in t))throw Error(r(61));null!==(t=t.__html)&&void 0!==t&&e.push(""+t)}}function k(e,t,o,n){e.push(R(o));var r,a=o=null;for(r in t)if(i.call(t,r)){var s=t[r];if(null!=s)switch(r){case"children":o=s;break;case"dangerouslySetInnerHTML":a=s;break;default:S(e,n,r,s)}}return e.push(">"),E(e,a,o),"string"===typeof o?(e.push(y(o)),null):o}var j=/^[a-zA-Z][a-zA-Z:_\.\-\d]*$/,A=new Map;function R(e){var t=A.get(e);if(void 0===t){if(!j.test(e))throw Error(r(65,e));t="<"+e,A.set(e,t)}return t}function O(e,t,o,a,s){switch(t){case"select":e.push(R("select"));var l=null,d=null;for(f in o)if(i.call(o,f)){var u=o[f];if(null!=u)switch(f){case"children":l=u;break;case"dangerouslySetInnerHTML":d=u;break;case"defaultValue":case"value":break;default:S(e,a,f,u)}}return e.push(">"),E(e,d,l),l;case"option":d=s.selectedValue,e.push(R("option"));var p=u=null,h=null,f=null;for(l in o)if(i.call(o,l)){var g=o[l];if(null!=g)switch(l){case"children":u=g;break;case"selected":h=g;break;case"dangerouslySetInnerHTML":f=g;break;case"value":p=g;default:S(e,a,l,g)}}if(null!=d)if(o=null!==p?""+p:function(e){var t="";return n.Children.forEach(e,(function(e){null!=e&&(t+=e)})),t}(u),x(d)){for(a=0;a<d.length;a++)if(""+d[a]===o){e.push(' selected=""');break}}else""+d===o&&e.push(' selected=""');else h&&e.push(' selected=""');return e.push(">"),E(e,f,u),u;case"textarea":for(u in e.push(R("textarea")),f=d=l=null,o)if(i.call(o,u)&&null!=(p=o[u]))switch(u){case"children":f=p;break;case"value":l=p;break;case"defaultValue":d=p;break;case"dangerouslySetInnerHTML":throw Error(r(91));default:S(e,a,u,p)}if(null===l&&null!==d&&(l=d),e.push(">"),null!=f){if(null!=l)throw Error(r(92));if(x(f)&&1<f.length)throw Error(r(93));l=""+f}return"string"===typeof l&&"\n"===l[0]&&e.push("\n"),null!==l&&e.push(y(""+l)),null;case"input":for(d in e.push(R("input")),p=f=u=l=null,o)if(i.call(o,d)&&null!=(h=o[d]))switch(d){case"children":case"dangerouslySetInnerHTML":throw Error(r(399,"input"));case"defaultChecked":p=h;break;case"defaultValue":u=h;break;case"checked":f=h;break;case"value":l=h;break;default:S(e,a,d,h)}return null!==f?S(e,a,"checked",f):null!==p&&S(e,a,"checked",p),null!==l?S(e,a,"value",l):null!==u&&S(e,a,"value",u),e.push("/>"),null;case"menuitem":for(var m in e.push(R("menuitem")),o)if(i.call(o,m)&&null!=(l=o[m]))switch(m){case"children":case"dangerouslySetInnerHTML":throw Error(r(400));default:S(e,a,m,l)}return e.push(">"),null;case"title":for(g in e.push(R("title")),l=null,o)if(i.call(o,g)&&null!=(d=o[g]))switch(g){case"children":l=d;break;case"dangerouslySetInnerHTML":throw Error(r(434));default:S(e,a,g,d)}return e.push(">"),l;case"listing":case"pre":for(p in e.push(R(t)),d=l=null,o)if(i.call(o,p)&&null!=(u=o[p]))switch(p){case"children":l=u;break;case"dangerouslySetInnerHTML":d=u;break;default:S(e,a,p,u)}if(e.push(">"),null!=d){if(null!=l)throw Error(r(60));if("object"!==typeof d||!("__html"in d))throw Error(r(61));null!==(o=d.__html)&&void 0!==o&&("string"===typeof o&&0<o.length&&"\n"===o[0]?e.push("\n",o):e.push(""+o))}return"string"===typeof l&&"\n"===l[0]&&e.push("\n"),l;case"area":case"base":case"br":case"col":case"embed":case"hr":case"img":case"keygen":case"link":case"meta":case"param":case"source":case"track":case"wbr":for(var v in e.push(R(t)),o)if(i.call(o,v)&&null!=(l=o[v]))switch(v){case"children":case"dangerouslySetInnerHTML":throw Error(r(399,t));default:S(e,a,v,l)}return e.push("/>"),null;case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return k(e,o,t,a);case"html":return 0===s.insertionMode&&e.push("<!DOCTYPE html>"),k(e,o,t,a);default:if(-1===t.indexOf("-")&&"string"!==typeof o.is)return k(e,o,t,a);for(h in e.push(R(t)),d=l=null,o)if(i.call(o,h)&&null!=(u=o[h]))switch(h){case"children":l=u;break;case"dangerouslySetInnerHTML":d=u;break;case"style":_(e,a,u);break;case"suppressContentEditableWarning":case"suppressHydrationWarning":break;default:c(h)&&"function"!==typeof u&&"symbol"!==typeof u&&e.push(" ",h,'="',y(u),'"')}return e.push(">"),E(e,d,l),l}}function T(e,t,o){if(e.push('\x3c!--$?--\x3e<template id="'),null===o)throw Error(r(395));return e.push(o),e.push('"></template>')}var D=/[<\u2028\u2029]/g;function P(e){return JSON.stringify(e).replace(D,(function(e){switch(e){case"<":return"\\u003c";case"\u2028":return"\\u2028";case"\u2029":return"\\u2029";default:throw Error("escapeJSStringsForInstructionScripts encountered a match it does not know how to replace. this means the match regex and the replacement characters are no longer in sync. This is a bug in React")}}))}function N(e,t,o,n){return o.generateStaticMarkup?(e.push(y(t)),!1):(""===t?e=n:(n&&e.push("\x3c!-- --\x3e"),e.push(y(t)),e=!0),e)}var I=Object.assign,M=Symbol.for("react.element"),L=Symbol.for("react.portal"),F=Symbol.for("react.fragment"),G=Symbol.for("react.strict_mode"),z=Symbol.for("react.profiler"),H=Symbol.for("react.provider"),B=Symbol.for("react.context"),V=Symbol.for("react.forward_ref"),$=Symbol.for("react.suspense"),U=Symbol.for("react.suspense_list"),W=Symbol.for("react.memo"),q=Symbol.for("react.lazy"),K=Symbol.for("react.scope"),Y=Symbol.for("react.debug_trace_mode"),J=Symbol.for("react.legacy_hidden"),X=Symbol.for("react.default_value"),Q=Symbol.iterator;function Z(e){if(null==e)return null;if("function"===typeof e)return e.displayName||e.name||null;if("string"===typeof e)return e;switch(e){case F:return"Fragment";case L:return"Portal";case z:return"Profiler";case G:return"StrictMode";case $:return"Suspense";case U:return"SuspenseList"}if("object"===typeof e)switch(e.$$typeof){case B:return(e.displayName||"Context")+".Consumer";case H:return(e._context.displayName||"Context")+".Provider";case V:var t=e.render;return(e=e.displayName)||(e=""!==(e=t.displayName||t.name||"")?"ForwardRef("+e+")":"ForwardRef"),e;case W:return null!==(t=e.displayName||null)?t:Z(e.type)||"Memo";case q:t=e._payload,e=e._init;try{return Z(e(t))}catch(o){}}return null}var ee={};function te(e,t){if(!(e=e.contextTypes))return ee;var o,n={};for(o in e)n[o]=t[o];return n}var oe=null;function ne(e,t){if(e!==t){e.context._currentValue2=e.parentValue,e=e.parent;var o=t.parent;if(null===e){if(null!==o)throw Error(r(401))}else{if(null===o)throw Error(r(401));ne(e,o)}t.context._currentValue2=t.value}}function re(e){e.context._currentValue2=e.parentValue,null!==(e=e.parent)&&re(e)}function ie(e){var t=e.parent;null!==t&&ie(t),e.context._currentValue2=e.value}function ae(e,t){if(e.context._currentValue2=e.parentValue,null===(e=e.parent))throw Error(r(402));e.depth===t.depth?ne(e,t):ae(e,t)}function se(e,t){var o=t.parent;if(null===o)throw Error(r(402));e.depth===o.depth?ne(e,o):se(e,o),t.context._currentValue2=t.value}function le(e){var t=oe;t!==e&&(null===t?ie(e):null===e?re(t):t.depth===e.depth?ne(t,e):t.depth>e.depth?ae(t,e):se(t,e),oe=e)}var ce={isMounted:function(){return!1},enqueueSetState:function(e,t){null!==(e=e._reactInternals).queue&&e.queue.push(t)},enqueueReplaceState:function(e,t){(e=e._reactInternals).replace=!0,e.queue=[t]},enqueueForceUpdate:function(){}};function de(e,t,o,n){var r=void 0!==e.state?e.state:null;e.updater=ce,e.props=o,e.state=r;var i={queue:[],replace:!1};e._reactInternals=i;var a=t.contextType;if(e.context="object"===typeof a&&null!==a?a._currentValue2:n,"function"===typeof(a=t.getDerivedStateFromProps)&&(r=null===(a=a(o,r))||void 0===a?r:I({},r,a),e.state=r),"function"!==typeof t.getDerivedStateFromProps&&"function"!==typeof e.getSnapshotBeforeUpdate&&("function"===typeof e.UNSAFE_componentWillMount||"function"===typeof e.componentWillMount))if(t=e.state,"function"===typeof e.componentWillMount&&e.componentWillMount(),"function"===typeof e.UNSAFE_componentWillMount&&e.UNSAFE_componentWillMount(),t!==e.state&&ce.enqueueReplaceState(e,e.state,null),null!==i.queue&&0<i.queue.length)if(t=i.queue,a=i.replace,i.queue=null,i.replace=!1,a&&1===t.length)e.state=t[0];else{for(i=a?t[0]:e.state,r=!0,a=a?1:0;a<t.length;a++){var s=t[a];null!=(s="function"===typeof s?s.call(e,i,o,n):s)&&(r?(r=!1,i=I({},i,s)):I(i,s))}e.state=i}else i.queue=null}var ue={id:1,overflow:""};function pe(e,t,o){var n=e.id;e=e.overflow;var r=32-he(n)-1;n&=~(1<<r),o+=1;var i=32-he(t)+r;if(30<i){var a=r-r%5;return i=(n&(1<<a)-1).toString(32),n>>=a,r-=a,{id:1<<32-he(t)+r|o<<r|n,overflow:i+e}}return{id:1<<i|o<<r|n,overflow:e}}var he=Math.clz32?Math.clz32:function(e){return 0===(e>>>=0)?32:31-(fe(e)/ge|0)|0},fe=Math.log,ge=Math.LN2;var me="function"===typeof Object.is?Object.is:function(e,t){return e===t&&(0!==e||1/e===1/t)||e!==e&&t!==t},ye=null,ve=null,be=null,xe=null,we=!1,Ce=!1,_e=0,Se=null,Ee=0;function ke(){if(null===ye)throw Error(r(321));return ye}function je(){if(0<Ee)throw Error(r(312));return{memoizedState:null,queue:null,next:null}}function Ae(){return null===xe?null===be?(we=!1,be=xe=je()):(we=!0,xe=be):null===xe.next?(we=!1,xe=xe.next=je()):(we=!0,xe=xe.next),xe}function Re(){ve=ye=null,Ce=!1,be=null,Ee=0,xe=Se=null}function Oe(e,t){return"function"===typeof t?t(e):t}function Te(e,t,o){if(ye=ke(),xe=Ae(),we){var n=xe.queue;if(t=n.dispatch,null!==Se&&void 0!==(o=Se.get(n))){Se.delete(n),n=xe.memoizedState;do{n=e(n,o.action),o=o.next}while(null!==o);return xe.memoizedState=n,[n,t]}return[xe.memoizedState,t]}return e=e===Oe?"function"===typeof t?t():t:void 0!==o?o(t):t,xe.memoizedState=e,e=(e=xe.queue={last:null,dispatch:null}).dispatch=Pe.bind(null,ye,e),[xe.memoizedState,e]}function De(e,t){if(ye=ke(),t=void 0===t?null:t,null!==(xe=Ae())){var o=xe.memoizedState;if(null!==o&&null!==t){var n=o[1];e:if(null===n)n=!1;else{for(var r=0;r<n.length&&r<t.length;r++)if(!me(t[r],n[r])){n=!1;break e}n=!0}if(n)return o[0]}}return e=e(),xe.memoizedState=[e,t],e}function Pe(e,t,o){if(25<=Ee)throw Error(r(301));if(e===ye)if(Ce=!0,e={action:o,next:null},null===Se&&(Se=new Map),void 0===(o=Se.get(t)))Se.set(t,e);else{for(t=o;null!==t.next;)t=t.next;t.next=e}}function Ne(){throw Error(r(394))}function Ie(){}var Me={readContext:function(e){return e._currentValue2},useContext:function(e){return ke(),e._currentValue2},useMemo:De,useReducer:Te,useRef:function(e){ye=ke();var t=(xe=Ae()).memoizedState;return null===t?(e={current:e},xe.memoizedState=e):t},useState:function(e){return Te(Oe,e)},useInsertionEffect:Ie,useLayoutEffect:function(){},useCallback:function(e,t){return De((function(){return e}),t)},useImperativeHandle:Ie,useEffect:Ie,useDebugValue:Ie,useDeferredValue:function(e){return ke(),e},useTransition:function(){return ke(),[!1,Ne]},useId:function(){var e=ve.treeContext,t=e.overflow;e=((e=e.id)&~(1<<32-he(e)-1)).toString(32)+t;var o=Le;if(null===o)throw Error(r(404));return t=_e++,e=":"+o.idPrefix+"R"+e,0<t&&(e+="H"+t.toString(32)),e+":"},useMutableSource:function(e,t){return ke(),t(e._source)},useSyncExternalStore:function(e,t,o){if(void 0===o)throw Error(r(407));return o()}},Le=null,Fe=n.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentDispatcher;function Ge(e){return console.error(e),null}function ze(){}function He(e,t,o,n,r,i,a,s){e.allPendingTasks++,null===o?e.pendingRootTasks++:o.pendingTasks++;var l={node:t,ping:function(){var t=e.pingedTasks;t.push(l),1===t.length&&ot(e)},blockedBoundary:o,blockedSegment:n,abortSet:r,legacyContext:i,context:a,treeContext:s};return r.add(l),l}function Be(e,t,o,n,r,i){return{status:0,id:-1,index:t,parentFlushed:!1,chunks:[],children:[],formatContext:n,boundary:o,lastPushedText:r,textEmbedded:i}}function Ve(e,t){if(null!=(e=e.onError(t))&&"string"!==typeof e)throw Error('onError returned something with a type other than "string". onError should return a string and may return null or undefined but must not return anything else. It received something of type "'+typeof e+'" instead');return e}function $e(e,t){var o=e.onShellError;o(t),(o=e.onFatalError)(t),null!==e.destination?(e.status=2,e.destination.destroy(t)):(e.status=1,e.fatalError=t)}function Ue(e,t,o,n,r){for(ye={},ve=t,_e=0,e=o(n,r);Ce;)Ce=!1,_e=0,Ee+=1,xe=null,e=o(n,r);return Re(),e}function We(e,t,o,n){var i=o.render(),a=n.childContextTypes;if(null!==a&&void 0!==a){var s=t.legacyContext;if("function"!==typeof o.getChildContext)n=s;else{for(var l in o=o.getChildContext())if(!(l in a))throw Error(r(108,Z(n)||"Unknown",l));n=I({},s,o)}t.legacyContext=n,Ye(e,t,i),t.legacyContext=s}else Ye(e,t,i)}function qe(e,t){if(e&&e.defaultProps){for(var o in t=I({},t),e=e.defaultProps)void 0===t[o]&&(t[o]=e[o]);return t}return t}function Ke(e,t,o,n,i){if("function"===typeof o)if(o.prototype&&o.prototype.isReactComponent){i=te(o,t.legacyContext);var a=o.contextType;de(a=new o(n,"object"===typeof a&&null!==a?a._currentValue2:i),o,n,i),We(e,t,a,o)}else{i=Ue(e,t,o,n,a=te(o,t.legacyContext));var s=0!==_e;if("object"===typeof i&&null!==i&&"function"===typeof i.render&&void 0===i.$$typeof)de(i,o,n,a),We(e,t,i,o);else if(s){n=t.treeContext,t.treeContext=pe(n,1,0);try{Ye(e,t,i)}finally{t.treeContext=n}}else Ye(e,t,i)}else{if("string"!==typeof o){switch(o){case J:case Y:case G:case z:case F:case U:return void Ye(e,t,n.children);case K:throw Error(r(343));case $:e:{o=t.blockedBoundary,i=t.blockedSegment,a=n.fallback,n=n.children;var l={id:null,rootSegmentID:-1,parentFlushed:!1,pendingTasks:0,forceClientRender:!1,completedSegments:[],byteSize:0,fallbackAbortableTasks:s=new Set,errorDigest:null},c=Be(0,i.chunks.length,l,i.formatContext,!1,!1);i.children.push(c),i.lastPushedText=!1;var d=Be(0,0,null,i.formatContext,!1,!1);d.parentFlushed=!0,t.blockedBoundary=l,t.blockedSegment=d;try{if(Xe(e,t,n),e.responseState.generateStaticMarkup||d.lastPushedText&&d.textEmbedded&&d.chunks.push("\x3c!-- --\x3e"),d.status=1,et(l,d),0===l.pendingTasks)break e}catch(u){d.status=4,l.forceClientRender=!0,l.errorDigest=Ve(e,u)}finally{t.blockedBoundary=o,t.blockedSegment=i}t=He(e,a,o,c,s,t.legacyContext,t.context,t.treeContext),e.pingedTasks.push(t)}return}if("object"===typeof o&&null!==o)switch(o.$$typeof){case V:if(n=Ue(e,t,o.render,n,i),0!==_e){o=t.treeContext,t.treeContext=pe(o,1,0);try{Ye(e,t,n)}finally{t.treeContext=o}}else Ye(e,t,n);return;case W:return void Ke(e,t,o=o.type,n=qe(o,n),i);case H:if(i=n.children,o=o._context,n=n.value,a=o._currentValue2,o._currentValue2=n,oe=n={parent:s=oe,depth:null===s?0:s.depth+1,context:o,parentValue:a,value:n},t.context=n,Ye(e,t,i),null===(e=oe))throw Error(r(403));return n=e.parentValue,e.context._currentValue2=n===X?e.context._defaultValue:n,e=oe=e.parent,void(t.context=e);case B:return void Ye(e,t,n=(n=n.children)(o._currentValue2));case q:return void Ke(e,t,o=(i=o._init)(o._payload),n=qe(o,n),void 0)}throw Error(r(130,null==o?o:typeof o,""))}switch(a=O((i=t.blockedSegment).chunks,o,n,e.responseState,i.formatContext),i.lastPushedText=!1,s=i.formatContext,i.formatContext=function(e,t,o){switch(t){case"select":return w(1,null!=o.value?o.value:o.defaultValue);case"svg":return w(2,null);case"math":return w(3,null);case"foreignObject":return w(1,null);case"table":return w(4,null);case"thead":case"tbody":case"tfoot":return w(5,null);case"colgroup":return w(7,null);case"tr":return w(6,null)}return 4<=e.insertionMode||0===e.insertionMode?w(1,null):e}(s,o,n),Xe(e,t,a),i.formatContext=s,o){case"area":case"base":case"br":case"col":case"embed":case"hr":case"img":case"input":case"keygen":case"link":case"meta":case"param":case"source":case"track":case"wbr":break;default:i.chunks.push("</",o,">")}i.lastPushedText=!1}}function Ye(e,t,o){if(t.node=o,"object"===typeof o&&null!==o){switch(o.$$typeof){case M:return void Ke(e,t,o.type,o.props,o.ref);case L:throw Error(r(257));case q:var n=o._init;return void Ye(e,t,o=n(o._payload))}if(x(o))return void Je(e,t,o);if(null===o||"object"!==typeof o?n=null:n="function"===typeof(n=Q&&o[Q]||o["@@iterator"])?n:null,n&&(n=n.call(o))){if(!(o=n.next()).done){var i=[];do{i.push(o.value),o=n.next()}while(!o.done);Je(e,t,i)}return}throw e=Object.prototype.toString.call(o),Error(r(31,"[object Object]"===e?"object with keys {"+Object.keys(o).join(", ")+"}":e))}"string"===typeof o?(n=t.blockedSegment).lastPushedText=N(t.blockedSegment.chunks,o,e.responseState,n.lastPushedText):"number"===typeof o&&((n=t.blockedSegment).lastPushedText=N(t.blockedSegment.chunks,""+o,e.responseState,n.lastPushedText))}function Je(e,t,o){for(var n=o.length,r=0;r<n;r++){var i=t.treeContext;t.treeContext=pe(i,n,r);try{Xe(e,t,o[r])}finally{t.treeContext=i}}}function Xe(e,t,o){var n=t.blockedSegment.formatContext,r=t.legacyContext,i=t.context;try{return Ye(e,t,o)}catch(l){if(Re(),"object"!==typeof l||null===l||"function"!==typeof l.then)throw t.blockedSegment.formatContext=n,t.legacyContext=r,t.context=i,le(i),l;o=l;var a=t.blockedSegment,s=Be(0,a.chunks.length,null,a.formatContext,a.lastPushedText,!0);a.children.push(s),a.lastPushedText=!1,e=He(e,t.node,t.blockedBoundary,s,t.abortSet,t.legacyContext,t.context,t.treeContext).ping,o.then(e,e),t.blockedSegment.formatContext=n,t.legacyContext=r,t.context=i,le(i)}}function Qe(e){var t=e.blockedBoundary;(e=e.blockedSegment).status=3,tt(this,t,e)}function Ze(e,t,o){var n=e.blockedBoundary;e.blockedSegment.status=3,null===n?(t.allPendingTasks--,2!==t.status&&(t.status=2,null!==t.destination&&t.destination.push(null))):(n.pendingTasks--,n.forceClientRender||(n.forceClientRender=!0,e=void 0===o?Error(r(432)):o,n.errorDigest=t.onError(e),n.parentFlushed&&t.clientRenderedBoundaries.push(n)),n.fallbackAbortableTasks.forEach((function(e){return Ze(e,t,o)})),n.fallbackAbortableTasks.clear(),t.allPendingTasks--,0===t.allPendingTasks&&(n=t.onAllReady)())}function et(e,t){if(0===t.chunks.length&&1===t.children.length&&null===t.children[0].boundary){var o=t.children[0];o.id=t.id,o.parentFlushed=!0,1===o.status&&et(e,o)}else e.completedSegments.push(t)}function tt(e,t,o){if(null===t){if(o.parentFlushed){if(null!==e.completedRootSegment)throw Error(r(389));e.completedRootSegment=o}e.pendingRootTasks--,0===e.pendingRootTasks&&(e.onShellError=ze,(t=e.onShellReady)())}else t.pendingTasks--,t.forceClientRender||(0===t.pendingTasks?(o.parentFlushed&&1===o.status&&et(t,o),t.parentFlushed&&e.completedBoundaries.push(t),t.fallbackAbortableTasks.forEach(Qe,e),t.fallbackAbortableTasks.clear()):o.parentFlushed&&1===o.status&&(et(t,o),1===t.completedSegments.length&&t.parentFlushed&&e.partialBoundaries.push(t)));e.allPendingTasks--,0===e.allPendingTasks&&(e=e.onAllReady)()}function ot(e){if(2!==e.status){var t=oe,o=Fe.current;Fe.current=Me;var n=Le;Le=e.responseState;try{var r,i=e.pingedTasks;for(r=0;r<i.length;r++){var a=i[r],s=e,l=a.blockedSegment;if(0===l.status){le(a.context);try{Ye(s,a,a.node),s.responseState.generateStaticMarkup||l.lastPushedText&&l.textEmbedded&&l.chunks.push("\x3c!-- --\x3e"),a.abortSet.delete(a),l.status=1,tt(s,a.blockedBoundary,l)}catch(h){if(Re(),"object"===typeof h&&null!==h&&"function"===typeof h.then){var c=a.ping;h.then(c,c)}else{a.abortSet.delete(a),l.status=4;var d=a.blockedBoundary,u=h,p=Ve(s,u);if(null===d?$e(s,u):(d.pendingTasks--,d.forceClientRender||(d.forceClientRender=!0,d.errorDigest=p,d.parentFlushed&&s.clientRenderedBoundaries.push(d))),s.allPendingTasks--,0===s.allPendingTasks)(0,s.onAllReady)()}}}}i.splice(0,r),null!==e.destination&&lt(e,e.destination)}catch(h){Ve(e,h),$e(e,h)}finally{Le=n,Fe.current=o,o===Me&&le(t)}}}function nt(e,t,o){switch(o.parentFlushed=!0,o.status){case 0:var n=o.id=e.nextSegmentId++;return o.lastPushedText=!1,o.textEmbedded=!1,e=e.responseState,t.push('<template id="'),t.push(e.placeholderPrefix),e=n.toString(16),t.push(e),t.push('"></template>');case 1:o.status=2;var i=!0;n=o.chunks;var a=0;o=o.children;for(var s=0;s<o.length;s++){for(i=o[s];a<i.index;a++)t.push(n[a]);i=rt(e,t,i)}for(;a<n.length-1;a++)t.push(n[a]);return a<n.length&&(i=t.push(n[a])),i;default:throw Error(r(390))}}function rt(e,t,o){var n=o.boundary;if(null===n)return nt(e,t,o);if(n.parentFlushed=!0,n.forceClientRender)return e.responseState.generateStaticMarkup||(n=n.errorDigest,t.push("\x3c!--$!--\x3e"),t.push("<template"),n&&(t.push(' data-dgst="'),n=y(n),t.push(n),t.push('"')),t.push("></template>")),nt(e,t,o),e=!!e.responseState.generateStaticMarkup||t.push("\x3c!--/$--\x3e");if(0<n.pendingTasks){n.rootSegmentID=e.nextSegmentId++,0<n.completedSegments.length&&e.partialBoundaries.push(n);var i=e.responseState,a=i.nextSuspenseID++;return i=i.boundaryPrefix+a.toString(16),n=n.id=i,T(t,e.responseState,n),nt(e,t,o),t.push("\x3c!--/$--\x3e")}if(n.byteSize>e.progressiveChunkSize)return n.rootSegmentID=e.nextSegmentId++,e.completedBoundaries.push(n),T(t,e.responseState,n.id),nt(e,t,o),t.push("\x3c!--/$--\x3e");if(e.responseState.generateStaticMarkup||t.push("\x3c!--$--\x3e"),1!==(o=n.completedSegments).length)throw Error(r(391));return rt(e,t,o[0]),e=!!e.responseState.generateStaticMarkup||t.push("\x3c!--/$--\x3e")}function it(e,t,o){return function(e,t,o,n){switch(o.insertionMode){case 0:case 1:return e.push('<div hidden id="'),e.push(t.segmentPrefix),t=n.toString(16),e.push(t),e.push('">');case 2:return e.push('<svg aria-hidden="true" style="display:none" id="'),e.push(t.segmentPrefix),t=n.toString(16),e.push(t),e.push('">');case 3:return e.push('<math aria-hidden="true" style="display:none" id="'),e.push(t.segmentPrefix),t=n.toString(16),e.push(t),e.push('">');case 4:return e.push('<table hidden id="'),e.push(t.segmentPrefix),t=n.toString(16),e.push(t),e.push('">');case 5:return e.push('<table hidden><tbody id="'),e.push(t.segmentPrefix),t=n.toString(16),e.push(t),e.push('">');case 6:return e.push('<table hidden><tr id="'),e.push(t.segmentPrefix),t=n.toString(16),e.push(t),e.push('">');case 7:return e.push('<table hidden><colgroup id="'),e.push(t.segmentPrefix),t=n.toString(16),e.push(t),e.push('">');default:throw Error(r(397))}}(t,e.responseState,o.formatContext,o.id),rt(e,t,o),function(e,t){switch(t.insertionMode){case 0:case 1:return e.push("</div>");case 2:return e.push("</svg>");case 3:return e.push("</math>");case 4:return e.push("</table>");case 5:return e.push("</tbody></table>");case 6:return e.push("</tr></table>");case 7:return e.push("</colgroup></table>");default:throw Error(r(397))}}(t,o.formatContext)}function at(e,t,o){for(var n=o.completedSegments,i=0;i<n.length;i++)st(e,t,o,n[i]);if(n.length=0,e=e.responseState,n=o.id,o=o.rootSegmentID,t.push(e.startInlineScript),e.sentCompleteBoundaryFunction?t.push('$RC("'):(e.sentCompleteBoundaryFunction=!0,t.push('function $RC(a,b){a=document.getElementById(a);b=document.getElementById(b);b.parentNode.removeChild(b);if(a){a=a.previousSibling;var f=a.parentNode,c=a.nextSibling,e=0;do{if(c&&8===c.nodeType){var d=c.data;if("/$"===d)if(0===e)break;else e--;else"$"!==d&&"$?"!==d&&"$!"!==d||e++}d=c.nextSibling;f.removeChild(c);c=d}while(c);for(;b.firstChild;)f.insertBefore(b.firstChild,c);a.data="$";a._reactRetry&&a._reactRetry()}};$RC("')),null===n)throw Error(r(395));return o=o.toString(16),t.push(n),t.push('","'),t.push(e.segmentPrefix),t.push(o),t.push('")<\/script>')}function st(e,t,o,n){if(2===n.status)return!0;var i=n.id;if(-1===i){if(-1===(n.id=o.rootSegmentID))throw Error(r(392));return it(e,t,n)}return it(e,t,n),e=e.responseState,t.push(e.startInlineScript),e.sentCompleteSegmentFunction?t.push('$RS("'):(e.sentCompleteSegmentFunction=!0,t.push('function $RS(a,b){a=document.getElementById(a);b=document.getElementById(b);for(a.parentNode.removeChild(a);a.firstChild;)b.parentNode.insertBefore(a.firstChild,b);b.parentNode.removeChild(b)};$RS("')),t.push(e.segmentPrefix),i=i.toString(16),t.push(i),t.push('","'),t.push(e.placeholderPrefix),t.push(i),t.push('")<\/script>')}function lt(e,t){try{var o=e.completedRootSegment;if(null!==o&&0===e.pendingRootTasks){rt(e,t,o),e.completedRootSegment=null;var n=e.responseState.bootstrapChunks;for(o=0;o<n.length-1;o++)t.push(n[o]);o<n.length&&t.push(n[o])}var i,a=e.clientRenderedBoundaries;for(i=0;i<a.length;i++){var s=a[i];n=t;var l=e.responseState,c=s.id,d=s.errorDigest,u=s.errorMessage,p=s.errorComponentStack;if(n.push(l.startInlineScript),l.sentClientRenderFunction?n.push('$RX("'):(l.sentClientRenderFunction=!0,n.push('function $RX(b,c,d,e){var a=document.getElementById(b);a&&(b=a.previousSibling,b.data="$!",a=a.dataset,c&&(a.dgst=c),d&&(a.msg=d),e&&(a.stck=e),b._reactRetry&&b._reactRetry())};$RX("')),null===c)throw Error(r(395));if(n.push(c),n.push('"'),d||u||p){n.push(",");var h=P(d||"");n.push(h)}if(u||p){n.push(",");var f=P(u||"");n.push(f)}if(p){n.push(",");var g=P(p);n.push(g)}if(!n.push(")<\/script>"))return e.destination=null,i++,void a.splice(0,i)}a.splice(0,i);var m=e.completedBoundaries;for(i=0;i<m.length;i++)if(!at(e,t,m[i]))return e.destination=null,i++,void m.splice(0,i);m.splice(0,i);var y=e.partialBoundaries;for(i=0;i<y.length;i++){var v=y[i];e:{a=e,s=t;var b=v.completedSegments;for(l=0;l<b.length;l++)if(!st(a,s,v,b[l])){l++,b.splice(0,l);var x=!1;break e}b.splice(0,l),x=!0}if(!x)return e.destination=null,i++,void y.splice(0,i)}y.splice(0,i);var w=e.completedBoundaries;for(i=0;i<w.length;i++)if(!at(e,t,w[i]))return e.destination=null,i++,void w.splice(0,i);w.splice(0,i)}finally{0===e.allPendingTasks&&0===e.pingedTasks.length&&0===e.clientRenderedBoundaries.length&&0===e.completedBoundaries.length&&t.push(null)}}function ct(e,t){try{var o=e.abortableTasks;o.forEach((function(o){return Ze(o,e,t)})),o.clear(),null!==e.destination&&lt(e,e.destination)}catch(n){Ve(e,n),$e(e,n)}}function dt(){}function ut(e,t,o,n){var i=!1,a=null,s="",l={push:function(e){return null!==e&&(s+=e),!0},destroy:function(e){i=!0,a=e}},c=!1;if(e=function(e,t,o,n,r,i,a,s,l){var c=[],d=new Set;return(o=Be(t={destination:null,responseState:t,progressiveChunkSize:void 0===n?12800:n,status:0,fatalError:null,nextSegmentId:0,allPendingTasks:0,pendingRootTasks:0,completedRootSegment:null,abortableTasks:d,pingedTasks:c,clientRenderedBoundaries:[],completedBoundaries:[],partialBoundaries:[],onError:void 0===r?Ge:r,onAllReady:void 0===i?ze:i,onShellReady:void 0===a?ze:a,onShellError:void 0===s?ze:s,onFatalError:void 0===l?ze:l},0,null,o,!1,!1)).parentFlushed=!0,e=He(t,e,null,o,d,ee,null,ue),c.push(e),t}(e,function(e,t){return{bootstrapChunks:[],startInlineScript:"<script>",placeholderPrefix:(t=void 0===t?"":t)+"P:",segmentPrefix:t+"S:",boundaryPrefix:t+"B:",idPrefix:t,nextSuspenseID:0,sentCompleteSegmentFunction:!1,sentCompleteBoundaryFunction:!1,sentClientRenderFunction:!1,generateStaticMarkup:e}}(o,t?t.identifierPrefix:void 0),{insertionMode:1,selectedValue:null},1/0,dt,void 0,(function(){c=!0}),void 0,void 0),ot(e),ct(e,n),1===e.status)e.status=2,l.destroy(e.fatalError);else if(2!==e.status&&null===e.destination){e.destination=l;try{lt(e,l)}catch(d){Ve(e,d),$e(e,d)}}if(i)throw a;if(!c)throw Error(r(426));return s}t.renderToNodeStream=function(){throw Error(r(207))},t.renderToStaticMarkup=function(e,t){return ut(e,t,!0,'The server used "renderToStaticMarkup" which does not support Suspense. If you intended to have the server wait for the suspended component please switch to "renderToReadableStream" which supports Suspense on the server')},t.renderToStaticNodeStream=function(){throw Error(r(208))},t.renderToString=function(e,t){return ut(e,t,!1,'The server used "renderToString" which does not support Suspense. If you intended for this Suspense boundary to render the fallback content on the server consider throwing an Error somewhere within the Suspense boundary. If you intended to have the server wait for the suspended component please switch to "renderToReadableStream" which supports Suspense on the server')},t.version="18.3.1"},2168:(e,t,o)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=o(5043),r=o(9201),i=o(9724);t.default=function(e,t,o,a,s,l){var c=n.useContext(r.BeansContext),d=c.context,u=(c.userComponentFactory,n.useCallback((function(){var e=s.current;if(e){var t=e.getGui();t&&t.parentElement&&t.parentElement.removeChild(t),d.destroyBean(e),s.current=void 0}}),[]));n.useEffect((function(){var n=null!=e,r=e&&e.compDetails&&!e.compDetails.componentFromFramework;if(n&&r&&!(t&&null==o)){var i=e.compDetails;if(s.current){var a=s.current,c=!!(null!=a.refresh&&0==e.force)&&a.refresh(i.params);if(!0===c||void 0===c)return;u()}var d=i.newAgStackInstance();if(d){var p=d.resolveNow(null,(function(e){return e}));if(p){var h=p.getGui();if(h)(t?o:l.current).appendChild(h),s.current=p}}}else u()}),[e,t,a]),i.useEffectOnce((function(){return u}))}},2206:(e,t,o)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t){var o=(0,i.default)(e);if(!o.length)return void t.preventDefault();var n=void 0,r=t.shiftKey,s=o[0],l=o[o.length-1],c=a();if(e===c){if(!r)return;n=l}l!==c||r||(n=s);s===c&&r&&(n=l);if(n)return t.preventDefault(),void n.focus();var d=/(\bChrome\b|\bSafari\b)\//.exec(navigator.userAgent);if(null==d||"Chrome"==d[1]||null!=/\biPod\b|\biPad\b/g.exec(navigator.userAgent))return;var u=o.indexOf(c);u>-1&&(u+=r?-1:1);if("undefined"===typeof(n=o[u]))return t.preventDefault(),void(n=r?l:s).focus();t.preventDefault(),n.focus()};var n,r=o(4682),i=(n=r)&&n.__esModule?n:{default:n};function a(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:document;return e.activeElement.shadowRoot?a(e.activeElement.shadowRoot):e.activeElement}e.exports=t.default},2233:(e,t,o)=>{"use strict";o.d(t,{A:()=>O});var n=o(5043),r=o(2963),i=o.n(r),a=o(1529),s=o(1009),l=o(579);const c=a.Ay.div`
  display: flex;
  justify-content: space-between;
  align-items: center;
  padding: 15px;
  border-bottom: 1px solid #333;
`,d=a.Ay.button`
  background: none;
  border: none;
  color: #ccc;
  cursor: pointer;
  font-size: 20px;
  display: flex;
  align-items: center;
  justify-content: center;
  padding: 5px;
  
  &:hover {
    color: #fff;
  }
`,u=a.Ay.div`
  padding: 20px;
  color: #eee;
  position: relative;
  box-sizing: border-box;
`,p=a.Ay.div`
  background: #2d2d2d;
  border-radius: 5px;
  padding: 20px;
  display: flex;
  flex-direction: column;
  gap: 15px;
  border: 1px solid #444;
`,h=a.Ay.div`
  display: flex;
  gap: 15px;
`,f=a.Ay.div`
  width: 80px;
  height: 80px;
  background: #0077b5;
  border-radius: 50%;
  display: flex;
  align-items: center;
  justify-content: center;
  color: white;
  font-size: 32px;
  font-weight: bold;
`,g=a.Ay.div`
  display: flex;
  flex-direction: column;
  justify-content: center;
  gap: 5px;
  flex: 1;
`,m=a.Ay.div`
  font-size: 18px;
  font-weight: bold;
  color: white;
`,y=a.Ay.div`
  font-size: 14px;
  color: #bbb;
  margin-bottom: 5px;
`,v=a.Ay.div`
  font-size: 13px;
  color: #999;
`,b=a.Ay.a`
  display: flex;
  align-items: center;
  justify-content: center;
  gap: 6px;
  background: #0077b5;
  color: white;
  padding: 8px 0;
  text-decoration: none;
  border-radius: 4px;
  text-align: center;
  font-size: 14px;
  font-weight: 500;
  cursor: pointer;
  margin-top: 8px;
  
  &:hover {
    background: #006097;
  }
`,x=a.Ay.div`
  margin-top: 20px;
  padding-top: 20px;
  border-top: 1px solid #444;
  box-sizing: border-box;
  width: 100%;
`,w=a.Ay.div`
  font-size: 15px;
  font-weight: 600;
  margin-bottom: 15px;
  color: #ddd;
`,C=a.Ay.div`
  margin-bottom: 15px;
  padding-right: 10px; /* Add consistent right padding */
`,_=a.Ay.label`
  display: block;
  margin-bottom: 8px;
  color: #bbb;
  font-size: 13px;
`,S=a.Ay.input`
  width: 100%; /* Full width */
  padding: 10px;
  background: #1e1e1e;
  border: 1px solid #444;
  border-radius: 4px;
  color: white;
  font-size: 14px;
  box-sizing: border-box; /* Ensures padding doesn't add to width */
  
  &:focus {
    outline: none;
    border-color: #0077b5;
  }
`,E=a.Ay.div`
  display: flex;
  justify-content: space-between;
  gap: 10px;
  margin-top: 20px;
`,k=a.Ay.button`
  flex: 1;
  display: flex;
  align-items: center;
  justify-content: center;
  gap: 5px;
  padding: 10px;
  border-radius: 4px;
  font-size: 14px;
  cursor: pointer;
  border: none;
  
  &:disabled {
    opacity: 0.6;
    cursor: not-allowed;
  }
`,j=(0,a.Ay)(k)`
  background: #00ff00;
  color: #111;
  
  &:hover:not(:disabled) {
    background: #00cc00;
  }
`,A=(0,a.Ay)(k)`
  background: #333;
  color: #eee;
  
  &:hover {
    background: #444;
  }
`,R={content:{top:"50%",left:"50%",right:"auto",bottom:"auto",marginRight:"-50%",transform:"translate(-50%, -50%)",background:"#222",border:"1px solid #333",borderRadius:"5px",padding:"0",width:"550px",maxWidth:"90%",maxHeight:"90vh",overflow:"auto"},overlay:{backgroundColor:"rgba(0, 0, 0, 0.75)",zIndex:1e3}};"undefined"!==typeof window&&i().setAppElement("#root");const O=e=>{let{isOpen:t,onClose:o,linkedInUrl:r,contactName:a,jobRole:k,onSaveData:O,firstName:T,lastName:D,email:P}=e;const[N,I]=(0,n.useState)(k||""),[M,L]=(0,n.useState)(""),[F,G]=(0,n.useState)(""),[z,H]=(0,n.useState)(""),[B,V]=(0,n.useState)([]),[$,U]=(0,n.useState)(""),[W,q]=(0,n.useState)(!1),[K,Y]=(0,n.useState)(null),[J,X]=(0,n.useState)(!1),Q=async()=>{q(!0),Y(null);try{const e="localhost"===window.location.hostname||"127.0.0.1"===window.location.hostname,t=e?"https://your-netlify-site.netlify.app/.netlify/functions/linkedin-job-extract":"/.netlify/functions/linkedin-job-extract";if(e){console.log("Development mode detected - using mock data instead of API call"),await new Promise((e=>setTimeout(e,1e3)));const e="Tech Company Inc.",t="https://techcompany.com",o="A leading technology company focused on creating innovative solutions.",n=["technology","software","engineering","innovation"],r="San Francisco, CA";return I(k||"Software Engineer"),L(e),G(t),H(o),V(n),U(r),q(!1),void X(!0)}const o=await fetch(t,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({firstName:T||a.split(" ")[0]||"",lastName:D||(a.split(" ").length>1?a.split(" ").slice(1).join(" "):""),email:P||null,linkedinUrl:r||null})}),n=await o.json();n.success&&n.data?(n.data.jobTitle&&I(n.data.jobTitle),n.data.company&&L(n.data.company),n.data.companyWebsite&&G(n.data.companyWebsite),n.data.companyDescription&&H(n.data.companyDescription),n.data.keywords&&n.data.keywords.length>0&&V(n.data.keywords),n.data.city&&U(n.data.city)):Y(n.error||"Unable to extract data from LinkedIn")}catch(e){console.error("Failed to extract LinkedIn data:",e),Y("Failed to extract data from LinkedIn. Please try manually entering the information.")}finally{q(!1),X(!0)}};(0,n.useEffect)((()=>{t&&r&&!J&&Q()}),[t,r]);return(0,l.jsxs)(i(),{isOpen:t,onRequestClose:o,style:R,contentLabel:"LinkedIn Preview",children:[(0,l.jsxs)(c,{children:[(0,l.jsx)("h3",{style:{margin:0,fontSize:"16px"},children:"LinkedIn Profile Preview"}),(0,l.jsx)(d,{onClick:o,children:(0,l.jsx)(s.yGN,{})})]}),(0,l.jsxs)(u,{children:[(0,l.jsxs)(p,{children:[(0,l.jsxs)(h,{children:[(0,l.jsx)(f,{children:(e=>{if(!e)return"?";const t=e.split(" ");return 1===t.length?t[0].charAt(0).toUpperCase():`${t[0].charAt(0)}${t[t.length-1].charAt(0)}`.toUpperCase()})(a)}),(0,l.jsxs)(g,{children:[(0,l.jsx)(m,{children:a}),(0,l.jsx)(y,{children:N&&M?`${N} at ${M}`:N||(W?"Extracting data...":"Add job information")}),(0,l.jsx)(v,{children:r?"LinkedIn Profile":"No LinkedIn URL"})]})]}),(0,l.jsxs)(b,{href:r,target:"_blank",rel:"noopener noreferrer",disabled:!r,children:[(0,l.jsx)(s.ayE,{size:14})," Visit Full LinkedIn Profile"]})]}),(0,l.jsxs)(x,{children:[(0,l.jsxs)(w,{style:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[(0,l.jsxs)("div",{children:[(0,l.jsx)(s.qYx,{size:16,style:{marginRight:"6px",verticalAlign:"text-bottom"}}),"Professional Information"]}),r&&(0,l.jsx)("button",{onClick:Q,disabled:W,style:{background:"transparent",border:"none",color:"#0077b5",cursor:W?"not-allowed":"pointer",fontSize:"14px",display:"flex",alignItems:"center",gap:"5px",opacity:W?.6:1},children:W?(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)(s.TwU,{size:14,style:{animation:"spin 1.5s linear infinite"}})," Extracting..."]}):(0,l.jsx)(l.Fragment,{children:"Refresh"})})]}),K&&(0,l.jsx)("div",{style:{padding:"10px 12px",marginBottom:"12px",background:"rgba(255, 0, 0, 0.1)",border:"1px solid rgba(255, 0, 0, 0.2)",borderRadius:"4px",color:"#ff6b6b",fontSize:"13px"},children:K}),(0,l.jsxs)(C,{children:[(0,l.jsxs)(_,{children:["Job Title ",W&&(0,l.jsx)("small",{style:{color:"#999",fontWeight:"normal"},children:"(extracting...)"})]}),(0,l.jsx)(S,{type:"text",value:N,onChange:e=>I(e.target.value),placeholder:"Enter job title (e.g. Software Engineer)",disabled:W})]}),(0,l.jsxs)(C,{children:[(0,l.jsxs)(_,{children:["Company ",W&&(0,l.jsx)("small",{style:{color:"#999",fontWeight:"normal"},children:"(extracting...)"})]}),(0,l.jsx)(S,{type:"text",value:M,onChange:e=>L(e.target.value),placeholder:"Enter company name (e.g. Acme Corp)",disabled:W})]}),(0,l.jsxs)(C,{children:[(0,l.jsxs)(_,{children:["Company Website ",W&&(0,l.jsx)("small",{style:{color:"#999",fontWeight:"normal"},children:"(extracting...)"})]}),(0,l.jsx)(S,{type:"text",value:F,onChange:e=>G(e.target.value),placeholder:"Enter company website (e.g. https://company.com)",disabled:W})]}),(0,l.jsxs)(C,{children:[(0,l.jsxs)(_,{children:["City ",W&&(0,l.jsx)("small",{style:{color:"#999",fontWeight:"normal"},children:"(extracting...)"})]}),(0,l.jsx)(S,{type:"text",value:$,onChange:e=>U(e.target.value),placeholder:"Enter city (e.g. San Francisco, CA)",disabled:W})]}),(0,l.jsxs)(C,{children:[(0,l.jsxs)(_,{children:["About the Company ",W&&(0,l.jsx)("small",{style:{color:"#999",fontWeight:"normal"},children:"(extracting...)"})]}),(0,l.jsx)("textarea",{value:z,onChange:e=>H(e.target.value),placeholder:"Enter information about the company",disabled:W,style:{width:"100%",minHeight:"80px",padding:"10px",background:"#1e1e1e",border:"1px solid #444",borderRadius:"4px",color:"white",fontSize:"14px",boxSizing:"border-box",resize:"vertical"}})]}),B.length>0&&(0,l.jsxs)(C,{children:[(0,l.jsx)(_,{children:"Keywords/Tags"}),(0,l.jsx)("div",{style:{display:"flex",flexWrap:"wrap",gap:"5px",marginTop:"5px"},children:B.map(((e,t)=>(0,l.jsx)("div",{style:{background:"#333",padding:"4px 8px",borderRadius:"4px",fontSize:"12px",color:"#ddd"},children:e},t)))})]}),(0,l.jsxs)(E,{children:[(0,l.jsx)(A,{onClick:o,disabled:W,children:"Cancel"}),(0,l.jsxs)(j,{onClick:()=>{O&&O({jobRole:N,company:M,companyWebsite:F,companyDescription:z,keywords:B,city:$}),o()},disabled:W||!N&&!M,children:[(0,l.jsx)(s.YrT,{size:14})," Save Information"]})]})]})]})]})}},2239:(e,t,o)=>{"use strict";o.d(t,{q:()=>r});var n={};function r(){return n}},2284:(e,t,o)=>{"use strict";function n(e){return n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},n(e)}o.d(t,{A:()=>n})},2285:(e,t,o)=>{"use strict";o.d(t,{faC:()=>i,ijb:()=>r});var n=o(6688);function r(e){return(0,n.k5)({tag:"svg",attr:{viewBox:"0 0 24 24"},child:[{tag:"path",attr:{d:"M18.3362 18.339H15.6707V14.1622C15.6707 13.1662 15.6505 11.8845 14.2817 11.8845C12.892 11.8845 12.6797 12.9683 12.6797 14.0887V18.339H10.0142V9.75H12.5747V10.9207H12.6092C12.967 10.2457 13.837 9.53325 15.1367 9.53325C17.8375 9.53325 18.337 11.3108 18.337 13.6245V18.339H18.3362ZM7.00373 8.57475C6.14573 8.57475 5.45648 7.88025 5.45648 7.026C5.45648 6.1725 6.14648 5.47875 7.00373 5.47875C7.85873 5.47875 8.55173 6.1725 8.55173 7.026C8.55173 7.88025 7.85798 8.57475 7.00373 8.57475ZM8.34023 18.339H5.66723V9.75H8.34023V18.339ZM19.6697 3H4.32923C3.59498 3 3.00098 3.5805 3.00098 4.29675V19.7033C3.00098 20.4202 3.59498 21 4.32923 21H19.6675C20.401 21 21.001 20.4202 21.001 19.7033V4.29675C21.001 3.5805 20.401 3 19.6675 3H19.6697Z"}}]})(e)}function i(e){return(0,n.k5)({tag:"svg",attr:{viewBox:"0 0 24 24"},child:[{tag:"path",attr:{d:"M12.001 2C17.5238 2 22.001 6.47715 22.001 12C22.001 17.5228 17.5238 22 12.001 22C10.1671 22 8.44851 21.5064 6.97086 20.6447L2.00516 22L3.35712 17.0315C2.49494 15.5536 2.00098 13.8345 2.00098 12C2.00098 6.47715 6.47813 2 12.001 2ZM8.59339 7.30019L8.39232 7.30833C8.26293 7.31742 8.13607 7.34902 8.02057 7.40811C7.93392 7.45244 7.85348 7.51651 7.72709 7.63586C7.60774 7.74855 7.53857 7.84697 7.46569 7.94186C7.09599 8.4232 6.89729 9.01405 6.90098 9.62098C6.90299 10.1116 7.03043 10.5884 7.23169 11.0336C7.63982 11.9364 8.31288 12.8908 9.20194 13.7759C9.4155 13.9885 9.62473 14.2034 9.85034 14.402C10.9538 15.3736 12.2688 16.0742 13.6907 16.4482C13.6907 16.4482 14.2507 16.5342 14.2589 16.5347C14.4444 16.5447 14.6296 16.5313 14.8153 16.5218C15.1066 16.5068 15.391 16.428 15.6484 16.2909C15.8139 16.2028 15.8922 16.159 16.0311 16.0714C16.0311 16.0714 16.0737 16.0426 16.1559 15.9814C16.2909 15.8808 16.3743 15.81 16.4866 15.6934C16.5694 15.6074 16.6406 15.5058 16.6956 15.3913C16.7738 15.2281 16.8525 14.9166 16.8838 14.6579C16.9077 14.4603 16.9005 14.3523 16.8979 14.2854C16.8936 14.1778 16.8047 14.0671 16.7073 14.0201L16.1258 13.7587C16.1258 13.7587 15.2563 13.3803 14.7245 13.1377C14.6691 13.1124 14.6085 13.1007 14.5476 13.097C14.4142 13.0888 14.2647 13.1236 14.1696 13.2238C14.1646 13.2218 14.0984 13.279 13.3749 14.1555C13.335 14.2032 13.2415 14.3069 13.0798 14.2972C13.0554 14.2955 13.0311 14.292 13.0074 14.2858C12.9419 14.2685 12.8781 14.2457 12.8157 14.2193C12.692 14.1668 12.6486 14.1469 12.5641 14.1105C11.9868 13.8583 11.457 13.5209 10.9887 13.108C10.8631 12.9974 10.7463 12.8783 10.6259 12.7616C10.2057 12.3543 9.86169 11.9211 9.60577 11.4938C9.5918 11.4705 9.57027 11.4368 9.54708 11.3991C9.50521 11.331 9.45903 11.25 9.44455 11.1944C9.40738 11.0473 9.50599 10.9291 9.50599 10.9291C9.50599 10.9291 9.74939 10.663 9.86248 10.5183C9.97128 10.379 10.0652 10.2428 10.125 10.1457C10.2428 9.95633 10.2801 9.76062 10.2182 9.60963C9.93764 8.92565 9.64818 8.24536 9.34986 7.56894C9.29098 7.43545 9.11585 7.33846 8.95659 7.32007C8.90265 7.31384 8.84875 7.30758 8.79459 7.30402C8.66053 7.29748 8.5262 7.29892 8.39232 7.30833L8.59339 7.30019Z"}}]})(e)}},2342:()=>{},2430:function(e,t,o){"use strict";var n=this&&this.__extends||function(){var e=function(t,o){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])},e(t,o)};return function(t,o){function n(){this.constructor=t}e(t,o),t.prototype=null===o?Object.create(o):(n.prototype=o.prototype,new n)}}(),r=this&&this.__assign||function(){return r=Object.assign||function(e){for(var t,o=1,n=arguments.length;o<n;o++)for(var r in t=arguments[o])Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e},r.apply(this,arguments)},i=this&&this.__createBinding||(Object.create?function(e,t,o,n){void 0===n&&(n=o),Object.defineProperty(e,n,{enumerable:!0,get:function(){return t[o]}})}:function(e,t,o,n){void 0===n&&(n=o),e[n]=t[o]}),a=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),s=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var o in e)"default"!==o&&Object.prototype.hasOwnProperty.call(e,o)&&i(t,e,o);return a(t,e),t},l=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.AgGridReactUi=void 0;var c=o(7079),d=s(o(5043)),u=o(4923),p=o(2678),h=l(o(296)),f=o(9385);var g=function(e){function t(t){var o=e.call(this,t)||this;return o.props=t,o.destroyFuncs=[],o.eGui=d.default.createRef(),o.whenReadyFuncs=[],o.ready=!1,o.renderedAfterMount=!1,o.mounted=!1,o.state={context:void 0},o.portalManager=new p.PortalManager(o,t.componentWrappingElement,t.maxComponentCreationTimeMs),o.destroyFuncs.push((function(){return o.portalManager.destroy()})),o}return n(t,e),t.prototype.render=function(){return this.state.context,this.state.context&&(this.renderedAfterMount=!0),d.default.createElement("div",{style:this.createStyleForDiv(),className:this.props.className,ref:this.eGui},this.state.context&&d.default.createElement(h.default,{context:this.state.context}),this.portalManager.getPortals())},t.prototype.createStyleForDiv=function(){return r({height:"100%"},this.props.containerStyle||{})},t.prototype.componentDidMount=function(){var e=this;if(!this.mounted){this.mounted=!0;var t=this.props.modules||[],o={providedBeanInstances:{frameworkComponentWrapper:new m(this.portalManager)},modules:t,frameworkOverrides:new f.ReactFrameworkOverrides(!0)};this.gridOptions=this.props.gridOptions||{},this.gridOptions=c.ComponentUtil.copyAttributesToGridOptions(this.gridOptions,this.props),this.checkForDeprecations(this.props);(new c.GridCoreCreator).create(this.eGui.current,this.gridOptions,(function(t){e.setState({context:t}),t.getBean(c.CtrlsService.NAME).whenReady((function(){e.api=e.gridOptions.api,e.columnApi=e.gridOptions.columnApi,e.props.setGridApi(e.api,e.columnApi),e.destroyFuncs.push((function(){return e.api.destroy()}))}))}),(function(t){t.getBean(c.CtrlsService.NAME).whenReady((function(){e.whenReadyFuncs.forEach((function(e){return e()})),e.whenReadyFuncs.length=0,e.ready=!0}))}),o)}},t.prototype.checkForDeprecations=function(e){e.rowDataChangeDetectionStrategy&&c._.doOnce((function(){return console.warn("AG Grid: Since v29 rowDataChangeDetectionStrategy has been deprecated. Row data property changes will be compared by reference via triple equals ===. See https://ag-grid.com/react-data-grid/react-hooks/")}),"rowDataChangeDetectionStrategy_Deprecation")},t.prototype.componentWillUnmount=function(){this.renderedAfterMount&&(this.destroyFuncs.forEach((function(e){return e()})),this.destroyFuncs.length=0)},t.prototype.componentDidUpdate=function(e){this.processPropsChanges(e,this.props)},t.prototype.processPropsChanges=function(e,t){var o={};this.extractGridPropertyChanges(e,t,o),this.processChanges(o)},t.prototype.extractGridPropertyChanges=function(e,t,o){var n=!!t.debug;Object.keys(t).forEach((function(r){c.ComponentUtil.ALL_PROPERTIES_SET.has(r)&&e[r]!==t[r]&&(n&&console.log("agGridReact: ["+r+"] property changed"),o[r]={previousValue:e[r],currentValue:t[r]})})),c.ComponentUtil.EVENT_CALLBACKS.forEach((function(r){e[r]!==t[r]&&(n&&console.log("agGridReact: ["+r+"] event callback changed"),o[r]={previousValue:e[r],currentValue:t[r]})}))},t.prototype.processChanges=function(e){var t=this;this.processWhenReady((function(){return c.ComponentUtil.processOnChange(e,t.api)}))},t.prototype.processWhenReady=function(e){this.ready?e():this.whenReadyFuncs.push(e)},t}(d.Component);t.AgGridReactUi=g;var m=function(e){function t(t){var o=e.call(this)||this;return o.parent=t,o}return n(t,e),t.prototype.createWrapper=function(e,t){return new u.NewReactComponent(e,this.parent,t)},t}(c.BaseComponentWrapper)},2509:(e,t,o)=>{"use strict";o.d(t,{A:()=>k});var n=o(5043),r=o(1529),i=o(2963),a=o.n(i),s=o(5315),l=o(3768),c=o(5852),d=o(1009),u=o(579);const p=r.Ay.div`
  display: flex;
  justify-content: space-between;
  align-items: center;
  padding-bottom: 15px;
  margin-bottom: 20px;
  border-bottom: 1px solid #333;

  h2 {
    color: #00ff00;
    margin: 0;
    font-size: 1.2rem;
    font-family: 'Courier New', monospace;
  }
`,h=r.Ay.button`
  background: none;
  border: none;
  color: #ff5555;
  font-size: 1.2rem;
  cursor: pointer;
  display: flex;
  align-items: center;
  justify-content: center;
  
  &:hover {
    color: #ff0000;
  }
`,f=r.Ay.div`
  background-color: #1a1a1a;
  border-radius: 8px;
  border: 1px solid #333;
  padding: 20px;
  margin-bottom: 15px;
`,g=r.Ay.h3`
  color: #00ff00;
  margin: 0 0 15px 0;
  font-size: 1rem;
  display: flex;
  align-items: center;
  gap: 8px;
  padding-bottom: 6px;
  border-bottom: 1px solid #333;
`,m=r.Ay.div`
  margin-bottom: 30px;
`,y=r.Ay.div`
  display: flex;
  justify-content: space-between;
  margin-top: 30px;
`,v=r.Ay.button`
  padding: 10px 20px;
  border-radius: 4px;
  font-weight: bold;
  cursor: pointer;
  display: flex;
  align-items: center;
  gap: 8px;
  
  &:disabled {
    opacity: 0.5;
    cursor: not-allowed;
  }
`,b=(0,r.Ay)(v)`
  background-color: #00ff00;
  color: #000;
  border: none;
  
  &:hover:not(:disabled) {
    background-color: #00cc00;
  }
`,x=(0,r.Ay)(v)`
  background-color: transparent;
  color: #ccc;
  border: 1px solid #555;
  
  &:hover:not(:disabled) {
    background-color: #333;
  }
`,w=r.Ay.div`
  display: flex;
  flex-direction: column;
  align-items: center;
  justify-content: center;
  padding: 40px;
`,C=r.Ay.table`
  width: 100%;
  border-collapse: collapse;
  margin-bottom: 20px;
  
  th, td {
    padding: 8px 12px;
    text-align: left;
    border-bottom: 1px solid #333;
  }
  
  th {
    color: #999;
    font-weight: normal;
    font-size: 0.85rem;
  }
  
  td {
    color: #eee;
  }
  
  tr:hover td {
    background-color: #222;
  }
`,_=r.Ay.label`
  display: flex;
  align-items: center;
  gap: 8px;
  padding: 8px;
  border-radius: 4px;
  cursor: pointer;
  
  &:hover {
    background-color: #222;
  }
`,S=r.Ay.input`
  appearance: none;
  width: 16px;
  height: 16px;
  border: 1px solid #00ff00;
  border-radius: 50%;
  position: relative;
  
  &:checked {
    &:after {
      content: '';
      position: absolute;
      top: 3px;
      left: 3px;
      width: 8px;
      height: 8px;
      background-color: #00ff00;
      border-radius: 50%;
    }
  }
`,E=r.Ay.span`
  display: inline-block;
  background-color: ${e=>e.bg||"#222"};
  color: ${e=>e.color||"#00ff00"};
  border: 1px solid ${e=>e.borderColor||"#00ff00"};
  padding: 2px 6px;
  margin-right: 3px;
  border-radius: 4px;
  font-size: 11px;
`,k=e=>{let{isOpen:t,onClose:o,primaryContactId:r,duplicateContactId:i,onComplete:v}=e;const[k,j]=(0,n.useState)(!0),[A,R]=(0,n.useState)(null),[O,T]=(0,n.useState)(null),[D,P]=(0,n.useState)(null),[N,I]=(0,n.useState)({});(0,n.useEffect)((()=>{t&&r&&i&&M()}),[t,r,i]);const M=async()=>{j(!0),R(null);try{const[e,t]=await Promise.all([L(r),L(i)]);T(e),P(t),F(e,t)}catch(e){console.error("Error loading contact data:",e),R("Failed to load contact data. Please try again.")}finally{j(!1)}},L=async e=>{var t,o;const{data:n,error:r}=await s.supabase.from("contacts").select("*").eq("contact_id",e).single();if(r)throw r;if(!n)throw new Error(`Contact ${e} not found`);const[i,a,l,c,d]=await Promise.all([s.supabase.from("contact_emails").select("*").eq("contact_id",e),s.supabase.from("contact_mobiles").select("*").eq("contact_id",e),s.supabase.from("contact_tags").select("tags (*)").eq("contact_id",e),s.supabase.from("contact_cities").select("cities (*)").eq("contact_id",e),s.supabase.from("contact_companies").select("companies (*), relationship, is_primary").eq("contact_id",e)]);return{...n,emails:i.data||[],mobiles:a.data||[],tags:(null===(t=l.data)||void 0===t?void 0:t.map((e=>e.tags)))||[],cities:(null===(o=c.data)||void 0===o?void 0:o.map((e=>e.cities)))||[],companies:d.data||[]}},F=(e,t)=>{const o={first_name:"primary",last_name:"primary",category:"primary",job_role:"primary",linkedin:"primary",description:"primary",score:"primary",birthday:"primary",keep_in_touch_frequency:"primary",emails:"combine",mobiles:"combine",tags:"combine",cities:"combine",companies:"combine"};!e.first_name&&t.first_name&&(o.first_name="duplicate"),!e.last_name&&t.last_name&&(o.last_name="duplicate"),"Inbox"===e.category&&"Inbox"!==t.category&&(o.category="duplicate"),!e.job_role&&t.job_role&&(o.job_role="duplicate"),!e.linkedin&&t.linkedin&&(o.linkedin="duplicate"),!e.description&&t.description&&(o.description="duplicate"),null!==e.score&&void 0!==e.score||null===t.score||(o.score="duplicate"),!e.birthday&&t.birthday&&(o.birthday="duplicate"),!e.keep_in_touch_frequency&&t.keep_in_touch_frequency&&(o.keep_in_touch_frequency="duplicate"),I(o)},G=(e,t)=>{I((o=>({...o,[e]:t})))},z=()=>{T(null),P(null),R(null),j(!1),o()},H=(e,t)=>e?(0,u.jsxs)(f,{children:[(0,u.jsx)(g,{children:t}),(0,u.jsxs)("div",{style:{marginBottom:"20px"},children:[(0,u.jsxs)("div",{style:{fontSize:"1.2rem",fontWeight:"bold",marginBottom:"8px",color:"#00ff00"},children:[e.first_name," ",e.last_name]}),(0,u.jsxs)("div",{style:{display:"flex",flexWrap:"wrap",gap:"10px",fontSize:"0.9rem",color:"#ccc"},children:[e.email&&(0,u.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:"5px"},children:[(0,u.jsx)(d.pHD,{size:14}),e.email]}),e.mobile&&(0,u.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:"5px"},children:[(0,u.jsx)(d.QFc,{size:14}),e.mobile]}),e.category&&(0,u.jsx)(E,{children:e.category})]})]})]}):null;return(0,u.jsxs)(a(),{isOpen:t,onRequestClose:k?null:z,shouldCloseOnOverlayClick:!k,style:{content:{top:"50%",left:"50%",right:"auto",bottom:"auto",marginRight:"-50%",transform:"translate(-50%, -50%)",padding:"25px",maxWidth:"800px",width:"90%",maxHeight:"90vh",overflow:"auto",backgroundColor:"#121212",border:"1px solid #333",borderRadius:"8px",boxShadow:"0 4px 20px rgba(0, 0, 0, 0.6)",color:"#e0e0e0",zIndex:1001},overlay:{backgroundColor:"rgba(0, 0, 0, 0.75)",zIndex:1e3}},contentLabel:"Duplicate Processing",children:[(0,u.jsxs)(p,{children:[(0,u.jsx)("h2",{children:"Merge Duplicate Contacts"}),(0,u.jsx)(h,{onClick:z,disabled:k,children:(0,u.jsx)(d.yGN,{})})]}),A&&(0,u.jsxs)("div",{style:{backgroundColor:"rgba(255, 70, 70, 0.2)",color:"#ff9999",padding:"10px 15px",borderRadius:"4px",marginBottom:"15px",display:"flex",alignItems:"center",gap:"10px"},children:[(0,u.jsx)(d.eHT,{}),(0,u.jsx)("div",{children:A})]}),k?(0,u.jsx)(w,{children:(0,u.jsx)("div",{style:{color:"#00ff00",marginBottom:"10px"},children:"Loading contact data..."})}):(0,u.jsxs)(m,{children:[(0,u.jsxs)("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:"15px"},children:[H(O,"Primary Contact"),H(D,"Duplicate Contact")]}),(0,u.jsxs)(f,{children:[(0,u.jsxs)(g,{children:[(0,u.jsx)(d.EPw,{})," Merge Contact Data"]}),(0,u.jsx)("p",{style:{color:"#999",marginBottom:"15px"},children:"Select which data to keep from each contact."}),O&&D&&(0,u.jsxs)(C,{children:[(0,u.jsx)("thead",{children:(0,u.jsxs)("tr",{children:[(0,u.jsx)("th",{children:"Field"}),(0,u.jsx)("th",{children:"Primary Contact"}),(0,u.jsx)("th",{children:"Duplicate Contact"}),(0,u.jsx)("th",{children:"Selection"})]})}),(0,u.jsxs)("tbody",{children:[(0,u.jsxs)("tr",{children:[(0,u.jsx)("td",{children:"Name"}),(0,u.jsxs)("td",{children:[O.first_name," ",O.last_name]}),(0,u.jsxs)("td",{children:[D.first_name," ",D.last_name]}),(0,u.jsx)("td",{children:(0,u.jsxs)("div",{style:{display:"flex",flexDirection:"column",gap:"4px"},children:[(0,u.jsxs)(_,{children:[(0,u.jsx)(S,{type:"radio",name:"merge_name",value:"primary",checked:"primary"===N.first_name&&"primary"===N.last_name,onChange:()=>{G("first_name","primary"),G("last_name","primary")}}),(0,u.jsx)("span",{children:"Primary"})]}),(0,u.jsxs)(_,{children:[(0,u.jsx)(S,{type:"radio",name:"merge_name",value:"duplicate",checked:"duplicate"===N.first_name&&"duplicate"===N.last_name,onChange:()=>{G("first_name","duplicate"),G("last_name","duplicate")}}),(0,u.jsx)("span",{children:"Duplicate"})]})]})})]}),(0,u.jsxs)("tr",{children:[(0,u.jsx)("td",{children:"Category"}),(0,u.jsx)("td",{children:O.category||"-"}),(0,u.jsx)("td",{children:D.category||"-"}),(0,u.jsx)("td",{children:(0,u.jsxs)("div",{style:{display:"flex",flexDirection:"column",gap:"4px"},children:[(0,u.jsxs)(_,{children:[(0,u.jsx)(S,{type:"radio",name:"merge_category",value:"primary",checked:"primary"===N.category,onChange:()=>G("category","primary")}),(0,u.jsx)("span",{children:"Primary"})]}),(0,u.jsxs)(_,{children:[(0,u.jsx)(S,{type:"radio",name:"merge_category",value:"duplicate",checked:"duplicate"===N.category,onChange:()=>G("category","duplicate")}),(0,u.jsx)("span",{children:"Duplicate"})]})]})})]}),(0,u.jsxs)("tr",{children:[(0,u.jsx)("td",{children:"Job Role"}),(0,u.jsx)("td",{children:O.job_role||"-"}),(0,u.jsx)("td",{children:D.job_role||"-"}),(0,u.jsx)("td",{children:(0,u.jsxs)("div",{style:{display:"flex",flexDirection:"column",gap:"4px"},children:[(0,u.jsxs)(_,{children:[(0,u.jsx)(S,{type:"radio",name:"merge_job_role",value:"primary",checked:"primary"===N.job_role,onChange:()=>G("job_role","primary")}),(0,u.jsx)("span",{children:"Primary"})]}),(0,u.jsxs)(_,{children:[(0,u.jsx)(S,{type:"radio",name:"merge_job_role",value:"duplicate",checked:"duplicate"===N.job_role,onChange:()=>G("job_role","duplicate")}),(0,u.jsx)("span",{children:"Duplicate"})]})]})})]}),(0,u.jsxs)("tr",{children:[(0,u.jsx)("td",{children:"Emails"}),(0,u.jsx)("td",{children:O.emails.map((e=>e.email)).join(", ")||"-"}),(0,u.jsx)("td",{children:D.emails.map((e=>e.email)).join(", ")||"-"}),(0,u.jsx)("td",{children:(0,u.jsxs)("div",{style:{display:"flex",flexDirection:"column",gap:"4px"},children:[(0,u.jsxs)(_,{children:[(0,u.jsx)(S,{type:"radio",name:"merge_emails",value:"primary",checked:"primary"===N.emails,onChange:()=>G("emails","primary")}),(0,u.jsx)("span",{children:"Primary"})]}),(0,u.jsxs)(_,{children:[(0,u.jsx)(S,{type:"radio",name:"merge_emails",value:"duplicate",checked:"duplicate"===N.emails,onChange:()=>G("emails","duplicate")}),(0,u.jsx)("span",{children:"Duplicate"})]}),(0,u.jsxs)(_,{children:[(0,u.jsx)(S,{type:"radio",name:"merge_emails",value:"combine",checked:"combine"===N.emails,onChange:()=>G("emails","combine")}),(0,u.jsx)("span",{children:"Combine"})]})]})})]}),(0,u.jsxs)("tr",{children:[(0,u.jsx)("td",{children:"Mobiles"}),(0,u.jsx)("td",{children:O.mobiles.map((e=>e.mobile)).join(", ")||"-"}),(0,u.jsx)("td",{children:D.mobiles.map((e=>e.mobile)).join(", ")||"-"}),(0,u.jsx)("td",{children:(0,u.jsxs)("div",{style:{display:"flex",flexDirection:"column",gap:"4px"},children:[(0,u.jsxs)(_,{children:[(0,u.jsx)(S,{type:"radio",name:"merge_mobiles",value:"primary",checked:"primary"===N.mobiles,onChange:()=>G("mobiles","primary")}),(0,u.jsx)("span",{children:"Primary"})]}),(0,u.jsxs)(_,{children:[(0,u.jsx)(S,{type:"radio",name:"merge_mobiles",value:"duplicate",checked:"duplicate"===N.mobiles,onChange:()=>G("mobiles","duplicate")}),(0,u.jsx)("span",{children:"Duplicate"})]}),(0,u.jsxs)(_,{children:[(0,u.jsx)(S,{type:"radio",name:"merge_mobiles",value:"combine",checked:"combine"===N.mobiles,onChange:()=>G("mobiles","combine")}),(0,u.jsx)("span",{children:"Combine"})]})]})})]}),(0,u.jsxs)("tr",{children:[(0,u.jsx)("td",{children:"Tags"}),(0,u.jsx)("td",{children:O.tags.length>0?O.tags.map((e=>e.name)).join(", "):"-"}),(0,u.jsx)("td",{children:D.tags.length>0?D.tags.map((e=>e.name)).join(", "):"-"}),(0,u.jsx)("td",{children:(0,u.jsxs)("div",{style:{display:"flex",flexDirection:"column",gap:"4px"},children:[(0,u.jsxs)(_,{children:[(0,u.jsx)(S,{type:"radio",name:"merge_tags",value:"primary",checked:"primary"===N.tags,onChange:()=>G("tags","primary")}),(0,u.jsx)("span",{children:"Primary"})]}),(0,u.jsxs)(_,{children:[(0,u.jsx)(S,{type:"radio",name:"merge_tags",value:"duplicate",checked:"duplicate"===N.tags,onChange:()=>G("tags","duplicate")}),(0,u.jsx)("span",{children:"Duplicate"})]}),(0,u.jsxs)(_,{children:[(0,u.jsx)(S,{type:"radio",name:"merge_tags",value:"combine",checked:"combine"===N.tags,onChange:()=>G("tags","combine")}),(0,u.jsx)("span",{children:"Combine"})]})]})})]}),(0,u.jsxs)("tr",{children:[(0,u.jsx)("td",{children:"LinkedIn"}),(0,u.jsx)("td",{children:O.linkedin?O.linkedin.length>30?O.linkedin.substring(0,30)+"...":O.linkedin:"-"}),(0,u.jsx)("td",{children:D.linkedin?D.linkedin.length>30?D.linkedin.substring(0,30)+"...":D.linkedin:"-"}),(0,u.jsx)("td",{children:(0,u.jsxs)("div",{style:{display:"flex",flexDirection:"column",gap:"4px"},children:[(0,u.jsxs)(_,{children:[(0,u.jsx)(S,{type:"radio",name:"merge_linkedin",value:"primary",checked:"primary"===N.linkedin,onChange:()=>G("linkedin","primary")}),(0,u.jsx)("span",{children:"Primary"})]}),(0,u.jsxs)(_,{children:[(0,u.jsx)(S,{type:"radio",name:"merge_linkedin",value:"duplicate",checked:"duplicate"===N.linkedin,onChange:()=>G("linkedin","duplicate")}),(0,u.jsx)("span",{children:"Duplicate"})]})]})})]}),(0,u.jsxs)("tr",{children:[(0,u.jsx)("td",{children:"Score"}),(0,u.jsx)("td",{children:null!==O.score?O.score:"-"}),(0,u.jsx)("td",{children:null!==D.score?D.score:"-"}),(0,u.jsx)("td",{children:(0,u.jsxs)("div",{style:{display:"flex",flexDirection:"column",gap:"4px"},children:[(0,u.jsxs)(_,{children:[(0,u.jsx)(S,{type:"radio",name:"merge_score",value:"primary",checked:"primary"===N.score,onChange:()=>G("score","primary")}),(0,u.jsx)("span",{children:"Primary"})]}),(0,u.jsxs)(_,{children:[(0,u.jsx)(S,{type:"radio",name:"merge_score",value:"duplicate",checked:"duplicate"===N.score,onChange:()=>G("score","duplicate")}),(0,u.jsx)("span",{children:"Duplicate"})]})]})})]}),(0,u.jsxs)("tr",{children:[(0,u.jsx)("td",{children:"Keep In Touch Frequency"}),(0,u.jsx)("td",{children:O.keep_in_touch_frequency||"-"}),(0,u.jsx)("td",{children:D.keep_in_touch_frequency||"-"}),(0,u.jsx)("td",{children:(0,u.jsxs)("div",{style:{display:"flex",flexDirection:"column",gap:"4px"},children:[(0,u.jsxs)(_,{children:[(0,u.jsx)(S,{type:"radio",name:"merge_keep_in_touch_frequency",value:"primary",checked:"primary"===N.keep_in_touch_frequency,onChange:()=>G("keep_in_touch_frequency","primary")}),(0,u.jsx)("span",{children:"Primary"})]}),(0,u.jsxs)(_,{children:[(0,u.jsx)(S,{type:"radio",name:"merge_keep_in_touch_frequency",value:"duplicate",checked:"duplicate"===N.keep_in_touch_frequency,onChange:()=>G("keep_in_touch_frequency","duplicate")}),(0,u.jsx)("span",{children:"Duplicate"})]})]})})]})]})]})]}),(0,u.jsxs)(y,{children:[(0,u.jsxs)(x,{onClick:z,disabled:k,children:[(0,u.jsx)(d.yGN,{})," Cancel"]}),(0,u.jsxs)(x,{onClick:()=>{O&&D&&(sessionStorage.setItem("workflow_contact_id",r),N.first_name,N.last_name,window.location.href=`/contacts/workflow/${r}`)},disabled:k,style:{marginRight:"auto",color:"#00aaff",borderColor:"#00aaff"},children:[(0,u.jsx)(d.HaR,{})," Edit and Match"]}),(0,u.jsxs)(b,{onClick:async()=>{if(O&&D){j(!0);try{var e,t,o,n,a,d,u,p;const h={contact:D,emails:D.emails||[],mobiles:D.mobiles||[],tags:D.tags||[],cities:D.cities||[],companies:D.companies||[]},f=(null===(e=D.mobiles)||void 0===e||null===(t=e.find((e=>e.is_primary)))||void 0===t?void 0:t.mobile)||(null===(o=D.mobiles)||void 0===o||null===(n=o[0])||void 0===n?void 0:n.mobile)||"",g=(null===(a=D.emails)||void 0===a||null===(d=a.find((e=>e.is_primary)))||void 0===d?void 0:d.email)||(null===(u=D.emails)||void 0===u||null===(p=u[0])||void 0===p?void 0:p.email)||"",{data:m,error:y}=await s.supabase.from("contact_duplicates").select("duplicate_id, status").eq("primary_contact_id",r).eq("duplicate_contact_id",i).maybeSingle();if(y)throw y;let b;if(m){const{data:e,error:t}=await s.supabase.from("contact_duplicates").update({status:"pending",notes:"Manually merged via Duplicate Processing Modal",merge_selections:N,duplicate_data:h,start_trigger:!0,detected_at:(new Date).toISOString(),resolved_at:null,error_message:null}).eq("duplicate_id",m.duplicate_id).select().single();if(t)throw t;b=e,l.Ay.success("Updated existing merge settings. The system will process it shortly.")}else{const{data:e,error:t}=await s.supabase.from("contact_duplicates").insert({duplicate_id:(0,c.A)(),primary_contact_id:r,duplicate_contact_id:i,mobile_number:f,email:g,detected_at:(new Date).toISOString(),status:"pending",notes:"Manually merged via Duplicate Processing Modal",merge_selections:N,duplicate_data:h,start_trigger:!0}).select().single();if(t)throw t;b=e,l.Ay.success("Merge request submitted. The system will process it shortly.")}if(!b)throw new Error("Failed to create or update merge record");const x=async function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;if(t>=5)return console.log("Maximum status check attempts reached"),l.Ay.success("Merge process initiated! Changes will take effect shortly."),v&&v("merged",r),void z();try{await new Promise((e=>setTimeout(e,2e3))),console.log(`Checking merge status (attempt ${t+1}/5)...`);const{data:o,error:n}=await s.supabase.from("contact_duplicates").select("status, error_message").eq("duplicate_id",e).single();if(n)return console.error("Error checking merge status:",n),void(t>=2?(l.Ay.success("Merge process initiated! Changes will take effect shortly."),v&&v("merged",r),z()):setTimeout((()=>x(e,t+1)),2e3));if(!o)return console.warn("No status data returned"),void(t>=2?(l.Ay.success("Merge process initiated! Changes will take effect shortly."),v&&v("merged",r),z()):setTimeout((()=>x(e,t+1)),2e3));console.log("Merge status:",o.status),"completed"===o.status?(l.Ay.success("Contacts successfully merged!"),v&&v("merged",r),z()):"failed"===o.status?(l.Ay.error(`Merge failed: ${o.error_message||"Unknown error"}`),j(!1)):["pending","processing"].includes(o.status)?setTimeout((()=>x(e,t+1)),2e3):t>=2?(l.Ay.success("Merge process initiated! Changes will take effect shortly."),v&&v("merged",r),z()):setTimeout((()=>x(e,t+1)),2e3)}catch(o){console.error("Error in checkMergeStatus:",o),t>=2?(l.Ay.success("Merge process initiated! Changes will take effect shortly."),v&&v("merged",r),z()):setTimeout((()=>x(e,t+1)),2e3)}};x(b.duplicate_id)}catch(h){console.error("Error initiating merge:",h),l.Ay.error("Failed to initiate merge: "+(h.message||"Unknown error")),j(!1)}}},disabled:k,children:[(0,u.jsx)(d.EPw,{})," ",k?"Merging...":"Merge Contacts"]})]})]})]})}},2511:function(e,t,o){"use strict";var n=this&&this.__createBinding||(Object.create?function(e,t,o,n){void 0===n&&(n=o),Object.defineProperty(e,n,{enumerable:!0,get:function(){return t[o]}})}:function(e,t,o,n){void 0===n&&(n=o),e[n]=t[o]}),r=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),i=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var o in e)"default"!==o&&Object.prototype.hasOwnProperty.call(e,o)&&n(t,e,o);return r(t,e),t},a=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var s=i(o(5043)),l=o(9201),c=o(7079),d=o(8242),u=a(o(9352)),p=o(9724);t.default=s.memo((function(){var e=s.useState(new d.CssClasses),t=e[0],o=e[1],n=s.useState(),r=n[0],i=n[1],a=s.useContext(l.BeansContext).context,h=s.useRef(null);p.useLayoutEffectOnce((function(){var e={addOrRemoveCssClass:function(e,t){return o((function(o){return o.setClass(e,t)}))},setHeightAndMinHeight:function(e){return i(e)}},t=a.createBean(new c.GridHeaderCtrl);return t.setComp(e,h.current,h.current),function(){a.destroyBean(t)}}));var f=s.useMemo((function(){return"ag-header "+t.toString()}),[t]),g=s.useMemo((function(){return{height:r,minHeight:r}}),[r]);return s.default.createElement("div",{ref:h,className:f,style:g,role:"presentation"},s.default.createElement(u.default,{pinned:"left"}),s.default.createElement(u.default,{pinned:null}),s.default.createElement(u.default,{pinned:"right"}))}))},2611:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});class o extends Error{constructor(e){super(e.message),this.name="PostgrestError",this.details=e.details,this.hint=e.hint,this.code=e.code}}t.default=o},2678:function(e,t){"use strict";var o=this&&this.__spreadArrays||function(){for(var e=0,t=0,o=arguments.length;t<o;t++)e+=arguments[t].length;var n=Array(e),r=0;for(t=0;t<o;t++)for(var i=arguments[t],a=0,s=i.length;a<s;a++,r++)n[r]=i[a];return n};Object.defineProperty(t,"__esModule",{value:!0}),t.PortalManager=void 0;var n=function(){function e(t,o,n){this.destroyed=!1,this.portals=[],this.hasPendingPortalUpdate=!1,this.wrappingElement=o||"div",this.parent=t,this.maxComponentCreationTimeMs=n||e.MAX_COMPONENT_CREATION_TIME_IN_MS}return e.prototype.getPortals=function(){return this.portals},e.prototype.destroy=function(){this.destroyed=!0},e.prototype.destroyPortal=function(e){this.portals=this.portals.filter((function(t){return t!==e})),this.batchUpdate()},e.prototype.getComponentWrappingElement=function(){return this.wrappingElement},e.prototype.mountReactPortal=function(e,t,n){this.portals=o(this.portals,[e]),this.waitForInstance(t,n),this.batchUpdate()},e.prototype.updateReactPortal=function(e,t){this.portals[this.portals.indexOf(e)]=t,this.batchUpdate()},e.prototype.batchUpdate=function(){var e=this;this.hasPendingPortalUpdate||(setTimeout((function(){e.destroyed||e.parent.forceUpdate((function(){e.hasPendingPortalUpdate=!1}))})),this.hasPendingPortalUpdate=!0)},e.prototype.waitForInstance=function(e,t,o){var n=this;if(void 0===o&&(o=Date.now()),this.destroyed)t(null);else if(e.rendered())t(e);else{if(Date.now()-o>=this.maxComponentCreationTimeMs&&!this.hasPendingPortalUpdate)return e.isNullValue()?void t(e):void console.error("AG Grid: React Component '"+e.getReactComponentName()+"' not created within "+this.maxComponentCreationTimeMs+"ms");window.setTimeout((function(){n.waitForInstance(e,t,o)}))}},e.MAX_COMPONENT_CREATION_TIME_IN_MS=1e3,e}();t.PortalManager=n},2730:(e,t,o)=>{"use strict";var n=o(5043),r=o(8853);function i(e){for(var t="https://reactjs.org/docs/error-decoder.html?invariant="+e,o=1;o<arguments.length;o++)t+="&args[]="+encodeURIComponent(arguments[o]);return"Minified React error #"+e+"; visit "+t+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var a=new Set,s={};function l(e,t){c(e,t),c(e+"Capture",t)}function c(e,t){for(s[e]=t,e=0;e<t.length;e++)a.add(t[e])}var d=!("undefined"===typeof window||"undefined"===typeof window.document||"undefined"===typeof window.document.createElement),u=Object.prototype.hasOwnProperty,p=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,h={},f={};function g(e,t,o,n,r,i,a){this.acceptsBooleans=2===t||3===t||4===t,this.attributeName=n,this.attributeNamespace=r,this.mustUseProperty=o,this.propertyName=e,this.type=t,this.sanitizeURL=i,this.removeEmptyString=a}var m={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach((function(e){m[e]=new g(e,0,!1,e,null,!1,!1)})),[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach((function(e){var t=e[0];m[t]=new g(t,1,!1,e[1],null,!1,!1)})),["contentEditable","draggable","spellCheck","value"].forEach((function(e){m[e]=new g(e,2,!1,e.toLowerCase(),null,!1,!1)})),["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach((function(e){m[e]=new g(e,2,!1,e,null,!1,!1)})),"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach((function(e){m[e]=new g(e,3,!1,e.toLowerCase(),null,!1,!1)})),["checked","multiple","muted","selected"].forEach((function(e){m[e]=new g(e,3,!0,e,null,!1,!1)})),["capture","download"].forEach((function(e){m[e]=new g(e,4,!1,e,null,!1,!1)})),["cols","rows","size","span"].forEach((function(e){m[e]=new g(e,6,!1,e,null,!1,!1)})),["rowSpan","start"].forEach((function(e){m[e]=new g(e,5,!1,e.toLowerCase(),null,!1,!1)}));var y=/[\-:]([a-z])/g;function v(e){return e[1].toUpperCase()}function b(e,t,o,n){var r=m.hasOwnProperty(t)?m[t]:null;(null!==r?0!==r.type:n||!(2<t.length)||"o"!==t[0]&&"O"!==t[0]||"n"!==t[1]&&"N"!==t[1])&&(function(e,t,o,n){if(null===t||"undefined"===typeof t||function(e,t,o,n){if(null!==o&&0===o.type)return!1;switch(typeof t){case"function":case"symbol":return!0;case"boolean":return!n&&(null!==o?!o.acceptsBooleans:"data-"!==(e=e.toLowerCase().slice(0,5))&&"aria-"!==e);default:return!1}}(e,t,o,n))return!0;if(n)return!1;if(null!==o)switch(o.type){case 3:return!t;case 4:return!1===t;case 5:return isNaN(t);case 6:return isNaN(t)||1>t}return!1}(t,o,r,n)&&(o=null),n||null===r?function(e){return!!u.call(f,e)||!u.call(h,e)&&(p.test(e)?f[e]=!0:(h[e]=!0,!1))}(t)&&(null===o?e.removeAttribute(t):e.setAttribute(t,""+o)):r.mustUseProperty?e[r.propertyName]=null===o?3!==r.type&&"":o:(t=r.attributeName,n=r.attributeNamespace,null===o?e.removeAttribute(t):(o=3===(r=r.type)||4===r&&!0===o?"":""+o,n?e.setAttributeNS(n,t,o):e.setAttribute(t,o))))}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach((function(e){var t=e.replace(y,v);m[t]=new g(t,1,!1,e,null,!1,!1)})),"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach((function(e){var t=e.replace(y,v);m[t]=new g(t,1,!1,e,"http://www.w3.org/1999/xlink",!1,!1)})),["xml:base","xml:lang","xml:space"].forEach((function(e){var t=e.replace(y,v);m[t]=new g(t,1,!1,e,"http://www.w3.org/XML/1998/namespace",!1,!1)})),["tabIndex","crossOrigin"].forEach((function(e){m[e]=new g(e,1,!1,e.toLowerCase(),null,!1,!1)})),m.xlinkHref=new g("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1),["src","href","action","formAction"].forEach((function(e){m[e]=new g(e,1,!1,e.toLowerCase(),null,!0,!0)}));var x=n.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,w=Symbol.for("react.element"),C=Symbol.for("react.portal"),_=Symbol.for("react.fragment"),S=Symbol.for("react.strict_mode"),E=Symbol.for("react.profiler"),k=Symbol.for("react.provider"),j=Symbol.for("react.context"),A=Symbol.for("react.forward_ref"),R=Symbol.for("react.suspense"),O=Symbol.for("react.suspense_list"),T=Symbol.for("react.memo"),D=Symbol.for("react.lazy");Symbol.for("react.scope"),Symbol.for("react.debug_trace_mode");var P=Symbol.for("react.offscreen");Symbol.for("react.legacy_hidden"),Symbol.for("react.cache"),Symbol.for("react.tracing_marker");var N=Symbol.iterator;function I(e){return null===e||"object"!==typeof e?null:"function"===typeof(e=N&&e[N]||e["@@iterator"])?e:null}var M,L=Object.assign;function F(e){if(void 0===M)try{throw Error()}catch(o){var t=o.stack.trim().match(/\n( *(at )?)/);M=t&&t[1]||""}return"\n"+M+e}var G=!1;function z(e,t){if(!e||G)return"";G=!0;var o=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(t)if(t=function(){throw Error()},Object.defineProperty(t.prototype,"props",{set:function(){throw Error()}}),"object"===typeof Reflect&&Reflect.construct){try{Reflect.construct(t,[])}catch(c){var n=c}Reflect.construct(e,[],t)}else{try{t.call()}catch(c){n=c}e.call(t.prototype)}else{try{throw Error()}catch(c){n=c}e()}}catch(c){if(c&&n&&"string"===typeof c.stack){for(var r=c.stack.split("\n"),i=n.stack.split("\n"),a=r.length-1,s=i.length-1;1<=a&&0<=s&&r[a]!==i[s];)s--;for(;1<=a&&0<=s;a--,s--)if(r[a]!==i[s]){if(1!==a||1!==s)do{if(a--,0>--s||r[a]!==i[s]){var l="\n"+r[a].replace(" at new "," at ");return e.displayName&&l.includes("<anonymous>")&&(l=l.replace("<anonymous>",e.displayName)),l}}while(1<=a&&0<=s);break}}}finally{G=!1,Error.prepareStackTrace=o}return(e=e?e.displayName||e.name:"")?F(e):""}function H(e){switch(e.tag){case 5:return F(e.type);case 16:return F("Lazy");case 13:return F("Suspense");case 19:return F("SuspenseList");case 0:case 2:case 15:return e=z(e.type,!1);case 11:return e=z(e.type.render,!1);case 1:return e=z(e.type,!0);default:return""}}function B(e){if(null==e)return null;if("function"===typeof e)return e.displayName||e.name||null;if("string"===typeof e)return e;switch(e){case _:return"Fragment";case C:return"Portal";case E:return"Profiler";case S:return"StrictMode";case R:return"Suspense";case O:return"SuspenseList"}if("object"===typeof e)switch(e.$$typeof){case j:return(e.displayName||"Context")+".Consumer";case k:return(e._context.displayName||"Context")+".Provider";case A:var t=e.render;return(e=e.displayName)||(e=""!==(e=t.displayName||t.name||"")?"ForwardRef("+e+")":"ForwardRef"),e;case T:return null!==(t=e.displayName||null)?t:B(e.type)||"Memo";case D:t=e._payload,e=e._init;try{return B(e(t))}catch(o){}}return null}function V(e){var t=e.type;switch(e.tag){case 24:return"Cache";case 9:return(t.displayName||"Context")+".Consumer";case 10:return(t._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return e=(e=t.render).displayName||e.name||"",t.displayName||(""!==e?"ForwardRef("+e+")":"ForwardRef");case 7:return"Fragment";case 5:return t;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return B(t);case 8:return t===S?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if("function"===typeof t)return t.displayName||t.name||null;if("string"===typeof t)return t}return null}function $(e){switch(typeof e){case"boolean":case"number":case"string":case"undefined":case"object":return e;default:return""}}function U(e){var t=e.type;return(e=e.nodeName)&&"input"===e.toLowerCase()&&("checkbox"===t||"radio"===t)}function W(e){e._valueTracker||(e._valueTracker=function(e){var t=U(e)?"checked":"value",o=Object.getOwnPropertyDescriptor(e.constructor.prototype,t),n=""+e[t];if(!e.hasOwnProperty(t)&&"undefined"!==typeof o&&"function"===typeof o.get&&"function"===typeof o.set){var r=o.get,i=o.set;return Object.defineProperty(e,t,{configurable:!0,get:function(){return r.call(this)},set:function(e){n=""+e,i.call(this,e)}}),Object.defineProperty(e,t,{enumerable:o.enumerable}),{getValue:function(){return n},setValue:function(e){n=""+e},stopTracking:function(){e._valueTracker=null,delete e[t]}}}}(e))}function q(e){if(!e)return!1;var t=e._valueTracker;if(!t)return!0;var o=t.getValue(),n="";return e&&(n=U(e)?e.checked?"true":"false":e.value),(e=n)!==o&&(t.setValue(e),!0)}function K(e){if("undefined"===typeof(e=e||("undefined"!==typeof document?document:void 0)))return null;try{return e.activeElement||e.body}catch(t){return e.body}}function Y(e,t){var o=t.checked;return L({},t,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:null!=o?o:e._wrapperState.initialChecked})}function J(e,t){var o=null==t.defaultValue?"":t.defaultValue,n=null!=t.checked?t.checked:t.defaultChecked;o=$(null!=t.value?t.value:o),e._wrapperState={initialChecked:n,initialValue:o,controlled:"checkbox"===t.type||"radio"===t.type?null!=t.checked:null!=t.value}}function X(e,t){null!=(t=t.checked)&&b(e,"checked",t,!1)}function Q(e,t){X(e,t);var o=$(t.value),n=t.type;if(null!=o)"number"===n?(0===o&&""===e.value||e.value!=o)&&(e.value=""+o):e.value!==""+o&&(e.value=""+o);else if("submit"===n||"reset"===n)return void e.removeAttribute("value");t.hasOwnProperty("value")?ee(e,t.type,o):t.hasOwnProperty("defaultValue")&&ee(e,t.type,$(t.defaultValue)),null==t.checked&&null!=t.defaultChecked&&(e.defaultChecked=!!t.defaultChecked)}function Z(e,t,o){if(t.hasOwnProperty("value")||t.hasOwnProperty("defaultValue")){var n=t.type;if(!("submit"!==n&&"reset"!==n||void 0!==t.value&&null!==t.value))return;t=""+e._wrapperState.initialValue,o||t===e.value||(e.value=t),e.defaultValue=t}""!==(o=e.name)&&(e.name=""),e.defaultChecked=!!e._wrapperState.initialChecked,""!==o&&(e.name=o)}function ee(e,t,o){"number"===t&&K(e.ownerDocument)===e||(null==o?e.defaultValue=""+e._wrapperState.initialValue:e.defaultValue!==""+o&&(e.defaultValue=""+o))}var te=Array.isArray;function oe(e,t,o,n){if(e=e.options,t){t={};for(var r=0;r<o.length;r++)t["$"+o[r]]=!0;for(o=0;o<e.length;o++)r=t.hasOwnProperty("$"+e[o].value),e[o].selected!==r&&(e[o].selected=r),r&&n&&(e[o].defaultSelected=!0)}else{for(o=""+$(o),t=null,r=0;r<e.length;r++){if(e[r].value===o)return e[r].selected=!0,void(n&&(e[r].defaultSelected=!0));null!==t||e[r].disabled||(t=e[r])}null!==t&&(t.selected=!0)}}function ne(e,t){if(null!=t.dangerouslySetInnerHTML)throw Error(i(91));return L({},t,{value:void 0,defaultValue:void 0,children:""+e._wrapperState.initialValue})}function re(e,t){var o=t.value;if(null==o){if(o=t.children,t=t.defaultValue,null!=o){if(null!=t)throw Error(i(92));if(te(o)){if(1<o.length)throw Error(i(93));o=o[0]}t=o}null==t&&(t=""),o=t}e._wrapperState={initialValue:$(o)}}function ie(e,t){var o=$(t.value),n=$(t.defaultValue);null!=o&&((o=""+o)!==e.value&&(e.value=o),null==t.defaultValue&&e.defaultValue!==o&&(e.defaultValue=o)),null!=n&&(e.defaultValue=""+n)}function ae(e){var t=e.textContent;t===e._wrapperState.initialValue&&""!==t&&null!==t&&(e.value=t)}function se(e){switch(e){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function le(e,t){return null==e||"http://www.w3.org/1999/xhtml"===e?se(t):"http://www.w3.org/2000/svg"===e&&"foreignObject"===t?"http://www.w3.org/1999/xhtml":e}var ce,de,ue=(de=function(e,t){if("http://www.w3.org/2000/svg"!==e.namespaceURI||"innerHTML"in e)e.innerHTML=t;else{for((ce=ce||document.createElement("div")).innerHTML="<svg>"+t.valueOf().toString()+"</svg>",t=ce.firstChild;e.firstChild;)e.removeChild(e.firstChild);for(;t.firstChild;)e.appendChild(t.firstChild)}},"undefined"!==typeof MSApp&&MSApp.execUnsafeLocalFunction?function(e,t,o,n){MSApp.execUnsafeLocalFunction((function(){return de(e,t)}))}:de);function pe(e,t){if(t){var o=e.firstChild;if(o&&o===e.lastChild&&3===o.nodeType)return void(o.nodeValue=t)}e.textContent=t}var he={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},fe=["Webkit","ms","Moz","O"];function ge(e,t,o){return null==t||"boolean"===typeof t||""===t?"":o||"number"!==typeof t||0===t||he.hasOwnProperty(e)&&he[e]?(""+t).trim():t+"px"}function me(e,t){for(var o in e=e.style,t)if(t.hasOwnProperty(o)){var n=0===o.indexOf("--"),r=ge(o,t[o],n);"float"===o&&(o="cssFloat"),n?e.setProperty(o,r):e[o]=r}}Object.keys(he).forEach((function(e){fe.forEach((function(t){t=t+e.charAt(0).toUpperCase()+e.substring(1),he[t]=he[e]}))}));var ye=L({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function ve(e,t){if(t){if(ye[e]&&(null!=t.children||null!=t.dangerouslySetInnerHTML))throw Error(i(137,e));if(null!=t.dangerouslySetInnerHTML){if(null!=t.children)throw Error(i(60));if("object"!==typeof t.dangerouslySetInnerHTML||!("__html"in t.dangerouslySetInnerHTML))throw Error(i(61))}if(null!=t.style&&"object"!==typeof t.style)throw Error(i(62))}}function be(e,t){if(-1===e.indexOf("-"))return"string"===typeof t.is;switch(e){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var xe=null;function we(e){return(e=e.target||e.srcElement||window).correspondingUseElement&&(e=e.correspondingUseElement),3===e.nodeType?e.parentNode:e}var Ce=null,_e=null,Se=null;function Ee(e){if(e=xr(e)){if("function"!==typeof Ce)throw Error(i(280));var t=e.stateNode;t&&(t=Cr(t),Ce(e.stateNode,e.type,t))}}function ke(e){_e?Se?Se.push(e):Se=[e]:_e=e}function je(){if(_e){var e=_e,t=Se;if(Se=_e=null,Ee(e),t)for(e=0;e<t.length;e++)Ee(t[e])}}function Ae(e,t){return e(t)}function Re(){}var Oe=!1;function Te(e,t,o){if(Oe)return e(t,o);Oe=!0;try{return Ae(e,t,o)}finally{Oe=!1,(null!==_e||null!==Se)&&(Re(),je())}}function De(e,t){var o=e.stateNode;if(null===o)return null;var n=Cr(o);if(null===n)return null;o=n[t];e:switch(t){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(n=!n.disabled)||(n=!("button"===(e=e.type)||"input"===e||"select"===e||"textarea"===e)),e=!n;break e;default:e=!1}if(e)return null;if(o&&"function"!==typeof o)throw Error(i(231,t,typeof o));return o}var Pe=!1;if(d)try{var Ne={};Object.defineProperty(Ne,"passive",{get:function(){Pe=!0}}),window.addEventListener("test",Ne,Ne),window.removeEventListener("test",Ne,Ne)}catch(de){Pe=!1}function Ie(e,t,o,n,r,i,a,s,l){var c=Array.prototype.slice.call(arguments,3);try{t.apply(o,c)}catch(d){this.onError(d)}}var Me=!1,Le=null,Fe=!1,Ge=null,ze={onError:function(e){Me=!0,Le=e}};function He(e,t,o,n,r,i,a,s,l){Me=!1,Le=null,Ie.apply(ze,arguments)}function Be(e){var t=e,o=e;if(e.alternate)for(;t.return;)t=t.return;else{e=t;do{0!==(4098&(t=e).flags)&&(o=t.return),e=t.return}while(e)}return 3===t.tag?o:null}function Ve(e){if(13===e.tag){var t=e.memoizedState;if(null===t&&(null!==(e=e.alternate)&&(t=e.memoizedState)),null!==t)return t.dehydrated}return null}function $e(e){if(Be(e)!==e)throw Error(i(188))}function Ue(e){return null!==(e=function(e){var t=e.alternate;if(!t){if(null===(t=Be(e)))throw Error(i(188));return t!==e?null:e}for(var o=e,n=t;;){var r=o.return;if(null===r)break;var a=r.alternate;if(null===a){if(null!==(n=r.return)){o=n;continue}break}if(r.child===a.child){for(a=r.child;a;){if(a===o)return $e(r),e;if(a===n)return $e(r),t;a=a.sibling}throw Error(i(188))}if(o.return!==n.return)o=r,n=a;else{for(var s=!1,l=r.child;l;){if(l===o){s=!0,o=r,n=a;break}if(l===n){s=!0,n=r,o=a;break}l=l.sibling}if(!s){for(l=a.child;l;){if(l===o){s=!0,o=a,n=r;break}if(l===n){s=!0,n=a,o=r;break}l=l.sibling}if(!s)throw Error(i(189))}}if(o.alternate!==n)throw Error(i(190))}if(3!==o.tag)throw Error(i(188));return o.stateNode.current===o?e:t}(e))?We(e):null}function We(e){if(5===e.tag||6===e.tag)return e;for(e=e.child;null!==e;){var t=We(e);if(null!==t)return t;e=e.sibling}return null}var qe=r.unstable_scheduleCallback,Ke=r.unstable_cancelCallback,Ye=r.unstable_shouldYield,Je=r.unstable_requestPaint,Xe=r.unstable_now,Qe=r.unstable_getCurrentPriorityLevel,Ze=r.unstable_ImmediatePriority,et=r.unstable_UserBlockingPriority,tt=r.unstable_NormalPriority,ot=r.unstable_LowPriority,nt=r.unstable_IdlePriority,rt=null,it=null;var at=Math.clz32?Math.clz32:function(e){return e>>>=0,0===e?32:31-(st(e)/lt|0)|0},st=Math.log,lt=Math.LN2;var ct=64,dt=4194304;function ut(e){switch(e&-e){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return 4194240&e;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return 130023424&e;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return e}}function pt(e,t){var o=e.pendingLanes;if(0===o)return 0;var n=0,r=e.suspendedLanes,i=e.pingedLanes,a=268435455&o;if(0!==a){var s=a&~r;0!==s?n=ut(s):0!==(i&=a)&&(n=ut(i))}else 0!==(a=o&~r)?n=ut(a):0!==i&&(n=ut(i));if(0===n)return 0;if(0!==t&&t!==n&&0===(t&r)&&((r=n&-n)>=(i=t&-t)||16===r&&0!==(4194240&i)))return t;if(0!==(4&n)&&(n|=16&o),0!==(t=e.entangledLanes))for(e=e.entanglements,t&=n;0<t;)r=1<<(o=31-at(t)),n|=e[o],t&=~r;return n}function ht(e,t){switch(e){case 1:case 2:case 4:return t+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t+5e3;default:return-1}}function ft(e){return 0!==(e=-1073741825&e.pendingLanes)?e:1073741824&e?1073741824:0}function gt(){var e=ct;return 0===(4194240&(ct<<=1))&&(ct=64),e}function mt(e){for(var t=[],o=0;31>o;o++)t.push(e);return t}function yt(e,t,o){e.pendingLanes|=t,536870912!==t&&(e.suspendedLanes=0,e.pingedLanes=0),(e=e.eventTimes)[t=31-at(t)]=o}function vt(e,t){var o=e.entangledLanes|=t;for(e=e.entanglements;o;){var n=31-at(o),r=1<<n;r&t|e[n]&t&&(e[n]|=t),o&=~r}}var bt=0;function xt(e){return 1<(e&=-e)?4<e?0!==(268435455&e)?16:536870912:4:1}var wt,Ct,_t,St,Et,kt=!1,jt=[],At=null,Rt=null,Ot=null,Tt=new Map,Dt=new Map,Pt=[],Nt="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function It(e,t){switch(e){case"focusin":case"focusout":At=null;break;case"dragenter":case"dragleave":Rt=null;break;case"mouseover":case"mouseout":Ot=null;break;case"pointerover":case"pointerout":Tt.delete(t.pointerId);break;case"gotpointercapture":case"lostpointercapture":Dt.delete(t.pointerId)}}function Mt(e,t,o,n,r,i){return null===e||e.nativeEvent!==i?(e={blockedOn:t,domEventName:o,eventSystemFlags:n,nativeEvent:i,targetContainers:[r]},null!==t&&(null!==(t=xr(t))&&Ct(t)),e):(e.eventSystemFlags|=n,t=e.targetContainers,null!==r&&-1===t.indexOf(r)&&t.push(r),e)}function Lt(e){var t=br(e.target);if(null!==t){var o=Be(t);if(null!==o)if(13===(t=o.tag)){if(null!==(t=Ve(o)))return e.blockedOn=t,void Et(e.priority,(function(){_t(o)}))}else if(3===t&&o.stateNode.current.memoizedState.isDehydrated)return void(e.blockedOn=3===o.tag?o.stateNode.containerInfo:null)}e.blockedOn=null}function Ft(e){if(null!==e.blockedOn)return!1;for(var t=e.targetContainers;0<t.length;){var o=Yt(e.domEventName,e.eventSystemFlags,t[0],e.nativeEvent);if(null!==o)return null!==(t=xr(o))&&Ct(t),e.blockedOn=o,!1;var n=new(o=e.nativeEvent).constructor(o.type,o);xe=n,o.target.dispatchEvent(n),xe=null,t.shift()}return!0}function Gt(e,t,o){Ft(e)&&o.delete(t)}function zt(){kt=!1,null!==At&&Ft(At)&&(At=null),null!==Rt&&Ft(Rt)&&(Rt=null),null!==Ot&&Ft(Ot)&&(Ot=null),Tt.forEach(Gt),Dt.forEach(Gt)}function Ht(e,t){e.blockedOn===t&&(e.blockedOn=null,kt||(kt=!0,r.unstable_scheduleCallback(r.unstable_NormalPriority,zt)))}function Bt(e){function t(t){return Ht(t,e)}if(0<jt.length){Ht(jt[0],e);for(var o=1;o<jt.length;o++){var n=jt[o];n.blockedOn===e&&(n.blockedOn=null)}}for(null!==At&&Ht(At,e),null!==Rt&&Ht(Rt,e),null!==Ot&&Ht(Ot,e),Tt.forEach(t),Dt.forEach(t),o=0;o<Pt.length;o++)(n=Pt[o]).blockedOn===e&&(n.blockedOn=null);for(;0<Pt.length&&null===(o=Pt[0]).blockedOn;)Lt(o),null===o.blockedOn&&Pt.shift()}var Vt=x.ReactCurrentBatchConfig,$t=!0;function Ut(e,t,o,n){var r=bt,i=Vt.transition;Vt.transition=null;try{bt=1,qt(e,t,o,n)}finally{bt=r,Vt.transition=i}}function Wt(e,t,o,n){var r=bt,i=Vt.transition;Vt.transition=null;try{bt=4,qt(e,t,o,n)}finally{bt=r,Vt.transition=i}}function qt(e,t,o,n){if($t){var r=Yt(e,t,o,n);if(null===r)Un(e,t,n,Kt,o),It(e,n);else if(function(e,t,o,n,r){switch(t){case"focusin":return At=Mt(At,e,t,o,n,r),!0;case"dragenter":return Rt=Mt(Rt,e,t,o,n,r),!0;case"mouseover":return Ot=Mt(Ot,e,t,o,n,r),!0;case"pointerover":var i=r.pointerId;return Tt.set(i,Mt(Tt.get(i)||null,e,t,o,n,r)),!0;case"gotpointercapture":return i=r.pointerId,Dt.set(i,Mt(Dt.get(i)||null,e,t,o,n,r)),!0}return!1}(r,e,t,o,n))n.stopPropagation();else if(It(e,n),4&t&&-1<Nt.indexOf(e)){for(;null!==r;){var i=xr(r);if(null!==i&&wt(i),null===(i=Yt(e,t,o,n))&&Un(e,t,n,Kt,o),i===r)break;r=i}null!==r&&n.stopPropagation()}else Un(e,t,n,null,o)}}var Kt=null;function Yt(e,t,o,n){if(Kt=null,null!==(e=br(e=we(n))))if(null===(t=Be(e)))e=null;else if(13===(o=t.tag)){if(null!==(e=Ve(t)))return e;e=null}else if(3===o){if(t.stateNode.current.memoizedState.isDehydrated)return 3===t.tag?t.stateNode.containerInfo:null;e=null}else t!==e&&(e=null);return Kt=e,null}function Jt(e){switch(e){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(Qe()){case Ze:return 1;case et:return 4;case tt:case ot:return 16;case nt:return 536870912;default:return 16}default:return 16}}var Xt=null,Qt=null,Zt=null;function eo(){if(Zt)return Zt;var e,t,o=Qt,n=o.length,r="value"in Xt?Xt.value:Xt.textContent,i=r.length;for(e=0;e<n&&o[e]===r[e];e++);var a=n-e;for(t=1;t<=a&&o[n-t]===r[i-t];t++);return Zt=r.slice(e,1<t?1-t:void 0)}function to(e){var t=e.keyCode;return"charCode"in e?0===(e=e.charCode)&&13===t&&(e=13):e=t,10===e&&(e=13),32<=e||13===e?e:0}function oo(){return!0}function no(){return!1}function ro(e){function t(t,o,n,r,i){for(var a in this._reactName=t,this._targetInst=n,this.type=o,this.nativeEvent=r,this.target=i,this.currentTarget=null,e)e.hasOwnProperty(a)&&(t=e[a],this[a]=t?t(r):r[a]);return this.isDefaultPrevented=(null!=r.defaultPrevented?r.defaultPrevented:!1===r.returnValue)?oo:no,this.isPropagationStopped=no,this}return L(t.prototype,{preventDefault:function(){this.defaultPrevented=!0;var e=this.nativeEvent;e&&(e.preventDefault?e.preventDefault():"unknown"!==typeof e.returnValue&&(e.returnValue=!1),this.isDefaultPrevented=oo)},stopPropagation:function(){var e=this.nativeEvent;e&&(e.stopPropagation?e.stopPropagation():"unknown"!==typeof e.cancelBubble&&(e.cancelBubble=!0),this.isPropagationStopped=oo)},persist:function(){},isPersistent:oo}),t}var io,ao,so,lo={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(e){return e.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},co=ro(lo),uo=L({},lo,{view:0,detail:0}),po=ro(uo),ho=L({},uo,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:Eo,button:0,buttons:0,relatedTarget:function(e){return void 0===e.relatedTarget?e.fromElement===e.srcElement?e.toElement:e.fromElement:e.relatedTarget},movementX:function(e){return"movementX"in e?e.movementX:(e!==so&&(so&&"mousemove"===e.type?(io=e.screenX-so.screenX,ao=e.screenY-so.screenY):ao=io=0,so=e),io)},movementY:function(e){return"movementY"in e?e.movementY:ao}}),fo=ro(ho),go=ro(L({},ho,{dataTransfer:0})),mo=ro(L({},uo,{relatedTarget:0})),yo=ro(L({},lo,{animationName:0,elapsedTime:0,pseudoElement:0})),vo=L({},lo,{clipboardData:function(e){return"clipboardData"in e?e.clipboardData:window.clipboardData}}),bo=ro(vo),xo=ro(L({},lo,{data:0})),wo={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},Co={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},_o={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function So(e){var t=this.nativeEvent;return t.getModifierState?t.getModifierState(e):!!(e=_o[e])&&!!t[e]}function Eo(){return So}var ko=L({},uo,{key:function(e){if(e.key){var t=wo[e.key]||e.key;if("Unidentified"!==t)return t}return"keypress"===e.type?13===(e=to(e))?"Enter":String.fromCharCode(e):"keydown"===e.type||"keyup"===e.type?Co[e.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:Eo,charCode:function(e){return"keypress"===e.type?to(e):0},keyCode:function(e){return"keydown"===e.type||"keyup"===e.type?e.keyCode:0},which:function(e){return"keypress"===e.type?to(e):"keydown"===e.type||"keyup"===e.type?e.keyCode:0}}),jo=ro(ko),Ao=ro(L({},ho,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0})),Ro=ro(L({},uo,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:Eo})),Oo=ro(L({},lo,{propertyName:0,elapsedTime:0,pseudoElement:0})),To=L({},ho,{deltaX:function(e){return"deltaX"in e?e.deltaX:"wheelDeltaX"in e?-e.wheelDeltaX:0},deltaY:function(e){return"deltaY"in e?e.deltaY:"wheelDeltaY"in e?-e.wheelDeltaY:"wheelDelta"in e?-e.wheelDelta:0},deltaZ:0,deltaMode:0}),Do=ro(To),Po=[9,13,27,32],No=d&&"CompositionEvent"in window,Io=null;d&&"documentMode"in document&&(Io=document.documentMode);var Mo=d&&"TextEvent"in window&&!Io,Lo=d&&(!No||Io&&8<Io&&11>=Io),Fo=String.fromCharCode(32),Go=!1;function zo(e,t){switch(e){case"keyup":return-1!==Po.indexOf(t.keyCode);case"keydown":return 229!==t.keyCode;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function Ho(e){return"object"===typeof(e=e.detail)&&"data"in e?e.data:null}var Bo=!1;var Vo={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function $o(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return"input"===t?!!Vo[e.type]:"textarea"===t}function Uo(e,t,o,n){ke(n),0<(t=qn(t,"onChange")).length&&(o=new co("onChange","change",null,o,n),e.push({event:o,listeners:t}))}var Wo=null,qo=null;function Ko(e){Gn(e,0)}function Yo(e){if(q(wr(e)))return e}function Jo(e,t){if("change"===e)return t}var Xo=!1;if(d){var Qo;if(d){var Zo="oninput"in document;if(!Zo){var en=document.createElement("div");en.setAttribute("oninput","return;"),Zo="function"===typeof en.oninput}Qo=Zo}else Qo=!1;Xo=Qo&&(!document.documentMode||9<document.documentMode)}function tn(){Wo&&(Wo.detachEvent("onpropertychange",on),qo=Wo=null)}function on(e){if("value"===e.propertyName&&Yo(qo)){var t=[];Uo(t,qo,e,we(e)),Te(Ko,t)}}function nn(e,t,o){"focusin"===e?(tn(),qo=o,(Wo=t).attachEvent("onpropertychange",on)):"focusout"===e&&tn()}function rn(e){if("selectionchange"===e||"keyup"===e||"keydown"===e)return Yo(qo)}function an(e,t){if("click"===e)return Yo(t)}function sn(e,t){if("input"===e||"change"===e)return Yo(t)}var ln="function"===typeof Object.is?Object.is:function(e,t){return e===t&&(0!==e||1/e===1/t)||e!==e&&t!==t};function cn(e,t){if(ln(e,t))return!0;if("object"!==typeof e||null===e||"object"!==typeof t||null===t)return!1;var o=Object.keys(e),n=Object.keys(t);if(o.length!==n.length)return!1;for(n=0;n<o.length;n++){var r=o[n];if(!u.call(t,r)||!ln(e[r],t[r]))return!1}return!0}function dn(e){for(;e&&e.firstChild;)e=e.firstChild;return e}function un(e,t){var o,n=dn(e);for(e=0;n;){if(3===n.nodeType){if(o=e+n.textContent.length,e<=t&&o>=t)return{node:n,offset:t-e};e=o}e:{for(;n;){if(n.nextSibling){n=n.nextSibling;break e}n=n.parentNode}n=void 0}n=dn(n)}}function pn(e,t){return!(!e||!t)&&(e===t||(!e||3!==e.nodeType)&&(t&&3===t.nodeType?pn(e,t.parentNode):"contains"in e?e.contains(t):!!e.compareDocumentPosition&&!!(16&e.compareDocumentPosition(t))))}function hn(){for(var e=window,t=K();t instanceof e.HTMLIFrameElement;){try{var o="string"===typeof t.contentWindow.location.href}catch(n){o=!1}if(!o)break;t=K((e=t.contentWindow).document)}return t}function fn(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t&&("input"===t&&("text"===e.type||"search"===e.type||"tel"===e.type||"url"===e.type||"password"===e.type)||"textarea"===t||"true"===e.contentEditable)}function gn(e){var t=hn(),o=e.focusedElem,n=e.selectionRange;if(t!==o&&o&&o.ownerDocument&&pn(o.ownerDocument.documentElement,o)){if(null!==n&&fn(o))if(t=n.start,void 0===(e=n.end)&&(e=t),"selectionStart"in o)o.selectionStart=t,o.selectionEnd=Math.min(e,o.value.length);else if((e=(t=o.ownerDocument||document)&&t.defaultView||window).getSelection){e=e.getSelection();var r=o.textContent.length,i=Math.min(n.start,r);n=void 0===n.end?i:Math.min(n.end,r),!e.extend&&i>n&&(r=n,n=i,i=r),r=un(o,i);var a=un(o,n);r&&a&&(1!==e.rangeCount||e.anchorNode!==r.node||e.anchorOffset!==r.offset||e.focusNode!==a.node||e.focusOffset!==a.offset)&&((t=t.createRange()).setStart(r.node,r.offset),e.removeAllRanges(),i>n?(e.addRange(t),e.extend(a.node,a.offset)):(t.setEnd(a.node,a.offset),e.addRange(t)))}for(t=[],e=o;e=e.parentNode;)1===e.nodeType&&t.push({element:e,left:e.scrollLeft,top:e.scrollTop});for("function"===typeof o.focus&&o.focus(),o=0;o<t.length;o++)(e=t[o]).element.scrollLeft=e.left,e.element.scrollTop=e.top}}var mn=d&&"documentMode"in document&&11>=document.documentMode,yn=null,vn=null,bn=null,xn=!1;function wn(e,t,o){var n=o.window===o?o.document:9===o.nodeType?o:o.ownerDocument;xn||null==yn||yn!==K(n)||("selectionStart"in(n=yn)&&fn(n)?n={start:n.selectionStart,end:n.selectionEnd}:n={anchorNode:(n=(n.ownerDocument&&n.ownerDocument.defaultView||window).getSelection()).anchorNode,anchorOffset:n.anchorOffset,focusNode:n.focusNode,focusOffset:n.focusOffset},bn&&cn(bn,n)||(bn=n,0<(n=qn(vn,"onSelect")).length&&(t=new co("onSelect","select",null,t,o),e.push({event:t,listeners:n}),t.target=yn)))}function Cn(e,t){var o={};return o[e.toLowerCase()]=t.toLowerCase(),o["Webkit"+e]="webkit"+t,o["Moz"+e]="moz"+t,o}var _n={animationend:Cn("Animation","AnimationEnd"),animationiteration:Cn("Animation","AnimationIteration"),animationstart:Cn("Animation","AnimationStart"),transitionend:Cn("Transition","TransitionEnd")},Sn={},En={};function kn(e){if(Sn[e])return Sn[e];if(!_n[e])return e;var t,o=_n[e];for(t in o)if(o.hasOwnProperty(t)&&t in En)return Sn[e]=o[t];return e}d&&(En=document.createElement("div").style,"AnimationEvent"in window||(delete _n.animationend.animation,delete _n.animationiteration.animation,delete _n.animationstart.animation),"TransitionEvent"in window||delete _n.transitionend.transition);var jn=kn("animationend"),An=kn("animationiteration"),Rn=kn("animationstart"),On=kn("transitionend"),Tn=new Map,Dn="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function Pn(e,t){Tn.set(e,t),l(t,[e])}for(var Nn=0;Nn<Dn.length;Nn++){var In=Dn[Nn];Pn(In.toLowerCase(),"on"+(In[0].toUpperCase()+In.slice(1)))}Pn(jn,"onAnimationEnd"),Pn(An,"onAnimationIteration"),Pn(Rn,"onAnimationStart"),Pn("dblclick","onDoubleClick"),Pn("focusin","onFocus"),Pn("focusout","onBlur"),Pn(On,"onTransitionEnd"),c("onMouseEnter",["mouseout","mouseover"]),c("onMouseLeave",["mouseout","mouseover"]),c("onPointerEnter",["pointerout","pointerover"]),c("onPointerLeave",["pointerout","pointerover"]),l("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),l("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),l("onBeforeInput",["compositionend","keypress","textInput","paste"]),l("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),l("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),l("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Mn="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),Ln=new Set("cancel close invalid load scroll toggle".split(" ").concat(Mn));function Fn(e,t,o){var n=e.type||"unknown-event";e.currentTarget=o,function(e,t,o,n,r,a,s,l,c){if(He.apply(this,arguments),Me){if(!Me)throw Error(i(198));var d=Le;Me=!1,Le=null,Fe||(Fe=!0,Ge=d)}}(n,t,void 0,e),e.currentTarget=null}function Gn(e,t){t=0!==(4&t);for(var o=0;o<e.length;o++){var n=e[o],r=n.event;n=n.listeners;e:{var i=void 0;if(t)for(var a=n.length-1;0<=a;a--){var s=n[a],l=s.instance,c=s.currentTarget;if(s=s.listener,l!==i&&r.isPropagationStopped())break e;Fn(r,s,c),i=l}else for(a=0;a<n.length;a++){if(l=(s=n[a]).instance,c=s.currentTarget,s=s.listener,l!==i&&r.isPropagationStopped())break e;Fn(r,s,c),i=l}}}if(Fe)throw e=Ge,Fe=!1,Ge=null,e}function zn(e,t){var o=t[mr];void 0===o&&(o=t[mr]=new Set);var n=e+"__bubble";o.has(n)||($n(t,e,2,!1),o.add(n))}function Hn(e,t,o){var n=0;t&&(n|=4),$n(o,e,n,t)}var Bn="_reactListening"+Math.random().toString(36).slice(2);function Vn(e){if(!e[Bn]){e[Bn]=!0,a.forEach((function(t){"selectionchange"!==t&&(Ln.has(t)||Hn(t,!1,e),Hn(t,!0,e))}));var t=9===e.nodeType?e:e.ownerDocument;null===t||t[Bn]||(t[Bn]=!0,Hn("selectionchange",!1,t))}}function $n(e,t,o,n){switch(Jt(t)){case 1:var r=Ut;break;case 4:r=Wt;break;default:r=qt}o=r.bind(null,t,o,e),r=void 0,!Pe||"touchstart"!==t&&"touchmove"!==t&&"wheel"!==t||(r=!0),n?void 0!==r?e.addEventListener(t,o,{capture:!0,passive:r}):e.addEventListener(t,o,!0):void 0!==r?e.addEventListener(t,o,{passive:r}):e.addEventListener(t,o,!1)}function Un(e,t,o,n,r){var i=n;if(0===(1&t)&&0===(2&t)&&null!==n)e:for(;;){if(null===n)return;var a=n.tag;if(3===a||4===a){var s=n.stateNode.containerInfo;if(s===r||8===s.nodeType&&s.parentNode===r)break;if(4===a)for(a=n.return;null!==a;){var l=a.tag;if((3===l||4===l)&&((l=a.stateNode.containerInfo)===r||8===l.nodeType&&l.parentNode===r))return;a=a.return}for(;null!==s;){if(null===(a=br(s)))return;if(5===(l=a.tag)||6===l){n=i=a;continue e}s=s.parentNode}}n=n.return}Te((function(){var n=i,r=we(o),a=[];e:{var s=Tn.get(e);if(void 0!==s){var l=co,c=e;switch(e){case"keypress":if(0===to(o))break e;case"keydown":case"keyup":l=jo;break;case"focusin":c="focus",l=mo;break;case"focusout":c="blur",l=mo;break;case"beforeblur":case"afterblur":l=mo;break;case"click":if(2===o.button)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":l=fo;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":l=go;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":l=Ro;break;case jn:case An:case Rn:l=yo;break;case On:l=Oo;break;case"scroll":l=po;break;case"wheel":l=Do;break;case"copy":case"cut":case"paste":l=bo;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":l=Ao}var d=0!==(4&t),u=!d&&"scroll"===e,p=d?null!==s?s+"Capture":null:s;d=[];for(var h,f=n;null!==f;){var g=(h=f).stateNode;if(5===h.tag&&null!==g&&(h=g,null!==p&&(null!=(g=De(f,p))&&d.push(Wn(f,g,h)))),u)break;f=f.return}0<d.length&&(s=new l(s,c,null,o,r),a.push({event:s,listeners:d}))}}if(0===(7&t)){if(l="mouseout"===e||"pointerout"===e,(!(s="mouseover"===e||"pointerover"===e)||o===xe||!(c=o.relatedTarget||o.fromElement)||!br(c)&&!c[gr])&&(l||s)&&(s=r.window===r?r:(s=r.ownerDocument)?s.defaultView||s.parentWindow:window,l?(l=n,null!==(c=(c=o.relatedTarget||o.toElement)?br(c):null)&&(c!==(u=Be(c))||5!==c.tag&&6!==c.tag)&&(c=null)):(l=null,c=n),l!==c)){if(d=fo,g="onMouseLeave",p="onMouseEnter",f="mouse","pointerout"!==e&&"pointerover"!==e||(d=Ao,g="onPointerLeave",p="onPointerEnter",f="pointer"),u=null==l?s:wr(l),h=null==c?s:wr(c),(s=new d(g,f+"leave",l,o,r)).target=u,s.relatedTarget=h,g=null,br(r)===n&&((d=new d(p,f+"enter",c,o,r)).target=h,d.relatedTarget=u,g=d),u=g,l&&c)e:{for(p=c,f=0,h=d=l;h;h=Kn(h))f++;for(h=0,g=p;g;g=Kn(g))h++;for(;0<f-h;)d=Kn(d),f--;for(;0<h-f;)p=Kn(p),h--;for(;f--;){if(d===p||null!==p&&d===p.alternate)break e;d=Kn(d),p=Kn(p)}d=null}else d=null;null!==l&&Yn(a,s,l,d,!1),null!==c&&null!==u&&Yn(a,u,c,d,!0)}if("select"===(l=(s=n?wr(n):window).nodeName&&s.nodeName.toLowerCase())||"input"===l&&"file"===s.type)var m=Jo;else if($o(s))if(Xo)m=sn;else{m=rn;var y=nn}else(l=s.nodeName)&&"input"===l.toLowerCase()&&("checkbox"===s.type||"radio"===s.type)&&(m=an);switch(m&&(m=m(e,n))?Uo(a,m,o,r):(y&&y(e,s,n),"focusout"===e&&(y=s._wrapperState)&&y.controlled&&"number"===s.type&&ee(s,"number",s.value)),y=n?wr(n):window,e){case"focusin":($o(y)||"true"===y.contentEditable)&&(yn=y,vn=n,bn=null);break;case"focusout":bn=vn=yn=null;break;case"mousedown":xn=!0;break;case"contextmenu":case"mouseup":case"dragend":xn=!1,wn(a,o,r);break;case"selectionchange":if(mn)break;case"keydown":case"keyup":wn(a,o,r)}var v;if(No)e:{switch(e){case"compositionstart":var b="onCompositionStart";break e;case"compositionend":b="onCompositionEnd";break e;case"compositionupdate":b="onCompositionUpdate";break e}b=void 0}else Bo?zo(e,o)&&(b="onCompositionEnd"):"keydown"===e&&229===o.keyCode&&(b="onCompositionStart");b&&(Lo&&"ko"!==o.locale&&(Bo||"onCompositionStart"!==b?"onCompositionEnd"===b&&Bo&&(v=eo()):(Qt="value"in(Xt=r)?Xt.value:Xt.textContent,Bo=!0)),0<(y=qn(n,b)).length&&(b=new xo(b,e,null,o,r),a.push({event:b,listeners:y}),v?b.data=v:null!==(v=Ho(o))&&(b.data=v))),(v=Mo?function(e,t){switch(e){case"compositionend":return Ho(t);case"keypress":return 32!==t.which?null:(Go=!0,Fo);case"textInput":return(e=t.data)===Fo&&Go?null:e;default:return null}}(e,o):function(e,t){if(Bo)return"compositionend"===e||!No&&zo(e,t)?(e=eo(),Zt=Qt=Xt=null,Bo=!1,e):null;switch(e){case"paste":default:return null;case"keypress":if(!(t.ctrlKey||t.altKey||t.metaKey)||t.ctrlKey&&t.altKey){if(t.char&&1<t.char.length)return t.char;if(t.which)return String.fromCharCode(t.which)}return null;case"compositionend":return Lo&&"ko"!==t.locale?null:t.data}}(e,o))&&(0<(n=qn(n,"onBeforeInput")).length&&(r=new xo("onBeforeInput","beforeinput",null,o,r),a.push({event:r,listeners:n}),r.data=v))}Gn(a,t)}))}function Wn(e,t,o){return{instance:e,listener:t,currentTarget:o}}function qn(e,t){for(var o=t+"Capture",n=[];null!==e;){var r=e,i=r.stateNode;5===r.tag&&null!==i&&(r=i,null!=(i=De(e,o))&&n.unshift(Wn(e,i,r)),null!=(i=De(e,t))&&n.push(Wn(e,i,r))),e=e.return}return n}function Kn(e){if(null===e)return null;do{e=e.return}while(e&&5!==e.tag);return e||null}function Yn(e,t,o,n,r){for(var i=t._reactName,a=[];null!==o&&o!==n;){var s=o,l=s.alternate,c=s.stateNode;if(null!==l&&l===n)break;5===s.tag&&null!==c&&(s=c,r?null!=(l=De(o,i))&&a.unshift(Wn(o,l,s)):r||null!=(l=De(o,i))&&a.push(Wn(o,l,s))),o=o.return}0!==a.length&&e.push({event:t,listeners:a})}var Jn=/\r\n?/g,Xn=/\u0000|\uFFFD/g;function Qn(e){return("string"===typeof e?e:""+e).replace(Jn,"\n").replace(Xn,"")}function Zn(e,t,o){if(t=Qn(t),Qn(e)!==t&&o)throw Error(i(425))}function er(){}var tr=null,or=null;function nr(e,t){return"textarea"===e||"noscript"===e||"string"===typeof t.children||"number"===typeof t.children||"object"===typeof t.dangerouslySetInnerHTML&&null!==t.dangerouslySetInnerHTML&&null!=t.dangerouslySetInnerHTML.__html}var rr="function"===typeof setTimeout?setTimeout:void 0,ir="function"===typeof clearTimeout?clearTimeout:void 0,ar="function"===typeof Promise?Promise:void 0,sr="function"===typeof queueMicrotask?queueMicrotask:"undefined"!==typeof ar?function(e){return ar.resolve(null).then(e).catch(lr)}:rr;function lr(e){setTimeout((function(){throw e}))}function cr(e,t){var o=t,n=0;do{var r=o.nextSibling;if(e.removeChild(o),r&&8===r.nodeType)if("/$"===(o=r.data)){if(0===n)return e.removeChild(r),void Bt(t);n--}else"$"!==o&&"$?"!==o&&"$!"!==o||n++;o=r}while(o);Bt(t)}function dr(e){for(;null!=e;e=e.nextSibling){var t=e.nodeType;if(1===t||3===t)break;if(8===t){if("$"===(t=e.data)||"$!"===t||"$?"===t)break;if("/$"===t)return null}}return e}function ur(e){e=e.previousSibling;for(var t=0;e;){if(8===e.nodeType){var o=e.data;if("$"===o||"$!"===o||"$?"===o){if(0===t)return e;t--}else"/$"===o&&t++}e=e.previousSibling}return null}var pr=Math.random().toString(36).slice(2),hr="__reactFiber$"+pr,fr="__reactProps$"+pr,gr="__reactContainer$"+pr,mr="__reactEvents$"+pr,yr="__reactListeners$"+pr,vr="__reactHandles$"+pr;function br(e){var t=e[hr];if(t)return t;for(var o=e.parentNode;o;){if(t=o[gr]||o[hr]){if(o=t.alternate,null!==t.child||null!==o&&null!==o.child)for(e=ur(e);null!==e;){if(o=e[hr])return o;e=ur(e)}return t}o=(e=o).parentNode}return null}function xr(e){return!(e=e[hr]||e[gr])||5!==e.tag&&6!==e.tag&&13!==e.tag&&3!==e.tag?null:e}function wr(e){if(5===e.tag||6===e.tag)return e.stateNode;throw Error(i(33))}function Cr(e){return e[fr]||null}var _r=[],Sr=-1;function Er(e){return{current:e}}function kr(e){0>Sr||(e.current=_r[Sr],_r[Sr]=null,Sr--)}function jr(e,t){Sr++,_r[Sr]=e.current,e.current=t}var Ar={},Rr=Er(Ar),Or=Er(!1),Tr=Ar;function Dr(e,t){var o=e.type.contextTypes;if(!o)return Ar;var n=e.stateNode;if(n&&n.__reactInternalMemoizedUnmaskedChildContext===t)return n.__reactInternalMemoizedMaskedChildContext;var r,i={};for(r in o)i[r]=t[r];return n&&((e=e.stateNode).__reactInternalMemoizedUnmaskedChildContext=t,e.__reactInternalMemoizedMaskedChildContext=i),i}function Pr(e){return null!==(e=e.childContextTypes)&&void 0!==e}function Nr(){kr(Or),kr(Rr)}function Ir(e,t,o){if(Rr.current!==Ar)throw Error(i(168));jr(Rr,t),jr(Or,o)}function Mr(e,t,o){var n=e.stateNode;if(t=t.childContextTypes,"function"!==typeof n.getChildContext)return o;for(var r in n=n.getChildContext())if(!(r in t))throw Error(i(108,V(e)||"Unknown",r));return L({},o,n)}function Lr(e){return e=(e=e.stateNode)&&e.__reactInternalMemoizedMergedChildContext||Ar,Tr=Rr.current,jr(Rr,e),jr(Or,Or.current),!0}function Fr(e,t,o){var n=e.stateNode;if(!n)throw Error(i(169));o?(e=Mr(e,t,Tr),n.__reactInternalMemoizedMergedChildContext=e,kr(Or),kr(Rr),jr(Rr,e)):kr(Or),jr(Or,o)}var Gr=null,zr=!1,Hr=!1;function Br(e){null===Gr?Gr=[e]:Gr.push(e)}function Vr(){if(!Hr&&null!==Gr){Hr=!0;var e=0,t=bt;try{var o=Gr;for(bt=1;e<o.length;e++){var n=o[e];do{n=n(!0)}while(null!==n)}Gr=null,zr=!1}catch(r){throw null!==Gr&&(Gr=Gr.slice(e+1)),qe(Ze,Vr),r}finally{bt=t,Hr=!1}}return null}var $r=[],Ur=0,Wr=null,qr=0,Kr=[],Yr=0,Jr=null,Xr=1,Qr="";function Zr(e,t){$r[Ur++]=qr,$r[Ur++]=Wr,Wr=e,qr=t}function ei(e,t,o){Kr[Yr++]=Xr,Kr[Yr++]=Qr,Kr[Yr++]=Jr,Jr=e;var n=Xr;e=Qr;var r=32-at(n)-1;n&=~(1<<r),o+=1;var i=32-at(t)+r;if(30<i){var a=r-r%5;i=(n&(1<<a)-1).toString(32),n>>=a,r-=a,Xr=1<<32-at(t)+r|o<<r|n,Qr=i+e}else Xr=1<<i|o<<r|n,Qr=e}function ti(e){null!==e.return&&(Zr(e,1),ei(e,1,0))}function oi(e){for(;e===Wr;)Wr=$r[--Ur],$r[Ur]=null,qr=$r[--Ur],$r[Ur]=null;for(;e===Jr;)Jr=Kr[--Yr],Kr[Yr]=null,Qr=Kr[--Yr],Kr[Yr]=null,Xr=Kr[--Yr],Kr[Yr]=null}var ni=null,ri=null,ii=!1,ai=null;function si(e,t){var o=Tc(5,null,null,0);o.elementType="DELETED",o.stateNode=t,o.return=e,null===(t=e.deletions)?(e.deletions=[o],e.flags|=16):t.push(o)}function li(e,t){switch(e.tag){case 5:var o=e.type;return null!==(t=1!==t.nodeType||o.toLowerCase()!==t.nodeName.toLowerCase()?null:t)&&(e.stateNode=t,ni=e,ri=dr(t.firstChild),!0);case 6:return null!==(t=""===e.pendingProps||3!==t.nodeType?null:t)&&(e.stateNode=t,ni=e,ri=null,!0);case 13:return null!==(t=8!==t.nodeType?null:t)&&(o=null!==Jr?{id:Xr,overflow:Qr}:null,e.memoizedState={dehydrated:t,treeContext:o,retryLane:1073741824},(o=Tc(18,null,null,0)).stateNode=t,o.return=e,e.child=o,ni=e,ri=null,!0);default:return!1}}function ci(e){return 0!==(1&e.mode)&&0===(128&e.flags)}function di(e){if(ii){var t=ri;if(t){var o=t;if(!li(e,t)){if(ci(e))throw Error(i(418));t=dr(o.nextSibling);var n=ni;t&&li(e,t)?si(n,o):(e.flags=-4097&e.flags|2,ii=!1,ni=e)}}else{if(ci(e))throw Error(i(418));e.flags=-4097&e.flags|2,ii=!1,ni=e}}}function ui(e){for(e=e.return;null!==e&&5!==e.tag&&3!==e.tag&&13!==e.tag;)e=e.return;ni=e}function pi(e){if(e!==ni)return!1;if(!ii)return ui(e),ii=!0,!1;var t;if((t=3!==e.tag)&&!(t=5!==e.tag)&&(t="head"!==(t=e.type)&&"body"!==t&&!nr(e.type,e.memoizedProps)),t&&(t=ri)){if(ci(e))throw hi(),Error(i(418));for(;t;)si(e,t),t=dr(t.nextSibling)}if(ui(e),13===e.tag){if(!(e=null!==(e=e.memoizedState)?e.dehydrated:null))throw Error(i(317));e:{for(e=e.nextSibling,t=0;e;){if(8===e.nodeType){var o=e.data;if("/$"===o){if(0===t){ri=dr(e.nextSibling);break e}t--}else"$"!==o&&"$!"!==o&&"$?"!==o||t++}e=e.nextSibling}ri=null}}else ri=ni?dr(e.stateNode.nextSibling):null;return!0}function hi(){for(var e=ri;e;)e=dr(e.nextSibling)}function fi(){ri=ni=null,ii=!1}function gi(e){null===ai?ai=[e]:ai.push(e)}var mi=x.ReactCurrentBatchConfig;function yi(e,t,o){if(null!==(e=o.ref)&&"function"!==typeof e&&"object"!==typeof e){if(o._owner){if(o=o._owner){if(1!==o.tag)throw Error(i(309));var n=o.stateNode}if(!n)throw Error(i(147,e));var r=n,a=""+e;return null!==t&&null!==t.ref&&"function"===typeof t.ref&&t.ref._stringRef===a?t.ref:(t=function(e){var t=r.refs;null===e?delete t[a]:t[a]=e},t._stringRef=a,t)}if("string"!==typeof e)throw Error(i(284));if(!o._owner)throw Error(i(290,e))}return e}function vi(e,t){throw e=Object.prototype.toString.call(t),Error(i(31,"[object Object]"===e?"object with keys {"+Object.keys(t).join(", ")+"}":e))}function bi(e){return(0,e._init)(e._payload)}function xi(e){function t(t,o){if(e){var n=t.deletions;null===n?(t.deletions=[o],t.flags|=16):n.push(o)}}function o(o,n){if(!e)return null;for(;null!==n;)t(o,n),n=n.sibling;return null}function n(e,t){for(e=new Map;null!==t;)null!==t.key?e.set(t.key,t):e.set(t.index,t),t=t.sibling;return e}function r(e,t){return(e=Pc(e,t)).index=0,e.sibling=null,e}function a(t,o,n){return t.index=n,e?null!==(n=t.alternate)?(n=n.index)<o?(t.flags|=2,o):n:(t.flags|=2,o):(t.flags|=1048576,o)}function s(t){return e&&null===t.alternate&&(t.flags|=2),t}function l(e,t,o,n){return null===t||6!==t.tag?((t=Lc(o,e.mode,n)).return=e,t):((t=r(t,o)).return=e,t)}function c(e,t,o,n){var i=o.type;return i===_?u(e,t,o.props.children,n,o.key):null!==t&&(t.elementType===i||"object"===typeof i&&null!==i&&i.$$typeof===D&&bi(i)===t.type)?((n=r(t,o.props)).ref=yi(e,t,o),n.return=e,n):((n=Nc(o.type,o.key,o.props,null,e.mode,n)).ref=yi(e,t,o),n.return=e,n)}function d(e,t,o,n){return null===t||4!==t.tag||t.stateNode.containerInfo!==o.containerInfo||t.stateNode.implementation!==o.implementation?((t=Fc(o,e.mode,n)).return=e,t):((t=r(t,o.children||[])).return=e,t)}function u(e,t,o,n,i){return null===t||7!==t.tag?((t=Ic(o,e.mode,n,i)).return=e,t):((t=r(t,o)).return=e,t)}function p(e,t,o){if("string"===typeof t&&""!==t||"number"===typeof t)return(t=Lc(""+t,e.mode,o)).return=e,t;if("object"===typeof t&&null!==t){switch(t.$$typeof){case w:return(o=Nc(t.type,t.key,t.props,null,e.mode,o)).ref=yi(e,null,t),o.return=e,o;case C:return(t=Fc(t,e.mode,o)).return=e,t;case D:return p(e,(0,t._init)(t._payload),o)}if(te(t)||I(t))return(t=Ic(t,e.mode,o,null)).return=e,t;vi(e,t)}return null}function h(e,t,o,n){var r=null!==t?t.key:null;if("string"===typeof o&&""!==o||"number"===typeof o)return null!==r?null:l(e,t,""+o,n);if("object"===typeof o&&null!==o){switch(o.$$typeof){case w:return o.key===r?c(e,t,o,n):null;case C:return o.key===r?d(e,t,o,n):null;case D:return h(e,t,(r=o._init)(o._payload),n)}if(te(o)||I(o))return null!==r?null:u(e,t,o,n,null);vi(e,o)}return null}function f(e,t,o,n,r){if("string"===typeof n&&""!==n||"number"===typeof n)return l(t,e=e.get(o)||null,""+n,r);if("object"===typeof n&&null!==n){switch(n.$$typeof){case w:return c(t,e=e.get(null===n.key?o:n.key)||null,n,r);case C:return d(t,e=e.get(null===n.key?o:n.key)||null,n,r);case D:return f(e,t,o,(0,n._init)(n._payload),r)}if(te(n)||I(n))return u(t,e=e.get(o)||null,n,r,null);vi(t,n)}return null}function g(r,i,s,l){for(var c=null,d=null,u=i,g=i=0,m=null;null!==u&&g<s.length;g++){u.index>g?(m=u,u=null):m=u.sibling;var y=h(r,u,s[g],l);if(null===y){null===u&&(u=m);break}e&&u&&null===y.alternate&&t(r,u),i=a(y,i,g),null===d?c=y:d.sibling=y,d=y,u=m}if(g===s.length)return o(r,u),ii&&Zr(r,g),c;if(null===u){for(;g<s.length;g++)null!==(u=p(r,s[g],l))&&(i=a(u,i,g),null===d?c=u:d.sibling=u,d=u);return ii&&Zr(r,g),c}for(u=n(r,u);g<s.length;g++)null!==(m=f(u,r,g,s[g],l))&&(e&&null!==m.alternate&&u.delete(null===m.key?g:m.key),i=a(m,i,g),null===d?c=m:d.sibling=m,d=m);return e&&u.forEach((function(e){return t(r,e)})),ii&&Zr(r,g),c}function m(r,s,l,c){var d=I(l);if("function"!==typeof d)throw Error(i(150));if(null==(l=d.call(l)))throw Error(i(151));for(var u=d=null,g=s,m=s=0,y=null,v=l.next();null!==g&&!v.done;m++,v=l.next()){g.index>m?(y=g,g=null):y=g.sibling;var b=h(r,g,v.value,c);if(null===b){null===g&&(g=y);break}e&&g&&null===b.alternate&&t(r,g),s=a(b,s,m),null===u?d=b:u.sibling=b,u=b,g=y}if(v.done)return o(r,g),ii&&Zr(r,m),d;if(null===g){for(;!v.done;m++,v=l.next())null!==(v=p(r,v.value,c))&&(s=a(v,s,m),null===u?d=v:u.sibling=v,u=v);return ii&&Zr(r,m),d}for(g=n(r,g);!v.done;m++,v=l.next())null!==(v=f(g,r,m,v.value,c))&&(e&&null!==v.alternate&&g.delete(null===v.key?m:v.key),s=a(v,s,m),null===u?d=v:u.sibling=v,u=v);return e&&g.forEach((function(e){return t(r,e)})),ii&&Zr(r,m),d}return function e(n,i,a,l){if("object"===typeof a&&null!==a&&a.type===_&&null===a.key&&(a=a.props.children),"object"===typeof a&&null!==a){switch(a.$$typeof){case w:e:{for(var c=a.key,d=i;null!==d;){if(d.key===c){if((c=a.type)===_){if(7===d.tag){o(n,d.sibling),(i=r(d,a.props.children)).return=n,n=i;break e}}else if(d.elementType===c||"object"===typeof c&&null!==c&&c.$$typeof===D&&bi(c)===d.type){o(n,d.sibling),(i=r(d,a.props)).ref=yi(n,d,a),i.return=n,n=i;break e}o(n,d);break}t(n,d),d=d.sibling}a.type===_?((i=Ic(a.props.children,n.mode,l,a.key)).return=n,n=i):((l=Nc(a.type,a.key,a.props,null,n.mode,l)).ref=yi(n,i,a),l.return=n,n=l)}return s(n);case C:e:{for(d=a.key;null!==i;){if(i.key===d){if(4===i.tag&&i.stateNode.containerInfo===a.containerInfo&&i.stateNode.implementation===a.implementation){o(n,i.sibling),(i=r(i,a.children||[])).return=n,n=i;break e}o(n,i);break}t(n,i),i=i.sibling}(i=Fc(a,n.mode,l)).return=n,n=i}return s(n);case D:return e(n,i,(d=a._init)(a._payload),l)}if(te(a))return g(n,i,a,l);if(I(a))return m(n,i,a,l);vi(n,a)}return"string"===typeof a&&""!==a||"number"===typeof a?(a=""+a,null!==i&&6===i.tag?(o(n,i.sibling),(i=r(i,a)).return=n,n=i):(o(n,i),(i=Lc(a,n.mode,l)).return=n,n=i),s(n)):o(n,i)}}var wi=xi(!0),Ci=xi(!1),_i=Er(null),Si=null,Ei=null,ki=null;function ji(){ki=Ei=Si=null}function Ai(e){var t=_i.current;kr(_i),e._currentValue=t}function Ri(e,t,o){for(;null!==e;){var n=e.alternate;if((e.childLanes&t)!==t?(e.childLanes|=t,null!==n&&(n.childLanes|=t)):null!==n&&(n.childLanes&t)!==t&&(n.childLanes|=t),e===o)break;e=e.return}}function Oi(e,t){Si=e,ki=Ei=null,null!==(e=e.dependencies)&&null!==e.firstContext&&(0!==(e.lanes&t)&&(bs=!0),e.firstContext=null)}function Ti(e){var t=e._currentValue;if(ki!==e)if(e={context:e,memoizedValue:t,next:null},null===Ei){if(null===Si)throw Error(i(308));Ei=e,Si.dependencies={lanes:0,firstContext:e}}else Ei=Ei.next=e;return t}var Di=null;function Pi(e){null===Di?Di=[e]:Di.push(e)}function Ni(e,t,o,n){var r=t.interleaved;return null===r?(o.next=o,Pi(t)):(o.next=r.next,r.next=o),t.interleaved=o,Ii(e,n)}function Ii(e,t){e.lanes|=t;var o=e.alternate;for(null!==o&&(o.lanes|=t),o=e,e=e.return;null!==e;)e.childLanes|=t,null!==(o=e.alternate)&&(o.childLanes|=t),o=e,e=e.return;return 3===o.tag?o.stateNode:null}var Mi=!1;function Li(e){e.updateQueue={baseState:e.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function Fi(e,t){e=e.updateQueue,t.updateQueue===e&&(t.updateQueue={baseState:e.baseState,firstBaseUpdate:e.firstBaseUpdate,lastBaseUpdate:e.lastBaseUpdate,shared:e.shared,effects:e.effects})}function Gi(e,t){return{eventTime:e,lane:t,tag:0,payload:null,callback:null,next:null}}function zi(e,t,o){var n=e.updateQueue;if(null===n)return null;if(n=n.shared,0!==(2&Al)){var r=n.pending;return null===r?t.next=t:(t.next=r.next,r.next=t),n.pending=t,Ii(e,o)}return null===(r=n.interleaved)?(t.next=t,Pi(n)):(t.next=r.next,r.next=t),n.interleaved=t,Ii(e,o)}function Hi(e,t,o){if(null!==(t=t.updateQueue)&&(t=t.shared,0!==(4194240&o))){var n=t.lanes;o|=n&=e.pendingLanes,t.lanes=o,vt(e,o)}}function Bi(e,t){var o=e.updateQueue,n=e.alternate;if(null!==n&&o===(n=n.updateQueue)){var r=null,i=null;if(null!==(o=o.firstBaseUpdate)){do{var a={eventTime:o.eventTime,lane:o.lane,tag:o.tag,payload:o.payload,callback:o.callback,next:null};null===i?r=i=a:i=i.next=a,o=o.next}while(null!==o);null===i?r=i=t:i=i.next=t}else r=i=t;return o={baseState:n.baseState,firstBaseUpdate:r,lastBaseUpdate:i,shared:n.shared,effects:n.effects},void(e.updateQueue=o)}null===(e=o.lastBaseUpdate)?o.firstBaseUpdate=t:e.next=t,o.lastBaseUpdate=t}function Vi(e,t,o,n){var r=e.updateQueue;Mi=!1;var i=r.firstBaseUpdate,a=r.lastBaseUpdate,s=r.shared.pending;if(null!==s){r.shared.pending=null;var l=s,c=l.next;l.next=null,null===a?i=c:a.next=c,a=l;var d=e.alternate;null!==d&&((s=(d=d.updateQueue).lastBaseUpdate)!==a&&(null===s?d.firstBaseUpdate=c:s.next=c,d.lastBaseUpdate=l))}if(null!==i){var u=r.baseState;for(a=0,d=c=l=null,s=i;;){var p=s.lane,h=s.eventTime;if((n&p)===p){null!==d&&(d=d.next={eventTime:h,lane:0,tag:s.tag,payload:s.payload,callback:s.callback,next:null});e:{var f=e,g=s;switch(p=t,h=o,g.tag){case 1:if("function"===typeof(f=g.payload)){u=f.call(h,u,p);break e}u=f;break e;case 3:f.flags=-65537&f.flags|128;case 0:if(null===(p="function"===typeof(f=g.payload)?f.call(h,u,p):f)||void 0===p)break e;u=L({},u,p);break e;case 2:Mi=!0}}null!==s.callback&&0!==s.lane&&(e.flags|=64,null===(p=r.effects)?r.effects=[s]:p.push(s))}else h={eventTime:h,lane:p,tag:s.tag,payload:s.payload,callback:s.callback,next:null},null===d?(c=d=h,l=u):d=d.next=h,a|=p;if(null===(s=s.next)){if(null===(s=r.shared.pending))break;s=(p=s).next,p.next=null,r.lastBaseUpdate=p,r.shared.pending=null}}if(null===d&&(l=u),r.baseState=l,r.firstBaseUpdate=c,r.lastBaseUpdate=d,null!==(t=r.shared.interleaved)){r=t;do{a|=r.lane,r=r.next}while(r!==t)}else null===i&&(r.shared.lanes=0);Ml|=a,e.lanes=a,e.memoizedState=u}}function $i(e,t,o){if(e=t.effects,t.effects=null,null!==e)for(t=0;t<e.length;t++){var n=e[t],r=n.callback;if(null!==r){if(n.callback=null,n=o,"function"!==typeof r)throw Error(i(191,r));r.call(n)}}}var Ui={},Wi=Er(Ui),qi=Er(Ui),Ki=Er(Ui);function Yi(e){if(e===Ui)throw Error(i(174));return e}function Ji(e,t){switch(jr(Ki,t),jr(qi,e),jr(Wi,Ui),e=t.nodeType){case 9:case 11:t=(t=t.documentElement)?t.namespaceURI:le(null,"");break;default:t=le(t=(e=8===e?t.parentNode:t).namespaceURI||null,e=e.tagName)}kr(Wi),jr(Wi,t)}function Xi(){kr(Wi),kr(qi),kr(Ki)}function Qi(e){Yi(Ki.current);var t=Yi(Wi.current),o=le(t,e.type);t!==o&&(jr(qi,e),jr(Wi,o))}function Zi(e){qi.current===e&&(kr(Wi),kr(qi))}var ea=Er(0);function ta(e){for(var t=e;null!==t;){if(13===t.tag){var o=t.memoizedState;if(null!==o&&(null===(o=o.dehydrated)||"$?"===o.data||"$!"===o.data))return t}else if(19===t.tag&&void 0!==t.memoizedProps.revealOrder){if(0!==(128&t.flags))return t}else if(null!==t.child){t.child.return=t,t=t.child;continue}if(t===e)break;for(;null===t.sibling;){if(null===t.return||t.return===e)return null;t=t.return}t.sibling.return=t.return,t=t.sibling}return null}var oa=[];function na(){for(var e=0;e<oa.length;e++)oa[e]._workInProgressVersionPrimary=null;oa.length=0}var ra=x.ReactCurrentDispatcher,ia=x.ReactCurrentBatchConfig,aa=0,sa=null,la=null,ca=null,da=!1,ua=!1,pa=0,ha=0;function fa(){throw Error(i(321))}function ga(e,t){if(null===t)return!1;for(var o=0;o<t.length&&o<e.length;o++)if(!ln(e[o],t[o]))return!1;return!0}function ma(e,t,o,n,r,a){if(aa=a,sa=t,t.memoizedState=null,t.updateQueue=null,t.lanes=0,ra.current=null===e||null===e.memoizedState?Za:es,e=o(n,r),ua){a=0;do{if(ua=!1,pa=0,25<=a)throw Error(i(301));a+=1,ca=la=null,t.updateQueue=null,ra.current=ts,e=o(n,r)}while(ua)}if(ra.current=Qa,t=null!==la&&null!==la.next,aa=0,ca=la=sa=null,da=!1,t)throw Error(i(300));return e}function ya(){var e=0!==pa;return pa=0,e}function va(){var e={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return null===ca?sa.memoizedState=ca=e:ca=ca.next=e,ca}function ba(){if(null===la){var e=sa.alternate;e=null!==e?e.memoizedState:null}else e=la.next;var t=null===ca?sa.memoizedState:ca.next;if(null!==t)ca=t,la=e;else{if(null===e)throw Error(i(310));e={memoizedState:(la=e).memoizedState,baseState:la.baseState,baseQueue:la.baseQueue,queue:la.queue,next:null},null===ca?sa.memoizedState=ca=e:ca=ca.next=e}return ca}function xa(e,t){return"function"===typeof t?t(e):t}function wa(e){var t=ba(),o=t.queue;if(null===o)throw Error(i(311));o.lastRenderedReducer=e;var n=la,r=n.baseQueue,a=o.pending;if(null!==a){if(null!==r){var s=r.next;r.next=a.next,a.next=s}n.baseQueue=r=a,o.pending=null}if(null!==r){a=r.next,n=n.baseState;var l=s=null,c=null,d=a;do{var u=d.lane;if((aa&u)===u)null!==c&&(c=c.next={lane:0,action:d.action,hasEagerState:d.hasEagerState,eagerState:d.eagerState,next:null}),n=d.hasEagerState?d.eagerState:e(n,d.action);else{var p={lane:u,action:d.action,hasEagerState:d.hasEagerState,eagerState:d.eagerState,next:null};null===c?(l=c=p,s=n):c=c.next=p,sa.lanes|=u,Ml|=u}d=d.next}while(null!==d&&d!==a);null===c?s=n:c.next=l,ln(n,t.memoizedState)||(bs=!0),t.memoizedState=n,t.baseState=s,t.baseQueue=c,o.lastRenderedState=n}if(null!==(e=o.interleaved)){r=e;do{a=r.lane,sa.lanes|=a,Ml|=a,r=r.next}while(r!==e)}else null===r&&(o.lanes=0);return[t.memoizedState,o.dispatch]}function Ca(e){var t=ba(),o=t.queue;if(null===o)throw Error(i(311));o.lastRenderedReducer=e;var n=o.dispatch,r=o.pending,a=t.memoizedState;if(null!==r){o.pending=null;var s=r=r.next;do{a=e(a,s.action),s=s.next}while(s!==r);ln(a,t.memoizedState)||(bs=!0),t.memoizedState=a,null===t.baseQueue&&(t.baseState=a),o.lastRenderedState=a}return[a,n]}function _a(){}function Sa(e,t){var o=sa,n=ba(),r=t(),a=!ln(n.memoizedState,r);if(a&&(n.memoizedState=r,bs=!0),n=n.queue,Ma(ja.bind(null,o,n,e),[e]),n.getSnapshot!==t||a||null!==ca&&1&ca.memoizedState.tag){if(o.flags|=2048,Ta(9,ka.bind(null,o,n,r,t),void 0,null),null===Rl)throw Error(i(349));0!==(30&aa)||Ea(o,t,r)}return r}function Ea(e,t,o){e.flags|=16384,e={getSnapshot:t,value:o},null===(t=sa.updateQueue)?(t={lastEffect:null,stores:null},sa.updateQueue=t,t.stores=[e]):null===(o=t.stores)?t.stores=[e]:o.push(e)}function ka(e,t,o,n){t.value=o,t.getSnapshot=n,Aa(t)&&Ra(e)}function ja(e,t,o){return o((function(){Aa(t)&&Ra(e)}))}function Aa(e){var t=e.getSnapshot;e=e.value;try{var o=t();return!ln(e,o)}catch(n){return!0}}function Ra(e){var t=Ii(e,1);null!==t&&oc(t,e,1,-1)}function Oa(e){var t=va();return"function"===typeof e&&(e=e()),t.memoizedState=t.baseState=e,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:xa,lastRenderedState:e},t.queue=e,e=e.dispatch=Ka.bind(null,sa,e),[t.memoizedState,e]}function Ta(e,t,o,n){return e={tag:e,create:t,destroy:o,deps:n,next:null},null===(t=sa.updateQueue)?(t={lastEffect:null,stores:null},sa.updateQueue=t,t.lastEffect=e.next=e):null===(o=t.lastEffect)?t.lastEffect=e.next=e:(n=o.next,o.next=e,e.next=n,t.lastEffect=e),e}function Da(){return ba().memoizedState}function Pa(e,t,o,n){var r=va();sa.flags|=e,r.memoizedState=Ta(1|t,o,void 0,void 0===n?null:n)}function Na(e,t,o,n){var r=ba();n=void 0===n?null:n;var i=void 0;if(null!==la){var a=la.memoizedState;if(i=a.destroy,null!==n&&ga(n,a.deps))return void(r.memoizedState=Ta(t,o,i,n))}sa.flags|=e,r.memoizedState=Ta(1|t,o,i,n)}function Ia(e,t){return Pa(8390656,8,e,t)}function Ma(e,t){return Na(2048,8,e,t)}function La(e,t){return Na(4,2,e,t)}function Fa(e,t){return Na(4,4,e,t)}function Ga(e,t){return"function"===typeof t?(e=e(),t(e),function(){t(null)}):null!==t&&void 0!==t?(e=e(),t.current=e,function(){t.current=null}):void 0}function za(e,t,o){return o=null!==o&&void 0!==o?o.concat([e]):null,Na(4,4,Ga.bind(null,t,e),o)}function Ha(){}function Ba(e,t){var o=ba();t=void 0===t?null:t;var n=o.memoizedState;return null!==n&&null!==t&&ga(t,n[1])?n[0]:(o.memoizedState=[e,t],e)}function Va(e,t){var o=ba();t=void 0===t?null:t;var n=o.memoizedState;return null!==n&&null!==t&&ga(t,n[1])?n[0]:(e=e(),o.memoizedState=[e,t],e)}function $a(e,t,o){return 0===(21&aa)?(e.baseState&&(e.baseState=!1,bs=!0),e.memoizedState=o):(ln(o,t)||(o=gt(),sa.lanes|=o,Ml|=o,e.baseState=!0),t)}function Ua(e,t){var o=bt;bt=0!==o&&4>o?o:4,e(!0);var n=ia.transition;ia.transition={};try{e(!1),t()}finally{bt=o,ia.transition=n}}function Wa(){return ba().memoizedState}function qa(e,t,o){var n=tc(e);if(o={lane:n,action:o,hasEagerState:!1,eagerState:null,next:null},Ya(e))Ja(t,o);else if(null!==(o=Ni(e,t,o,n))){oc(o,e,n,ec()),Xa(o,t,n)}}function Ka(e,t,o){var n=tc(e),r={lane:n,action:o,hasEagerState:!1,eagerState:null,next:null};if(Ya(e))Ja(t,r);else{var i=e.alternate;if(0===e.lanes&&(null===i||0===i.lanes)&&null!==(i=t.lastRenderedReducer))try{var a=t.lastRenderedState,s=i(a,o);if(r.hasEagerState=!0,r.eagerState=s,ln(s,a)){var l=t.interleaved;return null===l?(r.next=r,Pi(t)):(r.next=l.next,l.next=r),void(t.interleaved=r)}}catch(c){}null!==(o=Ni(e,t,r,n))&&(oc(o,e,n,r=ec()),Xa(o,t,n))}}function Ya(e){var t=e.alternate;return e===sa||null!==t&&t===sa}function Ja(e,t){ua=da=!0;var o=e.pending;null===o?t.next=t:(t.next=o.next,o.next=t),e.pending=t}function Xa(e,t,o){if(0!==(4194240&o)){var n=t.lanes;o|=n&=e.pendingLanes,t.lanes=o,vt(e,o)}}var Qa={readContext:Ti,useCallback:fa,useContext:fa,useEffect:fa,useImperativeHandle:fa,useInsertionEffect:fa,useLayoutEffect:fa,useMemo:fa,useReducer:fa,useRef:fa,useState:fa,useDebugValue:fa,useDeferredValue:fa,useTransition:fa,useMutableSource:fa,useSyncExternalStore:fa,useId:fa,unstable_isNewReconciler:!1},Za={readContext:Ti,useCallback:function(e,t){return va().memoizedState=[e,void 0===t?null:t],e},useContext:Ti,useEffect:Ia,useImperativeHandle:function(e,t,o){return o=null!==o&&void 0!==o?o.concat([e]):null,Pa(4194308,4,Ga.bind(null,t,e),o)},useLayoutEffect:function(e,t){return Pa(4194308,4,e,t)},useInsertionEffect:function(e,t){return Pa(4,2,e,t)},useMemo:function(e,t){var o=va();return t=void 0===t?null:t,e=e(),o.memoizedState=[e,t],e},useReducer:function(e,t,o){var n=va();return t=void 0!==o?o(t):t,n.memoizedState=n.baseState=t,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:e,lastRenderedState:t},n.queue=e,e=e.dispatch=qa.bind(null,sa,e),[n.memoizedState,e]},useRef:function(e){return e={current:e},va().memoizedState=e},useState:Oa,useDebugValue:Ha,useDeferredValue:function(e){return va().memoizedState=e},useTransition:function(){var e=Oa(!1),t=e[0];return e=Ua.bind(null,e[1]),va().memoizedState=e,[t,e]},useMutableSource:function(){},useSyncExternalStore:function(e,t,o){var n=sa,r=va();if(ii){if(void 0===o)throw Error(i(407));o=o()}else{if(o=t(),null===Rl)throw Error(i(349));0!==(30&aa)||Ea(n,t,o)}r.memoizedState=o;var a={value:o,getSnapshot:t};return r.queue=a,Ia(ja.bind(null,n,a,e),[e]),n.flags|=2048,Ta(9,ka.bind(null,n,a,o,t),void 0,null),o},useId:function(){var e=va(),t=Rl.identifierPrefix;if(ii){var o=Qr;t=":"+t+"R"+(o=(Xr&~(1<<32-at(Xr)-1)).toString(32)+o),0<(o=pa++)&&(t+="H"+o.toString(32)),t+=":"}else t=":"+t+"r"+(o=ha++).toString(32)+":";return e.memoizedState=t},unstable_isNewReconciler:!1},es={readContext:Ti,useCallback:Ba,useContext:Ti,useEffect:Ma,useImperativeHandle:za,useInsertionEffect:La,useLayoutEffect:Fa,useMemo:Va,useReducer:wa,useRef:Da,useState:function(){return wa(xa)},useDebugValue:Ha,useDeferredValue:function(e){return $a(ba(),la.memoizedState,e)},useTransition:function(){return[wa(xa)[0],ba().memoizedState]},useMutableSource:_a,useSyncExternalStore:Sa,useId:Wa,unstable_isNewReconciler:!1},ts={readContext:Ti,useCallback:Ba,useContext:Ti,useEffect:Ma,useImperativeHandle:za,useInsertionEffect:La,useLayoutEffect:Fa,useMemo:Va,useReducer:Ca,useRef:Da,useState:function(){return Ca(xa)},useDebugValue:Ha,useDeferredValue:function(e){var t=ba();return null===la?t.memoizedState=e:$a(t,la.memoizedState,e)},useTransition:function(){return[Ca(xa)[0],ba().memoizedState]},useMutableSource:_a,useSyncExternalStore:Sa,useId:Wa,unstable_isNewReconciler:!1};function os(e,t){if(e&&e.defaultProps){for(var o in t=L({},t),e=e.defaultProps)void 0===t[o]&&(t[o]=e[o]);return t}return t}function ns(e,t,o,n){o=null===(o=o(n,t=e.memoizedState))||void 0===o?t:L({},t,o),e.memoizedState=o,0===e.lanes&&(e.updateQueue.baseState=o)}var rs={isMounted:function(e){return!!(e=e._reactInternals)&&Be(e)===e},enqueueSetState:function(e,t,o){e=e._reactInternals;var n=ec(),r=tc(e),i=Gi(n,r);i.payload=t,void 0!==o&&null!==o&&(i.callback=o),null!==(t=zi(e,i,r))&&(oc(t,e,r,n),Hi(t,e,r))},enqueueReplaceState:function(e,t,o){e=e._reactInternals;var n=ec(),r=tc(e),i=Gi(n,r);i.tag=1,i.payload=t,void 0!==o&&null!==o&&(i.callback=o),null!==(t=zi(e,i,r))&&(oc(t,e,r,n),Hi(t,e,r))},enqueueForceUpdate:function(e,t){e=e._reactInternals;var o=ec(),n=tc(e),r=Gi(o,n);r.tag=2,void 0!==t&&null!==t&&(r.callback=t),null!==(t=zi(e,r,n))&&(oc(t,e,n,o),Hi(t,e,n))}};function is(e,t,o,n,r,i,a){return"function"===typeof(e=e.stateNode).shouldComponentUpdate?e.shouldComponentUpdate(n,i,a):!t.prototype||!t.prototype.isPureReactComponent||(!cn(o,n)||!cn(r,i))}function as(e,t,o){var n=!1,r=Ar,i=t.contextType;return"object"===typeof i&&null!==i?i=Ti(i):(r=Pr(t)?Tr:Rr.current,i=(n=null!==(n=t.contextTypes)&&void 0!==n)?Dr(e,r):Ar),t=new t(o,i),e.memoizedState=null!==t.state&&void 0!==t.state?t.state:null,t.updater=rs,e.stateNode=t,t._reactInternals=e,n&&((e=e.stateNode).__reactInternalMemoizedUnmaskedChildContext=r,e.__reactInternalMemoizedMaskedChildContext=i),t}function ss(e,t,o,n){e=t.state,"function"===typeof t.componentWillReceiveProps&&t.componentWillReceiveProps(o,n),"function"===typeof t.UNSAFE_componentWillReceiveProps&&t.UNSAFE_componentWillReceiveProps(o,n),t.state!==e&&rs.enqueueReplaceState(t,t.state,null)}function ls(e,t,o,n){var r=e.stateNode;r.props=o,r.state=e.memoizedState,r.refs={},Li(e);var i=t.contextType;"object"===typeof i&&null!==i?r.context=Ti(i):(i=Pr(t)?Tr:Rr.current,r.context=Dr(e,i)),r.state=e.memoizedState,"function"===typeof(i=t.getDerivedStateFromProps)&&(ns(e,t,i,o),r.state=e.memoizedState),"function"===typeof t.getDerivedStateFromProps||"function"===typeof r.getSnapshotBeforeUpdate||"function"!==typeof r.UNSAFE_componentWillMount&&"function"!==typeof r.componentWillMount||(t=r.state,"function"===typeof r.componentWillMount&&r.componentWillMount(),"function"===typeof r.UNSAFE_componentWillMount&&r.UNSAFE_componentWillMount(),t!==r.state&&rs.enqueueReplaceState(r,r.state,null),Vi(e,o,r,n),r.state=e.memoizedState),"function"===typeof r.componentDidMount&&(e.flags|=4194308)}function cs(e,t){try{var o="",n=t;do{o+=H(n),n=n.return}while(n);var r=o}catch(i){r="\nError generating stack: "+i.message+"\n"+i.stack}return{value:e,source:t,stack:r,digest:null}}function ds(e,t,o){return{value:e,source:null,stack:null!=o?o:null,digest:null!=t?t:null}}function us(e,t){try{console.error(t.value)}catch(o){setTimeout((function(){throw o}))}}var ps="function"===typeof WeakMap?WeakMap:Map;function hs(e,t,o){(o=Gi(-1,o)).tag=3,o.payload={element:null};var n=t.value;return o.callback=function(){$l||($l=!0,Ul=n),us(0,t)},o}function fs(e,t,o){(o=Gi(-1,o)).tag=3;var n=e.type.getDerivedStateFromError;if("function"===typeof n){var r=t.value;o.payload=function(){return n(r)},o.callback=function(){us(0,t)}}var i=e.stateNode;return null!==i&&"function"===typeof i.componentDidCatch&&(o.callback=function(){us(0,t),"function"!==typeof n&&(null===Wl?Wl=new Set([this]):Wl.add(this));var e=t.stack;this.componentDidCatch(t.value,{componentStack:null!==e?e:""})}),o}function gs(e,t,o){var n=e.pingCache;if(null===n){n=e.pingCache=new ps;var r=new Set;n.set(t,r)}else void 0===(r=n.get(t))&&(r=new Set,n.set(t,r));r.has(o)||(r.add(o),e=Ec.bind(null,e,t,o),t.then(e,e))}function ms(e){do{var t;if((t=13===e.tag)&&(t=null===(t=e.memoizedState)||null!==t.dehydrated),t)return e;e=e.return}while(null!==e);return null}function ys(e,t,o,n,r){return 0===(1&e.mode)?(e===t?e.flags|=65536:(e.flags|=128,o.flags|=131072,o.flags&=-52805,1===o.tag&&(null===o.alternate?o.tag=17:((t=Gi(-1,1)).tag=2,zi(o,t,1))),o.lanes|=1),e):(e.flags|=65536,e.lanes=r,e)}var vs=x.ReactCurrentOwner,bs=!1;function xs(e,t,o,n){t.child=null===e?Ci(t,null,o,n):wi(t,e.child,o,n)}function ws(e,t,o,n,r){o=o.render;var i=t.ref;return Oi(t,r),n=ma(e,t,o,n,i,r),o=ya(),null===e||bs?(ii&&o&&ti(t),t.flags|=1,xs(e,t,n,r),t.child):(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~r,$s(e,t,r))}function Cs(e,t,o,n,r){if(null===e){var i=o.type;return"function"!==typeof i||Dc(i)||void 0!==i.defaultProps||null!==o.compare||void 0!==o.defaultProps?((e=Nc(o.type,null,n,t,t.mode,r)).ref=t.ref,e.return=t,t.child=e):(t.tag=15,t.type=i,_s(e,t,i,n,r))}if(i=e.child,0===(e.lanes&r)){var a=i.memoizedProps;if((o=null!==(o=o.compare)?o:cn)(a,n)&&e.ref===t.ref)return $s(e,t,r)}return t.flags|=1,(e=Pc(i,n)).ref=t.ref,e.return=t,t.child=e}function _s(e,t,o,n,r){if(null!==e){var i=e.memoizedProps;if(cn(i,n)&&e.ref===t.ref){if(bs=!1,t.pendingProps=n=i,0===(e.lanes&r))return t.lanes=e.lanes,$s(e,t,r);0!==(131072&e.flags)&&(bs=!0)}}return ks(e,t,o,n,r)}function Ss(e,t,o){var n=t.pendingProps,r=n.children,i=null!==e?e.memoizedState:null;if("hidden"===n.mode)if(0===(1&t.mode))t.memoizedState={baseLanes:0,cachePool:null,transitions:null},jr(Pl,Dl),Dl|=o;else{if(0===(1073741824&o))return e=null!==i?i.baseLanes|o:o,t.lanes=t.childLanes=1073741824,t.memoizedState={baseLanes:e,cachePool:null,transitions:null},t.updateQueue=null,jr(Pl,Dl),Dl|=e,null;t.memoizedState={baseLanes:0,cachePool:null,transitions:null},n=null!==i?i.baseLanes:o,jr(Pl,Dl),Dl|=n}else null!==i?(n=i.baseLanes|o,t.memoizedState=null):n=o,jr(Pl,Dl),Dl|=n;return xs(e,t,r,o),t.child}function Es(e,t){var o=t.ref;(null===e&&null!==o||null!==e&&e.ref!==o)&&(t.flags|=512,t.flags|=2097152)}function ks(e,t,o,n,r){var i=Pr(o)?Tr:Rr.current;return i=Dr(t,i),Oi(t,r),o=ma(e,t,o,n,i,r),n=ya(),null===e||bs?(ii&&n&&ti(t),t.flags|=1,xs(e,t,o,r),t.child):(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~r,$s(e,t,r))}function js(e,t,o,n,r){if(Pr(o)){var i=!0;Lr(t)}else i=!1;if(Oi(t,r),null===t.stateNode)Vs(e,t),as(t,o,n),ls(t,o,n,r),n=!0;else if(null===e){var a=t.stateNode,s=t.memoizedProps;a.props=s;var l=a.context,c=o.contextType;"object"===typeof c&&null!==c?c=Ti(c):c=Dr(t,c=Pr(o)?Tr:Rr.current);var d=o.getDerivedStateFromProps,u="function"===typeof d||"function"===typeof a.getSnapshotBeforeUpdate;u||"function"!==typeof a.UNSAFE_componentWillReceiveProps&&"function"!==typeof a.componentWillReceiveProps||(s!==n||l!==c)&&ss(t,a,n,c),Mi=!1;var p=t.memoizedState;a.state=p,Vi(t,n,a,r),l=t.memoizedState,s!==n||p!==l||Or.current||Mi?("function"===typeof d&&(ns(t,o,d,n),l=t.memoizedState),(s=Mi||is(t,o,s,n,p,l,c))?(u||"function"!==typeof a.UNSAFE_componentWillMount&&"function"!==typeof a.componentWillMount||("function"===typeof a.componentWillMount&&a.componentWillMount(),"function"===typeof a.UNSAFE_componentWillMount&&a.UNSAFE_componentWillMount()),"function"===typeof a.componentDidMount&&(t.flags|=4194308)):("function"===typeof a.componentDidMount&&(t.flags|=4194308),t.memoizedProps=n,t.memoizedState=l),a.props=n,a.state=l,a.context=c,n=s):("function"===typeof a.componentDidMount&&(t.flags|=4194308),n=!1)}else{a=t.stateNode,Fi(e,t),s=t.memoizedProps,c=t.type===t.elementType?s:os(t.type,s),a.props=c,u=t.pendingProps,p=a.context,"object"===typeof(l=o.contextType)&&null!==l?l=Ti(l):l=Dr(t,l=Pr(o)?Tr:Rr.current);var h=o.getDerivedStateFromProps;(d="function"===typeof h||"function"===typeof a.getSnapshotBeforeUpdate)||"function"!==typeof a.UNSAFE_componentWillReceiveProps&&"function"!==typeof a.componentWillReceiveProps||(s!==u||p!==l)&&ss(t,a,n,l),Mi=!1,p=t.memoizedState,a.state=p,Vi(t,n,a,r);var f=t.memoizedState;s!==u||p!==f||Or.current||Mi?("function"===typeof h&&(ns(t,o,h,n),f=t.memoizedState),(c=Mi||is(t,o,c,n,p,f,l)||!1)?(d||"function"!==typeof a.UNSAFE_componentWillUpdate&&"function"!==typeof a.componentWillUpdate||("function"===typeof a.componentWillUpdate&&a.componentWillUpdate(n,f,l),"function"===typeof a.UNSAFE_componentWillUpdate&&a.UNSAFE_componentWillUpdate(n,f,l)),"function"===typeof a.componentDidUpdate&&(t.flags|=4),"function"===typeof a.getSnapshotBeforeUpdate&&(t.flags|=1024)):("function"!==typeof a.componentDidUpdate||s===e.memoizedProps&&p===e.memoizedState||(t.flags|=4),"function"!==typeof a.getSnapshotBeforeUpdate||s===e.memoizedProps&&p===e.memoizedState||(t.flags|=1024),t.memoizedProps=n,t.memoizedState=f),a.props=n,a.state=f,a.context=l,n=c):("function"!==typeof a.componentDidUpdate||s===e.memoizedProps&&p===e.memoizedState||(t.flags|=4),"function"!==typeof a.getSnapshotBeforeUpdate||s===e.memoizedProps&&p===e.memoizedState||(t.flags|=1024),n=!1)}return As(e,t,o,n,i,r)}function As(e,t,o,n,r,i){Es(e,t);var a=0!==(128&t.flags);if(!n&&!a)return r&&Fr(t,o,!1),$s(e,t,i);n=t.stateNode,vs.current=t;var s=a&&"function"!==typeof o.getDerivedStateFromError?null:n.render();return t.flags|=1,null!==e&&a?(t.child=wi(t,e.child,null,i),t.child=wi(t,null,s,i)):xs(e,t,s,i),t.memoizedState=n.state,r&&Fr(t,o,!0),t.child}function Rs(e){var t=e.stateNode;t.pendingContext?Ir(0,t.pendingContext,t.pendingContext!==t.context):t.context&&Ir(0,t.context,!1),Ji(e,t.containerInfo)}function Os(e,t,o,n,r){return fi(),gi(r),t.flags|=256,xs(e,t,o,n),t.child}var Ts,Ds,Ps,Ns,Is={dehydrated:null,treeContext:null,retryLane:0};function Ms(e){return{baseLanes:e,cachePool:null,transitions:null}}function Ls(e,t,o){var n,r=t.pendingProps,a=ea.current,s=!1,l=0!==(128&t.flags);if((n=l)||(n=(null===e||null!==e.memoizedState)&&0!==(2&a)),n?(s=!0,t.flags&=-129):null!==e&&null===e.memoizedState||(a|=1),jr(ea,1&a),null===e)return di(t),null!==(e=t.memoizedState)&&null!==(e=e.dehydrated)?(0===(1&t.mode)?t.lanes=1:"$!"===e.data?t.lanes=8:t.lanes=1073741824,null):(l=r.children,e=r.fallback,s?(r=t.mode,s=t.child,l={mode:"hidden",children:l},0===(1&r)&&null!==s?(s.childLanes=0,s.pendingProps=l):s=Mc(l,r,0,null),e=Ic(e,r,o,null),s.return=t,e.return=t,s.sibling=e,t.child=s,t.child.memoizedState=Ms(o),t.memoizedState=Is,e):Fs(t,l));if(null!==(a=e.memoizedState)&&null!==(n=a.dehydrated))return function(e,t,o,n,r,a,s){if(o)return 256&t.flags?(t.flags&=-257,Gs(e,t,s,n=ds(Error(i(422))))):null!==t.memoizedState?(t.child=e.child,t.flags|=128,null):(a=n.fallback,r=t.mode,n=Mc({mode:"visible",children:n.children},r,0,null),(a=Ic(a,r,s,null)).flags|=2,n.return=t,a.return=t,n.sibling=a,t.child=n,0!==(1&t.mode)&&wi(t,e.child,null,s),t.child.memoizedState=Ms(s),t.memoizedState=Is,a);if(0===(1&t.mode))return Gs(e,t,s,null);if("$!"===r.data){if(n=r.nextSibling&&r.nextSibling.dataset)var l=n.dgst;return n=l,Gs(e,t,s,n=ds(a=Error(i(419)),n,void 0))}if(l=0!==(s&e.childLanes),bs||l){if(null!==(n=Rl)){switch(s&-s){case 4:r=2;break;case 16:r=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:r=32;break;case 536870912:r=268435456;break;default:r=0}0!==(r=0!==(r&(n.suspendedLanes|s))?0:r)&&r!==a.retryLane&&(a.retryLane=r,Ii(e,r),oc(n,e,r,-1))}return gc(),Gs(e,t,s,n=ds(Error(i(421))))}return"$?"===r.data?(t.flags|=128,t.child=e.child,t=jc.bind(null,e),r._reactRetry=t,null):(e=a.treeContext,ri=dr(r.nextSibling),ni=t,ii=!0,ai=null,null!==e&&(Kr[Yr++]=Xr,Kr[Yr++]=Qr,Kr[Yr++]=Jr,Xr=e.id,Qr=e.overflow,Jr=t),t=Fs(t,n.children),t.flags|=4096,t)}(e,t,l,r,n,a,o);if(s){s=r.fallback,l=t.mode,n=(a=e.child).sibling;var c={mode:"hidden",children:r.children};return 0===(1&l)&&t.child!==a?((r=t.child).childLanes=0,r.pendingProps=c,t.deletions=null):(r=Pc(a,c)).subtreeFlags=14680064&a.subtreeFlags,null!==n?s=Pc(n,s):(s=Ic(s,l,o,null)).flags|=2,s.return=t,r.return=t,r.sibling=s,t.child=r,r=s,s=t.child,l=null===(l=e.child.memoizedState)?Ms(o):{baseLanes:l.baseLanes|o,cachePool:null,transitions:l.transitions},s.memoizedState=l,s.childLanes=e.childLanes&~o,t.memoizedState=Is,r}return e=(s=e.child).sibling,r=Pc(s,{mode:"visible",children:r.children}),0===(1&t.mode)&&(r.lanes=o),r.return=t,r.sibling=null,null!==e&&(null===(o=t.deletions)?(t.deletions=[e],t.flags|=16):o.push(e)),t.child=r,t.memoizedState=null,r}function Fs(e,t){return(t=Mc({mode:"visible",children:t},e.mode,0,null)).return=e,e.child=t}function Gs(e,t,o,n){return null!==n&&gi(n),wi(t,e.child,null,o),(e=Fs(t,t.pendingProps.children)).flags|=2,t.memoizedState=null,e}function zs(e,t,o){e.lanes|=t;var n=e.alternate;null!==n&&(n.lanes|=t),Ri(e.return,t,o)}function Hs(e,t,o,n,r){var i=e.memoizedState;null===i?e.memoizedState={isBackwards:t,rendering:null,renderingStartTime:0,last:n,tail:o,tailMode:r}:(i.isBackwards=t,i.rendering=null,i.renderingStartTime=0,i.last=n,i.tail=o,i.tailMode=r)}function Bs(e,t,o){var n=t.pendingProps,r=n.revealOrder,i=n.tail;if(xs(e,t,n.children,o),0!==(2&(n=ea.current)))n=1&n|2,t.flags|=128;else{if(null!==e&&0!==(128&e.flags))e:for(e=t.child;null!==e;){if(13===e.tag)null!==e.memoizedState&&zs(e,o,t);else if(19===e.tag)zs(e,o,t);else if(null!==e.child){e.child.return=e,e=e.child;continue}if(e===t)break e;for(;null===e.sibling;){if(null===e.return||e.return===t)break e;e=e.return}e.sibling.return=e.return,e=e.sibling}n&=1}if(jr(ea,n),0===(1&t.mode))t.memoizedState=null;else switch(r){case"forwards":for(o=t.child,r=null;null!==o;)null!==(e=o.alternate)&&null===ta(e)&&(r=o),o=o.sibling;null===(o=r)?(r=t.child,t.child=null):(r=o.sibling,o.sibling=null),Hs(t,!1,r,o,i);break;case"backwards":for(o=null,r=t.child,t.child=null;null!==r;){if(null!==(e=r.alternate)&&null===ta(e)){t.child=r;break}e=r.sibling,r.sibling=o,o=r,r=e}Hs(t,!0,o,null,i);break;case"together":Hs(t,!1,null,null,void 0);break;default:t.memoizedState=null}return t.child}function Vs(e,t){0===(1&t.mode)&&null!==e&&(e.alternate=null,t.alternate=null,t.flags|=2)}function $s(e,t,o){if(null!==e&&(t.dependencies=e.dependencies),Ml|=t.lanes,0===(o&t.childLanes))return null;if(null!==e&&t.child!==e.child)throw Error(i(153));if(null!==t.child){for(o=Pc(e=t.child,e.pendingProps),t.child=o,o.return=t;null!==e.sibling;)e=e.sibling,(o=o.sibling=Pc(e,e.pendingProps)).return=t;o.sibling=null}return t.child}function Us(e,t){if(!ii)switch(e.tailMode){case"hidden":t=e.tail;for(var o=null;null!==t;)null!==t.alternate&&(o=t),t=t.sibling;null===o?e.tail=null:o.sibling=null;break;case"collapsed":o=e.tail;for(var n=null;null!==o;)null!==o.alternate&&(n=o),o=o.sibling;null===n?t||null===e.tail?e.tail=null:e.tail.sibling=null:n.sibling=null}}function Ws(e){var t=null!==e.alternate&&e.alternate.child===e.child,o=0,n=0;if(t)for(var r=e.child;null!==r;)o|=r.lanes|r.childLanes,n|=14680064&r.subtreeFlags,n|=14680064&r.flags,r.return=e,r=r.sibling;else for(r=e.child;null!==r;)o|=r.lanes|r.childLanes,n|=r.subtreeFlags,n|=r.flags,r.return=e,r=r.sibling;return e.subtreeFlags|=n,e.childLanes=o,t}function qs(e,t,o){var n=t.pendingProps;switch(oi(t),t.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Ws(t),null;case 1:case 17:return Pr(t.type)&&Nr(),Ws(t),null;case 3:return n=t.stateNode,Xi(),kr(Or),kr(Rr),na(),n.pendingContext&&(n.context=n.pendingContext,n.pendingContext=null),null!==e&&null!==e.child||(pi(t)?t.flags|=4:null===e||e.memoizedState.isDehydrated&&0===(256&t.flags)||(t.flags|=1024,null!==ai&&(ac(ai),ai=null))),Ds(e,t),Ws(t),null;case 5:Zi(t);var r=Yi(Ki.current);if(o=t.type,null!==e&&null!=t.stateNode)Ps(e,t,o,n,r),e.ref!==t.ref&&(t.flags|=512,t.flags|=2097152);else{if(!n){if(null===t.stateNode)throw Error(i(166));return Ws(t),null}if(e=Yi(Wi.current),pi(t)){n=t.stateNode,o=t.type;var a=t.memoizedProps;switch(n[hr]=t,n[fr]=a,e=0!==(1&t.mode),o){case"dialog":zn("cancel",n),zn("close",n);break;case"iframe":case"object":case"embed":zn("load",n);break;case"video":case"audio":for(r=0;r<Mn.length;r++)zn(Mn[r],n);break;case"source":zn("error",n);break;case"img":case"image":case"link":zn("error",n),zn("load",n);break;case"details":zn("toggle",n);break;case"input":J(n,a),zn("invalid",n);break;case"select":n._wrapperState={wasMultiple:!!a.multiple},zn("invalid",n);break;case"textarea":re(n,a),zn("invalid",n)}for(var l in ve(o,a),r=null,a)if(a.hasOwnProperty(l)){var c=a[l];"children"===l?"string"===typeof c?n.textContent!==c&&(!0!==a.suppressHydrationWarning&&Zn(n.textContent,c,e),r=["children",c]):"number"===typeof c&&n.textContent!==""+c&&(!0!==a.suppressHydrationWarning&&Zn(n.textContent,c,e),r=["children",""+c]):s.hasOwnProperty(l)&&null!=c&&"onScroll"===l&&zn("scroll",n)}switch(o){case"input":W(n),Z(n,a,!0);break;case"textarea":W(n),ae(n);break;case"select":case"option":break;default:"function"===typeof a.onClick&&(n.onclick=er)}n=r,t.updateQueue=n,null!==n&&(t.flags|=4)}else{l=9===r.nodeType?r:r.ownerDocument,"http://www.w3.org/1999/xhtml"===e&&(e=se(o)),"http://www.w3.org/1999/xhtml"===e?"script"===o?((e=l.createElement("div")).innerHTML="<script><\/script>",e=e.removeChild(e.firstChild)):"string"===typeof n.is?e=l.createElement(o,{is:n.is}):(e=l.createElement(o),"select"===o&&(l=e,n.multiple?l.multiple=!0:n.size&&(l.size=n.size))):e=l.createElementNS(e,o),e[hr]=t,e[fr]=n,Ts(e,t,!1,!1),t.stateNode=e;e:{switch(l=be(o,n),o){case"dialog":zn("cancel",e),zn("close",e),r=n;break;case"iframe":case"object":case"embed":zn("load",e),r=n;break;case"video":case"audio":for(r=0;r<Mn.length;r++)zn(Mn[r],e);r=n;break;case"source":zn("error",e),r=n;break;case"img":case"image":case"link":zn("error",e),zn("load",e),r=n;break;case"details":zn("toggle",e),r=n;break;case"input":J(e,n),r=Y(e,n),zn("invalid",e);break;case"option":default:r=n;break;case"select":e._wrapperState={wasMultiple:!!n.multiple},r=L({},n,{value:void 0}),zn("invalid",e);break;case"textarea":re(e,n),r=ne(e,n),zn("invalid",e)}for(a in ve(o,r),c=r)if(c.hasOwnProperty(a)){var d=c[a];"style"===a?me(e,d):"dangerouslySetInnerHTML"===a?null!=(d=d?d.__html:void 0)&&ue(e,d):"children"===a?"string"===typeof d?("textarea"!==o||""!==d)&&pe(e,d):"number"===typeof d&&pe(e,""+d):"suppressContentEditableWarning"!==a&&"suppressHydrationWarning"!==a&&"autoFocus"!==a&&(s.hasOwnProperty(a)?null!=d&&"onScroll"===a&&zn("scroll",e):null!=d&&b(e,a,d,l))}switch(o){case"input":W(e),Z(e,n,!1);break;case"textarea":W(e),ae(e);break;case"option":null!=n.value&&e.setAttribute("value",""+$(n.value));break;case"select":e.multiple=!!n.multiple,null!=(a=n.value)?oe(e,!!n.multiple,a,!1):null!=n.defaultValue&&oe(e,!!n.multiple,n.defaultValue,!0);break;default:"function"===typeof r.onClick&&(e.onclick=er)}switch(o){case"button":case"input":case"select":case"textarea":n=!!n.autoFocus;break e;case"img":n=!0;break e;default:n=!1}}n&&(t.flags|=4)}null!==t.ref&&(t.flags|=512,t.flags|=2097152)}return Ws(t),null;case 6:if(e&&null!=t.stateNode)Ns(e,t,e.memoizedProps,n);else{if("string"!==typeof n&&null===t.stateNode)throw Error(i(166));if(o=Yi(Ki.current),Yi(Wi.current),pi(t)){if(n=t.stateNode,o=t.memoizedProps,n[hr]=t,(a=n.nodeValue!==o)&&null!==(e=ni))switch(e.tag){case 3:Zn(n.nodeValue,o,0!==(1&e.mode));break;case 5:!0!==e.memoizedProps.suppressHydrationWarning&&Zn(n.nodeValue,o,0!==(1&e.mode))}a&&(t.flags|=4)}else(n=(9===o.nodeType?o:o.ownerDocument).createTextNode(n))[hr]=t,t.stateNode=n}return Ws(t),null;case 13:if(kr(ea),n=t.memoizedState,null===e||null!==e.memoizedState&&null!==e.memoizedState.dehydrated){if(ii&&null!==ri&&0!==(1&t.mode)&&0===(128&t.flags))hi(),fi(),t.flags|=98560,a=!1;else if(a=pi(t),null!==n&&null!==n.dehydrated){if(null===e){if(!a)throw Error(i(318));if(!(a=null!==(a=t.memoizedState)?a.dehydrated:null))throw Error(i(317));a[hr]=t}else fi(),0===(128&t.flags)&&(t.memoizedState=null),t.flags|=4;Ws(t),a=!1}else null!==ai&&(ac(ai),ai=null),a=!0;if(!a)return 65536&t.flags?t:null}return 0!==(128&t.flags)?(t.lanes=o,t):((n=null!==n)!==(null!==e&&null!==e.memoizedState)&&n&&(t.child.flags|=8192,0!==(1&t.mode)&&(null===e||0!==(1&ea.current)?0===Nl&&(Nl=3):gc())),null!==t.updateQueue&&(t.flags|=4),Ws(t),null);case 4:return Xi(),Ds(e,t),null===e&&Vn(t.stateNode.containerInfo),Ws(t),null;case 10:return Ai(t.type._context),Ws(t),null;case 19:if(kr(ea),null===(a=t.memoizedState))return Ws(t),null;if(n=0!==(128&t.flags),null===(l=a.rendering))if(n)Us(a,!1);else{if(0!==Nl||null!==e&&0!==(128&e.flags))for(e=t.child;null!==e;){if(null!==(l=ta(e))){for(t.flags|=128,Us(a,!1),null!==(n=l.updateQueue)&&(t.updateQueue=n,t.flags|=4),t.subtreeFlags=0,n=o,o=t.child;null!==o;)e=n,(a=o).flags&=14680066,null===(l=a.alternate)?(a.childLanes=0,a.lanes=e,a.child=null,a.subtreeFlags=0,a.memoizedProps=null,a.memoizedState=null,a.updateQueue=null,a.dependencies=null,a.stateNode=null):(a.childLanes=l.childLanes,a.lanes=l.lanes,a.child=l.child,a.subtreeFlags=0,a.deletions=null,a.memoizedProps=l.memoizedProps,a.memoizedState=l.memoizedState,a.updateQueue=l.updateQueue,a.type=l.type,e=l.dependencies,a.dependencies=null===e?null:{lanes:e.lanes,firstContext:e.firstContext}),o=o.sibling;return jr(ea,1&ea.current|2),t.child}e=e.sibling}null!==a.tail&&Xe()>Bl&&(t.flags|=128,n=!0,Us(a,!1),t.lanes=4194304)}else{if(!n)if(null!==(e=ta(l))){if(t.flags|=128,n=!0,null!==(o=e.updateQueue)&&(t.updateQueue=o,t.flags|=4),Us(a,!0),null===a.tail&&"hidden"===a.tailMode&&!l.alternate&&!ii)return Ws(t),null}else 2*Xe()-a.renderingStartTime>Bl&&1073741824!==o&&(t.flags|=128,n=!0,Us(a,!1),t.lanes=4194304);a.isBackwards?(l.sibling=t.child,t.child=l):(null!==(o=a.last)?o.sibling=l:t.child=l,a.last=l)}return null!==a.tail?(t=a.tail,a.rendering=t,a.tail=t.sibling,a.renderingStartTime=Xe(),t.sibling=null,o=ea.current,jr(ea,n?1&o|2:1&o),t):(Ws(t),null);case 22:case 23:return uc(),n=null!==t.memoizedState,null!==e&&null!==e.memoizedState!==n&&(t.flags|=8192),n&&0!==(1&t.mode)?0!==(1073741824&Dl)&&(Ws(t),6&t.subtreeFlags&&(t.flags|=8192)):Ws(t),null;case 24:case 25:return null}throw Error(i(156,t.tag))}function Ks(e,t){switch(oi(t),t.tag){case 1:return Pr(t.type)&&Nr(),65536&(e=t.flags)?(t.flags=-65537&e|128,t):null;case 3:return Xi(),kr(Or),kr(Rr),na(),0!==(65536&(e=t.flags))&&0===(128&e)?(t.flags=-65537&e|128,t):null;case 5:return Zi(t),null;case 13:if(kr(ea),null!==(e=t.memoizedState)&&null!==e.dehydrated){if(null===t.alternate)throw Error(i(340));fi()}return 65536&(e=t.flags)?(t.flags=-65537&e|128,t):null;case 19:return kr(ea),null;case 4:return Xi(),null;case 10:return Ai(t.type._context),null;case 22:case 23:return uc(),null;default:return null}}Ts=function(e,t){for(var o=t.child;null!==o;){if(5===o.tag||6===o.tag)e.appendChild(o.stateNode);else if(4!==o.tag&&null!==o.child){o.child.return=o,o=o.child;continue}if(o===t)break;for(;null===o.sibling;){if(null===o.return||o.return===t)return;o=o.return}o.sibling.return=o.return,o=o.sibling}},Ds=function(){},Ps=function(e,t,o,n){var r=e.memoizedProps;if(r!==n){e=t.stateNode,Yi(Wi.current);var i,a=null;switch(o){case"input":r=Y(e,r),n=Y(e,n),a=[];break;case"select":r=L({},r,{value:void 0}),n=L({},n,{value:void 0}),a=[];break;case"textarea":r=ne(e,r),n=ne(e,n),a=[];break;default:"function"!==typeof r.onClick&&"function"===typeof n.onClick&&(e.onclick=er)}for(d in ve(o,n),o=null,r)if(!n.hasOwnProperty(d)&&r.hasOwnProperty(d)&&null!=r[d])if("style"===d){var l=r[d];for(i in l)l.hasOwnProperty(i)&&(o||(o={}),o[i]="")}else"dangerouslySetInnerHTML"!==d&&"children"!==d&&"suppressContentEditableWarning"!==d&&"suppressHydrationWarning"!==d&&"autoFocus"!==d&&(s.hasOwnProperty(d)?a||(a=[]):(a=a||[]).push(d,null));for(d in n){var c=n[d];if(l=null!=r?r[d]:void 0,n.hasOwnProperty(d)&&c!==l&&(null!=c||null!=l))if("style"===d)if(l){for(i in l)!l.hasOwnProperty(i)||c&&c.hasOwnProperty(i)||(o||(o={}),o[i]="");for(i in c)c.hasOwnProperty(i)&&l[i]!==c[i]&&(o||(o={}),o[i]=c[i])}else o||(a||(a=[]),a.push(d,o)),o=c;else"dangerouslySetInnerHTML"===d?(c=c?c.__html:void 0,l=l?l.__html:void 0,null!=c&&l!==c&&(a=a||[]).push(d,c)):"children"===d?"string"!==typeof c&&"number"!==typeof c||(a=a||[]).push(d,""+c):"suppressContentEditableWarning"!==d&&"suppressHydrationWarning"!==d&&(s.hasOwnProperty(d)?(null!=c&&"onScroll"===d&&zn("scroll",e),a||l===c||(a=[])):(a=a||[]).push(d,c))}o&&(a=a||[]).push("style",o);var d=a;(t.updateQueue=d)&&(t.flags|=4)}},Ns=function(e,t,o,n){o!==n&&(t.flags|=4)};var Ys=!1,Js=!1,Xs="function"===typeof WeakSet?WeakSet:Set,Qs=null;function Zs(e,t){var o=e.ref;if(null!==o)if("function"===typeof o)try{o(null)}catch(n){Sc(e,t,n)}else o.current=null}function el(e,t,o){try{o()}catch(n){Sc(e,t,n)}}var tl=!1;function ol(e,t,o){var n=t.updateQueue;if(null!==(n=null!==n?n.lastEffect:null)){var r=n=n.next;do{if((r.tag&e)===e){var i=r.destroy;r.destroy=void 0,void 0!==i&&el(t,o,i)}r=r.next}while(r!==n)}}function nl(e,t){if(null!==(t=null!==(t=t.updateQueue)?t.lastEffect:null)){var o=t=t.next;do{if((o.tag&e)===e){var n=o.create;o.destroy=n()}o=o.next}while(o!==t)}}function rl(e){var t=e.ref;if(null!==t){var o=e.stateNode;e.tag,e=o,"function"===typeof t?t(e):t.current=e}}function il(e){var t=e.alternate;null!==t&&(e.alternate=null,il(t)),e.child=null,e.deletions=null,e.sibling=null,5===e.tag&&(null!==(t=e.stateNode)&&(delete t[hr],delete t[fr],delete t[mr],delete t[yr],delete t[vr])),e.stateNode=null,e.return=null,e.dependencies=null,e.memoizedProps=null,e.memoizedState=null,e.pendingProps=null,e.stateNode=null,e.updateQueue=null}function al(e){return 5===e.tag||3===e.tag||4===e.tag}function sl(e){e:for(;;){for(;null===e.sibling;){if(null===e.return||al(e.return))return null;e=e.return}for(e.sibling.return=e.return,e=e.sibling;5!==e.tag&&6!==e.tag&&18!==e.tag;){if(2&e.flags)continue e;if(null===e.child||4===e.tag)continue e;e.child.return=e,e=e.child}if(!(2&e.flags))return e.stateNode}}function ll(e,t,o){var n=e.tag;if(5===n||6===n)e=e.stateNode,t?8===o.nodeType?o.parentNode.insertBefore(e,t):o.insertBefore(e,t):(8===o.nodeType?(t=o.parentNode).insertBefore(e,o):(t=o).appendChild(e),null!==(o=o._reactRootContainer)&&void 0!==o||null!==t.onclick||(t.onclick=er));else if(4!==n&&null!==(e=e.child))for(ll(e,t,o),e=e.sibling;null!==e;)ll(e,t,o),e=e.sibling}function cl(e,t,o){var n=e.tag;if(5===n||6===n)e=e.stateNode,t?o.insertBefore(e,t):o.appendChild(e);else if(4!==n&&null!==(e=e.child))for(cl(e,t,o),e=e.sibling;null!==e;)cl(e,t,o),e=e.sibling}var dl=null,ul=!1;function pl(e,t,o){for(o=o.child;null!==o;)hl(e,t,o),o=o.sibling}function hl(e,t,o){if(it&&"function"===typeof it.onCommitFiberUnmount)try{it.onCommitFiberUnmount(rt,o)}catch(s){}switch(o.tag){case 5:Js||Zs(o,t);case 6:var n=dl,r=ul;dl=null,pl(e,t,o),ul=r,null!==(dl=n)&&(ul?(e=dl,o=o.stateNode,8===e.nodeType?e.parentNode.removeChild(o):e.removeChild(o)):dl.removeChild(o.stateNode));break;case 18:null!==dl&&(ul?(e=dl,o=o.stateNode,8===e.nodeType?cr(e.parentNode,o):1===e.nodeType&&cr(e,o),Bt(e)):cr(dl,o.stateNode));break;case 4:n=dl,r=ul,dl=o.stateNode.containerInfo,ul=!0,pl(e,t,o),dl=n,ul=r;break;case 0:case 11:case 14:case 15:if(!Js&&(null!==(n=o.updateQueue)&&null!==(n=n.lastEffect))){r=n=n.next;do{var i=r,a=i.destroy;i=i.tag,void 0!==a&&(0!==(2&i)||0!==(4&i))&&el(o,t,a),r=r.next}while(r!==n)}pl(e,t,o);break;case 1:if(!Js&&(Zs(o,t),"function"===typeof(n=o.stateNode).componentWillUnmount))try{n.props=o.memoizedProps,n.state=o.memoizedState,n.componentWillUnmount()}catch(s){Sc(o,t,s)}pl(e,t,o);break;case 21:pl(e,t,o);break;case 22:1&o.mode?(Js=(n=Js)||null!==o.memoizedState,pl(e,t,o),Js=n):pl(e,t,o);break;default:pl(e,t,o)}}function fl(e){var t=e.updateQueue;if(null!==t){e.updateQueue=null;var o=e.stateNode;null===o&&(o=e.stateNode=new Xs),t.forEach((function(t){var n=Ac.bind(null,e,t);o.has(t)||(o.add(t),t.then(n,n))}))}}function gl(e,t){var o=t.deletions;if(null!==o)for(var n=0;n<o.length;n++){var r=o[n];try{var a=e,s=t,l=s;e:for(;null!==l;){switch(l.tag){case 5:dl=l.stateNode,ul=!1;break e;case 3:case 4:dl=l.stateNode.containerInfo,ul=!0;break e}l=l.return}if(null===dl)throw Error(i(160));hl(a,s,r),dl=null,ul=!1;var c=r.alternate;null!==c&&(c.return=null),r.return=null}catch(d){Sc(r,t,d)}}if(12854&t.subtreeFlags)for(t=t.child;null!==t;)ml(t,e),t=t.sibling}function ml(e,t){var o=e.alternate,n=e.flags;switch(e.tag){case 0:case 11:case 14:case 15:if(gl(t,e),yl(e),4&n){try{ol(3,e,e.return),nl(3,e)}catch(m){Sc(e,e.return,m)}try{ol(5,e,e.return)}catch(m){Sc(e,e.return,m)}}break;case 1:gl(t,e),yl(e),512&n&&null!==o&&Zs(o,o.return);break;case 5:if(gl(t,e),yl(e),512&n&&null!==o&&Zs(o,o.return),32&e.flags){var r=e.stateNode;try{pe(r,"")}catch(m){Sc(e,e.return,m)}}if(4&n&&null!=(r=e.stateNode)){var a=e.memoizedProps,s=null!==o?o.memoizedProps:a,l=e.type,c=e.updateQueue;if(e.updateQueue=null,null!==c)try{"input"===l&&"radio"===a.type&&null!=a.name&&X(r,a),be(l,s);var d=be(l,a);for(s=0;s<c.length;s+=2){var u=c[s],p=c[s+1];"style"===u?me(r,p):"dangerouslySetInnerHTML"===u?ue(r,p):"children"===u?pe(r,p):b(r,u,p,d)}switch(l){case"input":Q(r,a);break;case"textarea":ie(r,a);break;case"select":var h=r._wrapperState.wasMultiple;r._wrapperState.wasMultiple=!!a.multiple;var f=a.value;null!=f?oe(r,!!a.multiple,f,!1):h!==!!a.multiple&&(null!=a.defaultValue?oe(r,!!a.multiple,a.defaultValue,!0):oe(r,!!a.multiple,a.multiple?[]:"",!1))}r[fr]=a}catch(m){Sc(e,e.return,m)}}break;case 6:if(gl(t,e),yl(e),4&n){if(null===e.stateNode)throw Error(i(162));r=e.stateNode,a=e.memoizedProps;try{r.nodeValue=a}catch(m){Sc(e,e.return,m)}}break;case 3:if(gl(t,e),yl(e),4&n&&null!==o&&o.memoizedState.isDehydrated)try{Bt(t.containerInfo)}catch(m){Sc(e,e.return,m)}break;case 4:default:gl(t,e),yl(e);break;case 13:gl(t,e),yl(e),8192&(r=e.child).flags&&(a=null!==r.memoizedState,r.stateNode.isHidden=a,!a||null!==r.alternate&&null!==r.alternate.memoizedState||(Hl=Xe())),4&n&&fl(e);break;case 22:if(u=null!==o&&null!==o.memoizedState,1&e.mode?(Js=(d=Js)||u,gl(t,e),Js=d):gl(t,e),yl(e),8192&n){if(d=null!==e.memoizedState,(e.stateNode.isHidden=d)&&!u&&0!==(1&e.mode))for(Qs=e,u=e.child;null!==u;){for(p=Qs=u;null!==Qs;){switch(f=(h=Qs).child,h.tag){case 0:case 11:case 14:case 15:ol(4,h,h.return);break;case 1:Zs(h,h.return);var g=h.stateNode;if("function"===typeof g.componentWillUnmount){n=h,o=h.return;try{t=n,g.props=t.memoizedProps,g.state=t.memoizedState,g.componentWillUnmount()}catch(m){Sc(n,o,m)}}break;case 5:Zs(h,h.return);break;case 22:if(null!==h.memoizedState){wl(p);continue}}null!==f?(f.return=h,Qs=f):wl(p)}u=u.sibling}e:for(u=null,p=e;;){if(5===p.tag){if(null===u){u=p;try{r=p.stateNode,d?"function"===typeof(a=r.style).setProperty?a.setProperty("display","none","important"):a.display="none":(l=p.stateNode,s=void 0!==(c=p.memoizedProps.style)&&null!==c&&c.hasOwnProperty("display")?c.display:null,l.style.display=ge("display",s))}catch(m){Sc(e,e.return,m)}}}else if(6===p.tag){if(null===u)try{p.stateNode.nodeValue=d?"":p.memoizedProps}catch(m){Sc(e,e.return,m)}}else if((22!==p.tag&&23!==p.tag||null===p.memoizedState||p===e)&&null!==p.child){p.child.return=p,p=p.child;continue}if(p===e)break e;for(;null===p.sibling;){if(null===p.return||p.return===e)break e;u===p&&(u=null),p=p.return}u===p&&(u=null),p.sibling.return=p.return,p=p.sibling}}break;case 19:gl(t,e),yl(e),4&n&&fl(e);case 21:}}function yl(e){var t=e.flags;if(2&t){try{e:{for(var o=e.return;null!==o;){if(al(o)){var n=o;break e}o=o.return}throw Error(i(160))}switch(n.tag){case 5:var r=n.stateNode;32&n.flags&&(pe(r,""),n.flags&=-33),cl(e,sl(e),r);break;case 3:case 4:var a=n.stateNode.containerInfo;ll(e,sl(e),a);break;default:throw Error(i(161))}}catch(s){Sc(e,e.return,s)}e.flags&=-3}4096&t&&(e.flags&=-4097)}function vl(e,t,o){Qs=e,bl(e,t,o)}function bl(e,t,o){for(var n=0!==(1&e.mode);null!==Qs;){var r=Qs,i=r.child;if(22===r.tag&&n){var a=null!==r.memoizedState||Ys;if(!a){var s=r.alternate,l=null!==s&&null!==s.memoizedState||Js;s=Ys;var c=Js;if(Ys=a,(Js=l)&&!c)for(Qs=r;null!==Qs;)l=(a=Qs).child,22===a.tag&&null!==a.memoizedState?Cl(r):null!==l?(l.return=a,Qs=l):Cl(r);for(;null!==i;)Qs=i,bl(i,t,o),i=i.sibling;Qs=r,Ys=s,Js=c}xl(e)}else 0!==(8772&r.subtreeFlags)&&null!==i?(i.return=r,Qs=i):xl(e)}}function xl(e){for(;null!==Qs;){var t=Qs;if(0!==(8772&t.flags)){var o=t.alternate;try{if(0!==(8772&t.flags))switch(t.tag){case 0:case 11:case 15:Js||nl(5,t);break;case 1:var n=t.stateNode;if(4&t.flags&&!Js)if(null===o)n.componentDidMount();else{var r=t.elementType===t.type?o.memoizedProps:os(t.type,o.memoizedProps);n.componentDidUpdate(r,o.memoizedState,n.__reactInternalSnapshotBeforeUpdate)}var a=t.updateQueue;null!==a&&$i(t,a,n);break;case 3:var s=t.updateQueue;if(null!==s){if(o=null,null!==t.child)switch(t.child.tag){case 5:case 1:o=t.child.stateNode}$i(t,s,o)}break;case 5:var l=t.stateNode;if(null===o&&4&t.flags){o=l;var c=t.memoizedProps;switch(t.type){case"button":case"input":case"select":case"textarea":c.autoFocus&&o.focus();break;case"img":c.src&&(o.src=c.src)}}break;case 6:case 4:case 12:case 19:case 17:case 21:case 22:case 23:case 25:break;case 13:if(null===t.memoizedState){var d=t.alternate;if(null!==d){var u=d.memoizedState;if(null!==u){var p=u.dehydrated;null!==p&&Bt(p)}}}break;default:throw Error(i(163))}Js||512&t.flags&&rl(t)}catch(h){Sc(t,t.return,h)}}if(t===e){Qs=null;break}if(null!==(o=t.sibling)){o.return=t.return,Qs=o;break}Qs=t.return}}function wl(e){for(;null!==Qs;){var t=Qs;if(t===e){Qs=null;break}var o=t.sibling;if(null!==o){o.return=t.return,Qs=o;break}Qs=t.return}}function Cl(e){for(;null!==Qs;){var t=Qs;try{switch(t.tag){case 0:case 11:case 15:var o=t.return;try{nl(4,t)}catch(l){Sc(t,o,l)}break;case 1:var n=t.stateNode;if("function"===typeof n.componentDidMount){var r=t.return;try{n.componentDidMount()}catch(l){Sc(t,r,l)}}var i=t.return;try{rl(t)}catch(l){Sc(t,i,l)}break;case 5:var a=t.return;try{rl(t)}catch(l){Sc(t,a,l)}}}catch(l){Sc(t,t.return,l)}if(t===e){Qs=null;break}var s=t.sibling;if(null!==s){s.return=t.return,Qs=s;break}Qs=t.return}}var _l,Sl=Math.ceil,El=x.ReactCurrentDispatcher,kl=x.ReactCurrentOwner,jl=x.ReactCurrentBatchConfig,Al=0,Rl=null,Ol=null,Tl=0,Dl=0,Pl=Er(0),Nl=0,Il=null,Ml=0,Ll=0,Fl=0,Gl=null,zl=null,Hl=0,Bl=1/0,Vl=null,$l=!1,Ul=null,Wl=null,ql=!1,Kl=null,Yl=0,Jl=0,Xl=null,Ql=-1,Zl=0;function ec(){return 0!==(6&Al)?Xe():-1!==Ql?Ql:Ql=Xe()}function tc(e){return 0===(1&e.mode)?1:0!==(2&Al)&&0!==Tl?Tl&-Tl:null!==mi.transition?(0===Zl&&(Zl=gt()),Zl):0!==(e=bt)?e:e=void 0===(e=window.event)?16:Jt(e.type)}function oc(e,t,o,n){if(50<Jl)throw Jl=0,Xl=null,Error(i(185));yt(e,o,n),0!==(2&Al)&&e===Rl||(e===Rl&&(0===(2&Al)&&(Ll|=o),4===Nl&&sc(e,Tl)),nc(e,n),1===o&&0===Al&&0===(1&t.mode)&&(Bl=Xe()+500,zr&&Vr()))}function nc(e,t){var o=e.callbackNode;!function(e,t){for(var o=e.suspendedLanes,n=e.pingedLanes,r=e.expirationTimes,i=e.pendingLanes;0<i;){var a=31-at(i),s=1<<a,l=r[a];-1===l?0!==(s&o)&&0===(s&n)||(r[a]=ht(s,t)):l<=t&&(e.expiredLanes|=s),i&=~s}}(e,t);var n=pt(e,e===Rl?Tl:0);if(0===n)null!==o&&Ke(o),e.callbackNode=null,e.callbackPriority=0;else if(t=n&-n,e.callbackPriority!==t){if(null!=o&&Ke(o),1===t)0===e.tag?function(e){zr=!0,Br(e)}(lc.bind(null,e)):Br(lc.bind(null,e)),sr((function(){0===(6&Al)&&Vr()})),o=null;else{switch(xt(n)){case 1:o=Ze;break;case 4:o=et;break;case 16:default:o=tt;break;case 536870912:o=nt}o=Rc(o,rc.bind(null,e))}e.callbackPriority=t,e.callbackNode=o}}function rc(e,t){if(Ql=-1,Zl=0,0!==(6&Al))throw Error(i(327));var o=e.callbackNode;if(Cc()&&e.callbackNode!==o)return null;var n=pt(e,e===Rl?Tl:0);if(0===n)return null;if(0!==(30&n)||0!==(n&e.expiredLanes)||t)t=mc(e,n);else{t=n;var r=Al;Al|=2;var a=fc();for(Rl===e&&Tl===t||(Vl=null,Bl=Xe()+500,pc(e,t));;)try{vc();break}catch(l){hc(e,l)}ji(),El.current=a,Al=r,null!==Ol?t=0:(Rl=null,Tl=0,t=Nl)}if(0!==t){if(2===t&&(0!==(r=ft(e))&&(n=r,t=ic(e,r))),1===t)throw o=Il,pc(e,0),sc(e,n),nc(e,Xe()),o;if(6===t)sc(e,n);else{if(r=e.current.alternate,0===(30&n)&&!function(e){for(var t=e;;){if(16384&t.flags){var o=t.updateQueue;if(null!==o&&null!==(o=o.stores))for(var n=0;n<o.length;n++){var r=o[n],i=r.getSnapshot;r=r.value;try{if(!ln(i(),r))return!1}catch(s){return!1}}}if(o=t.child,16384&t.subtreeFlags&&null!==o)o.return=t,t=o;else{if(t===e)break;for(;null===t.sibling;){if(null===t.return||t.return===e)return!0;t=t.return}t.sibling.return=t.return,t=t.sibling}}return!0}(r)&&(2===(t=mc(e,n))&&(0!==(a=ft(e))&&(n=a,t=ic(e,a))),1===t))throw o=Il,pc(e,0),sc(e,n),nc(e,Xe()),o;switch(e.finishedWork=r,e.finishedLanes=n,t){case 0:case 1:throw Error(i(345));case 2:case 5:wc(e,zl,Vl);break;case 3:if(sc(e,n),(130023424&n)===n&&10<(t=Hl+500-Xe())){if(0!==pt(e,0))break;if(((r=e.suspendedLanes)&n)!==n){ec(),e.pingedLanes|=e.suspendedLanes&r;break}e.timeoutHandle=rr(wc.bind(null,e,zl,Vl),t);break}wc(e,zl,Vl);break;case 4:if(sc(e,n),(4194240&n)===n)break;for(t=e.eventTimes,r=-1;0<n;){var s=31-at(n);a=1<<s,(s=t[s])>r&&(r=s),n&=~a}if(n=r,10<(n=(120>(n=Xe()-n)?120:480>n?480:1080>n?1080:1920>n?1920:3e3>n?3e3:4320>n?4320:1960*Sl(n/1960))-n)){e.timeoutHandle=rr(wc.bind(null,e,zl,Vl),n);break}wc(e,zl,Vl);break;default:throw Error(i(329))}}}return nc(e,Xe()),e.callbackNode===o?rc.bind(null,e):null}function ic(e,t){var o=Gl;return e.current.memoizedState.isDehydrated&&(pc(e,t).flags|=256),2!==(e=mc(e,t))&&(t=zl,zl=o,null!==t&&ac(t)),e}function ac(e){null===zl?zl=e:zl.push.apply(zl,e)}function sc(e,t){for(t&=~Fl,t&=~Ll,e.suspendedLanes|=t,e.pingedLanes&=~t,e=e.expirationTimes;0<t;){var o=31-at(t),n=1<<o;e[o]=-1,t&=~n}}function lc(e){if(0!==(6&Al))throw Error(i(327));Cc();var t=pt(e,0);if(0===(1&t))return nc(e,Xe()),null;var o=mc(e,t);if(0!==e.tag&&2===o){var n=ft(e);0!==n&&(t=n,o=ic(e,n))}if(1===o)throw o=Il,pc(e,0),sc(e,t),nc(e,Xe()),o;if(6===o)throw Error(i(345));return e.finishedWork=e.current.alternate,e.finishedLanes=t,wc(e,zl,Vl),nc(e,Xe()),null}function cc(e,t){var o=Al;Al|=1;try{return e(t)}finally{0===(Al=o)&&(Bl=Xe()+500,zr&&Vr())}}function dc(e){null!==Kl&&0===Kl.tag&&0===(6&Al)&&Cc();var t=Al;Al|=1;var o=jl.transition,n=bt;try{if(jl.transition=null,bt=1,e)return e()}finally{bt=n,jl.transition=o,0===(6&(Al=t))&&Vr()}}function uc(){Dl=Pl.current,kr(Pl)}function pc(e,t){e.finishedWork=null,e.finishedLanes=0;var o=e.timeoutHandle;if(-1!==o&&(e.timeoutHandle=-1,ir(o)),null!==Ol)for(o=Ol.return;null!==o;){var n=o;switch(oi(n),n.tag){case 1:null!==(n=n.type.childContextTypes)&&void 0!==n&&Nr();break;case 3:Xi(),kr(Or),kr(Rr),na();break;case 5:Zi(n);break;case 4:Xi();break;case 13:case 19:kr(ea);break;case 10:Ai(n.type._context);break;case 22:case 23:uc()}o=o.return}if(Rl=e,Ol=e=Pc(e.current,null),Tl=Dl=t,Nl=0,Il=null,Fl=Ll=Ml=0,zl=Gl=null,null!==Di){for(t=0;t<Di.length;t++)if(null!==(n=(o=Di[t]).interleaved)){o.interleaved=null;var r=n.next,i=o.pending;if(null!==i){var a=i.next;i.next=r,n.next=a}o.pending=n}Di=null}return e}function hc(e,t){for(;;){var o=Ol;try{if(ji(),ra.current=Qa,da){for(var n=sa.memoizedState;null!==n;){var r=n.queue;null!==r&&(r.pending=null),n=n.next}da=!1}if(aa=0,ca=la=sa=null,ua=!1,pa=0,kl.current=null,null===o||null===o.return){Nl=1,Il=t,Ol=null;break}e:{var a=e,s=o.return,l=o,c=t;if(t=Tl,l.flags|=32768,null!==c&&"object"===typeof c&&"function"===typeof c.then){var d=c,u=l,p=u.tag;if(0===(1&u.mode)&&(0===p||11===p||15===p)){var h=u.alternate;h?(u.updateQueue=h.updateQueue,u.memoizedState=h.memoizedState,u.lanes=h.lanes):(u.updateQueue=null,u.memoizedState=null)}var f=ms(s);if(null!==f){f.flags&=-257,ys(f,s,l,0,t),1&f.mode&&gs(a,d,t),c=d;var g=(t=f).updateQueue;if(null===g){var m=new Set;m.add(c),t.updateQueue=m}else g.add(c);break e}if(0===(1&t)){gs(a,d,t),gc();break e}c=Error(i(426))}else if(ii&&1&l.mode){var y=ms(s);if(null!==y){0===(65536&y.flags)&&(y.flags|=256),ys(y,s,l,0,t),gi(cs(c,l));break e}}a=c=cs(c,l),4!==Nl&&(Nl=2),null===Gl?Gl=[a]:Gl.push(a),a=s;do{switch(a.tag){case 3:a.flags|=65536,t&=-t,a.lanes|=t,Bi(a,hs(0,c,t));break e;case 1:l=c;var v=a.type,b=a.stateNode;if(0===(128&a.flags)&&("function"===typeof v.getDerivedStateFromError||null!==b&&"function"===typeof b.componentDidCatch&&(null===Wl||!Wl.has(b)))){a.flags|=65536,t&=-t,a.lanes|=t,Bi(a,fs(a,l,t));break e}}a=a.return}while(null!==a)}xc(o)}catch(x){t=x,Ol===o&&null!==o&&(Ol=o=o.return);continue}break}}function fc(){var e=El.current;return El.current=Qa,null===e?Qa:e}function gc(){0!==Nl&&3!==Nl&&2!==Nl||(Nl=4),null===Rl||0===(268435455&Ml)&&0===(268435455&Ll)||sc(Rl,Tl)}function mc(e,t){var o=Al;Al|=2;var n=fc();for(Rl===e&&Tl===t||(Vl=null,pc(e,t));;)try{yc();break}catch(r){hc(e,r)}if(ji(),Al=o,El.current=n,null!==Ol)throw Error(i(261));return Rl=null,Tl=0,Nl}function yc(){for(;null!==Ol;)bc(Ol)}function vc(){for(;null!==Ol&&!Ye();)bc(Ol)}function bc(e){var t=_l(e.alternate,e,Dl);e.memoizedProps=e.pendingProps,null===t?xc(e):Ol=t,kl.current=null}function xc(e){var t=e;do{var o=t.alternate;if(e=t.return,0===(32768&t.flags)){if(null!==(o=qs(o,t,Dl)))return void(Ol=o)}else{if(null!==(o=Ks(o,t)))return o.flags&=32767,void(Ol=o);if(null===e)return Nl=6,void(Ol=null);e.flags|=32768,e.subtreeFlags=0,e.deletions=null}if(null!==(t=t.sibling))return void(Ol=t);Ol=t=e}while(null!==t);0===Nl&&(Nl=5)}function wc(e,t,o){var n=bt,r=jl.transition;try{jl.transition=null,bt=1,function(e,t,o,n){do{Cc()}while(null!==Kl);if(0!==(6&Al))throw Error(i(327));o=e.finishedWork;var r=e.finishedLanes;if(null===o)return null;if(e.finishedWork=null,e.finishedLanes=0,o===e.current)throw Error(i(177));e.callbackNode=null,e.callbackPriority=0;var a=o.lanes|o.childLanes;if(function(e,t){var o=e.pendingLanes&~t;e.pendingLanes=t,e.suspendedLanes=0,e.pingedLanes=0,e.expiredLanes&=t,e.mutableReadLanes&=t,e.entangledLanes&=t,t=e.entanglements;var n=e.eventTimes;for(e=e.expirationTimes;0<o;){var r=31-at(o),i=1<<r;t[r]=0,n[r]=-1,e[r]=-1,o&=~i}}(e,a),e===Rl&&(Ol=Rl=null,Tl=0),0===(2064&o.subtreeFlags)&&0===(2064&o.flags)||ql||(ql=!0,Rc(tt,(function(){return Cc(),null}))),a=0!==(15990&o.flags),0!==(15990&o.subtreeFlags)||a){a=jl.transition,jl.transition=null;var s=bt;bt=1;var l=Al;Al|=4,kl.current=null,function(e,t){if(tr=$t,fn(e=hn())){if("selectionStart"in e)var o={start:e.selectionStart,end:e.selectionEnd};else e:{var n=(o=(o=e.ownerDocument)&&o.defaultView||window).getSelection&&o.getSelection();if(n&&0!==n.rangeCount){o=n.anchorNode;var r=n.anchorOffset,a=n.focusNode;n=n.focusOffset;try{o.nodeType,a.nodeType}catch(w){o=null;break e}var s=0,l=-1,c=-1,d=0,u=0,p=e,h=null;t:for(;;){for(var f;p!==o||0!==r&&3!==p.nodeType||(l=s+r),p!==a||0!==n&&3!==p.nodeType||(c=s+n),3===p.nodeType&&(s+=p.nodeValue.length),null!==(f=p.firstChild);)h=p,p=f;for(;;){if(p===e)break t;if(h===o&&++d===r&&(l=s),h===a&&++u===n&&(c=s),null!==(f=p.nextSibling))break;h=(p=h).parentNode}p=f}o=-1===l||-1===c?null:{start:l,end:c}}else o=null}o=o||{start:0,end:0}}else o=null;for(or={focusedElem:e,selectionRange:o},$t=!1,Qs=t;null!==Qs;)if(e=(t=Qs).child,0!==(1028&t.subtreeFlags)&&null!==e)e.return=t,Qs=e;else for(;null!==Qs;){t=Qs;try{var g=t.alternate;if(0!==(1024&t.flags))switch(t.tag){case 0:case 11:case 15:case 5:case 6:case 4:case 17:break;case 1:if(null!==g){var m=g.memoizedProps,y=g.memoizedState,v=t.stateNode,b=v.getSnapshotBeforeUpdate(t.elementType===t.type?m:os(t.type,m),y);v.__reactInternalSnapshotBeforeUpdate=b}break;case 3:var x=t.stateNode.containerInfo;1===x.nodeType?x.textContent="":9===x.nodeType&&x.documentElement&&x.removeChild(x.documentElement);break;default:throw Error(i(163))}}catch(w){Sc(t,t.return,w)}if(null!==(e=t.sibling)){e.return=t.return,Qs=e;break}Qs=t.return}g=tl,tl=!1}(e,o),ml(o,e),gn(or),$t=!!tr,or=tr=null,e.current=o,vl(o,e,r),Je(),Al=l,bt=s,jl.transition=a}else e.current=o;if(ql&&(ql=!1,Kl=e,Yl=r),a=e.pendingLanes,0===a&&(Wl=null),function(e){if(it&&"function"===typeof it.onCommitFiberRoot)try{it.onCommitFiberRoot(rt,e,void 0,128===(128&e.current.flags))}catch(t){}}(o.stateNode),nc(e,Xe()),null!==t)for(n=e.onRecoverableError,o=0;o<t.length;o++)r=t[o],n(r.value,{componentStack:r.stack,digest:r.digest});if($l)throw $l=!1,e=Ul,Ul=null,e;0!==(1&Yl)&&0!==e.tag&&Cc(),a=e.pendingLanes,0!==(1&a)?e===Xl?Jl++:(Jl=0,Xl=e):Jl=0,Vr()}(e,t,o,n)}finally{jl.transition=r,bt=n}return null}function Cc(){if(null!==Kl){var e=xt(Yl),t=jl.transition,o=bt;try{if(jl.transition=null,bt=16>e?16:e,null===Kl)var n=!1;else{if(e=Kl,Kl=null,Yl=0,0!==(6&Al))throw Error(i(331));var r=Al;for(Al|=4,Qs=e.current;null!==Qs;){var a=Qs,s=a.child;if(0!==(16&Qs.flags)){var l=a.deletions;if(null!==l){for(var c=0;c<l.length;c++){var d=l[c];for(Qs=d;null!==Qs;){var u=Qs;switch(u.tag){case 0:case 11:case 15:ol(8,u,a)}var p=u.child;if(null!==p)p.return=u,Qs=p;else for(;null!==Qs;){var h=(u=Qs).sibling,f=u.return;if(il(u),u===d){Qs=null;break}if(null!==h){h.return=f,Qs=h;break}Qs=f}}}var g=a.alternate;if(null!==g){var m=g.child;if(null!==m){g.child=null;do{var y=m.sibling;m.sibling=null,m=y}while(null!==m)}}Qs=a}}if(0!==(2064&a.subtreeFlags)&&null!==s)s.return=a,Qs=s;else e:for(;null!==Qs;){if(0!==(2048&(a=Qs).flags))switch(a.tag){case 0:case 11:case 15:ol(9,a,a.return)}var v=a.sibling;if(null!==v){v.return=a.return,Qs=v;break e}Qs=a.return}}var b=e.current;for(Qs=b;null!==Qs;){var x=(s=Qs).child;if(0!==(2064&s.subtreeFlags)&&null!==x)x.return=s,Qs=x;else e:for(s=b;null!==Qs;){if(0!==(2048&(l=Qs).flags))try{switch(l.tag){case 0:case 11:case 15:nl(9,l)}}catch(C){Sc(l,l.return,C)}if(l===s){Qs=null;break e}var w=l.sibling;if(null!==w){w.return=l.return,Qs=w;break e}Qs=l.return}}if(Al=r,Vr(),it&&"function"===typeof it.onPostCommitFiberRoot)try{it.onPostCommitFiberRoot(rt,e)}catch(C){}n=!0}return n}finally{bt=o,jl.transition=t}}return!1}function _c(e,t,o){e=zi(e,t=hs(0,t=cs(o,t),1),1),t=ec(),null!==e&&(yt(e,1,t),nc(e,t))}function Sc(e,t,o){if(3===e.tag)_c(e,e,o);else for(;null!==t;){if(3===t.tag){_c(t,e,o);break}if(1===t.tag){var n=t.stateNode;if("function"===typeof t.type.getDerivedStateFromError||"function"===typeof n.componentDidCatch&&(null===Wl||!Wl.has(n))){t=zi(t,e=fs(t,e=cs(o,e),1),1),e=ec(),null!==t&&(yt(t,1,e),nc(t,e));break}}t=t.return}}function Ec(e,t,o){var n=e.pingCache;null!==n&&n.delete(t),t=ec(),e.pingedLanes|=e.suspendedLanes&o,Rl===e&&(Tl&o)===o&&(4===Nl||3===Nl&&(130023424&Tl)===Tl&&500>Xe()-Hl?pc(e,0):Fl|=o),nc(e,t)}function kc(e,t){0===t&&(0===(1&e.mode)?t=1:(t=dt,0===(130023424&(dt<<=1))&&(dt=4194304)));var o=ec();null!==(e=Ii(e,t))&&(yt(e,t,o),nc(e,o))}function jc(e){var t=e.memoizedState,o=0;null!==t&&(o=t.retryLane),kc(e,o)}function Ac(e,t){var o=0;switch(e.tag){case 13:var n=e.stateNode,r=e.memoizedState;null!==r&&(o=r.retryLane);break;case 19:n=e.stateNode;break;default:throw Error(i(314))}null!==n&&n.delete(t),kc(e,o)}function Rc(e,t){return qe(e,t)}function Oc(e,t,o,n){this.tag=e,this.key=o,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=t,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=n,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Tc(e,t,o,n){return new Oc(e,t,o,n)}function Dc(e){return!(!(e=e.prototype)||!e.isReactComponent)}function Pc(e,t){var o=e.alternate;return null===o?((o=Tc(e.tag,t,e.key,e.mode)).elementType=e.elementType,o.type=e.type,o.stateNode=e.stateNode,o.alternate=e,e.alternate=o):(o.pendingProps=t,o.type=e.type,o.flags=0,o.subtreeFlags=0,o.deletions=null),o.flags=14680064&e.flags,o.childLanes=e.childLanes,o.lanes=e.lanes,o.child=e.child,o.memoizedProps=e.memoizedProps,o.memoizedState=e.memoizedState,o.updateQueue=e.updateQueue,t=e.dependencies,o.dependencies=null===t?null:{lanes:t.lanes,firstContext:t.firstContext},o.sibling=e.sibling,o.index=e.index,o.ref=e.ref,o}function Nc(e,t,o,n,r,a){var s=2;if(n=e,"function"===typeof e)Dc(e)&&(s=1);else if("string"===typeof e)s=5;else e:switch(e){case _:return Ic(o.children,r,a,t);case S:s=8,r|=8;break;case E:return(e=Tc(12,o,t,2|r)).elementType=E,e.lanes=a,e;case R:return(e=Tc(13,o,t,r)).elementType=R,e.lanes=a,e;case O:return(e=Tc(19,o,t,r)).elementType=O,e.lanes=a,e;case P:return Mc(o,r,a,t);default:if("object"===typeof e&&null!==e)switch(e.$$typeof){case k:s=10;break e;case j:s=9;break e;case A:s=11;break e;case T:s=14;break e;case D:s=16,n=null;break e}throw Error(i(130,null==e?e:typeof e,""))}return(t=Tc(s,o,t,r)).elementType=e,t.type=n,t.lanes=a,t}function Ic(e,t,o,n){return(e=Tc(7,e,n,t)).lanes=o,e}function Mc(e,t,o,n){return(e=Tc(22,e,n,t)).elementType=P,e.lanes=o,e.stateNode={isHidden:!1},e}function Lc(e,t,o){return(e=Tc(6,e,null,t)).lanes=o,e}function Fc(e,t,o){return(t=Tc(4,null!==e.children?e.children:[],e.key,t)).lanes=o,t.stateNode={containerInfo:e.containerInfo,pendingChildren:null,implementation:e.implementation},t}function Gc(e,t,o,n,r){this.tag=t,this.containerInfo=e,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=mt(0),this.expirationTimes=mt(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=mt(0),this.identifierPrefix=n,this.onRecoverableError=r,this.mutableSourceEagerHydrationData=null}function zc(e,t,o,n,r,i,a,s,l){return e=new Gc(e,t,o,s,l),1===t?(t=1,!0===i&&(t|=8)):t=0,i=Tc(3,null,null,t),e.current=i,i.stateNode=e,i.memoizedState={element:n,isDehydrated:o,cache:null,transitions:null,pendingSuspenseBoundaries:null},Li(i),e}function Hc(e){if(!e)return Ar;e:{if(Be(e=e._reactInternals)!==e||1!==e.tag)throw Error(i(170));var t=e;do{switch(t.tag){case 3:t=t.stateNode.context;break e;case 1:if(Pr(t.type)){t=t.stateNode.__reactInternalMemoizedMergedChildContext;break e}}t=t.return}while(null!==t);throw Error(i(171))}if(1===e.tag){var o=e.type;if(Pr(o))return Mr(e,o,t)}return t}function Bc(e,t,o,n,r,i,a,s,l){return(e=zc(o,n,!0,e,0,i,0,s,l)).context=Hc(null),o=e.current,(i=Gi(n=ec(),r=tc(o))).callback=void 0!==t&&null!==t?t:null,zi(o,i,r),e.current.lanes=r,yt(e,r,n),nc(e,n),e}function Vc(e,t,o,n){var r=t.current,i=ec(),a=tc(r);return o=Hc(o),null===t.context?t.context=o:t.pendingContext=o,(t=Gi(i,a)).payload={element:e},null!==(n=void 0===n?null:n)&&(t.callback=n),null!==(e=zi(r,t,a))&&(oc(e,r,a,i),Hi(e,r,a)),a}function $c(e){return(e=e.current).child?(e.child.tag,e.child.stateNode):null}function Uc(e,t){if(null!==(e=e.memoizedState)&&null!==e.dehydrated){var o=e.retryLane;e.retryLane=0!==o&&o<t?o:t}}function Wc(e,t){Uc(e,t),(e=e.alternate)&&Uc(e,t)}_l=function(e,t,o){if(null!==e)if(e.memoizedProps!==t.pendingProps||Or.current)bs=!0;else{if(0===(e.lanes&o)&&0===(128&t.flags))return bs=!1,function(e,t,o){switch(t.tag){case 3:Rs(t),fi();break;case 5:Qi(t);break;case 1:Pr(t.type)&&Lr(t);break;case 4:Ji(t,t.stateNode.containerInfo);break;case 10:var n=t.type._context,r=t.memoizedProps.value;jr(_i,n._currentValue),n._currentValue=r;break;case 13:if(null!==(n=t.memoizedState))return null!==n.dehydrated?(jr(ea,1&ea.current),t.flags|=128,null):0!==(o&t.child.childLanes)?Ls(e,t,o):(jr(ea,1&ea.current),null!==(e=$s(e,t,o))?e.sibling:null);jr(ea,1&ea.current);break;case 19:if(n=0!==(o&t.childLanes),0!==(128&e.flags)){if(n)return Bs(e,t,o);t.flags|=128}if(null!==(r=t.memoizedState)&&(r.rendering=null,r.tail=null,r.lastEffect=null),jr(ea,ea.current),n)break;return null;case 22:case 23:return t.lanes=0,Ss(e,t,o)}return $s(e,t,o)}(e,t,o);bs=0!==(131072&e.flags)}else bs=!1,ii&&0!==(1048576&t.flags)&&ei(t,qr,t.index);switch(t.lanes=0,t.tag){case 2:var n=t.type;Vs(e,t),e=t.pendingProps;var r=Dr(t,Rr.current);Oi(t,o),r=ma(null,t,n,e,r,o);var a=ya();return t.flags|=1,"object"===typeof r&&null!==r&&"function"===typeof r.render&&void 0===r.$$typeof?(t.tag=1,t.memoizedState=null,t.updateQueue=null,Pr(n)?(a=!0,Lr(t)):a=!1,t.memoizedState=null!==r.state&&void 0!==r.state?r.state:null,Li(t),r.updater=rs,t.stateNode=r,r._reactInternals=t,ls(t,n,e,o),t=As(null,t,n,!0,a,o)):(t.tag=0,ii&&a&&ti(t),xs(null,t,r,o),t=t.child),t;case 16:n=t.elementType;e:{switch(Vs(e,t),e=t.pendingProps,n=(r=n._init)(n._payload),t.type=n,r=t.tag=function(e){if("function"===typeof e)return Dc(e)?1:0;if(void 0!==e&&null!==e){if((e=e.$$typeof)===A)return 11;if(e===T)return 14}return 2}(n),e=os(n,e),r){case 0:t=ks(null,t,n,e,o);break e;case 1:t=js(null,t,n,e,o);break e;case 11:t=ws(null,t,n,e,o);break e;case 14:t=Cs(null,t,n,os(n.type,e),o);break e}throw Error(i(306,n,""))}return t;case 0:return n=t.type,r=t.pendingProps,ks(e,t,n,r=t.elementType===n?r:os(n,r),o);case 1:return n=t.type,r=t.pendingProps,js(e,t,n,r=t.elementType===n?r:os(n,r),o);case 3:e:{if(Rs(t),null===e)throw Error(i(387));n=t.pendingProps,r=(a=t.memoizedState).element,Fi(e,t),Vi(t,n,null,o);var s=t.memoizedState;if(n=s.element,a.isDehydrated){if(a={element:n,isDehydrated:!1,cache:s.cache,pendingSuspenseBoundaries:s.pendingSuspenseBoundaries,transitions:s.transitions},t.updateQueue.baseState=a,t.memoizedState=a,256&t.flags){t=Os(e,t,n,o,r=cs(Error(i(423)),t));break e}if(n!==r){t=Os(e,t,n,o,r=cs(Error(i(424)),t));break e}for(ri=dr(t.stateNode.containerInfo.firstChild),ni=t,ii=!0,ai=null,o=Ci(t,null,n,o),t.child=o;o;)o.flags=-3&o.flags|4096,o=o.sibling}else{if(fi(),n===r){t=$s(e,t,o);break e}xs(e,t,n,o)}t=t.child}return t;case 5:return Qi(t),null===e&&di(t),n=t.type,r=t.pendingProps,a=null!==e?e.memoizedProps:null,s=r.children,nr(n,r)?s=null:null!==a&&nr(n,a)&&(t.flags|=32),Es(e,t),xs(e,t,s,o),t.child;case 6:return null===e&&di(t),null;case 13:return Ls(e,t,o);case 4:return Ji(t,t.stateNode.containerInfo),n=t.pendingProps,null===e?t.child=wi(t,null,n,o):xs(e,t,n,o),t.child;case 11:return n=t.type,r=t.pendingProps,ws(e,t,n,r=t.elementType===n?r:os(n,r),o);case 7:return xs(e,t,t.pendingProps,o),t.child;case 8:case 12:return xs(e,t,t.pendingProps.children,o),t.child;case 10:e:{if(n=t.type._context,r=t.pendingProps,a=t.memoizedProps,s=r.value,jr(_i,n._currentValue),n._currentValue=s,null!==a)if(ln(a.value,s)){if(a.children===r.children&&!Or.current){t=$s(e,t,o);break e}}else for(null!==(a=t.child)&&(a.return=t);null!==a;){var l=a.dependencies;if(null!==l){s=a.child;for(var c=l.firstContext;null!==c;){if(c.context===n){if(1===a.tag){(c=Gi(-1,o&-o)).tag=2;var d=a.updateQueue;if(null!==d){var u=(d=d.shared).pending;null===u?c.next=c:(c.next=u.next,u.next=c),d.pending=c}}a.lanes|=o,null!==(c=a.alternate)&&(c.lanes|=o),Ri(a.return,o,t),l.lanes|=o;break}c=c.next}}else if(10===a.tag)s=a.type===t.type?null:a.child;else if(18===a.tag){if(null===(s=a.return))throw Error(i(341));s.lanes|=o,null!==(l=s.alternate)&&(l.lanes|=o),Ri(s,o,t),s=a.sibling}else s=a.child;if(null!==s)s.return=a;else for(s=a;null!==s;){if(s===t){s=null;break}if(null!==(a=s.sibling)){a.return=s.return,s=a;break}s=s.return}a=s}xs(e,t,r.children,o),t=t.child}return t;case 9:return r=t.type,n=t.pendingProps.children,Oi(t,o),n=n(r=Ti(r)),t.flags|=1,xs(e,t,n,o),t.child;case 14:return r=os(n=t.type,t.pendingProps),Cs(e,t,n,r=os(n.type,r),o);case 15:return _s(e,t,t.type,t.pendingProps,o);case 17:return n=t.type,r=t.pendingProps,r=t.elementType===n?r:os(n,r),Vs(e,t),t.tag=1,Pr(n)?(e=!0,Lr(t)):e=!1,Oi(t,o),as(t,n,r),ls(t,n,r,o),As(null,t,n,!0,e,o);case 19:return Bs(e,t,o);case 22:return Ss(e,t,o)}throw Error(i(156,t.tag))};var qc="function"===typeof reportError?reportError:function(e){console.error(e)};function Kc(e){this._internalRoot=e}function Yc(e){this._internalRoot=e}function Jc(e){return!(!e||1!==e.nodeType&&9!==e.nodeType&&11!==e.nodeType)}function Xc(e){return!(!e||1!==e.nodeType&&9!==e.nodeType&&11!==e.nodeType&&(8!==e.nodeType||" react-mount-point-unstable "!==e.nodeValue))}function Qc(){}function Zc(e,t,o,n,r){var i=o._reactRootContainer;if(i){var a=i;if("function"===typeof r){var s=r;r=function(){var e=$c(a);s.call(e)}}Vc(t,a,e,r)}else a=function(e,t,o,n,r){if(r){if("function"===typeof n){var i=n;n=function(){var e=$c(a);i.call(e)}}var a=Bc(t,n,e,0,null,!1,0,"",Qc);return e._reactRootContainer=a,e[gr]=a.current,Vn(8===e.nodeType?e.parentNode:e),dc(),a}for(;r=e.lastChild;)e.removeChild(r);if("function"===typeof n){var s=n;n=function(){var e=$c(l);s.call(e)}}var l=zc(e,0,!1,null,0,!1,0,"",Qc);return e._reactRootContainer=l,e[gr]=l.current,Vn(8===e.nodeType?e.parentNode:e),dc((function(){Vc(t,l,o,n)})),l}(o,t,e,r,n);return $c(a)}Yc.prototype.render=Kc.prototype.render=function(e){var t=this._internalRoot;if(null===t)throw Error(i(409));Vc(e,t,null,null)},Yc.prototype.unmount=Kc.prototype.unmount=function(){var e=this._internalRoot;if(null!==e){this._internalRoot=null;var t=e.containerInfo;dc((function(){Vc(null,e,null,null)})),t[gr]=null}},Yc.prototype.unstable_scheduleHydration=function(e){if(e){var t=St();e={blockedOn:null,target:e,priority:t};for(var o=0;o<Pt.length&&0!==t&&t<Pt[o].priority;o++);Pt.splice(o,0,e),0===o&&Lt(e)}},wt=function(e){switch(e.tag){case 3:var t=e.stateNode;if(t.current.memoizedState.isDehydrated){var o=ut(t.pendingLanes);0!==o&&(vt(t,1|o),nc(t,Xe()),0===(6&Al)&&(Bl=Xe()+500,Vr()))}break;case 13:dc((function(){var t=Ii(e,1);if(null!==t){var o=ec();oc(t,e,1,o)}})),Wc(e,1)}},Ct=function(e){if(13===e.tag){var t=Ii(e,134217728);if(null!==t)oc(t,e,134217728,ec());Wc(e,134217728)}},_t=function(e){if(13===e.tag){var t=tc(e),o=Ii(e,t);if(null!==o)oc(o,e,t,ec());Wc(e,t)}},St=function(){return bt},Et=function(e,t){var o=bt;try{return bt=e,t()}finally{bt=o}},Ce=function(e,t,o){switch(t){case"input":if(Q(e,o),t=o.name,"radio"===o.type&&null!=t){for(o=e;o.parentNode;)o=o.parentNode;for(o=o.querySelectorAll("input[name="+JSON.stringify(""+t)+'][type="radio"]'),t=0;t<o.length;t++){var n=o[t];if(n!==e&&n.form===e.form){var r=Cr(n);if(!r)throw Error(i(90));q(n),Q(n,r)}}}break;case"textarea":ie(e,o);break;case"select":null!=(t=o.value)&&oe(e,!!o.multiple,t,!1)}},Ae=cc,Re=dc;var ed={usingClientEntryPoint:!1,Events:[xr,wr,Cr,ke,je,cc]},td={findFiberByHostInstance:br,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},od={bundleType:td.bundleType,version:td.version,rendererPackageName:td.rendererPackageName,rendererConfig:td.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:x.ReactCurrentDispatcher,findHostInstanceByFiber:function(e){return null===(e=Ue(e))?null:e.stateNode},findFiberByHostInstance:td.findFiberByHostInstance||function(){return null},findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if("undefined"!==typeof __REACT_DEVTOOLS_GLOBAL_HOOK__){var nd=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!nd.isDisabled&&nd.supportsFiber)try{rt=nd.inject(od),it=nd}catch(de){}}t.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=ed,t.createPortal=function(e,t){var o=2<arguments.length&&void 0!==arguments[2]?arguments[2]:null;if(!Jc(t))throw Error(i(200));return function(e,t,o){var n=3<arguments.length&&void 0!==arguments[3]?arguments[3]:null;return{$$typeof:C,key:null==n?null:""+n,children:e,containerInfo:t,implementation:o}}(e,t,null,o)},t.createRoot=function(e,t){if(!Jc(e))throw Error(i(299));var o=!1,n="",r=qc;return null!==t&&void 0!==t&&(!0===t.unstable_strictMode&&(o=!0),void 0!==t.identifierPrefix&&(n=t.identifierPrefix),void 0!==t.onRecoverableError&&(r=t.onRecoverableError)),t=zc(e,1,!1,null,0,o,0,n,r),e[gr]=t.current,Vn(8===e.nodeType?e.parentNode:e),new Kc(t)},t.findDOMNode=function(e){if(null==e)return null;if(1===e.nodeType)return e;var t=e._reactInternals;if(void 0===t){if("function"===typeof e.render)throw Error(i(188));throw e=Object.keys(e).join(","),Error(i(268,e))}return e=null===(e=Ue(t))?null:e.stateNode},t.flushSync=function(e){return dc(e)},t.hydrate=function(e,t,o){if(!Xc(t))throw Error(i(200));return Zc(null,e,t,!0,o)},t.hydrateRoot=function(e,t,o){if(!Jc(e))throw Error(i(405));var n=null!=o&&o.hydratedSources||null,r=!1,a="",s=qc;if(null!==o&&void 0!==o&&(!0===o.unstable_strictMode&&(r=!0),void 0!==o.identifierPrefix&&(a=o.identifierPrefix),void 0!==o.onRecoverableError&&(s=o.onRecoverableError)),t=Bc(t,null,e,1,null!=o?o:null,r,0,a,s),e[gr]=t.current,Vn(e),n)for(e=0;e<n.length;e++)r=(r=(o=n[e])._getVersion)(o._source),null==t.mutableSourceEagerHydrationData?t.mutableSourceEagerHydrationData=[o,r]:t.mutableSourceEagerHydrationData.push(o,r);return new Yc(t)},t.render=function(e,t,o){if(!Xc(t))throw Error(i(200));return Zc(null,e,t,!1,o)},t.unmountComponentAtNode=function(e){if(!Xc(e))throw Error(i(40));return!!e._reactRootContainer&&(dc((function(){Zc(null,null,e,!1,(function(){e._reactRootContainer=null,e[gr]=null}))})),!0)},t.unstable_batchedUpdates=cc,t.unstable_renderSubtreeIntoContainer=function(e,t,o,n){if(!Xc(o))throw Error(i(200));if(null==e||void 0===e._reactInternals)throw Error(i(38));return Zc(e,t,o,!1,n)},t.version="18.3.1-next-f1338f8080-20240426"},2908:function(e,t,o){"use strict";var n=this&&this.__createBinding||(Object.create?function(e,t,o,n){void 0===n&&(n=o),Object.defineProperty(e,n,{enumerable:!0,get:function(){return t[o]}})}:function(e,t,o,n){void 0===n&&(n=o),e[n]=t[o]}),r=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),i=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var o in e)"default"!==o&&Object.prototype.hasOwnProperty.call(e,o)&&n(t,e,o);return r(t,e),t};Object.defineProperty(t,"__esModule",{value:!0});var a=i(o(5043)),s=o(7079),l=o(9201),c=o(9724),d=a.forwardRef((function(e,t){var o=e.children,n=e.eFocusableElement,r=e.onTabKeyDown,i=e.gridCtrl,d=a.useContext(l.BeansContext).context,u=a.useRef(null),p=a.useRef(null),h=a.useRef(),f=a.useState(),g=f[0],m=f[1];a.useImperativeHandle(t,(function(){return{forceFocusOutOfContainer:function(){h.current.forceFocusOutOfContainer()}}})),c.useLayoutEffectOnce((function(){var e=u.current,t=p.current,o={setTabIndex:function(e){return m(null==e?void 0:parseInt(e,10))}},a=h.current=d.createBean(new s.TabGuardCtrl({comp:o,eTopGuard:e,eBottomGuard:t,eFocusableElement:n,onTabKeyDown:r,focusInnerElement:function(e){return i.focusInnerElement(e)}}));return function(){d.destroyBean(a)}}));var y=function(e){var t="top"===e?s.TabGuardClassNames.TAB_GUARD_TOP:s.TabGuardClassNames.TAB_GUARD_BOTTOM;return a.default.createElement("div",{className:s.TabGuardClassNames.TAB_GUARD+" "+t,role:"presentation",tabIndex:g,ref:"top"===e?u:p})};return a.default.createElement(a.default.Fragment,null,y("top"),o,y("bottom"))}));t.default=a.memo(d)},2959:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.log=function(){console.log("portalOpenInstances ----------"),console.log(n.openInstances.length),n.openInstances.forEach((function(e){return console.log(e)})),console.log("end portalOpenInstances ----------")},t.resetState=function(){n=new o};var o=function e(){var t=this;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.register=function(e){-1===t.openInstances.indexOf(e)&&(t.openInstances.push(e),t.emit("register"))},this.deregister=function(e){var o=t.openInstances.indexOf(e);-1!==o&&(t.openInstances.splice(o,1),t.emit("deregister"))},this.subscribe=function(e){t.subscribers.push(e)},this.emit=function(e){t.subscribers.forEach((function(o){return o(e,t.openInstances.slice())}))},this.openInstances=[],this.subscribers=[]},n=new o;t.default=n},2963:(e,t,o)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n,r=o(5765),i=(n=r)&&n.__esModule?n:{default:n};t.default=i.default,e.exports=t.default},3183:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.createSyncJsComp=t.showJsComp=void 0,t.showJsComp=function(e,t,n,r){if(!(!e||e.componentFromFramework)){var i=e.newAgStackInstance();if(i){var a,s,l=!1;return i.then((function(e){l?t.destroyBean(e):(s=(a=e).getGui(),n.appendChild(s),o(r,a))})),function(){l=!0,a&&(s&&s.parentElement&&s.parentElement.removeChild(s),t.destroyBean(a),r&&o(r,void 0))}}}};var o=function(e,t){e&&(e instanceof Function?e(t):e.current=t)};t.createSyncJsComp=function(e){var t=e.newAgStackInstance();if(t)return t.resolveNow(null,(function(e){return e}))}},3216:(e,t,o)=>{"use strict";var n;o.d(t,{$P:()=>h,C5:()=>I,Ix:()=>L,Rq:()=>l,V8:()=>N,Zp:()=>y,g:()=>b,jb:()=>c,ph:()=>w,sp:()=>s,sv:()=>M,wE:()=>F,x$:()=>x,zy:()=>g});var r=o(5043),i=o(1387);function a(){return a=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var o=arguments[t];for(var n in o)Object.prototype.hasOwnProperty.call(o,n)&&(e[n]=o[n])}return e},a.apply(this,arguments)}const s=r.createContext(null);const l=r.createContext(null);const c=r.createContext(null);const d=r.createContext(null);const u=r.createContext({outlet:null,matches:[],isDataRoute:!1});const p=r.createContext(null);function h(e,t){let{relative:o}=void 0===t?{}:t;f()||(0,i.Oi)(!1);let{basename:n,navigator:a}=r.useContext(c),{hash:s,pathname:l,search:d}=x(e,{relative:o}),u=l;return"/"!==n&&(u="/"===l?n:(0,i.HS)([n,l])),a.createHref({pathname:u,search:d,hash:s})}function f(){return null!=r.useContext(d)}function g(){return f()||(0,i.Oi)(!1),r.useContext(d).location}function m(e){r.useContext(c).static||r.useLayoutEffect(e)}function y(){let{isDataRoute:e}=r.useContext(u);return e?function(){let{router:e}=R(j.UseNavigateStable),t=T(A.UseNavigateStable),o=r.useRef(!1);return m((()=>{o.current=!0})),r.useCallback((function(n,r){void 0===r&&(r={}),o.current&&("number"===typeof n?e.navigate(n):e.navigate(n,a({fromRouteId:t},r)))}),[e,t])}():function(){f()||(0,i.Oi)(!1);let e=r.useContext(s),{basename:t,future:o,navigator:n}=r.useContext(c),{matches:a}=r.useContext(u),{pathname:l}=g(),d=JSON.stringify((0,i.yD)(a,o.v7_relativeSplatPath)),p=r.useRef(!1);return m((()=>{p.current=!0})),r.useCallback((function(o,r){if(void 0===r&&(r={}),!p.current)return;if("number"===typeof o)return void n.go(o);let a=(0,i.Gh)(o,JSON.parse(d),l,"path"===r.relative);null==e&&"/"!==t&&(a.pathname="/"===a.pathname?t:(0,i.HS)([t,a.pathname])),(r.replace?n.replace:n.push)(a,r.state,r)}),[t,n,d,l,e])}()}const v=r.createContext(null);function b(){let{matches:e}=r.useContext(u),t=e[e.length-1];return t?t.params:{}}function x(e,t){let{relative:o}=void 0===t?{}:t,{future:n}=r.useContext(c),{matches:a}=r.useContext(u),{pathname:s}=g(),l=JSON.stringify((0,i.yD)(a,n.v7_relativeSplatPath));return r.useMemo((()=>(0,i.Gh)(e,JSON.parse(l),s,"path"===o)),[e,l,s,o])}function w(e,t,o,n){f()||(0,i.Oi)(!1);let{navigator:s,static:l}=r.useContext(c),{matches:p}=r.useContext(u),h=p[p.length-1],m=h?h.params:{},y=(h&&h.pathname,h?h.pathnameBase:"/");h&&h.route;let v,b=g();if(t){var x;let e="string"===typeof t?(0,i.Rr)(t):t;"/"===y||(null==(x=e.pathname)?void 0:x.startsWith(y))||(0,i.Oi)(!1),v=e}else v=b;let w=v.pathname||"/",C=w;if("/"!==y){let e=y.replace(/^\//,"").split("/");C="/"+w.replace(/^\//,"").split("/").slice(e.length).join("/")}let _=!l&&o&&o.matches&&o.matches.length>0?o.matches:(0,i.ue)(e,{pathname:C});let S=k(_&&_.map((e=>Object.assign({},e,{params:Object.assign({},m,e.params),pathname:(0,i.HS)([y,s.encodeLocation?s.encodeLocation(e.pathname).pathname:e.pathname]),pathnameBase:"/"===e.pathnameBase?y:(0,i.HS)([y,s.encodeLocation?s.encodeLocation(e.pathnameBase).pathname:e.pathnameBase])}))),p,o,n);return t&&S?r.createElement(d.Provider,{value:{location:a({pathname:"/",search:"",hash:"",state:null,key:"default"},v),navigationType:i.rc.Pop}},S):S}function C(){let e=function(){var e;let t=r.useContext(p),o=O(A.UseRouteError),n=T(A.UseRouteError);if(void 0!==t)return t;return null==(e=o.errors)?void 0:e[n]}(),t=(0,i.pX)(e)?e.status+" "+e.statusText:e instanceof Error?e.message:JSON.stringify(e),o=e instanceof Error?e.stack:null,n="rgba(200,200,200, 0.5)",a={padding:"0.5rem",backgroundColor:n};return r.createElement(r.Fragment,null,r.createElement("h2",null,"Unexpected Application Error!"),r.createElement("h3",{style:{fontStyle:"italic"}},t),o?r.createElement("pre",{style:a},o):null,null)}const _=r.createElement(C,null);class S extends r.Component{constructor(e){super(e),this.state={location:e.location,revalidation:e.revalidation,error:e.error}}static getDerivedStateFromError(e){return{error:e}}static getDerivedStateFromProps(e,t){return t.location!==e.location||"idle"!==t.revalidation&&"idle"===e.revalidation?{error:e.error,location:e.location,revalidation:e.revalidation}:{error:void 0!==e.error?e.error:t.error,location:t.location,revalidation:e.revalidation||t.revalidation}}componentDidCatch(e,t){console.error("React Router caught the following error during render",e,t)}render(){return void 0!==this.state.error?r.createElement(u.Provider,{value:this.props.routeContext},r.createElement(p.Provider,{value:this.state.error,children:this.props.component})):this.props.children}}function E(e){let{routeContext:t,match:o,children:n}=e,i=r.useContext(s);return i&&i.static&&i.staticContext&&(o.route.errorElement||o.route.ErrorBoundary)&&(i.staticContext._deepestRenderedBoundaryId=o.route.id),r.createElement(u.Provider,{value:t},n)}function k(e,t,o,n){var a;if(void 0===t&&(t=[]),void 0===o&&(o=null),void 0===n&&(n=null),null==e){var s;if(!o)return null;if(o.errors)e=o.matches;else{if(!(null!=(s=n)&&s.v7_partialHydration&&0===t.length&&!o.initialized&&o.matches.length>0))return null;e=o.matches}}let l=e,c=null==(a=o)?void 0:a.errors;if(null!=c){let e=l.findIndex((e=>e.route.id&&void 0!==(null==c?void 0:c[e.route.id])));e>=0||(0,i.Oi)(!1),l=l.slice(0,Math.min(l.length,e+1))}let d=!1,u=-1;if(o&&n&&n.v7_partialHydration)for(let r=0;r<l.length;r++){let e=l[r];if((e.route.HydrateFallback||e.route.hydrateFallbackElement)&&(u=r),e.route.id){let{loaderData:t,errors:n}=o,r=e.route.loader&&void 0===t[e.route.id]&&(!n||void 0===n[e.route.id]);if(e.route.lazy||r){d=!0,l=u>=0?l.slice(0,u+1):[l[0]];break}}}return l.reduceRight(((e,n,i)=>{let a,s=!1,p=null,h=null;var f;o&&(a=c&&n.route.id?c[n.route.id]:void 0,p=n.route.errorElement||_,d&&(u<0&&0===i?(f="route-fallback",!1||D[f]||(D[f]=!0),s=!0,h=null):u===i&&(s=!0,h=n.route.hydrateFallbackElement||null)));let g=t.concat(l.slice(0,i+1)),m=()=>{let t;return t=a?p:s?h:n.route.Component?r.createElement(n.route.Component,null):n.route.element?n.route.element:e,r.createElement(E,{match:n,routeContext:{outlet:e,matches:g,isDataRoute:null!=o},children:t})};return o&&(n.route.ErrorBoundary||n.route.errorElement||0===i)?r.createElement(S,{location:o.location,revalidation:o.revalidation,component:p,error:a,children:m(),routeContext:{outlet:null,matches:g,isDataRoute:!0}}):m()}),null)}var j=function(e){return e.UseBlocker="useBlocker",e.UseRevalidator="useRevalidator",e.UseNavigateStable="useNavigate",e}(j||{}),A=function(e){return e.UseBlocker="useBlocker",e.UseLoaderData="useLoaderData",e.UseActionData="useActionData",e.UseRouteError="useRouteError",e.UseNavigation="useNavigation",e.UseRouteLoaderData="useRouteLoaderData",e.UseMatches="useMatches",e.UseRevalidator="useRevalidator",e.UseNavigateStable="useNavigate",e.UseRouteId="useRouteId",e}(A||{});function R(e){let t=r.useContext(s);return t||(0,i.Oi)(!1),t}function O(e){let t=r.useContext(l);return t||(0,i.Oi)(!1),t}function T(e){let t=function(){let e=r.useContext(u);return e||(0,i.Oi)(!1),e}(),o=t.matches[t.matches.length-1];return o.route.id||(0,i.Oi)(!1),o.route.id}const D={};const P=(e,t,o)=>{};function N(e,t){void 0===(null==e?void 0:e.v7_startTransition)&&P("v7_startTransition","React Router will begin wrapping state updates in `React.startTransition` in v7","https://reactrouter.com/v6/upgrading/future#v7_starttransition"),void 0!==(null==e?void 0:e.v7_relativeSplatPath)||t&&t.v7_relativeSplatPath||P("v7_relativeSplatPath","Relative route resolution within Splat routes is changing in v7","https://reactrouter.com/v6/upgrading/future#v7_relativesplatpath"),t&&(void 0===t.v7_fetcherPersist&&P("v7_fetcherPersist","The persistence behavior of fetchers is changing in v7","https://reactrouter.com/v6/upgrading/future#v7_fetcherpersist"),void 0===t.v7_normalizeFormMethod&&P("v7_normalizeFormMethod","Casing of `formMethod` fields is being normalized to uppercase in v7","https://reactrouter.com/v6/upgrading/future#v7_normalizeformmethod"),void 0===t.v7_partialHydration&&P("v7_partialHydration","`RouterProvider` hydration behavior is changing in v7","https://reactrouter.com/v6/upgrading/future#v7_partialhydration"),void 0===t.v7_skipActionErrorRevalidation&&P("v7_skipActionErrorRevalidation","The revalidation behavior after 4xx/5xx `action` responses is changing in v7","https://reactrouter.com/v6/upgrading/future#v7_skipactionerrorrevalidation"))}(n||(n=o.t(r,2))).startTransition;function I(e){let{to:t,replace:o,state:n,relative:a}=e;f()||(0,i.Oi)(!1);let{future:s,static:l}=r.useContext(c),{matches:d}=r.useContext(u),{pathname:p}=g(),h=y(),m=(0,i.Gh)(t,(0,i.yD)(d,s.v7_relativeSplatPath),p,"path"===a),v=JSON.stringify(m);return r.useEffect((()=>h(JSON.parse(v),{replace:o,state:n,relative:a})),[h,v,a,o,n]),null}function M(e){return function(e){let t=r.useContext(u).outlet;return t?r.createElement(v.Provider,{value:e},t):t}(e.context)}function L(e){let{basename:t="/",children:o=null,location:n,navigationType:s=i.rc.Pop,navigator:l,static:u=!1,future:p}=e;f()&&(0,i.Oi)(!1);let h=t.replace(/^\/*/,"/"),g=r.useMemo((()=>({basename:h,navigator:l,static:u,future:a({v7_relativeSplatPath:!1},p)})),[h,p,l,u]);"string"===typeof n&&(n=(0,i.Rr)(n));let{pathname:m="/",search:y="",hash:v="",state:b=null,key:x="default"}=n,w=r.useMemo((()=>{let e=(0,i.pb)(m,h);return null==e?null:{location:{pathname:e,search:y,hash:v,state:b,key:x},navigationType:s}}),[h,m,y,v,b,x,s]);return null==w?null:r.createElement(c.Provider,{value:g},r.createElement(d.Provider,{children:o,value:w}))}new Promise((()=>{}));r.Component;function F(e){let t={hasErrorBoundary:null!=e.ErrorBoundary||null!=e.errorElement};return e.Component&&Object.assign(t,{element:r.createElement(e.Component),Component:void 0}),e.HydrateFallback&&Object.assign(t,{hydrateFallbackElement:r.createElement(e.HydrateFallback),HydrateFallback:void 0}),e.ErrorBoundary&&Object.assign(t,{errorElement:r.createElement(e.ErrorBoundary),ErrorBoundary:void 0}),t}},3218:e=>{"use strict";e.exports="SECRET_DO_NOT_PASS_THIS_OR_YOU_WILL_BE_FIRED"},3237:(e,t,o)=>{"use strict";o.d(t,{A:()=>q});var n=o(5043),r=o(2963),i=o.n(r),a=o(1529),s=o(1009),l=o(5315),c=o(3768),d=o(8725),u=o(579);const p={content:{top:"50%",left:"50%",right:"auto",bottom:"auto",marginRight:"-50%",transform:"translate(-50%, -50%)",padding:"0",border:"1px solid #333",borderRadius:"8px",boxShadow:"0 4px 20px rgba(0, 0, 0, 0.6)",backgroundColor:"#121212",color:"#e0e0e0",width:"800px",maxWidth:"95%",maxHeight:"90vh",overflow:"hidden"},overlay:{backgroundColor:"rgba(0, 0, 0, 0.75)",zIndex:1e3}},h=a.Ay.div`
  padding: 28px;
  box-sizing: border-box;
`,f=a.Ay.div`
  display: flex;
  justify-content: space-between;
  align-items: center;
  margin-bottom: 24px;
  padding-bottom: 16px;
  border-bottom: 1px solid #333;
  
  h2 {
    margin: 0;
    font-size: 1.5rem;
    font-weight: 600;
    color: #00ff00;
  }
`,g=a.Ay.button`
  background: none;
  border: none;
  cursor: pointer;
  color: #ffffff;
  height: 32px;
  width: 32px;
  display: flex;
  align-items: center;
  justify-content: center;
  border-radius: 6px;
  transition: all 0.2s;
  
  &:hover {
    color: #ff5555;
  }
`,m=a.Ay.div`
  max-height: calc(90vh - 180px);
  overflow-y: auto;
  padding-right: 4px;
  margin-bottom: 16px;
  
  /* Custom scrollbar */
  &::-webkit-scrollbar {
    width: 6px;
  }
  
  &::-webkit-scrollbar-track {
    background: transparent;
  }
  
  &::-webkit-scrollbar-thumb {
    background-color: rgba(200, 200, 200, 0.5);
    border-radius: 10px;
  }
`,y=a.Ay.div`
  display: grid;
  grid-template-columns: 1fr 1fr;
  gap: 24px;
  margin-bottom: 24px;
  box-sizing: border-box;
`,v=a.Ay.div`
  margin-bottom: 20px;
  width: 100%;
  box-sizing: border-box;
`,b=a.Ay.label`
  display: block;
  margin-bottom: 8px;
  font-size: 0.875rem;
  font-weight: 500;
  color: #00ff00;
`,x=a.Ay.input`
  width: 100%;
  padding: 10px 12px;
  border: 1px solid #444;
  border-radius: 6px;
  font-size: 0.875rem;
  color: #eee;
  background-color: #222;
  box-sizing: border-box;
  
  &:focus {
    outline: none;
    border-color: #00ff00;
  }
  
  &:hover {
    background-color: #333;
  }
`,w=a.Ay.select`
  width: 100%;
  padding: 10px 12px;
  border: 1px solid #444;
  border-radius: 6px;
  font-size: 0.875rem;
  color: #eee;
  background-color: #222;
  box-sizing: border-box;
  
  &:focus {
    outline: none;
    border-color: #00ff00;
  }
  
  &:hover {
    background-color: #333;
  }
  
  option {
    background-color: #222;
    color: #eee;
  }
`,C=a.Ay.textarea`
  width: 100%;
  padding: 12px;
  border: 1px solid #444;
  border-radius: 6px;
  font-size: 0.875rem;
  color: #eee;
  background-color: #222;
  min-height: 120px;
  resize: vertical;
  box-sizing: border-box;
  
  &:focus {
    outline: none;
    border-color: #00ff00;
  }
  
  &:hover {
    background-color: #333;
  }
`,_=a.Ay.div`
  display: flex;
  gap: 12px;
  align-items: center;
  width: 100%;
  box-sizing: border-box;
  margin-bottom: 16px;
`,S=a.Ay.div`
  position: relative;
  flex: 1;
  min-width: 0;
`,E=a.Ay.div`
  position: absolute;
  left: 12px;
  top: 50%;
  transform: translateY(-50%);
  color: #6b7280;
`,k=a.Ay.input`
  width: 100%;
  padding: 10px 10px 10px 36px;
  border: 1px solid #444;
  border-radius: 6px;
  font-size: 0.875rem;
  color: #eee;
  background-color: #222;
  outline: none;
  transition: border-color 0.2s;
  box-sizing: border-box;

  &:focus {
    border-color: #00ff00;
  }
  
  &:hover {
    background-color: #333;
  }
`,j=a.Ay.button`
  display: flex;
  align-items: center;
  justify-content: center;
  padding: 10px;
  background-color: ${e=>e.active?"#333":"#222"};
  color: ${e=>e.active?"#00ff00":"#ccc"};
  border: 1px solid #444;
  border-radius: 6px;
  cursor: pointer;
  transition: all 0.2s;
  flex-shrink: 0;

  &:hover {
    background-color: ${e=>e.active?"#444":"#333"};
  }
`,A=a.Ay.div`
  display: ${e=>e.visible?"block":"none"};
  margin-bottom: 16px;
  padding: 16px;
  background-color: #222;
  border-radius: 6px;
  border: 1px solid #444;
  width: 100%;
  box-sizing: border-box;
`,R=a.Ay.div`
  margin-bottom: 12px;
  
  &:last-child {
    margin-bottom: 0;
  }
  
  label {
    font-size: 0.875rem;
    font-weight: 500;
    margin-bottom: 8px;
    display: block;
  }
`,O=a.Ay.div`
  display: flex;
  flex-wrap: wrap;
  gap: 12px 20px;
  margin-top: 8px;
`,T=a.Ay.label`
  display: flex;
  align-items: center;
  font-size: 0.8125rem;
  color: #ccc;
  cursor: pointer;
  
  input {
    margin-right: 6px;
    accent-color: #00ff00;
  }
`,D=a.Ay.div`
  position: relative;
  margin-top: 4px;
  border: 1px solid #444;
  border-radius: 6px;
  max-height: 200px;
  overflow-y: auto;
  background-color: #222;
  box-shadow: 0 4px 6px rgba(0, 0, 0, 0.3);
  z-index: 10;
  width: 100%;
  box-sizing: border-box;
`,P=a.Ay.button`
  width: 100%;
  text-align: left;
  padding: 10px 12px;
  border: none;
  background: none;
  cursor: pointer;
  font-size: 0.875rem;
  color: #eee;
  transition: background-color 0.2s;
  display: flex;
  align-items: center;
  justify-content: space-between;
  box-sizing: border-box;

  &:hover {
    background-color: #333;
    color: #00ff00;
  }

  &:not(:last-child) {
    border-bottom: 1px solid #333;
  }
`,N=a.Ay.div`
  display: flex;
  flex-wrap: wrap;
  gap: 8px;
  margin-bottom: 16px;
  padding: 5px 0;
  min-height: 32px;
`,I=a.Ay.div`
  display: inline-flex;
  align-items: center;
  padding: 6px 12px;
  background-color: #222;
  color: #00ff00;
  border-radius: 16px;
  font-size: 0.875rem;
  gap: 6px;
  border: 1px solid #00ff00;

  span {
    white-space: nowrap;
    overflow: hidden;
    text-overflow: ellipsis;
    max-width: 150px;
  }

  button {
    background: none;
    border: none;
    padding: 2px;
    cursor: pointer;
    color: inherit;
    opacity: 0.7;
    display: flex;
    align-items: center;
    justify-content: center;
    flex-shrink: 0;

    &:hover {
      opacity: 1;
      color: #ff5555;
    }
  }
`,M=a.Ay.div`
  margin-top: 16px;
  background-color: #222;
  border-radius: 6px;
  border: 1px solid #444;
  padding: 16px;
  width: 100%;
  box-sizing: border-box;
`,L=a.Ay.div`
  display: flex;
  align-items: center;
  margin-bottom: 12px;
  
  h4 {
    font-size: 0.9375rem;
    font-weight: 600;
    color: #00ff00;
    margin: 0;
    display: flex;
    align-items: center;
    gap: 6px;
  }
`,F=a.Ay.div`
  max-height: 180px;
  overflow-y: auto;
  
  &::-webkit-scrollbar {
    width: 4px;
  }
  
  &::-webkit-scrollbar-track {
    background: transparent;
  }
  
  &::-webkit-scrollbar-thumb {
    background-color: rgba(200, 200, 200, 0.5);
    border-radius: 10px;
  }
`,G=a.Ay.div`
  padding: 8px 0;
  border-bottom: 1px solid #333;
  font-size: 0.8125rem;
  
  &:last-child {
    border-bottom: none;
  }
  
  .intro-date {
    color: #ccc;
    font-size: 0.75rem;
    margin-bottom: 2px;
    display: flex;
    align-items: center;
    gap: 4px;
  }
  
  .intro-rationale {
    display: inline-block;
    padding: 2px 8px;
    border-radius: 9999px;
    font-size: 0.75rem;
    font-weight: 500;
    margin-left: 8px;
    background-color: ${e=>{switch(e.rationale){case"Karma Points":return"#143601";case"Dealflow":return"#2C1A00";case"Portfolio Company":return"#0A1C2E";default:return"#222"}}};
    color: ${e=>{switch(e.rationale){case"Karma Points":return"#00ff00";case"Dealflow":return"#FFBB00";case"Portfolio Company":return"#47A3FF";default:return"#ccc"}}};
  }
  
  .intro-note {
    color: #aaa;
    margin-top: 4px;
    white-space: nowrap;
    overflow: hidden;
    text-overflow: ellipsis;
  }
`,z=a.Ay.span`
  display: inline-block;
  padding: 2px 8px;
  border-radius: 9999px;
  font-size: 0.75rem;
  font-weight: 500;
  background-color: ${e=>{switch(e.type){case"Karma Points":return"#143601";case"Dealflow":return"#2C1A00";case"Portfolio Company":return"#0A1C2E";default:return"#222"}}};
  color: ${e=>{switch(e.type){case"Karma Points":return"#00ff00";case"Dealflow":return"#FFBB00";case"Portfolio Company":return"#47A3FF";default:return"#ccc"}}};
`,H=a.Ay.div`
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
  position: relative;

  &:hover::after {
    content: attr(data-tooltip);
    position: absolute;
    left: 0;
    top: 100%;
    background: #333;
    color: #00ff00;
    padding: 8px 12px;
    border-radius: 6px;
    font-size: 0.875rem;
    white-space: normal;
    max-width: 300px;
    word-wrap: break-word;
    z-index: 1000;
    box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.3);
    border: 1px solid #444;
  }
`,B=a.Ay.div`
  display: flex;
  align-items: flex-start;
  gap: 6px;
  font-size: 0.8125rem;
  color: ${e=>"error"===e.type?"#b91c1c":"#6b7280"};
  margin-top: 6px;
  padding: ${e=>"error"===e.type?"8px 10px":"4px 0"};
  background-color: ${e=>"error"===e.type?"#fee2e2":"transparent"};
  border-radius: ${e=>"error"===e.type?"4px":"0"};
  overflow-wrap: break-word;
  word-wrap: break-word;
`,V=a.Ay.div`
  display: flex;
  justify-content: flex-end;
  gap: 12px;
  padding-top: 16px;
  border-top: 1px solid #333;
`,$=a.Ay.button`
  display: flex;
  align-items: center;
  gap: 8px;
  padding: 10px 16px;
  border-radius: 6px;
  font-size: 0.875rem;
  font-weight: 500;
  cursor: pointer;
  transition: all 0.2s;
`,U=(0,a.Ay)($)`
  background-color: transparent;
  color: #ccc;
  border: 1px solid #555;
  
  &:hover {
    background-color: #333;
  }
`,W=(0,a.Ay)($)`
  background-color: #00ff00;
  color: black;
  border: none;
  white-space: nowrap;
  
  &:hover {
    background-color: #00dd00;
  }
  
  &:disabled {
    background-color: #006600;
    color: #88ff88;
    cursor: not-allowed;
  }
`,q=e=>{let{isOpen:t,onRequestClose:o,preSelectedContact:r,editingIntro:a}=e;(0,n.useEffect)((()=>{t&&a&&console.log("Edit Introduction Modal opened with:",{introId:a.intro_id,date:a.intro_date,contactsIntroduced:a.contacts_introduced,rationale:a.introduction_rationale,note:a.introduction_note})}),[t,a]);const[$,q]=(0,n.useState)([]),[K,Y]=(0,n.useState)([]),[J,X]=(0,n.useState)(""),[Q,Z]=(0,n.useState)(""),[ee,te]=(0,n.useState)((new Date).toISOString().split("T")[0]),[oe,ne]=(0,n.useState)(!1),[re,ie]=(0,n.useState)(""),[ae,se]=(0,n.useState)([]),[le,ce]=(0,n.useState)(!1),[de,ue]=(0,n.useState)(!1),[pe,he]=(0,n.useState)([]),[fe,ge]=(0,n.useState)([]),[me,ye]=(0,n.useState)(!1),[ve,be]=(0,n.useState)({});(0,n.useEffect)((()=>{if(t)if(xe(),a){Y([]),X(a.introduction_rationale||a.category),Z(a.introduction_note||a.text);const e=a.intro_date||a.introduction_date;te((0,d.A)(new Date(e),"yyyy-MM-dd"))}else r&&(Y([r]),we([r.id]));else Y(r?[r]:[]),X(""),Z(""),te((new Date).toISOString().split("T")[0]),ie(""),se([]),ge([]),be({}),ue(!1),he([])}),[t,r,a]);const xe=async function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";try{let t=l.supabase.from("contacts").select("contact_id, first_name, last_name, category").order("first_name");if(a&&!e){const o=a.contacts_introduced||a.contact_ids||[],{data:n,error:r}=await l.supabase.from("contacts").select("contact_id, first_name, last_name, category").in("contact_id",o);if(r)throw r;e&&(t=t.or(`first_name.ilike.%${e}%,last_name.ilike.%${e}%`)),pe.length>0&&(t=t.in("category",pe));const{data:i,error:s}=await t;if(s)throw s;const c=[...n];return i.forEach((e=>{c.some((t=>t.id===e.id))||c.push(e)})),Y(n),q(c),void we(n.map((e=>e.id)))}e&&(t=t.or(`first_name.ilike.%${e}%,last_name.ilike.%${e}%`)),pe.length>0&&(t=t.in("category",pe));const{data:o,error:n}=await t;if(n)throw n;const r=o.filter((e=>!K.some((t=>t.contact_id===e.contact_id))));e?se(r):q(o)}catch(t){console.error("Error fetching contacts:",t),c.oR.error("Failed to load contacts")}},we=async e=>{if(e&&!(e.length<1)){ye(!0);try{const{data:t,error:o}=await l.supabase.from("introductions").select("*").contains("contact_ids",e).order("introduction_date",{ascending:!1});if(o)throw o;const n=(t?t.filter((t=>e.every((e=>(t.contact_ids||[]).includes(e))))):[]).map((e=>({intro_id:e.introduction_id,contacts_introduced:e.contact_ids,intro_date:e.introduction_date,introduction_rationale:e.category,introduction_note:e.text,created_by:e.created_by,created_at:e.created_at})));ge(n)}catch(t){console.error("Error fetching introduction history:",t),c.oR.error("Failed to load introduction history")}finally{ye(!1)}}};(0,n.useEffect)((()=>{re.length>=2?(xe(re),ce(!0)):(se([]),ce(!1))}),[re,pe]),(0,n.useEffect)((()=>{K.length>=1?we(K.map((e=>e.contact_id))):ge([]),Ce("selectedContacts",K)}),[K]);const Ce=(e,t)=>{console.log(`Validating ${e||"all fields"}`);const o={...ve};switch(e){case"selectedContacts":!t||t.length<1?(console.log(`Selected contacts validation failed: ${(null===t||void 0===t?void 0:t.length)||0} contacts selected, need at least 1`),o.selectedContacts="Please select at least one contact"):(console.log(`Selected contacts validation passed: ${t.length} contacts`),delete o.selectedContacts);break;case"rationale":t?(console.log(`Rationale validation passed: "${t}" selected`),delete o.rationale):(console.log("Rationale validation failed: No rationale selected"),o.rationale="Please select a rationale for the introduction");break;case"introDate":t?(console.log(`Introduction date validation passed: "${t}" selected`),delete o.introDate):(console.log("Introduction date validation failed: No date selected"),o.introDate="Please select a date for the introduction");break;default:console.log("Validating all fields at once"),console.log(`- Selected contacts: ${(null===K||void 0===K?void 0:K.length)||0}`),console.log(`- Rationale: "${J||""}"`),console.log(`- Intro date: "${ee||""}"`),!K||K.length<1?(console.log(`Selected contacts validation failed: ${(null===K||void 0===K?void 0:K.length)||0} contacts selected, need at least 1`),o.selectedContacts="Please select at least one contact"):(console.log(`Selected contacts validation passed: ${K.length} contacts`),delete o.selectedContacts),J?delete o.rationale:(console.log("Rationale validation failed: No rationale selected"),o.rationale="Please select a rationale for the introduction"),ee?delete o.introDate:(console.log("Introduction date validation failed: No date selected"),o.introDate="Please select a date for the introduction")}const n={};Object.entries(o).forEach((e=>{let[t,o]=e;""!==o&&(n[t]=o)}));const r=0===Object.keys(n).length;return console.log(`Validation result: ${r?"VALID":"INVALID"}, errors:`,n),be(n),r};return(0,u.jsx)(i(),{isOpen:t,onRequestClose:o,style:p,ariaHideApp:!1,children:(0,u.jsxs)(h,{children:[(0,u.jsxs)(f,{children:[(0,u.jsx)("h2",{children:a?"Edit Introduction":"New Introduction"}),(0,u.jsx)(g,{onClick:o,children:(0,u.jsx)(s.yGN,{size:18})})]}),(0,u.jsxs)(m,{children:[(0,u.jsxs)(y,{children:[(0,u.jsxs)(v,{children:[(0,u.jsx)(b,{htmlFor:"introDate",children:"Introduction Date"}),(0,u.jsx)(x,{id:"introDate",type:"date",value:ee,onChange:e=>{te(e.target.value),Ce("introDate",e.target.value)}}),ve.introDate&&(0,u.jsxs)(B,{type:"error",children:[(0,u.jsx)(s.eHT,{size:14}),ve.introDate]})]}),(0,u.jsxs)(v,{children:[(0,u.jsx)(b,{htmlFor:"rationale",children:"Introduction Rationale"}),(0,u.jsxs)(w,{id:"rationale",value:J,onChange:e=>{X(e.target.value),Ce("rationale",e.target.value)},children:[(0,u.jsx)("option",{value:"",children:"Select a rationale..."}),(0,u.jsx)("option",{value:"Karma Points",children:"Karma Points"}),(0,u.jsx)("option",{value:"Dealflow",children:"Dealflow"}),(0,u.jsx)("option",{value:"Portfolio Company",children:"Portfolio Company"})]}),ve.rationale&&(0,u.jsxs)(B,{type:"error",children:[(0,u.jsx)(s.eHT,{size:14}),ve.rationale]})]})]}),(0,u.jsxs)(v,{id:"selectedContacts",children:[(0,u.jsx)(b,{children:"Select Contacts to Introduce"}),(0,u.jsx)(N,{children:K.map((e=>(0,u.jsxs)(I,{children:[(0,u.jsxs)("span",{children:[e.first_name," ",e.last_name]}),(0,u.jsx)("button",{onClick:()=>{return t=e.contact_id,void Y((e=>e.filter((e=>e.contact_id!==t))));var t},children:(0,u.jsx)(s.yGN,{size:14})})]},e.contact_id)))}),(0,u.jsxs)(_,{children:[(0,u.jsxs)(S,{children:[(0,u.jsx)(E,{children:(0,u.jsx)(s.CKj,{size:16})}),(0,u.jsx)(k,{type:"text",value:re,onChange:e=>ie(e.target.value),placeholder:"Search contacts (type at least 2 letters)..."})]}),(0,u.jsx)(j,{active:de,onClick:()=>ue(!de),title:"Filter contacts",children:(0,u.jsx)(s.K7R,{size:16})})]}),(0,u.jsx)(A,{visible:de,children:(0,u.jsxs)(R,{children:[(0,u.jsx)("label",{children:"Filter by contact category:"}),(0,u.jsx)(O,{children:["Founder","Professional Investor","Advisor","Team","Friend and Family","Manager","Institution","Media","Student","Supplier"].map((e=>(0,u.jsxs)(T,{children:[(0,u.jsx)("input",{type:"checkbox",checked:pe.includes(e),onChange:()=>(e=>{he((t=>t.includes(e)?t.filter((t=>t!==e)):[...t,e]))})(e)}),e]},e)))})]})}),le&&ae.length>0&&(0,u.jsx)(D,{children:ae.map((e=>(0,u.jsxs)(P,{onClick:()=>(e=>{Y((t=>[...t,e])),ie(""),ce(!1)})(e),children:[(0,u.jsxs)("span",{children:[e.first_name," ",e.last_name]}),e.category&&(0,u.jsx)("small",{style:{color:"#6b7280"},children:e.category})]},e.contact_id)))}),le&&0===ae.length&&re.length>=2&&(0,u.jsxs)(B,{children:['No contacts found matching "',re,'"']})]}),K.length>=1&&fe.length>0&&!a&&(0,u.jsxs)(M,{children:[(0,u.jsx)(L,{children:(0,u.jsxs)("h4",{children:[(0,u.jsx)(s.S8s,{size:16}),"Previous Introductions"]})}),(0,u.jsx)(F,{children:fe.map((e=>(0,u.jsxs)(G,{rationale:e.introduction_rationale,children:[(0,u.jsxs)("div",{className:"intro-date",children:[(0,u.jsx)(s.wIk,{size:12}),(0,d.A)(new Date(e.intro_date),"dd MMM yyyy"),(0,u.jsx)(z,{type:e.introduction_rationale,children:e.introduction_rationale})]}),e.introduction_note&&(0,u.jsx)(H,{"data-tooltip":e.introduction_note,className:"intro-note",children:e.introduction_note})]},e.intro_id)))})]}),(0,u.jsxs)(v,{children:[(0,u.jsx)(b,{htmlFor:"note",children:"Note"}),(0,u.jsx)(C,{id:"note",value:Q,onChange:e=>Z(e.target.value),placeholder:"Add any additional context about this introduction..."}),(0,u.jsxs)(B,{children:[(0,u.jsx)(s.S8s,{size:14}),"This note will help you remember the context of this introduction later."]})]})]}),(0,u.jsxs)(V,{children:[(0,u.jsx)(U,{onClick:o,children:"Cancel"}),(0,u.jsxs)(W,{onClick:async()=>{if(console.log("Introduction form submission started"),console.log("Current form data:",{introDate:ee,selectedContacts:K.map((e=>({id:e.contact_id,name:`${e.first_name} ${e.last_name}`}))),rationale:J,note:Q,validationErrors:Object.keys(ve)}),Ce()){ne(!0),console.log("Validation passed, submitting form");try{var e;const{data:t}=await l.supabase.auth.getUser();console.log("Authenticated user:",null===t||void 0===t||null===(e=t.user)||void 0===e?void 0:e.id);const n={introduction_date:ee,contact_ids:K.map((e=>e.contact_id)),category:J,text:Q,introduction_tool:"email",status:"Done & Dust",created_by:"User"};let r;if(console.log("Contact IDs to be stored:",n.contact_ids),console.log("Prepared introduction data:",n),a){const e={introduction_date:ee,contact_ids:K.map((e=>e.contact_id)),category:J,text:Q,last_modified_by:"User"};console.log("Updating introduction with data:",e),console.log("Introduction ID to update:",a.intro_id||a.introduction_id);const t=a.intro_id?"intro_id":"introduction_id",o=a.intro_id||a.introduction_id;console.log(`Using ID field: ${t} with value: ${o}`);const{data:n,error:i}=await l.supabase.from("introductions").update(e).eq("introduction_id",o).select();r=i,r&&console.error("Update error:",r),n&&console.log("Updated introduction returned data:",n)}else{console.log("Creating new introduction");const{data:e,error:t}=await l.supabase.from("introductions").insert(n).select();console.log("Insert result:",e),r=t,r&&console.error("Insert error:",r)}if(r)throw r;console.log("Operation completed successfully"),c.oR.success(`Introduction ${a?"updated":"created"} successfully`),setTimeout((()=>{console.log("Closing modal after successful operation"),o()}),500)}catch(t){console.error(`Error ${a?"updating":"creating"} introduction:`,t),c.oR.error(`Failed to ${a?"update":"create"} introduction`)}finally{ne(!1)}}else if(console.log("Validation failed",ve),Object.keys(ve).length>0){const e=document.getElementById(Object.keys(ve)[0]);e&&e.scrollIntoView({behavior:"smooth",block:"center"})}},disabled:oe,children:[(0,u.jsx)(s.Bc_,{size:16}),oe?a?"Updating...":"Creating...":a?"Update":"Create"]})]})]})})}},3594:(e,t,o)=>{"use strict";o.d(t,{A:()=>D});var n=o(5043),r=o(2963),i=o.n(r),a=o(1529),s=o(1009),l=o(5315),c=o(2115),d=o(579);const u=a.Ay.div`
  display: flex;
  justify-content: space-between;
  align-items: center;
  padding: 15px;
  border-bottom: 1px solid #333;
`,p=a.Ay.button`
  background: none;
  border: none;
  color: #ccc;
  cursor: pointer;
  font-size: 20px;
  display: flex;
  align-items: center;
  justify-content: center;
  padding: 5px;
  
  &:hover {
    color: #fff;
  }
`,h=a.Ay.div`
  padding: 20px;
  color: #eee;
  position: relative;
  box-sizing: border-box;
`,f=a.Ay.div`
  background: #2d2d2d;
  border-radius: 5px;
  padding: 15px;
  display: flex;
  flex-direction: column;
  gap: 15px;
  border: 1px solid #444;
`,g=a.Ay.div`
  display: flex;
  gap: 10px;
`,m=a.Ay.div`
  width: 60px;
  height: 60px;
  background: #0077b5;
  border-radius: 50%;
  display: flex;
  align-items: center;
  justify-content: center;
  color: white;
  font-size: 24px;
  font-weight: bold;
`,y=a.Ay.div`
  display: flex;
  flex-direction: column;
  justify-content: center;
  gap: 5px;
  flex: 1;
`,v=a.Ay.div`
  font-size: 16px;
  font-weight: bold;
  color: white;
`,b=a.Ay.div`
  font-size: 13px;
  color: #bbb;
  margin-bottom: 5px;
`,x=a.Ay.div`
  font-size: 13px;
  color: #999;
`,w=a.Ay.a`
  display: flex;
  align-items: center;
  justify-content: center;
  gap: 6px;
  background: #0077b5;
  color: white;
  padding: 6px 0;
  text-decoration: none;
  border-radius: 4px;
  text-align: center;
  font-size: 13px;
  font-weight: 500;
  cursor: pointer;
  margin-top: 5px;
  
  &:hover {
    background: #006097;
  }
`,C=a.Ay.div`
  margin-top: 20px;
  padding-top: 20px;
  border-top: 1px solid #444;
  box-sizing: border-box;
  width: 100%;
`,_=a.Ay.div`
  font-size: 15px;
  font-weight: 600;
  margin-bottom: 15px;
  color: #ddd;
`,S=a.Ay.div`
  margin-bottom: 10px;
  padding-right: 10px; /* Add consistent right padding */
`,E=a.Ay.label`
  display: block;
  margin-bottom: 8px;
  color: #bbb;
  font-size: 13px;
`,k=a.Ay.input`
  width: 100%; /* Full width */
  padding: 8px;
  background: #1e1e1e;
  border: 1px solid #444;
  border-radius: 4px;
  color: white;
  font-size: 13px;
  box-sizing: border-box; /* Ensures padding doesn't add to width */
  
  &:focus {
    outline: none;
    border-color: #0077b5;
  }
`,j=a.Ay.div`
  display: flex;
  justify-content: space-between;
  gap: 10px;
  margin-top: 20px;
`,A=a.Ay.button`
  flex: 1;
  display: flex;
  align-items: center;
  justify-content: center;
  gap: 5px;
  padding: 8px;
  border-radius: 4px;
  font-size: 13px;
  cursor: pointer;
  border: none;
  
  &:disabled {
    opacity: 0.6;
    cursor: not-allowed;
  }
`,R=(0,a.Ay)(A)`
  background: #00ff00;
  color: #111;
  
  &:hover:not(:disabled) {
    background: #00cc00;
  }
`,O=(0,a.Ay)(A)`
  background: #333;
  color: #eee;
  
  &:hover {
    background: #444;
  }
`,T={content:{top:"50%",left:"50%",right:"auto",bottom:"auto",marginRight:"-50%",transform:"translate(-50%, -50%)",background:"#222",border:"1px solid #333",borderRadius:"5px",padding:"0",width:"550px",maxWidth:"90%",maxHeight:"85vh",overflow:"auto"},overlay:{backgroundColor:"rgba(0, 0, 0, 0.75)",zIndex:1e3}};"undefined"!==typeof window&&i().setAppElement("#root");const D=e=>{let{isOpen:t,onClose:o,linkedInUrl:r,contactName:a,jobRole:A,onSaveData:D,firstName:P,lastName:N,email:I,contactId:M,context:L}=e;const[F,G]=(0,n.useState)(A||""),[z,H]=(0,n.useState)(""),[B,V]=(0,n.useState)(""),[$,U]=(0,n.useState)(""),[W,q]=(0,n.useState)(""),[K,Y]=(0,n.useState)(r||""),[J,X]=(0,n.useState)(!1),[Q,Z]=(0,n.useState)(!1),[ee,te]=(0,n.useState)(null),[oe,ne]=(0,n.useState)(!1),re=async()=>{X(!0),te(null);try{const e="localhost"===window.location.hostname||"127.0.0.1"===window.location.hostname,t=e?"https://your-netlify-site.netlify.app/.netlify/functions/linkedin-job-extract":"/.netlify/functions/linkedin-job-extract";if(e)return console.log("Development mode detected - using mock data instead of API call"),await new Promise((e=>setTimeout(e,1e3))),te("LinkedIn data extraction is only available in the online version"),X(!1),void ne(!0);const o=await fetch(t,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({firstName:P||a.split(" ")[0]||"",lastName:N||(a.split(" ").length>1?a.split(" ").slice(1).join(" "):""),email:I||null,linkedinUrl:K||r||null})}),n=await o.json();n.success&&n.data?(n.data.jobTitle&&G(n.data.jobTitle),n.data.company&&H(n.data.company),n.data.companyWebsite&&V(n.data.companyWebsite),n.data.companyDescription&&U(n.data.companyDescription),n.data.city&&q(n.data.city)):te(n.error||"Unable to extract data from LinkedIn")}catch(e){console.error("Failed to extract LinkedIn data:",e),te("Failed to extract data from LinkedIn. Please try manually entering the information.")}finally{X(!1),ne(!0)}};(0,n.useEffect)((()=>{t&&(r||K)&&!oe&&re()}),[t,r,K,oe]);return(0,d.jsxs)(i(),{isOpen:t,onRequestClose:o,style:T,contentLabel:"LinkedIn Profile Search & Enrich",children:[(0,d.jsxs)(u,{children:[(0,d.jsx)("h3",{style:{margin:0,fontSize:"16px",color:"#ffffff"},children:"LinkedIn Profile Search & Enrich"}),(0,d.jsx)(p,{onClick:o,children:(0,d.jsx)(s.yGN,{})})]}),(0,d.jsxs)(h,{children:[(0,d.jsxs)(f,{children:[(0,d.jsxs)(g,{children:[(0,d.jsx)(m,{children:(e=>{if(!e)return"?";const t=e.split(" ");return 1===t.length?t[0].charAt(0).toUpperCase():`${t[0].charAt(0)}${t[t.length-1].charAt(0)}`.toUpperCase()})(a)}),(0,d.jsxs)(y,{children:[(0,d.jsx)(v,{children:a}),(0,d.jsx)(b,{children:F&&z?`${F} at ${z}`:F||(J?"Extracting data...":"Add job information")}),(0,d.jsx)(x,{children:r?"LinkedIn Profile":"Add LinkedIn URL below"})]})]}),(0,d.jsxs)("div",{style:{display:"flex",gap:"8px",marginBottom:"10px",width:"100%"},children:[(0,d.jsx)(k,{type:"text",value:K,onChange:e=>Y(e.target.value),placeholder:"Paste LinkedIn URL here",style:{flex:1}}),(0,d.jsxs)("button",{onClick:async()=>{if(K){Z(!0);try{let e=M;if(!e){const t=window.location.pathname.split("/");e=t[t.length-1],e&&e.includes(":")&&(e=e.split(":")[1])}if(!e||""===e||"undefined"===e)throw new Error("Valid contact ID not found");console.log("Saving LinkedIn URL for contact ID:",e);const{data:t,error:o}=await l.supabase.from("contacts").update({linkedin:K}).eq("contact_id",e).select();if(o)throw console.error("Supabase update error:",o),o;console.log("Update success, response:",t),c.oR.success("LinkedIn URL saved successfully to contacts.linkedin in Supabase!",{position:"top-right",autoClose:3e3,hideProgressBar:!1,closeOnClick:!0,pauseOnHover:!0,draggable:!0}),(async(e,t)=>{try{if(!e||!t)return;const o="localhost"===window.location.hostname||"127.0.0.1"===window.location.hostname,n=o?"https://your-netlify-site.netlify.app/.netlify/functions/apollo-enrich":"/.netlify/functions/apollo-enrich";if(console.log(`Triggering Apollo enrichment for contact ${e} with LinkedIn URL: ${t}`),o)return void console.log("Development mode detected - skipping Apollo enrichment API call");const r=await fetch(n,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({contactId:e,linkedinUrl:t})}),i=await r.json();console.log("Apollo enrichment result:",i)}catch(o){console.error("Error triggering Apollo enrichment:",o)}})(e,K),Y(K),ne(!1),setTimeout((()=>{re()}),1e3),L&&L.refreshData&&setTimeout((()=>{L.refreshData()}),1500)}catch(e){console.error("Failed to save LinkedIn URL:",e.message,e),c.oR.error(`Failed to save URL to Supabase contacts.linkedin: ${e.message}`,{position:"top-right",autoClose:5e3,hideProgressBar:!1,closeOnClick:!0,pauseOnHover:!0,draggable:!0})}finally{Z(!1)}}},disabled:Q||!K,style:{background:"#0077b5",color:"white",border:"none",borderRadius:"4px",padding:"0 10px",cursor:Q||!K?"not-allowed":"pointer",display:"flex",alignItems:"center",justifyContent:"center",gap:"5px",opacity:Q||!K?.6:1,fontSize:"13px"},children:[Q?(0,d.jsx)(s.TwU,{size:14}):(0,d.jsx)(s.Bc_,{size:14})," Save URL"]})]}),(0,d.jsxs)(w,{href:K||`https://www.linkedin.com/search/results/people/?keywords=${encodeURIComponent(a)}`,target:"_blank",rel:"noopener noreferrer",children:[(0,d.jsx)(s.ayE,{size:14})," ",K?"Visit Full LinkedIn Profile":"Search on LinkedIn"]})]}),(0,d.jsxs)(C,{children:[(0,d.jsxs)(_,{style:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[(0,d.jsxs)("div",{children:[(0,d.jsx)(s.qYx,{size:16,style:{marginRight:"6px",verticalAlign:"text-bottom"}}),"Professional Information"]}),r&&(0,d.jsx)("button",{onClick:re,disabled:J,style:{background:"transparent",border:"none",color:"#0077b5",cursor:J?"not-allowed":"pointer",fontSize:"14px",display:"flex",alignItems:"center",gap:"5px",opacity:J?.6:1},children:J?(0,d.jsxs)(d.Fragment,{children:[(0,d.jsx)(s.TwU,{size:14,style:{animation:"spin 1.5s linear infinite"}})," Extracting..."]}):(0,d.jsx)(d.Fragment,{children:"Refresh"})})]}),ee&&(0,d.jsx)("div",{style:{padding:"10px 12px",marginBottom:"12px",background:"rgba(255, 0, 0, 0.1)",border:"1px solid rgba(255, 0, 0, 0.2)",borderRadius:"4px",color:"#ff6b6b",fontSize:"13px"},children:ee}),(0,d.jsxs)(S,{children:[(0,d.jsxs)(E,{children:["Job Title ",J&&(0,d.jsx)("small",{style:{color:"#999",fontWeight:"normal"},children:"(extracting...)"})]}),(0,d.jsx)(k,{type:"text",value:F,onChange:e=>G(e.target.value),placeholder:"Enter job title (e.g. Software Engineer)",disabled:J})]}),(0,d.jsxs)(S,{children:[(0,d.jsxs)(E,{children:["Company ",J&&(0,d.jsx)("small",{style:{color:"#999",fontWeight:"normal"},children:"(extracting...)"})]}),(0,d.jsx)(k,{type:"text",value:z,onChange:e=>H(e.target.value),placeholder:"Enter company name (e.g. Acme Corp)",disabled:J})]}),(0,d.jsxs)(S,{children:[(0,d.jsxs)(E,{children:["Company Website ",J&&(0,d.jsx)("small",{style:{color:"#999",fontWeight:"normal"},children:"(extracting...)"})]}),(0,d.jsx)(k,{type:"text",value:B,onChange:e=>V(e.target.value),placeholder:"Enter company website (e.g. https://company.com)",disabled:J})]}),(0,d.jsxs)(S,{children:[(0,d.jsxs)(E,{children:["City ",J&&(0,d.jsx)("small",{style:{color:"#999",fontWeight:"normal"},children:"(extracting...)"})]}),(0,d.jsx)(k,{type:"text",value:W,onChange:e=>q(e.target.value),placeholder:"Enter city (e.g. San Francisco, CA)",disabled:J})]}),(0,d.jsxs)(S,{children:[(0,d.jsxs)(E,{children:["About the Company ",J&&(0,d.jsx)("small",{style:{color:"#999",fontWeight:"normal"},children:"(extracting...)"})]}),(0,d.jsx)("textarea",{value:$,onChange:e=>U(e.target.value),placeholder:"Enter information about the company",disabled:J,style:{width:"100%",minHeight:"70px",padding:"8px",background:"#1e1e1e",border:"1px solid #444",borderRadius:"4px",color:"white",fontSize:"14px",boxSizing:"border-box",resize:"vertical"}})]}),(0,d.jsxs)(j,{children:[(0,d.jsx)(O,{onClick:o,disabled:J,children:"Cancel"}),(0,d.jsxs)(R,{onClick:()=>{D&&D({jobRole:F,company:z,companyWebsite:B,companyDescription:$,city:W,linkedin:K}),o()},disabled:J||!F&&!z,children:[(0,d.jsx)(s.YrT,{size:14})," Save Information"]})]})]})]})]})}},3666:(e,t,o)=>{"use strict";function n(e,t){if(t.length<e)throw new TypeError(e+" argument"+(e>1?"s":"")+" required, but only "+t.length+" present")}o.d(t,{A:()=>n})},3763:(e,t,o)=>{"use strict";e.exports=o(4983)},3768:(e,t,o)=>{"use strict";o.d(t,{l$:()=>ee,Ay:()=>te,oR:()=>A});var n=o(5043);let r={data:""},i=e=>"object"==typeof window?((e?e.querySelector("#_goober"):window._goober)||Object.assign((e||document.head).appendChild(document.createElement("style")),{innerHTML:" ",id:"_goober"})).firstChild:e||r,a=/(?:([\u0080-\uFFFF\w-%@]+) *:? *([^{;]+?);|([^;}{]*?) *{)|(}\s*)/g,s=/\/\*[^]*?\*\/|  +/g,l=/\n+/g,c=(e,t)=>{let o="",n="",r="";for(let i in e){let a=e[i];"@"==i[0]?"i"==i[1]?o=i+" "+a+";":n+="f"==i[1]?c(a,i):i+"{"+c(a,"k"==i[1]?"":t)+"}":"object"==typeof a?n+=c(a,t?t.replace(/([^,])+/g,(e=>i.replace(/([^,]*:\S+\([^)]*\))|([^,])+/g,(t=>/&/.test(t)?t.replace(/&/g,e):e?e+" "+t:t)))):i):null!=a&&(i=/^--/.test(i)?i:i.replace(/[A-Z]/g,"-$&").toLowerCase(),r+=c.p?c.p(i,a):i+":"+a+";")}return o+(t&&r?t+"{"+r+"}":r)+n},d={},u=e=>{if("object"==typeof e){let t="";for(let o in e)t+=o+u(e[o]);return t}return e},p=(e,t,o,n,r)=>{let i=u(e),p=d[i]||(d[i]=(e=>{let t=0,o=11;for(;t<e.length;)o=101*o+e.charCodeAt(t++)>>>0;return"go"+o})(i));if(!d[p]){let t=i!==e?e:(e=>{let t,o,n=[{}];for(;t=a.exec(e.replace(s,""));)t[4]?n.shift():t[3]?(o=t[3].replace(l," ").trim(),n.unshift(n[0][o]=n[0][o]||{})):n[0][t[1]]=t[2].replace(l," ").trim();return n[0]})(e);d[p]=c(r?{["@keyframes "+p]:t}:t,o?"":"."+p)}let h=o&&d.g?d.g:null;return o&&(d.g=d[p]),((e,t,o,n)=>{n?t.data=t.data.replace(n,e):-1===t.data.indexOf(e)&&(t.data=o?e+t.data:t.data+e)})(d[p],t,n,h),p};function h(e){let t=this||{},o=e.call?e(t.p):e;return p(o.unshift?o.raw?((e,t,o)=>e.reduce(((e,n,r)=>{let i=t[r];if(i&&i.call){let e=i(o),t=e&&e.props&&e.props.className||/^go/.test(e)&&e;i=t?"."+t:e&&"object"==typeof e?e.props?"":c(e,""):!1===e?"":e}return e+n+(null==i?"":i)}),""))(o,[].slice.call(arguments,1),t.p):o.reduce(((e,o)=>Object.assign(e,o&&o.call?o(t.p):o)),{}):o,i(t.target),t.g,t.o,t.k)}h.bind({g:1});let f,g,m,y=h.bind({k:1});function v(e,t){let o=this||{};return function(){let n=arguments;function r(i,a){let s=Object.assign({},i),l=s.className||r.className;o.p=Object.assign({theme:g&&g()},s),o.o=/ *go\d+/.test(l),s.className=h.apply(o,n)+(l?" "+l:""),t&&(s.ref=a);let c=e;return e[0]&&(c=s.as||e,delete s.as),m&&c[0]&&m(s),f(c,s)}return t?t(r):r}}var b=(e,t)=>(e=>"function"==typeof e)(e)?e(t):e,x=(()=>{let e=0;return()=>(++e).toString()})(),w=(()=>{let e;return()=>{if(void 0===e&&typeof window<"u"){let t=matchMedia("(prefers-reduced-motion: reduce)");e=!t||t.matches}return e}})(),C=(e,t)=>{switch(t.type){case 0:return{...e,toasts:[t.toast,...e.toasts].slice(0,20)};case 1:return{...e,toasts:e.toasts.map((e=>e.id===t.toast.id?{...e,...t.toast}:e))};case 2:let{toast:o}=t;return C(e,{type:e.toasts.find((e=>e.id===o.id))?1:0,toast:o});case 3:let{toastId:n}=t;return{...e,toasts:e.toasts.map((e=>e.id===n||void 0===n?{...e,dismissed:!0,visible:!1}:e))};case 4:return void 0===t.toastId?{...e,toasts:[]}:{...e,toasts:e.toasts.filter((e=>e.id!==t.toastId))};case 5:return{...e,pausedAt:t.time};case 6:let r=t.time-(e.pausedAt||0);return{...e,pausedAt:void 0,toasts:e.toasts.map((e=>({...e,pauseDuration:e.pauseDuration+r})))}}},_=[],S={toasts:[],pausedAt:void 0},E=e=>{S=C(S,e),_.forEach((e=>{e(S)}))},k={blank:4e3,error:4e3,success:2e3,loading:1/0,custom:4e3},j=e=>(t,o)=>{let n=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"blank",o=arguments.length>2?arguments[2]:void 0;return{createdAt:Date.now(),visible:!0,dismissed:!1,type:t,ariaProps:{role:"status","aria-live":"polite"},message:e,pauseDuration:0,...o,id:(null==o?void 0:o.id)||x()}}(t,e,o);return E({type:2,toast:n}),n.id},A=(e,t)=>j("blank")(e,t);A.error=j("error"),A.success=j("success"),A.loading=j("loading"),A.custom=j("custom"),A.dismiss=e=>{E({type:3,toastId:e})},A.remove=e=>E({type:4,toastId:e}),A.promise=(e,t,o)=>{let n=A.loading(t.loading,{...o,...null==o?void 0:o.loading});return"function"==typeof e&&(e=e()),e.then((e=>{let r=t.success?b(t.success,e):void 0;return r?A.success(r,{id:n,...o,...null==o?void 0:o.success}):A.dismiss(n),e})).catch((e=>{let r=t.error?b(t.error,e):void 0;r?A.error(r,{id:n,...o,...null==o?void 0:o.error}):A.dismiss(n)})),e};var R=(e,t)=>{E({type:1,toast:{id:e,height:t}})},O=()=>{E({type:5,time:Date.now()})},T=new Map,D=e=>{let{toasts:t,pausedAt:o}=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},[t,o]=(0,n.useState)(S),r=(0,n.useRef)(S);(0,n.useEffect)((()=>(r.current!==S&&o(S),_.push(o),()=>{let e=_.indexOf(o);e>-1&&_.splice(e,1)})),[]);let i=t.toasts.map((t=>{var o,n,r;return{...e,...e[t.type],...t,removeDelay:t.removeDelay||(null==(o=e[t.type])?void 0:o.removeDelay)||(null==e?void 0:e.removeDelay),duration:t.duration||(null==(n=e[t.type])?void 0:n.duration)||(null==e?void 0:e.duration)||k[t.type],style:{...e.style,...null==(r=e[t.type])?void 0:r.style,...t.style}}}));return{...t,toasts:i}}(e);(0,n.useEffect)((()=>{if(o)return;let e=Date.now(),n=t.map((t=>{if(t.duration===1/0)return;let o=(t.duration||0)+t.pauseDuration-(e-t.createdAt);if(!(o<0))return setTimeout((()=>A.dismiss(t.id)),o);t.visible&&A.dismiss(t.id)}));return()=>{n.forEach((e=>e&&clearTimeout(e)))}}),[t,o]);let r=(0,n.useCallback)((()=>{o&&E({type:6,time:Date.now()})}),[o]),i=(0,n.useCallback)(((e,o)=>{let{reverseOrder:n=!1,gutter:r=8,defaultPosition:i}=o||{},a=t.filter((t=>(t.position||i)===(e.position||i)&&t.height)),s=a.findIndex((t=>t.id===e.id)),l=a.filter(((e,t)=>t<s&&e.visible)).length;return a.filter((e=>e.visible)).slice(...n?[l+1]:[0,l]).reduce(((e,t)=>e+(t.height||0)+r),0)}),[t]);return(0,n.useEffect)((()=>{t.forEach((e=>{if(e.dismissed)!function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1e3;if(T.has(e))return;let o=setTimeout((()=>{T.delete(e),E({type:4,toastId:e})}),t);T.set(e,o)}(e.id,e.removeDelay);else{let t=T.get(e.id);t&&(clearTimeout(t),T.delete(e.id))}}))}),[t]),{toasts:t,handlers:{updateHeight:R,startPause:O,endPause:r,calculateOffset:i}}},P=y`
from {
  transform: scale(0) rotate(45deg);
	opacity: 0;
}
to {
 transform: scale(1) rotate(45deg);
  opacity: 1;
}`,N=y`
from {
  transform: scale(0);
  opacity: 0;
}
to {
  transform: scale(1);
  opacity: 1;
}`,I=y`
from {
  transform: scale(0) rotate(90deg);
	opacity: 0;
}
to {
  transform: scale(1) rotate(90deg);
	opacity: 1;
}`,M=v("div")`
  width: 20px;
  opacity: 0;
  height: 20px;
  border-radius: 10px;
  background: ${e=>e.primary||"#ff4b4b"};
  position: relative;
  transform: rotate(45deg);

  animation: ${P} 0.3s cubic-bezier(0.175, 0.885, 0.32, 1.275)
    forwards;
  animation-delay: 100ms;

  &:after,
  &:before {
    content: '';
    animation: ${N} 0.15s ease-out forwards;
    animation-delay: 150ms;
    position: absolute;
    border-radius: 3px;
    opacity: 0;
    background: ${e=>e.secondary||"#fff"};
    bottom: 9px;
    left: 4px;
    height: 2px;
    width: 12px;
  }

  &:before {
    animation: ${I} 0.15s ease-out forwards;
    animation-delay: 180ms;
    transform: rotate(90deg);
  }
`,L=y`
  from {
    transform: rotate(0deg);
  }
  to {
    transform: rotate(360deg);
  }
`,F=v("div")`
  width: 12px;
  height: 12px;
  box-sizing: border-box;
  border: 2px solid;
  border-radius: 100%;
  border-color: ${e=>e.secondary||"#e0e0e0"};
  border-right-color: ${e=>e.primary||"#616161"};
  animation: ${L} 1s linear infinite;
`,G=y`
from {
  transform: scale(0) rotate(45deg);
	opacity: 0;
}
to {
  transform: scale(1) rotate(45deg);
	opacity: 1;
}`,z=y`
0% {
	height: 0;
	width: 0;
	opacity: 0;
}
40% {
  height: 0;
	width: 6px;
	opacity: 1;
}
100% {
  opacity: 1;
  height: 10px;
}`,H=v("div")`
  width: 20px;
  opacity: 0;
  height: 20px;
  border-radius: 10px;
  background: ${e=>e.primary||"#61d345"};
  position: relative;
  transform: rotate(45deg);

  animation: ${G} 0.3s cubic-bezier(0.175, 0.885, 0.32, 1.275)
    forwards;
  animation-delay: 100ms;
  &:after {
    content: '';
    box-sizing: border-box;
    animation: ${z} 0.2s ease-out forwards;
    opacity: 0;
    animation-delay: 200ms;
    position: absolute;
    border-right: 2px solid;
    border-bottom: 2px solid;
    border-color: ${e=>e.secondary||"#fff"};
    bottom: 6px;
    left: 6px;
    height: 10px;
    width: 6px;
  }
`,B=v("div")`
  position: absolute;
`,V=v("div")`
  position: relative;
  display: flex;
  justify-content: center;
  align-items: center;
  min-width: 20px;
  min-height: 20px;
`,$=y`
from {
  transform: scale(0.6);
  opacity: 0.4;
}
to {
  transform: scale(1);
  opacity: 1;
}`,U=v("div")`
  position: relative;
  transform: scale(0.6);
  opacity: 0.4;
  min-width: 20px;
  animation: ${$} 0.3s 0.12s cubic-bezier(0.175, 0.885, 0.32, 1.275)
    forwards;
`,W=e=>{let{toast:t}=e,{icon:o,type:r,iconTheme:i}=t;return void 0!==o?"string"==typeof o?n.createElement(U,null,o):o:"blank"===r?null:n.createElement(V,null,n.createElement(F,{...i}),"loading"!==r&&n.createElement(B,null,"error"===r?n.createElement(M,{...i}):n.createElement(H,{...i})))},q=e=>`\n0% {transform: translate3d(0,${-200*e}%,0) scale(.6); opacity:.5;}\n100% {transform: translate3d(0,0,0) scale(1); opacity:1;}\n`,K=e=>`\n0% {transform: translate3d(0,0,-1px) scale(1); opacity:1;}\n100% {transform: translate3d(0,${-150*e}%,-1px) scale(.6); opacity:0;}\n`,Y=v("div")`
  display: flex;
  align-items: center;
  background: #fff;
  color: #363636;
  line-height: 1.3;
  will-change: transform;
  box-shadow: 0 3px 10px rgba(0, 0, 0, 0.1), 0 3px 3px rgba(0, 0, 0, 0.05);
  max-width: 350px;
  pointer-events: auto;
  padding: 8px 10px;
  border-radius: 8px;
`,J=v("div")`
  display: flex;
  justify-content: center;
  margin: 4px 10px;
  color: inherit;
  flex: 1 1 auto;
  white-space: pre-line;
`,X=n.memo((e=>{let{toast:t,position:o,style:r,children:i}=e,a=t.height?((e,t)=>{let o=e.includes("top")?1:-1,[n,r]=w()?["0%{opacity:0;} 100%{opacity:1;}","0%{opacity:1;} 100%{opacity:0;}"]:[q(o),K(o)];return{animation:t?`${y(n)} 0.35s cubic-bezier(.21,1.02,.73,1) forwards`:`${y(r)} 0.4s forwards cubic-bezier(.06,.71,.55,1)`}})(t.position||o||"top-center",t.visible):{opacity:0},s=n.createElement(W,{toast:t}),l=n.createElement(J,{...t.ariaProps},b(t.message,t));return n.createElement(Y,{className:t.className,style:{...a,...r,...t.style}},"function"==typeof i?i({icon:s,message:l}):n.createElement(n.Fragment,null,s,l))}));!function(e,t,o,n){c.p=t,f=e,g=o,m=n}(n.createElement);var Q=e=>{let{id:t,className:o,style:r,onHeightUpdate:i,children:a}=e,s=n.useCallback((e=>{if(e){let o=()=>{let o=e.getBoundingClientRect().height;i(t,o)};o(),new MutationObserver(o).observe(e,{subtree:!0,childList:!0,characterData:!0})}}),[t,i]);return n.createElement("div",{ref:s,className:o,style:r},a)},Z=h`
  z-index: 9999;
  > * {
    pointer-events: auto;
  }
`,ee=e=>{let{reverseOrder:t,position:o="top-center",toastOptions:r,gutter:i,children:a,containerStyle:s,containerClassName:l}=e,{toasts:c,handlers:d}=D(r);return n.createElement("div",{id:"_rht_toaster",style:{position:"fixed",zIndex:9999,top:16,left:16,right:16,bottom:16,pointerEvents:"none",...s},className:l,onMouseEnter:d.startPause,onMouseLeave:d.endPause},c.map((e=>{let r=e.position||o,s=((e,t)=>{let o=e.includes("top"),n=o?{top:0}:{bottom:0},r=e.includes("center")?{justifyContent:"center"}:e.includes("right")?{justifyContent:"flex-end"}:{};return{left:0,right:0,display:"flex",position:"absolute",transition:w()?void 0:"all 230ms cubic-bezier(.21,1.02,.73,1)",transform:`translateY(${t*(o?1:-1)}px)`,...n,...r}})(r,d.calculateOffset(e,{reverseOrder:t,gutter:i,defaultPosition:o}));return n.createElement(Q,{id:e.id,key:e.id,onHeightUpdate:d.updateHeight,className:e.visible?Z:"",style:s},"custom"===e.type?b(e.message,e):a?a(e):n.createElement(X,{toast:e,position:r}))})))},te=A},3915:(e,t,o)=>{"use strict";o(5043),o(2963),o(5315);var n=o(766),r=o.n(n);r().configure({apiKey:"pat31Rx6dxZsbexBc.3227ebbc64cdb5888b6e3a628edebba82c42e8534bee68921887fbfd27434728"});r().base("appTMYAU4N43eJdxG");var i=o(1529);o(579);i.Ay.div`
  display: flex;
  justify-content: space-between;
  align-items: center;
  margin-bottom: 15px;
  padding-bottom: 15px;
  border-bottom: 1px solid #e5e7eb;

  h2 {
    margin: 0;
    font-size: 1.25rem;
    color: #111827;
    font-weight: 600;
  }

  button {
    background: none;
    border: none;
    cursor: pointer;
    color: #6b7280;
    padding: 4px;
    border-radius: 4px;
    
    &:hover {
      color: #1f2937;
      background-color: #f3f4f6;
    }
  }
`,i.Ay.form`
  display: flex;
  gap: 10px;
  width: 100%;
  margin-bottom: 20px;
`,i.Ay.input`
  flex: 1;
  padding: 6px 8px;
  border: 1px solid #d1d5db;
  border-radius: 4px;
  font-size: 0.75rem;
  outline: none;
  transition: border-color 0.2s;

  &:focus {
    border-color: #3b82f6;
    box-shadow: 0 0 0 3px rgba(59, 130, 246, 0.1);
  }
`,i.Ay.div`
  position: relative;
  margin-bottom: 10px;
  width: 100%;
`,i.Ay.div`
  position: absolute;
  left: 10px;
  top: 50%;
  transform: translateY(-50%);
  color: #6b7280;
`,i.Ay.div`
  position: absolute;
  width: 300px;
  max-height: 200px;
  overflow-y: auto;
  background-color: white;
  border: 1px solid #e5e7eb;
  border-radius: 6px;
  box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
  z-index: 10;
  margin-top: 2px;
`,i.Ay.button`
  display: flex;
  align-items: center;
  width: 100%;
  text-align: left;
  padding: 8px 12px;
  background: none;
  border: none;
  border-bottom: 1px solid #e5e7eb;
  font-size: 0.875rem;
  color: #4b5563;
  cursor: pointer;
  
  &:hover {
    background-color: #f3f4f6;
  }
  
  &:last-child {
    border-bottom: none;
  }
`,i.Ay.button`
  display: inline-flex;
  align-items: center;
  gap: 6px;
  padding: 2px 8px;
  background-color: transparent;
  color: #4b5563;
  border: none;
  border-radius: 16px;
  font-size: 0.75rem;
  font-weight: 500;
  cursor: pointer;
  transition: all 0.2s;
  
  &:hover {
    background-color: #f3f4f6;
  }
`,i.Ay.button`
  padding: 10px 16px;
  border-radius: 6px;
  font-size: 0.875rem;
  font-weight: 500;
  background-color: #000000;
  color: white;
  border: none;
  cursor: pointer;
  transition: background-color 0.2s;

  &:hover {
    background-color: #333333;
  }

  &:disabled {
    opacity: 0.5;
    cursor: not-allowed;
  }
`,i.Ay.div`
  display: grid;
  grid-template-columns: repeat(3, 1fr);
  gap: 20px;
  width: 100%;
  height: calc(100% - 140px);
  overflow: hidden;
`,i.Ay.div`
  background-color: white;
  border-radius: 8px;
  border: 1px solid #e5e7eb;
  overflow: hidden;
  display: flex;
  flex-direction: column;
  height: 100%;

  &.loading {
    opacity: 0.7;
  }
`,i.Ay.div`
  padding: 12px 16px;
  background-color: #f9fafb;
  border-bottom: 1px solid #e5e7eb;
  display: flex;
  justify-content: space-between;
  align-items: center;

  h3 {
    margin: 0;
    font-size: 1rem;
    font-weight: 600;
    color: #111827;
  }
`,i.Ay.div`
  padding: 16px;
  overflow-y: auto;
  flex: 1;
`,i.Ay.div`
  margin-bottom: 16px;
`,i.Ay.div`
  font-size: 0.75rem;
  font-weight: 600;
  color: #6b7280;
  margin-bottom: 4px;
  text-transform: uppercase;
`,i.Ay.div`
  font-size: 0.875rem;
  color: #111827;
  word-wrap: break-word;
  
  &.empty {
    color: #9ca3af;
    font-style: italic;
  }
`,i.Ay.input`
  width: 100%;
  padding: 6px 8px;
  border: 1px solid #d1d5db;
  border-radius: 4px;
  font-size: 0.875rem;
  color: #111827;
  
  &:focus {
    outline: none;
    border-color: #3b82f6;
    box-shadow: 0 0 0 2px rgba(59, 130, 246, 0.1);
  }
`,i.Ay.select`
  width: 100%;
  padding: 6px 8px;
  border: 1px solid #d1d5db;
  border-radius: 4px;
  font-size: 0.875rem;
  color: #111827;
  background-color: white;
  appearance: none;
  background-image: url("data:image/svg+xml;charset=utf-8,%3Csvg xmlns='http://www.w3.org/2000/svg' fill='none' viewBox='0 0 20 20'%3E%3Cpath stroke='%236B7280' stroke-linecap='round' stroke-linejoin='round' stroke-width='1.5' d='M6 8l4 4 4-4'/%3E%3C/svg%3E");
  background-position: right 0.5rem center;
  background-repeat: no-repeat;
  background-size: 1.5em 1.5em;
  
  &:focus {
    outline: none;
    border-color: #3b82f6;
    box-shadow: 0 0 0 2px rgba(59, 130, 246, 0.1);
  }
`,i.Ay.textarea`
  width: 100%;
  padding: 6px 8px;
  border: 1px solid #d1d5db;
  border-radius: 4px;
  font-size: 0.875rem;
  color: #111827;
  min-height: 80px;
  resize: vertical;
  
  &:focus {
    outline: none;
    border-color: #3b82f6;
    box-shadow: 0 0 0 2px rgba(59, 130, 246, 0.1);
  }
`,i.Ay.button`
  background: none;
  border: none;
  cursor: pointer;
  color: #6b7280;
  padding: 2px;
  margin-left: 5px;
  display: inline-flex;
  align-items: center;
  justify-content: center;
  
  &:hover {
    color: #2563eb;
  }
`,i.Ay.button`
  padding: 8px 16px;
  background-color: #10B981;
  color: white;
  border: none;
  border-radius: 4px;
  font-size: 0.875rem;
  font-weight: 500;
  cursor: pointer;
  margin-top: 20px;
  transition: background-color 0.2s;
  
  &:hover {
    background-color: #059669;
  }
  
  &:disabled {
    opacity: 0.5;
    cursor: not-allowed;
  }
`,i.Ay.div`
  display: flex;
  flex-wrap: wrap;
  gap: 6px;
  margin-top: 10px;
`,i.Ay.span`
  display: inline-flex;
  align-items: center;
  padding: 2px 8px;
  font-size: 0.75rem;
  border-radius: 16px;
  background-color: ${e=>e.color||"#f3f4f6"};
  color: ${e=>e.textColor||"#4b5563"};
  max-width: 150px;
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
  
  button {
    background: none;
    border: none;
    padding: 2px;
    cursor: pointer;
    color: inherit;
    opacity: 0.7;
    display: flex;
    align-items: center;
    justify-content: center;
    flex-shrink: 0;
    margin-left: 4px;

    &:hover {
      opacity: 1;
    }
  }
`,i.Ay.div`
  display: flex;
  flex-wrap: wrap;
  gap: 6px;
  margin-top: 10px;
`,i.Ay.span`
  display: inline-flex;
  align-items: center;
  padding: 2px 8px;
  font-size: 0.75rem;
  border-radius: 16px;
  background-color: #e0f2fe;
  color: #0369a1;
  max-width: 150px;
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
  
  button {
    background: none;
    border: none;
    padding: 2px;
    cursor: pointer;
    color: inherit;
    opacity: 0.7;
    display: flex;
    align-items: center;
    justify-content: center;
    flex-shrink: 0;
    margin-left: 4px;

    &:hover {
      opacity: 1;
    }
  }
`,i.Ay.div`
  display: flex;
  flex-wrap: wrap;
  gap: 6px;
  margin-top: 10px;
`,i.Ay.span`
  display: inline-flex;
  align-items: center;
  justify-content: center;
  padding: 2px 8px;
  font-size: 0.75rem;
  border-radius: 16px;
  background-color: white;
  color: black;
  border: 2px solid black;
  max-width: 150px;
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
  text-transform: uppercase;
  font-weight: 500;
  margin: 2px;
  
  span {
    display: flex;
    align-items: center;
    justify-content: center;
  }
  
  button {
    background: none;
    border: none;
    padding: 2px;
    cursor: pointer;
    color: inherit;
    opacity: 0.7;
    display: flex;
    align-items: center;
    justify-content: center;
    flex-shrink: 0;
    margin-left: 4px;

    &:hover {
      opacity: 1;
    }
  }
`,i.Ay.div`
  padding: 10px;
  border-radius: 4px;
  margin-bottom: 15px;
  font-size: 0.875rem;

  &.info {
    background-color: #e0f2fe;
    color: #0369a1;
  }

  &.error {
    background-color: #fee2e2;
    color: #b91c1c;
  }
`,i.Ay.a`
  color: #2563eb;
  text-decoration: none;
  display: inline-flex;
  align-items: center;
  gap: 4px;

  &:hover {
    text-decoration: underline;
  }
`,i.Ay.div`
  display: flex;
  justify-content: center;
  align-items: center;
  height: 100%;
  width: 100%;
`;const a=document.createElement("style");a.innerHTML="\n  @keyframes spin {\n    0% { transform: rotate(0deg); }\n    100% { transform: rotate(360deg); }\n  }\n",document.head.appendChild(a)},4202:(e,t)=>{"use strict";var o=Symbol.for("react.element"),n=Symbol.for("react.portal"),r=Symbol.for("react.fragment"),i=Symbol.for("react.strict_mode"),a=Symbol.for("react.profiler"),s=Symbol.for("react.provider"),l=Symbol.for("react.context"),c=Symbol.for("react.forward_ref"),d=Symbol.for("react.suspense"),u=Symbol.for("react.memo"),p=Symbol.for("react.lazy"),h=Symbol.iterator;var f={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},g=Object.assign,m={};function y(e,t,o){this.props=e,this.context=t,this.refs=m,this.updater=o||f}function v(){}function b(e,t,o){this.props=e,this.context=t,this.refs=m,this.updater=o||f}y.prototype.isReactComponent={},y.prototype.setState=function(e,t){if("object"!==typeof e&&"function"!==typeof e&&null!=e)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,e,t,"setState")},y.prototype.forceUpdate=function(e){this.updater.enqueueForceUpdate(this,e,"forceUpdate")},v.prototype=y.prototype;var x=b.prototype=new v;x.constructor=b,g(x,y.prototype),x.isPureReactComponent=!0;var w=Array.isArray,C=Object.prototype.hasOwnProperty,_={current:null},S={key:!0,ref:!0,__self:!0,__source:!0};function E(e,t,n){var r,i={},a=null,s=null;if(null!=t)for(r in void 0!==t.ref&&(s=t.ref),void 0!==t.key&&(a=""+t.key),t)C.call(t,r)&&!S.hasOwnProperty(r)&&(i[r]=t[r]);var l=arguments.length-2;if(1===l)i.children=n;else if(1<l){for(var c=Array(l),d=0;d<l;d++)c[d]=arguments[d+2];i.children=c}if(e&&e.defaultProps)for(r in l=e.defaultProps)void 0===i[r]&&(i[r]=l[r]);return{$$typeof:o,type:e,key:a,ref:s,props:i,_owner:_.current}}function k(e){return"object"===typeof e&&null!==e&&e.$$typeof===o}var j=/\/+/g;function A(e,t){return"object"===typeof e&&null!==e&&null!=e.key?function(e){var t={"=":"=0",":":"=2"};return"$"+e.replace(/[=:]/g,(function(e){return t[e]}))}(""+e.key):t.toString(36)}function R(e,t,r,i,a){var s=typeof e;"undefined"!==s&&"boolean"!==s||(e=null);var l=!1;if(null===e)l=!0;else switch(s){case"string":case"number":l=!0;break;case"object":switch(e.$$typeof){case o:case n:l=!0}}if(l)return a=a(l=e),e=""===i?"."+A(l,0):i,w(a)?(r="",null!=e&&(r=e.replace(j,"$&/")+"/"),R(a,t,r,"",(function(e){return e}))):null!=a&&(k(a)&&(a=function(e,t){return{$$typeof:o,type:e.type,key:t,ref:e.ref,props:e.props,_owner:e._owner}}(a,r+(!a.key||l&&l.key===a.key?"":(""+a.key).replace(j,"$&/")+"/")+e)),t.push(a)),1;if(l=0,i=""===i?".":i+":",w(e))for(var c=0;c<e.length;c++){var d=i+A(s=e[c],c);l+=R(s,t,r,d,a)}else if(d=function(e){return null===e||"object"!==typeof e?null:"function"===typeof(e=h&&e[h]||e["@@iterator"])?e:null}(e),"function"===typeof d)for(e=d.call(e),c=0;!(s=e.next()).done;)l+=R(s=s.value,t,r,d=i+A(s,c++),a);else if("object"===s)throw t=String(e),Error("Objects are not valid as a React child (found: "+("[object Object]"===t?"object with keys {"+Object.keys(e).join(", ")+"}":t)+"). If you meant to render a collection of children, use an array instead.");return l}function O(e,t,o){if(null==e)return e;var n=[],r=0;return R(e,n,"","",(function(e){return t.call(o,e,r++)})),n}function T(e){if(-1===e._status){var t=e._result;(t=t()).then((function(t){0!==e._status&&-1!==e._status||(e._status=1,e._result=t)}),(function(t){0!==e._status&&-1!==e._status||(e._status=2,e._result=t)})),-1===e._status&&(e._status=0,e._result=t)}if(1===e._status)return e._result.default;throw e._result}var D={current:null},P={transition:null},N={ReactCurrentDispatcher:D,ReactCurrentBatchConfig:P,ReactCurrentOwner:_};function I(){throw Error("act(...) is not supported in production builds of React.")}t.Children={map:O,forEach:function(e,t,o){O(e,(function(){t.apply(this,arguments)}),o)},count:function(e){var t=0;return O(e,(function(){t++})),t},toArray:function(e){return O(e,(function(e){return e}))||[]},only:function(e){if(!k(e))throw Error("React.Children.only expected to receive a single React element child.");return e}},t.Component=y,t.Fragment=r,t.Profiler=a,t.PureComponent=b,t.StrictMode=i,t.Suspense=d,t.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=N,t.act=I,t.cloneElement=function(e,t,n){if(null===e||void 0===e)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+e+".");var r=g({},e.props),i=e.key,a=e.ref,s=e._owner;if(null!=t){if(void 0!==t.ref&&(a=t.ref,s=_.current),void 0!==t.key&&(i=""+t.key),e.type&&e.type.defaultProps)var l=e.type.defaultProps;for(c in t)C.call(t,c)&&!S.hasOwnProperty(c)&&(r[c]=void 0===t[c]&&void 0!==l?l[c]:t[c])}var c=arguments.length-2;if(1===c)r.children=n;else if(1<c){l=Array(c);for(var d=0;d<c;d++)l[d]=arguments[d+2];r.children=l}return{$$typeof:o,type:e.type,key:i,ref:a,props:r,_owner:s}},t.createContext=function(e){return(e={$$typeof:l,_currentValue:e,_currentValue2:e,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null}).Provider={$$typeof:s,_context:e},e.Consumer=e},t.createElement=E,t.createFactory=function(e){var t=E.bind(null,e);return t.type=e,t},t.createRef=function(){return{current:null}},t.forwardRef=function(e){return{$$typeof:c,render:e}},t.isValidElement=k,t.lazy=function(e){return{$$typeof:p,_payload:{_status:-1,_result:e},_init:T}},t.memo=function(e,t){return{$$typeof:u,type:e,compare:void 0===t?null:t}},t.startTransition=function(e){var t=P.transition;P.transition={};try{e()}finally{P.transition=t}},t.unstable_act=I,t.useCallback=function(e,t){return D.current.useCallback(e,t)},t.useContext=function(e){return D.current.useContext(e)},t.useDebugValue=function(){},t.useDeferredValue=function(e){return D.current.useDeferredValue(e)},t.useEffect=function(e,t){return D.current.useEffect(e,t)},t.useId=function(){return D.current.useId()},t.useImperativeHandle=function(e,t,o){return D.current.useImperativeHandle(e,t,o)},t.useInsertionEffect=function(e,t){return D.current.useInsertionEffect(e,t)},t.useLayoutEffect=function(e,t){return D.current.useLayoutEffect(e,t)},t.useMemo=function(e,t){return D.current.useMemo(e,t)},t.useReducer=function(e,t,o){return D.current.useReducer(e,t,o)},t.useRef=function(e){return D.current.useRef(e)},t.useState=function(e){return D.current.useState(e)},t.useSyncExternalStore=function(e,t,o){return D.current.useSyncExternalStore(e,t,o)},t.useTransition=function(){return D.current.useTransition()},t.version="18.3.1"},4391:(e,t,o)=>{"use strict";var n=o(7950);t.H=n.createRoot,n.hydrateRoot},4462:(e,t,o)=>{"use strict";o.d(t,{A:()=>A});var n=o(5043),r=o(1529),i=o(2963),a=o.n(i),s=o(1009),l=o(5315),c=o(2115),d=o(579);a().setAppElement("#root");const u=r.Ay.div`
  display: flex;
  justify-content: space-between;
  align-items: center;
  margin-bottom: 20px;
  padding-bottom: 15px;
  border-bottom: 1px solid #333;

  h2 {
    margin: 0;
    font-size: 1.25rem;
    color: #00ff00;
    font-weight: 600;
    display: flex;
    align-items: center;
    gap: 8px;
  }

  button {
    background: none;
    border: none;
    cursor: pointer;
    color: #ffffff;
    padding: 4px;
    border-radius: 4px;
    
    &:hover {
      color: #ff5555;
    }
  }
`,p=r.Ay.div`
  margin-bottom: 20px;
`,h=r.Ay.h3`
  font-size: 16px;
  font-weight: bold;
  color: #00ff00;
  margin-bottom: 12px;
  display: flex;
  align-items: center;
  gap: 8px;
`,f=(r.Ay.div`
  margin-bottom: 20px;
`,r.Ay.label`
  display: block;
  margin-bottom: 8px;
  font-size: 14px;
  font-weight: 500;
  color: #00ff00;
  display: flex;
  align-items: center;
  gap: 6px;
  
  svg {
    opacity: 0.8;
  }
`,r.Ay.input`
  width: 100%;
  padding: 10px 12px;
  border: 1px solid #444;
  border-radius: 4px;
  font-size: 14px;
  color: #eee;
  background-color: #222;
  box-sizing: border-box;
  transition: all 0.2s;
  
  &:focus {
    outline: none;
    border-color: #00ff00;
  }
  
  &:hover {
    background-color: #333;
  }
  
  &::placeholder {
    color: #666;
  }
`),g=r.Ay.textarea`
  width: 100%;
  padding: 12px;
  border: 1px solid #444;
  border-radius: 4px;
  font-size: 14px;
  color: #eee;
  background-color: #222;
  min-height: 100px;
  resize: vertical;
  box-sizing: border-box;
  transition: all 0.2s;
  
  &:focus {
    outline: none;
    border-color: #00ff00;
  }
  
  &:hover {
    background-color: #333;
  }
  
  &::placeholder {
    color: #666;
  }
`,m=r.Ay.select`
  width: 100%;
  padding: 10px 12px;
  border: 1px solid #444;
  border-radius: 4px;
  font-size: 14px;
  color: #eee;
  background-color: #222;
  box-sizing: border-box;
  cursor: pointer;
  transition: all 0.2s;
  
  &:focus {
    outline: none;
    border-color: #00ff00;
  }
  
  &:hover {
    background-color: #333;
  }
  
  option {
    background-color: #222;
    color: #eee;
  }
`,y=r.Ay.div`
  position: relative;
  margin-bottom: 8px;
  width: 100%;
`,v=r.Ay.div`
  position: absolute;
  left: 12px;
  top: 50%;
  transform: translateY(-50%);
  color: #999;
`,b=r.Ay.div`
  position: absolute;
  top: 100%;
  left: 0;
  right: 0;
  background-color: #222;
  border: 1px solid #444;
  border-top: none;
  border-radius: 0 0 4px 4px;
  max-height: 200px;
  overflow-y: auto;
  z-index: 1000;
  box-shadow: 0 4px 8px rgba(0, 0, 0, 0.3);
  width: 100%;

  &::-webkit-scrollbar {
    width: 6px;
  }
  
  &::-webkit-scrollbar-track {
    background: #333;
  }
  
  &::-webkit-scrollbar-thumb {
    background-color: #00ff00;
    border-radius: 3px;
  }
`,x=r.Ay.div`
  padding: 10px 12px;
  color: #eee;
  cursor: pointer;
  border-bottom: 1px solid #333;
  font-size: 14px;
  transition: all 0.2s ease;
  width: 100%;
  box-sizing: border-box;

  &:hover {
    background-color: #333;
    color: #00ff00;
  }

  &:last-child {
    border-bottom: none;
  }
`,w=r.Ay.div`
  padding: 10px 12px;
  color: #00ff00;
  cursor: pointer;
  border-bottom: 1px solid #333;
  font-size: 14px;
  transition: all 0.2s ease;
  background-color: rgba(0, 255, 0, 0.05);
  font-style: italic;
  width: 100%;
  box-sizing: border-box;

  &:hover {
    background-color: rgba(0, 255, 0, 0.15);
  }

  &:last-child {
    border-bottom: none;
  }

  &:before {
    content: " ";
    margin-right: 4px;
  }
`,C=r.Ay.div`
  padding: 10px 12px;
  color: #666;
  font-style: italic;
  font-size: 12px;
  text-align: center;
  width: 100%;
  box-sizing: border-box;
`,_=r.Ay.div`
  display: flex;
  justify-content: flex-end;
  gap: 12px;
  margin-top: 20px;
  padding-top: 15px;
  border-top: 1px solid #333;
`,S=r.Ay.button`
  padding: 10px 16px;
  border-radius: 4px;
  font-size: 0.875rem;
  font-weight: 500;
  cursor: pointer;
  transition: all 0.2s;
  display: flex;
  align-items: center;
  gap: 8px;
  
  &.primary {
    background-color: #00ff00;
    color: black;
    border: none;
    
    &:hover {
      background-color: #00dd00;
    }

    &:disabled {
      opacity: 0.5;
      cursor: not-allowed;
    }
  }
  
  &.secondary {
    background-color: transparent;
    color: #ccc;
    border: 1px solid #555;
    
    &:hover {
      background-color: #333;
    }
  }
`,E=r.Ay.div`
  color: #ff5555;
  font-size: 12px;
  margin-top: 4px;
`,k=(r.Ay.div`
  padding: 8px 12px;
  border-radius: 4px;
  font-size: 12px;
  margin-top: 12px;
  
  &.success {
    background-color: rgba(0, 255, 0, 0.1);
    color: #00ff00;
  }
  
  &.error {
    background-color: rgba(255, 70, 70, 0.2);
    color: #ff9999;
  }
`,r.Ay.div`
  display: flex;
  flex-wrap: wrap;
  gap: 8px;
  margin-bottom: 16px;
  padding: 5px 0;
  min-height: 32px;
`),j=r.Ay.div`
  display: inline-flex;
  align-items: center;
  padding: 4px 8px;
  font-size: 0.75rem;
  border-radius: 4px;
  background-color: ${e=>e.color||"#222"};
  color: ${e=>e.textColor||"#00ff00"};
  font-weight: 500;
  margin-right: 0.25rem;
  margin-bottom: 0.25rem;
  border: 1px solid #00ff00;
  gap: 6px;
  max-width: 200px;

  span {
    white-space: nowrap;
    overflow: hidden;
    text-overflow: ellipsis;
    max-width: 150px;
  }

  button {
    background: none;
    border: none;
    padding: 0;
    display: inline-flex;
    align-items: center;
    justify-content: center;
    margin-left: 0.25rem;
    color: #00ff00;
    cursor: pointer;
    
    &:hover { 
      color: #ff5555; 
    }
  }
`,A=e=>{let{isOpen:t,onClose:o,onSave:r,preselectedContact:i}=e;const[A,R]=(0,n.useState)({notes:"",category:"",status:"Requested"}),[O,T]=(0,n.useState)({}),[D,P]=(0,n.useState)(!1),[N,I]=(0,n.useState)([]),[M,L]=(0,n.useState)(!1),[F,G]=(0,n.useState)(null),[z,H]=(0,n.useState)(""),[B,V]=(0,n.useState)([]);(0,n.useEffect)((()=>{if(t)if(R({notes:"",category:"",status:"Requested"}),T({}),I([]),L(!1),H(""),i){const e={id:i.contact_id,name:`${i.first_name||""} ${i.last_name||""}`.trim(),firstName:i.first_name,lastName:i.last_name,isExisting:!0};V([e])}else V([])}),[t,i]);const $=async e=>{if(console.log("fetchContactSuggestions called with:",e),!e||e.length<2)return console.log("Search term too short, clearing suggestions"),I([]),void L(!1);try{console.log("Fetching contacts from database...");const t=e.toLowerCase().trim(),o=t.split(/\s+/).filter((e=>e.length>0));let n=l.supabase.from("contacts").select("contact_id, first_name, last_name");if(1===o.length)n=n.or(`first_name.ilike.%${t}%,last_name.ilike.%${t}%`);else if(2===o.length){const[e,r]=o;n=n.or(`and(first_name.ilike.%${e}%,last_name.ilike.%${r}%),and(first_name.ilike.%${r}%,last_name.ilike.%${e}%),first_name.ilike.%${t}%,last_name.ilike.%${t}%`)}else{const e=o[0],r=o[o.length-1];n=n.or(`and(first_name.ilike.%${e}%,last_name.ilike.%${r}%),first_name.ilike.%${t}%,last_name.ilike.%${t}%`)}const{data:r,error:i}=await n.limit(10);if(i)throw i;console.log("Raw contact data from DB:",r);const a=r.map((e=>({id:e.contact_id,name:`${e.first_name||""} ${e.last_name||""}`.trim(),firstName:e.first_name,lastName:e.last_name,isExisting:!0}))).filter((e=>e.name));console.log("Processed suggestions:",a);const s=a.filter((e=>!B.some((t=>t.id===e.id))));console.log("Filtered suggestions (after removing selected):",s);!s.some((t=>t.name.toLowerCase()===e.toLowerCase()))&&e.trim()&&/^[a-zA-Z\s]+$/.test(e.trim())&&(s.push({id:"create-new",name:e.trim(),isExisting:!1,isCreateNew:!0}),console.log("Added create new contact option")),console.log("Final suggestions:",s),I(s),L(!0),console.log("showSuggestions set to true")}catch(t){console.error("Error fetching contact suggestions:",t),I([]),L(!1)}},U=e=>{const{name:t,value:o}=e.target;R((e=>({...e,[t]:o}))),O[t]&&T((e=>({...e,[t]:""})))},W=async e=>{try{let t=e;if(e.isCreateNew){const o=await(async e=>{try{const t=e.trim().split(/\s+/),o={first_name:t[0]||"",last_name:t.length>1?t.slice(1).join(" "):"",created_at:(new Date).toISOString(),category:"Inbox"},{data:n,error:r}=await l.supabase.from("contacts").insert([o]).select("contact_id, first_name, last_name").single();if(r)throw r;return c.oR.success(`New contact "${e}" created successfully!`),{id:n.contact_id,name:`${n.first_name||""} ${n.last_name||""}`.trim(),firstName:n.first_name,lastName:n.last_name,isExisting:!0}}catch(t){return console.error("Error creating new contact:",t),c.oR.error(`Failed to create contact: ${t.message}`),null}})(e.name);if(!o)return;t=o}V((e=>[...e,t])),H(""),L(!1),I([]),c.oR.success(`Contact "${t.name}" added`)}catch(t){console.error("Error adding contact:",t),c.oR.error(`Failed to add contact: ${t.message}`)}};(0,n.useEffect)((()=>()=>{F&&clearTimeout(F)}),[F]);return(0,d.jsx)(a(),{isOpen:t,onRequestClose:o,style:{content:{top:"50%",left:"50%",right:"auto",bottom:"auto",marginRight:"-50%",transform:"translate(-50%, -50%)",padding:"20px",border:"1px solid #333",backgroundColor:"#121212",color:"#e0e0e0",borderRadius:"8px",boxShadow:"0 4px 20px rgba(0, 0, 0, 0.6)",maxWidth:"600px",width:"90%",maxHeight:"90vh",overflow:"auto"},overlay:{backgroundColor:"rgba(0, 0, 0, 0.75)",zIndex:1e3}},children:(0,d.jsxs)("div",{style:{padding:"1rem"},children:[(0,d.jsxs)(u,{children:[(0,d.jsxs)("h2",{children:[(0,d.jsx)(s.cfS,{}),"Add New Introduction"]}),(0,d.jsx)("button",{onClick:o,disabled:D,children:(0,d.jsx)(s.yGN,{size:20})})]}),(0,d.jsxs)(p,{children:[(0,d.jsxs)(h,{children:[(0,d.jsx)(s.cfS,{}),"Selected Contacts *"]}),(0,d.jsxs)(k,{children:[B.map((e=>(0,d.jsxs)(j,{color:"#222",textColor:"#00ff00",children:[(0,d.jsx)("span",{title:e.name,children:e.name.length>25?`${e.name.substring(0,25)}...`:e.name}),(0,d.jsx)("button",{onClick:()=>{return t=e,V((e=>e.filter((e=>e.id!==t.id)))),void c.oR.success(`Contact "${t.name}" removed`);var t},disabled:D,children:(0,d.jsx)(s.yGN,{size:14})})]},e.id))),0===B.length&&(0,d.jsx)("span",{style:{color:"#6c757d",fontStyle:"italic",padding:"4px"},children:"No contacts selected"})]}),O.selectedContacts&&(0,d.jsx)(E,{children:O.selectedContacts})]}),(0,d.jsxs)(p,{children:[(0,d.jsxs)(h,{children:[(0,d.jsx)(s.CKj,{}),"Add Contacts"]}),(0,d.jsxs)(y,{children:[(0,d.jsx)(v,{children:(0,d.jsx)(s.CKj,{size:16})}),(0,d.jsx)(f,{type:"text",value:z,onChange:e=>{const t=e.target.value;H(t),console.log("Search term changed:",t),F&&clearTimeout(F);const o=setTimeout((()=>{console.log("Triggering search for:",t),$(t)}),300);G(o)},onFocus:()=>{z.length>=2&&L(!0)},onBlur:()=>{setTimeout((()=>{L(!1)}),150)},placeholder:"Search or create new contact...",style:{paddingLeft:"36px"}}),M&&(0,d.jsx)(b,{children:N.length>0?N.map((e=>e.isCreateNew?(0,d.jsxs)(w,{onClick:()=>W(e),children:["Create new contact: ",e.name]},e.id):(0,d.jsx)(x,{onClick:()=>W(e),children:e.name},e.id))):z.length>=2?(0,d.jsx)(C,{children:"No contacts found"}):null})]}),!1]}),(0,d.jsxs)(p,{children:[(0,d.jsxs)(h,{children:[(0,d.jsx)(s.jH2,{}),"Notes"]}),(0,d.jsx)(g,{name:"notes",value:A.notes,onChange:U,placeholder:"Enter introduction notes...",rows:4})]}),(0,d.jsxs)(p,{children:[(0,d.jsxs)(h,{children:[(0,d.jsx)(s.cnX,{}),"Category *"]}),(0,d.jsxs)(m,{name:"category",value:A.category,onChange:U,children:[(0,d.jsx)("option",{value:"",children:"Select category..."}),["Dealflow","Portfolio Company","Karma Points"].map((e=>(0,d.jsx)("option",{value:e,children:e},e)))]}),O.category&&(0,d.jsx)(E,{children:O.category})]}),(0,d.jsxs)(p,{children:[(0,d.jsxs)(h,{children:[(0,d.jsx)(s.z1n,{}),"Status"]}),(0,d.jsx)(m,{name:"status",value:A.status,onChange:U,children:["Promised","Requested","Done & Dust","Aborted","Done, but need to monitor"].map((e=>(0,d.jsx)("option",{value:e,children:e},e)))})]}),(0,d.jsxs)(_,{children:[(0,d.jsx)(S,{className:"secondary",onClick:o,disabled:D,children:"Cancel"}),(0,d.jsxs)(S,{className:"primary",onClick:async()=>{if((()=>{const e={};return 0===B.length&&(e.selectedContacts="At least one contact is required"),A.category||(e.category="Category is required"),T(e),0===Object.keys(e).length})()){P(!0);try{const e={text:A.notes||"",category:A.category,status:A.status,introduction_date:(new Date).toISOString().split("T")[0],created_at:(new Date).toISOString(),contact_ids:B.map((e=>e.id)),introduction_tool:"email"},{data:t,error:n}=await l.supabase.from("introductions").insert([e]).select().single();if(n)throw n;c.oR.success("Introduction added successfully!"),r&&r(t),o()}catch(e){console.error("Error saving introduction:",e),c.oR.error(`Failed to save introduction: ${e.message}`)}finally{P(!1)}}},disabled:D,children:[(0,d.jsx)(s.Bc_,{}),D?"Saving...":"Save Introduction"]})]}),D&&(0,d.jsx)("div",{style:{textAlign:"center",marginTop:"10px"},children:(0,d.jsx)("div",{className:"spinner",style:{width:"20px",height:"20px",border:"3px solid #222",borderTop:"3px solid #00ff00",borderRadius:"50%",animation:"spin 1s linear infinite",margin:"0 auto"}})})]})})},R=document.createElement("style");R.innerHTML="\n  @keyframes spin {\n    0% { transform: rotate(0deg); }\n    100% { transform: rotate(360deg); }\n  }\n",document.head.appendChild(R)},4473:(e,t,o)=>{"use strict";o.r(t),o.d(t,{default:()=>$});var n=o(5043),r=o(3216),i=o(1529),a=o(5315),s=o(8136),l=o(1009),c=o(579);const d=i.Ay.div`
  padding: 15px 15px 15px 15px;
  height: calc(100vh - 60px);
  width: 100%;
  display: flex;
  
  .action-cell-no-click {
    z-index: 5;
  }
`,u=i.Ay.div`
  width: 15%;
  padding-right: 15px;
  border-right: 1px solid #333;
`,p=i.Ay.div`
  width: 85%;
  padding-left: 15px;
  padding-right: 35px;
  overflow: hidden;
`,h=i.Ay.h3`
  color: #00ff00;
  font-family: 'Courier New', monospace;
  margin-bottom: 12px;
  padding-bottom: 8px;
  border-bottom: 1px solid #333;
  font-size: 0.9rem;
  text-transform: uppercase;
`,f=i.Ay.div`
  height: calc(100vh - 120px);
  overflow-y: auto;
  
  &::-webkit-scrollbar {
    width: 6px;
  }
  
  &::-webkit-scrollbar-track {
    background: #121212;
  }
  
  &::-webkit-scrollbar-thumb {
    background-color: #333;
    border-radius: 3px;
  }
`,g=i.Ay.div`
  padding: 6px 8px;
  margin-bottom: 4px;
  background-color: #1a1a1a;
  border-radius: 3px;
  border: 1px solid transparent;
  font-family: 'Courier New', monospace;
  font-size: 0.75rem;
  color: #cccccc;
  display: flex;
  justify-content: space-between;
  align-items: center;
  transition: all 0.2s ease;
  cursor: pointer;
  
  &:hover {
    border-color: #00ff00;
    background-color: #112211;
  }
`,m=i.Ay.span`
  overflow: hidden;
  text-overflow: ellipsis;
  white-space: nowrap;
  max-width: 75%;
`,y=i.Ay.span`
  background-color: #112211;
  color: #00ff00;
  border-radius: 10px;
  padding: 1px 6px;
  font-size: 0.7rem;
  min-width: 20px;
  text-align: center;
  margin-left: 4px;
`,v=i.Ay.div`
  color: #ff3333;
  background-color: #330000;
  padding: 15px;
  border-radius: 4px;
  margin-bottom: 20px;
`,b=i.Ay.div`
  color: #00ff00;
  text-align: center;
  padding: 40px;
  font-family: monospace;
  display: flex;
  flex-direction: column;
  align-items: center;
  justify-content: center;
  height: 400px;
`,x=i.Ay.div`
  width: 300px;
  height: 8px;
  background-color: #111;
  margin: 20px 0;
  border-radius: 4px;
  overflow: hidden;
  position: relative;
  box-shadow: 0 0 10px rgba(0, 255, 0, 0.2);
  
  &:before {
    content: "";
    position: absolute;
    top: 0;
    left: 0;
    height: 100%;
    width: 30%;
    background-color: #00ff00;
    animation: pulse 1.5s ease-in-out infinite;
    box-shadow: 0 0 20px #00ff00;
    border-radius: 4px;
  }
  
  @keyframes pulse {
    0% {
      left: -30%;
      opacity: 0.8;
    }
    100% {
      left: 100%;
      opacity: 0.2;
    }
  }
`,w=i.Ay.div`
  margin-top: 15px;
  color: #00ff00;
  text-shadow: 0 0 5px rgba(0, 255, 0, 0.5);
  letter-spacing: 1px;
  font-size: 16px;
  opacity: 0.9;
  animation: blink 1.5s ease-in-out infinite alternate;
  
  @keyframes blink {
    from { opacity: 0.6; }
    to { opacity: 1; }
  }
`,C=i.Ay.div`
  font-family: 'Courier New', monospace;
  font-size: 14px;
  color: #00ff00;
  text-align: center;
  margin-top: 30px;
  height: 100px;
  width: 300px;
  overflow: hidden;
  position: relative;
  
  &:after {
    content: "01001100 01101111 01100001 01100100 01101001 01101110 01100111 00100000 01000101 01101101 01100001 01101001 01101100 01110011 00101110 00101110 00101110";
    position: absolute;
    top: 0;
    left: 0;
    height: 100%;
    width: 100%;
    background: linear-gradient(to bottom, transparent, #000 80%);
    display: flex;
    flex-wrap: wrap;
    justify-content: center;
    opacity: 0.7;
    text-shadow: 0 0 5px #00ff00;
    animation: matrix 5s linear infinite;
  }
  
  @keyframes matrix {
    0% { transform: translateY(-60px); }
    100% { transform: translateY(60px); }
  }
`,_=i.Ay.button`
  background-color: ${e=>e.color||"transparent"};
  color: ${e=>e.textColor||"white"};
  border: 1px solid ${e=>e.borderColor||"transparent"};
  border-radius: 4px;
  padding: 5px 10px;
  margin: 0 5px;
  cursor: pointer;
  display: inline-flex;
  align-items: center;
  gap: 5px;
  font-size: 12px;
  
  &:hover {
    opacity: 0.8;
  }
`,S=i.Ay.div`
  position: fixed;
  top: 0;
  left: 0;
  right: 0;
  bottom: 0;
  background-color: rgba(0, 0, 0, 0.7);
  display: flex;
  justify-content: center;
  align-items: center;
  z-index: 1000;
`,E=i.Ay.div`
  background-color: #121212;
  border-radius: 8px;
  border: 1px solid #333;
  width: 90%;
  max-width: 800px;
  max-height: 90vh;
  display: flex;
  flex-direction: column;
  box-shadow: 0 5px 20px rgba(0, 0, 0, 0.5);
  overflow: hidden;
`,k=i.Ay.div`
  padding: 15px 20px;
  border-bottom: 1px solid #333;
  display: flex;
  justify-content: space-between;
  align-items: center;
`,j=i.Ay.h3`
  color: #00ff00;
  margin: 0;
  font-size: 1.2rem;
  font-family: 'Courier New', monospace;
`,A=i.Ay.button`
  background: none;
  border: none;
  color: #999;
  font-size: 24px;
  cursor: pointer;
  display: flex;
  align-items: center;
  justify-content: center;
  
  &:hover {
    color: #fff;
  }
`,R=i.Ay.div`
  padding: 20px;
  overflow-y: auto;
  flex: 1;
`,O=i.Ay.div`
  padding: 15px 20px;
  border-top: 1px solid #333;
  display: flex;
  justify-content: flex-end;
  align-items: center;
  gap: 10px;
`,T=i.Ay.div`
  margin-bottom: 20px;
`,D=i.Ay.div`
  display: flex;
  align-items: center;
  margin-bottom: 10px;
  font-family: 'Courier New', monospace;
`,P=i.Ay.div`
  color: #999;
  width: 120px;
  display: flex;
  align-items: center;
  gap: 8px;
`,N=i.Ay.div`
  color: #eee;
  flex: 1;
`,I=i.Ay.div`
  background-color: #1a1a1a;
  border: 1px solid #333;
  border-radius: 4px;
  padding: 20px;
  margin-top: 20px;
  font-family: 'Courier New', monospace;
  line-height: 1.6;
  white-space: pre-wrap;
  color: #ddd;
  max-height: 400px;
  overflow-y: auto;
`,M=i.Ay.div`
  font-size: 1.1rem;
  font-weight: bold;
  color: #00aaff;
  margin-bottom: 20px;
  border-bottom: 1px solid #333;
  padding-bottom: 10px;
`,L=e=>{const t=e.value||"Unknown";return(0,c.jsx)("div",{style:{fontSize:"0.85rem"},children:t})},F=e=>e.value?"sent"===e.value.toLowerCase()?(0,c.jsx)("div",{style:{display:"flex",alignItems:"center",justifyContent:"center",height:"100%",paddingTop:"8px"},children:(0,c.jsx)(l.kRp,{color:"#00aaff",size:18})}):(0,c.jsx)("div",{style:{display:"flex",alignItems:"center",justifyContent:"center",height:"100%",paddingTop:"8px"},children:(0,c.jsx)(l.dyV,{color:"#00ff00",size:18})}):null,G=i.Ay.div`
  position: absolute;
  top: -5px;
  left: 0;
  transform: translateY(-100%);
  background-color: #222;
  color: #fff;
  padding: 8px;
  border-radius: 4px;
  box-shadow: 0 2px 10px rgba(0, 0, 0, 0.2);
  z-index: 1000;
  max-width: 400px;
  word-wrap: break-word;
  opacity: 0;
  visibility: hidden;
  transition: opacity 0.1s ease, visibility 0.1s ease;
  font-family: 'Courier New', monospace;
  font-size: 0.85rem;
  pointer-events: none;
`,z=e=>{const t=e.value||"",o=t.length>100?t.substring(0,100)+"...":t,[r,i]=(0,n.useState)(!1);return(0,c.jsxs)("div",{style:{whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis",position:"relative"},onMouseEnter:()=>i(!0),onMouseLeave:()=>i(!1),children:[o,(0,c.jsx)(G,{style:{opacity:r?1:0,visibility:r?"visible":"hidden"},children:t})]})},H=e=>{const t=n.useRef(null),o=n.useRef(null);return n.useEffect((()=>{const n=t.current,r=o.current;if(!n||!r)return;const i=t=>(t.stopPropagation(),t.preventDefault(),t.stopImmediatePropagation(),setTimeout((()=>{e.onSkip&&e.onSkip(e.data)}),10),!1),a=t=>(t.stopPropagation(),t.preventDefault(),t.stopImmediatePropagation(),setTimeout((()=>{e.onAddToCRM&&e.onAddToCRM(e.data)}),10),!1);return n.addEventListener("click",i,!0),r.addEventListener("click",a,!0),()=>{n.removeEventListener("click",i,!0),r.removeEventListener("click",a,!0)}}),[e]),(0,c.jsxs)("div",{className:"action-buttons-container",style:{display:"flex",justifyContent:"center",alignItems:"center",paddingTop:"4px",paddingBottom:"0px",height:"100%"},onClick:e=>{e.stopPropagation(),e.preventDefault()},children:[(0,c.jsxs)("div",{ref:t,style:{backgroundColor:"#333",color:"#ff5555",border:"1px solid #ff5555",borderRadius:"4px",padding:"4px 8px",margin:"0 5px",cursor:"pointer",display:"inline-flex",alignItems:"center",gap:"5px",fontSize:"11px",height:"22px"},children:[(0,c.jsx)(l.q_G,{})," Spam"]}),(0,c.jsxs)("div",{ref:o,style:{backgroundColor:"#333",color:"#55ff55",border:"1px solid #55ff55",borderRadius:"4px",padding:"4px 8px",margin:"0 5px",cursor:"pointer",display:"inline-flex",alignItems:"center",gap:"5px",fontSize:"11px",height:"22px"},children:[(0,c.jsx)(l.A3x,{})," Add to CRM"]})]})},B=i.Ay.a`
  display: inline-flex;
  align-items: center;
  color: #00aaff;
  text-decoration: none;
  margin-left: auto;
  font-size: 0.9rem;
  gap: 5px;
  border: 1px solid #00aaff;
  border-radius: 4px;
  padding: 6px 10px;
  transition: all 0.2s ease;
  
  &:hover {
    background-color: rgba(0, 170, 255, 0.1);
    text-decoration: none;
  }
`,V=e=>{var t;let{email:o,onClose:n,onSkip:r,onAddToCRM:i}=e;if(!o)return null;const a="sent"===(null===(t=o.direction)||void 0===t?void 0:t.toLowerCase()),s=a?o.to_name:o.from_name,d=a?o.to_email:o.from_email,u=`https://mail.superhuman.com/search/${encodeURIComponent(d)}`;return(0,c.jsx)(S,{onClick:n,children:(0,c.jsxs)(E,{onClick:e=>e.stopPropagation(),children:[(0,c.jsxs)(k,{children:[(0,c.jsxs)(j,{children:[(0,c.jsx)(l.pHD,{style:{marginRight:"10px"}})," Email Details"]}),(0,c.jsxs)(B,{href:u,target:"_blank",rel:"noopener noreferrer",children:[(0,c.jsx)(l.HaR,{})," Original"]}),(0,c.jsx)(A,{onClick:n,style:{marginLeft:"15px"},children:"\xd7"})]}),(0,c.jsxs)(R,{children:[(0,c.jsxs)(T,{children:[(0,c.jsxs)(D,{children:[(0,c.jsxs)(P,{children:[(0,c.jsx)(l.JXP,{})," ",a?"To:":"From:"]}),(0,c.jsxs)(N,{children:[s," <",d,">"]})]}),(0,c.jsxs)(D,{children:[(0,c.jsxs)(P,{children:[(0,c.jsx)(l.JXP,{})," ",a?"From:":"To:"]}),(0,c.jsxs)(N,{children:["Simone Cimminelli <","simone@cimminelli.com",">"]})]}),(0,c.jsxs)(D,{children:[(0,c.jsxs)(P,{children:[(0,c.jsx)(l.wIk,{})," Date:"]}),(0,c.jsx)(N,{children:(e=>{if(!e)return"Unknown";return new Date(e).toLocaleString("en-US",{year:"numeric",month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"})})(o.message_timestamp)})]})]}),(0,c.jsx)(M,{children:o.subject||"(No Subject)"}),(0,c.jsxs)(I,{children:[(0,c.jsx)(l.mEP,{style:{marginRight:"10px",opacity:.6}}),o.message_text||"(No message content)"]})]}),(0,c.jsxs)(O,{children:[(0,c.jsxs)(_,{onClick:()=>{r(o),n()},color:"#333",textColor:"#ff5555",borderColor:"#ff5555",children:[(0,c.jsx)(l.q_G,{})," Spam"]}),(0,c.jsxs)(_,{onClick:()=>{i(o),n()},color:"#333",textColor:"#55ff55",borderColor:"#55ff55",children:[(0,c.jsx)(l.A3x,{})," Add to CRM"]})]})]})})},$=()=>{var e;const[t,o]=(0,n.useState)([]),[i,T]=(0,n.useState)([]),[D,P]=(0,n.useState)(!0),[N,I]=(0,n.useState)(!0),[M,G]=(0,n.useState)(null),[B,$]=(0,n.useState)(null),[U,W]=(0,n.useState)(null),[q,K]=(0,n.useState)(!1),[Y,J]=(0,n.useState)(!1),[X,Q]=(0,n.useState)(!1),[Z,ee]=(0,n.useState)(null),[te,oe]=(0,n.useState)(null),ne=((0,r.Zp)(),(0,n.useMemo)((()=>[{headerName:"",field:"direction",minWidth:50,width:50,cellRenderer:F,filter:!1,sortable:!0},{headerName:"Contact",field:"contact_name",valueGetter:e=>{var t;return e.data?"sent"===(null===(t=e.data.direction)||void 0===t?void 0:t.toLowerCase())?e.data.to_name:e.data.from_name:""},minWidth:100,width:120,cellRenderer:L,filter:!1,sortable:!0},{headerName:"Subject",field:"subject",minWidth:230,cellRenderer:z,filter:!1,sortable:!0},{headerName:"Message",field:"message_text",cellRenderer:z,minWidth:300,filter:!1,sortable:!0},{headerName:"Date",field:"message_timestamp",valueFormatter:e=>{if(!e.value)return"-";const t=new Date(e.value);return`${t.getDate().toString().padStart(2,"0")}/${(t.getMonth()+1).toString().padStart(2,"0")}/${t.getFullYear().toString().substr(-2)}`},minWidth:70,width:80,cellStyle:{fontSize:"0.85rem"},filter:!1,sortable:!0},{headerName:"Actions",field:"actions",minWidth:220,width:220,cellRenderer:H,cellRendererParams:{onSkip:se,onAddToCRM:le},sortable:!1,filter:!1,suppressSizeToFit:!0,cellClass:"action-cell-no-click"}]),[])),re=(0,n.useMemo)((()=>({resizable:!0,sortable:!0})),[]),ie=n.useCallback((e=>{console.log("Grid is ready"),W(e.api),setTimeout((()=>{e.api.sizeColumnsToFit()}),0)}),[]),ae=n.useCallback((e=>{e.colDef&&"Actions"===e.colDef.headerName||ee(e.data)}),[]);function se(e){console.log("Spam button clicked:",e),oe(e)}async function le(e){console.log("Add to CRM clicked:",e);try{const{error:n}=await a.supabase.from("email_inbox").update({special_case:null,last_processed_at:(new Date).toISOString()}).eq("id",e.id);if(n)throw n;o(t.filter((t=>t.id!==e.id))),console.log("Email marked for CRM processing:",e.id)}catch(n){console.error("Error processing email for CRM:",n)}}return(0,n.useEffect)((()=>{q||(console.log("Initiating email inbox data fetch"),(async()=>{try{P(!0),G(null);const{data:e,error:t}=await a.supabase.from("email_inbox").select("*").eq("special_case","pending_approval").order("message_timestamp",{ascending:!1});if(t)throw t;if(console.log(`Successfully fetched ${(null===e||void 0===e?void 0:e.length)||0} emails`),!e||0===e.length)return o([]),P(!1),K(!0),void Q(!0);o(e||[]),P(!1),K(!0),setTimeout((()=>{Q(!0)}),800)}catch(e){console.error("Error fetching emails:",e),G(e.message),P(!1)}})()),Y||(console.log("Initiating spam emails fetch"),(async()=>{try{I(!0),$(null);const{data:e,error:t}=await a.supabase.from("emails_spam").select("*").order("last_modified_at",{ascending:!1}).limit(25);if(t)throw t;console.log(`Successfully fetched ${(null===e||void 0===e?void 0:e.length)||0} spam emails`),T(e||[]),I(!1),J(!0)}catch(e){console.error("Error fetching spam emails:",e),$(e.message),I(!1)}})())}),[q,Y]),(0,n.useEffect)((()=>{if(!U)return;const e=()=>{U.sizeColumnsToFit()};return window.addEventListener("resize",e,{passive:!0}),()=>{window.removeEventListener("resize",e,{passive:!0})}}),[U]),(0,c.jsxs)(d,{children:[Z&&(0,c.jsx)(V,{email:Z,onClose:()=>ee(null),onSkip:se,onAddToCRM:le}),te&&(0,c.jsx)(S,{onClick:()=>oe(null),children:(0,c.jsxs)(E,{onClick:e=>e.stopPropagation(),style:{maxWidth:"400px",padding:"20px"},children:[(0,c.jsxs)(k,{children:[(0,c.jsxs)(j,{children:[(0,c.jsx)(l.q_G,{style:{marginRight:"10px",color:"#ff5555"}})," Confirm Spam"]}),(0,c.jsx)(A,{onClick:()=>oe(null),children:"\xd7"})]}),(0,c.jsxs)(R,{children:[(0,c.jsx)("p",{style:{marginBottom:"20px"},children:"Are you sure you want to mark this email as spam?"}),(0,c.jsxs)("div",{style:{backgroundColor:"#1a1a1a",padding:"10px",borderRadius:"4px",marginBottom:"20px"},children:[(0,c.jsxs)("p",{children:[(0,c.jsx)("strong",{children:"From:"})," ","sent"===(null===(e=te.direction)||void 0===e?void 0:e.toLowerCase())?te.to_name:te.from_name]}),(0,c.jsxs)("p",{children:[(0,c.jsx)("strong",{children:"Subject:"})," ",te.subject||"(No Subject)"]})]})]}),(0,c.jsxs)(O,{children:[(0,c.jsx)(_,{onClick:()=>oe(null),color:"#333",textColor:"#cccccc",borderColor:"#555",children:"Cancel"}),(0,c.jsxs)(_,{onClick:async function(){if(!te)return;const e=te;try{const{error:n}=await a.supabase.from("email_inbox").update({special_case:"reject",last_processed_at:(new Date).toISOString()}).eq("id",e.id);if(n)throw n;o(t.filter((t=>t.id!==e.id))),oe(null),console.log("Email marked as spam:",e.id)}catch(n){console.error("Error marking email as spam:",n)}},color:"#333",textColor:"#ff5555",borderColor:"#ff5555",children:[(0,c.jsx)(l.q_G,{})," Mark as Spam"]})]})]})}),(0,c.jsxs)(u,{children:[(0,c.jsx)(h,{children:"Spam Emails"}),N?(0,c.jsx)("div",{style:{padding:"10px",color:"#00ff00",textAlign:"center",fontSize:"0.75rem"},children:"Loading..."}):B?(0,c.jsxs)(v,{style:{fontSize:"0.75rem",padding:"8px"},children:["Error: ",B]}):0===i.length?(0,c.jsx)("div",{style:{padding:"10px",color:"#cccccc",textAlign:"center",fontSize:"0.75rem"},children:"No spam emails"}):(0,c.jsx)(f,{children:i.map(((e,t)=>(0,c.jsxs)(g,{onClick:()=>async function(e){console.log("Spam email clicked:",e);try{const{data:t,error:o}=await a.supabase.from("email_inbox").select("*").filter("from_email","eq",e.email).limit(1);if(o)throw o;t&&t.length>0?ee(t[0]):ee({id:`spam-${e.id||Date.now()}`,from_name:"Spam Sender",from_email:e.email,to_name:"You",to_email:"your.email@example.com",subject:"Spam Email",message_text:"This email was marked as spam.",message_timestamp:e.last_modified_at||(new Date).toISOString(),direction:"received"})}catch(t){console.error("Error fetching email details for spam:",t)}}(e),children:[(0,c.jsx)(m,{children:e.email&&e.email.length>40?`${e.email.substring(0,40)}...`:e.email}),(0,c.jsx)(y,{children:e.counter||1})]},t)))})]}),(0,c.jsxs)(p,{children:[M&&(0,c.jsxs)(v,{children:["Error: ",M]}),!1!==D?(0,c.jsxs)(b,{children:[(0,c.jsx)(w,{children:"string"===typeof D?D:"Accessing Email Database..."}),(0,c.jsx)(x,{}),(0,c.jsx)(C,{})]}):X||M?0!==t.length||M?(0,c.jsx)("div",{className:"ag-theme-alpine",style:{height:"calc(100vh - 120px)",width:"100%",overflow:"auto",margin:"15px 0 0 0",marginTop:"30px",opacity:X?1:0,transition:"opacity 0.5s ease-in-out","--ag-background-color":"#121212","--ag-odd-row-background-color":"#1a1a1a","--ag-header-background-color":"#222222","--ag-header-foreground-color":"#00ff00","--ag-foreground-color":"#e0e0e0","--ag-row-hover-color":"#2a2a2a","--ag-border-color":"#333333","--ag-range-selection-border-color":"#00ff00","--ag-range-selection-background-color":"rgba(0, 255, 0, 0.1)","--ag-selected-row-background-color":"#1a1a1a"},children:(0,c.jsx)(s.W,{rowData:t,columnDefs:ne,defaultColDef:re,onGridReady:ie,rowSelection:"single",animateRows:!0,pagination:!0,paginationPageSize:100,suppressCellFocus:!0,enableCellTextSelection:!0,rowHeight:42,domLayout:"autoHeight",paginationAutoPageSize:!0,sortingOrder:["desc","asc",null],sortModel:[{colId:"message_timestamp",sort:"desc"}],onRowClicked:ae,rowStyle:{cursor:"pointer"}})}):(0,c.jsxs)("div",{style:{padding:"40px",textAlign:"center",color:"#00ff00",background:"#121212",borderRadius:"8px",fontSize:"24px",fontWeight:"bold",display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",height:"300px"},children:[(0,c.jsx)("div",{style:{marginBottom:"15px"},children:"All records processed \ud83d\ude0a"}),(0,c.jsx)("div",{style:{fontSize:"48px",marginBottom:"20px"},children:"\u2713"})]}):(0,c.jsxs)(b,{children:[(0,c.jsx)(w,{children:"Preparing interface..."}),(0,c.jsx)(x,{}),(0,c.jsx)(C,{})]})]})]})}},4630:(e,t,o)=>{"use strict";o.r(t),o.d(t,{Headers:()=>a,Request:()=>s,Response:()=>l,default:()=>i,fetch:()=>r});var n=function(){if("undefined"!==typeof self)return self;if("undefined"!==typeof window)return window;if("undefined"!==typeof o.g)return o.g;throw new Error("unable to locate global object")}();const r=n.fetch,i=n.fetch.bind(n),a=n.Headers,s=n.Request,l=n.Response},4682:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function e(t){var o=[].slice.call(t.querySelectorAll("*"),0).reduce((function(t,o){return t.concat(o.shadowRoot?e(o.shadowRoot):[o])}),[]);return o.filter(s)};var o="none",n="contents",r=/^(input|select|textarea|button|object|iframe)$/;function i(e){var t=e.offsetWidth<=0&&e.offsetHeight<=0;if(t&&!e.innerHTML)return!0;try{var r=window.getComputedStyle(e),i=r.getPropertyValue("display");return t?i!==n&&function(e,t){return"visible"!==t.getPropertyValue("overflow")||e.scrollWidth<=0&&e.scrollHeight<=0}(e,r):i===o}catch(a){return console.warn("Failed to inspect element style"),!1}}function a(e,t){var o=e.nodeName.toLowerCase();return(r.test(o)&&!e.disabled||"a"===o&&e.href||t)&&function(e){for(var t=e,o=e.getRootNode&&e.getRootNode();t&&t!==document.body;){if(o&&t===o&&(t=o.host.parentNode),i(t))return!1;t=t.parentNode}return!0}(e)}function s(e){var t=e.getAttribute("tabindex");null===t&&(t=void 0);var o=isNaN(t);return(o||t>=0)&&a(e,!o)}e.exports=t.default},4762:(e,t,o)=>{"use strict";o.d(t,{A:()=>pe});var n=o(5043),r=o(1529),i=o(2963),a=o.n(i),s=o(1009),l=o(585),c=o(3768),d=o(579);a().setAppElement("#root");const u=r.Ay.div`
  display: flex;
  flex-direction: column;
  gap: 30px;
  width: 100%;
  max-height: 100%;
  overflow-y: auto;
  
  &::-webkit-scrollbar {
    width: 6px;
  }
  
  &::-webkit-scrollbar-track {
    background: #222;
  }
  
  &::-webkit-scrollbar-thumb {
    background-color: #00ff00;
    border-radius: 3px;
  }
`,p=r.Ay.div`
  display: flex;
  flex-direction: column;
  gap: 6px;
`,h=r.Ay.label`
  color: #00ff00;
  font-size: 13px;
  display: flex;
  align-items: center;
  gap: 6px;
  
  svg {
    opacity: 0.8;
  }
`,f="\n  background-color: #1a1a1a;\n  border: 1px solid #333;\n  border-radius: 4px;\n  color: #ccc;\n  padding: 10px 12px;\n  font-size: 14px;\n  width: 100%;\n  height: 42px; /* Fixed height for consistent appearance */\n  box-sizing: border-box;\n  \n  &:focus {\n    border-color: #00ff00;\n    outline: none;\n    box-shadow: 0 0 0 1px rgba(0, 255, 0, 0.3);\n  }\n  \n  &::placeholder {\n    color: #555;\n  }\n",g=r.Ay.input`
  ${f}
  
  &:disabled {
    background-color: #222;
    color: #666;
    cursor: not-allowed;
  }
`,m=r.Ay.select`
  ${f}
  cursor: pointer;
  appearance: none;
  background-image: url("data:image/svg+xml;charset=utf-8,%3Csvg xmlns='http://www.w3.org/2000/svg' width='16' height='16' viewBox='0 0 24 24' fill='none' stroke='%2300ff00' stroke-width='2' stroke-linecap='round' stroke-linejoin='round'%3E%3Cpolyline points='6 9 12 15 18 9'/%3E%3C/svg%3E");
  background-repeat: no-repeat;
  background-position: right 10px center;
  padding-right: 30px; /* Make room for the dropdown arrow */
  
  option {
    background-color: #1a1a1a;
    color: #ccc;
  }
`,y=r.Ay.textarea`
  ${f}
  min-height: 100px;
  height: auto;
  resize: vertical;
`,v=r.Ay.div`
  color: #ff5555;
  font-size: 12px;
  margin-top: 4px;
  display: flex;
  align-items: center;
  gap: 4px;
  
  svg {
    flex-shrink: 0;
  }
`,b=r.Ay.div`
  display: flex;
  gap: 20px;
  width: 100%;
  
  @media (max-width: 768px) {
    flex-direction: column;
  }
  
  > div {
    flex: 1;
    min-width: 0; /* Prevents flex children from overflowing */
  }
`,x=(r.Ay.div`
  font-size: 15px;
  color: #00ff00;
  margin: 25px 0 15px 0;
  padding-bottom: 8px;
  border-bottom: 1px solid #333;
  display: flex;
  align-items: center;
  
  svg {
    margin-right: 8px;
  }
`,r.Ay.div`
  color: #888;
  font-size: 12px;
  margin-top: 4px;
  font-style: italic;
`),w=r.Ay.button`
  background-color: rgba(0, 255, 0, 0.1);
  color: #00ff00;
  border: 1px solid #00ff00;
  padding: 10px 20px;
  border-radius: 4px;
  cursor: pointer;
  display: flex;
  align-items: center;
  gap: 8px;
  transition: all 0.2s;
  
  &:hover {
    background-color: rgba(0, 255, 0, 0.2);
    box-shadow: 0 0 8px rgba(0, 255, 0, 0.3);
  }
  
  &:disabled {
    opacity: 0.5;
    cursor: not-allowed;
    background-color: rgba(0, 255, 0, 0.05);
    &:hover {
      box-shadow: none;
    }
  }
`,C=r.Ay.div`
  display: flex;
  justify-content: space-between;
  align-items: center;
  padding-bottom: 15px;
  margin-bottom: 10px;
  border-bottom: 1px solid #333;

  h2 {
    color: #00ff00;
    margin: 0;
    font-size: 1.2rem;
    font-family: 'Courier New', monospace;
  }
`,_=r.Ay.div`
  display: flex;
  height: calc(100% - 70px); /* Account for header */
  width: 100%;
`,S=r.Ay.div`
  display: flex;
  flex-direction: column;
  width: 15%;
  border-right: 1px solid #333;
  min-height: 100%;
  background-color: #0a0a0a;
`,E=r.Ay.div`
  width: 85%;
  padding: 0 20px;
  overflow-y: auto;
`,k=r.Ay.div`
  padding: 15px 15px;
  cursor: pointer;
  color: ${e=>e.$isActive?"#00ff00":"#ccc"};
  border-left: 3px solid ${e=>e.$isActive?"#00ff00":"transparent"};
  font-weight: ${e=>e.$isActive?"bold":"normal"};
  background-color: ${e=>e.$isActive?"#121212":"transparent"};
  
  &:hover {
    color: #00ff00;
    background-color: rgba(0, 255, 0, 0.05);
  }
`,j=r.Ay.button`
  background: none;
  border: none;
  color: #ff5555;
  font-size: 1.2rem;
  cursor: pointer;
  display: flex;
  align-items: center;
  justify-content: center;
  
  &:hover {
    color: #ff0000;
  }
`,A=r.Ay.div`
  color: #cccccc;
  font-size: 0.9rem;
  min-height: 300px;
  height: 100%;
  display: flex;
  justify-content: center;
  align-items: center;
  flex-direction: column;
  padding: 20px;
`,R=(r.Ay.div`
  font-size: 1.2rem;
  color: #00ff00;
  text-align: center;
  font-family: 'Courier New', monospace;
  display: flex;
  flex-direction: column;
  justify-content: center;
  align-items: center;
  height: 100%;
  width: 100%;
  
  p {
    margin: 10px 0;
  }
  
  .emoji {
    font-size: 2rem;
    margin: 20px 0;
  }
`,r.Ay.div`
  color: #888;
  text-align: center;
  padding: 40px 20px;
  display: flex;
  flex-direction: column;
  align-items: center;
  justify-content: center;
  height: 100%;
  
  h3 {
    color: #00ff00;
    margin-bottom: 15px;
    font-size: 1.1rem;
    font-family: 'Courier New', monospace;
  }
  
  p {
    font-size: 0.9rem;
    margin-bottom: 25px;
    max-width: 400px;
  }
  
  svg {
    margin-bottom: 20px;
    color: #00ff00;
    opacity: 0.6;
  }
`),O=r.Ay.button`
  background-color: rgba(0, 255, 0, 0.1);
  color: #00ff00;
  border: 1px solid #00ff00;
  border-radius: 4px;
  padding: 10px 20px;
  font-size: 0.9rem;
  cursor: pointer;
  display: flex;
  align-items: center;
  gap: 8px;
  transition: all 0.2s;
  
  &:hover {
    background-color: rgba(0, 255, 0, 0.2);
    box-shadow: 0 0 8px rgba(0, 255, 0, 0.3);
  }
`,T=r.Ay.div`
  width: 100%;
  height: 100%;
  overflow-y: auto;
  padding: 10px 15px;
  
  &::-webkit-scrollbar {
    width: 6px;
  }
  
  &::-webkit-scrollbar-track {
    background: #222;
  }
  
  &::-webkit-scrollbar-thumb {
    background-color: #00ff00;
    border-radius: 3px;
  }
`,D=r.Ay.div`
  background-color: #1a1a1a;
  border: 1px solid #333;
  border-left: 3px solid #00ff00;
  border-radius: 4px;
  padding: 15px;
  margin-bottom: 15px;
  transition: all 0.2s;
  
  &:hover {
    border-color: #00ff00;
    box-shadow: 0 0 8px rgba(0, 255, 0, 0.2);
  }
`,P=r.Ay.div`
  background-color: rgba(0, 255, 0, 0.15);
  color: #00ff00;
  font-size: 11px;
  padding: 3px 8px;
  border-radius: 3px;
  display: inline-block;
  margin-left: 10px;
  font-weight: bold;
  text-transform: capitalize;
`,N=r.Ay.div`
  display: flex;
  margin-bottom: 8px;
  font-size: 13px;
`,I=r.Ay.div`
  width: 120px;
  color: #888;
  padding-right: 10px;
`,M=r.Ay.div`
  color: #ccc;
  flex: 1;
`,L=r.Ay.div`
  margin-top: 15px;
  padding: 10px;
  background-color: rgba(255, 255, 255, 0.05);
  border-radius: 4px;
  font-size: 13px;
  color: #aaa;
  
  .label {
    color: #888;
    margin-bottom: 5px;
    font-size: 12px;
  }
`,F=r.Ay.div`
  font-size: 13px;
  color: #888;
  margin: 15px 0 5px 0;
  padding-bottom: 5px;
  border-bottom: 1px solid #333;
  display: flex;
  align-items: center;
  
  svg {
    margin-right: 5px;
  }
`,G=r.Ay.div`
  display: flex;
  flex-wrap: wrap;
  gap: 5px;
  margin-top: 5px;
`,z=r.Ay.div`
  background-color: rgba(0, 255, 0, 0.1);
  color: #00ff00;
  font-size: 11px;
  padding: 3px 8px;
  border-radius: 12px;
  display: inline-flex;
  align-items: center;
  
  svg {
    margin-right: 4px;
    font-size: 10px;
  }
`,H=r.Ay.div`
  position: absolute;
  top: 100%;
  left: 0;
  right: 0;
  max-height: 150px;
  overflow-y: auto;
  background-color: #1a1a1a;
  border: 1px solid #333;
  border-top: none;
  border-radius: 0 0 4px 4px;
  box-shadow: 0 4px 8px rgba(0, 0, 0, 0.3);
  z-index: 1000;
  
  &::-webkit-scrollbar {
    width: 6px;
  }
  
  &::-webkit-scrollbar-track {
    background: #222;
  }
  
  &::-webkit-scrollbar-thumb {
    background-color: #00ff00;
    border-radius: 3px;
  }
`,B=r.Ay.div`
  padding: 8px 12px;
  cursor: pointer;
  color: #ccc;
  
  &:hover {
    background-color: #333;
    color: #00ff00;
  }
  
  &.highlight {
    background-color: #333;
    color: #00ff00;
  }
`,V=r.Ay.div`
  margin-top: 5px;
`,$=r.Ay.div`
  display: flex;
  align-items: center;
  justify-content: space-between;
  background-color: #1f1f1f;
  padding: 8px 10px;
  border-radius: 4px;
  margin-bottom: 5px;
  font-size: 12px;
  
  .attachment-name {
    display: flex;
    align-items: center;
    color: #ccc;
    
    svg {
      margin-right: 5px;
      color: #00ff00;
    }
  }
`,U=r.Ay.button`
  background: none;
  border: none;
  color: #00ff00;
  cursor: pointer;
  display: flex;
  align-items: center;
  font-size: 11px;
  opacity: 0.7;
  
  &:hover {
    opacity: 1;
  }
  
  svg {
    margin-right: 3px;
  }
`,W=r.Ay.div`
  display: flex;
  justify-content: flex-end;
  margin-top: 15px;
  gap: 10px;
`,q=r.Ay.div`
  display: flex;
  gap: 8px;
  overflow-x: auto;
  padding: 10px 15px;
  margin-bottom: 15px;
  border-bottom: 1px solid #333;
  
  &::-webkit-scrollbar {
    height: 4px;
  }
  
  &::-webkit-scrollbar-track {
    background: #222;
  }
  
  &::-webkit-scrollbar-thumb {
    background-color: #00ff00;
    border-radius: 3px;
  }
`,K=r.Ay.button`
  background-color: ${e=>e.$isActive?"rgba(0, 255, 0, 0.15)":"#1a1a1a"};
  color: ${e=>e.$isActive?"#00ff00":"#ccc"};
  border: 1px solid ${e=>e.$isActive?"#00ff00":"#333"};
  border-radius: 20px;
  padding: 5px 12px;
  font-size: 12px;
  cursor: pointer;
  white-space: nowrap;
  display: flex;
  align-items: center;
  gap: 5px;
  transition: all 0.2s;
  
  &:hover {
    background-color: ${e=>e.$isActive?"rgba(0, 255, 0, 0.15)":"rgba(0, 255, 0, 0.05)"};
    border-color: #00ff00;
    color: #00ff00;
  }
  
  .badge {
    background-color: ${e=>e.$isActive?"rgba(0, 255, 0, 0.3)":"rgba(255, 255, 255, 0.1)"};
    color: ${e=>e.$isActive?"#00ff00":"#aaa"};
    font-size: 10px;
    padding: 1px 5px;
    border-radius: 10px;
    margin-left: 5px;
  }
`,Y=r.Ay.button`
  background-color: transparent;
  color: #ccc;
  border: 1px solid #444;
  border-radius: 4px;
  padding: 5px 10px;
  font-size: 11px;
  cursor: pointer;
  display: flex;
  align-items: center;
  gap: 5px;
  
  &:hover {
    background-color: rgba(0, 255, 0, 0.05);
    border-color: #00ff00;
    color: #00ff00;
  }
  
  &.danger {
    &:hover {
      background-color: rgba(255, 0, 0, 0.1);
      border-color: #ff5555;
      color: #ff5555;
    }
  }
`,J=r.Ay.div`
  margin-bottom: 20px;
  width: 100%;
  padding: 0 15px;
`,X=r.Ay.div`
  display: flex;
  align-items: center;
  background-color: #1a1a1a;
  border: 1px solid #333;
  border-radius: 4px;
  padding: 8px 12px;
  margin-bottom: 10px;
  width: 100%;
  
  svg {
    color: #666;
    margin-right: 8px;
  }
  
  input {
    background: none;
    border: none;
    color: #ccc;
    font-size: 14px;
    width: 100%;
    outline: none;
    
    &::placeholder {
      color: #666;
    }
  }
`,Q=r.Ay.div`
  color: #00ff00;
  font-size: 12px;
  margin-top: 5px;
  cursor: pointer;
  display: flex;
  align-items: center;
  
  span {
    margin-left: 5px;
    padding: 3px 8px;
    background-color: rgba(0, 255, 0, 0.1);
    border-radius: 4px;
    
    &:hover {
      background-color: rgba(0, 255, 0, 0.2);
    }
  }
`,Z=r.Ay.div`
  display: flex;
  flex-wrap: wrap;
  gap: 8px;
  margin-bottom: 20px;
  padding: 0 15px 15px 15px;
  border-bottom: 1px solid #333;
  overflow-x: auto;
  width: 100%;
  scrollbar-width: thin;
  scrollbar-color: #00ff00 #222;
  
  &::-webkit-scrollbar {
    height: 4px;
  }
  
  &::-webkit-scrollbar-track {
    background: #222;
  }
  
  &::-webkit-scrollbar-thumb {
    background-color: #00ff00;
    border-radius: 3px;
  }
`,ee=r.Ay.button`
  background-color: ${e=>e.$active?"rgba(0, 255, 0, 0.15)":"#1a1a1a"};
  color: ${e=>e.$active?"#00ff00":"#ccc"};
  border: 1px solid ${e=>e.$active?"#00ff00":"#333"};
  border-radius: 4px;
  padding: 6px 12px;
  font-size: 12px;
  cursor: pointer;
  white-space: nowrap;
  
  &:hover {
    background-color: ${e=>e.$active?"rgba(0, 255, 0, 0.15)":"rgba(0, 255, 0, 0.05)"};
    border-color: ${e=>e.$active?"#00ff00":"#444"};
  }
`,te=r.Ay.div`
  height: calc(100% - 150px);
  overflow-y: auto;
  width: 100%;
  padding: 0 15px;
  
  &::-webkit-scrollbar {
    width: 6px;
  }
  
  &::-webkit-scrollbar-track {
    background: #222;
  }
  
  &::-webkit-scrollbar-thumb {
    background-color: #00ff00;
    border-radius: 3px;
  }
`,oe=r.Ay.div`
  background-color: #1a1a1a;
  border: ${e=>e.$isAssociated?"2px solid #00ff00":"1px solid #333"};
  border-radius: 4px;
  padding: 12px;
  margin-bottom: 10px;
  cursor: pointer;
  transition: all 0.2s;
  position: relative;
  
  &:hover {
    border-color: #00ff00;
    box-shadow: 0 0 5px rgba(0, 255, 0, 0.2);
  }
  
  ${e=>e.$isAssociated&&`\n    box-shadow: 0 0 8px rgba(0, 255, 0, 0.3);\n    \n    &::after {\n      content: '${e=>e.$relationship?`Associated (${e.$relationship})`:"Associated"}';\n      position: absolute;\n      top: 8px;\n      right: 8px;\n      background-color: rgba(0, 255, 0, 0.2);\n      color: #00ff00;\n      font-size: 10px;\n      padding: 2px 6px;\n      border-radius: 3px;\n      font-weight: bold;\n    }\n  `}
`,ne=r.Ay.div`
  display: flex;
  justify-content: space-between;
  margin-bottom: 8px;
`,re=r.Ay.div`
  font-weight: bold;
  color: #00ff00;
  font-size: 14px;
`,ie=r.Ay.div`
  font-size: 11px;
  color: #ccc;
  background-color: rgba(255, 255, 255, 0.1);
  padding: 2px 6px;
  border-radius: 3px;
`,ae=r.Ay.div`
  font-size: 12px;
  color: #aaa;
  margin-bottom: 8px;
`,se=r.Ay.div`
  font-size: 11px;
  color: #888;
  text-align: right;
`,le=r.Ay.div`
  display: flex;
  justify-content: space-between;
  align-items: center;
  margin-top: 10px;
`,ce=r.Ay.button`
  background-color: ${e=>e.$isAssociated?"rgba(0, 255, 0, 0.15)":"transparent"};
  color: ${e=>e.$isAssociated?"#00ff00":"#ccc"};
  border: 1px solid ${e=>e.$isAssociated?"#00ff00":"#444"};
  border-radius: 4px;
  padding: 5px 10px;
  font-size: 11px;
  cursor: pointer;
  display: flex;
  align-items: center;
  gap: 5px;
  transition: all 0.2s;
  
  &:hover {
    background-color: ${e=>e.$isAssociated?"rgba(0, 255, 0, 0.15)":"rgba(0, 255, 0, 0.05)"};
    border-color: #00ff00;
    color: #00ff00;
  }
  
  &:disabled {
    opacity: 0.5;
    cursor: not-allowed;
  }
`,de=r.Ay.div`
  color: #666;
  text-align: center;
  padding: 40px 0;
  font-style: italic;
`,ue=r.Ay.div`
  display: flex;
  justify-content: flex-end;
  gap: 15px;
  position: absolute;
  bottom: 25px;
  right: 25px;
  width: calc(100% - 50px);
  z-index: 10;
`,pe=(r.Ay.button`
  background-color: transparent;
  color: #cccccc;
  border: 1px solid #555;
  padding: 10px 20px;
  border-radius: 4px;
  cursor: pointer;
  display: flex;
  align-items: center;
  gap: 8px;
  
  &:hover {
    background-color: #333;
  }
`,e=>{var t;let{isOpen:r,onClose:i,contactData:f,showOnlyCreateTab:pe=!1,onSave:he,inline:fe=!1}=e;const[ge,me]=(0,n.useState)(pe?"createNewDeal":"addFromList"),[ye,ve]=(0,n.useState)(""),[be,xe]=(0,n.useState)("All"),[we,Ce]=(0,n.useState)([]),[_e,Se]=(0,n.useState)([]),[Ee,ke]=(0,n.useState)({}),[je,Ae]=(0,n.useState)(!1),[Re,Oe]=(0,n.useState)({}),[Te,De]=(0,n.useState)({}),[Pe,Ne]=(0,n.useState)(0),[Ie,Me]=(0,n.useState)(!1),[Le,Fe]=(0,n.useState)(null);(0,n.useEffect)((()=>{(async()=>{if(console.log("=== DealViewFindAddModal fetchData DEBUG ==="),console.log("contactData:",f),console.log("contactData.contact_id:",null===f||void 0===f?void 0:f.contact_id),null!==f&&void 0!==f&&f.contact_id){console.log("\u2705 Proceeding with data fetch...");try{const{supabase:t}=await Promise.resolve().then(o.bind(o,5315));console.log("\ud83d\udd0d Fetching all deals...");const{data:n,error:r}=await t.from("deals").select("\n            deal_id,\n            opportunity,\n            source_category,\n            introducer,\n            category,\n            stage,\n            description,\n            total_investment,\n            created_by,\n            created_at,\n            last_modified_by,\n            last_modified_at\n          ").order("created_at",{ascending:!1});if(console.log("Deals query result:",{dealsData:n,dealsError:r}),r)return void console.error("Error fetching deals:",r);console.log("\ud83d\udd0d Fetching deal associations for contact:",f.contact_id);const{data:i,error:a}=await t.from("deals_contacts").select("deal_id, relationship").eq("contact_id",f.contact_id);if(console.log("Associations query result:",{associationsData:i,associationsError:a}),a)return void console.error("Error fetching deal associations:",a);const s=(null===i||void 0===i?void 0:i.map((e=>e.deal_id)))||[],l={};if(null===i||void 0===i||i.forEach((e=>{l[e.deal_id]=e.relationship})),console.log("\ud83d\udcdd Setting deals state:",{dealsCount:(null===n||void 0===n?void 0:n.length)||0,associatedIdsCount:s.length,associatedIds:s,relationshipMap:l}),Ce(n||[]),Se(s),ke(l),s.length>0){try{const{data:e,error:o}=await t.from("deal_tags").select("\n                entry_id,\n                deal_id,\n                tag_id,\n                created_at\n              ").in("deal_id",s);if(o)console.error("Error fetching deal tags:",o);else if(e&&e.length>0){const o=e.map((e=>e.tag_id)),{data:n,error:r}=await t.from("tags").select("tag_id, name").in("tag_id",o);if(r)console.error("Error fetching tag details:",r);else{const t={};null===n||void 0===n||n.forEach((e=>{t[e.tag_id]=e}));const o={};e.forEach((e=>{o[e.deal_id]||(o[e.deal_id]=[]);const n=t[e.tag_id];n&&o[e.deal_id].push({entry_id:e.entry_id,tag_id:e.tag_id,name:n.name,created_at:e.created_at})})),console.log("Tag data:",{tagsByDeal:o,tagsData:e,tagDetails:n}),Oe(o)}}}catch(e){console.error("Error fetching deal tags:",e)}try{const{data:e,error:o}=await t.from("deal_attachments").select("\n                deal_attachment_id,\n                deal_id,\n                attachment_id,\n                created_at,\n                created_by\n              ").in("deal_id",s);if(o)console.error("Error fetching deal attachments:",o);else if(e&&e.length>0){const o=e.map((e=>e.attachment_id)),{data:n,error:r}=await t.from("attachments").select("attachment_id, file_name, file_url, file_type, file_size").in("attachment_id",o);if(r)console.error("Error fetching attachment details:",r);else{const t={};null===n||void 0===n||n.forEach((e=>{t[e.attachment_id]=e}));const o={};e.forEach((e=>{o[e.deal_id]||(o[e.deal_id]=[]);const n=t[e.attachment_id];n&&o[e.deal_id].push({deal_attachment_id:e.deal_attachment_id,attachment_id:e.attachment_id,filename:n.file_name,file_url:n.file_url,file_type:n.file_type,file_size:n.file_size,created_at:e.created_at,created_by:e.created_by})})),De(o)}}}catch(e){console.error("Error fetching deal attachments:",e)}}}catch(e){console.error("Error in data fetch operation:",e)}}else console.log("\u274c No contactData.contact_id - exiting fetchData")})()}),[null===f||void 0===f?void 0:f.contact_id]);const Ge=[...we.filter((e=>{const t=""===ye||e.opportunity.toLowerCase().includes(ye.toLowerCase())||e.description&&e.description.toLowerCase().includes(ye.toLowerCase()),o="All"===be||e.category===be;return t&&o}))].sort(((e,t)=>new Date(t.created_at)-new Date(e.created_at))),ze=(null===f||void 0===f||null===(t=f.companies)||void 0===t?void 0:t.map((e=>e.name)))||[],He=e=>{ve(e.target.value)},Be=e=>{xe(e)},Ve=e=>e?new Intl.NumberFormat("en-US",{style:"currency",currency:"USD",maximumFractionDigits:0}).format(e):"N/A",$e=e=>new Date(e).toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric"}),Ue=async e=>{if(null!==f&&void 0!==f&&f.contact_id&&!je){Ae(!0);try{const{supabase:t}=await Promise.resolve().then(o.bind(o,5315));if(_e.includes(e)){const{error:o}=await t.from("deals_contacts").delete().eq("contact_id",f.contact_id).eq("deal_id",e);if(o)throw o;Se((t=>t.filter((t=>t!==e)))),ke((t=>{const o={...t};return delete o[e],o})),c.Ay.success("Deal disassociated from contact")}else{const{error:o}=await t.from("deals_contacts").insert({contact_id:f.contact_id,deal_id:e,relationship:"proposer",created_at:(new Date).toISOString()});if(o)throw o;Se((t=>[...t,e])),ke((t=>({...t,[e]:"proposer"}))),c.Ay.success("Deal associated with contact as proposer")}}catch(t){console.error("Error toggling deal association:",t),c.Ay.error(`Failed to update association: ${t.message||"Unknown error"}`)}finally{Ae(!1)}}},We=()=>(0,d.jsxs)(A,{style:{alignItems:"flex-start",padding:"0 10px"},children:[(0,d.jsxs)(J,{children:[(0,d.jsxs)(X,{children:[(0,d.jsx)(s.CKj,{size:16}),(0,d.jsx)("input",{type:"text",placeholder:"Search deals by name or description...",value:ye,onChange:He})]}),ze.length>0&&(0,d.jsxs)(Q,{children:["Search for company:",ze.map(((e,t)=>(0,d.jsx)("span",{onClick:()=>(e=>{ve(e)})(e),children:e},t)))]})]}),(0,d.jsxs)(Z,{children:[(0,d.jsx)(ee,{$active:"All"===be,onClick:()=>Be("All"),children:"All Deals"}),(0,d.jsx)(ee,{$active:"Startup"===be,onClick:()=>Be("Startup"),children:"Startup"}),(0,d.jsx)(ee,{$active:"Fund"===be,onClick:()=>Be("Fund"),children:"Fund"}),(0,d.jsx)(ee,{$active:"Real Estate"===be,onClick:()=>Be("Real Estate"),children:"Real Estate"}),(0,d.jsx)(ee,{$active:"Private Debt"===be,onClick:()=>Be("Private Debt"),children:"Private Debt"}),(0,d.jsx)(ee,{$active:"Private Equity"===be,onClick:()=>Be("Private Equity"),children:"Private Equity"}),(0,d.jsx)(ee,{$active:"Others"===be,onClick:()=>Be("Others"),children:"Others"}),(0,d.jsx)(ee,{$active:"Inbox"===be,onClick:()=>Be("Inbox"),children:"Inbox"})]}),(0,d.jsx)(te,{children:0===Ge.length?(0,d.jsx)(de,{children:"No deals found matching your criteria"}):Ge.map((e=>{const t=_e.includes(e.deal_id),o=Ee[e.deal_id];return(0,d.jsxs)(oe,{$isAssociated:t,$relationship:o,children:[(0,d.jsxs)(ne,{children:[(0,d.jsx)(re,{children:e.opportunity}),(0,d.jsx)(ie,{children:e.category})]}),(0,d.jsxs)(ae,{children:[(0,d.jsxs)("div",{children:["Stage: ",e.stage]}),(0,d.jsxs)("div",{children:["Investment: ",Ve(e.total_investment)]}),e.description&&(0,d.jsx)("div",{children:e.description}),"Not Set"!==e.source_category&&(0,d.jsxs)("div",{children:["Source: ",e.source_category]})]}),(0,d.jsxs)(le,{children:[(0,d.jsxs)(se,{children:["Added: ",$e(e.created_at)]}),(0,d.jsx)(ce,{$isAssociated:t,onClick:t=>{t.stopPropagation(),Ue(e.deal_id)},disabled:je,children:t?(0,d.jsxs)(d.Fragment,{children:[(0,d.jsx)(s.YrT,{size:12})," Associated"]}):(0,d.jsxs)(d.Fragment,{children:[(0,d.jsx)(s.ayE,{size:12})," Associate"]})})]})]},e.deal_id)}))})]}),qe=()=>{const[e,t]=(0,n.useState)({opportunity:"",source_category:"Not Set",category:"Inbox",stage:"Lead",description:"",total_investment:"",attachment:"None",tags:[]}),[r,a]=(0,n.useState)({}),[l,C]=(0,n.useState)(""),[_,S]=(0,n.useState)(!1),[E,k]=(0,n.useState)([]),j=e=>{const{name:o,value:n,type:i,files:s}=e.target;t("file"===i?e=>({...e,[o]:s&&s.length>0?s[0]:null}):e=>({...e,[o]:n})),r[o]&&a((e=>({...e,[o]:null})))};return(0,n.useEffect)((()=>{(async()=>{try{const{supabase:e}=await Promise.resolve().then(o.bind(o,5315)),{data:t,error:n}=await e.from("tags").select("name").order("name");if(n)throw n;k(t.map((e=>e.name)))}catch(e){console.error("Error fetching tags:",e)}})()}),[]),(0,d.jsx)(A,{style:{alignItems:"flex-start",overflowY:"auto",padding:"5px 20px"},children:(0,d.jsx)(u,{children:(0,d.jsxs)("form",{onSubmit:t=>{t.preventDefault(),(async e=>{if(console.log("=== DEAL CREATION DEBUG START ==="),console.log("Form data received:",e),(pe||null!==f&&void 0!==f&&f.contact_id&&!je)&&(!pe||!je)){Ae(!0);try{var t,n;const{supabase:l}=await Promise.resolve().then(o.bind(o,5315));if(null===(t=e.opportunity)||void 0===t||!t.trim())return c.Ay.error("Deal name is required"),void Ae(!1);c.Ay.loading("Creating deal...",{id:"create-deal"});const d={opportunity:e.opportunity.trim(),category:e.category||"Inbox",stage:e.stage||"Lead",source_category:e.source_category||"Not Set",description:(null===(n=e.description)||void 0===n?void 0:n.trim())||null,total_investment:e.total_investment?parseFloat(e.total_investment):null,created_at:(new Date).toISOString(),last_modified_at:(new Date).toISOString(),created_by:"User",last_modified_by:"User"};console.log("Creating deal with data:",d);const{data:u,error:p}=await l.from("deals").insert(d).select().single();if(p)throw console.error("Error creating deal:",p),p;if(console.log("\u2705 Deal created successfully:",u),!pe&&null!==f&&void 0!==f&&f.contact_id){console.log("Associating deal with contact:",f.contact_id);const{error:e}=await l.from("deals_contacts").insert({deal_id:u.deal_id,contact_id:f.contact_id,relationship:"proposer",created_at:(new Date).toISOString()});if(e)throw console.error("Error creating deal association:",e),e;console.log("\u2705 Deal-contact association created")}if(e.attachment&&e.attachment instanceof File){console.log("\ud83d\udd17 ATTACHMENT UPLOAD DEBUG START"),console.log("\ud83d\udcc1 File details:",{name:e.attachment.name,size:e.attachment.size,type:e.attachment.type});try{const t=e.attachment.name.split(".").pop(),o=`deal-attachments/${Math.random().toString(36).substring(2,15)}_${Date.now()}.${t}`;console.log("\ud83d\udcc2 Upload path:",o),console.log("\u2b06\ufe0f Starting file upload to Supabase Storage...");const{data:n,error:r}=await l.storage.from("attachments").upload(o,e.attachment,{cacheControl:"3600",upsert:!1});if(r)console.error("\u274c Error uploading file to storage:",r),console.error("Upload error details:",{message:r.message,statusCode:r.statusCode,error:r.error});else{console.log("\u2705 File uploaded to storage successfully:",n),console.log("\ud83d\udd17 Getting public URL...");const{data:t}=await l.storage.from("attachments").getPublicUrl(o),r=t.publicUrl;console.log("\ud83d\udcce Public URL:",r),console.log("\ud83d\udcbe Creating attachment record in database...");const i={file_name:e.attachment.name,file_url:r,file_type:e.attachment.type,file_size:e.attachment.size,processing_status:"completed",created_by:"User"};console.log("\ud83d\udccb Attachment record data:",i);const{data:a,error:s}=await l.from("attachments").insert(i).select().single();if(s)console.error("\u274c Error creating attachment record:",s),console.error("Attachment error details:",{message:s.message,code:s.code,details:s.details});else{console.log("\u2705 Attachment record created successfully:",a),console.log("\ud83d\udd17 Linking attachment to deal...");const e={deal_id:u.deal_id,attachment_id:a.attachment_id,created_by:"User"};console.log("\ud83d\udd17 Link record data:",e);const{error:t}=await l.from("deal_attachments").insert(e);t?(console.error("\u274c Error linking attachment to deal:",t),console.error("Link error details:",{message:t.message,code:t.code,details:t.details})):(console.log("\u2705 Attachment linked to deal successfully"),console.log("\ud83c\udf89 ATTACHMENT UPLOAD COMPLETE"))}}}catch(r){console.error("\u274c Error processing attachment:",r),console.error("Attachment processing error details:",r)}}else e.attachment?console.log("\u26a0\ufe0f Attachment field is not empty but not a File object:",typeof e.attachment,e.attachment):console.log("\u2139\ufe0f No attachment provided");if(e.tags&&e.tags.length>0){console.log("Processing tags:",e.tags),console.log('\u26a0\ufe0f  NOTE: Using tables "tags" and "deal_tags" - please verify these are correct!');for(const t of e.tags)try{console.log(`Processing tag: "${t}"`);let e,{data:o,error:n}=await l.from("tags").select("tag_id").eq("name",t).single();if(n&&"PGRST116"!==n.code){console.error(`\u274c Error searching for tag "${t}":`,n);continue}if(o)e=o.tag_id,console.log(`\u2705 Found existing tag "${t}" with ID:`,e);else{console.log(`Tag "${t}" doesn't exist, creating it...`);const{data:o,error:n}=await l.from("tags").insert({name:t}).select("tag_id").single();if(n){console.error(`\u274c Error creating tag "${t}":`,n);continue}e=o.tag_id,console.log(`\u2705 Created new tag "${t}" with ID:`,e)}const{error:r}=await l.from("deal_tags").insert({deal_id:u.deal_id,tag_id:e});r?console.error(`\u274c Error linking tag "${t}" to deal:`,r):console.log(`\u2705 Linked tag "${t}" to deal`)}catch(a){console.error(`\u274c Error processing tag "${t}":`,a)}}if(Ce((e=>[u,...e])),!pe&&null!==f&&void 0!==f&&f.contact_id&&(Se((e=>[...e,u.deal_id])),ke((e=>({...e,[u.deal_id]:"proposer"})))),c.Ay.dismiss("create-deal"),pe){let e={...u};try{const{data:t}=await l.from("deal_attachments").select("attachment_id").eq("deal_id",u.deal_id);let o=[];if(t&&t.length>0){const e=t.map((e=>e.attachment_id)),{data:n}=await l.from("attachments").select("attachment_id, file_name, file_url, file_type, file_size, permanent_url").in("attachment_id",e);o=n||[]}const{data:n}=await l.from("deal_tags").select("tag_id").eq("deal_id",u.deal_id);let r=[];if(n&&n.length>0){const e=n.map((e=>e.tag_id)),{data:t}=await l.from("tags").select("tag_id, name").in("tag_id",e);r=t||[]}const{data:i}=await l.from("deals_contacts").select("contact_id, relationship").eq("deal_id",u.deal_id);let a=[];if(i&&i.length>0){const e=i.map((e=>e.contact_id)),{data:t}=await l.from("contacts").select("contact_id, first_name, last_name, job_role, profile_image_url, last_interaction_at").in("contact_id",e);t&&(a=t.map((e=>{const t=i.find((t=>t.contact_id===e.contact_id));return{...e,relationship:(null===t||void 0===t?void 0:t.relationship)||"Unknown"}})))}e={...u,attachments:o,tags:r,contacts:a}}catch(s){console.error("Error fetching complete deal data:",s),e={...u,attachments:[],tags:[],contacts:[]}}c.Ay.success(`Deal "${u.opportunity}" created successfully`),he&&he(e),i()}else c.Ay.success(`Deal "${u.opportunity}" created and associated successfully`),me("associatedDeals")}catch(l){console.error("Error creating deal:",l),c.Ay.dismiss("create-deal"),c.Ay.error(`Failed to create deal: ${l.message||"Unknown error"}`)}finally{Ae(!1)}}})(e)},children:[(0,d.jsxs)(p,{children:[(0,d.jsxs)(h,{htmlFor:"opportunity",children:[(0,d.jsx)(s.S8s,{size:14})," Deal Name"]}),(0,d.jsx)(g,{id:"opportunity",name:"opportunity",value:e.opportunity,onChange:j,placeholder:"Enter deal name",required:!0}),r.opportunity&&(0,d.jsxs)(v,{children:[(0,d.jsx)(s.eHT,{size:12})," ",r.opportunity]})]}),(0,d.jsxs)(b,{style:{marginTop:"35px"},children:[(0,d.jsxs)(p,{children:[(0,d.jsxs)(h,{htmlFor:"category",children:[(0,d.jsx)(s.Wm,{size:14})," Category"]}),(0,d.jsx)(m,{id:"category",name:"category",value:e.category,onChange:j,children:["Inbox","Startup","Fund","Real Estate","Private Debt","Private Equity","Other"].map((e=>(0,d.jsx)("option",{value:e,children:e},e)))})]}),(0,d.jsxs)(p,{children:[(0,d.jsxs)(h,{htmlFor:"stage",children:[(0,d.jsx)(s.z1n,{size:14})," Stage"]}),(0,d.jsx)(m,{id:"stage",name:"stage",value:e.stage,onChange:j,children:["Lead","Evaluating","Closing","Invested","Monitoring","Passed"].map((e=>(0,d.jsx)("option",{value:e,children:e},e)))})]})]}),(0,d.jsxs)(b,{style:{marginTop:"35px"},children:[(0,d.jsxs)(p,{children:[(0,d.jsxs)(h,{htmlFor:"source_category",children:[(0,d.jsx)(s.CKj,{size:14})," Source"]}),(0,d.jsx)(m,{id:"source_category",name:"source_category",value:e.source_category,onChange:j,children:["Not Set","Cold Contacting","Introduction"].map((e=>(0,d.jsx)("option",{value:e,children:e},e)))})]}),(0,d.jsxs)(p,{children:[(0,d.jsxs)(h,{htmlFor:"total_investment",children:[(0,d.jsx)(s.z8N,{size:14})," Investment Amount"]}),(0,d.jsx)(g,{id:"total_investment",name:"total_investment",type:"number",step:"0.01",min:"0",value:e.total_investment,onChange:j,placeholder:"Enter investment amount"}),r.total_investment&&(0,d.jsxs)(v,{children:[(0,d.jsx)(s.eHT,{size:12})," ",r.total_investment]}),(0,d.jsx)(x,{children:"Enter numeric value only (no currency symbols)"})]})]}),(0,d.jsxs)(b,{style:{marginTop:"35px"},children:[(0,d.jsxs)(p,{children:[(0,d.jsxs)(h,{htmlFor:"attachment",children:[(0,d.jsx)(s._mV,{size:14})," Attachment"]}),(0,d.jsx)(g,{id:"attachment",name:"attachment",type:"file",onChange:j,accept:"*/*"}),(0,d.jsx)(x,{children:"Upload a file to attach to this deal"})]}),(0,d.jsxs)(p,{children:[(0,d.jsxs)(h,{htmlFor:"deal_tags",children:[(0,d.jsx)(s.cnX,{size:14})," Tags"]}),(0,d.jsxs)("div",{style:{display:"flex",gap:"10px",width:"100%",position:"relative"},children:[(0,d.jsx)(g,{id:"deal_tags",placeholder:"Search or add tag and press Enter",value:l,onChange:t=>{const o=t.target.value;if(C(o),o){const t=E.filter((t=>t.toLowerCase().includes(o.toLowerCase())&&!e.tags.includes(t)));S(t.length>0)}else S(!1)},onKeyPress:o=>{"Enter"===o.key&&(o.preventDefault(),l.trim()&&!e.tags.includes(l.trim())&&(t({...e,tags:[...e.tags,l.trim()]}),C(""),S(!1)))},autoComplete:"off"}),_&&l.trim()&&(0,d.jsx)(H,{children:E.filter((t=>t.toLowerCase().includes(l.toLowerCase())&&!e.tags.includes(t))).slice(0,8).map(((o,n)=>(0,d.jsx)(B,{onClick:()=>(o=>{e.tags.includes(o)||t({...e,tags:[...e.tags,o]}),C(""),S(!1)})(o),children:o},n)))})]}),(0,d.jsx)(x,{children:"Press Enter to add multiple tags"}),e.tags.length>0&&(0,d.jsx)(G,{style:{marginTop:"10px"},children:e.tags.map((o=>(0,d.jsxs)(z,{children:[o,(0,d.jsx)("button",{type:"button",onClick:()=>{return n=o,void t({...e,tags:e.tags.filter((e=>e!==n))});var n},children:(0,d.jsx)(s.yGN,{size:12})})]},o)))})]})]}),(0,d.jsxs)(p,{style:{marginTop:"40px"},children:[(0,d.jsxs)(h,{htmlFor:"description",children:[(0,d.jsx)(s.S8s,{size:14})," Description"]}),(0,d.jsx)(y,{id:"description",name:"description",value:e.description,onChange:j,placeholder:"Enter description"})]}),(0,d.jsx)(ue,{style:{marginTop:"20px",justifyContent:"flex-end",gap:"15px"},children:(0,d.jsxs)(w,{type:"submit",disabled:je,children:[(0,d.jsx)(s.GGD,{})," Create Deal"]})})]})})})},Ke=()=>(0,d.jsx)(qe,{}),Ye=we.filter((e=>_e.includes(e.deal_id))).sort(((e,t)=>new Date(t.created_at)-new Date(e.created_at))),Je=e=>{if(!e)return"Unknown";if(0===e)return"0 Byte";const t=parseInt(Math.floor(Math.log(e)/Math.log(1024)));return Math.round(e/Math.pow(1024,t),2)+" "+["Bytes","KB","MB","GB","TB"][t]},Xe=e=>{const t=we.map((t=>t.deal_id===e.deal_id?e:t));Ce(t)},Qe=()=>0===_e.length?(0,d.jsx)(A,{children:(0,d.jsxs)(R,{children:[(0,d.jsx)(s.ayE,{size:40}),(0,d.jsx)("h3",{children:"No Deals Associated"}),(0,d.jsx)("p",{children:"This contact is not yet associated with any deals. Associate existing deals or create a new one."}),(0,d.jsxs)(O,{onClick:()=>me("createNewDeal"),children:[(0,d.jsx)(s.GGD,{size:16})," Create New Deal"]})]})}):(Pe>=Ye.length&&Ne(0),(0,d.jsxs)(A,{style:{alignItems:"flex-start",padding:"0"},children:[Ye.length>1&&(0,d.jsx)(q,{children:Ye.map(((e,t)=>(0,d.jsxs)(K,{$isActive:t===Pe,onClick:()=>(e=>{Ne(e);const t=document.querySelectorAll(".associated-deal-item");t&&t[e]&&t[e].scrollIntoView({behavior:"smooth",block:"nearest"})})(t),children:[e.opportunity,(0,d.jsx)("span",{className:"badge",children:Ee[e.deal_id]||"Unknown"})]},e.deal_id)))}),(0,d.jsx)(T,{children:Ye.map(((e,t)=>{const o=Ee[e.deal_id]||"Unknown",n=Re[e.deal_id]||[],r=Te[e.deal_id]||[];return Ye.length>1&&t!==Pe?null:(0,d.jsxs)(D,{className:"associated-deal-item",children:[(0,d.jsxs)(ne,{children:[(0,d.jsxs)("div",{style:{display:"flex",alignItems:"center"},children:[(0,d.jsx)(re,{children:e.opportunity}),(0,d.jsx)(P,{children:o})]}),(0,d.jsx)(ie,{children:e.category})]}),(0,d.jsxs)(N,{children:[(0,d.jsx)(I,{children:"Stage:"}),(0,d.jsx)(M,{children:e.stage})]}),(0,d.jsxs)(N,{children:[(0,d.jsx)(I,{children:"Investment:"}),(0,d.jsx)(M,{children:Ve(e.total_investment)})]}),(0,d.jsxs)(N,{children:[(0,d.jsx)(I,{children:"Source:"}),(0,d.jsx)(M,{children:e.source_category||"Not Set"})]}),(0,d.jsxs)(N,{children:[(0,d.jsx)(I,{children:"Created:"}),(0,d.jsx)(M,{children:$e(e.created_at)})]}),(0,d.jsxs)(N,{children:[(0,d.jsx)(I,{children:"Last Modified:"}),(0,d.jsx)(M,{children:$e(e.last_modified_at)})]}),e.description&&(0,d.jsxs)(L,{children:[(0,d.jsx)("div",{className:"label",children:"Description"}),e.description]}),(0,d.jsxs)(F,{children:[(0,d.jsx)(s.cnX,{size:14})," Tags ",0===n.length&&"(None)"]}),n.length>0?(0,d.jsx)(G,{children:n.map((e=>(0,d.jsxs)(z,{children:[(0,d.jsx)(s.cnX,{size:10})," ",e.name]},e.entry_id||e.tag_id)))}):(0,d.jsx)("div",{style:{fontSize:"12px",color:"#777",fontStyle:"italic",margin:"5px 0 15px 5px"},children:"No tags associated with this deal"}),(0,d.jsxs)(F,{children:[(0,d.jsx)(s._mV,{size:14})," Attachments ",0===r.length&&"(None)"]}),r.length>0?(0,d.jsx)(V,{children:r.map((e=>(0,d.jsxs)($,{children:[(0,d.jsxs)("div",{className:"attachment-name",children:[(0,d.jsx)(s._mV,{size:14}),e.filename," (",Je(e.file_size),")"]}),(0,d.jsxs)(U,{onClick:()=>((e,t)=>{const o=document.createElement("a");o.href=e,o.download=t,document.body.appendChild(o),o.click(),document.body.removeChild(o)})(e.file_url,e.filename),children:[(0,d.jsx)(s.a4x,{size:12})," Download"]})]},e.deal_attachment_id)))}):(0,d.jsx)("div",{style:{fontSize:"12px",color:"#777",fontStyle:"italic",margin:"5px 0 15px 5px"},children:"No attachments associated with this deal"}),(0,d.jsxs)(W,{children:[(0,d.jsxs)(Y,{onClick:t=>{t.stopPropagation(),(e=>{Fe(e),Me(!0)})(e)},children:[(0,d.jsx)(s.SG1,{size:12})," Edit Deal"]}),(0,d.jsxs)(Y,{className:"danger",onClick:t=>{t.stopPropagation(),Ue(e.deal_id)},disabled:je,children:[(0,d.jsx)(s.yGN,{size:12})," Remove Association"]})]})]},e.deal_id)}))})]}));return fe?(0,d.jsxs)("div",{style:{padding:"20px",width:"100%",height:"580px",maxHeight:"80vh",overflowY:"auto",backgroundColor:"#121212",border:"1px solid #333",borderRadius:"8px",color:"#e0e0e0",position:"relative",paddingBottom:"80px"},children:[(0,d.jsxs)(C,{children:[(0,d.jsx)("h2",{children:pe?"Create New Deal":(0,d.jsxs)(d.Fragment,{children:["Deal - ",f?`${f.first_name} ${f.last_name}`:"Contact",f&&f.companies&&f.companies.length>0&&` (${f.companies.map((e=>e.name)).join(", ")})`,_e.length>0&&(0,d.jsxs)("span",{style:{fontSize:"0.7rem",backgroundColor:"rgba(0, 255, 0, 0.2)",color:"#00ff00",marginLeft:"10px",padding:"2px 6px",borderRadius:"10px",verticalAlign:"middle"},children:[_e.length," ",1===_e.length?"deal":"deals"]})]})}),(0,d.jsx)(j,{onClick:i,children:(0,d.jsx)(s.yGN,{})})]}),(0,d.jsxs)(_,{children:[(0,d.jsxs)(S,{style:pe?{display:"none"}:{},children:[!pe&&(0,d.jsxs)(d.Fragment,{children:[(0,d.jsx)(k,{$isActive:"addFromList"===ge,onClick:()=>me("addFromList"),children:"Add from List"}),(0,d.jsxs)(k,{$isActive:"associatedDeals"===ge,onClick:()=>me("associatedDeals"),children:["Associated Deals",_e.length>0&&(0,d.jsx)("span",{style:{marginLeft:"5px",backgroundColor:"rgba(0, 255, 0, 0.2)",color:"#00ff00",fontSize:"0.7rem",padding:"1px 5px",borderRadius:"10px",fontWeight:"normal"},children:_e.length})]})]}),(0,d.jsx)(k,{$isActive:"createNewDeal"===ge,onClick:()=>me("createNewDeal"),children:"Create New Deal"})]}),(0,d.jsxs)(E,{style:pe?{width:"100%"}:{},children:[!pe&&"addFromList"===ge&&We(),"createNewDeal"===ge&&Ke(),!pe&&"associatedDeals"===ge&&Qe()]})]}),Le&&(0,d.jsx)(l.A,{isOpen:Ie,onClose:()=>Me(!1),dealData:Le,onSave:Xe})]}):(0,d.jsxs)(d.Fragment,{children:[(0,d.jsxs)(a(),{isOpen:r,onRequestClose:i,style:{content:{top:"50%",left:"50%",right:"auto",bottom:"auto",marginRight:"-50%",transform:"translate(-50%, -50%)",padding:"20px",width:"55%",height:"580px",maxHeight:"80vh",overflowY:"auto",backgroundColor:"#121212",border:"1px solid #333",borderRadius:"8px",boxShadow:"0 4px 20px rgba(0, 0, 0, 0.6)",color:"#e0e0e0",zIndex:1001,position:"relative",paddingBottom:"80px"},overlay:{backgroundColor:"rgba(0, 0, 0, 0.75)",zIndex:1e3}},children:[(0,d.jsxs)(C,{children:[(0,d.jsx)("h2",{children:pe?"Create New Deal":(0,d.jsxs)(d.Fragment,{children:["Deal - ",f?`${f.first_name} ${f.last_name}`:"Contact",f&&f.companies&&f.companies.length>0&&` (${f.companies.map((e=>e.name)).join(", ")})`,_e.length>0&&(0,d.jsxs)("span",{style:{fontSize:"0.7rem",backgroundColor:"rgba(0, 255, 0, 0.2)",color:"#00ff00",marginLeft:"10px",padding:"2px 6px",borderRadius:"10px",verticalAlign:"middle"},children:[_e.length," ",1===_e.length?"deal":"deals"]})]})}),(0,d.jsx)(j,{onClick:i,children:(0,d.jsx)(s.yGN,{})})]}),(0,d.jsxs)(_,{children:[(0,d.jsxs)(S,{style:pe?{display:"none"}:{},children:[!pe&&(0,d.jsxs)(d.Fragment,{children:[(0,d.jsx)(k,{$isActive:"addFromList"===ge,onClick:()=>me("addFromList"),children:"Add from List"}),(0,d.jsxs)(k,{$isActive:"associatedDeals"===ge,onClick:()=>me("associatedDeals"),children:["Associated Deals",_e.length>0&&(0,d.jsx)("span",{style:{marginLeft:"5px",backgroundColor:"rgba(0, 255, 0, 0.2)",color:"#00ff00",fontSize:"0.7rem",padding:"1px 5px",borderRadius:"10px",fontWeight:"normal"},children:_e.length})]})]}),(0,d.jsx)(k,{$isActive:"createNewDeal"===ge,onClick:()=>me("createNewDeal"),children:"Create New Deal"})]}),(0,d.jsxs)(E,{style:pe?{width:"100%"}:{},children:[!pe&&"addFromList"===ge&&We(),"createNewDeal"===ge&&Ke(),!pe&&"associatedDeals"===ge&&Qe()]})]})]}),Le&&(0,d.jsx)(l.A,{isOpen:Ie,onClose:()=>Me(!1),dealData:Le,onSave:Xe})]})})},4782:(e,t,o)=>{"use strict";o.r(t),o.d(t,{default:()=>x});var n=o(5043),r=o(3216),i=o(1529),a=o(5315),s=o(8136),l=o(9430),c=o(4762),d=o(3594),u=o(1009),p=o(5369),h=o(579);const f=i.Ay.div`
  height: calc(100vh - 60px);
  width: 100%;
  padding: 0 5px 0 0;
  overflow: hidden;
  box-sizing: border-box;
  max-width: 100%;
  position: relative;
`,g=i.Ay.h1`
  color: #00ff00;
  margin-bottom: 20px;
  font-family: 'Courier New', monospace;
  font-size: 24px;
  padding: 20px;
`,m=i.Ay.div`
  color: #ff3333;
  background-color: #330000;
  padding: 15px;
  border-radius: 4px;
  margin-bottom: 20px;
`,y=i.Ay.div`
  color: #00ff00;
  text-align: center;
  padding: 40px;
  font-family: monospace;
  display: flex;
  flex-direction: column;
  align-items: center;
  justify-content: center;
  height: 400px;
`,v=i.Ay.div`
  width: 300px;
  height: 8px;
  background-color: #111;
  margin: 20px 0;
  border-radius: 4px;
  overflow: hidden;
  position: relative;
  box-shadow: 0 0 10px rgba(0, 255, 0, 0.2);
  
  &:before {
    content: "";
    position: absolute;
    top: 0;
    left: 0;
    height: 100%;
    width: 30%;
    background-color: #00ff00;
    animation: pulse 1.5s ease-in-out infinite;
    box-shadow: 0 0 20px #00ff00;
    border-radius: 4px;
  }
  
  @keyframes pulse {
    0% {
      left: -30%;
      opacity: 0.8;
    }
    100% {
      left: 100%;
      opacity: 0.2;
    }
  }
`,b=i.Ay.div`
  margin-top: 15px;
  color: #00ff00;
  text-shadow: 0 0 5px rgba(0, 255, 0, 0.5);
  letter-spacing: 1px;
  font-size: 16px;
  opacity: 0.9;
  animation: blink 1.5s ease-in-out infinite alternate;
  
  @keyframes blink {
    from { opacity: 0.6; }
    to { opacity: 1; }
  }
`,x=(i.Ay.span`
  display: inline-block;
  background-color: ${e=>e.bg||"#222"};
  color: ${e=>e.color||"#00ff00"};
  border: 1px solid ${e=>e.borderColor||"#00ff00"};
  padding: 2px 6px;
  margin-right: 3px;
  border-radius: 4px;
  font-size: 11px;
`,()=>{var e,t;const[o,i]=(0,n.useState)([]),[x,w]=(0,n.useState)(!0),[C,_]=(0,n.useState)(null),[S,E]=(0,n.useState)(null),[k,j]=(0,n.useState)(!1),[A,R]=(0,n.useState)(!1),[O,T]=(0,n.useState)(null),[D,P]=(0,n.useState)({}),[N,I]=(0,n.useState)(!1),[M,L]=(0,n.useState)(null),[F,G]=(0,n.useState)(!1),[z,H]=(0,n.useState)(null),[B,V]=(0,n.useState)({}),$=(0,r.Zp)(),U=(0,n.useCallback)((e=>{var t;const o=null===(t=e.data)||void 0===t?void 0:t.contact_id,n=e.value||"",r=D[o]||!1,i=[{value:"Do not keep in touch",label:"Do not keep in touch"},{value:"Weekly",label:"Weekly"},{value:"Monthly",label:"Monthly"},{value:"Quarterly",label:"Quarterly"},{value:"Twice per Year",label:"Twice per Year"},{value:"Once per Year",label:"Once per Year"}],s=()=>{setTimeout((()=>{P((e=>({...e,[o]:!1})))}),150)};return r?(0,h.jsx)("div",{style:{position:"relative",width:"100%"},children:(0,h.jsx)("select",{value:n,onChange:e=>(async e=>{try{const{error:t}=await a.supabase.from("contacts").update({keep_in_touch_frequency:e}).eq("contact_id",o);if(t)throw t;P((e=>({...e,[o]:!1}))),await Z(),console.log(`Updated frequency for contact ${o} to ${e} and refreshed table`)}catch(t){console.error("Error updating frequency:",t),alert("Failed to update frequency. Please try again.")}})(e.target.value),onBlur:s,autoFocus:!0,style:{width:"100%",padding:"4px",fontSize:"12px",backgroundColor:"#222",color:"#fff",border:"1px solid #555",borderRadius:"4px"},children:i.map((e=>(0,h.jsx)("option",{value:e.value,children:e.label},e.value)))})}):(0,h.jsx)("div",{onClick:e=>{e.stopPropagation(),P((e=>({...e,[o]:!e[o]})))},style:{whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis",cursor:"pointer",width:"100%",fontSize:"12px",textAlign:"center",color:n?"#00ff00":"#aaaaaa",padding:"4px",borderRadius:"4px"},children:n||"Not set"})}),[D,i,P]),W=(0,n.useCallback)((e=>{var t;const o=null===(t=e.data)||void 0===t?void 0:t.contact_id,n=e.value||0,r=B[o]||!1;console.log("SnoozeDaysRenderer debug:",{contactId:o,currentSnoozeDays:n,isEditing:r,showSnoozeDaysInput:B});const i=async e=>{try{const{error:t}=await a.supabase.from("keep_in_touch").update({snooze_days:e}).eq("contact_id",o);if(t)throw t;V((e=>({...e,[o]:!1}))),await Z(),console.log(`Updated snooze days for contact ${o} to ${e} and refreshed table`)}catch(t){console.error("Error updating snooze days:",t),alert("Failed to update snooze days. Please try again.")}},s=e=>{e.stopPropagation(),console.log("Snooze days clicked for contact:",o),V((e=>({...e,[o]:!e[o]})))},l=()=>{setTimeout((()=>{V((e=>({...e,[o]:!1})))}),150)},c=e=>{if("Enter"===e.key){const t=parseInt(e.target.value)||0;i(t)}},d=e=>{e.stopPropagation(),console.log("Reset to zero clicked for contact:",o),i(0)};return r?(0,h.jsxs)("div",{style:{position:"relative",width:"100%",display:"flex",alignItems:"center",gap:"4px"},children:[(0,h.jsx)("input",{type:"number",min:"0",max:"365",defaultValue:n,onBlur:l,onKeyPress:c,autoFocus:!0,style:{width:"60px",padding:"2px 4px",fontSize:"11px",backgroundColor:"#222",color:"#00ff00",border:"1px solid #00ff00",borderRadius:"4px",textAlign:"center"}}),(0,h.jsx)("button",{onClick:d,style:{background:"#ff5555",color:"#fff",border:"none",borderRadius:"2px",width:"16px",height:"16px",fontSize:"10px",cursor:"pointer",display:"flex",alignItems:"center",justifyContent:"center"},title:"Reset to 0",children:"\xd7"})]}):!n||n<=0?(0,h.jsx)("div",{onClick:s,style:{cursor:"pointer",padding:"2px 6px",borderRadius:"4px",fontSize:"11px",color:"#666",textAlign:"center"},title:"Click to set snooze days",children:"-"}):(0,h.jsxs)("span",{onClick:s,style:{color:"#00ff00",backgroundColor:"#222",padding:"2px 6px",borderRadius:"4px",fontSize:"11px",cursor:"pointer",display:"inline-block"},title:"Click to edit snooze days",children:["+",n," days"]})}),[B,i,V]),q=e=>{const t=e.data,o=t.contacts||{},n=t.email||"",r=t.mobile||"",i=o.linkedin||"";return(0,h.jsxs)("div",{style:{display:"flex",gap:"8px",justifyContent:"center",alignItems:"center",padding:"4px",width:"100%",height:"100%"},children:[(0,h.jsx)("button",{onClick:e=>{var o;e.stopPropagation(),console.log("=== Opening LinkedIn search & enrich modal ==="),console.log("Full data object:",t),console.log("Contacts nested data:",t.contacts),console.log("Data keys:",Object.keys(t)),console.log("LinkedIn URL from contacts:",null===(o=t.contacts)||void 0===o?void 0:o.linkedin),console.log("LinkedIn URL direct:",t.linkedin),console.log("=== Setting selected contact for LinkedIn ==="),H(t),G(!0)},style:{background:"transparent",border:"none",color:i?"#00ff00":"#666",cursor:"pointer",display:"flex",alignItems:"center",justifyContent:"center",width:"24px",height:"24px",borderRadius:"3px",transition:"all 0.2s",padding:"0"},onMouseEnter:e=>e.currentTarget.style.transform="scale(1.1)",onMouseLeave:e=>e.currentTarget.style.transform="scale(1)",title:"LinkedIn",children:(0,h.jsx)(u.Wjy,{size:16})}),(0,h.jsx)("button",{onClick:e=>{if(e.stopPropagation(),r){const e=r.replace(/\D/g,"");window.open(`https://wa.me/${e}`,"_blank")}},disabled:!r,style:{background:"transparent",border:"none",color:r?"#00ff00":"#666",cursor:r?"pointer":"not-allowed",display:"flex",alignItems:"center",justifyContent:"center",width:"24px",height:"24px",borderRadius:"3px",transition:"all 0.2s",padding:"0"},onMouseEnter:e=>r&&(e.currentTarget.style.transform="scale(1.1)"),onMouseLeave:e=>r&&(e.currentTarget.style.transform="scale(1)"),title:"WhatsApp",children:(0,h.jsx)(p.EcP,{size:16})}),(0,h.jsx)("button",{onClick:e=>{e.stopPropagation(),L(t),I(!0)},style:{background:"transparent",border:"none",color:"#00ff00",cursor:"pointer",display:"flex",alignItems:"center",justifyContent:"center",width:"24px",height:"24px",borderRadius:"3px",transition:"all 0.2s",padding:"0"},onMouseEnter:e=>e.currentTarget.style.transform="scale(1.1)",onMouseLeave:e=>e.currentTarget.style.transform="scale(1)",title:"Deal (Coming Soon)",children:(0,h.jsx)(u.z8N,{size:16})}),(0,h.jsx)("button",{onClick:e=>{if(e.stopPropagation(),n)try{window.open(`https://mail.google.com/mail/?view=cm&to=${encodeURIComponent(n)}`,"_blank")}catch(C){window.location.href=`mailto:${n}`}else{console.log("Data structure for grey button:",t);const e=t.first_name||t.firstName||"",o=t.last_name||t.lastName||"",n=t.full_name||t.fullName||"";if(console.log("Name fields found:",{firstName:e,lastName:o,fullName:n}),e&&o)console.log("Using first + last names:",`${e}%20${o}`),window.open(`https://mail.superhuman.com/search/${e}%20${o}`,"_blank");else if(n){const e=n.trim().split(" ");if(e.length>=2){const t=e[0],o=e[e.length-1];console.log("Using split full name:",`${t}%20${o}`),window.open(`https://mail.superhuman.com/search/${t}%20${o}`,"_blank")}else 1===e.length&&(console.log("Using single name:",e[0]),window.open(`https://mail.superhuman.com/search/${e[0]}`,"_blank"))}else if(e||o){const t=e||o;console.log("Using single available name:",t),window.open(`https://mail.superhuman.com/search/${t}`,"_blank")}else{console.log("No names found in data:",t);const e=document.createElement("div");e.innerHTML="\n            <div style=\"\n              position: fixed;\n              top: 20px;\n              right: 20px;\n              background: #331100;\n              color: #ff9900;\n              border: 1px solid #ff9900;\n              padding: 15px;\n              border-radius: 6px;\n              z-index: 10000;\n              font-family: 'Courier New', monospace;\n            \">\n              \u26a0\ufe0f No contact name available for Superhuman search\n            </div>\n          ",document.body.appendChild(e),setTimeout((()=>{e.parentElement&&e.parentElement.removeChild(e)}),3e3)}}},style:{background:"transparent",border:"none",color:n?"#00ff00":"#666",cursor:"pointer",display:"flex",alignItems:"center",justifyContent:"center",width:"24px",height:"24px",borderRadius:"3px",transition:"all 0.2s",padding:"0"},onMouseEnter:e=>e.currentTarget.style.transform="scale(1.1)",onMouseLeave:e=>e.currentTarget.style.transform="scale(1)",title:n?"Email":"Search on Superhuman",children:(0,h.jsx)(u.pHD,{size:16})})]})},K=e=>{if(!e.value)return"";const t=new Date(e.value),o=`${(t.getMonth()+1).toString().padStart(2,"0")}/${t.getFullYear().toString().slice(-2)}`;return(0,h.jsx)("div",{onClick:t=>{t.stopPropagation(),T(e.data),R(!0)},style:{whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis",paddingRight:"0",width:"100%",fontSize:"12px",textAlign:"center",cursor:"pointer",color:"#aaaaaa"},children:o})},Y=(0,n.useMemo)((()=>[{headerName:"Contact",field:"full_name",cellRenderer:e=>{if(!e.value)return"-";return(0,h.jsx)("div",{style:{whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis",cursor:"pointer",width:"100%",height:"100%",display:"flex",alignItems:"center"},onClick:()=>{e.data&&e.data.contact_id&&$(`/contacts/${e.data.contact_id}`)},children:e.value})},minWidth:180,filter:"agTextColumnFilter",floatingFilter:!0,sortable:!0,pinned:"left"},{headerName:"Last Interaction",field:"last_interaction_at",cellRenderer:K,minWidth:150,filter:"agDateColumnFilter",floatingFilter:!0,sortable:!0},{headerName:"Frequency",field:"frequency",cellRenderer:U,minWidth:130,filter:"agTextColumnFilter",floatingFilter:!0,sortable:!0},{headerName:"Snooze Days",field:"snooze_days",cellRenderer:W,width:120,filter:"agNumberColumnFilter",floatingFilter:!0,sortable:!0},{headerName:"Next Interaction",field:"next_interaction_date",valueFormatter:e=>{if(!e.value)return"-";const t=new Date(e.value),o=new Date;return Math.floor((t-o)/864e5)<0?"DUE":new Date(e.value).toLocaleDateString()},minWidth:180,filter:"agDateColumnFilter",floatingFilter:!0,sortable:!0},{headerName:"Actions",field:"actions",cellRenderer:q,minWidth:140,sortable:!1,filter:!1}]),[$,U,W]);(0,n.useEffect)((()=>{k||Z()}),[k]);const J=(0,n.useMemo)((()=>({resizable:!0,sortable:!0,filter:!0})),[]),X=n.useCallback((e=>{console.log("Grid is ready"),E(e.api),setTimeout((()=>{e.api.sizeColumnsToFit()}),0)}),[]),Q=n.useCallback((e=>{console.log("Row clicked:",e.data)}),[$]),Z=async()=>{try{w(!0),_(null);const e=async function(e){let t,o=arguments.length>1&&void 0!==arguments[1]?arguments[1]:3,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1e3;for(let i=0;i<o;i++)try{return await e()}catch(r){console.log(`Attempt ${i+1} failed, retrying in ${n}ms...`,r),t=r,await new Promise((e=>setTimeout(e,n))),n*=1.5}throw t};w("Accessing Keep in Touch data...");const{data:t,error:o}=await e((async()=>a.supabase.from("v_keep_in_touch").select("\n            *,\n            contacts!inner(linkedin)\n          ").order("next_interaction_date",{ascending:!0})));if(o)throw console.error("Error fetching keep in touch data:",o),o;const n=(null===t||void 0===t?void 0:t.map((e=>e.contact_id)))||[];let r=[],s=[];if(n.length>0){const{data:t,error:o}=await e((async()=>a.supabase.from("contact_mobiles").select("contact_id, mobile, is_primary").in("contact_id",n)));o?console.error("Error fetching mobile data:",o):r=t||[];const{data:i,error:l}=await e((async()=>a.supabase.from("contact_emails").select("contact_id, email, is_primary").in("contact_id",n)));l?console.error("Error fetching email data:",l):s=i||[]}const l=(null===t||void 0===t?void 0:t.map((e=>{const t=r.filter((t=>t.contact_id===e.contact_id)),o=t.find((e=>e.is_primary)),n=(null===o||void 0===o?void 0:o.mobile)||(t.length>0?t[0].mobile:null),i=s.filter((t=>t.contact_id===e.contact_id)),a=i.find((e=>e.is_primary)),l=(null===a||void 0===a?void 0:a.email)||(i.length>0?i[0].email:null);return{...e,mobile:n,email:l}})))||[];console.log("Fetched contacts with mobile and email data:",l),i(l),j(!0)}catch(e){console.error("Failed to fetch contacts:",e),_(`Failed to load contacts: ${e.message}`)}finally{w(!1)}},ee={navigate:$,refreshData:()=>{x||Z()}};return C?(0,h.jsxs)(f,{children:[(0,h.jsx)(g,{children:"Keep in Touch Contacts"}),(0,h.jsx)(m,{children:C})]}):x?(0,h.jsxs)(f,{children:[(0,h.jsx)(g,{children:"Keep in Touch Contacts"}),(0,h.jsxs)(y,{children:[(0,h.jsx)(b,{children:"string"===typeof x?x:"Loading contacts..."}),(0,h.jsx)(v,{})]})]}):(0,h.jsxs)(f,{children:[0===o.length?(0,h.jsx)("div",{style:{padding:"40px",textAlign:"center",color:"#00ff00",background:"#121212",borderRadius:"8px"},children:"No contacts found for this category."}):(0,h.jsx)("div",{className:"ag-theme-alpine",style:{height:"calc(100% - 80px)",width:"100%",overflowX:"hidden",boxSizing:"border-box",marginRight:"5px","--ag-background-color":"#121212","--ag-odd-row-background-color":"#1a1a1a","--ag-header-background-color":"#222222","--ag-header-foreground-color":"#00ff00","--ag-foreground-color":"#e0e0e0","--ag-row-hover-color":"transparent","--ag-border-color":"#333333","--ag-cell-horizontal-padding":"8px","--ag-borders":"none","--ag-header-height":"32px","--ag-header-column-separator-display":"none","--ag-font-size":"12px","--ag-paging-panel-height":"42px","--ag-row-height":"36px"},children:(0,h.jsx)(s.W,{rowData:o,columnDefs:Y,defaultColDef:J,onGridReady:X,onRowClicked:Q,context:ee,animateRows:!1,suppressRowClickSelection:!0,enableCellTextSelection:!0,pagination:!0,paginationPageSize:50,domLayout:"normal",suppressColumnVirtualisation:!0,suppressRowVirtualisation:!1,suppressCellFocus:!0,suppressHorizontalScroll:!0,alwaysShowHorizontalScroll:!1,alwaysShowVerticalScroll:!1,overlayNoRowsTemplate:'<span style="padding: 10px; border: 1px solid #00ff00; background: #121212; color: #00ff00;">No contacts found</span>'})}),A&&O&&(0,h.jsx)(l.A,{isOpen:A,onRequestClose:()=>{R(!1),T(null)},contact:O}),N&&M&&(0,h.jsx)(c.A,{isOpen:N,onClose:()=>{I(!1),L(null)},contactData:M}),F&&z&&(0,h.jsx)(d.A,{isOpen:F,onClose:()=>{G(!1),H(null)},linkedInUrl:(()=>{const e=z.contacts||{};let t=e.linkedin||"";return t&&!t.startsWith("http")&&(t=t.startsWith("linkedin.com")||t.startsWith("www.linkedin.com")||t.includes("linkedin.com")?`https://${t}`:`https://www.linkedin.com/in/${t.replace(/^\/+/,"")}`),console.log("LinkedIn URL being passed to modal:",t),console.log("Original LinkedIn data:",e.linkedin),console.log("Selected contact data:",z),console.log("Contact data object:",e),t})(),contactName:(()=>{let e=z.first_name||"",t=z.last_name||"",o=z.full_name||"";if(!e&&!t&&o){const n=o.trim().split(" ");e=n[0]||"",t=n.slice(1).join(" ")||""}const n=`${e} ${t}`.trim()||o.trim();return console.log("Contact name debugging:"),console.log("- first_name:",z.first_name),console.log("- last_name:",z.last_name),console.log("- full_name:",z.full_name),console.log("- Final contact name being passed to modal:",n),console.log("- Full selected contact data:",z),n})(),firstName:z.first_name||(null===(e=z.full_name)||void 0===e?void 0:e.split(" ")[0])||"",lastName:z.last_name||(null===(t=z.full_name)||void 0===t?void 0:t.split(" ").slice(1).join(" "))||"",email:z.email||"",jobRole:z.job_role||"",contactId:z.contact_id,context:ee,onSaveData:async e=>{try{if(!z)return;const t={job_role:e.jobRole,linkedin:z.linkedin||e.linkedinUrl,last_modified_at:(new Date).toISOString(),last_modified_by:"User"},{error:o}=await a.supabase.from("contacts").update(t).eq("contact_id",z.contact_id);if(o)throw o;if(e.company){const{data:t,error:o}=await a.supabase.from("companies").select("company_id, name").ilike("name",e.company);if(o)throw o;let n;if(t&&t.length>0){n=t[0].company_id;const{error:o}=await a.supabase.from("companies").update({website:e.companyWebsite||null,description:e.companyDescription||null,last_modified_at:(new Date).toISOString(),last_modified_by:"User"}).eq("company_id",n);if(o)throw o}else{const{data:t,error:o}=await a.supabase.from("companies").insert({name:e.company,website:e.companyWebsite||null,description:e.companyDescription||null,created_at:(new Date).toISOString(),created_by:"User",last_modified_at:(new Date).toISOString(),last_modified_by:"User"}).select();if(o)throw o;t&&t.length>0&&(n=t[0].company_id)}if(n){const{data:e,error:t}=await a.supabase.from("contact_companies").select("contact_id, company_id").eq("contact_id",z.contact_id).eq("company_id",n);if(t)throw t;if(!e||0===e.length){const{error:e}=await a.supabase.from("contact_companies").insert({contact_id:z.contact_id,company_id:n});if(e)throw e}}}if(e.city){const{data:t,error:o}=await a.supabase.from("cities").select("city_id, name").ilike("name",e.city);if(o)throw o;let n;if(t&&t.length>0)n=t[0].city_id;else{const{data:t,error:o}=await a.supabase.from("cities").insert({name:e.city}).select();if(o)throw o;t&&t.length>0&&(n=t[0].city_id)}if(n){const{data:e,error:t}=await a.supabase.from("contact_cities").select("contact_id, city_id").eq("contact_id",z.contact_id).eq("city_id",n);if(t)throw t;if(!e||0===e.length){const{error:e}=await a.supabase.from("contact_cities").insert({contact_id:z.contact_id,city_id:n});if(e)throw e}}}await Z(),console.log("LinkedIn data saved successfully and table refreshed")}catch(t){console.error("Error saving LinkedIn data:",t)}}})]})})},4841:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.resetState=function(){var e=document.getElementsByTagName("html")[0];for(var t in o)r(e,o[t]);var i=document.body;for(var a in n)r(i,n[a]);o={},n={}},t.log=function(){0};var o={},n={};function r(e,t){e.classList.remove(t)}t.add=function(e,t){return r=e.classList,i="html"==e.nodeName.toLowerCase()?o:n,void t.split(" ").forEach((function(e){!function(e,t){e[t]||(e[t]=0),e[t]+=1}(i,e),r.add(e)}));var r,i},t.remove=function(e,t){return r=e.classList,i="html"==e.nodeName.toLowerCase()?o:n,void t.split(" ").forEach((function(e){!function(e,t){e[t]&&(e[t]-=1)}(i,e),0===i[e]&&r.remove(e)}));var r,i}},4923:function(e,t,o){"use strict";var n=this&&this.__extends||function(){var e=function(t,o){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])},e(t,o)};return function(t,o){function n(){this.constructor=t}e(t,o),t.prototype=null===o?Object.create(o):(n.prototype=o.prototype,new n)}}(),r=this&&this.__assign||function(){return r=Object.assign||function(e){for(var t,o=1,n=arguments.length;o<n;o++)for(var r in t=arguments[o])Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e},r.apply(this,arguments)},i=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.NewReactComponent=void 0;var a=o(5043),s=o(7950),l=o(7079),c=o(7301),d=o(6885),u=i(o(7467)),p=function(e){function t(t,o,n){var r=e.call(this,t,o,n)||this;return r.oldPortal=null,r.key=u.default(),r.portalKey=u.default(),r}return n(t,e),t.prototype.init=function(e){var t=this;return this.eParentElement=this.createParentElement(e),this.params=e,this.createOrUpdatePortal(e),new l.AgPromise((function(e){return t.createReactComponent(e)}))},t.prototype.createOrUpdatePortal=function(e){var t=this;this.isStatelessComponent()||(e.ref=function(e){t.componentInstance=e,t.addParentContainerStyleAndClasses()}),this.reactElement=a.createElement(this.reactComponent,r(r({},e),{key:this.key})),this.portal=s.createPortal(this.reactElement,this.eParentElement,this.portalKey)},t.prototype.createReactComponent=function(e){this.portalManager.mountReactPortal(this.portal,this,(function(t){e(t)}))},t.prototype.isNullValue=function(){return this.valueRenderedIsNull(this.params)},t.prototype.rendered=function(){return this.isStatelessComponent()&&this.statelessComponentRendered()||!(this.isStatelessComponent()||!this.getFrameworkComponentInstance())},t.prototype.valueRenderedIsNull=function(e){if(!this.componentType.cellRenderer)return!1;var t=console.error;try{return console.error=function(){},""===d.renderToStaticMarkup(a.createElement(this.reactComponent,e))}catch(o){}finally{console.error=t}return!1},t.prototype.refreshComponent=function(e){this.oldPortal=this.portal,this.createOrUpdatePortal(e),this.portalManager.updateReactPortal(this.oldPortal,this.portal)},t.prototype.fallbackMethod=function(e,t){var o=this[e+"Component"];if(o)return o.bind(this)(t)},t.prototype.fallbackMethodAvailable=function(e){return!!this[e+"Component"]},t}(c.ReactComponent);t.NewReactComponent=p},4967:(e,t,o)=>{"use strict";function n(e){var t=new Date(Date.UTC(e.getFullYear(),e.getMonth(),e.getDate(),e.getHours(),e.getMinutes(),e.getSeconds(),e.getMilliseconds()));return t.setUTCFullYear(e.getFullYear()),e.getTime()-t.getTime()}o.d(t,{A:()=>n})},4983:(e,t)=>{"use strict";var o="function"===typeof Symbol&&Symbol.for,n=o?Symbol.for("react.element"):60103,r=o?Symbol.for("react.portal"):60106,i=o?Symbol.for("react.fragment"):60107,a=o?Symbol.for("react.strict_mode"):60108,s=o?Symbol.for("react.profiler"):60114,l=o?Symbol.for("react.provider"):60109,c=o?Symbol.for("react.context"):60110,d=o?Symbol.for("react.async_mode"):60111,u=o?Symbol.for("react.concurrent_mode"):60111,p=o?Symbol.for("react.forward_ref"):60112,h=o?Symbol.for("react.suspense"):60113,f=o?Symbol.for("react.suspense_list"):60120,g=o?Symbol.for("react.memo"):60115,m=o?Symbol.for("react.lazy"):60116,y=o?Symbol.for("react.block"):60121,v=o?Symbol.for("react.fundamental"):60117,b=o?Symbol.for("react.responder"):60118,x=o?Symbol.for("react.scope"):60119;function w(e){if("object"===typeof e&&null!==e){var t=e.$$typeof;switch(t){case n:switch(e=e.type){case d:case u:case i:case s:case a:case h:return e;default:switch(e=e&&e.$$typeof){case c:case p:case m:case g:case l:return e;default:return t}}case r:return t}}}function C(e){return w(e)===u}t.AsyncMode=d,t.ConcurrentMode=u,t.ContextConsumer=c,t.ContextProvider=l,t.Element=n,t.ForwardRef=p,t.Fragment=i,t.Lazy=m,t.Memo=g,t.Portal=r,t.Profiler=s,t.StrictMode=a,t.Suspense=h,t.isAsyncMode=function(e){return C(e)||w(e)===d},t.isConcurrentMode=C,t.isContextConsumer=function(e){return w(e)===c},t.isContextProvider=function(e){return w(e)===l},t.isElement=function(e){return"object"===typeof e&&null!==e&&e.$$typeof===n},t.isForwardRef=function(e){return w(e)===p},t.isFragment=function(e){return w(e)===i},t.isLazy=function(e){return w(e)===m},t.isMemo=function(e){return w(e)===g},t.isPortal=function(e){return w(e)===r},t.isProfiler=function(e){return w(e)===s},t.isStrictMode=function(e){return w(e)===a},t.isSuspense=function(e){return w(e)===h},t.isValidElementType=function(e){return"string"===typeof e||"function"===typeof e||e===i||e===u||e===s||e===a||e===h||e===f||"object"===typeof e&&null!==e&&(e.$$typeof===m||e.$$typeof===g||e.$$typeof===l||e.$$typeof===c||e.$$typeof===p||e.$$typeof===v||e.$$typeof===b||e.$$typeof===x||e.$$typeof===y)},t.typeOf=w},5043:(e,t,o)=>{"use strict";e.exports=o(4202)},5056:(e,t,o)=>{t.AgGridReact=o(8278).AgGridReact,o(1111).J,o(2430).AgGridReactUi},5173:(e,t,o)=>{e.exports=o(1497)()},5268:function(e,t,o){"use strict";var n=this&&this.__extends||function(){var e=function(t,o){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])},e(t,o)};return function(t,o){function n(){this.constructor=t}e(t,o),t.prototype=null===o?Object.create(o):(n.prototype=o.prototype,new n)}}(),r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.LegacyReactComponent=void 0;var i=o(5043),a=o(7950),s=o(7079),l=o(7301),c=o(6885),d=r(o(7467)),u=function(e){function t(t,o,n,r){var i=e.call(this,t,n,r)||this;return i.staticMarkup=null,i.staticRenderTime=0,i.parentComponent=o,i}return n(t,e),t.prototype.init=function(e){var t=this;return this.eParentElement=this.createParentElement(e),this.renderStaticMarkup(e),new s.AgPromise((function(o){return t.createReactComponent(e,o)}))},t.prototype.createReactComponent=function(e,t){var o=this;this.isStatelessComponent()||(e.ref=function(e){o.componentInstance=e,o.addParentContainerStyleAndClasses(),o.removeStaticMarkup()});var n=i.createElement(this.reactComponent,e),r=a.createPortal(n,this.eParentElement,d.default());this.portal=r,this.portalManager.mountReactPortal(r,this,(function(e){t(e),o.isStatelessComponent()&&(o.isSlowRenderer()&&o.removeStaticMarkup(),setTimeout((function(){o.removeStaticMarkup()})))}))},t.prototype.fallbackMethodAvailable=function(e){return!1},t.prototype.fallbackMethod=function(e,t){},t.prototype.isSlowRenderer=function(){return this.staticRenderTime>=t.SLOW_RENDERING_THRESHOLD},t.prototype.isNullValue=function(){return""===this.staticMarkup},t.prototype.renderStaticMarkup=function(e){if(!this.parentComponent.isDisableStaticMarkup()&&this.componentType.cellRenderer){var t=console.error,o=i.createElement(this.reactComponent,e);try{console.error=function(){};var n=Date.now(),r=c.renderToStaticMarkup(o);this.staticRenderTime=Date.now()-n,console.error=t,""===r?this.staticMarkup=r:r&&(this.staticMarkup=document.createElement("span"),this.staticMarkup.innerHTML=r,this.eParentElement.appendChild(this.staticMarkup))}catch(a){}finally{console.error=t}}},t.prototype.removeStaticMarkup=function(){!this.parentComponent.isDisableStaticMarkup()&&this.componentType.cellRenderer&&this.staticMarkup&&(this.staticMarkup.remove?(this.staticMarkup.remove(),this.staticMarkup=null):this.eParentElement.removeChild&&(this.eParentElement.removeChild(this.staticMarkup),this.staticMarkup=null))},t.prototype.rendered=function(){return this.isNullValue()||!!this.staticMarkup||this.isStatelessComponent()&&this.statelessComponentRendered()||!(this.isStatelessComponent()||!this.getFrameworkComponentInstance())},t.SLOW_RENDERING_THRESHOLD=3,t}(l.ReactComponent);t.LegacyReactComponent=u},5315:(e,t,o)=>{"use strict";o.d(t,{supabase:()=>Rt});class n extends Error{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"FunctionsError",o=arguments.length>2?arguments[2]:void 0;super(e),this.name=t,this.context=o}}class r extends n{constructor(e){super("Failed to send a request to the Edge Function","FunctionsFetchError",e)}}class i extends n{constructor(e){super("Relay Error invoking the Edge Function","FunctionsRelayError",e)}}class a extends n{constructor(e){super("Edge Function returned a non-2xx status code","FunctionsHttpError",e)}}var s;!function(e){e.Any="any",e.ApNortheast1="ap-northeast-1",e.ApNortheast2="ap-northeast-2",e.ApSouth1="ap-south-1",e.ApSoutheast1="ap-southeast-1",e.ApSoutheast2="ap-southeast-2",e.CaCentral1="ca-central-1",e.EuCentral1="eu-central-1",e.EuWest1="eu-west-1",e.EuWest2="eu-west-2",e.EuWest3="eu-west-3",e.SaEast1="sa-east-1",e.UsEast1="us-east-1",e.UsWest1="us-west-1",e.UsWest2="us-west-2"}(s||(s={}));var l=function(e,t,o,n){return new(o||(o=Promise))((function(r,i){function a(e){try{l(n.next(e))}catch(t){i(t)}}function s(e){try{l(n.throw(e))}catch(t){i(t)}}function l(e){var t;e.done?r(e.value):(t=e.value,t instanceof o?t:new o((function(e){e(t)}))).then(a,s)}l((n=n.apply(e,t||[])).next())}))};class c{constructor(e){let{headers:t={},customFetch:n,region:r=s.Any}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};this.url=e,this.headers=t,this.region=r,this.fetch=(e=>{let t;return t=e||("undefined"===typeof fetch?function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return Promise.resolve().then(o.bind(o,4630)).then((e=>{let{default:o}=e;return o(...t)}))}:fetch),function(){return t(...arguments)}})(n)}setAuth(e){this.headers.Authorization=`Bearer ${e}`}invoke(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};var o;return l(this,void 0,void 0,(function*(){try{const{headers:n,method:s,body:l}=t;let c,d={},{region:u}=t;u||(u=this.region),u&&"any"!==u&&(d["x-region"]=u),l&&(n&&!Object.prototype.hasOwnProperty.call(n,"Content-Type")||!n)&&("undefined"!==typeof Blob&&l instanceof Blob||l instanceof ArrayBuffer?(d["Content-Type"]="application/octet-stream",c=l):"string"===typeof l?(d["Content-Type"]="text/plain",c=l):"undefined"!==typeof FormData&&l instanceof FormData?c=l:(d["Content-Type"]="application/json",c=JSON.stringify(l)));const p=yield this.fetch(`${this.url}/${e}`,{method:s||"POST",headers:Object.assign(Object.assign(Object.assign({},d),this.headers),n),body:c}).catch((e=>{throw new r(e)})),h=p.headers.get("x-relay-error");if(h&&"true"===h)throw new i(p);if(!p.ok)throw new a(p);let f,g=(null!==(o=p.headers.get("Content-Type"))&&void 0!==o?o:"text/plain").split(";")[0].trim();return f="application/json"===g?yield p.json():"application/octet-stream"===g?yield p.blob():"text/event-stream"===g?p:"multipart/form-data"===g?yield p.formData():yield p.text(),{data:f,error:null}}catch(n){return{data:null,error:n}}}))}}var d=o(7980);const{PostgrestClient:u,PostgrestQueryBuilder:p,PostgrestFilterBuilder:h,PostgrestTransformBuilder:f,PostgrestBuilder:g,PostgrestError:m}=d,y={"X-Client-Info":"realtime-js/2.11.2"};var v,b,x,w,C,_;!function(e){e[e.connecting=0]="connecting",e[e.open=1]="open",e[e.closing=2]="closing",e[e.closed=3]="closed"}(v||(v={})),function(e){e.closed="closed",e.errored="errored",e.joined="joined",e.joining="joining",e.leaving="leaving"}(b||(b={})),function(e){e.close="phx_close",e.error="phx_error",e.join="phx_join",e.reply="phx_reply",e.leave="phx_leave",e.access_token="access_token"}(x||(x={})),function(e){e.websocket="websocket"}(w||(w={})),function(e){e.Connecting="connecting",e.Open="open",e.Closing="closing",e.Closed="closed"}(C||(C={}));class S{constructor(){this.HEADER_LENGTH=1}decode(e,t){return e.constructor===ArrayBuffer?t(this._binaryDecode(e)):t("string"===typeof e?JSON.parse(e):{})}_binaryDecode(e){const t=new DataView(e),o=new TextDecoder;return this._decodeBroadcast(e,t,o)}_decodeBroadcast(e,t,o){const n=t.getUint8(1),r=t.getUint8(2);let i=this.HEADER_LENGTH+2;const a=o.decode(e.slice(i,i+n));i+=n;const s=o.decode(e.slice(i,i+r));i+=r;return{ref:null,topic:a,event:s,payload:JSON.parse(o.decode(e.slice(i,e.byteLength)))}}}class E{constructor(e,t){this.callback=e,this.timerCalc=t,this.timer=void 0,this.tries=0,this.callback=e,this.timerCalc=t}reset(){this.tries=0,clearTimeout(this.timer)}scheduleTimeout(){clearTimeout(this.timer),this.timer=setTimeout((()=>{this.tries=this.tries+1,this.callback()}),this.timerCalc(this.tries+1))}}!function(e){e.abstime="abstime",e.bool="bool",e.date="date",e.daterange="daterange",e.float4="float4",e.float8="float8",e.int2="int2",e.int4="int4",e.int4range="int4range",e.int8="int8",e.int8range="int8range",e.json="json",e.jsonb="jsonb",e.money="money",e.numeric="numeric",e.oid="oid",e.reltime="reltime",e.text="text",e.time="time",e.timestamp="timestamp",e.timestamptz="timestamptz",e.timetz="timetz",e.tsrange="tsrange",e.tstzrange="tstzrange"}(_||(_={}));const k=function(e,t){var o;const n=null!==(o=(arguments.length>2&&void 0!==arguments[2]?arguments[2]:{}).skipTypes)&&void 0!==o?o:[];return Object.keys(t).reduce(((o,r)=>(o[r]=j(r,e,t,n),o)),{})},j=(e,t,o,n)=>{const r=t.find((t=>t.name===e)),i=null===r||void 0===r?void 0:r.type,a=o[e];return i&&!n.includes(i)?A(i,a):R(a)},A=(e,t)=>{if("_"===e.charAt(0)){const o=e.slice(1,e.length);return P(t,o)}switch(e){case _.bool:return O(t);case _.float4:case _.float8:case _.int2:case _.int4:case _.int8:case _.numeric:case _.oid:return T(t);case _.json:case _.jsonb:return D(t);case _.timestamp:return N(t);case _.abstime:case _.date:case _.daterange:case _.int4range:case _.int8range:case _.money:case _.reltime:case _.text:case _.time:case _.timestamptz:case _.timetz:case _.tsrange:case _.tstzrange:default:return R(t)}},R=e=>e,O=e=>{switch(e){case"t":return!0;case"f":return!1;default:return e}},T=e=>{if("string"===typeof e){const t=parseFloat(e);if(!Number.isNaN(t))return t}return e},D=e=>{if("string"===typeof e)try{return JSON.parse(e)}catch(t){return console.log(`JSON parse error: ${t}`),e}return e},P=(e,t)=>{if("string"!==typeof e)return e;const o=e.length-1,n=e[o];if("{"===e[0]&&"}"===n){let n;const i=e.slice(1,o);try{n=JSON.parse("["+i+"]")}catch(r){n=i?i.split(","):[]}return n.map((e=>A(t,e)))}return e},N=e=>"string"===typeof e?e.replace(" ","T"):e,I=e=>{let t=e;return t=t.replace(/^ws/i,"http"),t=t.replace(/(\/socket\/websocket|\/socket|\/websocket)\/?$/i,""),t.replace(/\/+$/,"")};class M{constructor(e,t){let o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1e4;this.channel=e,this.event=t,this.payload=o,this.timeout=n,this.sent=!1,this.timeoutTimer=void 0,this.ref="",this.receivedResp=null,this.recHooks=[],this.refEvent=null}resend(e){this.timeout=e,this._cancelRefEvent(),this.ref="",this.refEvent=null,this.receivedResp=null,this.sent=!1,this.send()}send(){this._hasReceived("timeout")||(this.startTimeout(),this.sent=!0,this.channel.socket.push({topic:this.channel.topic,event:this.event,payload:this.payload,ref:this.ref,join_ref:this.channel._joinRef()}))}updatePayload(e){this.payload=Object.assign(Object.assign({},this.payload),e)}receive(e,t){var o;return this._hasReceived(e)&&t(null===(o=this.receivedResp)||void 0===o?void 0:o.response),this.recHooks.push({status:e,callback:t}),this}startTimeout(){if(this.timeoutTimer)return;this.ref=this.channel.socket._makeRef(),this.refEvent=this.channel._replyEventName(this.ref);this.channel._on(this.refEvent,{},(e=>{this._cancelRefEvent(),this._cancelTimeout(),this.receivedResp=e,this._matchReceive(e)})),this.timeoutTimer=setTimeout((()=>{this.trigger("timeout",{})}),this.timeout)}trigger(e,t){this.refEvent&&this.channel._trigger(this.refEvent,{status:e,response:t})}destroy(){this._cancelRefEvent(),this._cancelTimeout()}_cancelRefEvent(){this.refEvent&&this.channel._off(this.refEvent,{})}_cancelTimeout(){clearTimeout(this.timeoutTimer),this.timeoutTimer=void 0}_matchReceive(e){let{status:t,response:o}=e;this.recHooks.filter((e=>e.status===t)).forEach((e=>e.callback(o)))}_hasReceived(e){return this.receivedResp&&this.receivedResp.status===e}}var L,F,G,z;!function(e){e.SYNC="sync",e.JOIN="join",e.LEAVE="leave"}(L||(L={}));class H{constructor(e,t){this.channel=e,this.state={},this.pendingDiffs=[],this.joinRef=null,this.caller={onJoin:()=>{},onLeave:()=>{},onSync:()=>{}};const o=(null===t||void 0===t?void 0:t.events)||{state:"presence_state",diff:"presence_diff"};this.channel._on(o.state,{},(e=>{const{onJoin:t,onLeave:o,onSync:n}=this.caller;this.joinRef=this.channel._joinRef(),this.state=H.syncState(this.state,e,t,o),this.pendingDiffs.forEach((e=>{this.state=H.syncDiff(this.state,e,t,o)})),this.pendingDiffs=[],n()})),this.channel._on(o.diff,{},(e=>{const{onJoin:t,onLeave:o,onSync:n}=this.caller;this.inPendingSyncState()?this.pendingDiffs.push(e):(this.state=H.syncDiff(this.state,e,t,o),n())})),this.onJoin(((e,t,o)=>{this.channel._trigger("presence",{event:"join",key:e,currentPresences:t,newPresences:o})})),this.onLeave(((e,t,o)=>{this.channel._trigger("presence",{event:"leave",key:e,currentPresences:t,leftPresences:o})})),this.onSync((()=>{this.channel._trigger("presence",{event:"sync"})}))}static syncState(e,t,o,n){const r=this.cloneDeep(e),i=this.transformState(t),a={},s={};return this.map(r,((e,t)=>{i[e]||(s[e]=t)})),this.map(i,((e,t)=>{const o=r[e];if(o){const n=t.map((e=>e.presence_ref)),r=o.map((e=>e.presence_ref)),i=t.filter((e=>r.indexOf(e.presence_ref)<0)),l=o.filter((e=>n.indexOf(e.presence_ref)<0));i.length>0&&(a[e]=i),l.length>0&&(s[e]=l)}else a[e]=t})),this.syncDiff(r,{joins:a,leaves:s},o,n)}static syncDiff(e,t,o,n){const{joins:r,leaves:i}={joins:this.transformState(t.joins),leaves:this.transformState(t.leaves)};return o||(o=()=>{}),n||(n=()=>{}),this.map(r,((t,n)=>{var r;const i=null!==(r=e[t])&&void 0!==r?r:[];if(e[t]=this.cloneDeep(n),i.length>0){const o=e[t].map((e=>e.presence_ref)),n=i.filter((e=>o.indexOf(e.presence_ref)<0));e[t].unshift(...n)}o(t,i,n)})),this.map(i,((t,o)=>{let r=e[t];if(!r)return;const i=o.map((e=>e.presence_ref));r=r.filter((e=>i.indexOf(e.presence_ref)<0)),e[t]=r,n(t,r,o),0===r.length&&delete e[t]})),e}static map(e,t){return Object.getOwnPropertyNames(e).map((o=>t(o,e[o])))}static transformState(e){return e=this.cloneDeep(e),Object.getOwnPropertyNames(e).reduce(((t,o)=>{const n=e[o];return t[o]="metas"in n?n.metas.map((e=>(e.presence_ref=e.phx_ref,delete e.phx_ref,delete e.phx_ref_prev,e))):n,t}),{})}static cloneDeep(e){return JSON.parse(JSON.stringify(e))}onJoin(e){this.caller.onJoin=e}onLeave(e){this.caller.onLeave=e}onSync(e){this.caller.onSync=e}inPendingSyncState(){return!this.joinRef||this.joinRef!==this.channel._joinRef()}}!function(e){e.ALL="*",e.INSERT="INSERT",e.UPDATE="UPDATE",e.DELETE="DELETE"}(F||(F={})),function(e){e.BROADCAST="broadcast",e.PRESENCE="presence",e.POSTGRES_CHANGES="postgres_changes",e.SYSTEM="system"}(G||(G={})),function(e){e.SUBSCRIBED="SUBSCRIBED",e.TIMED_OUT="TIMED_OUT",e.CLOSED="CLOSED",e.CHANNEL_ERROR="CHANNEL_ERROR"}(z||(z={}));class B{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{config:{}},o=arguments.length>2?arguments[2]:void 0;this.topic=e,this.params=t,this.socket=o,this.bindings={},this.state=b.closed,this.joinedOnce=!1,this.pushBuffer=[],this.subTopic=e.replace(/^realtime:/i,""),this.params.config=Object.assign({broadcast:{ack:!1,self:!1},presence:{key:""},private:!1},t.config),this.timeout=this.socket.timeout,this.joinPush=new M(this,x.join,this.params,this.timeout),this.rejoinTimer=new E((()=>this._rejoinUntilConnected()),this.socket.reconnectAfterMs),this.joinPush.receive("ok",(()=>{this.state=b.joined,this.rejoinTimer.reset(),this.pushBuffer.forEach((e=>e.send())),this.pushBuffer=[]})),this._onClose((()=>{this.rejoinTimer.reset(),this.socket.log("channel",`close ${this.topic} ${this._joinRef()}`),this.state=b.closed,this.socket._remove(this)})),this._onError((e=>{this._isLeaving()||this._isClosed()||(this.socket.log("channel",`error ${this.topic}`,e),this.state=b.errored,this.rejoinTimer.scheduleTimeout())})),this.joinPush.receive("timeout",(()=>{this._isJoining()&&(this.socket.log("channel",`timeout ${this.topic}`,this.joinPush.timeout),this.state=b.errored,this.rejoinTimer.scheduleTimeout())})),this._on(x.reply,{},((e,t)=>{this._trigger(this._replyEventName(t),e)})),this.presence=new H(this),this.broadcastEndpointURL=I(this.socket.endPoint)+"/api/broadcast",this.private=this.params.config.private||!1}subscribe(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.timeout;var o,n;if(this.socket.isConnected()||this.socket.connect(),this.joinedOnce)throw"tried to subscribe multiple times. 'subscribe' can only be called a single time per channel instance";{const{config:{broadcast:r,presence:i,private:a}}=this.params;this._onError((t=>null===e||void 0===e?void 0:e(z.CHANNEL_ERROR,t))),this._onClose((()=>null===e||void 0===e?void 0:e(z.CLOSED)));const s={},l={broadcast:r,presence:i,postgres_changes:null!==(n=null===(o=this.bindings.postgres_changes)||void 0===o?void 0:o.map((e=>e.filter)))&&void 0!==n?n:[],private:a};this.socket.accessTokenValue&&(s.access_token=this.socket.accessTokenValue),this.updateJoinPayload(Object.assign({config:l},s)),this.joinedOnce=!0,this._rejoin(t),this.joinPush.receive("ok",(async t=>{let{postgres_changes:o}=t;var n;if(this.socket.setAuth(),void 0!==o){const t=this.bindings.postgres_changes,r=null!==(n=null===t||void 0===t?void 0:t.length)&&void 0!==n?n:0,i=[];for(let n=0;n<r;n++){const r=t[n],{filter:{event:a,schema:s,table:l,filter:c}}=r,d=o&&o[n];if(!d||d.event!==a||d.schema!==s||d.table!==l||d.filter!==c)return this.unsubscribe(),void(null===e||void 0===e||e(z.CHANNEL_ERROR,new Error("mismatch between server and client bindings for postgres changes")));i.push(Object.assign(Object.assign({},r),{id:d.id}))}return this.bindings.postgres_changes=i,void(e&&e(z.SUBSCRIBED))}null===e||void 0===e||e(z.SUBSCRIBED)})).receive("error",(t=>{null===e||void 0===e||e(z.CHANNEL_ERROR,new Error(JSON.stringify(Object.values(t).join(", ")||"error")))})).receive("timeout",(()=>{null===e||void 0===e||e(z.TIMED_OUT)}))}return this}presenceState(){return this.presence.state}async track(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return await this.send({type:"presence",event:"track",payload:e},t.timeout||this.timeout)}async untrack(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return await this.send({type:"presence",event:"untrack"},e)}on(e,t,o){return this._on(e,t,o)}async send(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};var o,n;if(this._canPush()||"broadcast"!==e.type)return new Promise((o=>{var n,r,i;const a=this._push(e.type,e,t.timeout||this.timeout);"broadcast"!==e.type||(null===(i=null===(r=null===(n=this.params)||void 0===n?void 0:n.config)||void 0===r?void 0:r.broadcast)||void 0===i?void 0:i.ack)||o("ok"),a.receive("ok",(()=>o("ok"))),a.receive("error",(()=>o("error"))),a.receive("timeout",(()=>o("timed out")))}));{const{event:i,payload:a}=e,s={method:"POST",headers:{Authorization:this.socket.accessTokenValue?`Bearer ${this.socket.accessTokenValue}`:"",apikey:this.socket.apiKey?this.socket.apiKey:"","Content-Type":"application/json"},body:JSON.stringify({messages:[{topic:this.subTopic,event:i,payload:a,private:this.private}]})};try{const e=await this._fetchWithTimeout(this.broadcastEndpointURL,s,null!==(o=t.timeout)&&void 0!==o?o:this.timeout);return await(null===(n=e.body)||void 0===n?void 0:n.cancel()),e.ok?"ok":"error"}catch(r){return"AbortError"===r.name?"timed out":"error"}}}updateJoinPayload(e){this.joinPush.updatePayload(e)}unsubscribe(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.timeout;this.state=b.leaving;const t=()=>{this.socket.log("channel",`leave ${this.topic}`),this._trigger(x.close,"leave",this._joinRef())};return this.rejoinTimer.reset(),this.joinPush.destroy(),new Promise((o=>{const n=new M(this,x.leave,{},e);n.receive("ok",(()=>{t(),o("ok")})).receive("timeout",(()=>{t(),o("timed out")})).receive("error",(()=>{o("error")})),n.send(),this._canPush()||n.trigger("ok",{})}))}async _fetchWithTimeout(e,t,o){const n=new AbortController,r=setTimeout((()=>n.abort()),o),i=await this.socket.fetch(e,Object.assign(Object.assign({},t),{signal:n.signal}));return clearTimeout(r),i}_push(e,t){let o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:this.timeout;if(!this.joinedOnce)throw`tried to push '${e}' to '${this.topic}' before joining. Use channel.subscribe() before pushing events`;let n=new M(this,e,t,o);return this._canPush()?n.send():(n.startTimeout(),this.pushBuffer.push(n)),n}_onMessage(e,t,o){return t}_isMember(e){return this.topic===e}_joinRef(){return this.joinPush.ref}_trigger(e,t,o){var n,r;const i=e.toLocaleLowerCase(),{close:a,error:s,leave:l,join:c}=x;if(o&&[a,s,l,c].indexOf(i)>=0&&o!==this._joinRef())return;let d=this._onMessage(i,t,o);if(t&&!d)throw"channel onMessage callbacks must return the payload, modified or unmodified";["insert","update","delete"].includes(i)?null===(n=this.bindings.postgres_changes)||void 0===n||n.filter((e=>{var t,o,n;return"*"===(null===(t=e.filter)||void 0===t?void 0:t.event)||(null===(n=null===(o=e.filter)||void 0===o?void 0:o.event)||void 0===n?void 0:n.toLocaleLowerCase())===i})).map((e=>e.callback(d,o))):null===(r=this.bindings[i])||void 0===r||r.filter((e=>{var o,n,r,a,s,l;if(["broadcast","presence","postgres_changes"].includes(i)){if("id"in e){const i=e.id,a=null===(o=e.filter)||void 0===o?void 0:o.event;return i&&(null===(n=t.ids)||void 0===n?void 0:n.includes(i))&&("*"===a||(null===a||void 0===a?void 0:a.toLocaleLowerCase())===(null===(r=t.data)||void 0===r?void 0:r.type.toLocaleLowerCase()))}{const o=null===(s=null===(a=null===e||void 0===e?void 0:e.filter)||void 0===a?void 0:a.event)||void 0===s?void 0:s.toLocaleLowerCase();return"*"===o||o===(null===(l=null===t||void 0===t?void 0:t.event)||void 0===l?void 0:l.toLocaleLowerCase())}}return e.type.toLocaleLowerCase()===i})).map((e=>{if("object"===typeof d&&"ids"in d){const e=d.data,{schema:t,table:o,commit_timestamp:n,type:r,errors:i}=e,a={schema:t,table:o,commit_timestamp:n,eventType:r,new:{},old:{},errors:i};d=Object.assign(Object.assign({},a),this._getPayloadRecords(e))}e.callback(d,o)}))}_isClosed(){return this.state===b.closed}_isJoined(){return this.state===b.joined}_isJoining(){return this.state===b.joining}_isLeaving(){return this.state===b.leaving}_replyEventName(e){return`chan_reply_${e}`}_on(e,t,o){const n=e.toLocaleLowerCase(),r={type:n,filter:t,callback:o};return this.bindings[n]?this.bindings[n].push(r):this.bindings[n]=[r],this}_off(e,t){const o=e.toLocaleLowerCase();return this.bindings[o]=this.bindings[o].filter((e=>{var n;return!((null===(n=e.type)||void 0===n?void 0:n.toLocaleLowerCase())===o&&B.isEqual(e.filter,t))})),this}static isEqual(e,t){if(Object.keys(e).length!==Object.keys(t).length)return!1;for(const o in e)if(e[o]!==t[o])return!1;return!0}_rejoinUntilConnected(){this.rejoinTimer.scheduleTimeout(),this.socket.isConnected()&&this._rejoin()}_onClose(e){this._on(x.close,{},e)}_onError(e){this._on(x.error,{},(t=>e(t)))}_canPush(){return this.socket.isConnected()&&this._isJoined()}_rejoin(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.timeout;this._isLeaving()||(this.socket._leaveOpenTopic(this.topic),this.state=b.joining,this.joinPush.resend(e))}_getPayloadRecords(e){const t={new:{},old:{}};return"INSERT"!==e.type&&"UPDATE"!==e.type||(t.new=k(e.columns,e.record)),"UPDATE"!==e.type&&"DELETE"!==e.type||(t.old=k(e.columns,e.old_record)),t}}const V=()=>{},$="undefined"!==typeof WebSocket;class U{constructor(e,t){var n;this.accessTokenValue=null,this.apiKey=null,this.channels=[],this.endPoint="",this.httpEndpoint="",this.headers=y,this.params={},this.timeout=1e4,this.heartbeatIntervalMs=3e4,this.heartbeatTimer=void 0,this.pendingHeartbeatRef=null,this.ref=0,this.logger=V,this.conn=null,this.sendBuffer=[],this.serializer=new S,this.stateChangeCallbacks={open:[],close:[],error:[],message:[]},this.accessToken=null,this._resolveFetch=e=>{let t;return t=e||("undefined"===typeof fetch?function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return Promise.resolve().then(o.bind(o,4630)).then((e=>{let{default:o}=e;return o(...t)}))}:fetch),function(){return t(...arguments)}},this.endPoint=`${e}/${w.websocket}`,this.httpEndpoint=I(e),(null===t||void 0===t?void 0:t.transport)?this.transport=t.transport:this.transport=null,(null===t||void 0===t?void 0:t.params)&&(this.params=t.params),(null===t||void 0===t?void 0:t.headers)&&(this.headers=Object.assign(Object.assign({},this.headers),t.headers)),(null===t||void 0===t?void 0:t.timeout)&&(this.timeout=t.timeout),(null===t||void 0===t?void 0:t.logger)&&(this.logger=t.logger),(null===t||void 0===t?void 0:t.heartbeatIntervalMs)&&(this.heartbeatIntervalMs=t.heartbeatIntervalMs);const r=null===(n=null===t||void 0===t?void 0:t.params)||void 0===n?void 0:n.apikey;if(r&&(this.accessTokenValue=r,this.apiKey=r),this.reconnectAfterMs=(null===t||void 0===t?void 0:t.reconnectAfterMs)?t.reconnectAfterMs:e=>[1e3,2e3,5e3,1e4][e-1]||1e4,this.encode=(null===t||void 0===t?void 0:t.encode)?t.encode:(e,t)=>t(JSON.stringify(e)),this.decode=(null===t||void 0===t?void 0:t.decode)?t.decode:this.serializer.decode.bind(this.serializer),this.reconnectTimer=new E((async()=>{this.disconnect(),this.connect()}),this.reconnectAfterMs),this.fetch=this._resolveFetch(null===t||void 0===t?void 0:t.fetch),null===t||void 0===t?void 0:t.worker){if("undefined"!==typeof window&&!window.Worker)throw new Error("Web Worker is not supported");this.worker=(null===t||void 0===t?void 0:t.worker)||!1,this.workerUrl=null===t||void 0===t?void 0:t.workerUrl}this.accessToken=(null===t||void 0===t?void 0:t.accessToken)||null}connect(){if(!this.conn)if(this.transport)this.conn=new this.transport(this.endpointURL(),void 0,{headers:this.headers});else{if($)return this.conn=new WebSocket(this.endpointURL()),void this.setupConnection();this.conn=new W(this.endpointURL(),void 0,{close:()=>{this.conn=null}}),o.e(198).then(o.t.bind(o,1198,23)).then((e=>{let{default:t}=e;this.conn=new t(this.endpointURL(),void 0,{headers:this.headers}),this.setupConnection()}))}}endpointURL(){return this._appendParams(this.endPoint,Object.assign({},this.params,{vsn:"1.0.0"}))}disconnect(e,t){this.conn&&(this.conn.onclose=function(){},e?this.conn.close(e,null!==t&&void 0!==t?t:""):this.conn.close(),this.conn=null,this.heartbeatTimer&&clearInterval(this.heartbeatTimer),this.reconnectTimer.reset())}getChannels(){return this.channels}async removeChannel(e){const t=await e.unsubscribe();return 0===this.channels.length&&this.disconnect(),t}async removeAllChannels(){const e=await Promise.all(this.channels.map((e=>e.unsubscribe())));return this.disconnect(),e}log(e,t,o){this.logger(e,t,o)}connectionState(){switch(this.conn&&this.conn.readyState){case v.connecting:return C.Connecting;case v.open:return C.Open;case v.closing:return C.Closing;default:return C.Closed}}isConnected(){return this.connectionState()===C.Open}channel(e){const t=new B(`realtime:${e}`,arguments.length>1&&void 0!==arguments[1]?arguments[1]:{config:{}},this);return this.channels.push(t),t}push(e){const{topic:t,event:o,payload:n,ref:r}=e,i=()=>{this.encode(e,(e=>{var t;null===(t=this.conn)||void 0===t||t.send(e)}))};this.log("push",`${t} ${o} (${r})`,n),this.isConnected()?i():this.sendBuffer.push(i)}async setAuth(){let e=(arguments.length>0&&void 0!==arguments[0]?arguments[0]:null)||this.accessToken&&await this.accessToken()||this.accessTokenValue;if(e){let o=null;try{o=JSON.parse(atob(e.split(".")[1]))}catch(t){}if(o&&o.exp){if(!(Math.floor(Date.now()/1e3)-o.exp<0))return this.log("auth",`InvalidJWTToken: Invalid value for JWT claim "exp" with value ${o.exp}`),Promise.reject(`InvalidJWTToken: Invalid value for JWT claim "exp" with value ${o.exp}`)}this.accessTokenValue=e,this.channels.forEach((t=>{e&&t.updateJoinPayload({access_token:e}),t.joinedOnce&&t._isJoined()&&t._push(x.access_token,{access_token:e})}))}}async sendHeartbeat(){var e;if(this.isConnected()){if(this.pendingHeartbeatRef)return this.pendingHeartbeatRef=null,this.log("transport","heartbeat timeout. Attempting to re-establish connection"),void(null===(e=this.conn)||void 0===e||e.close(1e3,"hearbeat timeout"));this.pendingHeartbeatRef=this._makeRef(),this.push({topic:"phoenix",event:"heartbeat",payload:{},ref:this.pendingHeartbeatRef}),this.setAuth()}}flushSendBuffer(){this.isConnected()&&this.sendBuffer.length>0&&(this.sendBuffer.forEach((e=>e())),this.sendBuffer=[])}_makeRef(){let e=this.ref+1;return e===this.ref?this.ref=0:this.ref=e,this.ref.toString()}_leaveOpenTopic(e){let t=this.channels.find((t=>t.topic===e&&(t._isJoined()||t._isJoining())));t&&(this.log("transport",`leaving duplicate topic "${e}"`),t.unsubscribe())}_remove(e){this.channels=this.channels.filter((t=>t._joinRef()!==e._joinRef()))}setupConnection(){this.conn&&(this.conn.binaryType="arraybuffer",this.conn.onopen=()=>this._onConnOpen(),this.conn.onerror=e=>this._onConnError(e),this.conn.onmessage=e=>this._onConnMessage(e),this.conn.onclose=e=>this._onConnClose(e))}_onConnMessage(e){this.decode(e.data,(e=>{let{topic:t,event:o,payload:n,ref:r}=e;r&&r===this.pendingHeartbeatRef&&(this.pendingHeartbeatRef=null),this.log("receive",`${n.status||""} ${t} ${o} ${r&&"("+r+")"||""}`,n),this.channels.filter((e=>e._isMember(t))).forEach((e=>e._trigger(o,n,r))),this.stateChangeCallbacks.message.forEach((t=>t(e)))}))}async _onConnOpen(){if(this.log("transport",`connected to ${this.endpointURL()}`),this.flushSendBuffer(),this.reconnectTimer.reset(),this.worker){this.workerUrl?this.log("worker",`starting worker for from ${this.workerUrl}`):this.log("worker","starting default worker");const e=this._workerObjectUrl(this.workerUrl);this.workerRef=new Worker(e),this.workerRef.onerror=e=>{this.log("worker","worker error",e.message),this.workerRef.terminate()},this.workerRef.onmessage=e=>{"keepAlive"===e.data.event&&this.sendHeartbeat()},this.workerRef.postMessage({event:"start",interval:this.heartbeatIntervalMs})}else this.heartbeatTimer&&clearInterval(this.heartbeatTimer),this.heartbeatTimer=setInterval((()=>this.sendHeartbeat()),this.heartbeatIntervalMs);this.stateChangeCallbacks.open.forEach((e=>e()))}_onConnClose(e){this.log("transport","close",e),this._triggerChanError(),this.heartbeatTimer&&clearInterval(this.heartbeatTimer),this.reconnectTimer.scheduleTimeout(),this.stateChangeCallbacks.close.forEach((t=>t(e)))}_onConnError(e){this.log("transport",e.message),this._triggerChanError(),this.stateChangeCallbacks.error.forEach((t=>t(e)))}_triggerChanError(){this.channels.forEach((e=>e._trigger(x.error)))}_appendParams(e,t){if(0===Object.keys(t).length)return e;const o=e.match(/\?/)?"&":"?";return`${e}${o}${new URLSearchParams(t)}`}_workerObjectUrl(e){let t;if(e)t=e;else{const e=new Blob(['\n  addEventListener("message", (e) => {\n    if (e.data.event === "start") {\n      setInterval(() => postMessage({ event: "keepAlive" }), e.data.interval);\n    }\n  });'],{type:"application/javascript"});t=URL.createObjectURL(e)}return t}}class W{constructor(e,t,o){this.binaryType="arraybuffer",this.onclose=()=>{},this.onerror=()=>{},this.onmessage=()=>{},this.onopen=()=>{},this.readyState=v.connecting,this.send=()=>{},this.url=null,this.url=e,this.close=o.close}}class q extends Error{constructor(e){super(e),this.__isStorageError=!0,this.name="StorageError"}}function K(e){return"object"===typeof e&&null!==e&&"__isStorageError"in e}class Y extends q{constructor(e,t){super(e),this.name="StorageApiError",this.status=t}toJSON(){return{name:this.name,message:this.message,status:this.status}}}class J extends q{constructor(e,t){super(e),this.name="StorageUnknownError",this.originalError=t}}var X=function(e,t,o,n){return new(o||(o=Promise))((function(r,i){function a(e){try{l(n.next(e))}catch(t){i(t)}}function s(e){try{l(n.throw(e))}catch(t){i(t)}}function l(e){var t;e.done?r(e.value):(t=e.value,t instanceof o?t:new o((function(e){e(t)}))).then(a,s)}l((n=n.apply(e,t||[])).next())}))};const Q=e=>{let t;return t=e||("undefined"===typeof fetch?function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return Promise.resolve().then(o.bind(o,4630)).then((e=>{let{default:o}=e;return o(...t)}))}:fetch),function(){return t(...arguments)}},Z=e=>{if(Array.isArray(e))return e.map((e=>Z(e)));if("function"===typeof e||e!==Object(e))return e;const t={};return Object.entries(e).forEach((e=>{let[o,n]=e;const r=o.replace(/([-_][a-z])/gi,(e=>e.toUpperCase().replace(/[-_]/g,"")));t[r]=Z(n)})),t};var ee=function(e,t,o,n){return new(o||(o=Promise))((function(r,i){function a(e){try{l(n.next(e))}catch(t){i(t)}}function s(e){try{l(n.throw(e))}catch(t){i(t)}}function l(e){var t;e.done?r(e.value):(t=e.value,t instanceof o?t:new o((function(e){e(t)}))).then(a,s)}l((n=n.apply(e,t||[])).next())}))};const te=e=>e.msg||e.message||e.error_description||e.error||JSON.stringify(e),oe=(e,t,n)=>ee(void 0,void 0,void 0,(function*(){const r=yield X(void 0,void 0,void 0,(function*(){return"undefined"===typeof Response?(yield Promise.resolve().then(o.bind(o,4630))).Response:Response}));e instanceof r&&!(null===n||void 0===n?void 0:n.noResolveJson)?e.json().then((o=>{t(new Y(te(o),e.status||500))})).catch((e=>{t(new J(te(e),e))})):t(new J(te(e),e))}));function ne(e,t,o,n,r,i){return ee(this,void 0,void 0,(function*(){return new Promise(((a,s)=>{e(o,((e,t,o,n)=>{const r={method:e,headers:(null===t||void 0===t?void 0:t.headers)||{}};return"GET"===e?r:(r.headers=Object.assign({"Content-Type":"application/json"},null===t||void 0===t?void 0:t.headers),n&&(r.body=JSON.stringify(n)),Object.assign(Object.assign({},r),o))})(t,n,r,i)).then((e=>{if(!e.ok)throw e;return(null===n||void 0===n?void 0:n.noResolveJson)?e:e.json()})).then((e=>a(e))).catch((e=>oe(e,s,n)))}))}))}function re(e,t,o,n){return ee(this,void 0,void 0,(function*(){return ne(e,"GET",t,o,n)}))}function ie(e,t,o,n,r){return ee(this,void 0,void 0,(function*(){return ne(e,"POST",t,n,r,o)}))}function ae(e,t,o,n,r){return ee(this,void 0,void 0,(function*(){return ne(e,"DELETE",t,n,r,o)}))}var se=function(e,t,o,n){return new(o||(o=Promise))((function(r,i){function a(e){try{l(n.next(e))}catch(t){i(t)}}function s(e){try{l(n.throw(e))}catch(t){i(t)}}function l(e){var t;e.done?r(e.value):(t=e.value,t instanceof o?t:new o((function(e){e(t)}))).then(a,s)}l((n=n.apply(e,t||[])).next())}))};const le={limit:100,offset:0,sortBy:{column:"name",order:"asc"}},ce={cacheControl:"3600",contentType:"text/plain;charset=UTF-8",upsert:!1};class de{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},o=arguments.length>2?arguments[2]:void 0,n=arguments.length>3?arguments[3]:void 0;this.url=e,this.headers=t,this.bucketId=o,this.fetch=Q(n)}uploadOrUpdate(e,t,o,n){return se(this,void 0,void 0,(function*(){try{let r;const i=Object.assign(Object.assign({},ce),n);let a=Object.assign(Object.assign({},this.headers),"POST"===e&&{"x-upsert":String(i.upsert)});const s=i.metadata;"undefined"!==typeof Blob&&o instanceof Blob?(r=new FormData,r.append("cacheControl",i.cacheControl),s&&r.append("metadata",this.encodeMetadata(s)),r.append("",o)):"undefined"!==typeof FormData&&o instanceof FormData?(r=o,r.append("cacheControl",i.cacheControl),s&&r.append("metadata",this.encodeMetadata(s))):(r=o,a["cache-control"]=`max-age=${i.cacheControl}`,a["content-type"]=i.contentType,s&&(a["x-metadata"]=this.toBase64(this.encodeMetadata(s)))),(null===n||void 0===n?void 0:n.headers)&&(a=Object.assign(Object.assign({},a),n.headers));const l=this._removeEmptyFolders(t),c=this._getFinalPath(l),d=yield this.fetch(`${this.url}/object/${c}`,Object.assign({method:e,body:r,headers:a},(null===i||void 0===i?void 0:i.duplex)?{duplex:i.duplex}:{})),u=yield d.json();if(d.ok)return{data:{path:l,id:u.Id,fullPath:u.Key},error:null};return{data:null,error:u}}catch(r){if(K(r))return{data:null,error:r};throw r}}))}upload(e,t,o){return se(this,void 0,void 0,(function*(){return this.uploadOrUpdate("POST",e,t,o)}))}uploadToSignedUrl(e,t,o,n){return se(this,void 0,void 0,(function*(){const r=this._removeEmptyFolders(e),i=this._getFinalPath(r),a=new URL(this.url+`/object/upload/sign/${i}`);a.searchParams.set("token",t);try{let e;const t=Object.assign({upsert:ce.upsert},n),i=Object.assign(Object.assign({},this.headers),{"x-upsert":String(t.upsert)});"undefined"!==typeof Blob&&o instanceof Blob?(e=new FormData,e.append("cacheControl",t.cacheControl),e.append("",o)):"undefined"!==typeof FormData&&o instanceof FormData?(e=o,e.append("cacheControl",t.cacheControl)):(e=o,i["cache-control"]=`max-age=${t.cacheControl}`,i["content-type"]=t.contentType);const s=yield this.fetch(a.toString(),{method:"PUT",body:e,headers:i}),l=yield s.json();if(s.ok)return{data:{path:r,fullPath:l.Key},error:null};return{data:null,error:l}}catch(s){if(K(s))return{data:null,error:s};throw s}}))}createSignedUploadUrl(e,t){return se(this,void 0,void 0,(function*(){try{let o=this._getFinalPath(e);const n=Object.assign({},this.headers);(null===t||void 0===t?void 0:t.upsert)&&(n["x-upsert"]="true");const r=yield ie(this.fetch,`${this.url}/object/upload/sign/${o}`,{},{headers:n}),i=new URL(this.url+r.url),a=i.searchParams.get("token");if(!a)throw new q("No token returned by API");return{data:{signedUrl:i.toString(),path:e,token:a},error:null}}catch(o){if(K(o))return{data:null,error:o};throw o}}))}update(e,t,o){return se(this,void 0,void 0,(function*(){return this.uploadOrUpdate("PUT",e,t,o)}))}move(e,t,o){return se(this,void 0,void 0,(function*(){try{return{data:yield ie(this.fetch,`${this.url}/object/move`,{bucketId:this.bucketId,sourceKey:e,destinationKey:t,destinationBucket:null===o||void 0===o?void 0:o.destinationBucket},{headers:this.headers}),error:null}}catch(n){if(K(n))return{data:null,error:n};throw n}}))}copy(e,t,o){return se(this,void 0,void 0,(function*(){try{return{data:{path:(yield ie(this.fetch,`${this.url}/object/copy`,{bucketId:this.bucketId,sourceKey:e,destinationKey:t,destinationBucket:null===o||void 0===o?void 0:o.destinationBucket},{headers:this.headers})).Key},error:null}}catch(n){if(K(n))return{data:null,error:n};throw n}}))}createSignedUrl(e,t,o){return se(this,void 0,void 0,(function*(){try{let n=this._getFinalPath(e),r=yield ie(this.fetch,`${this.url}/object/sign/${n}`,Object.assign({expiresIn:t},(null===o||void 0===o?void 0:o.transform)?{transform:o.transform}:{}),{headers:this.headers});const i=(null===o||void 0===o?void 0:o.download)?`&download=${!0===o.download?"":o.download}`:"";return r={signedUrl:encodeURI(`${this.url}${r.signedURL}${i}`)},{data:r,error:null}}catch(n){if(K(n))return{data:null,error:n};throw n}}))}createSignedUrls(e,t,o){return se(this,void 0,void 0,(function*(){try{const n=yield ie(this.fetch,`${this.url}/object/sign/${this.bucketId}`,{expiresIn:t,paths:e},{headers:this.headers}),r=(null===o||void 0===o?void 0:o.download)?`&download=${!0===o.download?"":o.download}`:"";return{data:n.map((e=>Object.assign(Object.assign({},e),{signedUrl:e.signedURL?encodeURI(`${this.url}${e.signedURL}${r}`):null}))),error:null}}catch(n){if(K(n))return{data:null,error:n};throw n}}))}download(e,t){return se(this,void 0,void 0,(function*(){const o="undefined"!==typeof(null===t||void 0===t?void 0:t.transform)?"render/image/authenticated":"object",n=this.transformOptsToQueryString((null===t||void 0===t?void 0:t.transform)||{}),r=n?`?${n}`:"";try{const t=this._getFinalPath(e),n=yield re(this.fetch,`${this.url}/${o}/${t}${r}`,{headers:this.headers,noResolveJson:!0});return{data:yield n.blob(),error:null}}catch(i){if(K(i))return{data:null,error:i};throw i}}))}info(e){return se(this,void 0,void 0,(function*(){const t=this._getFinalPath(e);try{const e=yield re(this.fetch,`${this.url}/object/info/${t}`,{headers:this.headers});return{data:Z(e),error:null}}catch(o){if(K(o))return{data:null,error:o};throw o}}))}exists(e){return se(this,void 0,void 0,(function*(){const t=this._getFinalPath(e);try{return yield function(e,t,o,n){return ee(this,void 0,void 0,(function*(){return ne(e,"HEAD",t,Object.assign(Object.assign({},o),{noResolveJson:!0}),n)}))}(this.fetch,`${this.url}/object/${t}`,{headers:this.headers}),{data:!0,error:null}}catch(o){if(K(o)&&o instanceof J){const e=o.originalError;if([400,404].includes(null===e||void 0===e?void 0:e.status))return{data:!1,error:o}}throw o}}))}getPublicUrl(e,t){const o=this._getFinalPath(e),n=[],r=(null===t||void 0===t?void 0:t.download)?`download=${!0===t.download?"":t.download}`:"";""!==r&&n.push(r);const i="undefined"!==typeof(null===t||void 0===t?void 0:t.transform)?"render/image":"object",a=this.transformOptsToQueryString((null===t||void 0===t?void 0:t.transform)||{});""!==a&&n.push(a);let s=n.join("&");return""!==s&&(s=`?${s}`),{data:{publicUrl:encodeURI(`${this.url}/${i}/public/${o}${s}`)}}}remove(e){return se(this,void 0,void 0,(function*(){try{return{data:yield ae(this.fetch,`${this.url}/object/${this.bucketId}`,{prefixes:e},{headers:this.headers}),error:null}}catch(t){if(K(t))return{data:null,error:t};throw t}}))}list(e,t,o){return se(this,void 0,void 0,(function*(){try{const n=Object.assign(Object.assign(Object.assign({},le),t),{prefix:e||""});return{data:yield ie(this.fetch,`${this.url}/object/list/${this.bucketId}`,n,{headers:this.headers},o),error:null}}catch(n){if(K(n))return{data:null,error:n};throw n}}))}encodeMetadata(e){return JSON.stringify(e)}toBase64(e){return"undefined"!==typeof Buffer?Buffer.from(e).toString("base64"):btoa(e)}_getFinalPath(e){return`${this.bucketId}/${e}`}_removeEmptyFolders(e){return e.replace(/^\/|\/$/g,"").replace(/\/+/g,"/")}transformOptsToQueryString(e){const t=[];return e.width&&t.push(`width=${e.width}`),e.height&&t.push(`height=${e.height}`),e.resize&&t.push(`resize=${e.resize}`),e.format&&t.push(`format=${e.format}`),e.quality&&t.push(`quality=${e.quality}`),t.join("&")}}const ue={"X-Client-Info":"storage-js/2.7.1"};var pe=function(e,t,o,n){return new(o||(o=Promise))((function(r,i){function a(e){try{l(n.next(e))}catch(t){i(t)}}function s(e){try{l(n.throw(e))}catch(t){i(t)}}function l(e){var t;e.done?r(e.value):(t=e.value,t instanceof o?t:new o((function(e){e(t)}))).then(a,s)}l((n=n.apply(e,t||[])).next())}))};class he{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},o=arguments.length>2?arguments[2]:void 0;this.url=e,this.headers=Object.assign(Object.assign({},ue),t),this.fetch=Q(o)}listBuckets(){return pe(this,void 0,void 0,(function*(){try{return{data:yield re(this.fetch,`${this.url}/bucket`,{headers:this.headers}),error:null}}catch(e){if(K(e))return{data:null,error:e};throw e}}))}getBucket(e){return pe(this,void 0,void 0,(function*(){try{return{data:yield re(this.fetch,`${this.url}/bucket/${e}`,{headers:this.headers}),error:null}}catch(t){if(K(t))return{data:null,error:t};throw t}}))}createBucket(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{public:!1};return pe(this,void 0,void 0,(function*(){try{return{data:yield ie(this.fetch,`${this.url}/bucket`,{id:e,name:e,public:t.public,file_size_limit:t.fileSizeLimit,allowed_mime_types:t.allowedMimeTypes},{headers:this.headers}),error:null}}catch(o){if(K(o))return{data:null,error:o};throw o}}))}updateBucket(e,t){return pe(this,void 0,void 0,(function*(){try{const o=yield function(e,t,o,n,r){return ee(this,void 0,void 0,(function*(){return ne(e,"PUT",t,n,r,o)}))}(this.fetch,`${this.url}/bucket/${e}`,{id:e,name:e,public:t.public,file_size_limit:t.fileSizeLimit,allowed_mime_types:t.allowedMimeTypes},{headers:this.headers});return{data:o,error:null}}catch(o){if(K(o))return{data:null,error:o};throw o}}))}emptyBucket(e){return pe(this,void 0,void 0,(function*(){try{return{data:yield ie(this.fetch,`${this.url}/bucket/${e}/empty`,{},{headers:this.headers}),error:null}}catch(t){if(K(t))return{data:null,error:t};throw t}}))}deleteBucket(e){return pe(this,void 0,void 0,(function*(){try{return{data:yield ae(this.fetch,`${this.url}/bucket/${e}`,{},{headers:this.headers}),error:null}}catch(t){if(K(t))return{data:null,error:t};throw t}}))}}class fe extends he{constructor(e){super(e,arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},arguments.length>2?arguments[2]:void 0)}from(e){return new de(this.url,this.headers,e,this.fetch)}}let ge="";ge="undefined"!==typeof Deno?"deno":"undefined"!==typeof document?"web":"undefined"!==typeof navigator&&"ReactNative"===navigator.product?"react-native":"node";const me={headers:{"X-Client-Info":`supabase-js-${ge}/2.49.1`}},ye={schema:"public"},ve={autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,flowType:"implicit"},be={};var xe=o(4630),we=function(e,t,o,n){return new(o||(o=Promise))((function(r,i){function a(e){try{l(n.next(e))}catch(t){i(t)}}function s(e){try{l(n.throw(e))}catch(t){i(t)}}function l(e){var t;e.done?r(e.value):(t=e.value,t instanceof o?t:new o((function(e){e(t)}))).then(a,s)}l((n=n.apply(e,t||[])).next())}))};const Ce=e=>{let t;return t=e||("undefined"===typeof fetch?xe.default:fetch),function(){return t(...arguments)}},_e=(e,t,o)=>{const n=Ce(o),r="undefined"===typeof Headers?xe.Headers:Headers;return(o,i)=>we(void 0,void 0,void 0,(function*(){var a;const s=null!==(a=yield t())&&void 0!==a?a:e;let l=new r(null===i||void 0===i?void 0:i.headers);return l.has("apikey")||l.set("apikey",e),l.has("Authorization")||l.set("Authorization",`Bearer ${s}`),n(o,Object.assign(Object.assign({},i),{headers:l}))}))};var Se=function(e,t,o,n){return new(o||(o=Promise))((function(r,i){function a(e){try{l(n.next(e))}catch(t){i(t)}}function s(e){try{l(n.throw(e))}catch(t){i(t)}}function l(e){var t;e.done?r(e.value):(t=e.value,t instanceof o?t:new o((function(e){e(t)}))).then(a,s)}l((n=n.apply(e,t||[])).next())}))};const Ee="2.68.0",ke=3e4,je=9e4,Ae={"X-Client-Info":`gotrue-js/${Ee}`},Re="X-Supabase-Api-Version",Oe={timestamp:Date.parse("2024-01-01T00:00:00.0Z"),name:"2024-01-01"};const Te=()=>"undefined"!==typeof window&&"undefined"!==typeof document,De={tested:!1,writable:!1},Pe=()=>{if(!Te())return!1;try{if("object"!==typeof globalThis.localStorage)return!1}catch(t){return!1}if(De.tested)return De.writable;const e=`lswt-${Math.random()}${Math.random()}`;try{globalThis.localStorage.setItem(e,e),globalThis.localStorage.removeItem(e),De.tested=!0,De.writable=!0}catch(t){De.tested=!0,De.writable=!1}return De.writable};const Ne=e=>{let t;return t=e||("undefined"===typeof fetch?function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return Promise.resolve().then(o.bind(o,4630)).then((e=>{let{default:o}=e;return o(...t)}))}:fetch),function(){return t(...arguments)}},Ie=async(e,t,o)=>{await e.setItem(t,JSON.stringify(o))},Me=async(e,t)=>{const o=await e.getItem(t);if(!o)return null;try{return JSON.parse(o)}catch(n){return o}},Le=async(e,t)=>{await e.removeItem(t)};class Fe{constructor(){this.promise=new Fe.promiseConstructor(((e,t)=>{this.resolve=e,this.reject=t}))}}function Ge(e){const t=e.split(".");if(3!==t.length)throw new Error("JWT is not valid: not a JWT structure");if(!/^([a-z0-9_-]{4})*($|[a-z0-9_-]{3}=?$|[a-z0-9_-]{2}(==)?$)$/i.test(t[1]))throw new Error("JWT is not valid: payload is not in base64url format");const o=t[1];return JSON.parse(function(e){const t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";let o,n,r,i,a,s,l,c="",d=0;for(e=e.replace("-","+").replace("_","/");d<e.length;)i=t.indexOf(e.charAt(d++)),a=t.indexOf(e.charAt(d++)),s=t.indexOf(e.charAt(d++)),l=t.indexOf(e.charAt(d++)),o=i<<2|a>>4,n=(15&a)<<4|s>>2,r=(3&s)<<6|l,c+=String.fromCharCode(o),64!=s&&0!=n&&(c+=String.fromCharCode(n)),64!=l&&0!=r&&(c+=String.fromCharCode(r));return c}(o))}function ze(e){return("0"+e.toString(16)).substr(-2)}async function He(e){if(!("undefined"!==typeof crypto&&"undefined"!==typeof crypto.subtle&&"undefined"!==typeof TextEncoder))return console.warn("WebCrypto API is not supported. Code challenge method will default to use plain instead of sha256."),e;const t=await async function(e){const t=(new TextEncoder).encode(e),o=await crypto.subtle.digest("SHA-256",t),n=new Uint8Array(o);return Array.from(n).map((e=>String.fromCharCode(e))).join("")}(e);return btoa(t).replace(/\+/g,"-").replace(/\//g,"_").replace(/=+$/,"")}async function Be(e,t){let o=arguments.length>2&&void 0!==arguments[2]&&arguments[2];const n=function(){const e=new Uint32Array(56);if("undefined"===typeof crypto){const e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-._~",t=e.length;let o="";for(let n=0;n<56;n++)o+=e.charAt(Math.floor(Math.random()*t));return o}return crypto.getRandomValues(e),Array.from(e,ze).join("")}();let r=n;o&&(r+="/PASSWORD_RECOVERY"),await Ie(e,`${t}-code-verifier`,r);const i=await He(n);return[i,n===i?"plain":"s256"]}Fe.promiseConstructor=Promise;const Ve=/^2[0-9]{3}-(0[1-9]|1[0-2])-(0[1-9]|1[0-9]|2[0-9]|3[0-1])$/i;class $e extends Error{constructor(e,t,o){super(e),this.__isAuthError=!0,this.name="AuthError",this.status=t,this.code=o}}function Ue(e){return"object"===typeof e&&null!==e&&"__isAuthError"in e}class We extends $e{constructor(e,t,o){super(e,t,o),this.name="AuthApiError",this.status=t,this.code=o}}class qe extends $e{constructor(e,t){super(e),this.name="AuthUnknownError",this.originalError=t}}class Ke extends $e{constructor(e,t,o,n){super(e,o,n),this.name=t,this.status=o}}class Ye extends Ke{constructor(){super("Auth session missing!","AuthSessionMissingError",400,void 0)}}class Je extends Ke{constructor(){super("Auth session or user missing","AuthInvalidTokenResponseError",500,void 0)}}class Xe extends Ke{constructor(e){super(e,"AuthInvalidCredentialsError",400,void 0)}}class Qe extends Ke{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;super(e,"AuthImplicitGrantRedirectError",500,void 0),this.details=null,this.details=t}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}class Ze extends Ke{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;super(e,"AuthPKCEGrantCodeExchangeError",500,void 0),this.details=null,this.details=t}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}class et extends Ke{constructor(e,t){super(e,"AuthRetryableFetchError",t,void 0)}}function tt(e){return Ue(e)&&"AuthRetryableFetchError"===e.name}class ot extends Ke{constructor(e,t,o){super(e,"AuthWeakPasswordError",t,"weak_password"),this.reasons=o}}var nt=function(e,t){var o={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(o[n]=e[n]);if(null!=e&&"function"===typeof Object.getOwnPropertySymbols){var r=0;for(n=Object.getOwnPropertySymbols(e);r<n.length;r++)t.indexOf(n[r])<0&&Object.prototype.propertyIsEnumerable.call(e,n[r])&&(o[n[r]]=e[n[r]])}return o};const rt=e=>e.msg||e.message||e.error_description||e.error||JSON.stringify(e),it=[502,503,504];async function at(e){var t,o;if(!("object"===typeof(o=e)&&null!==o&&"status"in o&&"ok"in o&&"json"in o&&"function"===typeof o.json))throw new et(rt(e),0);if(it.includes(e.status))throw new et(rt(e),e.status);let n,r;try{n=await e.json()}catch(a){throw new qe(rt(a),a)}const i=function(e){const t=e.headers.get(Re);if(!t)return null;if(!t.match(Ve))return null;try{return new Date(`${t}T00:00:00.0Z`)}catch(a){return null}}(e);if(i&&i.getTime()>=Oe.timestamp&&"object"===typeof n&&n&&"string"===typeof n.code?r=n.code:"object"===typeof n&&n&&"string"===typeof n.error_code&&(r=n.error_code),r){if("weak_password"===r)throw new ot(rt(n),e.status,(null===(t=n.weak_password)||void 0===t?void 0:t.reasons)||[]);if("session_not_found"===r)throw new Ye}else if("object"===typeof n&&n&&"object"===typeof n.weak_password&&n.weak_password&&Array.isArray(n.weak_password.reasons)&&n.weak_password.reasons.length&&n.weak_password.reasons.reduce(((e,t)=>e&&"string"===typeof t),!0))throw new ot(rt(n),e.status,n.weak_password.reasons);throw new We(rt(n),e.status||500,r)}async function st(e,t,o,n){var r;const i=Object.assign({},null===n||void 0===n?void 0:n.headers);i[Re]||(i[Re]=Oe.name),(null===n||void 0===n?void 0:n.jwt)&&(i.Authorization=`Bearer ${n.jwt}`);const a=null!==(r=null===n||void 0===n?void 0:n.query)&&void 0!==r?r:{};(null===n||void 0===n?void 0:n.redirectTo)&&(a.redirect_to=n.redirectTo);const s=Object.keys(a).length?"?"+new URLSearchParams(a).toString():"",l=await async function(e,t,o,n,r,i){const a=((e,t,o,n)=>{const r={method:e,headers:(null===t||void 0===t?void 0:t.headers)||{}};return"GET"===e?r:(r.headers=Object.assign({"Content-Type":"application/json;charset=UTF-8"},null===t||void 0===t?void 0:t.headers),r.body=JSON.stringify(n),Object.assign(Object.assign({},r),o))})(t,n,r,i);let s;try{s=await e(o,Object.assign({},a))}catch(l){throw console.error(l),new et(rt(l),0)}s.ok||await at(s);if(null===n||void 0===n?void 0:n.noResolveJson)return s;try{return await s.json()}catch(l){await at(l)}}(e,t,o+s,{headers:i,noResolveJson:null===n||void 0===n?void 0:n.noResolveJson},{},null===n||void 0===n?void 0:n.body);return(null===n||void 0===n?void 0:n.xform)?null===n||void 0===n?void 0:n.xform(l):{data:Object.assign({},l),error:null}}function lt(e){var t;let o=null;var n;(function(e){return e.access_token&&e.refresh_token&&e.expires_in})(e)&&(o=Object.assign({},e),e.expires_at||(o.expires_at=(n=e.expires_in,Math.round(Date.now()/1e3)+n)));return{data:{session:o,user:null!==(t=e.user)&&void 0!==t?t:e},error:null}}function ct(e){const t=lt(e);return!t.error&&e.weak_password&&"object"===typeof e.weak_password&&Array.isArray(e.weak_password.reasons)&&e.weak_password.reasons.length&&e.weak_password.message&&"string"===typeof e.weak_password.message&&e.weak_password.reasons.reduce(((e,t)=>e&&"string"===typeof t),!0)&&(t.data.weak_password=e.weak_password),t}function dt(e){var t;return{data:{user:null!==(t=e.user)&&void 0!==t?t:e},error:null}}function ut(e){return{data:e,error:null}}function pt(e){const{action_link:t,email_otp:o,hashed_token:n,redirect_to:r,verification_type:i}=e,a=nt(e,["action_link","email_otp","hashed_token","redirect_to","verification_type"]);return{data:{properties:{action_link:t,email_otp:o,hashed_token:n,redirect_to:r,verification_type:i},user:Object.assign({},a)},error:null}}function ht(e){return e}var ft=function(e,t){var o={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(o[n]=e[n]);if(null!=e&&"function"===typeof Object.getOwnPropertySymbols){var r=0;for(n=Object.getOwnPropertySymbols(e);r<n.length;r++)t.indexOf(n[r])<0&&Object.prototype.propertyIsEnumerable.call(e,n[r])&&(o[n[r]]=e[n[r]])}return o};class gt{constructor(e){let{url:t="",headers:o={},fetch:n}=e;this.url=t,this.headers=o,this.fetch=Ne(n),this.mfa={listFactors:this._listFactors.bind(this),deleteFactor:this._deleteFactor.bind(this)}}async signOut(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"global";try{return await st(this.fetch,"POST",`${this.url}/logout?scope=${t}`,{headers:this.headers,jwt:e,noResolveJson:!0}),{data:null,error:null}}catch(o){if(Ue(o))return{data:null,error:o};throw o}}async inviteUserByEmail(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};try{return await st(this.fetch,"POST",`${this.url}/invite`,{body:{email:e,data:t.data},headers:this.headers,redirectTo:t.redirectTo,xform:dt})}catch(o){if(Ue(o))return{data:{user:null},error:o};throw o}}async generateLink(e){try{const{options:t}=e,o=ft(e,["options"]),n=Object.assign(Object.assign({},o),t);return"newEmail"in o&&(n.new_email=null===o||void 0===o?void 0:o.newEmail,delete n.newEmail),await st(this.fetch,"POST",`${this.url}/admin/generate_link`,{body:n,headers:this.headers,xform:pt,redirectTo:null===t||void 0===t?void 0:t.redirectTo})}catch(t){if(Ue(t))return{data:{properties:null,user:null},error:t};throw t}}async createUser(e){try{return await st(this.fetch,"POST",`${this.url}/admin/users`,{body:e,headers:this.headers,xform:dt})}catch(t){if(Ue(t))return{data:{user:null},error:t};throw t}}async listUsers(e){var t,o,n,r,i,a,s;try{const l={nextPage:null,lastPage:0,total:0},c=await st(this.fetch,"GET",`${this.url}/admin/users`,{headers:this.headers,noResolveJson:!0,query:{page:null!==(o=null===(t=null===e||void 0===e?void 0:e.page)||void 0===t?void 0:t.toString())&&void 0!==o?o:"",per_page:null!==(r=null===(n=null===e||void 0===e?void 0:e.perPage)||void 0===n?void 0:n.toString())&&void 0!==r?r:""},xform:ht});if(c.error)throw c.error;const d=await c.json(),u=null!==(i=c.headers.get("x-total-count"))&&void 0!==i?i:0,p=null!==(s=null===(a=c.headers.get("link"))||void 0===a?void 0:a.split(","))&&void 0!==s?s:[];return p.length>0&&(p.forEach((e=>{const t=parseInt(e.split(";")[0].split("=")[1].substring(0,1)),o=JSON.parse(e.split(";")[1].split("=")[1]);l[`${o}Page`]=t})),l.total=parseInt(u)),{data:Object.assign(Object.assign({},d),l),error:null}}catch(l){if(Ue(l))return{data:{users:[]},error:l};throw l}}async getUserById(e){try{return await st(this.fetch,"GET",`${this.url}/admin/users/${e}`,{headers:this.headers,xform:dt})}catch(t){if(Ue(t))return{data:{user:null},error:t};throw t}}async updateUserById(e,t){try{return await st(this.fetch,"PUT",`${this.url}/admin/users/${e}`,{body:t,headers:this.headers,xform:dt})}catch(o){if(Ue(o))return{data:{user:null},error:o};throw o}}async deleteUser(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];try{return await st(this.fetch,"DELETE",`${this.url}/admin/users/${e}`,{headers:this.headers,body:{should_soft_delete:t},xform:dt})}catch(o){if(Ue(o))return{data:{user:null},error:o};throw o}}async _listFactors(e){try{const{data:t,error:o}=await st(this.fetch,"GET",`${this.url}/admin/users/${e.userId}/factors`,{headers:this.headers,xform:e=>({data:{factors:e},error:null})});return{data:t,error:o}}catch(t){if(Ue(t))return{data:null,error:t};throw t}}async _deleteFactor(e){try{return{data:await st(this.fetch,"DELETE",`${this.url}/admin/users/${e.userId}/factors/${e.id}`,{headers:this.headers}),error:null}}catch(t){if(Ue(t))return{data:null,error:t};throw t}}}const mt={getItem:e=>Pe()?globalThis.localStorage.getItem(e):null,setItem:(e,t)=>{Pe()&&globalThis.localStorage.setItem(e,t)},removeItem:e=>{Pe()&&globalThis.localStorage.removeItem(e)}};function yt(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return{getItem:t=>e[t]||null,setItem:(t,o)=>{e[t]=o},removeItem:t=>{delete e[t]}}}const vt=!!(globalThis&&Pe()&&globalThis.localStorage&&"true"===globalThis.localStorage.getItem("supabase.gotrue-js.locks.debug"));class bt extends Error{constructor(e){super(e),this.isAcquireTimeout=!0}}class xt extends bt{}async function wt(e,t,o){vt&&console.log("@supabase/gotrue-js: navigatorLock: acquire lock",e,t);const n=new globalThis.AbortController;return t>0&&setTimeout((()=>{n.abort(),vt&&console.log("@supabase/gotrue-js: navigatorLock acquire timed out",e)}),t),await Promise.resolve().then((()=>globalThis.navigator.locks.request(e,0===t?{mode:"exclusive",ifAvailable:!0}:{mode:"exclusive",signal:n.signal},(async n=>{if(!n){if(0===t)throw vt&&console.log("@supabase/gotrue-js: navigatorLock: not immediately available",e),new xt(`Acquiring an exclusive Navigator LockManager lock "${e}" immediately failed`);if(vt)try{const e=await globalThis.navigator.locks.query();console.log("@supabase/gotrue-js: Navigator LockManager state",JSON.stringify(e,null,"  "))}catch(r){console.warn("@supabase/gotrue-js: Error when querying Navigator LockManager state",r)}return console.warn("@supabase/gotrue-js: Navigator LockManager returned a null lock when using #request without ifAvailable set to true, it appears this browser is not following the LockManager spec https://developer.mozilla.org/en-US/docs/Web/API/LockManager/request"),await o()}vt&&console.log("@supabase/gotrue-js: navigatorLock: acquired",e,n.name);try{return await o()}finally{vt&&console.log("@supabase/gotrue-js: navigatorLock: released",e,n.name)}}))))}!function(){if("object"!==typeof globalThis)try{Object.defineProperty(Object.prototype,"__magic__",{get:function(){return this},configurable:!0}),__magic__.globalThis=__magic__,delete Object.prototype.__magic__}catch(e){"undefined"!==typeof self&&(self.globalThis=self)}}();const Ct={url:"http://localhost:9999",storageKey:"supabase.auth.token",autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,headers:Ae,flowType:"implicit",debug:!1,hasCustomAuthorizationHeader:!1};async function _t(e,t,o){return await o()}class St{constructor(e){var t,o;this.memoryStorage=null,this.stateChangeEmitters=new Map,this.autoRefreshTicker=null,this.visibilityChangedCallback=null,this.refreshingDeferred=null,this.initializePromise=null,this.detectSessionInUrl=!0,this.hasCustomAuthorizationHeader=!1,this.suppressGetSessionWarning=!1,this.lockAcquired=!1,this.pendingInLock=[],this.broadcastChannel=null,this.logger=console.log,this.instanceID=St.nextInstanceID,St.nextInstanceID+=1,this.instanceID>0&&Te()&&console.warn("Multiple GoTrueClient instances detected in the same browser context. It is not an error, but this should be avoided as it may produce undefined behavior when used concurrently under the same storage key.");const n=Object.assign(Object.assign({},Ct),e);if(this.logDebugMessages=!!n.debug,"function"===typeof n.debug&&(this.logger=n.debug),this.persistSession=n.persistSession,this.storageKey=n.storageKey,this.autoRefreshToken=n.autoRefreshToken,this.admin=new gt({url:n.url,headers:n.headers,fetch:n.fetch}),this.url=n.url,this.headers=n.headers,this.fetch=Ne(n.fetch),this.lock=n.lock||_t,this.detectSessionInUrl=n.detectSessionInUrl,this.flowType=n.flowType,this.hasCustomAuthorizationHeader=n.hasCustomAuthorizationHeader,n.lock?this.lock=n.lock:Te()&&(null===(t=null===globalThis||void 0===globalThis?void 0:globalThis.navigator)||void 0===t?void 0:t.locks)?this.lock=wt:this.lock=_t,this.mfa={verify:this._verify.bind(this),enroll:this._enroll.bind(this),unenroll:this._unenroll.bind(this),challenge:this._challenge.bind(this),listFactors:this._listFactors.bind(this),challengeAndVerify:this._challengeAndVerify.bind(this),getAuthenticatorAssuranceLevel:this._getAuthenticatorAssuranceLevel.bind(this)},this.persistSession?n.storage?this.storage=n.storage:Pe()?this.storage=mt:(this.memoryStorage={},this.storage=yt(this.memoryStorage)):(this.memoryStorage={},this.storage=yt(this.memoryStorage)),Te()&&globalThis.BroadcastChannel&&this.persistSession&&this.storageKey){try{this.broadcastChannel=new globalThis.BroadcastChannel(this.storageKey)}catch(r){console.error("Failed to create a new BroadcastChannel, multi-tab state changes will not be available",r)}null===(o=this.broadcastChannel)||void 0===o||o.addEventListener("message",(async e=>{this._debug("received broadcast notification from other tab or client",e),await this._notifyAllSubscribers(e.data.event,e.data.session,!1)}))}this.initialize()}_debug(){if(this.logDebugMessages){for(var e=arguments.length,t=new Array(e),o=0;o<e;o++)t[o]=arguments[o];this.logger(`GoTrueClient@${this.instanceID} (${Ee}) ${(new Date).toISOString()}`,...t)}return this}async initialize(){return this.initializePromise||(this.initializePromise=(async()=>await this._acquireLock(-1,(async()=>await this._initialize())))()),await this.initializePromise}async _initialize(){var e;try{const t=function(e){const t={},o=new URL(e);if(o.hash&&"#"===o.hash[0])try{new URLSearchParams(o.hash.substring(1)).forEach(((e,o)=>{t[o]=e}))}catch(n){}return o.searchParams.forEach(((e,o)=>{t[o]=e})),t}(window.location.href);let o="none";if(this._isImplicitGrantCallback(t)?o="implicit":await this._isPKCECallback(t)&&(o="pkce"),Te()&&this.detectSessionInUrl&&"none"!==o){const{data:n,error:r}=await this._getSessionFromURL(t,o);if(r){if(this._debug("#_initialize()","error detecting session from URL",r),function(e){return Ue(e)&&"AuthImplicitGrantRedirectError"===e.name}(r)){const t=null===(e=r.details)||void 0===e?void 0:e.code;if("identity_already_exists"===t||"identity_not_found"===t||"single_identity_not_deletable"===t)return{error:r}}return await this._removeSession(),{error:r}}const{session:i,redirectType:a}=n;return this._debug("#_initialize()","detected session in URL",i,"redirect type",a),await this._saveSession(i),setTimeout((async()=>{"recovery"===a?await this._notifyAllSubscribers("PASSWORD_RECOVERY",i):await this._notifyAllSubscribers("SIGNED_IN",i)}),0),{error:null}}return await this._recoverAndRefresh(),{error:null}}catch(t){return Ue(t)?{error:t}:{error:new qe("Unexpected error during initialization",t)}}finally{await this._handleVisibilityChange(),this._debug("#_initialize()","end")}}async signInAnonymously(e){var t,o,n;try{const r=await st(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{data:null!==(o=null===(t=null===e||void 0===e?void 0:e.options)||void 0===t?void 0:t.data)&&void 0!==o?o:{},gotrue_meta_security:{captcha_token:null===(n=null===e||void 0===e?void 0:e.options)||void 0===n?void 0:n.captchaToken}},xform:lt}),{data:i,error:a}=r;if(a||!i)return{data:{user:null,session:null},error:a};const s=i.session,l=i.user;return i.session&&(await this._saveSession(i.session),await this._notifyAllSubscribers("SIGNED_IN",s)),{data:{user:l,session:s},error:null}}catch(r){if(Ue(r))return{data:{user:null,session:null},error:r};throw r}}async signUp(e){var t,o,n;try{let r;if("email"in e){const{email:o,password:n,options:i}=e;let a=null,s=null;"pkce"===this.flowType&&([a,s]=await Be(this.storage,this.storageKey)),r=await st(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,redirectTo:null===i||void 0===i?void 0:i.emailRedirectTo,body:{email:o,password:n,data:null!==(t=null===i||void 0===i?void 0:i.data)&&void 0!==t?t:{},gotrue_meta_security:{captcha_token:null===i||void 0===i?void 0:i.captchaToken},code_challenge:a,code_challenge_method:s},xform:lt})}else{if(!("phone"in e))throw new Xe("You must provide either an email or phone number and a password");{const{phone:t,password:i,options:a}=e;r=await st(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{phone:t,password:i,data:null!==(o=null===a||void 0===a?void 0:a.data)&&void 0!==o?o:{},channel:null!==(n=null===a||void 0===a?void 0:a.channel)&&void 0!==n?n:"sms",gotrue_meta_security:{captcha_token:null===a||void 0===a?void 0:a.captchaToken}},xform:lt})}}const{data:i,error:a}=r;if(a||!i)return{data:{user:null,session:null},error:a};const s=i.session,l=i.user;return i.session&&(await this._saveSession(i.session),await this._notifyAllSubscribers("SIGNED_IN",s)),{data:{user:l,session:s},error:null}}catch(r){if(Ue(r))return{data:{user:null,session:null},error:r};throw r}}async signInWithPassword(e){try{let t;if("email"in e){const{email:o,password:n,options:r}=e;t=await st(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{email:o,password:n,gotrue_meta_security:{captcha_token:null===r||void 0===r?void 0:r.captchaToken}},xform:ct})}else{if(!("phone"in e))throw new Xe("You must provide either an email or phone number and a password");{const{phone:o,password:n,options:r}=e;t=await st(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{phone:o,password:n,gotrue_meta_security:{captcha_token:null===r||void 0===r?void 0:r.captchaToken}},xform:ct})}}const{data:o,error:n}=t;return n?{data:{user:null,session:null},error:n}:o&&o.session&&o.user?(o.session&&(await this._saveSession(o.session),await this._notifyAllSubscribers("SIGNED_IN",o.session)),{data:Object.assign({user:o.user,session:o.session},o.weak_password?{weakPassword:o.weak_password}:null),error:n}):{data:{user:null,session:null},error:new Je}}catch(t){if(Ue(t))return{data:{user:null,session:null},error:t};throw t}}async signInWithOAuth(e){var t,o,n,r;return await this._handleProviderSignIn(e.provider,{redirectTo:null===(t=e.options)||void 0===t?void 0:t.redirectTo,scopes:null===(o=e.options)||void 0===o?void 0:o.scopes,queryParams:null===(n=e.options)||void 0===n?void 0:n.queryParams,skipBrowserRedirect:null===(r=e.options)||void 0===r?void 0:r.skipBrowserRedirect})}async exchangeCodeForSession(e){return await this.initializePromise,this._acquireLock(-1,(async()=>this._exchangeCodeForSession(e)))}async _exchangeCodeForSession(e){const t=await Me(this.storage,`${this.storageKey}-code-verifier`),[o,n]=(null!==t&&void 0!==t?t:"").split("/");try{const{data:t,error:r}=await st(this.fetch,"POST",`${this.url}/token?grant_type=pkce`,{headers:this.headers,body:{auth_code:e,code_verifier:o},xform:lt});if(await Le(this.storage,`${this.storageKey}-code-verifier`),r)throw r;return t&&t.session&&t.user?(t.session&&(await this._saveSession(t.session),await this._notifyAllSubscribers("SIGNED_IN",t.session)),{data:Object.assign(Object.assign({},t),{redirectType:null!==n&&void 0!==n?n:null}),error:r}):{data:{user:null,session:null,redirectType:null},error:new Je}}catch(r){if(Ue(r))return{data:{user:null,session:null,redirectType:null},error:r};throw r}}async signInWithIdToken(e){try{const{options:t,provider:o,token:n,access_token:r,nonce:i}=e,a=await st(this.fetch,"POST",`${this.url}/token?grant_type=id_token`,{headers:this.headers,body:{provider:o,id_token:n,access_token:r,nonce:i,gotrue_meta_security:{captcha_token:null===t||void 0===t?void 0:t.captchaToken}},xform:lt}),{data:s,error:l}=a;return l?{data:{user:null,session:null},error:l}:s&&s.session&&s.user?(s.session&&(await this._saveSession(s.session),await this._notifyAllSubscribers("SIGNED_IN",s.session)),{data:s,error:l}):{data:{user:null,session:null},error:new Je}}catch(t){if(Ue(t))return{data:{user:null,session:null},error:t};throw t}}async signInWithOtp(e){var t,o,n,r,i;try{if("email"in e){const{email:n,options:r}=e;let i=null,a=null;"pkce"===this.flowType&&([i,a]=await Be(this.storage,this.storageKey));const{error:s}=await st(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{email:n,data:null!==(t=null===r||void 0===r?void 0:r.data)&&void 0!==t?t:{},create_user:null===(o=null===r||void 0===r?void 0:r.shouldCreateUser)||void 0===o||o,gotrue_meta_security:{captcha_token:null===r||void 0===r?void 0:r.captchaToken},code_challenge:i,code_challenge_method:a},redirectTo:null===r||void 0===r?void 0:r.emailRedirectTo});return{data:{user:null,session:null},error:s}}if("phone"in e){const{phone:t,options:o}=e,{data:a,error:s}=await st(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{phone:t,data:null!==(n=null===o||void 0===o?void 0:o.data)&&void 0!==n?n:{},create_user:null===(r=null===o||void 0===o?void 0:o.shouldCreateUser)||void 0===r||r,gotrue_meta_security:{captcha_token:null===o||void 0===o?void 0:o.captchaToken},channel:null!==(i=null===o||void 0===o?void 0:o.channel)&&void 0!==i?i:"sms"}});return{data:{user:null,session:null,messageId:null===a||void 0===a?void 0:a.message_id},error:s}}throw new Xe("You must provide either an email or phone number.")}catch(a){if(Ue(a))return{data:{user:null,session:null},error:a};throw a}}async verifyOtp(e){var t,o;try{let n,r;"options"in e&&(n=null===(t=e.options)||void 0===t?void 0:t.redirectTo,r=null===(o=e.options)||void 0===o?void 0:o.captchaToken);const{data:i,error:a}=await st(this.fetch,"POST",`${this.url}/verify`,{headers:this.headers,body:Object.assign(Object.assign({},e),{gotrue_meta_security:{captcha_token:r}}),redirectTo:n,xform:lt});if(a)throw a;if(!i)throw new Error("An error occurred on token verification.");const s=i.session,l=i.user;return(null===s||void 0===s?void 0:s.access_token)&&(await this._saveSession(s),await this._notifyAllSubscribers("recovery"==e.type?"PASSWORD_RECOVERY":"SIGNED_IN",s)),{data:{user:l,session:s},error:null}}catch(n){if(Ue(n))return{data:{user:null,session:null},error:n};throw n}}async signInWithSSO(e){var t,o,n;try{let r=null,i=null;return"pkce"===this.flowType&&([r,i]=await Be(this.storage,this.storageKey)),await st(this.fetch,"POST",`${this.url}/sso`,{body:Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},"providerId"in e?{provider_id:e.providerId}:null),"domain"in e?{domain:e.domain}:null),{redirect_to:null!==(o=null===(t=e.options)||void 0===t?void 0:t.redirectTo)&&void 0!==o?o:void 0}),(null===(n=null===e||void 0===e?void 0:e.options)||void 0===n?void 0:n.captchaToken)?{gotrue_meta_security:{captcha_token:e.options.captchaToken}}:null),{skip_http_redirect:!0,code_challenge:r,code_challenge_method:i}),headers:this.headers,xform:ut})}catch(r){if(Ue(r))return{data:null,error:r};throw r}}async reauthenticate(){return await this.initializePromise,await this._acquireLock(-1,(async()=>await this._reauthenticate()))}async _reauthenticate(){try{return await this._useSession((async e=>{const{data:{session:t},error:o}=e;if(o)throw o;if(!t)throw new Ye;const{error:n}=await st(this.fetch,"GET",`${this.url}/reauthenticate`,{headers:this.headers,jwt:t.access_token});return{data:{user:null,session:null},error:n}}))}catch(e){if(Ue(e))return{data:{user:null,session:null},error:e};throw e}}async resend(e){try{const t=`${this.url}/resend`;if("email"in e){const{email:o,type:n,options:r}=e,{error:i}=await st(this.fetch,"POST",t,{headers:this.headers,body:{email:o,type:n,gotrue_meta_security:{captcha_token:null===r||void 0===r?void 0:r.captchaToken}},redirectTo:null===r||void 0===r?void 0:r.emailRedirectTo});return{data:{user:null,session:null},error:i}}if("phone"in e){const{phone:o,type:n,options:r}=e,{data:i,error:a}=await st(this.fetch,"POST",t,{headers:this.headers,body:{phone:o,type:n,gotrue_meta_security:{captcha_token:null===r||void 0===r?void 0:r.captchaToken}}});return{data:{user:null,session:null,messageId:null===i||void 0===i?void 0:i.message_id},error:a}}throw new Xe("You must provide either an email or phone number and a type")}catch(t){if(Ue(t))return{data:{user:null,session:null},error:t};throw t}}async getSession(){await this.initializePromise;return await this._acquireLock(-1,(async()=>this._useSession((async e=>e))))}async _acquireLock(e,t){this._debug("#_acquireLock","begin",e);try{if(this.lockAcquired){const e=this.pendingInLock.length?this.pendingInLock[this.pendingInLock.length-1]:Promise.resolve(),o=(async()=>(await e,await t()))();return this.pendingInLock.push((async()=>{try{await o}catch(e){}})()),o}return await this.lock(`lock:${this.storageKey}`,e,(async()=>{this._debug("#_acquireLock","lock acquired for storage key",this.storageKey);try{this.lockAcquired=!0;const e=t();for(this.pendingInLock.push((async()=>{try{await e}catch(t){}})()),await e;this.pendingInLock.length;){const e=[...this.pendingInLock];await Promise.all(e),this.pendingInLock.splice(0,e.length)}return await e}finally{this._debug("#_acquireLock","lock released for storage key",this.storageKey),this.lockAcquired=!1}}))}finally{this._debug("#_acquireLock","end")}}async _useSession(e){this._debug("#_useSession","begin");try{const t=await this.__loadSession();return await e(t)}finally{this._debug("#_useSession","end")}}async __loadSession(){this._debug("#__loadSession()","begin"),this.lockAcquired||this._debug("#__loadSession()","used outside of an acquired lock!",(new Error).stack);try{let e=null;const t=await Me(this.storage,this.storageKey);if(this._debug("#getSession()","session from storage",t),null!==t&&(this._isValidSession(t)?e=t:(this._debug("#getSession()","session from storage is not valid"),await this._removeSession())),!e)return{data:{session:null},error:null};const o=!!e.expires_at&&1e3*e.expires_at-Date.now()<je;if(this._debug("#__loadSession()",`session has${o?"":" not"} expired`,"expires_at",e.expires_at),!o){if(this.storage.isServer){let t=this.suppressGetSessionWarning;e=new Proxy(e,{get:(e,o,n)=>(t||"user"!==o||(console.warn("Using the user object as returned from supabase.auth.getSession() or from some supabase.auth.onAuthStateChange() events could be insecure! This value comes directly from the storage medium (usually cookies on the server) and may not be authentic. Use supabase.auth.getUser() instead which authenticates the data by contacting the Supabase Auth server."),t=!0,this.suppressGetSessionWarning=!0),Reflect.get(e,o,n))})}return{data:{session:e},error:null}}const{session:n,error:r}=await this._callRefreshToken(e.refresh_token);return r?{data:{session:null},error:r}:{data:{session:n},error:null}}finally{this._debug("#__loadSession()","end")}}async getUser(e){if(e)return await this._getUser(e);await this.initializePromise;return await this._acquireLock(-1,(async()=>await this._getUser()))}async _getUser(e){try{return e?await st(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:e,xform:dt}):await this._useSession((async e=>{var t,o,n;const{data:r,error:i}=e;if(i)throw i;return(null===(t=r.session)||void 0===t?void 0:t.access_token)||this.hasCustomAuthorizationHeader?await st(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:null!==(n=null===(o=r.session)||void 0===o?void 0:o.access_token)&&void 0!==n?n:void 0,xform:dt}):{data:{user:null},error:new Ye}}))}catch(t){if(Ue(t))return function(e){return Ue(e)&&"AuthSessionMissingError"===e.name}(t)&&(await this._removeSession(),await Le(this.storage,`${this.storageKey}-code-verifier`)),{data:{user:null},error:t};throw t}}async updateUser(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return await this.initializePromise,await this._acquireLock(-1,(async()=>await this._updateUser(e,t)))}async _updateUser(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};try{return await this._useSession((async o=>{const{data:n,error:r}=o;if(r)throw r;if(!n.session)throw new Ye;const i=n.session;let a=null,s=null;"pkce"===this.flowType&&null!=e.email&&([a,s]=await Be(this.storage,this.storageKey));const{data:l,error:c}=await st(this.fetch,"PUT",`${this.url}/user`,{headers:this.headers,redirectTo:null===t||void 0===t?void 0:t.emailRedirectTo,body:Object.assign(Object.assign({},e),{code_challenge:a,code_challenge_method:s}),jwt:i.access_token,xform:dt});if(c)throw c;return i.user=l.user,await this._saveSession(i),await this._notifyAllSubscribers("USER_UPDATED",i),{data:{user:i.user},error:null}}))}catch(o){if(Ue(o))return{data:{user:null},error:o};throw o}}_decodeJWT(e){return Ge(e)}async setSession(e){return await this.initializePromise,await this._acquireLock(-1,(async()=>await this._setSession(e)))}async _setSession(e){try{if(!e.access_token||!e.refresh_token)throw new Ye;const t=Date.now()/1e3;let o=t,n=!0,r=null;const i=Ge(e.access_token);if(i.exp&&(o=i.exp,n=o<=t),n){const{session:t,error:o}=await this._callRefreshToken(e.refresh_token);if(o)return{data:{user:null,session:null},error:o};if(!t)return{data:{user:null,session:null},error:null};r=t}else{const{data:n,error:i}=await this._getUser(e.access_token);if(i)throw i;r={access_token:e.access_token,refresh_token:e.refresh_token,user:n.user,token_type:"bearer",expires_in:o-t,expires_at:o},await this._saveSession(r),await this._notifyAllSubscribers("SIGNED_IN",r)}return{data:{user:r.user,session:r},error:null}}catch(t){if(Ue(t))return{data:{session:null,user:null},error:t};throw t}}async refreshSession(e){return await this.initializePromise,await this._acquireLock(-1,(async()=>await this._refreshSession(e)))}async _refreshSession(e){try{return await this._useSession((async t=>{var o;if(!e){const{data:n,error:r}=t;if(r)throw r;e=null!==(o=n.session)&&void 0!==o?o:void 0}if(!(null===e||void 0===e?void 0:e.refresh_token))throw new Ye;const{session:n,error:r}=await this._callRefreshToken(e.refresh_token);return r?{data:{user:null,session:null},error:r}:n?{data:{user:n.user,session:n},error:null}:{data:{user:null,session:null},error:null}}))}catch(t){if(Ue(t))return{data:{user:null,session:null},error:t};throw t}}async _getSessionFromURL(e,t){try{if(!Te())throw new Qe("No browser detected.");if(e.error||e.error_description||e.error_code)throw new Qe(e.error_description||"Error in URL with unspecified error_description",{error:e.error||"unspecified_error",code:e.error_code||"unspecified_code"});switch(t){case"implicit":if("pkce"===this.flowType)throw new Ze("Not a valid PKCE flow url.");break;case"pkce":if("implicit"===this.flowType)throw new Qe("Not a valid implicit grant flow url.")}if("pkce"===t){if(this._debug("#_initialize()","begin","is PKCE flow",!0),!e.code)throw new Ze("No code detected.");const{data:t,error:o}=await this._exchangeCodeForSession(e.code);if(o)throw o;const n=new URL(window.location.href);return n.searchParams.delete("code"),window.history.replaceState(window.history.state,"",n.toString()),{data:{session:t.session,redirectType:null},error:null}}const{provider_token:o,provider_refresh_token:n,access_token:r,refresh_token:i,expires_in:a,expires_at:s,token_type:l}=e;if(!r||!a||!i||!l)throw new Qe("No session defined in URL");const c=Math.round(Date.now()/1e3),d=parseInt(a);let u=c+d;s&&(u=parseInt(s));const p=u-c;1e3*p<=ke&&console.warn(`@supabase/gotrue-js: Session as retrieved from URL expires in ${p}s, should have been closer to ${d}s`);const h=u-d;c-h>=120?console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued over 120s ago, URL could be stale",h,u,c):c-h<0&&console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued in the future? Check the device clock for skew",h,u,c);const{data:f,error:g}=await this._getUser(r);if(g)throw g;const m={provider_token:o,provider_refresh_token:n,access_token:r,expires_in:d,expires_at:u,refresh_token:i,token_type:l,user:f.user};return window.location.hash="",this._debug("#_getSessionFromURL()","clearing window.location.hash"),{data:{session:m,redirectType:e.type},error:null}}catch(o){if(Ue(o))return{data:{session:null,redirectType:null},error:o};throw o}}_isImplicitGrantCallback(e){return Boolean(e.access_token||e.error_description)}async _isPKCECallback(e){const t=await Me(this.storage,`${this.storageKey}-code-verifier`);return!(!e.code||!t)}async signOut(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{scope:"global"};return await this.initializePromise,await this._acquireLock(-1,(async()=>await this._signOut(e)))}async _signOut(){let{scope:e}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{scope:"global"};return await this._useSession((async t=>{var o;const{data:n,error:r}=t;if(r)return{error:r};const i=null===(o=n.session)||void 0===o?void 0:o.access_token;if(i){const{error:t}=await this.admin.signOut(i,e);if(t&&(!function(e){return Ue(e)&&"AuthApiError"===e.name}(t)||404!==t.status&&401!==t.status&&403!==t.status))return{error:t}}return"others"!==e&&(await this._removeSession(),await Le(this.storage,`${this.storageKey}-code-verifier`)),{error:null}}))}onAuthStateChange(e){const t="xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,(function(e){const t=16*Math.random()|0;return("x"==e?t:3&t|8).toString(16)})),o={id:t,callback:e,unsubscribe:()=>{this._debug("#unsubscribe()","state change callback with id removed",t),this.stateChangeEmitters.delete(t)}};return this._debug("#onAuthStateChange()","registered callback with id",t),this.stateChangeEmitters.set(t,o),(async()=>{await this.initializePromise,await this._acquireLock(-1,(async()=>{this._emitInitialSession(t)}))})(),{data:{subscription:o}}}async _emitInitialSession(e){return await this._useSession((async t=>{var o,n;try{const{data:{session:n},error:r}=t;if(r)throw r;await(null===(o=this.stateChangeEmitters.get(e))||void 0===o?void 0:o.callback("INITIAL_SESSION",n)),this._debug("INITIAL_SESSION","callback id",e,"session",n)}catch(r){await(null===(n=this.stateChangeEmitters.get(e))||void 0===n?void 0:n.callback("INITIAL_SESSION",null)),this._debug("INITIAL_SESSION","callback id",e,"error",r),console.error(r)}}))}async resetPasswordForEmail(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},o=null,n=null;"pkce"===this.flowType&&([o,n]=await Be(this.storage,this.storageKey,!0));try{return await st(this.fetch,"POST",`${this.url}/recover`,{body:{email:e,code_challenge:o,code_challenge_method:n,gotrue_meta_security:{captcha_token:t.captchaToken}},headers:this.headers,redirectTo:t.redirectTo})}catch(r){if(Ue(r))return{data:null,error:r};throw r}}async getUserIdentities(){var e;try{const{data:t,error:o}=await this.getUser();if(o)throw o;return{data:{identities:null!==(e=t.user.identities)&&void 0!==e?e:[]},error:null}}catch(t){if(Ue(t))return{data:null,error:t};throw t}}async linkIdentity(e){var t;try{const{data:o,error:n}=await this._useSession((async t=>{var o,n,r,i,a;const{data:s,error:l}=t;if(l)throw l;const c=await this._getUrlForProvider(`${this.url}/user/identities/authorize`,e.provider,{redirectTo:null===(o=e.options)||void 0===o?void 0:o.redirectTo,scopes:null===(n=e.options)||void 0===n?void 0:n.scopes,queryParams:null===(r=e.options)||void 0===r?void 0:r.queryParams,skipBrowserRedirect:!0});return await st(this.fetch,"GET",c,{headers:this.headers,jwt:null!==(a=null===(i=s.session)||void 0===i?void 0:i.access_token)&&void 0!==a?a:void 0})}));if(n)throw n;return Te()&&!(null===(t=e.options)||void 0===t?void 0:t.skipBrowserRedirect)&&window.location.assign(null===o||void 0===o?void 0:o.url),{data:{provider:e.provider,url:null===o||void 0===o?void 0:o.url},error:null}}catch(o){if(Ue(o))return{data:{provider:e.provider,url:null},error:o};throw o}}async unlinkIdentity(e){try{return await this._useSession((async t=>{var o,n;const{data:r,error:i}=t;if(i)throw i;return await st(this.fetch,"DELETE",`${this.url}/user/identities/${e.identity_id}`,{headers:this.headers,jwt:null!==(n=null===(o=r.session)||void 0===o?void 0:o.access_token)&&void 0!==n?n:void 0})}))}catch(t){if(Ue(t))return{data:null,error:t};throw t}}async _refreshAccessToken(e){const t=`#_refreshAccessToken(${e.substring(0,5)}...)`;this._debug(t,"begin");try{const r=Date.now();return await(o=async o=>(o>0&&await async function(e){return await new Promise((t=>{setTimeout((()=>t(null)),e)}))}(200*Math.pow(2,o-1)),this._debug(t,"refreshing attempt",o),await st(this.fetch,"POST",`${this.url}/token?grant_type=refresh_token`,{body:{refresh_token:e},headers:this.headers,xform:lt})),n=(e,t)=>{const o=200*Math.pow(2,e);return t&&tt(t)&&Date.now()+o-r<ke},new Promise(((e,t)=>{(async()=>{for(let i=0;i<1/0;i++)try{const t=await o(i);if(!n(i,null,t))return void e(t)}catch(r){if(!n(i,r))return void t(r)}})()})))}catch(r){if(this._debug(t,"error",r),Ue(r))return{data:{session:null,user:null},error:r};throw r}finally{this._debug(t,"end")}var o,n}_isValidSession(e){return"object"===typeof e&&null!==e&&"access_token"in e&&"refresh_token"in e&&"expires_at"in e}async _handleProviderSignIn(e,t){const o=await this._getUrlForProvider(`${this.url}/authorize`,e,{redirectTo:t.redirectTo,scopes:t.scopes,queryParams:t.queryParams});return this._debug("#_handleProviderSignIn()","provider",e,"options",t,"url",o),Te()&&!t.skipBrowserRedirect&&window.location.assign(o),{data:{provider:e,url:o},error:null}}async _recoverAndRefresh(){var e;const t="#_recoverAndRefresh()";this._debug(t,"begin");try{const o=await Me(this.storage,this.storageKey);if(this._debug(t,"session from storage",o),!this._isValidSession(o))return this._debug(t,"session is not valid"),void(null!==o&&await this._removeSession());const n=1e3*(null!==(e=o.expires_at)&&void 0!==e?e:1/0)-Date.now()<je;if(this._debug(t,`session has${n?"":" not"} expired with margin of 90000s`),n){if(this.autoRefreshToken&&o.refresh_token){const{error:e}=await this._callRefreshToken(o.refresh_token);e&&(console.error(e),tt(e)||(this._debug(t,"refresh failed with a non-retryable error, removing the session",e),await this._removeSession()))}}else await this._notifyAllSubscribers("SIGNED_IN",o)}catch(o){return this._debug(t,"error",o),void console.error(o)}finally{this._debug(t,"end")}}async _callRefreshToken(e){var t,o;if(!e)throw new Ye;if(this.refreshingDeferred)return this.refreshingDeferred.promise;const n=`#_callRefreshToken(${e.substring(0,5)}...)`;this._debug(n,"begin");try{this.refreshingDeferred=new Fe;const{data:t,error:o}=await this._refreshAccessToken(e);if(o)throw o;if(!t.session)throw new Ye;await this._saveSession(t.session),await this._notifyAllSubscribers("TOKEN_REFRESHED",t.session);const n={session:t.session,error:null};return this.refreshingDeferred.resolve(n),n}catch(r){if(this._debug(n,"error",r),Ue(r)){const e={session:null,error:r};return tt(r)||await this._removeSession(),null===(t=this.refreshingDeferred)||void 0===t||t.resolve(e),e}throw null===(o=this.refreshingDeferred)||void 0===o||o.reject(r),r}finally{this.refreshingDeferred=null,this._debug(n,"end")}}async _notifyAllSubscribers(e,t){let o=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];const n=`#_notifyAllSubscribers(${e})`;this._debug(n,"begin",t,`broadcast = ${o}`);try{this.broadcastChannel&&o&&this.broadcastChannel.postMessage({event:e,session:t});const n=[],r=Array.from(this.stateChangeEmitters.values()).map((async o=>{try{await o.callback(e,t)}catch(r){n.push(r)}}));if(await Promise.all(r),n.length>0){for(let e=0;e<n.length;e+=1)console.error(n[e]);throw n[0]}}finally{this._debug(n,"end")}}async _saveSession(e){this._debug("#_saveSession()",e),this.suppressGetSessionWarning=!0,await Ie(this.storage,this.storageKey,e)}async _removeSession(){this._debug("#_removeSession()"),await Le(this.storage,this.storageKey),await this._notifyAllSubscribers("SIGNED_OUT",null)}_removeVisibilityChangedCallback(){this._debug("#_removeVisibilityChangedCallback()");const e=this.visibilityChangedCallback;this.visibilityChangedCallback=null;try{e&&Te()&&(null===window||void 0===window?void 0:window.removeEventListener)&&window.removeEventListener("visibilitychange",e)}catch(t){console.error("removing visibilitychange callback failed",t)}}async _startAutoRefresh(){await this._stopAutoRefresh(),this._debug("#_startAutoRefresh()");const e=setInterval((()=>this._autoRefreshTokenTick()),ke);this.autoRefreshTicker=e,e&&"object"===typeof e&&"function"===typeof e.unref?e.unref():"undefined"!==typeof Deno&&"function"===typeof Deno.unrefTimer&&Deno.unrefTimer(e),setTimeout((async()=>{await this.initializePromise,await this._autoRefreshTokenTick()}),0)}async _stopAutoRefresh(){this._debug("#_stopAutoRefresh()");const e=this.autoRefreshTicker;this.autoRefreshTicker=null,e&&clearInterval(e)}async startAutoRefresh(){this._removeVisibilityChangedCallback(),await this._startAutoRefresh()}async stopAutoRefresh(){this._removeVisibilityChangedCallback(),await this._stopAutoRefresh()}async _autoRefreshTokenTick(){this._debug("#_autoRefreshTokenTick()","begin");try{await this._acquireLock(0,(async()=>{try{const t=Date.now();try{return await this._useSession((async e=>{const{data:{session:o}}=e;if(!o||!o.refresh_token||!o.expires_at)return void this._debug("#_autoRefreshTokenTick()","no session");const n=Math.floor((1e3*o.expires_at-t)/ke);this._debug("#_autoRefreshTokenTick()",`access token expires in ${n} ticks, a tick lasts 30000ms, refresh threshold is 3 ticks`),n<=3&&await this._callRefreshToken(o.refresh_token)}))}catch(e){console.error("Auto refresh tick failed with error. This is likely a transient error.",e)}}finally{this._debug("#_autoRefreshTokenTick()","end")}}))}catch(e){if(!(e.isAcquireTimeout||e instanceof bt))throw e;this._debug("auto refresh token tick lock not available")}}async _handleVisibilityChange(){if(this._debug("#_handleVisibilityChange()"),!Te()||!(null===window||void 0===window?void 0:window.addEventListener))return this.autoRefreshToken&&this.startAutoRefresh(),!1;try{this.visibilityChangedCallback=async()=>await this._onVisibilityChanged(!1),null===window||void 0===window||window.addEventListener("visibilitychange",this.visibilityChangedCallback),await this._onVisibilityChanged(!0)}catch(e){console.error("_handleVisibilityChange",e)}}async _onVisibilityChanged(e){const t=`#_onVisibilityChanged(${e})`;this._debug(t,"visibilityState",document.visibilityState),"visible"===document.visibilityState?(this.autoRefreshToken&&this._startAutoRefresh(),e||(await this.initializePromise,await this._acquireLock(-1,(async()=>{"visible"===document.visibilityState?await this._recoverAndRefresh():this._debug(t,"acquired the lock to recover the session, but the browser visibilityState is no longer visible, aborting")})))):"hidden"===document.visibilityState&&this.autoRefreshToken&&this._stopAutoRefresh()}async _getUrlForProvider(e,t,o){const n=[`provider=${encodeURIComponent(t)}`];if((null===o||void 0===o?void 0:o.redirectTo)&&n.push(`redirect_to=${encodeURIComponent(o.redirectTo)}`),(null===o||void 0===o?void 0:o.scopes)&&n.push(`scopes=${encodeURIComponent(o.scopes)}`),"pkce"===this.flowType){const[e,t]=await Be(this.storage,this.storageKey),o=new URLSearchParams({code_challenge:`${encodeURIComponent(e)}`,code_challenge_method:`${encodeURIComponent(t)}`});n.push(o.toString())}if(null===o||void 0===o?void 0:o.queryParams){const e=new URLSearchParams(o.queryParams);n.push(e.toString())}return(null===o||void 0===o?void 0:o.skipBrowserRedirect)&&n.push(`skip_http_redirect=${o.skipBrowserRedirect}`),`${e}?${n.join("&")}`}async _unenroll(e){try{return await this._useSession((async t=>{var o;const{data:n,error:r}=t;return r?{data:null,error:r}:await st(this.fetch,"DELETE",`${this.url}/factors/${e.factorId}`,{headers:this.headers,jwt:null===(o=null===n||void 0===n?void 0:n.session)||void 0===o?void 0:o.access_token})}))}catch(t){if(Ue(t))return{data:null,error:t};throw t}}async _enroll(e){try{return await this._useSession((async t=>{var o,n;const{data:r,error:i}=t;if(i)return{data:null,error:i};const a=Object.assign({friendly_name:e.friendlyName,factor_type:e.factorType},"phone"===e.factorType?{phone:e.phone}:{issuer:e.issuer}),{data:s,error:l}=await st(this.fetch,"POST",`${this.url}/factors`,{body:a,headers:this.headers,jwt:null===(o=null===r||void 0===r?void 0:r.session)||void 0===o?void 0:o.access_token});return l?{data:null,error:l}:("totp"===e.factorType&&(null===(n=null===s||void 0===s?void 0:s.totp)||void 0===n?void 0:n.qr_code)&&(s.totp.qr_code=`data:image/svg+xml;utf-8,${s.totp.qr_code}`),{data:s,error:null})}))}catch(t){if(Ue(t))return{data:null,error:t};throw t}}async _verify(e){return this._acquireLock(-1,(async()=>{try{return await this._useSession((async t=>{var o;const{data:n,error:r}=t;if(r)return{data:null,error:r};const{data:i,error:a}=await st(this.fetch,"POST",`${this.url}/factors/${e.factorId}/verify`,{body:{code:e.code,challenge_id:e.challengeId},headers:this.headers,jwt:null===(o=null===n||void 0===n?void 0:n.session)||void 0===o?void 0:o.access_token});return a?{data:null,error:a}:(await this._saveSession(Object.assign({expires_at:Math.round(Date.now()/1e3)+i.expires_in},i)),await this._notifyAllSubscribers("MFA_CHALLENGE_VERIFIED",i),{data:i,error:a})}))}catch(t){if(Ue(t))return{data:null,error:t};throw t}}))}async _challenge(e){return this._acquireLock(-1,(async()=>{try{return await this._useSession((async t=>{var o;const{data:n,error:r}=t;return r?{data:null,error:r}:await st(this.fetch,"POST",`${this.url}/factors/${e.factorId}/challenge`,{body:{channel:e.channel},headers:this.headers,jwt:null===(o=null===n||void 0===n?void 0:n.session)||void 0===o?void 0:o.access_token})}))}catch(t){if(Ue(t))return{data:null,error:t};throw t}}))}async _challengeAndVerify(e){const{data:t,error:o}=await this._challenge({factorId:e.factorId});return o?{data:null,error:o}:await this._verify({factorId:e.factorId,challengeId:t.id,code:e.code})}async _listFactors(){const{data:{user:e},error:t}=await this.getUser();if(t)return{data:null,error:t};const o=(null===e||void 0===e?void 0:e.factors)||[],n=o.filter((e=>"totp"===e.factor_type&&"verified"===e.status)),r=o.filter((e=>"phone"===e.factor_type&&"verified"===e.status));return{data:{all:o,totp:n,phone:r},error:null}}async _getAuthenticatorAssuranceLevel(){return this._acquireLock(-1,(async()=>await this._useSession((async e=>{var t,o;const{data:{session:n},error:r}=e;if(r)return{data:null,error:r};if(!n)return{data:{currentLevel:null,nextLevel:null,currentAuthenticationMethods:[]},error:null};const i=this._decodeJWT(n.access_token);let a=null;i.aal&&(a=i.aal);let s=a;(null!==(o=null===(t=n.user.factors)||void 0===t?void 0:t.filter((e=>"verified"===e.status)))&&void 0!==o?o:[]).length>0&&(s="aal2");return{data:{currentLevel:a,nextLevel:s,currentAuthenticationMethods:i.amr||[]},error:null}}))))}}St.nextInstanceID=0;const Et=St;class kt extends Et{constructor(e){super(e)}}var jt=function(e,t,o,n){return new(o||(o=Promise))((function(r,i){function a(e){try{l(n.next(e))}catch(t){i(t)}}function s(e){try{l(n.throw(e))}catch(t){i(t)}}function l(e){var t;e.done?r(e.value):(t=e.value,t instanceof o?t:new o((function(e){e(t)}))).then(a,s)}l((n=n.apply(e,t||[])).next())}))};class At{constructor(e,t,o){var n,r,i;if(this.supabaseUrl=e,this.supabaseKey=t,!e)throw new Error("supabaseUrl is required.");if(!t)throw new Error("supabaseKey is required.");const a=e.replace(/\/$/,"");this.realtimeUrl=`${a}/realtime/v1`.replace(/^http/i,"ws"),this.authUrl=`${a}/auth/v1`,this.storageUrl=`${a}/storage/v1`,this.functionsUrl=`${a}/functions/v1`;const s=`sb-${new URL(this.authUrl).hostname.split(".")[0]}-auth-token`,l=function(e,t){const{db:o,auth:n,realtime:r,global:i}=e,{db:a,auth:s,realtime:l,global:c}=t,d={db:Object.assign(Object.assign({},a),o),auth:Object.assign(Object.assign({},s),n),realtime:Object.assign(Object.assign({},l),r),global:Object.assign(Object.assign({},c),i),accessToken:()=>Se(this,void 0,void 0,(function*(){return""}))};return e.accessToken?d.accessToken=e.accessToken:delete d.accessToken,d}(null!==o&&void 0!==o?o:{},{db:ye,realtime:be,auth:Object.assign(Object.assign({},ve),{storageKey:s}),global:me});this.storageKey=null!==(n=l.auth.storageKey)&&void 0!==n?n:"",this.headers=null!==(r=l.global.headers)&&void 0!==r?r:{},l.accessToken?(this.accessToken=l.accessToken,this.auth=new Proxy({},{get:(e,t)=>{throw new Error(`@supabase/supabase-js: Supabase Client is configured with the accessToken option, accessing supabase.auth.${String(t)} is not possible`)}})):this.auth=this._initSupabaseAuthClient(null!==(i=l.auth)&&void 0!==i?i:{},this.headers,l.global.fetch),this.fetch=_e(t,this._getAccessToken.bind(this),l.global.fetch),this.realtime=this._initRealtimeClient(Object.assign({headers:this.headers,accessToken:this._getAccessToken.bind(this)},l.realtime)),this.rest=new u(`${a}/rest/v1`,{headers:this.headers,schema:l.db.schema,fetch:this.fetch}),l.accessToken||this._listenForAuthEvents()}get functions(){return new c(this.functionsUrl,{headers:this.headers,customFetch:this.fetch})}get storage(){return new fe(this.storageUrl,this.headers,this.fetch)}from(e){return this.rest.from(e)}schema(e){return this.rest.schema(e)}rpc(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return this.rest.rpc(e,t,o)}channel(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{config:{}};return this.realtime.channel(e,t)}getChannels(){return this.realtime.getChannels()}removeChannel(e){return this.realtime.removeChannel(e)}removeAllChannels(){return this.realtime.removeAllChannels()}_getAccessToken(){var e,t;return jt(this,void 0,void 0,(function*(){if(this.accessToken)return yield this.accessToken();const{data:o}=yield this.auth.getSession();return null!==(t=null===(e=o.session)||void 0===e?void 0:e.access_token)&&void 0!==t?t:null}))}_initSupabaseAuthClient(e,t,o){let{autoRefreshToken:n,persistSession:r,detectSessionInUrl:i,storage:a,storageKey:s,flowType:l,lock:c,debug:d}=e;const u={Authorization:`Bearer ${this.supabaseKey}`,apikey:`${this.supabaseKey}`};return new kt({url:this.authUrl,headers:Object.assign(Object.assign({},u),t),storageKey:s,autoRefreshToken:n,persistSession:r,detectSessionInUrl:i,storage:a,flowType:l,lock:c,debug:d,fetch:o,hasCustomAuthorizationHeader:"Authorization"in this.headers})}_initRealtimeClient(e){return new U(this.realtimeUrl,Object.assign(Object.assign({},e),{params:Object.assign({apikey:this.supabaseKey},null===e||void 0===e?void 0:e.params)}))}_listenForAuthEvents(){return this.auth.onAuthStateChange(((e,t)=>{this._handleTokenChanged(e,"CLIENT",null===t||void 0===t?void 0:t.access_token)}))}_handleTokenChanged(e,t,o){"TOKEN_REFRESHED"!==e&&"SIGNED_IN"!==e||this.changedAccessToken===o?"SIGNED_OUT"===e&&(this.realtime.setAuth(),"STORAGE"==t&&this.auth.signOut(),this.changedAccessToken=void 0):this.changedAccessToken=o}}const Rt=((e,t,o)=>new At(e,t,o))("https://efazuvegwxouysfcgwja.supabase.co","eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImVmYXp1dmVnd3hvdXlzZmNnd2phIiwicm9sZSI6ImFub24iLCJpYXQiOjE3MzU5Mjk1MjcsImV4cCI6MjA1MTUwNTUyN30.1G5n0CyQEHGeE1XaJld_PbpstUFd0Imaao6N8MUmfvE")},5369:(e,t,o)=>{"use strict";o.d(t,{DDN:()=>s,EcP:()=>i,QEs:()=>r,gt3:()=>l,nBS:()=>a,wJQ:()=>c});var n=o(6688);function r(e){return(0,n.k5)({tag:"svg",attr:{viewBox:"0 0 448 512"},child:[{tag:"path",attr:{d:"M416 32H31.9C14.3 32 0 46.5 0 64.3v383.4C0 465.5 14.3 480 31.9 480H416c17.6 0 32-14.5 32-32.3V64.3c0-17.8-14.4-32.3-32-32.3zM135.4 416H69V202.2h66.5V416zm-33.2-243c-21.3 0-38.5-17.3-38.5-38.5S80.9 96 102.2 96c21.2 0 38.5 17.3 38.5 38.5 0 21.3-17.2 38.5-38.5 38.5zm282.1 243h-66.4V312c0-24.8-.5-56.7-34.5-56.7-34.6 0-39.9 27-39.9 54.9V416h-66.4V202.2h63.7v29.2h.9c8.9-16.8 30.6-34.5 62.9-34.5 67.2 0 79.7 44.3 79.7 101.9V416z"}}]})(e)}function i(e){return(0,n.k5)({tag:"svg",attr:{viewBox:"0 0 448 512"},child:[{tag:"path",attr:{d:"M380.9 97.1C339 55.1 283.2 32 223.9 32c-122.4 0-222 99.6-222 222 0 39.1 10.2 77.3 29.6 111L0 480l117.7-30.9c32.4 17.7 68.9 27 106.1 27h.1c122.3 0 224.1-99.6 224.1-222 0-59.3-25.2-115-67.1-157zm-157 341.6c-33.2 0-65.7-8.9-94-25.7l-6.7-4-69.8 18.3L72 359.2l-4.4-7c-18.5-29.4-28.2-63.3-28.2-98.2 0-101.7 82.8-184.5 184.6-184.5 49.3 0 95.6 19.2 130.4 54.1 34.8 34.9 56.2 81.2 56.1 130.5 0 101.8-84.9 184.6-186.6 184.6zm101.2-138.2c-5.5-2.8-32.8-16.2-37.9-18-5.1-1.9-8.8-2.8-12.5 2.8-3.7 5.6-14.3 18-17.6 21.8-3.2 3.7-6.5 4.2-12 1.4-32.6-16.3-54-29.1-75.5-66-5.7-9.8 5.7-9.1 16.3-30.3 1.8-3.7.9-6.9-.5-9.7-1.4-2.8-12.5-30.1-17.1-41.2-4.5-10.8-9.1-9.3-12.5-9.5-3.2-.2-6.9-.2-10.6-.2-3.7 0-9.7 1.4-14.8 6.9-5.1 5.6-19.4 19-19.4 46.3 0 27.3 19.9 53.7 22.6 57.4 2.8 3.7 39.1 59.7 94.8 83.8 35.2 15.2 49 16.5 66.6 13.9 10.7-1.6 32.8-13.4 37.4-26.4 4.6-13 4.6-24.1 3.2-26.4-1.3-2.5-5-3.9-10.5-6.6z"}}]})(e)}function a(e){return(0,n.k5)({tag:"svg",attr:{viewBox:"0 0 448 512"},child:[{tag:"path",attr:{d:"M448 73.143v45.714C448 159.143 347.667 192 224 192S0 159.143 0 118.857V73.143C0 32.857 100.333 0 224 0s224 32.857 224 73.143zM448 176v102.857C448 319.143 347.667 352 224 352S0 319.143 0 278.857V176c48.125 33.143 136.208 48.572 224 48.572S399.874 209.143 448 176zm0 160v102.857C448 479.143 347.667 512 224 512S0 479.143 0 438.857V336c48.125 33.143 136.208 48.572 224 48.572S399.874 369.143 448 336z"}}]})(e)}function s(e){return(0,n.k5)({tag:"svg",attr:{viewBox:"0 0 640 512"},child:[{tag:"path",attr:{d:"M434.7 64h-85.9c-8 0-15.7 3-21.6 8.4l-98.3 90c-.1.1-.2.3-.3.4-16.6 15.6-16.3 40.5-2.1 56 12.7 13.9 39.4 17.6 56.1 2.7.1-.1.3-.1.4-.2l79.9-73.2c6.5-5.9 16.7-5.5 22.6 1 6 6.5 5.5 16.6-1 22.6l-26.1 23.9L504 313.8c2.9 2.4 5.5 5 7.9 7.7V128l-54.6-54.6c-5.9-6-14.1-9.4-22.6-9.4zM544 128.2v223.9c0 17.7 14.3 32 32 32h64V128.2h-96zm48 223.9c-8.8 0-16-7.2-16-16s7.2-16 16-16 16 7.2 16 16-7.2 16-16 16zM0 384h64c17.7 0 32-14.3 32-32V128.2H0V384zm48-63.9c8.8 0 16 7.2 16 16s-7.2 16-16 16-16-7.2-16-16c0-8.9 7.2-16 16-16zm435.9 18.6L334.6 217.5l-30 27.5c-29.7 27.1-75.2 24.5-101.7-4.4-26.9-29.4-24.8-74.9 4.4-101.7L289.1 64h-83.8c-8.5 0-16.6 3.4-22.6 9.4L128 128v223.9h18.3l90.5 81.9c27.4 22.3 67.7 18.1 90-9.3l.2-.2 17.9 15.5c15.9 13 39.4 10.5 52.3-5.4l31.4-38.6 5.4 4.4c13.7 11.1 33.9 9.1 45-4.7l9.5-11.7c11.2-13.8 9.1-33.9-4.6-45.1z"}}]})(e)}function l(e){return(0,n.k5)({tag:"svg",attr:{viewBox:"0 0 576 512"},child:[{tag:"path",attr:{d:"M259.3 17.8L194 150.2 47.9 171.5c-26.2 3.8-36.7 36.1-17.7 54.6l105.7 103-25 145.5c-4.5 26.3 23.2 46 46.4 33.7L288 439.6l130.7 68.7c23.2 12.2 50.9-7.4 46.4-33.7l-25-145.5 105.7-103c19-18.5 8.5-50.8-17.7-54.6L382 150.2 316.7 17.8c-11.7-23.6-45.6-23.9-57.4 0z"}}]})(e)}function c(e){return(0,n.k5)({tag:"svg",attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{d:"M0 252.118V48C0 21.49 21.49 0 48 0h204.118a48 48 0 0 1 33.941 14.059l211.882 211.882c18.745 18.745 18.745 49.137 0 67.882L293.823 497.941c-18.745 18.745-49.137 18.745-67.882 0L14.059 286.059A48 48 0 0 1 0 252.118zM112 64c-26.51 0-48 21.49-48 48s21.49 48 48 48 48-21.49 48-48-21.49-48-48-48z"}}]})(e)}},5484:(e,t,o)=>{"use strict";function n(){var e=this.constructor.getDerivedStateFromProps(this.props,this.state);null!==e&&void 0!==e&&this.setState(e)}function r(e){this.setState(function(t){var o=this.constructor.getDerivedStateFromProps(e,t);return null!==o&&void 0!==o?o:null}.bind(this))}function i(e,t){try{var o=this.props,n=this.state;this.props=e,this.state=t,this.__reactInternalSnapshotFlag=!0,this.__reactInternalSnapshot=this.getSnapshotBeforeUpdate(o,n)}finally{this.props=o,this.state=n}}function a(e){var t=e.prototype;if(!t||!t.isReactComponent)throw new Error("Can only polyfill class components");if("function"!==typeof e.getDerivedStateFromProps&&"function"!==typeof t.getSnapshotBeforeUpdate)return e;var o=null,a=null,s=null;if("function"===typeof t.componentWillMount?o="componentWillMount":"function"===typeof t.UNSAFE_componentWillMount&&(o="UNSAFE_componentWillMount"),"function"===typeof t.componentWillReceiveProps?a="componentWillReceiveProps":"function"===typeof t.UNSAFE_componentWillReceiveProps&&(a="UNSAFE_componentWillReceiveProps"),"function"===typeof t.componentWillUpdate?s="componentWillUpdate":"function"===typeof t.UNSAFE_componentWillUpdate&&(s="UNSAFE_componentWillUpdate"),null!==o||null!==a||null!==s){var l=e.displayName||e.name,c="function"===typeof e.getDerivedStateFromProps?"getDerivedStateFromProps()":"getSnapshotBeforeUpdate()";throw Error("Unsafe legacy lifecycles will not be called for components using new component APIs.\n\n"+l+" uses "+c+" but also contains the following legacy lifecycles:"+(null!==o?"\n  "+o:"")+(null!==a?"\n  "+a:"")+(null!==s?"\n  "+s:"")+"\n\nThe above lifecycles should be removed. Learn more about this warning here:\nhttps://fb.me/react-async-component-lifecycle-hooks")}if("function"===typeof e.getDerivedStateFromProps&&(t.componentWillMount=n,t.componentWillReceiveProps=r),"function"===typeof t.getSnapshotBeforeUpdate){if("function"!==typeof t.componentDidUpdate)throw new Error("Cannot polyfill getSnapshotBeforeUpdate() for components that do not define componentDidUpdate() on the prototype");t.componentWillUpdate=i;var d=t.componentDidUpdate;t.componentDidUpdate=function(e,t,o){var n=this.__reactInternalSnapshotFlag?this.__reactInternalSnapshot:o;d.call(this,e,t,n)}}return e}o.r(t),o.d(t,{polyfill:()=>a}),n.__suppressDeprecationWarning=!0,r.__suppressDeprecationWarning=!0,i.__suppressDeprecationWarning=!0},5546:(e,t,o)=>{"use strict";o.d(t,{A:()=>T});var n=o(5043),r=o(2963),i=o.n(r),a=o(1529),s=o(5315),l=o(1009),c=o(3768),d=o(579);const u=a.Ay.div`
  width: 100%;
  max-width: 600px;
`,p=a.Ay.div`
  display: flex;
  justify-content: space-between;
  align-items: center;
  margin-bottom: 20px;
  padding-bottom: 15px;
  border-bottom: 1px solid #333;
`,h=a.Ay.h2`
  color: #fff;
  font-size: 20px;
  font-weight: 500;
  margin: 0;
`,f=a.Ay.button`
  background: transparent;
  color: #00ff00;
  border: none;
  cursor: pointer;
  display: flex;
  align-items: center;
  justify-content: center;
  font-size: 20px;
  padding: 5px;
  border-radius: 4px;

  &:hover {
    background: #333;
  }
`,g=a.Ay.div`
  margin-bottom: 20px;
`,m=a.Ay.label`
  display: block;
  margin-bottom: 8px;
  color: #00ff00;
  font-size: 14px;
  font-weight: 500;
`,y=a.Ay.div`
  position: relative;
  margin-bottom: 20px;
`,v=a.Ay.input`
  width: 100%;
  padding: 10px 40px 10px 12px;
  background: #333;
  border: 1px solid #444;
  border-radius: 4px;
  color: #fff;
  font-size: 14px;
  box-sizing: border-box;
  height: 40px;

  &:focus {
    outline: none;
    border-color: #00ff00;
  }
`,b=a.Ay.div`
  position: absolute;
  right: 12px;
  top: 50%;
  transform: translateY(-50%);
  color: #aaa;
`,x=a.Ay.div`
  background: #222;
  border: 1px solid #444;
  border-radius: 4px;
  max-height: 300px;
  overflow-y: auto;
  margin-top: 10px;
`,w=a.Ay.div`
  padding: 10px 15px;
  border-bottom: 1px solid #333;
  cursor: pointer;
  display: flex;
  justify-content: space-between;
  align-items: center;

  &:hover {
    background: #333;
  }

  &:last-child {
    border-bottom: none;
  }
`,C=a.Ay.div`
  flex: 1;
`,_=a.Ay.div`
  color: #fff;
  font-weight: 500;
  margin-bottom: 4px;
`,S=a.Ay.div`
  color: #999;
  font-size: 12px;
`,E=a.Ay.button`
  background: transparent;
  border: none;
  color: #00ff00;
  cursor: pointer;
  display: flex;
  align-items: center;
  justify-content: center;
  padding: 5px;
  margin-left: 5px;
  border-radius: 4px;

  &:hover {
    background: #444;
  }
`,k=a.Ay.div`
  padding: 20px;
  text-align: center;
  color: #999;
`,j=a.Ay.div`
  display: flex;
  justify-content: flex-end;
  gap: 10px;
  margin-top: 30px;
`,A=a.Ay.button`
  display: flex;
  align-items: center;
  gap: 8px;
  padding: 8px 16px;
  border-radius: 4px;
  font-size: 14px;
  cursor: pointer;
  transition: all 0.2s;
  
  &.primary {
    background: #333;
    color: #00ff00;
    border: 1px solid #00ff00;
    
    &:hover {
      background: #444;
    }
  }
  
  &.cancel {
    background: transparent;
    color: #fff;
    border: 1px solid #555;
    
    &:hover {
      background: #333;
    }
  }
`,R=a.Ay.select`
  width: 100%;
  padding: 10px;
  background: #333;
  border: 1px solid #444;
  border-radius: 4px;
  color: #fff;
  font-size: 14px;
  box-sizing: border-box;
  appearance: none;
  background-image: url("data:image/svg+xml;utf8,<svg xmlns='http://www.w3.org/2000/svg' width='10' height='6' fill='none' stroke='%23aaa' stroke-width='1.5' viewBox='0 0 10 6'><polyline points='1,1 5,5 9,1'/></svg>");
  background-repeat: no-repeat;
  background-position: right 10px center;
  padding-right: 30px;
  height: 40px;

  &:focus {
    outline: none;
    border-color: #00ff00;
  }
`,O=["not_set","employee","founder","advisor","manager","investor","other"],T=e=>{let{isOpen:t,onRequestClose:o,contactId:r,onCompanyAssociated:a=()=>{}}=e;const[T,D]=(0,n.useState)(""),[P,N]=(0,n.useState)([]),[I,M]=(0,n.useState)(!1),[L,F]=(0,n.useState)(!1),[G,z]=(0,n.useState)(null),[H,B]=(0,n.useState)("not_set"),[V,$]=(0,n.useState)(!1),U=(0,n.useRef)(null),W=(0,n.useRef)(null);(0,n.useEffect)((()=>{t&&U.current&&setTimeout((()=>{U.current.focus()}),100),t&&(D(""),N([]),z(null),B("not_set"),$(!1),F(!1),console.log("AssociateCompanyModal opened with contactId:",r))}),[t,r]);const q=async e=>{M(!0);try{const{data:t,error:o}=await s.supabase.from("contact_companies").select("company_id").eq("contact_id",r);if(o)throw o;const n=new Set(t.map((e=>e.company_id))),{data:i,error:a}=await s.supabase.from("companies").select("*").ilike("name",`%${e}%`).order("name",{ascending:!0}).limit(20);if(a)throw a;const l=i.filter((e=>!n.has(e.company_id)));N(l),F(0===l.length)}catch(t){console.error("Error searching companies:",t),c.Ay.error("Failed to search companies")}finally{M(!1)}};return(0,d.jsx)(i(),{isOpen:t,onRequestClose:o,style:{content:{top:"50%",left:"50%",right:"auto",bottom:"auto",marginRight:"-50%",transform:"translate(-50%, -50%)",padding:"25px",border:"1px solid #444",borderRadius:"8px",backgroundColor:"#111",color:"#fff",maxWidth:"600px",width:"90%",boxShadow:"0 4px 20px rgba(0, 0, 0, 0.5)"},overlay:{backgroundColor:"rgba(0, 0, 0, 0.7)",zIndex:1e3}},children:(0,d.jsxs)(u,{children:[(0,d.jsxs)(p,{children:[(0,d.jsx)(h,{children:"Associate Company"}),(0,d.jsx)(f,{onClick:o,children:(0,d.jsx)(l.yGN,{size:20})})]}),(0,d.jsxs)(y,{children:[(0,d.jsx)(v,{ref:U,type:"text",value:T,onChange:e=>{const t=e.target.value;if(D(t),W.current&&clearTimeout(W.current),t.length<2)return N([]),void F(!1);W.current=setTimeout((()=>{q(t)}),300)},onKeyDown:e=>{if("Enter"===e.key){if(e.preventDefault(),T.length<2)return;W.current&&clearTimeout(W.current),q(T)}},placeholder:"Search for a company by name..."}),(0,d.jsx)(b,{children:(0,d.jsx)(l.CKj,{size:16})})]}),I&&(0,d.jsx)(k,{children:"Searching..."}),!I&&T.length>=2&&(0,d.jsx)(d.Fragment,{children:P.length>0?(0,d.jsx)(x,{children:P.map((e=>(0,d.jsxs)(w,{onClick:()=>(e=>{z(e),N([]),D(e.name)})(e),children:[(0,d.jsxs)(C,{children:[(0,d.jsx)(_,{children:e.name}),(0,d.jsxs)(S,{children:[e.category||"No category"," \u2022 ",e.website||"No website"]})]}),(0,d.jsx)(E,{title:"View details",children:(0,d.jsx)(l.HaR,{size:16})})]},e.company_id)))}):L?(0,d.jsx)(x,{children:(0,d.jsxs)(k,{children:["No companies found with that name.",(0,d.jsx)("div",{style:{marginTop:"10px"},children:(0,d.jsxs)(A,{className:"primary",onClick:()=>{o(),a({action:"create_new",name:T})},children:[(0,d.jsx)(l.GGD,{size:14}),' Create "',T,'"']})})]})}):null}),G&&(0,d.jsxs)(d.Fragment,{children:[(0,d.jsxs)(g,{style:{marginTop:"20px"},children:[(0,d.jsx)(m,{children:"Relationship"}),(0,d.jsx)(R,{value:H,onChange:e=>B(e.target.value),children:O.map((e=>(0,d.jsx)("option",{value:e,children:"not_set"===e?"Not Set":e.charAt(0).toUpperCase()+e.slice(1)},e)))})]}),(0,d.jsx)(g,{children:(0,d.jsxs)("div",{style:{display:"flex",alignItems:"center"},children:[(0,d.jsx)("input",{type:"checkbox",id:"isPrimary",checked:V,onChange:e=>$(e.target.checked),style:{marginRight:"10px"}}),(0,d.jsx)("label",{htmlFor:"isPrimary",style:{color:"#fff"},children:"Set as primary company"})]})})]}),(0,d.jsxs)(j,{children:[(0,d.jsx)(A,{className:"cancel",onClick:o,children:"Cancel"}),(0,d.jsx)(A,{className:"primary",onClick:async()=>{if(G){if(console.log("handleAssociateCompany - contactId:",r,"type:",typeof r),console.log("handleAssociateCompany - selectedCompany:",G),!r)return console.error("Missing contact ID when trying to associate company",{contactId:r,companyId:null===G||void 0===G?void 0:G.company_id}),void c.Ay.error("Cannot associate company: Missing contact ID");try{c.Ay.loading("Associating company...",{id:"associate-company"}),console.log("Associating company to contact",{contactId:r,contactIdType:typeof r,companyId:G.company_id,companyName:G.name,relationship:H,isPrimary:V});const{data:e,error:t}=await s.supabase.from("contact_companies").insert({contact_id:String(r),company_id:G.company_id,relationship:H,is_primary:V}).select();if(t)throw console.error("Database error when associating company:",t),t;console.log("Company association successful:",e),c.Ay.dismiss("associate-company"),c.Ay.success(`${G.name} associated successfully`),a({action:"associated",company:G,relationship:H,is_primary:V,data:null===e||void 0===e?void 0:e[0]}),o()}catch(e){console.error("Error associating company:",e),c.Ay.dismiss("associate-company"),c.Ay.error(`Failed to associate company: ${e.message||"Unknown error"}`)}}else c.Ay.error("Please select a company to associate")},disabled:!G,children:G?`Associate with ${G.name}`:"Select a Company"})]})]})})}},5736:function(e,t,o){"use strict";var n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const r=n(o(7374));class i extends r.default{eq(e,t){return this.url.searchParams.append(e,`eq.${t}`),this}neq(e,t){return this.url.searchParams.append(e,`neq.${t}`),this}gt(e,t){return this.url.searchParams.append(e,`gt.${t}`),this}gte(e,t){return this.url.searchParams.append(e,`gte.${t}`),this}lt(e,t){return this.url.searchParams.append(e,`lt.${t}`),this}lte(e,t){return this.url.searchParams.append(e,`lte.${t}`),this}like(e,t){return this.url.searchParams.append(e,`like.${t}`),this}likeAllOf(e,t){return this.url.searchParams.append(e,`like(all).{${t.join(",")}}`),this}likeAnyOf(e,t){return this.url.searchParams.append(e,`like(any).{${t.join(",")}}`),this}ilike(e,t){return this.url.searchParams.append(e,`ilike.${t}`),this}ilikeAllOf(e,t){return this.url.searchParams.append(e,`ilike(all).{${t.join(",")}}`),this}ilikeAnyOf(e,t){return this.url.searchParams.append(e,`ilike(any).{${t.join(",")}}`),this}is(e,t){return this.url.searchParams.append(e,`is.${t}`),this}in(e,t){const o=Array.from(new Set(t)).map((e=>"string"===typeof e&&new RegExp("[,()]").test(e)?`"${e}"`:`${e}`)).join(",");return this.url.searchParams.append(e,`in.(${o})`),this}contains(e,t){return"string"===typeof t?this.url.searchParams.append(e,`cs.${t}`):Array.isArray(t)?this.url.searchParams.append(e,`cs.{${t.join(",")}}`):this.url.searchParams.append(e,`cs.${JSON.stringify(t)}`),this}containedBy(e,t){return"string"===typeof t?this.url.searchParams.append(e,`cd.${t}`):Array.isArray(t)?this.url.searchParams.append(e,`cd.{${t.join(",")}}`):this.url.searchParams.append(e,`cd.${JSON.stringify(t)}`),this}rangeGt(e,t){return this.url.searchParams.append(e,`sr.${t}`),this}rangeGte(e,t){return this.url.searchParams.append(e,`nxl.${t}`),this}rangeLt(e,t){return this.url.searchParams.append(e,`sl.${t}`),this}rangeLte(e,t){return this.url.searchParams.append(e,`nxr.${t}`),this}rangeAdjacent(e,t){return this.url.searchParams.append(e,`adj.${t}`),this}overlaps(e,t){return"string"===typeof t?this.url.searchParams.append(e,`ov.${t}`):this.url.searchParams.append(e,`ov.{${t.join(",")}}`),this}textSearch(e,t){let{config:o,type:n}=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},r="";"plain"===n?r="pl":"phrase"===n?r="ph":"websearch"===n&&(r="w");const i=void 0===o?"":`(${o})`;return this.url.searchParams.append(e,`${r}fts${i}.${t}`),this}match(e){return Object.entries(e).forEach((e=>{let[t,o]=e;this.url.searchParams.append(t,`eq.${o}`)})),this}not(e,t,o){return this.url.searchParams.append(e,`not.${t}.${o}`),this}or(e){let{foreignTable:t,referencedTable:o=t}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const n=o?`${o}.or`:"or";return this.url.searchParams.append(n,`(${e})`),this}filter(e,t,o){return this.url.searchParams.append(e,`${t}.${o}`),this}}t.default=i},5745:(e,t,o)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.DEFAULT_HEADERS=void 0;const n=o(400);t.DEFAULT_HEADERS={"X-Client-Info":`postgrest-js/${n.version}`}},5765:(e,t,o)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.bodyOpenClassName=t.portalClassName=void 0;var n=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var o=arguments[t];for(var n in o)Object.prototype.hasOwnProperty.call(o,n)&&(e[n]=o[n])}return e},r=function(){function e(e,t){for(var o=0;o<t.length;o++){var n=t[o];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,o,n){return o&&e(t.prototype,o),n&&e(t,n),t}}(),i=o(5043),a=f(i),s=f(o(7950)),l=f(o(5173)),c=f(o(1439)),d=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o]);return t.default=e,t}(o(6619)),u=o(8821),p=f(u),h=o(5484);function f(e){return e&&e.__esModule?e:{default:e}}function g(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!==typeof t&&"function"!==typeof t?e:t}var m=t.portalClassName="ReactModalPortal",y=t.bodyOpenClassName="ReactModal__Body--open",v=u.canUseDOM&&void 0!==s.default.createPortal,b=function(e){return document.createElement(e)},x=function(){return v?s.default.createPortal:s.default.unstable_renderSubtreeIntoContainer};function w(e){return e()}var C=function(e){function t(){var e,o,r;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);for(var i=arguments.length,l=Array(i),d=0;d<i;d++)l[d]=arguments[d];return o=r=g(this,(e=t.__proto__||Object.getPrototypeOf(t)).call.apply(e,[this].concat(l))),r.removePortal=function(){!v&&s.default.unmountComponentAtNode(r.node);var e=w(r.props.parentSelector);e&&e.contains(r.node)?e.removeChild(r.node):console.warn('React-Modal: "parentSelector" prop did not returned any DOM element. Make sure that the parent element is unmounted to avoid any memory leaks.')},r.portalRef=function(e){r.portal=e},r.renderPortal=function(e){var o=x()(r,a.default.createElement(c.default,n({defaultStyles:t.defaultStyles},e)),r.node);r.portalRef(o)},g(r,o)}return function(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),r(t,[{key:"componentDidMount",value:function(){u.canUseDOM&&(v||(this.node=b("div")),this.node.className=this.props.portalClassName,w(this.props.parentSelector).appendChild(this.node),!v&&this.renderPortal(this.props))}},{key:"getSnapshotBeforeUpdate",value:function(e){return{prevParent:w(e.parentSelector),nextParent:w(this.props.parentSelector)}}},{key:"componentDidUpdate",value:function(e,t,o){if(u.canUseDOM){var n=this.props,r=n.isOpen,i=n.portalClassName;e.portalClassName!==i&&(this.node.className=i);var a=o.prevParent,s=o.nextParent;s!==a&&(a.removeChild(this.node),s.appendChild(this.node)),(e.isOpen||r)&&!v&&this.renderPortal(this.props)}}},{key:"componentWillUnmount",value:function(){if(u.canUseDOM&&this.node&&this.portal){var e=this.portal.state,t=Date.now(),o=e.isOpen&&this.props.closeTimeoutMS&&(e.closesAt||t+this.props.closeTimeoutMS);o?(e.beforeClose||this.portal.closeWithTimeout(),setTimeout(this.removePortal,o-t)):this.removePortal()}}},{key:"render",value:function(){return u.canUseDOM&&v?(!this.node&&v&&(this.node=b("div")),x()(a.default.createElement(c.default,n({ref:this.portalRef,defaultStyles:t.defaultStyles},this.props)),this.node)):null}}],[{key:"setAppElement",value:function(e){d.setElement(e)}}]),t}(i.Component);C.propTypes={isOpen:l.default.bool.isRequired,style:l.default.shape({content:l.default.object,overlay:l.default.object}),portalClassName:l.default.string,bodyOpenClassName:l.default.string,htmlOpenClassName:l.default.string,className:l.default.oneOfType([l.default.string,l.default.shape({base:l.default.string.isRequired,afterOpen:l.default.string.isRequired,beforeClose:l.default.string.isRequired})]),overlayClassName:l.default.oneOfType([l.default.string,l.default.shape({base:l.default.string.isRequired,afterOpen:l.default.string.isRequired,beforeClose:l.default.string.isRequired})]),appElement:l.default.oneOfType([l.default.instanceOf(p.default),l.default.instanceOf(u.SafeHTMLCollection),l.default.instanceOf(u.SafeNodeList),l.default.arrayOf(l.default.instanceOf(p.default))]),onAfterOpen:l.default.func,onRequestClose:l.default.func,closeTimeoutMS:l.default.number,ariaHideApp:l.default.bool,shouldFocusAfterRender:l.default.bool,shouldCloseOnOverlayClick:l.default.bool,shouldReturnFocusAfterClose:l.default.bool,preventScroll:l.default.bool,parentSelector:l.default.func,aria:l.default.object,data:l.default.object,role:l.default.string,contentLabel:l.default.string,shouldCloseOnEsc:l.default.bool,overlayRef:l.default.func,contentRef:l.default.func,id:l.default.string,overlayElement:l.default.func,contentElement:l.default.func},C.defaultProps={isOpen:!1,portalClassName:m,bodyOpenClassName:y,role:"dialog",ariaHideApp:!0,closeTimeoutMS:0,shouldFocusAfterRender:!0,shouldCloseOnEsc:!0,shouldCloseOnOverlayClick:!0,shouldReturnFocusAfterClose:!0,preventScroll:!1,parentSelector:function(){return document.body},overlayElement:function(e,t){return a.default.createElement("div",e,t)},contentElement:function(e,t){return a.default.createElement("div",e,t)}},C.defaultStyles={overlay:{position:"fixed",top:0,left:0,right:0,bottom:0,backgroundColor:"rgba(255, 255, 255, 0.75)"},content:{position:"absolute",top:"40px",left:"40px",right:"40px",bottom:"40px",border:"1px solid #ccc",background:"#fff",overflow:"auto",WebkitOverflowScrolling:"touch",borderRadius:"4px",outline:"none",padding:"20px"}},(0,h.polyfill)(C),t.default=C},5837:(e,t,o)=>{"use strict";o.d(t,{A:()=>a});var n=o(2284),r=o(3666);var i=o(6260);function a(e){if((0,r.A)(1,arguments),!function(e){return(0,r.A)(1,arguments),e instanceof Date||"object"===(0,n.A)(e)&&"[object Date]"===Object.prototype.toString.call(e)}(e)&&"number"!==typeof e)return!1;var t=(0,i.A)(e);return!isNaN(Number(t))}},5852:(e,t,o)=>{"use strict";o.d(t,{A:()=>l});const n={randomUUID:"undefined"!==typeof crypto&&crypto.randomUUID&&crypto.randomUUID.bind(crypto)};let r;const i=new Uint8Array(16);const a=[];for(let c=0;c<256;++c)a.push((c+256).toString(16).slice(1));function s(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return(a[e[t+0]]+a[e[t+1]]+a[e[t+2]]+a[e[t+3]]+"-"+a[e[t+4]]+a[e[t+5]]+"-"+a[e[t+6]]+a[e[t+7]]+"-"+a[e[t+8]]+a[e[t+9]]+"-"+a[e[t+10]]+a[e[t+11]]+a[e[t+12]]+a[e[t+13]]+a[e[t+14]]+a[e[t+15]]).toLowerCase()}const l=function(e,t,o){if(n.randomUUID&&!t&&!e)return n.randomUUID();const a=(e=e||{}).random??e.rng?.()??function(){if(!r){if("undefined"===typeof crypto||!crypto.getRandomValues)throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");r=crypto.getRandomValues.bind(crypto)}return r(i)}();if(a.length<16)throw new Error("Random bytes length must be >= 16");if(a[6]=15&a[6]|64,a[8]=63&a[8]|128,t){if((o=o||0)<0||o+16>t.length)throw new RangeError(`UUID byte range ${o}:${o+15} is out of buffer bounds`);for(let e=0;e<16;++e)t[o+e]=a[e];return t}return s(a)}},5962:(e,t,o)=>{"use strict";o.d(t,{A:()=>R});var n=o(5043),r=o(2963),i=o.n(r),a=o(1529),s=o(5315),l=o(1009),c=o(3768),d=o(579);const u=a.Ay.div`
  display: flex;
  width: 100%;
  height: 100%;
`,p=a.Ay.div`
  width: 25%;
  background-color: #222;
  padding: 20px 0;
  border-right: 1px solid #333;
  flex-shrink: 0;
`,h=a.Ay.div`
  width: 75%;
  padding: 20px;
  overflow-y: auto;
  max-height: 80vh;
  flex-grow: 1;
`,f=a.Ay.button`
  display: flex;
  align-items: center;
  gap: 10px;
  width: 100%;
  padding: 12px 20px;
  background: ${e=>e.active?"#333":"transparent"};
  color: ${e=>e.active?"#00ff00":"#fff"};
  border: none;
  text-align: left;
  font-size: 15px;
  transition: all 0.2s;
  cursor: pointer;
  border-left: 3px solid ${e=>e.active?"#00ff00":"transparent"};

  &:hover {
    background: #333;
  }
`,g=a.Ay.div`
  margin-bottom: 20px;
`,m=a.Ay.label`
  display: block;
  margin-bottom: 8px;
  color: #00ff00;
  font-size: 14px;
  font-weight: 500;
`,y=a.Ay.input`
  width: 100%;
  padding: 8px 10px;
  height: 36px;
  background: #333;
  border: 1px solid #444;
  border-radius: 4px;
  color: #fff;
  font-size: 14px;
  box-sizing: border-box;

  &:focus {
    outline: none;
    border-color: #00ff00;
  }
`,v=a.Ay.select`
  width: 100%;
  padding: 8px 10px;
  height: 36px;
  background: #333;
  border: 1px solid #444;
  border-radius: 4px;
  color: #fff;
  font-size: 14px;
  box-sizing: border-box;
  appearance: none;
  background-image: url("data:image/svg+xml;utf8,<svg xmlns='http://www.w3.org/2000/svg' width='10' height='6' fill='none' stroke='%23aaa' stroke-width='1.5' viewBox='0 0 10 6'><polyline points='1,1 5,5 9,1'/></svg>");
  background-repeat: no-repeat;
  background-position: right 10px center;
  padding-right: 30px;

  &:focus {
    outline: none;
    border-color: #00ff00;
  }
`,b=a.Ay.textarea`
  width: 100%;
  padding: 10px;
  background: #333;
  border: 1px solid #444;
  border-radius: 4px;
  color: #fff;
  font-size: 14px;
  min-height: 100px;
  resize: vertical;
  box-sizing: border-box;

  &:focus {
    outline: none;
    border-color: #00ff00;
  }
`,x=(a.Ay.div`
  display: flex;
  flex-wrap: wrap;
  gap: 8px;
  margin-top: 8px;
  min-height: 40px;
  padding: 10px;
  background: #333;
  border-radius: 4px;
  border: 1px solid #444;
`,a.Ay.div`
  display: flex;
  align-items: center;
  gap: 5px;
  padding: 2px 5px;
  background: #444;
  color: #00ff00;
  border: 1px solid #00ff00;
  border-radius: 3px;
  font-size: 0.7rem;
`,a.Ay.button`
  display: flex;
  align-items: center;
  justify-content: center;
  background: transparent;
  border: none;
  color: #00ff00;
  cursor: pointer;
  padding: 2px;

  &:hover {
    color: #ff5555;
  }
`,a.Ay.div`
  display: flex;
  justify-content: flex-end;
  gap: 10px;
  margin-top: 30px;
`),w=a.Ay.button`
  display: flex;
  align-items: center;
  gap: 8px;
  padding: 8px 16px;
  border-radius: 4px;
  font-size: 14px;
  cursor: pointer;
  transition: all 0.2s;
  
  &.primary {
    background: #333;
    color: #00ff00;
    border: 1px solid #00ff00;
    
    &:hover {
      background: #444;
    }
  }
  
  &.cancel {
    background: transparent;
    color: #fff;
    border: 1px solid #555;
    
    &:hover {
      background: #333;
    }
  }
`,C=a.Ay.div`
  display: flex;
  justify-content: space-between;
  align-items: center;
  margin-bottom: 20px;
  padding-bottom: 15px;
  border-bottom: 1px solid #333;
`,_=a.Ay.h2`
  color: #fff;
  font-size: 20px;
  font-weight: 500;
  margin: 0;
`,S=a.Ay.button`
  background: transparent;
  color: #00ff00;
  border: none;
  cursor: pointer;
  display: flex;
  align-items: center;
  justify-content: center;
  font-size: 20px;
  padding: 5px;
  border-radius: 4px;

  &:hover {
    background: #333;
  }
`,E=a.Ay.div`
  color: #999;
  text-align: center;
  padding: 30px;
  font-size: 15px;
`,k=["Not Set","Inbox","Professional Investor","Startup","Corporate","Corporation","Advisory","SME","Institution","Media","Skip"],j=["not_set","employee","founder","advisor","manager","investor","other"],A=e=>{let{isOpen:t,onRequestClose:o,companyId:r,onContactAdded:a}=e;const[u,p]=(0,n.useState)(""),[h,f]=(0,n.useState)([]),[b,E]=(0,n.useState)(!1),[k,A]=(0,n.useState)(null),[R,O]=(0,n.useState)("not_set"),[T,D]=(0,n.useState)(!1);return(0,d.jsxs)(i(),{isOpen:t,onRequestClose:o,style:{content:{top:"50%",left:"50%",right:"auto",bottom:"auto",marginRight:"-50%",transform:"translate(-50%, -50%)",padding:"20px",border:"1px solid #444",borderRadius:"8px",backgroundColor:"#111",color:"#fff",width:"500px",maxWidth:"95%",maxHeight:"90vh",overflow:"auto"},overlay:{backgroundColor:"rgba(0, 0, 0, 0.7)",zIndex:1100}},children:[(0,d.jsxs)(C,{children:[(0,d.jsx)(_,{children:"Add Contact to Company"}),(0,d.jsx)(S,{onClick:o,children:(0,d.jsx)(l.yGN,{size:20})})]}),k?(0,d.jsxs)(d.Fragment,{children:[(0,d.jsxs)("div",{style:{padding:"15px",background:"#222",borderRadius:"4px",marginBottom:"20px"},children:[(0,d.jsxs)("div",{style:{fontSize:"16px",marginBottom:"10px",color:"#00ff00"},children:[k.first_name," ",k.last_name]}),(0,d.jsxs)("div",{style:{fontSize:"14px",color:"#ccc"},children:[k.job_role&&(0,d.jsx)("div",{children:k.job_role}),k.category&&(0,d.jsxs)("div",{children:["Category: ",k.category]})]})]}),(0,d.jsxs)(g,{children:[(0,d.jsx)(m,{children:"Relationship Type"}),(0,d.jsx)(v,{value:R,onChange:e=>O(e.target.value),children:j.map((e=>(0,d.jsx)("option",{value:e,children:"not_set"===e?"Not Set":e.charAt(0).toUpperCase()+e.slice(1)},e)))})]}),(0,d.jsx)(g,{children:(0,d.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:"10px"},children:[(0,d.jsx)("input",{type:"checkbox",id:"isPrimary",checked:T,onChange:e=>D(e.target.checked),style:{appearance:"none",width:"16px",height:"16px",border:"1px solid #555",borderRadius:"3px",position:"relative",cursor:"pointer",backgroundColor:T?"#00ff00":"transparent","&:checked::after":{content:"\u2713",color:"#000",position:"absolute",top:"1px",left:"4px"}}}),(0,d.jsx)("label",{htmlFor:"isPrimary",style:{fontSize:"14px",cursor:"pointer"},children:"Set as primary company for this contact"})]})}),(0,d.jsxs)(x,{children:[(0,d.jsx)(w,{className:"cancel",onClick:()=>A(null),children:"Back"}),(0,d.jsxs)(w,{className:"primary",onClick:async()=>{if(k)try{const{error:e}=await s.supabase.from("contact_companies").insert({contact_id:k.contact_id,company_id:r,relationship:R,is_primary:T});if(e)throw e;c.Ay.success("Contact added successfully"),a&&a(),o()}catch(e){console.error("Error adding contact to company:",e),c.Ay.error("Failed to add contact to company")}else c.Ay.error("Please select a contact")},children:[(0,d.jsx)(l.vq3,{size:16})," Add Contact"]})]})]}):(0,d.jsxs)(d.Fragment,{children:[(0,d.jsxs)(g,{children:[(0,d.jsx)(m,{children:"Search for Contact"}),(0,d.jsx)(y,{type:"text",value:u,onChange:e=>(async e=>{if(p(e),e.length<2)f([]);else{E(!0);try{const{data:t,error:o}=await s.supabase.from("contacts").select("contact_id, first_name, last_name, job_role, category").or(`first_name.ilike.%${e}%,last_name.ilike.%${e}%`).limit(10);if(o)throw o;const{data:n,error:i}=await s.supabase.from("contact_companies").select("contact_id").eq("company_id",r);if(i)throw i;const a=new Set(n.map((e=>e.contact_id))),l=t.filter((e=>!a.has(e.contact_id)));f(l)}catch(t){console.error("Error searching for contacts:",t),c.Ay.error("Failed to search for contacts")}finally{E(!1)}}})(e.target.value),placeholder:"Search by first or last name...",style:{marginBottom:"10px"}}),b&&(0,d.jsx)("div",{style:{color:"#999",fontSize:"14px",marginTop:"10px"},children:"Searching..."}),!b&&u.length>1&&0===h.length&&(0,d.jsx)("div",{style:{color:"#999",fontSize:"14px",marginTop:"10px"},children:"No contacts found"}),h.length>0&&(0,d.jsx)("div",{style:{maxHeight:"300px",overflowY:"auto",border:"1px solid #444",borderRadius:"4px",marginTop:"10px"},children:h.map((e=>(0,d.jsxs)("div",{style:{padding:"10px",borderBottom:"1px solid #333",cursor:"pointer","&:hover":{backgroundColor:"#222"}},onClick:()=>(e=>{A(e),p(""),f([])})(e),children:[(0,d.jsxs)("div",{style:{fontSize:"14px",fontWeight:"bold"},children:[e.first_name," ",e.last_name]}),(0,d.jsxs)("div",{style:{fontSize:"12px",color:"#999"},children:[e.job_role?`${e.job_role}`:"",e.category?` \u2022 ${e.category}`:""]})]},e.contact_id)))})]}),(0,d.jsx)(x,{children:(0,d.jsx)(w,{className:"cancel",onClick:o,children:"Cancel"})})]})]})},R=e=>{let{isOpen:t,onRequestClose:o,company:r,contactId:a=null,onCompanyUpdated:R=()=>{}}=e;const[O,T]=(0,n.useState)("edit"),[D,P]=(0,n.useState)({name:"",website:"",linkedin:"",category:"Inbox",description:"",relationship:"not_set"}),[N,I]=(0,n.useState)([]),[M,L]=(0,n.useState)(""),[F,G]=(0,n.useState)([]),[z,H]=(0,n.useState)(!1),[B,V]=(0,n.useState)([]),[$,U]=(0,n.useState)(!1),[W,q]=(0,n.useState)([]),[K,Y]=(0,n.useState)(!1),[J,X]=(0,n.useState)(!1),[Q,Z]=(0,n.useState)(!1);(0,n.useEffect)((()=>{t&&null!==r&&void 0!==r&&r.company_id&&(ee(),te(),"related"===O?oe():"duplicates"===O&&ne())}),[t,r,O]);const ee=async()=>{try{const{data:e,error:t}=await s.supabase.from("companies").select("*").eq("company_id",r.company_id).single();if(t)throw t;let o="not_set";if(a){const{data:e,error:t}=await s.supabase.from("contact_companies").select("relationship").eq("contact_id",a).eq("company_id",r.company_id).single();!t&&e&&(o=e.relationship)}P({...e,relationship:o})}catch(e){console.error("Error loading company data:",e),c.Ay.error("Failed to load company data")}},te=async()=>{try{const{data:e,error:t}=await s.supabase.from("company_tags").select("\n          entry_id,\n          tag_id,\n          tags (\n            tag_id,\n            name\n          )\n        ").eq("company_id",r.company_id);if(t)throw t;const o=e.map((e=>{var t;return{id:e.entry_id,tag_id:e.tag_id,name:(null===(t=e.tags)||void 0===t?void 0:t.name)||"Unknown"}}));I(o)}catch(e){console.error("Error loading company tags:",e),c.Ay.error("Failed to load company tags")}},oe=async()=>{if(null!==r&&void 0!==r&&r.company_id){U(!0);try{const{data:e,error:t}=await s.supabase.from("contact_companies").select("\n          contact_companies_id,\n          relationship,\n          contacts (\n            contact_id,\n            first_name,\n            last_name,\n            job_role,\n            linkedin\n          )\n        ").eq("company_id",r.company_id);if(t)throw t;const o=e.filter((e=>e.contacts)).map((e=>({id:e.contact_companies_id,contact_id:e.contacts.contact_id,name:`${e.contacts.first_name||""} ${e.contacts.last_name||""}`.trim(),job_role:e.contacts.job_role,linkedin:e.contacts.linkedin,relationship:e.relationship})));V(o)}catch(e){console.error("Error loading related contacts:",e),c.Ay.error("Failed to load related contacts")}finally{U(!1)}}},ne=async()=>{if(null!==r&&void 0!==r&&r.company_id){Y(!0);try{let e=[],t=new Set;if(D.name){const{data:o,error:n}=await s.supabase.from("companies").select("*").neq("company_id",r.company_id).ilike("name",D.name);if(n)throw n;o&&o.length>0&&(e.push(...o),o.forEach((e=>t.add(e.company_id))));const i=D.name.split(" ").filter((e=>e.length>3));if(i.length>0){const o=i.map((e=>s.supabase.from("companies").select("*").neq("company_id",r.company_id).ilike("name",`%${e}%`).limit(5))),n=(await Promise.all(o)).flatMap((e=>e.data||[]));for(const r of n)t.has(r.company_id)||(e.push(r),t.add(r.company_id))}}if(D.website){const o=D.website.replace(/^https?:\/\//,"").replace(/^www\./,"").split("/")[0].toLowerCase();if(o&&o.length>3){const{data:n,error:i}=await s.supabase.from("companies").select("*").neq("company_id",r.company_id);if(i)throw i;const a=n.filter((e=>{if(!e.website)return!1;const t=e.website.replace(/^https?:\/\//,"").replace(/^www\./,"").split("/")[0].toLowerCase();return t===o||t.includes(o)||o.includes(t)}));for(const o of a)t.has(o.company_id)||(e.push(o),t.add(o.company_id))}}e=e.slice(0,20),q(e)}catch(e){console.error("Error checking for duplicates:",e),c.Ay.error("Failed to check for duplicates")}finally{Y(!1)}}},re=(e,t)=>{P((o=>({...o,[e]:t})))},ie=async e=>{try{if(N.some((t=>t.tag_id===e.tag_id)))return;const{data:t,error:o}=await s.supabase.from("company_tags").insert({company_id:r.company_id,tag_id:e.tag_id}).select();if(o)throw o;I([...N,{id:t[0].entry_id,tag_id:e.tag_id,name:e.name}]),L(""),H(!1)}catch(t){console.error("Error adding tag:",t),c.Ay.error("Failed to add tag")}},ae=async()=>{if(M.trim())try{const{data:e,error:t}=await s.supabase.from("tags").select("tag_id, name").eq("name",M.trim());if(t)throw t;let o;if(e&&e.length>0)o=e[0];else{const{data:e,error:t}=await s.supabase.from("tags").insert({name:M.trim()}).select().single();if(t)throw t;o=e}await ie(o)}catch(e){console.error("Error creating tag:",e),c.Ay.error("Failed to create tag")}},se=async()=>{try{const{error:e}=await s.supabase.from("companies").update({name:D.name,website:D.website,linkedin:D.linkedin,category:D.category,description:D.description,last_modified_at:new Date,last_modified_by:"User"}).eq("company_id",r.company_id);if(e)throw e;if(a){const{error:e}=await s.supabase.from("contact_companies").update({relationship:D.relationship}).eq("contact_id",a).eq("company_id",r.company_id);if(e)throw e}c.Ay.success("Company updated successfully"),R(),o()}catch(e){console.error("Error saving company:",e),c.Ay.error("Failed to update company")}};return(0,d.jsx)(d.Fragment,{children:(0,d.jsxs)(i(),{isOpen:t,onRequestClose:o,style:{content:{top:"50%",left:"50%",right:"auto",bottom:"auto",marginRight:"-50%",transform:"translate(-50%, -50%)",padding:0,border:"1px solid #444",borderRadius:"8px",backgroundColor:"#111",color:"#fff",boxShadow:"0 4px 20px rgba(0, 0, 0, 0.5)",width:"900px",height:"600px",overflow:"hidden"},overlay:{backgroundColor:"rgba(0, 0, 0, 0.7)",zIndex:1e3}},children:[(0,d.jsx)(A,{isOpen:Q,onRequestClose:()=>Z(!1),companyId:null===r||void 0===r?void 0:r.company_id,onContactAdded:()=>{oe()}}),(0,d.jsxs)(u,{children:[(0,d.jsxs)(p,{children:[(0,d.jsxs)(f,{active:"edit"===O,onClick:()=>T("edit"),children:[(0,d.jsx)(l.WXf,{size:18})," Edit Company"]}),(0,d.jsxs)(f,{active:"related"===O,onClick:()=>T("related"),children:[(0,d.jsx)(l.cfS,{size:18})," Related Contacts"]}),(0,d.jsxs)(f,{active:"duplicates"===O,onClick:()=>T("duplicates"),children:[(0,d.jsx)(l.nxz,{size:18})," Duplicates"]})]}),(0,d.jsxs)(h,{children:[(0,d.jsxs)(C,{children:[(0,d.jsx)(_,{style:{display:"flex",alignItems:"center"},children:"edit"===O?(0,d.jsx)(d.Fragment,{children:J?(0,d.jsx)("input",{type:"text",value:D.name||"",onChange:e=>re("name",e.target.value),onBlur:()=>X(!1),onKeyDown:e=>{("Enter"===e.key||"Escape"===e.key)&&X(!1)},autoFocus:!0,style:{background:"transparent",border:"none",borderBottom:"1px solid #00ff00",color:"#fff",fontSize:"20px",fontWeight:"500",padding:"2px 0",width:"100%",maxWidth:"300px",outline:"none"}}):(0,d.jsxs)("span",{style:{display:"inline-block",borderBottom:"1px dotted #00ff00",padding:"2px",cursor:"pointer"},onClick:()=>X(!0),children:[D.name||"Unnamed Company"," ",(0,d.jsx)(l.SG1,{size:14,style:{verticalAlign:"middle",marginLeft:"5px"}})]})}):"related"===O?`${D.name||"Company"} - Related Contacts`:`${D.name||"Company"} - Duplicates`}),(0,d.jsx)(S,{onClick:o,children:(0,d.jsx)(l.yGN,{size:20})})]}),(()=>{switch(O){case"edit":return(0,d.jsxs)(d.Fragment,{children:[(0,d.jsxs)(g,{children:[(0,d.jsx)(m,{children:"Description"}),(0,d.jsx)(b,{value:D.description||"",onChange:e=>re("description",e.target.value),placeholder:"Enter company description..."})]}),(0,d.jsxs)("div",{style:{display:"flex",gap:"15px"},children:[(0,d.jsxs)(g,{style:{flex:1},children:[(0,d.jsx)(m,{children:"Domain"}),(0,d.jsx)(y,{type:"text",value:D.website||"",onChange:e=>re("website",e.target.value),placeholder:"e.g. example.com"})]}),(0,d.jsxs)(g,{style:{flex:1},children:[(0,d.jsx)(m,{children:"LinkedIn URL"}),(0,d.jsx)(y,{type:"text",value:D.linkedin||"",onChange:e=>re("linkedin",e.target.value),placeholder:"e.g. linkedin.com/company/example"})]})]}),(0,d.jsxs)("div",{style:{display:"flex",gap:"15px"},children:[(0,d.jsxs)(g,{style:{flex:1},children:[(0,d.jsx)(m,{children:"Category"}),(0,d.jsx)(v,{value:D.category||"",onChange:e=>re("category",e.target.value),children:k.map((e=>(0,d.jsx)("option",{value:e,children:e},e)))})]}),a&&(0,d.jsxs)(g,{style:{flex:1},children:[(0,d.jsx)(m,{children:"Relationship"}),(0,d.jsx)(v,{value:D.relationship||"not_set",onChange:e=>re("relationship",e.target.value),children:j.map((e=>(0,d.jsx)("option",{value:e,children:"not_set"===e?"Not Set":e.charAt(0).toUpperCase()+e.slice(1)},e)))})]})]}),(0,d.jsxs)(g,{children:[(0,d.jsx)(m,{children:"Tags"}),(0,d.jsxs)("div",{style:{position:"relative"},children:[(0,d.jsx)(y,{type:"text",value:M,onChange:e=>(async e=>{if(L(e),e.length<2)return G([]),void H(!1);try{const{data:t,error:o}=await s.supabase.from("tags").select("tag_id, name").ilike("name",`%${e}%`).limit(10);if(o)throw o;const n=t.filter((e=>!N.some((t=>t.tag_id===e.tag_id))));G(n),H(!0)}catch(t){console.error("Error searching tags:",t)}})(e.target.value),placeholder:"Search or add tags..."}),z&&F.length>0&&(0,d.jsx)("div",{style:{position:"absolute",top:"100%",left:0,width:"100%",background:"#333",border:"1px solid #444",borderRadius:"4px",zIndex:10,marginTop:"4px",maxHeight:"200px",overflowY:"auto"},children:F.map((e=>(0,d.jsx)("div",{style:{padding:"8px 12px",borderBottom:"1px solid #444",cursor:"pointer"},onClick:()=>ie(e),children:e.name},e.tag_id)))}),z&&M.trim()&&!F.find((e=>e.name.toLowerCase()===M.toLowerCase()))&&(0,d.jsx)("div",{style:{position:"absolute",top:"100%",left:0,width:"100%",background:"#333",border:"1px solid #444",borderRadius:"4px",zIndex:10,marginTop:"4px",padding:"8px 12px"},children:(0,d.jsxs)("button",{style:{display:"flex",alignItems:"center",gap:"8px",background:"transparent",color:"#00ff00",border:"none",padding:"4px 0",cursor:"pointer",fontSize:"14px"},onClick:ae,children:[(0,d.jsx)(l.GGD,{size:16}),' Create "',M,'" tag']})})]})]}),(0,d.jsx)("div",{style:{display:"flex",flexWrap:"wrap",gap:"6px",marginTop:"10px",marginBottom:"20px"},children:N.length>0?N.map((e=>(0,d.jsxs)("div",{style:{display:"inline-flex",alignItems:"center",gap:"4px",padding:"2px 6px",fontSize:"0.7rem",borderRadius:"3px",border:"1px solid #00ff00",color:"#00ff00"},children:[e.name,(0,d.jsx)("span",{onClick:()=>(async e=>{try{const{error:t}=await s.supabase.from("company_tags").delete().eq("entry_id",e);if(t)throw t;I(N.filter((t=>t.id!==e)))}catch(t){console.error("Error removing tag:",t),c.Ay.error("Failed to remove tag")}})(e.id),style:{cursor:"pointer",display:"inline-flex",alignItems:"center"},children:(0,d.jsx)(l.yGN,{size:10})})]},e.id))):(0,d.jsx)("div",{style:{color:"#999",fontSize:"14px"},children:"No tags added"})}),(0,d.jsxs)(x,{children:[(0,d.jsx)(w,{className:"cancel",onClick:o,children:"Cancel"}),(0,d.jsxs)(w,{className:"primary",onClick:se,children:[(0,d.jsx)(l.Bc_,{size:16})," Save Changes"]})]})]});case"related":return(0,d.jsxs)("div",{style:{minHeight:"400px",display:"flex",flexDirection:"column"},children:[(0,d.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"15px"},children:[(0,d.jsx)(m,{children:"Related Contacts"}),(0,d.jsxs)(w,{className:"primary",style:{padding:"5px 10px",fontSize:"12px"},onClick:()=>Z(!0),children:[(0,d.jsx)(l.vq3,{size:14})," Add Contact"]})]}),$?(0,d.jsx)("div",{style:{textAlign:"center",padding:"30px",flex:1,display:"flex",alignItems:"center",justifyContent:"center"},children:"Loading related contacts..."}):B.length>0?(0,d.jsx)("div",{style:{overflowX:"auto",flex:1},children:(0,d.jsxs)("table",{style:{width:"100%",borderCollapse:"collapse",marginTop:"12px",tableLayout:"fixed"},children:[(0,d.jsx)("thead",{children:(0,d.jsxs)("tr",{style:{background:"#333"},children:[(0,d.jsx)("th",{style:{padding:"10px",textAlign:"left",color:"#00ff00",fontSize:"14px",borderBottom:"1px solid #444",width:"30%"},children:"Name"}),(0,d.jsx)("th",{style:{padding:"10px",textAlign:"left",color:"#00ff00",fontSize:"14px",borderBottom:"1px solid #444",width:"30%"},children:"Job Role"}),(0,d.jsx)("th",{style:{padding:"10px",textAlign:"left",color:"#00ff00",fontSize:"14px",borderBottom:"1px solid #444",width:"30%"},children:"Relationship"}),(0,d.jsx)("th",{style:{padding:"10px",textAlign:"center",color:"#00ff00",fontSize:"14px",borderBottom:"1px solid #444",width:"10%"},children:"Actions"})]})}),(0,d.jsx)("tbody",{children:B.map((e=>(0,d.jsxs)("tr",{style:{borderBottom:"1px solid #333"},children:[(0,d.jsx)("td",{style:{padding:"10px",fontSize:"14px",whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis"},children:e.name||"Unnamed"}),(0,d.jsx)("td",{style:{padding:"10px",fontSize:"14px",whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis"},children:e.job_role||"\u2014"}),(0,d.jsx)("td",{style:{padding:"10px",fontSize:"14px",whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis"},children:"not_set"===e.relationship?"Not Set":e.relationship.charAt(0).toUpperCase()+e.relationship.slice(1)}),(0,d.jsx)("td",{style:{padding:"10px",textAlign:"center"},children:(0,d.jsx)("div",{style:{display:"flex",justifyContent:"center",gap:"10px"},children:(0,d.jsx)("button",{style:{background:"transparent",border:"none",color:"#00ff00",cursor:"pointer"},title:"View Contact",children:(0,d.jsx)(l.HaR,{size:16})})})})]},e.id)))})]})}):(0,d.jsx)("div",{style:{flex:1,display:"flex",alignItems:"center",justifyContent:"center"},children:(0,d.jsx)(E,{children:"No related contacts found"})}),(0,d.jsx)(x,{children:(0,d.jsx)(w,{className:"cancel",onClick:o,children:"Close"})})]});case"duplicates":return(0,d.jsxs)("div",{style:{minHeight:"400px",display:"flex",flexDirection:"column"},children:[(0,d.jsx)(g,{children:(0,d.jsx)(m,{children:"Possible Duplicate Companies"})}),K?(0,d.jsx)("div",{style:{textAlign:"center",padding:"30px",flex:1,display:"flex",alignItems:"center",justifyContent:"center"},children:"Checking for duplicates..."}):W.length>0?(0,d.jsx)("div",{style:{overflowX:"auto",flex:1},children:(0,d.jsxs)("table",{style:{width:"100%",borderCollapse:"collapse",marginTop:"12px",tableLayout:"fixed"},children:[(0,d.jsx)("thead",{children:(0,d.jsxs)("tr",{style:{background:"#333"},children:[(0,d.jsx)("th",{style:{padding:"10px",textAlign:"left",color:"#00ff00",fontSize:"14px",borderBottom:"1px solid #444",width:"35%"},children:"Name"}),(0,d.jsx)("th",{style:{padding:"10px",textAlign:"left",color:"#00ff00",fontSize:"14px",borderBottom:"1px solid #444",width:"30%"},children:"Website"}),(0,d.jsx)("th",{style:{padding:"10px",textAlign:"left",color:"#00ff00",fontSize:"14px",borderBottom:"1px solid #444",width:"25%"},children:"Category"}),(0,d.jsx)("th",{style:{padding:"10px",textAlign:"center",color:"#00ff00",fontSize:"14px",borderBottom:"1px solid #444",width:"10%"},children:"Actions"})]})}),(0,d.jsx)("tbody",{children:W.map((e=>(0,d.jsxs)("tr",{style:{borderBottom:"1px solid #333"},children:[(0,d.jsx)("td",{style:{padding:"10px",fontSize:"14px",whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis"},children:e.name||"Unnamed"}),(0,d.jsx)("td",{style:{padding:"10px",fontSize:"14px",whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis"},children:e.website||"\u2014"}),(0,d.jsx)("td",{style:{padding:"10px",fontSize:"14px",whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis"},children:e.category||"\u2014"}),(0,d.jsx)("td",{style:{padding:"10px",textAlign:"center"},children:(0,d.jsxs)("div",{style:{display:"flex",justifyContent:"center",gap:"10px"},children:[(0,d.jsx)("button",{style:{background:"transparent",border:"none",color:"#00ff00",cursor:"pointer"},title:"View Company",children:(0,d.jsx)(l.HaR,{size:16})}),(0,d.jsx)("button",{onClick:()=>(async e=>{if(window.confirm("Are you sure you want to merge these companies? This action cannot be undone."))try{c.Ay.loading("Merging companies...");const[t,o]=await Promise.all([s.supabase.from("company_tags").select("\n            tag_id,\n            tags (name)\n          ").eq("company_id",e),s.supabase.from("contact_companies").select("\n            contact_id,\n            relationship\n          ").eq("company_id",e)]);if(t.error)throw t.error;if(o.error)throw o.error;if(t.data&&t.data.length>0){const{data:e,error:o}=await s.supabase.from("company_tags").select("tag_id").eq("company_id",r.company_id);if(o)throw o;const n=new Set(e.map((e=>e.tag_id))),i=t.data.filter((e=>!n.has(e.tag_id)));if(i.length>0){const e=i.map((e=>({company_id:r.company_id,tag_id:e.tag_id}))),{error:t}=await s.supabase.from("company_tags").insert(e);if(t)throw t}}if(o.data&&o.data.length>0){const{data:t,error:n}=await s.supabase.from("contact_companies").select("contact_id").eq("company_id",r.company_id);if(n)throw n;const i=new Set(t.map((e=>e.contact_id))),a=o.data.filter((e=>!i.has(e.contact_id)));if(a.length>0)for(const o of a){const{error:t}=await s.supabase.from("contact_companies").update({company_id:r.company_id}).eq("contact_id",o.contact_id).eq("company_id",e);if(t)throw t}}const{error:n}=await s.supabase.from("companies").update({name:`[MERGED] ${D.name}`,last_modified_at:new Date,last_modified_by:"User"}).eq("company_id",e);if(n)throw n;c.Ay.dismiss(),c.Ay.success("Companies merged successfully"),ne(),ee(),te()}catch(t){console.error("Error merging companies:",t),c.Ay.dismiss(),c.Ay.error("Failed to merge companies")}})(e.company_id),style:{background:"transparent",border:"none",color:"#00ff00",cursor:"pointer"},title:"Merge this company into current company",children:(0,d.jsx)(l.EPw,{size:16})})]})})]},e.company_id)))})]})}):(0,d.jsx)("div",{style:{flex:1,display:"flex",alignItems:"center",justifyContent:"center"},children:(0,d.jsx)(E,{children:"No possible duplicates found"})}),(0,d.jsx)(x,{children:(0,d.jsx)(w,{className:"cancel",onClick:o,children:"Close"})})]});default:return null}})()]})]})]})})}},6062:(e,t,o)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.resetState=function(){for(var e=[a,s],t=0;t<e.length;t++){var o=e[t];o&&(o.parentNode&&o.parentNode.removeChild(o))}a=s=null,l=[]},t.log=function(){console.log("bodyTrap ----------"),console.log(l.length);for(var e=[a,s],t=0;t<e.length;t++){var o=e[t]||{};console.log(o.nodeName,o.className,o.id)}console.log("edn bodyTrap ----------")};var n,r=o(2959),i=(n=r)&&n.__esModule?n:{default:n};var a=void 0,s=void 0,l=[];function c(){0!==l.length&&l[l.length-1].focusContent()}i.default.subscribe((function(e,t){a||s||((a=document.createElement("div")).setAttribute("data-react-modal-body-trap",""),a.style.position="absolute",a.style.opacity="0",a.setAttribute("tabindex","0"),a.addEventListener("focus",c),(s=a.cloneNode()).addEventListener("focus",c)),(l=t).length>0?(document.body.firstChild!==a&&document.body.insertBefore(a,document.body.firstChild),document.body.lastChild!==s&&document.body.appendChild(s)):(a.parentElement&&a.parentElement.removeChild(a),s.parentElement&&s.parentElement.removeChild(s))}))},6260:(e,t,o)=>{"use strict";o.d(t,{A:()=>i});var n=o(2284),r=o(3666);function i(e){(0,r.A)(1,arguments);var t=Object.prototype.toString.call(e);return e instanceof Date||"object"===(0,n.A)(e)&&"[object Date]"===t?new Date(e.getTime()):"number"===typeof e||"[object Number]"===t?new Date(e):("string"!==typeof e&&"[object String]"!==t||"undefined"===typeof console||(console.warn("Starting with v2.0.0-beta.1 date-fns doesn't accept strings as date arguments. Please use `parseISO` to parse strings. See: https://github.com/date-fns/date-fns/blob/master/docs/upgradeGuide.md#string-arguments"),console.warn((new Error).stack)),new Date(NaN))}},6325:function(e,t,o){"use strict";var n=this&&this.__createBinding||(Object.create?function(e,t,o,n){void 0===n&&(n=o),Object.defineProperty(e,n,{enumerable:!0,get:function(){return t[o]}})}:function(e,t,o,n){void 0===n&&(n=o),e[n]=t[o]}),r=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),i=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var o in e)"default"!==o&&Object.prototype.hasOwnProperty.call(e,o)&&n(t,e,o);return r(t,e),t},a=this&&this.__spreadArrays||function(){for(var e=0,t=0,o=arguments.length;t<o;t++)e+=arguments[t].length;var n=Array(e),r=0;for(t=0;t<o;t++)for(var i=arguments[t],a=0,s=i.length;a<s;a++,r++)n[r]=i[a];return n},s=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var l=o(7079),c=i(o(5043)),d=o(8242),u=s(o(7355)),p=s(o(9262)),h=o(9201),f=o(9724);t.default=c.memo((function(e){var t=c.useContext(h.BeansContext).context,o=c.useState([]),n=o[0],r=o[1],i=e.name,s=c.useMemo((function(){return l.getRowContainerTypeForName(i)}),[i]),g=c.useRef(null),m=c.useRef(null),y=c.useRef(null),v=c.useRef([]),b=c.useRef(!1),x=c.useMemo((function(){return l.RowContainerCtrl.getRowContainerCssClasses(i)}),[i]),w=c.useMemo((function(){return d.classesList(x.wrapper)}),[]),C=c.useMemo((function(){return d.classesList(x.viewport)}),[]),_=c.useMemo((function(){return d.classesList(x.container)}),[]),S=i===l.RowContainerName.CENTER,E=i===l.RowContainerName.TOP_CENTER||i===l.RowContainerName.BOTTOM_CENTER||i===l.RowContainerName.STICKY_TOP_CENTER,k=!S&&!E,j=S?g:E?m:y;function A(e){d.agFlushSync(e,(function(){r((function(e){var t=v.current;if(b.current)return t;var o=e.filter((function(e){return t.indexOf(e)>=0})),n=t.filter((function(e){return o.indexOf(e)<0}));return a(o,n)}))}))}u.default(" AG Row Container "+i+" ",j),f.useLayoutEffectOnce((function(){var e=[],o={setViewportHeight:function(e){return m.current.style.height=e},setRowCtrls:function(e,t){if(v.current!==e){var o=t&&v.current.length>0&&e.length>0;v.current=e,A(o)}},setDomOrder:function(e){b.current!=e&&(b.current=e,A(!1))},setContainerWidth:function(e){return y.current.style.width=e}},n=t.createBean(new l.RowContainerCtrl(i));return e.push(n),n.setComp(o,y.current,m.current,g.current),function(){t.destroyBeans(e)}}));var R=function(){return c.default.createElement("div",{className:_,ref:y,role:n.length?"rowgroup":"presentation"},n.map((function(e){return c.default.createElement(p.default,{rowCtrl:e,containerType:s,key:e.getInstanceId()})})))};return c.default.createElement(c.default.Fragment,null,S&&c.default.createElement("div",{className:w,ref:g,role:"presentation"},c.default.createElement("div",{className:C,ref:m,role:"presentation"},R())),E&&c.default.createElement("div",{className:C,ref:m,role:"presentation"},R()),k&&R())}))},6440:e=>{"use strict";var t=function(){};e.exports=t},6619:(e,t,o)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.resetState=function(){s&&(s.removeAttribute?s.removeAttribute("aria-hidden"):null!=s.length?s.forEach((function(e){return e.removeAttribute("aria-hidden")})):document.querySelectorAll(s).forEach((function(e){return e.removeAttribute("aria-hidden")})));s=null},t.log=function(){0},t.assertNodeList=l,t.setElement=function(e){var t=e;if("string"===typeof t&&a.canUseDOM){var o=document.querySelectorAll(t);l(o,t),t=o}return s=t||s},t.validateElement=c,t.hide=function(e){var t=!0,o=!1,n=void 0;try{for(var r,i=c(e)[Symbol.iterator]();!(t=(r=i.next()).done);t=!0){r.value.setAttribute("aria-hidden","true")}}catch(a){o=!0,n=a}finally{try{!t&&i.return&&i.return()}finally{if(o)throw n}}},t.show=function(e){var t=!0,o=!1,n=void 0;try{for(var r,i=c(e)[Symbol.iterator]();!(t=(r=i.next()).done);t=!0){r.value.removeAttribute("aria-hidden")}}catch(a){o=!0,n=a}finally{try{!t&&i.return&&i.return()}finally{if(o)throw n}}},t.documentNotReadyOrSSRTesting=function(){s=null};var n,r=o(6440),i=(n=r)&&n.__esModule?n:{default:n},a=o(8821);var s=null;function l(e,t){if(!e||!e.length)throw new Error("react-modal: No elements were found for selector "+t+".")}function c(e){var t=e||s;return t?Array.isArray(t)||t instanceof HTMLCollection||t instanceof NodeList?t:[t]:((0,i.default)(!1,["react-modal: App element is not defined.","Please use `Modal.setAppElement(el)` or set `appElement={el}`.","This is needed so screen readers don't see main content","when modal is opened. It is not recommended, but you can opt-out","by setting `ariaHideApp={false}`."].join(" ")),[])}},6688:(e,t,o)=>{"use strict";o.d(t,{k5:()=>c});var n=o(5043),r={color:void 0,size:void 0,className:void 0,style:void 0,attr:void 0},i=n.createContext&&n.createContext(r),a=function(){return a=Object.assign||function(e){for(var t,o=1,n=arguments.length;o<n;o++)for(var r in t=arguments[o])Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e},a.apply(this,arguments)},s=function(e,t){var o={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(o[n]=e[n]);if(null!=e&&"function"===typeof Object.getOwnPropertySymbols){var r=0;for(n=Object.getOwnPropertySymbols(e);r<n.length;r++)t.indexOf(n[r])<0&&Object.prototype.propertyIsEnumerable.call(e,n[r])&&(o[n[r]]=e[n[r]])}return o};function l(e){return e&&e.map((function(e,t){return n.createElement(e.tag,a({key:t},e.attr),l(e.child))}))}function c(e){return function(t){return n.createElement(d,a({attr:a({},e.attr)},t),l(e.child))}}function d(e){var t=function(t){var o,r=e.attr,i=e.size,l=e.title,c=s(e,["attr","size","title"]),d=i||t.size||"1em";return t.className&&(o=t.className),e.className&&(o=(o?o+" ":"")+e.className),n.createElement("svg",a({stroke:"currentColor",fill:"currentColor",strokeWidth:"0"},t.attr,r,c,{className:o,style:a(a({color:e.color||t.color},t.style),e.style),height:d,width:d,xmlns:"http://www.w3.org/2000/svg"}),l&&n.createElement("title",null,l),e.children)};return void 0!==i?n.createElement(i.Consumer,null,(function(e){return t(e)})):t(r)}},6825:function(e,t,o){"use strict";var n=this&&this.__createBinding||(Object.create?function(e,t,o,n){void 0===n&&(n=o),Object.defineProperty(e,n,{enumerable:!0,get:function(){return t[o]}})}:function(e,t,o,n){void 0===n&&(n=o),e[n]=t[o]}),r=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),i=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var o in e)"default"!==o&&Object.prototype.hasOwnProperty.call(e,o)&&n(t,e,o);return r(t,e),t},a=this&&this.__spreadArrays||function(){for(var e=0,t=0,o=arguments.length;t<o;t++)e+=arguments[t].length;var n=Array(e),r=0;for(t=0;t<o;t++)for(var i=arguments[t],a=0,s=i.length;a<s;a++,r++)n[r]=i[a];return n},s=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var l=o(7079),c=i(o(5043)),d=o(9201),u=s(o(9139)),p=s(o(9426)),h=s(o(8293)),f=o(9724);t.default=c.memo((function(e){var t=c.useContext(d.BeansContext).gridOptionsService,o=c.useState(),n=o[0],r=o[1],i=c.useState(),s=i[0],g=i[1],m=c.useState(),y=m[0],v=m[1],b=c.useState(),x=b[0],w=b[1],C=c.useState([]),_=C[0],S=C[1],E=c.useRef(null),k=e.ctrl,j=k.getType()===l.HeaderRowType.COLUMN,A=k.getType()===l.HeaderRowType.COLUMN_GROUP,R=k.getType()===l.HeaderRowType.FLOATING_FILTER,O=c.useCallback((function(e,o){var n=t.is("ensureDomOrder"),r=t.isDomLayout("print");if(n||r)return o;var i=l._.mapById(e,(function(e){return e.getInstanceId()})),s=l._.mapById(o,(function(e){return e.getInstanceId()})),c=e.filter((function(e){return s.has(e.getInstanceId())})),d=o.filter((function(e){return!i.has(e.getInstanceId())}));return a(c,d)}),[]);f.useLayoutEffectOnce((function(){var e={setTransform:function(e){return r(e)},setHeight:function(e){return g(e)},setTop:function(e){return v(e)},setHeaderCtrls:function(e){return S((function(t){return O(t,e)}))},setWidth:function(e){return E.current.style.width=e},setAriaRowIndex:function(e){return w(e)}};k.setComp(e)}));var T=c.useMemo((function(){return{transform:n,height:s,top:y}}),[n,s,y]),D=c.useMemo((function(){var e=["ag-header-row"];return j&&e.push("ag-header-row-column"),A&&e.push("ag-header-row-column-group"),R&&e.push("ag-header-row-column-filter"),e.join(" ")}),[]),P=c.useCallback((function(e){switch(k.getType()){case l.HeaderRowType.COLUMN_GROUP:return c.default.createElement(p.default,{ctrl:e,key:e.getInstanceId()});case l.HeaderRowType.FLOATING_FILTER:return c.default.createElement(h.default,{ctrl:e,key:e.getInstanceId()});default:return c.default.createElement(u.default,{ctrl:e,key:e.getInstanceId()})}}),[]);return c.default.createElement("div",{ref:E,className:D,role:"row",style:T,"aria-rowindex":x},_.map(P))}))},6885:(e,t,o)=>{"use strict";var n,r;n=o(2160),r=o(8556),t.version=n.version,t.renderToString=n.renderToString,t.renderToStaticMarkup=n.renderToStaticMarkup,t.renderToNodeStream=n.renderToNodeStream,t.renderToStaticNodeStream=n.renderToStaticNodeStream,t.renderToReadableStream=r.renderToReadableStream},7079:(e,t,o)=>{"use strict";function n(e){return null==e||""===e?null:e}function r(e,t){return void 0===t&&(t=!1),null!=e&&(""!==e||t)}function i(e){return!r(e)}function a(e){return null==e||0===e.length}function s(e){return null!=e&&"function"===typeof e.toString?e.toString():null}function l(e){if(void 0!==e){if(null===e||""===e)return null;if("number"===typeof e)return isNaN(e)?void 0:e;var t=parseInt(e,10);return isNaN(t)?void 0:t}}function c(e){if(void 0!==e)return null!==e&&""!==e&&("boolean"===typeof e?e:/true/i.test(e))}function d(e){if(e instanceof Set||e instanceof Map){var t=[];return e.forEach((function(e){return t.push(e)})),t}return Object.values(e)}o.r(t),o.d(t,{AbstractHeaderCellCtrl:()=>md,AgAbstractField:()=>Hr,AgAbstractLabel:()=>Gr,AgCheckbox:()=>ti,AgDialog:()=>Wp,AgGroupComponent:()=>wp,AgInputNumberField:()=>Ai,AgInputRange:()=>gp,AgInputTextArea:()=>hp,AgInputTextField:()=>ki,AgMenuItemComponent:()=>Gp,AgMenuList:()=>Pp,AgMenuPanel:()=>Mp,AgPanel:()=>Bp,AgPickerField:()=>$r,AgPromise:()=>rr,AgPromiseStatus:()=>Qn,AgRadioButton:()=>ni,AgSelect:()=>Jr,AgSlider:()=>vp,AgStackComponentsRegistry:()=>Gt,AgToggleButton:()=>up,AlignedGridsService:()=>xh,AllCommunityModules:()=>ly,AnimateShowChangeCellRenderer:()=>va,AnimateSlideCellRenderer:()=>wa,AnimationFrameService:()=>ju,AutoScrollService:()=>Zs,AutoWidthCalculator:()=>Ou,Autowired:()=>q,BarColumnLabelPlacement:()=>Gg,BaseComponentWrapper:()=>Xg,BaseCreator:()=>Um,BaseGridSerializingSession:()=>Wm,Bean:()=>W,BeanStub:()=>Fe,Beans:()=>_l,BodyDropPivotTarget:()=>qc,BodyDropTarget:()=>Zc,CHART_TOOLBAR_ALLOW_LIST:()=>em,CHART_TOOL_PANEL_ALLOW_LIST:()=>Zg,CHART_TOOL_PANEL_MENU_OPTIONS:()=>tm,CellComp:()=>Fc,CellCtrl:()=>Nl,CellNavigationService:()=>mh,CellPositionUtils:()=>Kf,CellRangeType:()=>cl,ChangedPath:()=>Xu,CheckboxSelectionComponent:()=>ja,ClientSideRowModelModule:()=>Pm,ClientSideRowModelSteps:()=>As,ColDefUtil:()=>Ve,Column:()=>ce,ColumnApi:()=>Ah,ColumnFactory:()=>Be,ColumnGroup:()=>ct,ColumnKeyCreator:()=>p,ColumnModel:()=>Ot,ColumnUtils:()=>Pt,Component:()=>fr,ComponentUtil:()=>Xe,Context:()=>B,CssClassApplier:()=>od,CssClassManager:()=>dr,CsvCreator:()=>Qm,CsvExportModule:()=>oy,CtrlsService:()=>yg,CustomTooltipFeature:()=>cr,DEFAULT_CHART_GROUPS:()=>Qg,DateFilter:()=>mi,DisplayedGroupCreator:()=>Mt,Downloader:()=>qm,DragAndDropService:()=>Da,DragService:()=>Ts,DragSourceType:()=>Di,Environment:()=>Rf,EventService:()=>te,Events:()=>$e,ExcelFactoryMode:()=>Ta,ExpressionService:()=>Ih,FilterManager:()=>Gs,FloatingFilterMapper:()=>_s,FocusService:()=>Qp,GROUP_AUTO_COLUMN_ID:()=>ht,Grid:()=>Yg,GridApi:()=>Is,GridBodyComp:()=>_c,GridBodyCtrl:()=>pl,GridComp:()=>Yh,GridCoreCreator:()=>Jg,GridCtrl:()=>Wh,GridHeaderComp:()=>du,GridHeaderCtrl:()=>su,GridOptionsService:()=>zg,GridSerializer:()=>ty,GroupCellRenderer:()=>Ua,GroupCellRendererCtrl:()=>Ba,GroupInstanceIdCreator:()=>dt,HeaderCellCtrl:()=>Nd,HeaderFilterCellComp:()=>$s,HeaderFilterCellCtrl:()=>Ed,HeaderGroupCellCtrl:()=>Vd,HeaderNavigationDirection:()=>ud,HeaderNavigationService:()=>ru,HeaderPositionUtils:()=>sg,HeaderRowComp:()=>pd,HeaderRowContainerComp:()=>tu,HeaderRowContainerCtrl:()=>Qd,HeaderRowCtrl:()=>qd,HeaderRowType:()=>$c,HorizontalDirection:()=>Ni,HorizontalResizeService:()=>hu,InfiniteRowModelModule:()=>$m,KeyCode:()=>Hn,LargeTextCellEditor:()=>ca,LayoutCssClasses:()=>Ns,LocaleService:()=>Vg,Logger:()=>Vh,LoggerFactory:()=>Bh,ManagedFocusFeature:()=>Ar,ModuleNames:()=>Q,ModuleRegistry:()=>ne,MouseEventService:()=>Rc,MoveColumnFeature:()=>Jc,NavigationService:()=>Pc,NumberFilter:()=>Ii,NumberSequence:()=>or,Optional:()=>K,PaginationProxy:()=>ap,PinnedRowModel:()=>Yu,PopupComponent:()=>aa,PopupEditorWrapper:()=>Mc,PopupService:()=>ih,PositionableFeature:()=>Pr,PostConstruct:()=>$,PreConstruct:()=>V,PreDestroy:()=>U,PropertyKeys:()=>qe,ProvidedColumnGroup:()=>ue,ProvidedFilter:()=>Mr,Qualifier:()=>J,QuerySelector:()=>gr,RefSelector:()=>mr,ResizeObserverService:()=>Su,RowAnimationCssClasses:()=>qs,RowContainerComp:()=>Uc,RowContainerCtrl:()=>bc,RowContainerName:()=>Gl,RowContainerType:()=>zl,RowCtrl:()=>Bl,RowHighlightPosition:()=>js,RowNode:()=>_a,RowNodeBlock:()=>Zu,RowNodeBlockLoader:()=>np,RowNodeSorter:()=>fg,RowPositionUtils:()=>Uf,RowRenderer:()=>Bu,RowType:()=>pm,ScalarFilter:()=>di,ScrollVisibleService:()=>kc,SelectCellEditor:()=>pa,SelectableService:()=>Mf,SelectionHandleType:()=>ll,ServerSideTransactionResultStatus:()=>wu,SetLeftFeature:()=>bd,SimpleFilter:()=>li,SortController:()=>ef,SortIndicatorComp:()=>Qi,StandardMenuFactory:()=>mu,StylingService:()=>cp,TabGuardClassNames:()=>Ju,TabGuardComp:()=>Rp,TabGuardCtrl:()=>Ep,TabbedLayout:()=>bu,TemplateService:()=>Fh,TextCellEditor:()=>ga,TextFilter:()=>Gi,TextFloatingFilter:()=>Ki,Timer:()=>ir,TouchListener:()=>Yi,UserComponentFactory:()=>ks,UserComponentRegistry:()=>is,ValueCache:()=>hf,ValueFormatterService:()=>Wu,ValueService:()=>Th,VanillaFrameworkOverrides:()=>uh,VerticalDirection:()=>Pi,VirtualList:()=>lh,XmlFactory:()=>ry,ZipContainer:()=>sy,_:()=>tr,__FORCE_MODULE_DETECTION:()=>om,getRowContainerTypeForName:()=>gc,simpleHttpRequest:()=>xu});var u=Object.freeze({__proto__:null,makeNull:n,exists:r,missing:i,missingOrEmpty:a,toStringOrNull:s,attrToNumber:l,attrToBoolean:c,attrToString:function(e){if(null!=e&&""!==e)return e},referenceCompare:function(e,t){return null==e&&null==t||(null!=e||null==t)&&((null==e||null!=t)&&e===t)},jsonEquals:function(e,t){return(e?JSON.stringify(e):null)===(t?JSON.stringify(t):null)},defaultComparator:function(e,t,o){void 0===o&&(o=!1);var n=null==e,r=null==t;if(e&&e.toNumber&&(e=e.toNumber()),t&&t.toNumber&&(t=t.toNumber()),n&&r)return 0;if(n)return-1;if(r)return 1;function i(e,t){return e>t?1:e<t?-1:0}if("string"!==typeof e)return i(e,t);if(!o)return i(e,t);try{return e.localeCompare(t)}catch(a){return i(e,t)}},values:d}),p=function(){function e(){this.existingKeys={}}return e.prototype.addExistingKeys=function(e){for(var t=0;t<e.length;t++)this.existingKeys[e[t]]=!0},e.prototype.getUniqueKey=function(e,t){e=s(e);for(var o=0;;){var n=void 0;if(e?(n=e,0!==o&&(n+="_"+o)):t?(n=t,0!==o&&(n+="_"+o)):n=""+o,!this.existingKeys[n])return this.existingKeys[n]=!0,n;o++}},e}();function h(e,t){null!=e&&(Array.isArray(e)?e.forEach((function(e,o){return t(""+o,e)})):Object.keys(e).forEach((function(o){return t(o,e[o])})))}function f(e){for(var t={},o=Object.keys(e),n=0;n<o.length;n++){var r=o[n],i=e[r];t[r]=i}return t}function g(e,t){if(e){var o=e,n={};return Object.keys(o).forEach((function(e){if(!(t&&t.indexOf(e)>=0)){var r=o[e],i=S(r)&&r.constructor===Object;n[e]=i?g(r):r}})),n}}function m(e,t){return e[t]}function y(e,t,o){e[t]=o}function v(e,t,o,n){var r=m(e,o);void 0!==r&&y(t,o,n?n(r):r)}function b(e){var t={};return e.filter((function(e){return null!=e})).forEach((function(e){Object.keys(e).forEach((function(e){return t[e]=null}))})),Object.keys(t)}function x(e){if(!e)return[];var t=Object;if("function"===typeof t.values)return t.values(e);var o=[];for(var n in e)e.hasOwnProperty(n)&&e.propertyIsEnumerable(n)&&o.push(e[n]);return o}function w(e,t,o,n){void 0===o&&(o=!0),void 0===n&&(n=!1),r(t)&&h(t,(function(t,r){var i=e[t];if(i!==r){if(n)if(null==i&&null!=r)"object"===typeof r&&r.constructor===Object&&(i={},e[t]=i);S(r)&&S(i)&&!Array.isArray(i)?w(i,r,o,n):(o||void 0!==r)&&(e[t]=r)}}))}function C(e,t,o){if(t&&e){if(!o)return e[t];for(var n=t.split("."),r=e,i=0;i<n.length;i++){if(null==r)return;r=r[n[i]]}return r}}function _(e,t){Object.keys(e).forEach((function(t){"object"===typeof e[t]&&(e[t]=void 0)}));var o=Object.getPrototypeOf(e),n={};Object.keys(o).forEach((function(e){if("function"===typeof o[e]){n[e]={value:function(){console.warn("AG Grid: "+t+" function "+e+"() cannot be called as the grid has been destroyed.\n                     Please don't call grid API functions on destroyed grids - as a matter of fact you shouldn't\n                     be keeping the API reference, your application has a memory leak! Remove the API reference\n                     when the grid is destroyed.")},writable:!0}}})),Object.defineProperties(e,n)}function S(e){return"object"===typeof e&&null!==e}var E=Object.freeze({__proto__:null,iterateObject:h,cloneObject:f,deepCloneObject:function(e){return JSON.parse(JSON.stringify(e))},deepCloneDefinition:g,getProperty:m,setProperty:y,copyPropertiesIfPresent:function(e,t){for(var o=[],n=2;n<arguments.length;n++)o[n-2]=arguments[n];o.forEach((function(o){return v(e,t,o)}))},copyPropertyIfPresent:v,getAllKeysInObjects:b,getAllValuesInObject:x,mergeDeep:w,missingOrEmptyObject:function(e){return i(e)||0===Object.keys(e).length},get:function(e,t,o){if(null==e)return o;for(var n=t.split("."),r=e;n.length>1;)if(null==(r=r[n.shift()]))return o;var i=r[n[0]];return null!=i?i:o},set:function(e,t,o){if(null!=e){var n=t.split("."),r=e;n.forEach((function(e,t){r[e]||(r[e]={}),t<n.length-1&&(r=r[e])})),r[n[n.length-1]]=o}},getValueUsingField:C,removeAllReferences:_,isNonNullObject:S}),k={};function j(e,t){k[t]||(e(),k[t]=!0)}function A(e){if(e.name)return e.name;var t=/function\s+([^\(]+)/.exec(e.toString());return t&&2===t.length?t[1].trim():null}function R(e){return!!(e&&e.constructor&&e.call&&e.apply)}function O(e){N(e,400)}var T=[],D=!1;function P(e){T.push(e),D||(D=!0,window.setTimeout((function(){var e=T.slice();T.length=0,D=!1,e.forEach((function(e){return e()}))}),0))}function N(e,t){void 0===t&&(t=0),e.length>0&&window.setTimeout((function(){return e.forEach((function(e){return e()}))}),t)}function I(e,t){var o;return function(){for(var n=[],r=0;r<arguments.length;r++)n[r]=arguments[r];var i=this;window.clearTimeout(o),o=window.setTimeout((function(){e.apply(i,n)}),t)}}function M(e,t){var o=0;return function(){for(var n=[],r=0;r<arguments.length;r++)n[r]=arguments[r];var i=(new Date).getTime();i-o<t||(o=i,e.apply(this,n))}}function L(e,t,o,n){void 0===o&&(o=100);var r=(new Date).getTime(),i=null,a=!1,s=function(){var s=(new Date).getTime()-r>o;(e()||s)&&(t(),a=!0,null!=i&&(window.clearInterval(i),i=null),s&&n&&console.warn(n))};s(),a||(i=window.setInterval(s,10))}function F(e){e&&e()}var G=Object.freeze({__proto__:null,doOnce:j,getFunctionName:A,isFunction:R,executeInAWhile:O,executeNextVMTurn:P,executeAfter:N,debounce:I,throttle:M,waitUntil:L,compose:function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return function(t){return e.reduce((function(e,t){return t(e)}),t)}},callIfPresent:F,noop:function(){}}),z=function(e,t){var o="function"===typeof Symbol&&e[Symbol.iterator];if(!o)return e;var n,r,i=o.call(e),a=[];try{for(;(void 0===t||t-- >0)&&!(n=i.next()).done;)a.push(n.value)}catch(s){r={error:s}}finally{try{n&&!n.done&&(o=i.return)&&o.call(i)}finally{if(r)throw r.error}}return a},H=function(){for(var e=[],t=0;t<arguments.length;t++)e=e.concat(z(arguments[t]));return e},B=function(){function e(e,t){if(this.beanWrappers={},this.destroyed=!1,e&&e.beanClasses){this.contextParams=e,this.logger=t,this.logger.log(">> creating ag-Application Context"),this.createBeans();var o=this.getBeanInstances();this.wireBeans(o),this.logger.log(">> ag-Application Context ready - component is alive")}}return e.prototype.getBeanInstances=function(){return d(this.beanWrappers).map((function(e){return e.beanInstance}))},e.prototype.createBean=function(e,t){if(!e)throw Error("Can't wire to bean since it is null");return this.wireBeans([e],t),e},e.prototype.wireBeans=function(e,t){this.autoWireBeans(e),this.methodWireBeans(e),this.callLifeCycleMethods(e,"preConstructMethods"),r(t)&&e.forEach(t),this.callLifeCycleMethods(e,"postConstructMethods")},e.prototype.createBeans=function(){var e=this;this.contextParams.beanClasses.forEach(this.createBeanWrapper.bind(this)),h(this.beanWrappers,(function(t,o){var n;o.bean.__agBeanMetaData&&o.bean.__agBeanMetaData.autowireMethods&&o.bean.__agBeanMetaData.autowireMethods.agConstructor&&(n=o.bean.__agBeanMetaData.autowireMethods.agConstructor);var r=e.getBeansForParameters(n,o.bean.name),i=new(o.bean.bind.apply(o.bean,H([null],r)));o.beanInstance=i}));var t=Object.keys(this.beanWrappers).join(", ");this.logger.log("created beans: "+t)},e.prototype.createBeanWrapper=function(e){var t=e.__agBeanMetaData;if(!t){var o=void 0;return o=e.prototype.constructor?A(e.prototype.constructor):""+e,void console.error("Context item "+o+" is not a bean")}var n={bean:e,beanInstance:null,beanName:t.beanName};this.beanWrappers[t.beanName]=n},e.prototype.autoWireBeans=function(e){var t=this;e.forEach((function(e){t.forEachMetaDataInHierarchy(e,(function(o,n){var r=o.agClassAttributes;r&&r.forEach((function(o){var r=t.lookupBeanInstance(n,o.beanName,o.optional);e[o.attributeName]=r}))}))}))},e.prototype.methodWireBeans=function(e){var t=this;e.forEach((function(e){t.forEachMetaDataInHierarchy(e,(function(o,n){h(o.autowireMethods,(function(o,r){if("agConstructor"!==o){var i=t.getBeansForParameters(r,n);e[o].apply(e,i)}}))}))}))},e.prototype.forEachMetaDataInHierarchy=function(e,t){for(var o=Object.getPrototypeOf(e);null!=o;){var n=o.constructor;if(n.hasOwnProperty("__agBeanMetaData"))t(n.__agBeanMetaData,this.getBeanName(n));o=Object.getPrototypeOf(o)}},e.prototype.getBeanName=function(e){if(e.__agBeanMetaData&&e.__agBeanMetaData.beanName)return e.__agBeanMetaData.beanName;var t=e.toString();return t.substring(9,t.indexOf("("))},e.prototype.getBeansForParameters=function(e,t){var o=this,n=[];return e&&h(e,(function(e,r){var i=o.lookupBeanInstance(t,r);n[Number(e)]=i})),n},e.prototype.lookupBeanInstance=function(e,t,o){if(void 0===o&&(o=!1),"context"===t)return this;if(this.contextParams.providedBeanInstances&&this.contextParams.providedBeanInstances.hasOwnProperty(t))return this.contextParams.providedBeanInstances[t];var n=this.beanWrappers[t];return n?n.beanInstance:(o||console.error("AG Grid: unable to find bean reference "+t+" while initialising "+e),null)},e.prototype.callLifeCycleMethods=function(e,t){var o=this;e.forEach((function(e){return o.callLifeCycleMethodsOnBean(e,t)}))},e.prototype.callLifeCycleMethodsOnBean=function(e,t,o){var n={};this.forEachMetaDataInHierarchy(e,(function(e){var r=e[t];r&&r.forEach((function(e){e!=o&&(n[e]=!0)}))})),Object.keys(n).forEach((function(t){return e[t]()}))},e.prototype.getBean=function(e){return this.lookupBeanInstance("getBean",e,!0)},e.prototype.destroy=function(){if(!this.destroyed){this.logger.log(">> Shutting down ag-Application Context");var e=this.getBeanInstances();this.destroyBeans(e),this.contextParams.providedBeanInstances=null,this.destroyed=!0,this.logger.log(">> ag-Application Context shut down - component is dead")}},e.prototype.destroyBean=function(e){e&&this.destroyBeans([e])},e.prototype.destroyBeans=function(e){var t=this;return e?(e.forEach((function(e){t.callLifeCycleMethodsOnBean(e,"preDestroyMethods","destroy");var o=e;"function"===typeof o.destroy&&o.destroy()})),[]):[]},e}();function V(e,t,o){var n=X(e.constructor);n.preConstructMethods||(n.preConstructMethods=[]),n.preConstructMethods.push(t)}function $(e,t,o){var n=X(e.constructor);n.postConstructMethods||(n.postConstructMethods=[]),n.postConstructMethods.push(t)}function U(e,t,o){var n=X(e.constructor);n.preDestroyMethods||(n.preDestroyMethods=[]),n.preDestroyMethods.push(t)}function W(e){return function(t){X(t).beanName=e}}function q(e){return function(t,o,n){Y(t,e,!1,t,o,null)}}function K(e){return function(t,o,n){Y(t,e,!0,t,o,null)}}function Y(e,t,o,n,r,i){if(null!==t)if("number"!==typeof i){var a=X(e.constructor);a.agClassAttributes||(a.agClassAttributes=[]),a.agClassAttributes.push({attributeName:r,beanName:t,optional:o})}else console.error("AG Grid: Autowired should be on an attribute");else console.error("AG Grid: Autowired name should not be null")}function J(e){return function(t,o,n){var r,i="function"==typeof t?t:t.constructor;if("number"===typeof n){var a=void 0;o?(r=X(i),a=o):(r=X(i),a="agConstructor"),r.autowireMethods||(r.autowireMethods={}),r.autowireMethods[a]||(r.autowireMethods[a]={}),r.autowireMethods[a][n]=e}}}function X(e){return e.hasOwnProperty("__agBeanMetaData")||(e.__agBeanMetaData={}),e.__agBeanMetaData}var Q,Z=function(e,t,o,n){var r,i=arguments.length,a=i<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,o):n;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)a=Reflect.decorate(e,t,o,n);else for(var s=e.length-1;s>=0;s--)(r=e[s])&&(a=(i<3?r(a):i>3?r(t,o,a):r(t,o))||a);return i>3&&a&&Object.defineProperty(t,o,a),a},ee=function(e,t){return function(o,n){t(o,n,e)}},te=function(){function e(){this.allSyncListeners=new Map,this.allAsyncListeners=new Map,this.globalSyncListeners=new Set,this.globalAsyncListeners=new Set,this.asyncFunctionsQueue=[],this.scheduled=!1,this.firedEvents={}}return e.prototype.setBeans=function(e,t,o,n){if(void 0===n&&(n=null),this.frameworkOverrides=o,this.gridOptionsService=t,n){var r=t.useAsyncEvents();this.addGlobalListener(n,r)}},e.prototype.getListeners=function(e,t,o){var n=t?this.allAsyncListeners:this.allSyncListeners,r=n.get(e);return!r&&o&&(r=new Set,n.set(e,r)),r},e.prototype.noRegisteredListenersExist=function(){return 0===this.allSyncListeners.size&&0===this.allAsyncListeners.size&&0===this.globalSyncListeners.size&&0===this.globalAsyncListeners.size},e.prototype.addEventListener=function(e,t,o){void 0===o&&(o=!1),this.getListeners(e,o,!0).add(t)},e.prototype.removeEventListener=function(e,t,o){void 0===o&&(o=!1);var n=this.getListeners(e,o,!1);n&&(n.delete(t),0===n.size&&(o?this.allAsyncListeners:this.allSyncListeners).delete(e))},e.prototype.addGlobalListener=function(e,t){void 0===t&&(t=!1),(t?this.globalAsyncListeners:this.globalSyncListeners).add(e)},e.prototype.removeGlobalListener=function(e,t){void 0===t&&(t=!1),(t?this.globalAsyncListeners:this.globalSyncListeners).delete(e)},e.prototype.dispatchEvent=function(e){var t=e;if(this.gridOptionsService){var o=this.gridOptionsService,n=o.api,r=o.columnApi,i=o.context;t.api=n,t.columnApi=r,t.context=i}this.dispatchToListeners(t,!0),this.dispatchToListeners(t,!1),this.firedEvents[t.type]=!0},e.prototype.dispatchEventOnce=function(e){this.firedEvents[e.type]||this.dispatchEvent(e)},e.prototype.dispatchToListeners=function(e,t){var o=this,n=e.type;if(t&&"event"in e){var r=e.event;r instanceof Event&&(e.eventPath=r.composedPath())}var i=this.getListeners(n,t,!1);i&&function(n){n.forEach((function(n){t?o.dispatchAsync((function(){return n(e)})):n(e)}))}(i),(t?this.globalAsyncListeners:this.globalSyncListeners).forEach((function(r){t?o.dispatchAsync((function(){return o.frameworkOverrides.dispatchEvent(n,(function(){return r(n,e)}),!0)})):o.frameworkOverrides.dispatchEvent(n,(function(){return r(n,e)}),!0)}))},e.prototype.dispatchAsync=function(e){this.asyncFunctionsQueue.push(e),this.scheduled||(window.setTimeout(this.flushAsyncQueue.bind(this),0),this.scheduled=!0)},e.prototype.flushAsyncQueue=function(){this.scheduled=!1;var e=this.asyncFunctionsQueue.slice();this.asyncFunctionsQueue=[],e.forEach((function(e){return e()}))},Z([ee(0,J("loggerFactory")),ee(1,J("gridOptionsService")),ee(2,J("frameworkOverrides")),ee(3,J("globalEventListener"))],e.prototype,"setBeans",null),e=Z([W("eventService")],e)}();!function(e){e.CommunityCoreModule="@ag-grid-community/core",e.InfiniteRowModelModule="@ag-grid-community/infinite-row-model",e.ClientSideRowModelModule="@ag-grid-community/client-side-row-model",e.CsvExportModule="@ag-grid-community/csv-export",e.EnterpriseCoreModule="@ag-grid-enterprise/core",e.RowGroupingModule="@ag-grid-enterprise/row-grouping",e.ColumnsToolPanelModule="@ag-grid-enterprise/column-tool-panel",e.FiltersToolPanelModule="@ag-grid-enterprise/filter-tool-panel",e.MenuModule="@ag-grid-enterprise/menu",e.SetFilterModule="@ag-grid-enterprise/set-filter",e.MultiFilterModule="@ag-grid-enterprise/multi-filter",e.StatusBarModule="@ag-grid-enterprise/status-bar",e.SideBarModule="@ag-grid-enterprise/side-bar",e.RangeSelectionModule="@ag-grid-enterprise/range-selection",e.MasterDetailModule="@ag-grid-enterprise/master-detail",e.RichSelectModule="@ag-grid-enterprise/rich-select",e.GridChartsModule="@ag-grid-enterprise/charts",e.ViewportRowModelModule="@ag-grid-enterprise/viewport-row-model",e.ServerSideRowModelModule="@ag-grid-enterprise/server-side-row-model",e.ExcelExportModule="@ag-grid-enterprise/excel-export",e.ClipboardModule="@ag-grid-enterprise/clipboard",e.SparklinesModule="@ag-grid-enterprise/sparklines",e.AngularModule="@ag-grid-community/angular",e.ReactModule="@ag-grid-community/react",e.VueModule="@ag-grid-community/vue"}(Q||(Q={}));var oe=function(e,t){var o="function"===typeof Symbol&&e[Symbol.iterator];if(!o)return e;var n,r,i=o.call(e),a=[];try{for(;(void 0===t||t-- >0)&&!(n=i.next()).done;)a.push(n.value)}catch(s){r={error:s}}finally{try{n&&!n.done&&(o=i.return)&&o.call(i)}finally{if(r)throw r.error}}return a},ne=function(){function e(){}return e.register=function(t,o){void 0===o&&(o=!0),e.runVersionChecks(t),e.modulesMap[t.moduleName]=t,e.setModuleBased(o)},e.runVersionChecks=function(t){if(e.currentModuleVersion||(e.currentModuleVersion=t.version),t.version?t.version!==e.currentModuleVersion&&console.error("AG Grid: You are using incompatible versions of AG Grid modules. Major and minor versions should always match across modules. '"+t.moduleName+"' is version "+t.version+" but the other modules are version "+this.currentModuleVersion+". Please update all modules to the same version."):console.error("AG Grid: You are using incompatible versions of AG Grid modules. Major and minor versions should always match across modules. '"+t.moduleName+"' is incompatible. Please update all modules to the same version."),t.validate){var o=t.validate();if(!o.isValid){var n=o;console.error("AG Grid: "+n.message)}}},e.setModuleBased=function(t){void 0===e.moduleBased?e.moduleBased=t:e.moduleBased!==t&&j((function(){console.warn("AG Grid: You are mixing modules (i.e. @ag-grid-community/core) and packages (ag-grid-community) - you can only use one or the other of these mechanisms."),console.warn("Please see https://www.ag-grid.com/javascript-grid/packages-modules/ for more information.")}),"ModulePackageCheck")},e.setIsBundled=function(){e.isBundled=!0},e.registerModules=function(t,o){void 0===o&&(o=!0),e.setModuleBased(o),t&&t.forEach((function(t){return e.register(t,o)}))},e.assertRegistered=function(t,o){var n;if(this.isRegistered(t))return!0;var r,i=o+t;if(e.isBundled)r="AG Grid: unable to use "+o+" as 'ag-grid-enterprise' has not been loaded. Check you are using the Enterprise bundle:\n        \n        <script src=\"https://cdn.jsdelivr.net/npm/ag-grid-enterprise@AG_GRID_VERSION/dist/ag-grid-enterprise.min.js\"><\/script>\n        \nFor more info see: https://ag-grid.com/javascript-data-grid/getting-started/#getting-started-with-ag-grid-enterprise";else if(e.moduleBased||void 0===e.moduleBased){var a=null===(n=Object.entries(Q).find((function(e){var o=oe(e,2);return o[0],o[1]===t})))||void 0===n?void 0:n[0];r="AG Grid: unable to use "+o+" as the "+a+" is not registered. Check if you have registered the module:\n           \n    import { ModuleRegistry } from '@ag-grid-community/core';\n    import { "+a+" } from '"+t+"';\n    \n    ModuleRegistry.registerModules([ "+a+" ]);\n\nFor more info see: https://www.ag-grid.com/javascript-grid/modules/"}else r="AG Grid: unable to use "+o+" as package 'ag-grid-enterprise' has not been imported. Check that you have imported the package:\n            \n    import 'ag-grid-enterprise';\n            \nFor more info see: https://www.ag-grid.com/javascript-grid/packages/";return j((function(){console.warn(r)}),i),!1},e.isRegistered=function(t){return!!e.modulesMap[t]},e.getRegisteredModules=function(){return d(e.modulesMap)},e.isPackageBased=function(){return!e.moduleBased},e.modulesMap={},e}(),re=function(e,t,o,n){var r,i=arguments.length,a=i<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,o):n;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)a=Reflect.decorate(e,t,o,n);else for(var s=e.length-1;s>=0;s--)(r=e[s])&&(a=(i<3?r(a):i>3?r(t,o,a):r(t,o))||a);return i>3&&a&&Object.defineProperty(t,o,a),a},ie=function(e,t){var o="function"===typeof Symbol&&e[Symbol.iterator];if(!o)return e;var n,r,i=o.call(e),a=[];try{for(;(void 0===t||t-- >0)&&!(n=i.next()).done;)a.push(n.value)}catch(s){r={error:s}}finally{try{n&&!n.done&&(o=i.return)&&o.call(i)}finally{if(r)throw r.error}}return a},ae=function(){for(var e=[],t=0;t<arguments.length;t++)e=e.concat(ie(arguments[t]));return e},se=0;function le(){return se++}var ce=function(){function e(e,t,o,n){this.instanceId=le(),this.autoHeaderHeight=null,this.moving=!1,this.menuVisible=!1,this.filterActive=!1,this.eventService=new te,this.tooltipEnabled=!1,this.rowGroupActive=!1,this.pivotActive=!1,this.aggregationActive=!1,this.colDef=e,this.userProvidedColDef=t,this.colId=o,this.primary=n,this.setState(e)}return e.prototype.getInstanceId=function(){return this.instanceId},e.prototype.setState=function(e){void 0!==e.sort?"asc"!==e.sort&&"desc"!==e.sort||(this.sort=e.sort):"asc"!==e.initialSort&&"desc"!==e.initialSort||(this.sort=e.initialSort);var t=l(e.sortIndex),o=l(e.initialSortIndex);void 0!==t?null!==t&&(this.sortIndex=t):null!==o&&(this.sortIndex=o);var n=c(e.hide),r=c(e.initialHide);this.visible=void 0!==n?!n:!r,void 0!==e.pinned?this.setPinned(e.pinned):this.setPinned(e.initialPinned);var i=l(e.flex),a=l(e.initialFlex);void 0!==i?this.flex=i:void 0!==a&&(this.flex=a)},e.prototype.setColDef=function(e,t){this.colDef=e,this.userProvidedColDef=t,this.initMinAndMaxWidths(),this.initDotNotation(),this.eventService.dispatchEvent(this.createColumnEvent("colDefChanged","api"))},e.prototype.getUserProvidedColDef=function(){return this.userProvidedColDef},e.prototype.setParent=function(e){this.parent=e},e.prototype.getParent=function(){return this.parent},e.prototype.setOriginalParent=function(e){this.originalParent=e},e.prototype.getOriginalParent=function(){return this.originalParent},e.prototype.initialise=function(){this.initMinAndMaxWidths(),this.resetActualWidth("gridInitializing"),this.initDotNotation(),this.initTooltip(),this.validate()},e.prototype.initDotNotation=function(){var e=this.gridOptionsService.is("suppressFieldDotNotation");this.fieldContainsDots=r(this.colDef.field)&&this.colDef.field.indexOf(".")>=0&&!e,this.tooltipFieldContainsDots=r(this.colDef.tooltipField)&&this.colDef.tooltipField.indexOf(".")>=0&&!e},e.prototype.initMinAndMaxWidths=function(){var e=this.colDef;this.minWidth=this.columnUtils.calculateColMinWidth(e),this.maxWidth=this.columnUtils.calculateColMaxWidth(e)},e.prototype.initTooltip=function(){this.tooltipEnabled=r(this.colDef.tooltipField)||r(this.colDef.tooltipValueGetter)||r(this.colDef.tooltipComponent)||r(this.colDef.tooltipComponentFramework)},e.prototype.resetActualWidth=function(e){void 0===e&&(e="api");var t=this.columnUtils.calculateColInitialWidth(this.colDef);this.setActualWidth(t,e,!0)},e.prototype.isEmptyGroup=function(){return!1},e.prototype.isRowGroupDisplayed=function(e){if(i(this.colDef)||i(this.colDef.showRowGroup))return!1;var t=!0===this.colDef.showRowGroup,o=this.colDef.showRowGroup===e;return t||o},e.prototype.isPrimary=function(){return this.primary},e.prototype.isFilterAllowed=function(){return!!this.colDef.filter||!!this.colDef.filterFramework},e.prototype.isFieldContainsDots=function(){return this.fieldContainsDots},e.prototype.isTooltipEnabled=function(){return this.tooltipEnabled},e.prototype.isTooltipFieldContainsDots=function(){return this.tooltipFieldContainsDots},e.prototype.validate=function(){var e=this.colDef;function t(e,t,o){j((function(){o?console.warn(e,o):j((function(){return console.warn(e)}),t)}),t)}if(this.gridOptionsService.isRowModelType("clientSide")&&!ne.isRegistered(Q.RowGroupingModule)){(o=["enableRowGroup","rowGroup","rowGroupIndex","enablePivot","enableValue","pivot","pivotIndex","aggFunc"].filter((function(t){return r(e[t])}))).length>0&&ne.assertRegistered(Q.RowGroupingModule,o.map((function(e){return"colDef."+e})).join(", "))}if("agRichSelect"!==this.colDef.cellEditor&&"agRichSelectCellEditor"!==this.colDef.cellEditor||ne.assertRegistered(Q.RichSelectModule,this.colDef.cellEditor),this.gridOptionsService.isTreeData()){(o=["rowGroup","rowGroupIndex","pivot","pivotIndex"].filter((function(t){return r(e[t])}))).length>0&&t("AG Grid: "+o.join()+" is not possible when doing tree data, your column definition should not have "+o.join(),"TreeDataCannotRowGroup")}if(r(e.menuTabs))if(Array.isArray(e.menuTabs)){var o,n=["filterMenuTab"],i=["columnsMenuTab","generalMenuTab"];(o=i.filter((function(t){return e.menuTabs.includes(t)}))).length>0&&ne.assertRegistered(Q.MenuModule,"menuTab(s): "+o.map((function(e){return"'"+e+"'"})).join()),e.menuTabs.forEach((function(e){i.includes(e)||n.includes(e)||t("AG Grid: '"+e+"' is not valid for 'colDef.menuTabs'. Valid values are: "+ae(n,i).map((function(e){return"'"+e+"'"})).join()+".","wrongValue_menuTabs_"+e)}))}else t("AG Grid: The typeof 'colDef.menuTabs' should be an array not:"+typeof e.menuTabs,"wrongType_menuTabs");r(e.columnsMenuParams)&&ne.assertRegistered(Q.MenuModule,"columnsMenuParams"),r(e.columnsMenuParams)&&ne.assertRegistered(Q.ColumnsToolPanelModule,"columnsMenuParams"),r(this.colDef.width)&&"number"!==typeof this.colDef.width&&t("AG Grid: colDef.width should be a number, not "+typeof this.colDef.width,"ColumnCheck"),(e.pinnedRowCellRenderer||e.pinnedRowCellRendererParams||e.pinnedRowCellRendererFramework)&&t("AG Grid: pinnedRowCellRenderer[Params,Framework] no longer exist. Use cellRendererSelector if you want a different Cell Renderer for pinned rows. Check params.node.rowPinned.","colDef.pinnedRowCellRenderer-deprecated"),r(e.columnGroupShow)&&"closed"!==e.columnGroupShow&&"open"!==e.columnGroupShow&&t("AG Grid: '"+e.columnGroupShow+"' is not valid for columnGroupShow. Valid values are 'open', 'closed', undefined, null","columnGroupShow_invalid")},e.prototype.addEventListener=function(e,t){this.eventService.addEventListener(e,t)},e.prototype.removeEventListener=function(e,t){this.eventService.removeEventListener(e,t)},e.prototype.createColumnFunctionCallbackParams=function(e){return{node:e,data:e.data,column:this,colDef:this.colDef,context:this.gridOptionsService.context,api:this.gridOptionsService.api,columnApi:this.gridOptionsService.columnApi}},e.prototype.isSuppressNavigable=function(e){if("boolean"===typeof this.colDef.suppressNavigable)return this.colDef.suppressNavigable;if("function"===typeof this.colDef.suppressNavigable){var t=this.createColumnFunctionCallbackParams(e);return(0,this.colDef.suppressNavigable)(t)}return!1},e.prototype.isCellEditable=function(e){return!(e.group&&!this.gridOptionsService.is("enableGroupEdit"))&&this.isColumnFunc(e,this.colDef.editable)},e.prototype.isSuppressFillHandle=function(){return!!c(this.colDef.suppressFillHandle)},e.prototype.isAutoHeight=function(){return!!c(this.colDef.autoHeight)},e.prototype.isAutoHeaderHeight=function(){return!!c(this.colDef.autoHeaderHeight)},e.prototype.isRowDrag=function(e){return this.isColumnFunc(e,this.colDef.rowDrag)},e.prototype.isDndSource=function(e){return this.isColumnFunc(e,this.colDef.dndSource)},e.prototype.isCellCheckboxSelection=function(e){return this.isColumnFunc(e,this.colDef.checkboxSelection)},e.prototype.isSuppressPaste=function(e){return this.isColumnFunc(e,this.colDef?this.colDef.suppressPaste:null)},e.prototype.isResizable=function(){return!!c(this.colDef.resizable)},e.prototype.isColumnFunc=function(e,t){return"boolean"===typeof t?t:"function"===typeof t&&t(this.createColumnFunctionCallbackParams(e))},e.prototype.setMoving=function(e,t){void 0===t&&(t="api"),this.moving=e,this.eventService.dispatchEvent(this.createColumnEvent("movingChanged",t))},e.prototype.createColumnEvent=function(e,t){return{type:e,column:this,columns:[this],source:t,api:this.gridOptionsService.api,columnApi:this.gridOptionsService.columnApi,context:this.gridOptionsService.context}},e.prototype.isMoving=function(){return this.moving},e.prototype.getSort=function(){return this.sort},e.prototype.setSort=function(e,t){void 0===t&&(t="api"),this.sort!==e&&(this.sort=e,this.eventService.dispatchEvent(this.createColumnEvent("sortChanged",t)))},e.prototype.setMenuVisible=function(e,t){void 0===t&&(t="api"),this.menuVisible!==e&&(this.menuVisible=e,this.eventService.dispatchEvent(this.createColumnEvent("menuVisibleChanged",t)))},e.prototype.isMenuVisible=function(){return this.menuVisible},e.prototype.isSortAscending=function(){return"asc"===this.sort},e.prototype.isSortDescending=function(){return"desc"===this.sort},e.prototype.isSortNone=function(){return i(this.sort)},e.prototype.isSorting=function(){return r(this.sort)},e.prototype.getSortIndex=function(){return this.sortIndex},e.prototype.setSortIndex=function(e){this.sortIndex=e},e.prototype.setAggFunc=function(e){this.aggFunc=e},e.prototype.getAggFunc=function(){return this.aggFunc},e.prototype.getLeft=function(){return this.left},e.prototype.getOldLeft=function(){return this.oldLeft},e.prototype.getRight=function(){return this.left+this.actualWidth},e.prototype.setLeft=function(e,t){void 0===t&&(t="api"),this.oldLeft=this.left,this.left!==e&&(this.left=e,this.eventService.dispatchEvent(this.createColumnEvent("leftChanged",t)))},e.prototype.isFilterActive=function(){return this.filterActive},e.prototype.setFilterActive=function(e,t,o){void 0===t&&(t="api"),this.filterActive!==e&&(this.filterActive=e,this.eventService.dispatchEvent(this.createColumnEvent("filterActiveChanged",t)));var n=this.createColumnEvent("filterChanged",t);o&&w(n,o),this.eventService.dispatchEvent(n)},e.prototype.isHovered=function(){return this.columnHoverService.isHovered(this)},e.prototype.setPinned=function(e){this.pinned=!0===e||"left"===e?"left":"right"===e?"right":null},e.prototype.setFirstRightPinned=function(e,t){void 0===t&&(t="api"),this.firstRightPinned!==e&&(this.firstRightPinned=e,this.eventService.dispatchEvent(this.createColumnEvent("firstRightPinnedChanged",t)))},e.prototype.setLastLeftPinned=function(e,t){void 0===t&&(t="api"),this.lastLeftPinned!==e&&(this.lastLeftPinned=e,this.eventService.dispatchEvent(this.createColumnEvent("lastLeftPinnedChanged",t)))},e.prototype.isFirstRightPinned=function(){return this.firstRightPinned},e.prototype.isLastLeftPinned=function(){return this.lastLeftPinned},e.prototype.isPinned=function(){return"left"===this.pinned||"right"===this.pinned},e.prototype.isPinnedLeft=function(){return"left"===this.pinned},e.prototype.isPinnedRight=function(){return"right"===this.pinned},e.prototype.getPinned=function(){return this.pinned},e.prototype.setVisible=function(e,t){void 0===t&&(t="api");var o=!0===e;this.visible!==o&&(this.visible=o,this.eventService.dispatchEvent(this.createColumnEvent("visibleChanged",t)))},e.prototype.isVisible=function(){return this.visible},e.prototype.isSpanHeaderHeight=function(){return!!this.getColDef().spanHeaderHeight},e.prototype.getColDef=function(){return this.colDef},e.prototype.getColumnGroupShow=function(){return this.colDef.columnGroupShow},e.prototype.getColId=function(){return this.colId},e.prototype.getId=function(){return this.colId},e.prototype.getUniqueId=function(){return this.colId},e.prototype.getDefinition=function(){return this.colDef},e.prototype.getActualWidth=function(){return this.actualWidth},e.prototype.getAutoHeaderHeight=function(){return this.autoHeaderHeight},e.prototype.setAutoHeaderHeight=function(e){var t=e!==this.autoHeaderHeight;return this.autoHeaderHeight=e,t},e.prototype.createBaseColDefParams=function(e){return{node:e,data:e.data,colDef:this.colDef,column:this,api:this.gridOptionsService.api,columnApi:this.gridOptionsService.columnApi,context:this.gridOptionsService.context}},e.prototype.getColSpan=function(e){if(i(this.colDef.colSpan))return 1;var t=this.createBaseColDefParams(e),o=this.colDef.colSpan(t);return Math.max(o,1)},e.prototype.getRowSpan=function(e){if(i(this.colDef.rowSpan))return 1;var t=this.createBaseColDefParams(e),o=this.colDef.rowSpan(t);return Math.max(o,1)},e.prototype.setActualWidth=function(e,t,o){void 0===t&&(t="api"),void 0===o&&(o=!1),null!=this.minWidth&&(e=Math.max(e,this.minWidth)),null!=this.maxWidth&&(e=Math.min(e,this.maxWidth)),this.actualWidth!==e&&(this.actualWidth=e,this.flex&&"flex"!==t&&"gridInitializing"!==t&&(this.flex=null),o||this.fireColumnWidthChangedEvent(t))},e.prototype.fireColumnWidthChangedEvent=function(e){this.eventService.dispatchEvent(this.createColumnEvent("widthChanged",e))},e.prototype.isGreaterThanMax=function(e){return null!=this.maxWidth&&e>this.maxWidth},e.prototype.getMinWidth=function(){return this.minWidth},e.prototype.getMaxWidth=function(){return this.maxWidth},e.prototype.getFlex=function(){return this.flex||0},e.prototype.setFlex=function(e){this.flex!==e&&(this.flex=e)},e.prototype.setMinimum=function(e){void 0===e&&(e="api"),r(this.minWidth)&&this.setActualWidth(this.minWidth,e)},e.prototype.setRowGroupActive=function(e,t){void 0===t&&(t="api"),this.rowGroupActive!==e&&(this.rowGroupActive=e,this.eventService.dispatchEvent(this.createColumnEvent("columnRowGroupChanged",t)))},e.prototype.isRowGroupActive=function(){return this.rowGroupActive},e.prototype.setPivotActive=function(e,t){void 0===t&&(t="api"),this.pivotActive!==e&&(this.pivotActive=e,this.eventService.dispatchEvent(this.createColumnEvent("columnPivotChanged",t)))},e.prototype.isPivotActive=function(){return this.pivotActive},e.prototype.isAnyFunctionActive=function(){return this.isPivotActive()||this.isRowGroupActive()||this.isValueActive()},e.prototype.isAnyFunctionAllowed=function(){return this.isAllowPivot()||this.isAllowRowGroup()||this.isAllowValue()},e.prototype.setValueActive=function(e,t){void 0===t&&(t="api"),this.aggregationActive!==e&&(this.aggregationActive=e,this.eventService.dispatchEvent(this.createColumnEvent("columnValueChanged",t)))},e.prototype.isValueActive=function(){return this.aggregationActive},e.prototype.isAllowPivot=function(){return!0===this.colDef.enablePivot},e.prototype.isAllowValue=function(){return!0===this.colDef.enableValue},e.prototype.isAllowRowGroup=function(){return!0===this.colDef.enableRowGroup},e.prototype.getMenuTabs=function(e){var t=this.getColDef().menuTabs;return null==t&&(t=e),t},e.EVENT_MOVING_CHANGED="movingChanged",e.EVENT_LEFT_CHANGED="leftChanged",e.EVENT_WIDTH_CHANGED="widthChanged",e.EVENT_LAST_LEFT_PINNED_CHANGED="lastLeftPinnedChanged",e.EVENT_FIRST_RIGHT_PINNED_CHANGED="firstRightPinnedChanged",e.EVENT_VISIBLE_CHANGED="visibleChanged",e.EVENT_FILTER_CHANGED="filterChanged",e.EVENT_FILTER_ACTIVE_CHANGED="filterActiveChanged",e.EVENT_SORT_CHANGED="sortChanged",e.EVENT_COL_DEF_CHANGED="colDefChanged",e.EVENT_MENU_VISIBLE_CHANGED="menuVisibleChanged",e.EVENT_ROW_GROUP_CHANGED="columnRowGroupChanged",e.EVENT_PIVOT_CHANGED="columnPivotChanged",e.EVENT_VALUE_CHANGED="columnValueChanged",re([q("gridOptionsService")],e.prototype,"gridOptionsService",void 0),re([q("columnUtils")],e.prototype,"columnUtils",void 0),re([q("columnHoverService")],e.prototype,"columnHoverService",void 0),re([$],e.prototype,"initialise",null),e}(),de=function(e,t,o,n){var r,i=arguments.length,a=i<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,o):n;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)a=Reflect.decorate(e,t,o,n);else for(var s=e.length-1;s>=0;s--)(r=e[s])&&(a=(i<3?r(a):i>3?r(t,o,a):r(t,o))||a);return i>3&&a&&Object.defineProperty(t,o,a),a},ue=function(){function e(e,t,o,n){this.localEventService=new te,this.expandable=!1,this.instanceId=le(),this.expandableListenerRemoveCallback=null,this.colGroupDef=e,this.groupId=t,this.expanded=!!e&&!!e.openByDefault,this.padding=o,this.level=n}return e.prototype.destroy=function(){this.expandableListenerRemoveCallback&&this.reset(null,void 0)},e.prototype.reset=function(e,t){this.colGroupDef=e,this.level=t,this.originalParent=null,this.expandableListenerRemoveCallback&&this.expandableListenerRemoveCallback(),this.children=void 0,this.expandable=void 0},e.prototype.getInstanceId=function(){return this.instanceId},e.prototype.setOriginalParent=function(e){this.originalParent=e},e.prototype.getOriginalParent=function(){return this.originalParent},e.prototype.getLevel=function(){return this.level},e.prototype.isVisible=function(){return!!this.children&&this.children.some((function(e){return e.isVisible()}))},e.prototype.isPadding=function(){return this.padding},e.prototype.setExpanded=function(t){this.expanded=void 0!==t&&t;var o={type:e.EVENT_EXPANDED_CHANGED};this.localEventService.dispatchEvent(o)},e.prototype.isExpandable=function(){return this.expandable},e.prototype.isExpanded=function(){return this.expanded},e.prototype.getGroupId=function(){return this.groupId},e.prototype.getId=function(){return this.getGroupId()},e.prototype.setChildren=function(e){this.children=e},e.prototype.getChildren=function(){return this.children},e.prototype.getColGroupDef=function(){return this.colGroupDef},e.prototype.getLeafColumns=function(){var e=[];return this.addLeafColumns(e),e},e.prototype.addLeafColumns=function(t){this.children&&this.children.forEach((function(o){o instanceof ce?t.push(o):o instanceof e&&o.addLeafColumns(t)}))},e.prototype.getColumnGroupShow=function(){var e=this.colGroupDef;if(e)return e.columnGroupShow},e.prototype.setupExpandable=function(){var e=this;this.setExpandable(),this.expandableListenerRemoveCallback&&this.expandableListenerRemoveCallback();var t=this.onColumnVisibilityChanged.bind(this);this.getLeafColumns().forEach((function(e){return e.addEventListener("visibleChanged",t)})),this.expandableListenerRemoveCallback=function(){e.getLeafColumns().forEach((function(e){return e.removeEventListener("visibleChanged",t)})),e.expandableListenerRemoveCallback=null}},e.prototype.setExpandable=function(){if(!this.isPadding()){for(var t=!1,o=!1,n=!1,r=this.findChildrenRemovingPadding(),i=0,a=r.length;i<a;i++){var s=r[i];if(s.isVisible()){var l=s.getColumnGroupShow();"open"===l?(t=!0,n=!0):"closed"===l?(o=!0,n=!0):(t=!0,o=!0)}}var c=t&&o&&n;if(this.expandable!==c){this.expandable=c;var d={type:e.EVENT_EXPANDABLE_CHANGED};this.localEventService.dispatchEvent(d)}}},e.prototype.findChildrenRemovingPadding=function(){var t=[],o=function(n){n.forEach((function(n){n instanceof e&&n.isPadding()?o(n.children):t.push(n)}))};return o(this.children),t},e.prototype.onColumnVisibilityChanged=function(){this.setExpandable()},e.prototype.addEventListener=function(e,t){this.localEventService.addEventListener(e,t)},e.prototype.removeEventListener=function(e,t){this.localEventService.removeEventListener(e,t)},e.EVENT_EXPANDED_CHANGED="expandedChanged",e.EVENT_EXPANDABLE_CHANGED="expandableChanged",de([U],e.prototype,"destroy",null),e}(),pe={numericColumn:{headerClass:"ag-right-aligned-header",cellClass:"ag-right-aligned-cell"},rightAligned:{headerClass:"ag-right-aligned-header",cellClass:"ag-right-aligned-cell"}};function he(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];for(var o=0;o<e.length;o++){var n=e[o];if(r(n))return n}return null}function fe(e){if(e&&e.length)return e[e.length-1]}function ge(e,t,o){return null==e&&null==t||null!=e&&null!=t&&e.length===t.length&&e.every((function(e,n){return o?o(e,t[n]):t[n]===e}))}function me(e){return e.sort((function(e,t){return e-t}))}function ye(e,t){var o=e.indexOf(t);o>=0&&e.splice(o,1)}function ve(e,t){t.forEach((function(t){return ye(e,t)}))}function be(e,t,o){e.splice(o,0,t)}function xe(e,t,o){ve(e,t),t.slice().reverse().forEach((function(t){return be(e,t,o)}))}function we(e,t){return e.indexOf(t)>-1}function Ce(e){return[].concat.apply([],e)}function _e(e,t){null!=t&&null!=e&&t.forEach((function(t){return e.push(t)}))}var Se=Object.freeze({__proto__:null,firstExistingValue:he,existsAndNotEmpty:function(e){return null!=e&&e.length>0},last:fe,areEqual:ge,shallowCompare:function(e,t){return ge(e,t)},sortNumerically:me,removeRepeatsFromArray:function(e,t){if(e)for(var o=e.length-2;o>=0;o--){var n=e[o]===t,r=e[o+1]===t;n&&r&&e.splice(o+1,1)}},removeFromArray:ye,removeAllFromArray:ve,insertIntoArray:be,insertArrayIntoArray:function(e,t,o){if(null!=e&&null!=t)for(var n=t.length-1;n>=0;n--){be(e,t[n],o)}},moveInArray:xe,includes:we,flatten:Ce,pushAll:_e,toStrings:function(e){return e.map(s)},forEachReverse:function(e,t){if(null!=e)for(var o=e.length-1;o>=0;o--)t(e[o],o)}}),Ee="__ag_Grid_Stop_Propagation",ke=["touchstart","touchend","touchmove","touchcancel","scroll"],je={};function Ae(e){e[Ee]=!0}function Re(e){return!0===e[Ee]}var Oe=function(){var e={select:"input",change:"input",submit:"form",reset:"form",error:"img",load:"img",abort:"img"};return function(t){if("boolean"===typeof je[t])return je[t];var o=document.createElement(e[t]||"div");return je[t="on"+t]=t in o}}();function Te(e,t,o){for(var n=t;n;){var r=e.getDomData(n,o);if(r)return r;n=n.parentElement}return null}function De(e,t){return!(!t||!e)&&Ne(t).indexOf(e)>=0}function Pe(e){for(var t=[],o=e.target;o;)t.push(o),o=o.parentElement;return t}function Ne(e){var t=e;return t.path?t.path:t.composedPath?t.composedPath():Pe(t)}function Ie(e,t,o,n){var r=we(ke,o)?{passive:!0}:void 0;e&&e.addEventListener&&e.addEventListener(t,o,n,r)}var Me=Object.freeze({__proto__:null,stopPropagationForAgGrid:Ae,isStopPropagationForAgGrid:Re,isEventSupported:Oe,getCtrlForEventTarget:Te,isElementInEventPath:De,createEventPath:Pe,getEventPath:Ne,addSafePassiveEventListener:Ie}),Le=function(e,t,o,n){var r,i=arguments.length,a=i<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,o):n;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)a=Reflect.decorate(e,t,o,n);else for(var s=e.length-1;s>=0;s--)(r=e[s])&&(a=(i<3?r(a):i>3?r(t,o,a):r(t,o))||a);return i>3&&a&&Object.defineProperty(t,o,a),a},Fe=function(){function e(){var e=this;this.destroyFunctions=[],this.destroyed=!1,this.__v_skip=!0,this.isAlive=function(){return!e.destroyed}}return e.prototype.getFrameworkOverrides=function(){return this.frameworkOverrides},e.prototype.getContext=function(){return this.context},e.prototype.destroy=function(){this.destroyFunctions.forEach((function(e){return e()})),this.destroyFunctions.length=0,this.destroyed=!0,this.dispatchEvent({type:e.EVENT_DESTROYED})},e.prototype.addEventListener=function(e,t){this.localEventService||(this.localEventService=new te),this.localEventService.addEventListener(e,t)},e.prototype.removeEventListener=function(e,t){this.localEventService&&this.localEventService.removeEventListener(e,t)},e.prototype.dispatchEventAsync=function(e){var t=this;window.setTimeout((function(){return t.dispatchEvent(e)}),0)},e.prototype.dispatchEvent=function(e){this.localEventService&&this.localEventService.dispatchEvent(e)},e.prototype.addManagedListener=function(e,t,o){var n=this;if(!this.destroyed){e instanceof HTMLElement?Ie(this.getFrameworkOverrides(),e,t,o):e.addEventListener(t,o);var r=function(){return e.removeEventListener(t,o),n.destroyFunctions=n.destroyFunctions.filter((function(e){return e!==r})),null};return this.destroyFunctions.push(r),r}},e.prototype.addManagedPropertyListener=function(e,t){var o=this;if(!this.destroyed){this.gridOptionsService.addEventListener(e,t);var n=function(){return o.gridOptionsService.removeEventListener(e,t),o.destroyFunctions=o.destroyFunctions.filter((function(e){return e!==n})),null};return this.destroyFunctions.push(n),n}},e.prototype.addDestroyFunc=function(e){this.isAlive()?this.destroyFunctions.push(e):e()},e.prototype.createManagedBean=function(e,t){var o=this.createBean(e,t);return this.addDestroyFunc(this.destroyBean.bind(this,e,t)),o},e.prototype.createBean=function(e,t,o){return(t||this.getContext()).createBean(e,o)},e.prototype.destroyBean=function(e,t){return(t||this.getContext()).destroyBean(e)},e.prototype.destroyBeans=function(e,t){var o=this;return e&&e.forEach((function(e){return o.destroyBean(e,t)})),[]},e.EVENT_DESTROYED="destroyed",Le([q("frameworkOverrides")],e.prototype,"frameworkOverrides",void 0),Le([q("context")],e.prototype,"context",void 0),Le([q("eventService")],e.prototype,"eventService",void 0),Le([q("gridOptionsService")],e.prototype,"gridOptionsService",void 0),Le([q("localeService")],e.prototype,"localeService",void 0),Le([q("environment")],e.prototype,"environment",void 0),Le([U],e.prototype,"destroy",null),e}(),Ge=function(){var e=function(t,o){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])},e(t,o)};return function(t,o){function n(){this.constructor=t}e(t,o),t.prototype=null===o?Object.create(o):(n.prototype=o.prototype,new n)}}(),ze=function(e,t,o,n){var r,i=arguments.length,a=i<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,o):n;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)a=Reflect.decorate(e,t,o,n);else for(var s=e.length-1;s>=0;s--)(r=e[s])&&(a=(i<3?r(a):i>3?r(t,o,a):r(t,o))||a);return i>3&&a&&Object.defineProperty(t,o,a),a},He=function(e,t){return function(o,n){t(o,n,e)}},Be=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Ge(t,e),t.prototype.setBeans=function(e){this.logger=e.create("ColumnFactory")},t.prototype.createColumnTree=function(e,t,o){var n=new p,r=this.extractExistingTreeData(o),i=r.existingCols,a=r.existingGroups,s=r.existingColKeys;n.addExistingKeys(s);var l=this.recursivelyCreateColumns(e,0,t,i,n,a),c=this.findMaxDept(l,0);this.logger.log("Number of levels for grouped columns is "+c);var d=this.balanceColumnTree(l,0,c,n);return this.columnUtils.depthFirstOriginalTreeSearch(null,d,(function(e,t){e instanceof ue&&e.setupExpandable(),e.setOriginalParent(t)})),{columnTree:d,treeDept:c}},t.prototype.extractExistingTreeData=function(e){var t=[],o=[],n=[];return e&&this.columnUtils.depthFirstOriginalTreeSearch(null,e,(function(e){if(e instanceof ue){var r=e;o.push(r)}else{var i=e;n.push(i.getId()),t.push(i)}})),{existingCols:t,existingGroups:o,existingColKeys:n}},t.prototype.createForAutoGroups=function(e,t){var o=this;return e.map((function(e){return o.createAutoGroupTreeItem(t,e)}))},t.prototype.createAutoGroupTreeItem=function(e,t){for(var o=t,n=this.findDepth(e)-1;n>=0;n--){var r=new ue(null,"FAKE_PATH_"+t.getId()+"}_"+n,!0,n);this.createBean(r),r.setChildren([o]),o.setOriginalParent(r),o=r}return o},t.prototype.findDepth=function(e){for(var t=0,o=e;o&&o[0]&&o[0]instanceof ue;)t++,o=o[0].getChildren();return t},t.prototype.balanceColumnTree=function(e,t,o,n){for(var r=[],i=0;i<e.length;i++){var a=e[i];if(a instanceof ue){var s=a,l=this.balanceColumnTree(s.getChildren(),t+1,o,n);s.setChildren(l),r.push(s)}else{for(var c=void 0,d=void 0,u=o-1;u>=t;u--){var p=n.getUniqueKey(null,null),h=this.createMergedColGroupDef(null),f=new ue(h,p,!0,t);this.createBean(f),d&&d.setChildren([f]),d=f,c||(c=d)}if(c&&d){if(r.push(c),e.some((function(e){return e instanceof ue}))){d.setChildren([a]);continue}d.setChildren(e);break}r.push(a)}}return r},t.prototype.findMaxDept=function(e,t){for(var o=t,n=0;n<e.length;n++){var r=e[n];if(r instanceof ue){var i=r,a=this.findMaxDept(i.getChildren(),t+1);o<a&&(o=a)}}return o},t.prototype.recursivelyCreateColumns=function(e,t,o,n,r,i){var a=this;return(e||[]).map((function(e){return a.isColumnGroup(e)?a.createColumnGroup(o,e,t,n,r,i):a.createColumn(o,e,n,r)}))},t.prototype.createColumnGroup=function(e,t,o,n,r,i){var a=this.createMergedColGroupDef(t),s=r.getUniqueKey(a.groupId||null,null),l=new ue(a,s,!1,o);this.createBean(l);var c=this.findExistingGroup(t,i);c&&ye(i,c),c&&c.isExpanded()&&l.setExpanded(!0);var d=this.recursivelyCreateColumns(a.children,o+1,e,n,r,i);return l.setChildren(d),l},t.prototype.createMergedColGroupDef=function(e){var t={};return Object.assign(t,this.gridOptionsService.get("defaultColGroupDef")),Object.assign(t,e),t},t.prototype.createColumn=function(e,t,o,n){var r=this.mergeColDefs(t),i=this.findExistingColumn(t,o);if(o&&i&&ye(o,i),i)i.setColDef(r,t),this.applyColumnState(i,r);else{var a=n.getUniqueKey(r.colId,r.field);i=new ce(r,t,a,e),this.context.createBean(i)}return i},t.prototype.applyColumnState=function(e,t){var o=l(t.flex);if(void 0!==o&&e.setFlex(o),e.getFlex()<=0){var n=l(t.width);if(null!=n)e.setActualWidth(n);else{var r=e.getActualWidth();e.setActualWidth(r)}}void 0!==t.sort&&("asc"==t.sort||"desc"==t.sort?e.setSort(t.sort):e.setSort(void 0));var i=l(t.sortIndex);void 0!==i&&e.setSortIndex(i);var a=c(t.hide);void 0!==a&&e.setVisible(!a),void 0!==t.pinned&&e.setPinned(t.pinned)},t.prototype.findExistingColumn=function(e,t){return(t||[]).find((function(t){var o=t.getUserProvidedColDef();if(!o)return!1;var n=null!=e.colId,r=null!=e.field;return n?t.getId()===e.colId:r?o.field===e.field:o===e}))},t.prototype.findExistingGroup=function(e,t){return t.find((function(t){return!!t.getColGroupDef()&&(!(null==e.groupId)&&t.getId()===e.groupId)}))},t.prototype.mergeColDefs=function(e){var t={},o=this.gridOptionsService.get("defaultColDef");w(t,o,!1,!0);var n=e.type;n||(n=o&&o.type),n&&this.assignColumnTypes(n,t),w(t,e,!1,!0);var r=this.gridOptionsService.get("autoGroupColumnDef"),i=this.gridOptionsService.isColumnsSortingCoupledToGroup();return e.rowGroup&&r&&i&&w(t,{sort:r.sort,initialSort:r.initialSort},!1,!0),t},t.prototype.assignColumnTypes=function(e,t){var o=[];if(e instanceof Array){e.some((function(e){return"string"!==typeof e}))?console.warn("AG Grid: if colDef.type is supplied an array it should be of type 'string[]'"):o=e}else{if("string"!==typeof e)return void console.warn("AG Grid: colDef.type should be of type 'string' | 'string[]'");o=e.split(",")}var n=Object.assign({},pe);h(this.gridOptionsService.get("columnTypes")||{},(function(e,t){e in n?console.warn("AG Grid: the column type '"+e+"' is a default column type and cannot be overridden."):n[e]=t})),o.forEach((function(e){var o=n[e.trim()];o?w(t,o,!1,!0):console.warn("AG Grid: colDef.type '"+e+"' does not correspond to defined gridOptions.columnTypes")}))},t.prototype.isColumnGroup=function(e){return void 0!==e.children},ze([q("columnUtils")],t.prototype,"columnUtils",void 0),ze([He(0,J("loggerFactory"))],t.prototype,"setBeans",null),t=ze([W("columnFactory")],t)}(Fe),Ve=function(){function e(){}return e.ColDefPropertyMap={headerName:void 0,columnGroupShow:void 0,headerClass:void 0,toolPanelClass:void 0,headerValueGetter:void 0,pivotKeys:void 0,groupId:void 0,colId:void 0,sort:void 0,initialSort:void 0,field:void 0,type:void 0,tooltipComponent:void 0,tooltipField:void 0,headerTooltip:void 0,cellClass:void 0,showRowGroup:void 0,filter:void 0,initialAggFunc:void 0,defaultAggFunc:void 0,aggFunc:void 0,pinned:void 0,initialPinned:void 0,chartDataType:void 0,cellEditorPopupPosition:void 0,headerGroupComponent:void 0,headerGroupComponentFramework:void 0,headerGroupComponentParams:void 0,cellStyle:void 0,cellRenderer:void 0,cellRendererParams:void 0,cellRendererFramework:void 0,cellEditor:void 0,cellEditorFramework:void 0,cellEditorParams:void 0,filterFramework:void 0,filterParams:void 0,pivotValueColumn:void 0,headerComponent:void 0,headerComponentFramework:void 0,headerComponentParams:void 0,floatingFilterComponent:void 0,floatingFilterComponentParams:void 0,floatingFilterComponentFramework:void 0,tooltipComponentParams:void 0,tooltipComponentFramework:void 0,refData:void 0,columnsMenuParams:void 0,children:void 0,sortingOrder:void 0,allowedAggFuncs:void 0,menuTabs:void 0,pivotTotalColumnIds:void 0,cellClassRules:void 0,icons:void 0,sortIndex:void 0,initialSortIndex:void 0,flex:void 0,initialFlex:void 0,width:void 0,initialWidth:void 0,minWidth:void 0,maxWidth:void 0,rowGroupIndex:void 0,initialRowGroupIndex:void 0,pivotIndex:void 0,initialPivotIndex:void 0,suppressCellFlash:void 0,suppressColumnsToolPanel:void 0,suppressFiltersToolPanel:void 0,openByDefault:void 0,marryChildren:void 0,stickyLabel:void 0,hide:void 0,initialHide:void 0,rowGroup:void 0,initialRowGroup:void 0,pivot:void 0,initialPivot:void 0,checkboxSelection:void 0,showDisabledCheckboxes:void 0,headerCheckboxSelection:void 0,headerCheckboxSelectionFilteredOnly:void 0,headerCheckboxSelectionCurrentPageOnly:void 0,suppressMenu:void 0,suppressMovable:void 0,lockPosition:void 0,lockVisible:void 0,lockPinned:void 0,unSortIcon:void 0,suppressSizeToFit:void 0,suppressAutoSize:void 0,enableRowGroup:void 0,enablePivot:void 0,enableValue:void 0,editable:void 0,suppressPaste:void 0,suppressNavigable:void 0,enableCellChangeFlash:void 0,rowDrag:void 0,dndSource:void 0,autoHeight:void 0,wrapText:void 0,sortable:void 0,resizable:void 0,singleClickEdit:void 0,floatingFilter:void 0,cellEditorPopup:void 0,suppressFillHandle:void 0,wrapHeaderText:void 0,autoHeaderHeight:void 0,dndSourceOnRowDrag:void 0,valueGetter:void 0,valueSetter:void 0,filterValueGetter:void 0,keyCreator:void 0,valueFormatter:void 0,valueParser:void 0,comparator:void 0,equals:void 0,pivotComparator:void 0,suppressKeyboardEvent:void 0,suppressHeaderKeyboardEvent:void 0,colSpan:void 0,rowSpan:void 0,getQuickFilterText:void 0,onCellValueChanged:void 0,onCellClicked:void 0,onCellDoubleClicked:void 0,onCellContextMenu:void 0,rowDragText:void 0,tooltipValueGetter:void 0,cellRendererSelector:void 0,cellEditorSelector:void 0,spanHeaderHeight:void 0},e.ALL_PROPERTIES=Object.keys(e.ColDefPropertyMap),e.FRAMEWORK_PROPERTIES=["__ob__","__v_skip","__metadata__","mappedColumnProperties","hasChildColumns","toColDef","createColDefFromGridColumn"],e}(),$e=function(){function e(){}return e.EVENT_COLUMN_EVERYTHING_CHANGED="columnEverythingChanged",e.EVENT_NEW_COLUMNS_LOADED="newColumnsLoaded",e.EVENT_COLUMN_PIVOT_MODE_CHANGED="columnPivotModeChanged",e.EVENT_COLUMN_ROW_GROUP_CHANGED="columnRowGroupChanged",e.EVENT_EXPAND_COLLAPSE_ALL="expandOrCollapseAll",e.EVENT_COLUMN_PIVOT_CHANGED="columnPivotChanged",e.EVENT_GRID_COLUMNS_CHANGED="gridColumnsChanged",e.EVENT_COLUMN_VALUE_CHANGED="columnValueChanged",e.EVENT_COLUMN_MOVED="columnMoved",e.EVENT_COLUMN_VISIBLE="columnVisible",e.EVENT_COLUMN_PINNED="columnPinned",e.EVENT_COLUMN_GROUP_OPENED="columnGroupOpened",e.EVENT_COLUMN_RESIZED="columnResized",e.EVENT_DISPLAYED_COLUMNS_CHANGED="displayedColumnsChanged",e.EVENT_VIRTUAL_COLUMNS_CHANGED="virtualColumnsChanged",e.EVENT_ASYNC_TRANSACTIONS_FLUSHED="asyncTransactionsFlushed",e.EVENT_ROW_GROUP_OPENED="rowGroupOpened",e.EVENT_ROW_DATA_CHANGED="rowDataChanged",e.EVENT_ROW_DATA_UPDATED="rowDataUpdated",e.EVENT_PINNED_ROW_DATA_CHANGED="pinnedRowDataChanged",e.EVENT_RANGE_SELECTION_CHANGED="rangeSelectionChanged",e.EVENT_CHART_CREATED="chartCreated",e.EVENT_CHART_RANGE_SELECTION_CHANGED="chartRangeSelectionChanged",e.EVENT_CHART_OPTIONS_CHANGED="chartOptionsChanged",e.EVENT_CHART_DESTROYED="chartDestroyed",e.EVENT_TOOL_PANEL_VISIBLE_CHANGED="toolPanelVisibleChanged",e.EVENT_TOOL_PANEL_SIZE_CHANGED="toolPanelSizeChanged",e.EVENT_INTERNAL_TOOL_PANEL_VISIBLE_CHANGED="internalToolPanelVisibleChanged",e.EVENT_COLUMN_PANEL_ITEM_DRAG_START="columnPanelItemDragStart",e.EVENT_COLUMN_PANEL_ITEM_DRAG_END="columnPanelItemDragEnd",e.EVENT_MODEL_UPDATED="modelUpdated",e.EVENT_PASTE_START="pasteStart",e.EVENT_PASTE_END="pasteEnd",e.EVENT_FILL_START="fillStart",e.EVENT_FILL_END="fillEnd",e.EVENT_UNDO_STARTED="undoStarted",e.EVENT_UNDO_ENDED="undoEnded",e.EVENT_REDO_STARTED="redoStarted",e.EVENT_REDO_ENDED="redoEnded",e.EVENT_KEY_SHORTCUT_CHANGED_CELL_START="keyShortcutChangedCellStart",e.EVENT_KEY_SHORTCUT_CHANGED_CELL_END="keyShortcutChangedCellEnd",e.EVENT_CELL_CLICKED="cellClicked",e.EVENT_CELL_DOUBLE_CLICKED="cellDoubleClicked",e.EVENT_CELL_MOUSE_DOWN="cellMouseDown",e.EVENT_CELL_CONTEXT_MENU="cellContextMenu",e.EVENT_CELL_VALUE_CHANGED="cellValueChanged",e.EVENT_CELL_EDIT_REQUEST="cellEditRequest",e.EVENT_ROW_VALUE_CHANGED="rowValueChanged",e.EVENT_CELL_FOCUSED="cellFocused",e.EVENT_CELL_FOCUS_CLEARED="cellFocusCleared",e.EVENT_FULL_WIDTH_ROW_FOCUSED="fullWidthRowFocused",e.EVENT_ROW_SELECTED="rowSelected",e.EVENT_SELECTION_CHANGED="selectionChanged",e.EVENT_CELL_KEY_DOWN="cellKeyDown",e.EVENT_CELL_KEY_PRESS="cellKeyPress",e.EVENT_CELL_MOUSE_OVER="cellMouseOver",e.EVENT_CELL_MOUSE_OUT="cellMouseOut",e.EVENT_FILTER_CHANGED="filterChanged",e.EVENT_FILTER_MODIFIED="filterModified",e.EVENT_FILTER_OPENED="filterOpened",e.EVENT_SORT_CHANGED="sortChanged",e.EVENT_VIRTUAL_ROW_REMOVED="virtualRowRemoved",e.EVENT_ROW_CLICKED="rowClicked",e.EVENT_ROW_DOUBLE_CLICKED="rowDoubleClicked",e.EVENT_GRID_READY="gridReady",e.EVENT_GRID_SIZE_CHANGED="gridSizeChanged",e.EVENT_VIEWPORT_CHANGED="viewportChanged",e.EVENT_SCROLLBAR_WIDTH_CHANGED="scrollbarWidthChanged",e.EVENT_FIRST_DATA_RENDERED="firstDataRendered",e.EVENT_DRAG_STARTED="dragStarted",e.EVENT_DRAG_STOPPED="dragStopped",e.EVENT_CHECKBOX_CHANGED="checkboxChanged",e.EVENT_ROW_EDITING_STARTED="rowEditingStarted",e.EVENT_ROW_EDITING_STOPPED="rowEditingStopped",e.EVENT_CELL_EDITING_STARTED="cellEditingStarted",e.EVENT_CELL_EDITING_STOPPED="cellEditingStopped",e.EVENT_BODY_SCROLL="bodyScroll",e.EVENT_BODY_SCROLL_END="bodyScrollEnd",e.EVENT_HEIGHT_SCALE_CHANGED="heightScaleChanged",e.EVENT_PAGINATION_CHANGED="paginationChanged",e.EVENT_COMPONENT_STATE_CHANGED="componentStateChanged",e.EVENT_STORE_REFRESHED="storeRefreshed",e.EVENT_BODY_HEIGHT_CHANGED="bodyHeightChanged",e.EVENT_DISPLAYED_COLUMNS_WIDTH_CHANGED="displayedColumnsWidthChanged",e.EVENT_SCROLL_VISIBILITY_CHANGED="scrollVisibilityChanged",e.EVENT_COLUMN_HOVER_CHANGED="columnHoverChanged",e.EVENT_FLASH_CELLS="flashCells",e.EVENT_PAGINATION_PIXEL_OFFSET_CHANGED="paginationPixelOffsetChanged",e.EVENT_DISPLAYED_ROWS_CHANGED="displayedRowsChanged",e.EVENT_LEFT_PINNED_WIDTH_CHANGED="leftPinnedWidthChanged",e.EVENT_RIGHT_PINNED_WIDTH_CHANGED="rightPinnedWidthChanged",e.EVENT_ROW_CONTAINER_HEIGHT_CHANGED="rowContainerHeightChanged",e.EVENT_HEADER_HEIGHT_CHANGED="headerHeightChanged",e.EVENT_COLUMN_HEADER_HEIGHT_CHANGED="columnHeaderHeightChanged",e.EVENT_ROW_DRAG_ENTER="rowDragEnter",e.EVENT_ROW_DRAG_MOVE="rowDragMove",e.EVENT_ROW_DRAG_LEAVE="rowDragLeave",e.EVENT_ROW_DRAG_END="rowDragEnd",e.EVENT_GRID_STYLES_CHANGED="gridStylesChanged",e.EVENT_POPUP_TO_FRONT="popupToFront",e.EVENT_COLUMN_ROW_GROUP_CHANGE_REQUEST="columnRowGroupChangeRequest",e.EVENT_COLUMN_PIVOT_CHANGE_REQUEST="columnPivotChangeRequest",e.EVENT_COLUMN_VALUE_CHANGE_REQUEST="columnValueChangeRequest",e.EVENT_COLUMN_AGG_FUNC_CHANGE_REQUEST="columnAggFuncChangeRequest",e.EVENT_KEYBOARD_FOCUS="keyboardFocus",e.EVENT_MOUSE_FOCUS="mouseFocus",e.EVENT_STORE_UPDATED="storeUpdated",e.EVENT_FILTER_DESTROYED="filterDestroyed",e}(),Ue=function(e,t){var o="function"===typeof Symbol&&e[Symbol.iterator];if(!o)return e;var n,r,i=o.call(e),a=[];try{for(;(void 0===t||t-- >0)&&!(n=i.next()).done;)a.push(n.value)}catch(s){r={error:s}}finally{try{n&&!n.done&&(o=i.return)&&o.call(i)}finally{if(r)throw r.error}}return a},We=function(){for(var e=[],t=0;t<arguments.length;t++)e=e.concat(Ue(arguments[t]));return e},qe=function(){function e(){}return e.STRING_PROPERTIES=["rowSelection","overlayLoadingTemplate","overlayNoRowsTemplate","quickFilterText","rowModelType","editType","domLayout","clipboardDelimiter","rowGroupPanelShow","multiSortKey","pivotColumnGroupTotals","pivotRowTotals","pivotPanelShow","fillHandleDirection","serverSideStoreType","groupDisplayType","treeDataDisplayType","colResizeDefault"],e.OBJECT_PROPERTIES=["components","frameworkComponents","rowStyle","context","autoGroupColumnDef","localeText","icons","datasource","serverSideDatasource","viewportDatasource","groupRowRendererParams","aggFuncs","fullWidthCellRendererParams","defaultColGroupDef","defaultColDef","defaultCsvExportParams","defaultExcelExportParams","columnTypes","rowClassRules","detailCellRendererParams","loadingCellRendererParams","loadingOverlayComponentParams","noRowsOverlayComponentParams","popupParent","statusBar","sideBar","chartThemeOverrides","customChartThemes","chartToolPanelsDef"],e.ARRAY_PROPERTIES=["sortingOrder","alignedGrids","rowData","columnDefs","excelStyles","pinnedTopRowData","pinnedBottomRowData","chartThemes","rowClass"],e.NUMBER_PROPERTIES=["rowHeight","detailRowHeight","rowBuffer","headerHeight","groupHeaderHeight","floatingFiltersHeight","pivotHeaderHeight","pivotGroupHeaderHeight","groupDefaultExpanded","viewportRowModelPageSize","viewportRowModelBufferSize","autoSizePadding","maxBlocksInCache","maxConcurrentDatasourceRequests","tooltipShowDelay","tooltipHideDelay","cacheOverflowSize","paginationPageSize","cacheBlockSize","infiniteInitialRowCount","serverSideInitialRowCount","scrollbarWidth","asyncTransactionWaitMillis","blockLoadDebounceMillis","keepDetailRowsCount","undoRedoCellEditingLimit","cellFlashDelay","cellFadeDelay","tabIndex"],e.BOOLEAN_PROPERTIES=["suppressMakeColumnVisibleAfterUnGroup","suppressRowClickSelection","suppressCellSelection","suppressCellFocus","suppressHorizontalScroll","alwaysShowHorizontalScroll","alwaysShowVerticalScroll","debug","enableBrowserTooltips","enableCellExpressions","groupSelectsChildren","groupIncludeFooter","groupIncludeTotalFooter","groupSuppressBlankHeader","suppressMenuHide","suppressRowDeselection","unSortIcon","suppressMultiSort","alwaysMultiSort","singleClickEdit","suppressLoadingOverlay","suppressNoRowsOverlay","suppressAutoSize","skipHeaderOnAutoSize","suppressParentsInRowNodes","suppressColumnMoveAnimation","suppressMovableColumns","suppressFieldDotNotation","enableRangeSelection","enableRangeHandle","enableFillHandle","suppressClearOnFillReduction","deltaSort","suppressTouch","suppressAsyncEvents","allowContextMenuWithControlKey","suppressContextMenu","rememberGroupStateWhenNewData","enableCellChangeFlash","suppressDragLeaveHidesColumns","suppressRowGroupHidesColumns","suppressMiddleClickScrolls","suppressPreventDefaultOnMouseWheel","suppressCopyRowsToClipboard","copyHeadersToClipboard","copyGroupHeadersToClipboard","pivotMode","suppressAggFuncInHeader","suppressColumnVirtualisation","suppressAggAtRootLevel","suppressFocusAfterRefresh","functionsPassive","functionsReadOnly","animateRows","groupSelectsFiltered","groupRemoveSingleChildren","groupRemoveLowestSingleChildren","enableRtl","suppressClickEdit","rowDragEntireRow","rowDragManaged","suppressRowDrag","suppressMoveWhenRowDragging","rowDragMultiRow","enableGroupEdit","embedFullWidthRows","suppressPaginationPanel","groupHideOpenParents","groupAllowUnbalanced","pagination","paginationAutoPageSize","suppressScrollOnNewData","suppressScrollWhenPopupsAreOpen","purgeClosedRowNodes","cacheQuickFilter","excludeHiddenColumnsFromQuickFilter","ensureDomOrder","accentedSort","suppressChangeDetection","valueCache","valueCacheNeverExpires","aggregateOnlyChangedColumns","suppressAnimationFrame","suppressExcelExport","suppressCsvExport","treeData","masterDetail","suppressMultiRangeSelection","enterMovesDownAfterEdit","enterMovesDown","suppressPropertyNamesCheck","rowMultiSelectWithClick","suppressRowHoverHighlight","suppressRowTransform","suppressClipboardPaste","suppressLastEmptyLineOnPaste","enableCharts","enableChartToolPanelsButton","suppressChartToolPanelsButton","suppressMaintainUnsortedOrder","enableCellTextSelection","suppressBrowserResizeObserver","suppressMaxRenderedRowRestriction","excludeChildrenWhenTreeDataFiltering","tooltipMouseTrack","keepDetailRows","paginateChildRows","preventDefaultOnContextMenu","undoRedoCellEditing","allowDragFromColumnsToolPanel","immutableData","pivotSuppressAutoColumn","suppressExpandablePivotGroups","debounceVerticalScrollbar","detailRowAutoHeight","serverSideFilteringAlwaysResets","serverSideSortingAlwaysResets","serverSideSortAllLevels","serverSideFilterAllLevels","serverSideSortOnServer","serverSideFilterOnServer","suppressAggFilteredOnly","showOpenedGroup","suppressClipboardApi","suppressModelUpdateAfterUpdateTransaction","stopEditingWhenCellsLoseFocus","maintainColumnOrder","groupMaintainOrder","columnHoverHighlight","reactUi","suppressReactUi","readOnlyEdit","suppressRowVirtualisation","enableCellEditingOnBackspace","resetRowDataOnUpdate","removePivotHeaderRowWhenSingleValueColumn","suppressCopySingleCellRanges","groupRowsSticky","suppressServerSideInfiniteScroll","rowGroupPanelSuppressSort","allowShowChangeAfterFilter","suppressCutToClipboard"],e.FUNCTIONAL_PROPERTIES=["localeTextFunc","doesExternalFilterPass","groupRowAggNodes","isFullWidthCell","processSecondaryColDef","processSecondaryColGroupDef","processPivotResultColDef","processPivotResultColGroupDef","getBusinessKeyForNode","isRowSelectable","postSort","defaultGroupOrderComparator","rowDragText","groupRowRenderer","groupRowRendererFramework","fullWidthCellRenderer","fullWidthCellRendererFramework","loadingCellRenderer","loadingCellRendererFramework","loadingOverlayComponent","loadingOverlayComponentFramework","noRowsOverlayComponent","noRowsOverlayComponentFramework","detailCellRenderer","detailCellRendererFramework"],e.CALLBACK_PROPERTIES=["getLocaleText","isExternalFilterPresent","getRowHeight","getRowClass","getRowStyle","getContextMenuItems","getMainMenuItems","processRowPostCreate","processCellForClipboard","getGroupRowAgg","getRowNodeId","isFullWidthRow","sendToClipboard","navigateToNextHeader","tabToNextHeader","navigateToNextCell","tabToNextCell","processCellFromClipboard","getDocument","postProcessPopup","getChildCount","getDataPath","isRowMaster","postSortRows","processHeaderForClipboard","processGroupHeaderForClipboard","paginationNumberFormatter","processDataFromClipboard","getServerSideGroupKey","isServerSideGroup","createChartContainer","getChartToolbarItems","fillOperation","isApplyServerSideTransaction","getServerSideStoreParams","getServerSideGroupLevelParams","isServerSideGroupOpenByDefault","isGroupOpenByDefault","initialGroupOrderComparator","loadingCellRendererSelector","getRowId","groupAggFiltering"],e.FUNCTION_PROPERTIES=We(e.FUNCTIONAL_PROPERTIES,e.CALLBACK_PROPERTIES),e.ALL_PROPERTIES=We(e.ARRAY_PROPERTIES,e.OBJECT_PROPERTIES,e.STRING_PROPERTIES,e.NUMBER_PROPERTIES,e.FUNCTION_PROPERTIES,e.BOOLEAN_PROPERTIES),e.FRAMEWORK_PROPERTIES=["__ob__","__v_skip","__metadata__","mappedColumnProperties","hasChildColumns","toColDef","createColDefFromGridColumn"],e}(),Ke=function(){return Ke=Object.assign||function(e){for(var t,o=1,n=arguments.length;o<n;o++)for(var r in t=arguments[o])Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e},Ke.apply(this,arguments)},Ye=function(e,t){var o="function"===typeof Symbol&&e[Symbol.iterator];if(!o)return e;var n,r,i=o.call(e),a=[];try{for(;(void 0===t||t-- >0)&&!(n=i.next()).done;)a.push(n.value)}catch(s){r={error:s}}finally{try{n&&!n.done&&(o=i.return)&&o.call(i)}finally{if(r)throw r.error}}return a},Je=function(){for(var e=[],t=0;t<arguments.length;t++)e=e.concat(Ye(arguments[t]));return e},Xe=function(){function e(){}return e.getCallbackForEvent=function(e){return!e||e.length<2?e:"on"+e[0].toUpperCase()+e.substr(1)},e.getCoercionLookup=function(){var t={};return Je(e.ARRAY_PROPERTIES,e.OBJECT_PROPERTIES,e.STRING_PROPERTIES,e.FUNCTION_PROPERTIES,e.EVENT_CALLBACKS).forEach((function(e){return t[e]="none"})),e.BOOLEAN_PROPERTIES.forEach((function(e){return t[e]="boolean"})),e.NUMBER_PROPERTIES.forEach((function(e){return t[e]="number"})),t},e.getValue=function(t,o){var n=e.coercionLookup[t];if(n){var r=o;switch(n){case"number":r=e.toNumber(o);break;case"boolean":r=e.toBoolean(o);break;case"none":"groupAggFiltering"===t&&"function"!==typeof o&&(r=e.toBoolean(o))}return r}},e.getGridOptionKeys=function(t,o){return o?Object.keys(e.coercionLookup):Object.keys(t)},e.copyAttributesToGridOptions=function(t,o,n){void 0===n&&(n=!1),"object"!==typeof t&&(t={});var r=t;return e.getGridOptionKeys(o,n).forEach((function(t){var n=o[t];if("undefined"!==typeof n){var i=e.getValue(t,n);void 0!==i&&(r[t]=i)}})),t},e.processOnChange=function(t,o){if(t&&0!==Object.keys(t).length){var n=Ke({},t);n.columnTypes&&(o.setColumnTypes(n.columnTypes.currentValue,"gridOptionsChanged"),delete n.columnTypes),n.autoGroupColumnDef&&(o.setAutoGroupColumnDef(n.autoGroupColumnDef.currentValue,"gridOptionsChanged"),delete n.autoGroupColumnDef),n.defaultColDef&&(o.setDefaultColDef(n.defaultColDef.currentValue,"gridOptionsChanged"),delete n.defaultColDef),n.columnDefs&&(o.setColumnDefs(n.columnDefs.currentValue,"gridOptionsChanged"),delete n.columnDefs),Object.keys(n).forEach((function(t){var r=t,i=e.getValue(r,n[r].currentValue);o.__setProperty(r,i)}));var r={type:$e.EVENT_COMPONENT_STATE_CHANGED};h(t,(function(e,t){r[e]=t})),o.dispatchEvent(r)}},e.toBoolean=function(e){return"boolean"===typeof e?e:"string"===typeof e&&("TRUE"===e.toUpperCase()||""==e)},e.toNumber=function(e){return"number"===typeof e?e:"string"===typeof e?Number(e):void 0},e.EVENTS=d($e),e.EXCLUDED_INTERNAL_EVENTS=[$e.EVENT_SCROLLBAR_WIDTH_CHANGED,$e.EVENT_CHECKBOX_CHANGED,$e.EVENT_HEIGHT_SCALE_CHANGED,$e.EVENT_BODY_HEIGHT_CHANGED,$e.EVENT_DISPLAYED_COLUMNS_WIDTH_CHANGED,$e.EVENT_SCROLL_VISIBILITY_CHANGED,$e.EVENT_COLUMN_HOVER_CHANGED,$e.EVENT_FLASH_CELLS,$e.EVENT_PAGINATION_PIXEL_OFFSET_CHANGED,$e.EVENT_DISPLAYED_ROWS_CHANGED,$e.EVENT_LEFT_PINNED_WIDTH_CHANGED,$e.EVENT_RIGHT_PINNED_WIDTH_CHANGED,$e.EVENT_ROW_CONTAINER_HEIGHT_CHANGED,$e.EVENT_POPUP_TO_FRONT,$e.EVENT_KEYBOARD_FOCUS,$e.EVENT_MOUSE_FOCUS,$e.EVENT_STORE_UPDATED,$e.EVENT_COLUMN_PANEL_ITEM_DRAG_START,$e.EVENT_COLUMN_PANEL_ITEM_DRAG_END,$e.EVENT_FILL_START,$e.EVENT_FILL_END,$e.EVENT_KEY_SHORTCUT_CHANGED_CELL_START,$e.EVENT_KEY_SHORTCUT_CHANGED_CELL_END,$e.EVENT_FULL_WIDTH_ROW_FOCUSED,$e.EVENT_HEADER_HEIGHT_CHANGED,$e.EVENT_COLUMN_HEADER_HEIGHT_CHANGED,$e.EVENT_INTERNAL_TOOL_PANEL_VISIBLE_CHANGED,$e.EVENT_CELL_FOCUS_CLEARED,$e.EVENT_GRID_STYLES_CHANGED,$e.EVENT_FILTER_DESTROYED],e.PUBLIC_EVENTS=e.EVENTS.filter((function(t){return!we(e.EXCLUDED_INTERNAL_EVENTS,t)})),e.EVENT_CALLBACKS=e.EVENTS.map((function(t){return e.getCallbackForEvent(t)})),e.STRING_PROPERTIES=qe.STRING_PROPERTIES,e.OBJECT_PROPERTIES=qe.OBJECT_PROPERTIES,e.ARRAY_PROPERTIES=qe.ARRAY_PROPERTIES,e.NUMBER_PROPERTIES=qe.NUMBER_PROPERTIES,e.BOOLEAN_PROPERTIES=qe.BOOLEAN_PROPERTIES,e.FUNCTION_PROPERTIES=qe.FUNCTION_PROPERTIES,e.ALL_PROPERTIES=qe.ALL_PROPERTIES,e.ALL_PROPERTIES_SET=new Set(qe.ALL_PROPERTIES),e.coercionLookup=e.getCoercionLookup(),e}();function Qe(e,t,o){var n={},r=e.filter((function(e){return!t.some((function(t){return t===e}))}));return r.length>0&&r.forEach((function(e){return n[e]=Ze(e,o)})),n}function Ze(e,t,o,n){var r=t.map((function(t){return{value:t,relevance:et(e.toLowerCase(),t.toLocaleLowerCase())}}));if(r.sort((function(e,t){return t.relevance-e.relevance})),o&&(r=r.filter((function(e){return 0!==e.relevance}))),n&&n>0){var i=r[0].relevance*n;r=r.filter((function(e){return i-e.relevance<0}))}return r.map((function(e){return e.value}))}function et(e,t){for(var o=e.replace(/\s/g,""),n=t.replace(/\s/g,""),r=0,i=-1,a=0;a<o.length;a++){var s=n.indexOf(o[a],i+1);-1!==s&&(r+=100-100*(i=s)/1e4*100)}return r}var tt=Object.freeze({__proto__:null,fuzzyCheckStrings:Qe,fuzzySuggestions:Ze}),ot=function(e,t,o,n){var r,i=arguments.length,a=i<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,o):n;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)a=Reflect.decorate(e,t,o,n);else for(var s=e.length-1;s>=0;s--)(r=e[s])&&(a=(i<3?r(a):i>3?r(t,o,a):r(t,o))||a);return i>3&&a&&Object.defineProperty(t,o,a),a},nt=function(e,t){var o="function"===typeof Symbol&&e[Symbol.iterator];if(!o)return e;var n,r,i=o.call(e),a=[];try{for(;(void 0===t||t-- >0)&&!(n=i.next()).done;)a.push(n.value)}catch(s){r={error:s}}finally{try{n&&!n.done&&(o=i.return)&&o.call(i)}finally{if(r)throw r.error}}return a},rt=function(){for(var e=[],t=0;t<arguments.length;t++)e=e.concat(nt(arguments[t]));return e};function it(e,t,o,n){var r=o?"Please use '"+o+"' instead. ":"";j((function(){return console.warn("AG Grid: since v"+e+", '"+t+"' is deprecated. "+r+(null!==n&&void 0!==n?n:""))}),"Deprecated_"+t)}var at=function(){function e(){this.deprecatedProperties={serverSideInfiniteScroll:{version:"29",message:"Infinite Scrolling is now the default behaviour. This can be suppressed with `suppressServerSideInfiniteScroll`."},rememberGroupStateWhenNewData:{version:"24",message:"Now that transaction updates are possible and they keep group state, this feature is no longer needed."},suppressEnterpriseResetOnNewColumns:{version:"25",message:"Now that it is possible to dynamically change columns in the grid, this is no longer needed."},suppressColumnStateEvents:{version:"25",message:'Events should be ignored based on the `event.source`, which will be "api" if the event was due to setting column state via the API.'},defaultExportParams:{version:"25.2",message:"The property `defaultExportParams` has been replaced by `defaultCsvExportParams` and `defaultExcelExportParams`"},stopEditingWhenGridLosesFocus:{version:"25.2.2",newProp:"stopEditingWhenCellsLoseFocus",copyToNewProp:!0},applyColumnDefOrder:{version:"26",message:"The property `applyColumnDefOrder` is no longer needed, as this is the default behaviour. To turn this behaviour off, set maintainColumnOrder=true"},groupMultiAutoColumn:{version:"26",newProp:"groupDisplayType",copyToNewProp:!0,newPropValue:"multipleColumns"},groupUseEntireRow:{version:"26",newProp:"groupDisplayType",copyToNewProp:!0,newPropValue:"groupRows"},defaultGroupSortComparator:{version:"26",newProp:"initialGroupOrderComparator"},enableMultiRowDragging:{version:"26.1",newProp:"rowDragMultiRow",copyToNewProp:!0},colWidth:{version:"26.1",newProp:"defaultColDef.width"},minColWidth:{version:"26.1",newProp:"defaultColDef.minWidth"},maxColWidth:{version:"26.1",newProp:"defaultColDef.maxWidth"},reactUi:{version:"26.1",message:"React UI is on by default, so no need for reactUi=true. To turn it off, set suppressReactUi=true."},suppressCellSelection:{version:"27",newProp:"suppressCellFocus",copyToNewProp:!0},clipboardDeliminator:{version:"27.1",newProp:"clipboardDelimiter",copyToNewProp:!0},getRowNodeId:{version:"27.1",newProp:"getRowId",message:"The difference: if getRowId() is implemented then immutable data is enabled by default."},defaultGroupOrderComparator:{version:"27.2",newProp:"initialGroupOrderComparator"},groupRowAggNodes:{version:"27.2",newProp:"getGroupRowAgg"},postSort:{version:"27.2",newProp:"postSortRows"},isFullWidthCell:{version:"27.2",newProp:"isFullWidthRow"},localeTextFunc:{version:"27.2",newProp:"getLocaleText"},serverSideFilteringAlwaysResets:{version:"28.0",newProp:"serverSideFilterAllLevels",copyToNewProp:!0},serverSideSortingAlwaysResets:{version:"28.0",newProp:"serverSideSortAllLevels",copyToNewProp:!0},suppressReactUi:{version:"28",message:"The legacy React rendering engine is deprecated and will be removed in the next major version of the grid."},processSecondaryColDef:{version:"28",newProp:"processPivotResultColDef",copyToNewProp:!0},processSecondaryColGroupDef:{version:"28",newProp:"processPivotResultColGroupDef",copyToNewProp:!0},getServerSideStoreParams:{version:"28",newProp:"getServerSideGroupLevelParams",copyToNewProp:!0},enableChartToolPanelsButton:{version:"29",message:"The Chart Tool Panels button is now enabled by default. To hide the Chart Tool Panels button and display the hamburger button instead, set suppressChartToolPanelsButton=true."},functionsPassive:{version:"29.2"},onColumnRowGroupChangeRequest:{version:"29.2"},onColumnPivotChangeRequest:{version:"29.2"},onColumnValueChangeRequest:{version:"29.2"},onColumnAggFuncChangeRequest:{version:"29.2"}}}return e.prototype.pickOneWarning=function(e,t){console.warn("AG Grid: "+e+" and "+t+" do not work with each other, you need to pick one.")},e.prototype.init=function(){var e=this;if(this.checkForDeprecated(),this.checkForViolations(),!0!==this.gridOptions.suppressPropertyNamesCheck&&(this.checkGridOptionsProperties(),this.checkColumnDefProperties()),this.checkColumnDefViolations(),this.gridOptionsService.is("groupSelectsChildren")&&this.gridOptionsService.is("suppressParentsInRowNodes")&&console.warn("AG Grid: 'groupSelectsChildren' does not work with 'suppressParentsInRowNodes', this selection method needs the part in rowNode to work"),this.gridOptionsService.is("groupSelectsChildren")&&"multiple"!==this.gridOptionsService.get("rowSelection")&&console.warn("AG Grid: rowSelection must be 'multiple' for groupSelectsChildren to make sense"),this.gridOptionsService.is("groupRemoveSingleChildren")&&this.gridOptionsService.is("groupHideOpenParents")&&this.pickOneWarning("groupRemoveSingleChildren","groupHideOpenParents"),"autoHeight"!==this.gridOptionsService.get("domLayout")||this.gridOptionsService.isRowModelType("clientSide")||this.gridOptionsService.is("pagination")||(console.warn("AG Grid: domLayout='autoHeight' was ignored as it is only supported by the Client-Side row model, unless using pagination."),this.gridOptions.domLayout="normal"),this.gridOptionsService.isRowModelType("serverSide")){var t=function(e,t){return"AG Grid: '"+e+"' is not supported on the Server-Side Row Model."+(t?" Please use "+t+" instead.":"")};this.gridOptionsService.exists("groupDefaultExpanded")&&console.warn(t("groupDefaultExpanded","isServerSideGroupOpenByDefault callback")),this.gridOptionsService.exists("groupIncludeFooter")&&console.warn(t("groupIncludeFooter")),this.gridOptionsService.exists("groupIncludeTotalFooter")&&console.warn(t("groupIncludeTotalFooter"))}this.gridOptionsService.is("enableRangeSelection")?ne.assertRegistered(Q.RangeSelectionModule,"enableRangeSelection"):(this.gridOptionsService.is("enableRangeHandle")||this.gridOptionsService.is("enableFillHandle"))&&console.warn("AG Grid: 'enableRangeHandle' or 'enableFillHandle' will not work unless 'enableRangeSelection' is set to true");var o=function(t,o){return e.gridOptionsService.exists(t)&&ne.assertRegistered(o,t)};o("sideBar",Q.SideBarModule),o("statusBar",Q.StatusBarModule),o("enableCharts",Q.GridChartsModule),o("getMainMenuItems",Q.MenuModule),o("getContextMenuItems",Q.MenuModule),o("allowContextMenuWithControlKey",Q.MenuModule),this.gridOptionsService.is("groupRowsSticky")&&(this.gridOptionsService.is("groupHideOpenParents")&&this.pickOneWarning("groupRowsSticky","groupHideOpenParents"),this.gridOptionsService.is("masterDetail")&&this.pickOneWarning("groupRowsSticky","masterDetail"),this.gridOptionsService.is("pagination")&&this.pickOneWarning("groupRowsSticky","pagination"))},e.prototype.checkColumnDefProperties=function(){var e=this;if(null!=this.gridOptions.columnDefs){var t=rt(Ve.ALL_PROPERTIES,Ve.FRAMEWORK_PROPERTIES),o=function(n,r){var i=Object.getOwnPropertyNames(n);e.checkProperties(i,t,t,r,"https://www.ag-grid.com/javascript-data-grid/column-properties/"),n.children&&n.children.forEach((function(e){return o(e,"columnDefs.children")}))};this.gridOptions.columnDefs.forEach((function(e){return o(e,"columnDefs")})),this.gridOptions.defaultColDef&&o(this.gridOptions.defaultColDef,"defaultColDef")}},e.prototype.checkColumnDefViolations=function(){var e,t=null!==(e=this.gridOptionsService.get("rowModelType"))&&void 0!==e?e:"clientSide",o={infinite:["headerCheckboxSelection","headerCheckboxSelectionFilteredOnly","headerCheckboxSelectionCurrentPageOnly"],viewport:["headerCheckboxSelection","headerCheckboxSelectionFilteredOnly","headerCheckboxSelectionCurrentPageOnly"],serverSide:["headerCheckboxSelectionFilteredOnly","headerCheckboxSelectionCurrentPageOnly"],clientSide:[]}[t];if(null===o||void 0===o?void 0:o.length){var n=function(e){o.forEach((function(o){o in e&&e[o]&&console.warn("AG Grid: Column property "+o+" is not supported with the row model type "+t+".")}))};null!=this.gridOptions.columnDefs&&this.gridOptions.columnDefs.forEach((function(e){return n(e)})),null!=this.gridOptions.autoGroupColumnDef&&n(this.gridOptions.autoGroupColumnDef),null!=this.gridOptions.defaultColDef&&n(this.gridOptions.defaultColDef)}},e.prototype.checkGridOptionsProperties=function(){var e=Object.getOwnPropertyNames(this.gridOptions),t=rt(qe.ALL_PROPERTIES,qe.FRAMEWORK_PROPERTIES,Xe.EVENT_CALLBACKS),o=rt(t,["api","columnApi"],Object.keys(this.deprecatedProperties));this.checkProperties(e,o,t,"gridOptions","https://www.ag-grid.com/javascript-data-grid/grid-options/")},e.prototype.checkProperties=function(e,t,o,n,r){var i=Qe(e,t,o);h(i,(function(e,t){j((function(){return console.warn("AG Grid: invalid "+n+" property '"+e+"' did you mean any of these: "+t.slice(0,8).join(", "))}),"invalidProperty"+n+e)})),Object.keys(i).length>0&&j((function(){return console.warn("AG Grid: to see all the valid "+n+" properties please check: "+r)}),"invalidProperties"+n+r)},e.prototype.checkForDeprecated=function(){var e=this.gridOptions;if(Object.entries(this.deprecatedProperties).forEach((function(t){var o,n=nt(t,2),r=n[0],i=n[1],a=e[r];a&&(it(i.version,r,i.newProp,i.message),i.copyToNewProp&&i.newProp&&null==e[i.newProp]&&(e[i.newProp]=null!==(o=i.newPropValue)&&void 0!==o?o:a))})),e.groupSuppressAutoColumn){var t=e.treeData?"treeDataDisplayType":"groupDisplayType";console.warn("AG Grid: since v26.0, the grid property `groupSuppressAutoColumn` has been replaced by `"+t+" = 'custom'`"),e[t]="custom"}e.immutableData&&(e.getRowId?console.warn("AG Grid: since v27.1, `immutableData` is deprecated. With the `getRowId` callback implemented, immutable data is enabled by default so you can remove `immutableData=true`."):console.warn("AG Grid: since v27.1, `immutableData` is deprecated. To enable immutable data you must implement the `getRowId()` callback.")),e.serverSideStoreType&&(console.warn("AG Grid: since v29.0, `serverSideStoreType` has been replaced by `suppressServerSideInfiniteScroll`. Set to false to use Partial Store, and true to use Full Store."),e.suppressServerSideInfiniteScroll="partial"!==e.serverSideStoreType)},e.prototype.checkForViolations=function(){this.gridOptionsService.is("treeData")&&this.treeDataViolations()},e.prototype.treeDataViolations=function(){this.gridOptionsService.isRowModelType("clientSide")&&(this.gridOptionsService.exists("getDataPath")||console.warn("AG Grid: property usingTreeData=true with rowModel=clientSide, but you did not provide getDataPath function, please provide getDataPath function if using tree data.")),this.gridOptionsService.isRowModelType("serverSide")&&(this.gridOptionsService.exists("isServerSideGroup")||console.warn("AG Grid: property usingTreeData=true with rowModel=serverSide, but you did not provide isServerSideGroup function, please provide isServerSideGroup function if using tree data."),this.gridOptionsService.exists("getServerSideGroupKey")||console.warn("AG Grid: property usingTreeData=true with rowModel=serverSide, but you did not provide getServerSideGroupKey function, please provide getServerSideGroupKey function if using tree data."))},ot([q("gridOptions")],e.prototype,"gridOptions",void 0),ot([q("gridOptionsService")],e.prototype,"gridOptionsService",void 0),ot([$],e.prototype,"init",null),e=ot([W("gridOptionsValidator")],e)}();function st(e,t){var o=["groupRows","multipleColumns","custom","singleColumn"];return o.indexOf(t)<0?(console.warn("AG Grid: '"+t+"' is not a valid groupDisplayType value - possible values are: '"+o.join("', '")+"'"),!1):t===e}var lt=function(e,t,o,n){var r,i=arguments.length,a=i<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,o):n;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)a=Reflect.decorate(e,t,o,n);else for(var s=e.length-1;s>=0;s--)(r=e[s])&&(a=(i<3?r(a):i>3?r(t,o,a):r(t,o))||a);return i>3&&a&&Object.defineProperty(t,o,a),a},ct=function(){function e(e,t,o,n){this.displayedChildren=[],this.localEventService=new te,this.groupId=t,this.partId=o,this.providedColumnGroup=e,this.pinned=n}return e.createUniqueId=function(e,t){return e+"_"+t},e.prototype.reset=function(){this.parent=null,this.children=null,this.displayedChildren=null},e.prototype.getParent=function(){return this.parent},e.prototype.setParent=function(e){this.parent=e},e.prototype.getUniqueId=function(){return e.createUniqueId(this.groupId,this.partId)},e.prototype.isEmptyGroup=function(){return 0===this.displayedChildren.length},e.prototype.isMoving=function(){var e=this.getProvidedColumnGroup().getLeafColumns();return!(!e||0===e.length)&&e.every((function(e){return e.isMoving()}))},e.prototype.checkLeft=function(){if(this.displayedChildren.forEach((function(t){t instanceof e&&t.checkLeft()})),this.displayedChildren.length>0)if(this.gridOptionsService.is("enableRtl")){var t=fe(this.displayedChildren).getLeft();this.setLeft(t)}else{var o=this.displayedChildren[0].getLeft();this.setLeft(o)}else this.setLeft(null)},e.prototype.getLeft=function(){return this.left},e.prototype.getOldLeft=function(){return this.oldLeft},e.prototype.setLeft=function(t){this.oldLeft=t,this.left!==t&&(this.left=t,this.localEventService.dispatchEvent(this.createAgEvent(e.EVENT_LEFT_CHANGED)))},e.prototype.getPinned=function(){return this.pinned},e.prototype.createAgEvent=function(e){return{type:e}},e.prototype.addEventListener=function(e,t){this.localEventService.addEventListener(e,t)},e.prototype.removeEventListener=function(e,t){this.localEventService.removeEventListener(e,t)},e.prototype.getGroupId=function(){return this.groupId},e.prototype.getPartId=function(){return this.partId},e.prototype.isChildInThisGroupDeepSearch=function(t){var o=!1;return this.children.forEach((function(n){t===n&&(o=!0),n instanceof e&&n.isChildInThisGroupDeepSearch(t)&&(o=!0)})),o},e.prototype.getActualWidth=function(){var e=0;return this.displayedChildren&&this.displayedChildren.forEach((function(t){e+=t.getActualWidth()})),e},e.prototype.isResizable=function(){if(!this.displayedChildren)return!1;var e=!1;return this.displayedChildren.forEach((function(t){t.isResizable()&&(e=!0)})),e},e.prototype.getMinWidth=function(){var e=0;return this.displayedChildren.forEach((function(t){e+=t.getMinWidth()||0})),e},e.prototype.addChild=function(e){this.children||(this.children=[]),this.children.push(e)},e.prototype.getDisplayedChildren=function(){return this.displayedChildren},e.prototype.getLeafColumns=function(){var e=[];return this.addLeafColumns(e),e},e.prototype.getDisplayedLeafColumns=function(){var e=[];return this.addDisplayedLeafColumns(e),e},e.prototype.getDefinition=function(){return this.providedColumnGroup.getColGroupDef()},e.prototype.getColGroupDef=function(){return this.providedColumnGroup.getColGroupDef()},e.prototype.isPadding=function(){return this.providedColumnGroup.isPadding()},e.prototype.isExpandable=function(){return this.providedColumnGroup.isExpandable()},e.prototype.isExpanded=function(){return this.providedColumnGroup.isExpanded()},e.prototype.setExpanded=function(e){this.providedColumnGroup.setExpanded(e)},e.prototype.addDisplayedLeafColumns=function(t){this.displayedChildren.forEach((function(o){o instanceof ce?t.push(o):o instanceof e&&o.addDisplayedLeafColumns(t)}))},e.prototype.addLeafColumns=function(t){this.children.forEach((function(o){o instanceof ce?t.push(o):o instanceof e&&o.addLeafColumns(t)}))},e.prototype.getChildren=function(){return this.children},e.prototype.getColumnGroupShow=function(){return this.providedColumnGroup.getColumnGroupShow()},e.prototype.getProvidedColumnGroup=function(){return this.providedColumnGroup},e.prototype.getOriginalColumnGroup=function(){return it("27","getOriginalColumnGroup","getProvidedColumnGroup"),this.getProvidedColumnGroup()},e.prototype.getPaddingLevel=function(){var e=this.getParent();return this.isPadding()&&e&&e.isPadding()?1+e.getPaddingLevel():0},e.prototype.calculateDisplayedColumns=function(){var t=this;this.displayedChildren=[];for(var o=this;null!=o&&o.isPadding();)o=o.getParent();if(!(!!o&&o.providedColumnGroup.isExpandable()))return this.displayedChildren=this.children,void this.localEventService.dispatchEvent(this.createAgEvent(e.EVENT_DISPLAYED_CHILDREN_CHANGED));this.children.forEach((function(n){if(!(n instanceof e&&(!n.displayedChildren||!n.displayedChildren.length)))switch(n.getColumnGroupShow()){case"open":o.providedColumnGroup.isExpanded()&&t.displayedChildren.push(n);break;case"closed":o.providedColumnGroup.isExpanded()||t.displayedChildren.push(n);break;default:t.displayedChildren.push(n)}})),this.localEventService.dispatchEvent(this.createAgEvent(e.EVENT_DISPLAYED_CHILDREN_CHANGED))},e.EVENT_LEFT_CHANGED="leftChanged",e.EVENT_DISPLAYED_CHILDREN_CHANGED="displayedChildrenChanged",lt([q("gridOptionsService")],e.prototype,"gridOptionsService",void 0),e}(),dt=function(){function e(){this.existingIds={}}return e.prototype.getInstanceIdForKey=function(e){var t,o=this.existingIds[e];return t="number"!==typeof o?0:o+1,this.existingIds[e]=t,t},e}(),ut=function(){var e=function(t,o){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])},e(t,o)};return function(t,o){function n(){this.constructor=t}e(t,o),t.prototype=null===o?Object.create(o):(n.prototype=o.prototype,new n)}}(),pt=function(e,t,o,n){var r,i=arguments.length,a=i<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,o):n;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)a=Reflect.decorate(e,t,o,n);else for(var s=e.length-1;s>=0;s--)(r=e[s])&&(a=(i<3?r(a):i>3?r(t,o,a):r(t,o))||a);return i>3&&a&&Object.defineProperty(t,o,a),a},ht="ag-Grid-AutoColumn",ft=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return ut(t,e),t.prototype.createAutoGroupColumns=function(e,t){var o=this,n=[],r=this.gridOptionsService.isTreeData(),i=this.gridOptionsService.isGroupMultiAutoColumn();return r&&i&&(console.warn('AG Grid: you cannot mix groupDisplayType = "multipleColumns" with treeData, only one column can be used to display groups when doing tree data'),i=!1),i?t.forEach((function(t,r){n.push(o.createOneAutoGroupColumn(e,t,r))})):n.push(this.createOneAutoGroupColumn(e)),n},t.prototype.createOneAutoGroupColumn=function(e,t,o){var n,r=this.generateDefaultColDef(t);(n=t?ht+"-"+t.getId():ht,w(r,this.gridOptionsService.get("autoGroupColumnDef")),(r=this.columnFactory.mergeColDefs(r)).colId=n,this.gridOptionsService.isTreeData())||i(r.field)&&i(r.valueGetter)&&i(r.filterValueGetter)&&"agGroupColumnFilter"!==r.filter&&(r.filter=!1);o&&o>0&&(r.headerCheckboxSelection=!1);var a=e.find((function(e){return e.getId()==n}));if(a)return a.setColDef(r,null),this.columnFactory.applyColumnState(a,r),a;this.gridOptionsService.isColumnsSortingCoupledToGroup()&&(r.sort||r.initialSort)&&!r.field&&w(r,{sort:null,initialSort:null},!0,!0);var s=new ce(r,null,n,!0);return this.context.createBean(s),s},t.prototype.generateDefaultColDef=function(e){var t=this.gridOptionsService.get("autoGroupColumnDef"),o={headerName:this.localeService.getLocaleTextFunc()("group","Group")};if(t&&(t.cellRenderer||t.cellRendererFramework||t.cellRendererSelector)||(o.cellRenderer="agGroupCellRenderer"),e){var n=e.getColDef();Object.assign(o,{headerName:this.columnModel.getDisplayNameForColumn(e,"header"),headerValueGetter:n.headerValueGetter}),(n.cellRenderer||n.cellRendererFramework)&&Object.assign(o,{cellRendererParams:{innerRenderer:n.cellRenderer,innerRendererFramework:n.cellRendererFramework,innerRendererParams:n.cellRendererParams}}),o.showRowGroup=e.getColId()}else o.showRowGroup=!0;return o},pt([q("columnModel")],t.prototype,"columnModel",void 0),pt([q("columnFactory")],t.prototype,"columnFactory",void 0),t=pt([W("autoGroupColService")],t)}(Fe),gt=/[&<>"']/g,mt={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"};function yt(e){return e[0].toUpperCase()+e.substr(1).toLowerCase()}function vt(e,t){if(null==e)return null;var o=e.toString().toString();return t?o:o.replace(gt,(function(e){return mt[e]}))}function bt(e){if(!e||null==e)return null;return e.replace(/([a-z])([A-Z])/g,"$1 $2").replace(/([A-Z]+)([A-Z])([a-z])/g,"$1 $2$3").replace(/\./g," ").split(" ").map((function(e){return e.substring(0,1).toUpperCase()+(e.length>1?e.substring(1,e.length):"")})).join(" ")}var xt=Object.freeze({__proto__:null,utf8_encode:function(e){var t=String.fromCharCode;function o(e,o){return t(e>>o&63|128)}function n(e){if(e>=0&&e<=31&&10!==e)return"_x"+e.toString(16).toUpperCase().padStart(4,"0")+"_";if(0==(4294967168&e))return t(e);var n="";return 0==(4294965248&e)?n=t(e>>6&31|192):0==(4294901760&e)?(!function(e){if(e>=55296&&e<=57343)throw Error("Lone surrogate U+"+e.toString(16).toUpperCase()+" is not a scalar value")}(e),n=t(e>>12&15|224),n+=o(e,6)):0==(4292870144&e)&&(n=t(e>>18&7|240),n+=o(e,12),n+=o(e,6)),n+=t(63&e|128)}for(var r=function(e){var t=[];if(!e)return[];for(var o,n,r=e.length,i=0;i<r;)(o=e.charCodeAt(i++))>=55296&&o<=56319&&i<r?56320==(64512&(n=e.charCodeAt(i++)))?t.push(((1023&o)<<10)+(1023&n)+65536):(t.push(o),i--):t.push(o);return t}(e),i=r.length,a=-1,s="";++a<i;)s+=n(r[a]);return s},capitalise:yt,escapeString:vt,camelCaseToHumanText:bt});function wt(e){var t=new Map;return e.forEach((function(e){return t.set(e[0],e[1])})),t}var Ct=Object.freeze({__proto__:null,convertToMap:wt,mapById:function(e,t){var o=new Map;return e.forEach((function(e){return o.set(t(e),e)})),o},keys:function(e){var t=[];return e.forEach((function(e,o){return t.push(o)})),t}}),_t=function(){var e=function(t,o){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])},e(t,o)};return function(t,o){function n(){this.constructor=t}e(t,o),t.prototype=null===o?Object.create(o):(n.prototype=o.prototype,new n)}}(),St=function(e,t,o,n){var r,i=arguments.length,a=i<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,o):n;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)a=Reflect.decorate(e,t,o,n);else for(var s=e.length-1;s>=0;s--)(r=e[s])&&(a=(i<3?r(a):i>3?r(t,o,a):r(t,o))||a);return i>3&&a&&Object.defineProperty(t,o,a),a},Et=function(e,t){return function(o,n){t(o,n,e)}},kt=function(e,t){var o={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(o[n]=e[n]);if(null!=e&&"function"===typeof Object.getOwnPropertySymbols){var r=0;for(n=Object.getOwnPropertySymbols(e);r<n.length;r++)t.indexOf(n[r])<0&&Object.prototype.propertyIsEnumerable.call(e,n[r])&&(o[n[r]]=e[n[r]])}return o},jt=function(e){var t="function"===typeof Symbol&&Symbol.iterator,o=t&&e[t],n=0;if(o)return o.call(e);if(e&&"number"===typeof e.length)return{next:function(){return e&&n>=e.length&&(e=void 0),{value:e&&e[n++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")},At=function(e,t){var o="function"===typeof Symbol&&e[Symbol.iterator];if(!o)return e;var n,r,i=o.call(e),a=[];try{for(;(void 0===t||t-- >0)&&!(n=i.next()).done;)a.push(n.value)}catch(s){r={error:s}}finally{try{n&&!n.done&&(o=i.return)&&o.call(i)}finally{if(r)throw r.error}}return a},Rt=function(){for(var e=[],t=0;t<arguments.length;t++)e=e.concat(At(arguments[t]));return e},Ot=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.primaryHeaderRowCount=0,t.secondaryHeaderRowCount=0,t.gridHeaderRowCount=0,t.displayedColumnsLeft=[],t.displayedColumnsRight=[],t.displayedColumnsCenter=[],t.displayedColumns=[],t.displayedColumnsAndGroupsMap={},t.viewportColumns=[],t.viewportColumnsHash="",t.headerViewportColumns=[],t.viewportColumnsCenter=[],t.headerViewportColumnsCenter=[],t.autoHeightActiveAtLeastOnce=!1,t.rowGroupColumns=[],t.valueColumns=[],t.pivotColumns=[],t.ready=!1,t.autoGroupsNeedBuilding=!1,t.forceRecreateAutoGroups=!1,t.pivotMode=!1,t.bodyWidth=0,t.leftWidth=0,t.rightWidth=0,t.bodyWidthDirty=!0,t}return _t(t,e),t.prototype.init=function(){var e=this;this.suppressColumnVirtualisation=this.gridOptionsService.is("suppressColumnVirtualisation");var t=this.gridOptionsService.is("pivotMode");this.isPivotSettingAllowed(t)&&(this.pivotMode=t),this.usingTreeData=this.gridOptionsService.isTreeData(),this.addManagedPropertyListener("groupDisplayType",(function(){return e.onAutoGroupColumnDefChanged()})),this.addManagedPropertyListener("autoGroupColumnDef",(function(){return e.onAutoGroupColumnDefChanged()})),this.addManagedPropertyListener("defaultColDef",(function(t){return e.onSharedColDefChanged(t.source)})),this.addManagedPropertyListener("columnTypes",(function(t){return e.onSharedColDefChanged(t.source)}))},t.prototype.onAutoGroupColumnDefChanged=function(){this.autoGroupsNeedBuilding=!0,this.forceRecreateAutoGroups=!0,this.updateGridColumns(),this.updateDisplayedColumns("gridOptionsChanged")},t.prototype.onSharedColDefChanged=function(e){void 0===e&&(e="api"),this.forceRecreateAutoGroups=!0,this.createColumnsFromColumnDefs(!0,e)},t.prototype.setColumnDefs=function(e,t){void 0===t&&(t="api");var o=!!this.columnDefs;this.columnDefs=e,this.createColumnsFromColumnDefs(o,t)},t.prototype.destroyOldColumns=function(e,t){var o={};if(e){this.columnUtils.depthFirstOriginalTreeSearch(null,e,(function(e){o[e.getInstanceId()]=e})),t&&this.columnUtils.depthFirstOriginalTreeSearch(null,t,(function(e){o[e.getInstanceId()]=null}));var n=Object.values(o).filter((function(e){return null!=e}));this.destroyBeans(n)}},t.prototype.destroyColumns=function(){this.destroyOldColumns(this.primaryColumnTree),this.destroyOldColumns(this.secondaryBalancedTree),this.destroyOldColumns(this.groupAutoColsBalancedTree)},t.prototype.createColumnsFromColumnDefs=function(e,t){var o=this;void 0===t&&(t="api");var n=e?this.compareColumnStatesAndDispatchEvents(t):void 0;this.valueCache.expire(),this.autoGroupsNeedBuilding=!0;var r=this.primaryColumns,i=this.primaryColumnTree,a=this.columnFactory.createColumnTree(this.columnDefs,!0,i);this.destroyOldColumns(this.primaryColumnTree,a.columnTree),this.primaryColumnTree=a.columnTree,this.primaryHeaderRowCount=a.treeDept+1,this.primaryColumns=this.getColumnsFromTree(this.primaryColumnTree),this.primaryColumnsMap={},this.primaryColumns.forEach((function(e){return o.primaryColumnsMap[e.getId()]=e})),this.extractRowGroupColumns(t,r),this.extractPivotColumns(t,r),this.extractValueColumns(t,r),this.ready=!0;var s=void 0===this.gridColsArePrimary;(this.gridColsArePrimary||s)&&(this.updateGridColumns(),e&&!this.gridOptionsService.is("maintainColumnOrder")&&this.orderGridColumnsLikePrimary(),this.updateDisplayedColumns(t),this.checkViewportColumns()),this.dispatchEverythingChanged(t),n&&n(),this.dispatchNewColumnsLoaded()},t.prototype.dispatchNewColumnsLoaded=function(){var e={type:$e.EVENT_NEW_COLUMNS_LOADED};this.eventService.dispatchEvent(e)},t.prototype.dispatchEverythingChanged=function(e){void 0===e&&(e="api");var t={type:$e.EVENT_COLUMN_EVERYTHING_CHANGED,source:e};this.eventService.dispatchEvent(t)},t.prototype.orderGridColumnsLikePrimary=function(){var e=this,t=this.primaryColumns;t&&(this.gridColumns.sort((function(o,n){var r=t.indexOf(o),i=t.indexOf(n),a=r>=0,s=i>=0;return a&&s?r-i:a?1:s?-1:e.gridColumns.indexOf(o)-e.gridColumns.indexOf(n)})),this.gridColumns=this.placeLockedColumns(this.gridColumns))},t.prototype.getAllDisplayedAutoHeightCols=function(){return this.displayedAutoHeightCols},t.prototype.setViewport=function(){this.gridOptionsService.is("enableRtl")?(this.viewportLeft=this.bodyWidth-this.scrollPosition-this.scrollWidth,this.viewportRight=this.bodyWidth-this.scrollPosition):(this.viewportLeft=this.scrollPosition,this.viewportRight=this.scrollWidth+this.scrollPosition)},t.prototype.getDisplayedColumnsStartingAt=function(e){for(var t=e,o=[];null!=t;)o.push(t),t=this.getDisplayedColAfter(t);return o},t.prototype.checkViewportColumns=function(){if(null!=this.displayedColumnsCenter&&this.extractViewport()){var e={type:$e.EVENT_VIRTUAL_COLUMNS_CHANGED};this.eventService.dispatchEvent(e)}},t.prototype.setViewportPosition=function(e,t){(e!==this.scrollWidth||t!==this.scrollPosition||this.bodyWidthDirty)&&(this.scrollWidth=e,this.scrollPosition=t,this.bodyWidthDirty=!0,this.setViewport(),this.ready&&this.checkViewportColumns())},t.prototype.isPivotMode=function(){return this.pivotMode},t.prototype.isPivotSettingAllowed=function(e){return!e||!this.gridOptionsService.isTreeData()||(console.warn("AG Grid: Pivot mode not available in conjunction Tree Data i.e. 'gridOptions.treeData: true'"),!1)},t.prototype.setPivotMode=function(e,t){if(void 0===t&&(t="api"),e!==this.pivotMode&&this.isPivotSettingAllowed(this.pivotMode)){this.pivotMode=e,this.autoGroupsNeedBuilding=!0,this.updateGridColumns(),this.updateDisplayedColumns(t);var o={type:$e.EVENT_COLUMN_PIVOT_MODE_CHANGED};this.eventService.dispatchEvent(o)}},t.prototype.getSecondaryPivotColumn=function(e,t){if(i(this.secondaryColumns))return null;var o=this.getPrimaryColumn(t),n=null;return this.secondaryColumns.forEach((function(t){var r=t.getColDef().pivotKeys,i=t.getColDef().pivotValueColumn;ge(r,e)&&i===o&&(n=t)})),n},t.prototype.setBeans=function(e){this.logger=e.create("columnModel")},t.prototype.setFirstRightAndLastLeftPinned=function(e){var t,o;this.gridOptionsService.is("enableRtl")?(t=this.displayedColumnsLeft?this.displayedColumnsLeft[0]:null,o=this.displayedColumnsRight?fe(this.displayedColumnsRight):null):(t=this.displayedColumnsLeft?fe(this.displayedColumnsLeft):null,o=this.displayedColumnsRight?this.displayedColumnsRight[0]:null),this.gridColumns.forEach((function(n){n.setLastLeftPinned(n===t,e),n.setFirstRightPinned(n===o,e)}))},t.prototype.autoSizeColumns=function(e){var t=this,o=e.columns,n=e.skipHeader,r=e.skipHeaderGroups,i=e.stopAtGroup,a=e.source,s=void 0===a?"api":a;this.animationFrameService.flushAllFrames();for(var l=[],c=-1,d=null!=n?n:this.gridOptionsService.is("skipHeaderOnAutoSize"),u=null!=r?r:d;0!==c;)c=0,this.actionOnGridColumns(o,(function(e){if(l.indexOf(e)>=0)return!1;var o=t.autoWidthCalculator.getPreferredWidthForColumn(e,d);if(o>0){var n=t.normaliseColumnWidth(e,o);e.setActualWidth(n,s),l.push(e),c++}return!0}),s);u||this.autoSizeColumnGroupsByColumns(o,s,i),this.dispatchColumnResizedEvent(l,!0,"autosizeColumns")},t.prototype.dispatchColumnResizedEvent=function(e,t,o,n){if(void 0===n&&(n=null),e&&e.length){var r={type:$e.EVENT_COLUMN_RESIZED,columns:e,column:1===e.length?e[0]:null,flexColumns:n,finished:t,source:o};this.eventService.dispatchEvent(r)}},t.prototype.dispatchColumnChangedEvent=function(e,t,o){var n={type:e,columns:t,column:t&&1==t.length?t[0]:null,source:o};this.eventService.dispatchEvent(n)},t.prototype.dispatchColumnMovedEvent=function(e){var t=e.movedColumns,o=e.source,n=e.toIndex,r=e.finished,i={type:$e.EVENT_COLUMN_MOVED,columns:t,column:t&&1===t.length?t[0]:null,toIndex:n,finished:r,source:o};this.eventService.dispatchEvent(i)},t.prototype.dispatchColumnPinnedEvent=function(e,t){if(e.length){var o=1===e.length?e[0]:null,n=this.getCommonValue(e,(function(e){return e.getPinned()})),r={type:$e.EVENT_COLUMN_PINNED,pinned:null!=n?n:null,columns:e,column:o,source:t};this.eventService.dispatchEvent(r)}},t.prototype.dispatchColumnVisibleEvent=function(e,t){if(e.length){var o=1===e.length?e[0]:null,n=this.getCommonValue(e,(function(e){return e.isVisible()})),r={type:$e.EVENT_COLUMN_VISIBLE,visible:n,columns:e,column:o,source:t};this.eventService.dispatchEvent(r)}},t.prototype.autoSizeColumn=function(e,t,o){void 0===o&&(o="api"),e&&this.autoSizeColumns({columns:[e],skipHeader:t,skipHeaderGroups:!0,source:o})},t.prototype.autoSizeColumnGroupsByColumns=function(e,t,o){var n,r,i,a,s,l=new Set;this.getGridColumns(e).forEach((function(e){for(var t=e.getParent();t&&t!=o;)t.isPadding()||l.add(t),t=t.getParent()}));try{for(var c=jt(l),d=c.next();!d.done;d=c.next()){var u=d.value;try{for(var p=(i=void 0,jt(this.ctrlsService.getHeaderRowContainerCtrls())),h=p.next();!h.done;h=p.next()){if(s=h.value.getHeaderCtrlForColumn(u))break}}catch(f){i={error:f}}finally{try{h&&!h.done&&(a=p.return)&&a.call(p)}finally{if(i)throw i.error}}s&&s.resizeLeafColumnsToFit(t)}}catch(g){n={error:g}}finally{try{d&&!d.done&&(r=c.return)&&r.call(c)}finally{if(n)throw n.error}}return[]},t.prototype.autoSizeAllColumns=function(e,t){void 0===t&&(t="api");var o=this.getAllDisplayedColumns();this.autoSizeColumns({columns:o,skipHeader:e,source:t})},t.prototype.getColumnsFromTree=function(e){var t=[],o=function(e){for(var n=0;n<e.length;n++){var r=e[n];r instanceof ce?t.push(r):r instanceof ue&&o(r.getChildren())}};return o(e),t},t.prototype.getAllDisplayedTrees=function(){return this.displayedTreeLeft&&this.displayedTreeRight&&this.displayedTreeCentre?this.displayedTreeLeft.concat(this.displayedTreeCentre).concat(this.displayedTreeRight):null},t.prototype.getPrimaryColumnTree=function(){return this.primaryColumnTree},t.prototype.getHeaderRowCount=function(){return this.gridHeaderRowCount},t.prototype.getDisplayedTreeLeft=function(){return this.displayedTreeLeft},t.prototype.getDisplayedTreeRight=function(){return this.displayedTreeRight},t.prototype.getDisplayedTreeCentre=function(){return this.displayedTreeCentre},t.prototype.isColumnDisplayed=function(e){return this.getAllDisplayedColumns().indexOf(e)>=0},t.prototype.getAllDisplayedColumns=function(){return this.displayedColumns},t.prototype.getViewportColumns=function(){return this.viewportColumns},t.prototype.getDisplayedLeftColumnsForRow=function(e){return this.colSpanActive?this.getDisplayedColumnsForRow(e,this.displayedColumnsLeft):this.displayedColumnsLeft},t.prototype.getDisplayedRightColumnsForRow=function(e){return this.colSpanActive?this.getDisplayedColumnsForRow(e,this.displayedColumnsRight):this.displayedColumnsRight},t.prototype.isColSpanActive=function(){return this.colSpanActive},t.prototype.getDisplayedColumnsForRow=function(e,t,o,n){for(var r,i=[],a=null,s=function(s){var l,c=t[s],d=t.length-s,u=Math.min(c.getColSpan(e),d),p=[c];if(u>1){for(var h=u-1,f=1;f<=h;f++)p.push(t[s+f]);s+=h}if(o?(l=!1,p.forEach((function(e){o(e)&&(l=!0)}))):l=!0,l){if(0===i.length&&a)!!n&&n(c)&&i.push(a);i.push(c)}a=c,r=s},l=0;l<t.length;l++)s(l),l=r;return i},t.prototype.getViewportCenterColumnsForRow=function(e){var t=this;if(!this.colSpanActive)return this.viewportColumnsCenter;var o=this.suppressColumnVirtualisation?null:this.isColumnInRowViewport.bind(this);return this.getDisplayedColumnsForRow(e,this.displayedColumnsCenter,o,(function(e){var o=e.getLeft();return r(o)&&o>t.viewportLeft}))},t.prototype.getAriaColumnIndex=function(e){return this.getAllGridColumns().indexOf(e)+1},t.prototype.isColumnInHeaderViewport=function(e){return!!e.isAutoHeaderHeight()||this.isColumnInRowViewport(e)},t.prototype.isColumnInRowViewport=function(e){if(e.isAutoHeight())return!0;var t=e.getLeft()||0,o=t+e.getActualWidth(),n=this.viewportLeft-200,r=this.viewportRight+200;return!(t<n&&o<n)&&!(t>r&&o>r)},t.prototype.getDisplayedColumnsLeftWidth=function(){return this.getWidthOfColsInList(this.displayedColumnsLeft)},t.prototype.getDisplayedColumnsRightWidth=function(){return this.getWidthOfColsInList(this.displayedColumnsRight)},t.prototype.updatePrimaryColumnList=function(e,t,o,n,r,i){var s=this;if(void 0===i&&(i="api"),e&&!a(e)){var l=!1;if(e.forEach((function(e){var r=s.getPrimaryColumn(e);if(r){if(o){if(t.indexOf(r)>=0)return;t.push(r)}else{if(t.indexOf(r)<0)return;ye(t,r)}n(r),l=!0}})),l){this.autoGroupsNeedBuilding&&this.updateGridColumns(),this.updateDisplayedColumns(i);var c={type:r,columns:t,column:1===t.length?t[0]:null,source:i};this.eventService.dispatchEvent(c)}}},t.prototype.setRowGroupColumns=function(e,t){void 0===t&&(t="api"),this.autoGroupsNeedBuilding=!0,this.setPrimaryColumnList(e,this.rowGroupColumns,$e.EVENT_COLUMN_ROW_GROUP_CHANGED,this.setRowGroupActive.bind(this),t)},t.prototype.setRowGroupActive=function(e,t,o){e!==t.isRowGroupActive()&&(t.setRowGroupActive(e,o),e&&!this.gridOptionsService.is("suppressRowGroupHidesColumns")&&this.setColumnVisible(t,!1,o),e||this.gridOptionsService.is("suppressMakeColumnVisibleAfterUnGroup")||this.setColumnVisible(t,!0,o))},t.prototype.addRowGroupColumn=function(e,t){void 0===t&&(t="api"),e&&this.addRowGroupColumns([e],t)},t.prototype.addRowGroupColumns=function(e,t){void 0===t&&(t="api"),this.autoGroupsNeedBuilding=!0,this.updatePrimaryColumnList(e,this.rowGroupColumns,!0,this.setRowGroupActive.bind(this,!0),$e.EVENT_COLUMN_ROW_GROUP_CHANGED,t)},t.prototype.removeRowGroupColumns=function(e,t){void 0===t&&(t="api"),this.autoGroupsNeedBuilding=!0,this.updatePrimaryColumnList(e,this.rowGroupColumns,!1,this.setRowGroupActive.bind(this,!1),$e.EVENT_COLUMN_ROW_GROUP_CHANGED,t)},t.prototype.removeRowGroupColumn=function(e,t){void 0===t&&(t="api"),e&&this.removeRowGroupColumns([e],t)},t.prototype.addPivotColumns=function(e,t){void 0===t&&(t="api"),this.updatePrimaryColumnList(e,this.pivotColumns,!0,(function(e){return e.setPivotActive(!0,t)}),$e.EVENT_COLUMN_PIVOT_CHANGED,t)},t.prototype.setPivotColumns=function(e,t){void 0===t&&(t="api"),this.setPrimaryColumnList(e,this.pivotColumns,$e.EVENT_COLUMN_PIVOT_CHANGED,(function(e,o){o.setPivotActive(e,t)}),t)},t.prototype.addPivotColumn=function(e,t){void 0===t&&(t="api"),this.addPivotColumns([e],t)},t.prototype.removePivotColumns=function(e,t){void 0===t&&(t="api"),this.updatePrimaryColumnList(e,this.pivotColumns,!1,(function(e){return e.setPivotActive(!1,t)}),$e.EVENT_COLUMN_PIVOT_CHANGED,t)},t.prototype.removePivotColumn=function(e,t){void 0===t&&(t="api"),this.removePivotColumns([e],t)},t.prototype.setPrimaryColumnList=function(e,t,o,n,i){var a=this;t.length=0,r(e)&&e.forEach((function(e){var o=a.getPrimaryColumn(e);o&&t.push(o)})),(this.primaryColumns||[]).forEach((function(e){var o=t.indexOf(e)>=0;n(o,e)})),this.autoGroupsNeedBuilding&&this.updateGridColumns(),this.updateDisplayedColumns(i),this.dispatchColumnChangedEvent(o,t,i)},t.prototype.setValueColumns=function(e,t){void 0===t&&(t="api"),this.setPrimaryColumnList(e,this.valueColumns,$e.EVENT_COLUMN_VALUE_CHANGED,this.setValueActive.bind(this),t)},t.prototype.setValueActive=function(e,t,o){if(e!==t.isValueActive()&&(t.setValueActive(e,o),e&&!t.getAggFunc())){var n=this.aggFuncService.getDefaultAggFunc(t);t.setAggFunc(n)}},t.prototype.addValueColumns=function(e,t){void 0===t&&(t="api"),this.updatePrimaryColumnList(e,this.valueColumns,!0,this.setValueActive.bind(this,!0),$e.EVENT_COLUMN_VALUE_CHANGED,t)},t.prototype.addValueColumn=function(e,t){void 0===t&&(t="api"),e&&this.addValueColumns([e],t)},t.prototype.removeValueColumn=function(e,t){void 0===t&&(t="api"),this.removeValueColumns([e],t)},t.prototype.removeValueColumns=function(e,t){void 0===t&&(t="api"),this.updatePrimaryColumnList(e,this.valueColumns,!1,this.setValueActive.bind(this,!1),$e.EVENT_COLUMN_VALUE_CHANGED,t)},t.prototype.normaliseColumnWidth=function(e,t){var o=e.getMinWidth();r(o)&&t<o&&(t=o);var n=e.getMaxWidth();return r(n)&&e.isGreaterThanMax(t)&&(t=n),t},t.prototype.getPrimaryOrGridColumn=function(e){return this.getPrimaryColumn(e)||this.getGridColumn(e)},t.prototype.setColumnWidths=function(e,t,o,n){var r=this;void 0===n&&(n="api");var i=[];e.forEach((function(e){var o=r.getPrimaryOrGridColumn(e.key);if(o&&(i.push({width:e.newWidth,ratios:[1],columns:[o]}),"shift"===r.gridOptionsService.get("colResizeDefault")&&(t=!t),t)){var n=r.getDisplayedColAfter(o);if(!n)return;var a=o.getActualWidth()-e.newWidth,s=n.getActualWidth()+a;i.push({width:s,ratios:[1],columns:[n]})}})),0!==i.length&&this.resizeColumnSets({resizeSets:i,finished:o,source:n})},t.prototype.checkMinAndMaxWidthsForSet=function(e){var t=e.columns,o=e.width,n=0,i=0,a=!0;return t.forEach((function(e){var t=e.getMinWidth();n+=t||0;var o=e.getMaxWidth();r(o)&&o>0?i+=o:a=!1})),o>=n&&(!a||o<=i)},t.prototype.resizeColumnSets=function(e){var t=this,o=e.resizeSets,n=e.finished,i=e.source;if(!o||o.every((function(e){return t.checkMinAndMaxWidthsForSet(e)}))){var a=[],s=[];o.forEach((function(e){var t=e.width,o=e.columns,n=e.ratios,l={},c={};o.forEach((function(e){return s.push(e)}));for(var d=!0,u=0,p=function(){if(++u>1e3)return console.error("AG Grid: infinite loop in resizeColumnSets"),"break";d=!1;var e=[],i=0,a=t;o.forEach((function(t,o){if(c[t.getId()])a-=l[t.getId()];else{e.push(t);var r=n[o];i+=r}}));var s=1/i;e.forEach((function(o,i){var u;i===e.length-1?u=a:(u=Math.round(n[i]*t*s),a-=u);var p=o.getMinWidth(),h=o.getMaxWidth();r(p)&&u<p?(u=p,c[o.getId()]=!0,d=!0):r(h)&&h>0&&u>h&&(u=h,c[o.getId()]=!0,d=!0),l[o.getId()]=u}))};d;){if("break"===p())break}o.forEach((function(e){var t=l[e.getId()];e.getActualWidth()!==t&&(e.setActualWidth(t,i),a.push(e))}))}));var l=a.length>0,c=[];l&&(c=this.refreshFlexedColumns({resizingCols:s,skipSetLeft:!0}),this.setLeftValues(i),this.updateBodyWidths(),this.checkViewportColumns());var d=s.concat(c);(l||n)&&this.dispatchColumnResizedEvent(d,n,i,c)}else if(n){var u=o&&o.length>0?o[0].columns:null;this.dispatchColumnResizedEvent(u,n,i)}},t.prototype.setColumnAggFunc=function(e,t,o){if(void 0===o&&(o="api"),e){var n=this.getPrimaryColumn(e);n&&(n.setAggFunc(t),this.dispatchColumnChangedEvent($e.EVENT_COLUMN_VALUE_CHANGED,[n],o))}},t.prototype.moveRowGroupColumn=function(e,t,o){void 0===o&&(o="api");var n=this.rowGroupColumns[e];this.rowGroupColumns.splice(e,1),this.rowGroupColumns.splice(t,0,n);var r={type:$e.EVENT_COLUMN_ROW_GROUP_CHANGED,columns:this.rowGroupColumns,column:1===this.rowGroupColumns.length?this.rowGroupColumns[0]:null,source:o};this.eventService.dispatchEvent(r)},t.prototype.moveColumns=function(e,t,o,n){if(void 0===o&&(o="api"),void 0===n&&(n=!0),this.columnAnimationService.start(),t>this.gridColumns.length-e.length)return console.warn("AG Grid: tried to insert columns in invalid location, toIndex = "+t),void console.warn("AG Grid: remember that you should not count the moving columns when calculating the new index");var r=this.getGridColumns(e);!this.doesMovePassRules(r,t)||(xe(this.gridColumns,r,t),this.updateDisplayedColumns(o),this.dispatchColumnMovedEvent({movedColumns:r,source:o,toIndex:t,finished:n}),this.columnAnimationService.finish())},t.prototype.doesMovePassRules=function(e,t){var o=this.getProposedColumnOrder(e,t);return this.doesOrderPassRules(o)},t.prototype.doesOrderPassRules=function(e){return!!this.doesMovePassMarryChildren(e)&&!!this.doesMovePassLockedPositions(e)},t.prototype.getProposedColumnOrder=function(e,t){var o=this.gridColumns.slice();return xe(o,e,t),o},t.prototype.sortColumnsLikeGridColumns=function(e){var t=this;!e||e.length<=1||(e.filter((function(e){return t.gridColumns.indexOf(e)<0})).length>0||e.sort((function(e,o){return t.gridColumns.indexOf(e)-t.gridColumns.indexOf(o)})))},t.prototype.doesMovePassLockedPositions=function(e){var t=0,o=!0;return e.forEach((function(e){var n,r=(n=e.getColDef().lockPosition)?!0===n||"left"===n?0:2:1;r<t&&(o=!1),t=r})),o},t.prototype.doesMovePassMarryChildren=function(e){var t=!0;return this.columnUtils.depthFirstOriginalTreeSearch(null,this.gridBalancedTree,(function(o){if(o instanceof ue){var n=o,r=n.getColGroupDef();if(r&&r.marryChildren){var i=[];n.getLeafColumns().forEach((function(t){var o=e.indexOf(t);i.push(o)})),Math.max.apply(Math,i)-Math.min.apply(Math,i)>n.getLeafColumns().length-1&&(t=!1)}}})),t},t.prototype.moveColumn=function(e,t,o){void 0===o&&(o="api"),this.moveColumns([e],t,o)},t.prototype.moveColumnByIndex=function(e,t,o){void 0===o&&(o="api");var n=this.gridColumns[e];this.moveColumn(n,t,o)},t.prototype.getColumnDefs=function(){var e=this;if(this.primaryColumns){var t=this.primaryColumns.slice();return this.gridColsArePrimary?t.sort((function(t,o){return e.gridColumns.indexOf(t)-e.gridColumns.indexOf(o)})):this.lastPrimaryOrder&&t.sort((function(t,o){return e.lastPrimaryOrder.indexOf(t)-e.lastPrimaryOrder.indexOf(o)})),this.columnDefFactory.buildColumnDefs(t,this.rowGroupColumns,this.pivotColumns)}},t.prototype.getBodyContainerWidth=function(){return this.bodyWidth},t.prototype.getContainerWidth=function(e){switch(e){case"left":return this.leftWidth;case"right":return this.rightWidth;default:return this.bodyWidth}},t.prototype.updateBodyWidths=function(){var e=this.getWidthOfColsInList(this.displayedColumnsCenter),t=this.getWidthOfColsInList(this.displayedColumnsLeft),o=this.getWidthOfColsInList(this.displayedColumnsRight);if(this.bodyWidthDirty=this.bodyWidth!==e,this.bodyWidth!==e||this.leftWidth!==t||this.rightWidth!==o){this.bodyWidth=e,this.leftWidth=t,this.rightWidth=o;var n={type:$e.EVENT_DISPLAYED_COLUMNS_WIDTH_CHANGED};this.eventService.dispatchEvent(n)}},t.prototype.getValueColumns=function(){return this.valueColumns?this.valueColumns:[]},t.prototype.getPivotColumns=function(){return this.pivotColumns?this.pivotColumns:[]},t.prototype.isPivotActive=function(){return this.pivotColumns&&this.pivotColumns.length>0&&this.pivotMode},t.prototype.getRowGroupColumns=function(){return this.rowGroupColumns?this.rowGroupColumns:[]},t.prototype.getDisplayedCenterColumns=function(){return this.displayedColumnsCenter},t.prototype.getDisplayedLeftColumns=function(){return this.displayedColumnsLeft},t.prototype.getDisplayedRightColumns=function(){return this.displayedColumnsRight},t.prototype.getDisplayedColumns=function(e){switch(e){case"left":return this.getDisplayedLeftColumns();case"right":return this.getDisplayedRightColumns();default:return this.getDisplayedCenterColumns()}},t.prototype.getAllPrimaryColumns=function(){return this.primaryColumns?this.primaryColumns.slice():null},t.prototype.getSecondaryColumns=function(){return this.secondaryColumns?this.secondaryColumns.slice():null},t.prototype.getAllColumnsForQuickFilter=function(){return this.columnsForQuickFilter},t.prototype.getAllGridColumns=function(){return this.gridColumns},t.prototype.isEmpty=function(){return a(this.gridColumns)},t.prototype.isRowGroupEmpty=function(){return a(this.rowGroupColumns)},t.prototype.setColumnVisible=function(e,t,o){void 0===o&&(o="api"),this.setColumnsVisible([e],t,o)},t.prototype.setColumnsVisible=function(e,t,o){void 0===t&&(t=!1),void 0===o&&(o="api"),this.applyColumnState({state:e.map((function(e){return{colId:"string"===typeof e?e:e.getColId(),hide:!t}}))},o)},t.prototype.setColumnPinned=function(e,t,o){void 0===o&&(o="api"),e&&this.setColumnsPinned([e],t,o)},t.prototype.setColumnsPinned=function(e,t,o){var n;(void 0===o&&(o="api"),this.gridOptionsService.isDomLayout("print"))?console.warn("AG Grid: Changing the column pinning status is not allowed with domLayout='print'"):(this.columnAnimationService.start(),n=!0===t||"left"===t?"left":"right"===t?"right":null,this.actionOnGridColumns(e,(function(e){return e.getPinned()!==n&&(e.setPinned(n),!0)}),o,(function(){return{type:$e.EVENT_COLUMN_PINNED,pinned:n,column:null,columns:null,source:o}})),this.columnAnimationService.finish())},t.prototype.actionOnGridColumns=function(e,t,o,n){var i=this;if(!a(e)){var s=[];if(e.forEach((function(e){var o=i.getGridColumn(e);o&&(!1!==t(o)&&s.push(o))})),s.length&&(this.updateDisplayedColumns(o),r(n)&&n)){var l=n();l.columns=s,l.column=1===s.length?s[0]:null,this.eventService.dispatchEvent(l)}}},t.prototype.getDisplayedColBefore=function(e){var t=this.getAllDisplayedColumns(),o=t.indexOf(e);return o>0?t[o-1]:null},t.prototype.getDisplayedColAfter=function(e){var t=this.getAllDisplayedColumns(),o=t.indexOf(e);return o<t.length-1?t[o+1]:null},t.prototype.getDisplayedGroupAfter=function(e){return this.getDisplayedGroupAtDirection(e,"After")},t.prototype.getDisplayedGroupBefore=function(e){return this.getDisplayedGroupAtDirection(e,"Before")},t.prototype.getDisplayedGroupAtDirection=function(e,t){for(var o=e.getProvidedColumnGroup().getLevel()+e.getPaddingLevel(),n=e.getDisplayedLeafColumns(),r="After"===t?fe(n):n[0],i="getDisplayedCol"+t;;){var a=this[i](r);if(!a)return null;var s=this.getColumnGroupAtLevel(a,o);if(s!==e)return s}},t.prototype.getColumnGroupAtLevel=function(e,t){for(var o=e.getParent();;){if(o.getProvidedColumnGroup().getLevel()+o.getPaddingLevel()<=t)break;o=o.getParent()}return o},t.prototype.isPinningLeft=function(){return this.displayedColumnsLeft.length>0},t.prototype.isPinningRight=function(){return this.displayedColumnsRight.length>0},t.prototype.getPrimaryAndSecondaryAndAutoColumns=function(){var e;return(e=[]).concat.apply(e,Rt([this.primaryColumns||[],this.groupAutoColumns||[],this.secondaryColumns||[]]))},t.prototype.createStateItemFromColumn=function(e){var t=e.isRowGroupActive()?this.rowGroupColumns.indexOf(e):null,o=e.isPivotActive()?this.pivotColumns.indexOf(e):null,n=e.isValueActive()?e.getAggFunc():null,r=null!=e.getSort()?e.getSort():null,i=null!=e.getSortIndex()?e.getSortIndex():null,a=null!=e.getFlex()&&e.getFlex()>0?e.getFlex():null;return{colId:e.getColId(),width:e.getActualWidth(),hide:!e.isVisible(),pinned:e.getPinned(),sort:r,sortIndex:i,aggFunc:n,rowGroup:e.isRowGroupActive(),rowGroupIndex:t,pivot:e.isPivotActive(),pivotIndex:o,flex:a}},t.prototype.getColumnState=function(){if(i(this.primaryColumns)||!this.isAlive())return[];var e=this.getPrimaryAndSecondaryAndAutoColumns().map(this.createStateItemFromColumn.bind(this));return this.orderColumnStateList(e),e},t.prototype.orderColumnStateList=function(e){var t=wt(this.gridColumns.map((function(e,t){return[e.getColId(),t]})));e.sort((function(e,o){return(t.has(e.colId)?t.get(e.colId):-1)-(t.has(o.colId)?t.get(o.colId):-1)}))},t.prototype.resetColumnState=function(e){void 0===e&&(e="api");var t=this.getColumnsFromTree(this.primaryColumnTree),o=[],n=1e3,r=1e3,a=[];this.groupAutoColumns&&(a=a.concat(this.groupAutoColumns)),t&&(a=a.concat(t)),a.forEach((function(e){var t=function(e,t){return null!=e?e:null!=t?t:null},a=e.getColDef(),s=t(a.sort,a.initialSort),l=t(a.sortIndex,a.initialSortIndex),c=t(a.hide,a.initialHide),d=t(a.pinned,a.initialPinned),u=t(a.width,a.initialWidth),p=t(a.flex,a.initialFlex),h=t(a.rowGroupIndex,a.initialRowGroupIndex),f=t(a.rowGroup,a.initialRowGroup);null!=h||null!=f&&0!=f||(h=null,f=null);var g=t(a.pivotIndex,a.initialPivotIndex),m=t(a.pivot,a.initialPivot);null!=g||null!=m&&0!=m||(g=null,m=null);var y=t(a.aggFunc,a.initialAggFunc),v={colId:e.getColId(),sort:s,sortIndex:l,hide:c,pinned:d,width:u,flex:p,rowGroup:f,rowGroupIndex:h,pivot:m,pivotIndex:g,aggFunc:y};i(h)&&f&&(v.rowGroupIndex=n++),i(g)&&m&&(v.pivotIndex=r++),o.push(v)})),this.applyColumnState({state:o,applyOrder:!0},e)},t.prototype.applyColumnState=function(e,t){var o=this;if(a(this.primaryColumns))return!1;if(e&&e.state&&!e.state.forEach)return console.warn("AG Grid: applyColumnState() - the state attribute should be an array, however an array was not found. Please provide an array of items (one for each col you want to change) for state."),!1;var n=function(n,r,i){var a=o.compareColumnStatesAndDispatchEvents(t);o.autoGroupsNeedBuilding=!0;var s=r.slice(),l={},c={},d=[],u=[],p=0,h=o.rowGroupColumns.slice(),f=o.pivotColumns.slice();n.forEach((function(n){var r=n.colId||"";if(r.startsWith(ht))return d.push(n),void u.push(n);var a=i(r);a?(o.syncColumnWithStateItem(a,n,e.defaultState,l,c,!1,t),ye(s,a)):(u.push(n),p+=1)}));var g=function(n){return o.syncColumnWithStateItem(n,null,e.defaultState,l,c,!1,t)};s.forEach(g);var m=function(e,t,o,n){var r=e[o.getId()],i=e[n.getId()],a=null!=r,s=null!=i;if(a&&s)return r-i;if(a)return-1;if(s)return 1;var l=t.indexOf(o),c=t.indexOf(n),d=l>=0;return d&&c>=0?l-c:d?-1:1};o.rowGroupColumns.sort(m.bind(o,l,h)),o.pivotColumns.sort(m.bind(o,c,f)),o.updateGridColumns();var y=o.groupAutoColumns?o.groupAutoColumns.slice():[];return d.forEach((function(n){var r=o.getAutoColumn(n.colId);ye(y,r),o.syncColumnWithStateItem(r,n,e.defaultState,null,null,!0,t)})),y.forEach(g),o.applyOrderAfterApplyState(e),o.updateDisplayedColumns(t),o.dispatchEverythingChanged(t),a(),{unmatchedAndAutoStates:u,unmatchedCount:p}};this.columnAnimationService.start();var i=n(e.state||[],this.primaryColumns||[],(function(e){return o.getPrimaryColumn(e)})),s=i.unmatchedAndAutoStates,l=i.unmatchedCount;return(s.length>0||r(e.defaultState))&&(l=n(s,this.secondaryColumns||[],(function(e){return o.getSecondaryColumn(e)})).unmatchedCount),this.columnAnimationService.finish(),0===l},t.prototype.applyOrderAfterApplyState=function(e){var t=this;if(e.applyOrder&&e.state){var o=[],n={};e.state.forEach((function(e){if(e.colId&&!n[e.colId]){var r=t.gridColumnsMap[e.colId];r&&(o.push(r),n[e.colId]=!0)}}));var r=0;this.gridColumns.forEach((function(e){var t=e.getColId();null!=n[t]||(t.startsWith(ht)?be(o,e,r++):o.push(e))})),o=this.placeLockedColumns(o),this.doesMovePassMarryChildren(o)?this.gridColumns=o:console.warn("AG Grid: Applying column order broke a group where columns should be married together. Applying new order has been discarded.")}},t.prototype.compareColumnStatesAndDispatchEvents=function(e){var t=this,o={rowGroupColumns:this.rowGroupColumns.slice(),pivotColumns:this.pivotColumns.slice(),valueColumns:this.valueColumns.slice()},n=this.getColumnState(),r={};return n.forEach((function(e){r[e.colId]=e})),function(){var i=t.getPrimaryAndSecondaryAndAutoColumns(),a=function(o,n,r,i){if(!ge(n.map(i),r.map(i))){var a={type:o,columns:r,column:1===r.length?r[0]:null,source:e};t.eventService.dispatchEvent(a)}},s=function(e){var t=[];return i.forEach((function(o){var n=r[o.getColId()];n&&e(n,o)&&t.push(o)})),t},l=function(e){return e.getColId()};a($e.EVENT_COLUMN_ROW_GROUP_CHANGED,o.rowGroupColumns,t.rowGroupColumns,l),a($e.EVENT_COLUMN_PIVOT_CHANGED,o.pivotColumns,t.pivotColumns,l);s((function(e,t){var o=null!=e.aggFunc,n=o!=t.isValueActive(),r=o&&e.aggFunc!=t.getAggFunc();return n||r})).length>0&&t.dispatchColumnChangedEvent($e.EVENT_COLUMN_VALUE_CHANGED,t.valueColumns,e);t.dispatchColumnResizedEvent(s((function(e,t){return e.width!=t.getActualWidth()})),!0,e);t.dispatchColumnPinnedEvent(s((function(e,t){return e.pinned!=t.getPinned()})),e);t.dispatchColumnVisibleEvent(s((function(e,t){return e.hide==t.isVisible()})),e);s((function(e,t){return e.sort!=t.getSort()||e.sortIndex!=t.getSortIndex()})).length>0&&t.sortController.dispatchSortChangedEvents(e),t.normaliseColumnMovedEventForColumnState(n,e)}},t.prototype.getCommonValue=function(e,t){if(e&&0!=e.length){for(var o=t(e[0]),n=1;n<e.length;n++)if(o!==t(e[n]))return;return o}},t.prototype.normaliseColumnMovedEventForColumnState=function(e,t){var o=this,n=this.getColumnState(),r={};n.forEach((function(e){return r[e.colId]=e}));var i={};e.forEach((function(e){r[e.colId]&&(i[e.colId]=!0)}));var a=e.filter((function(e){return i[e.colId]})),s=n.filter((function(e){return i[e.colId]})),l=[];s.forEach((function(e,t){var n=a&&a[t];if(n&&n.colId!==e.colId){var r=o.getGridColumn(n.colId);r&&l.push(r)}})),l.length&&this.dispatchColumnMovedEvent({movedColumns:l,source:t,finished:!0})},t.prototype.syncColumnWithStateItem=function(e,t,o,n,i,a,s){if(e){var l=function(e,n){var i={value1:void 0,value2:void 0},a=!1;return t&&(void 0!==t[e]&&(i.value1=t[e],a=!0),r(n)&&void 0!==t[n]&&(i.value2=t[n],a=!0)),!a&&o&&(void 0!==o[e]&&(i.value1=o[e]),r(n)&&void 0!==o[n]&&(i.value2=o[n])),i},c=l("hide").value1;void 0!==c&&e.setVisible(!c,s);var d=l("pinned").value1;void 0!==d&&e.setPinned(d);var u=this.columnUtils.calculateColMinWidth(e.getColDef()),p=l("flex").value1;if(void 0!==p&&e.setFlex(p),e.getFlex()<=0){var h=l("width").value1;null!=h&&null!=u&&h>=u&&e.setActualWidth(h,s)}var f=l("sort").value1;void 0!==f&&("desc"===f||"asc"===f?e.setSort(f,s):e.setSort(void 0,s));var g=l("sortIndex").value1;if(void 0!==g&&e.setSortIndex(g),!a&&e.isPrimary()){var m=l("aggFunc").value1;void 0!==m&&("string"===typeof m?(e.setAggFunc(m),e.isValueActive()||(e.setValueActive(!0,s),this.valueColumns.push(e))):(r(m)&&console.warn("AG Grid: stateItem.aggFunc must be a string. if using your own aggregation functions, register the functions first before using them in get/set state. This is because it is intended for the column state to be stored and retrieved as simple JSON."),e.isValueActive()&&(e.setValueActive(!1,s),ye(this.valueColumns,e))));var y=l("rowGroup","rowGroupIndex"),v=y.value1,b=y.value2;void 0===v&&void 0===b||("number"===typeof b||v?(e.isRowGroupActive()||(e.setRowGroupActive(!0,s),this.rowGroupColumns.push(e)),n&&"number"===typeof b&&(n[e.getId()]=b)):e.isRowGroupActive()&&(e.setRowGroupActive(!1,s),ye(this.rowGroupColumns,e)));var x=l("pivot","pivotIndex"),w=x.value1,C=x.value2;void 0===w&&void 0===C||("number"===typeof C||w?(e.isPivotActive()||(e.setPivotActive(!0,s),this.pivotColumns.push(e)),i&&"number"===typeof C&&(i[e.getId()]=C)):e.isPivotActive()&&(e.setPivotActive(!1,s),ye(this.pivotColumns,e)))}}},t.prototype.getGridColumns=function(e){return this.getColumns(e,this.getGridColumn.bind(this))},t.prototype.getColumns=function(e,t){var o=[];return e&&e.forEach((function(e){var n=t(e);n&&o.push(n)})),o},t.prototype.getColumnWithValidation=function(e){if(null==e)return null;var t=this.getGridColumn(e);return t||console.warn("AG Grid: could not find column "+e),t},t.prototype.getPrimaryColumn=function(e){return this.primaryColumns?this.getColumn(e,this.primaryColumns,this.primaryColumnsMap):null},t.prototype.getGridColumn=function(e){return this.getColumn(e,this.gridColumns,this.gridColumnsMap)},t.prototype.getSecondaryColumn=function(e){return this.secondaryColumns?this.getColumn(e,this.secondaryColumns,this.secondaryColumnsMap):null},t.prototype.getColumn=function(e,t,o){if(!e)return null;if("string"==typeof e&&o[e])return o[e];for(var n=0;n<t.length;n++)if(this.columnsMatch(t[n],e))return t[n];return this.getAutoColumn(e)},t.prototype.getSourceColumnsForGroupColumn=function(e){var t=e.getColDef().showRowGroup;if(!t)return null;if(!0===t)return this.rowGroupColumns.slice(0);var o=this.getPrimaryColumn(t);return o?[o]:null},t.prototype.getAutoColumn=function(e){var t=this;return this.groupAutoColumns&&r(this.groupAutoColumns)&&!i(this.groupAutoColumns)&&this.groupAutoColumns.find((function(o){return t.columnsMatch(o,e)}))||null},t.prototype.columnsMatch=function(e,t){var o=e===t,n=e.getColDef()===t,r=e.getColId()==t;return o||n||r},t.prototype.getDisplayNameForColumn=function(e,t,o){if(void 0===o&&(o=!1),!e)return null;var n=this.getHeaderName(e.getColDef(),e,null,null,t);return o?this.wrapHeaderNameWithAggFunc(e,n):n},t.prototype.getDisplayNameForProvidedColumnGroup=function(e,t,o){var n=t?t.getColGroupDef():null;return n?this.getHeaderName(n,null,e,t,o):null},t.prototype.getDisplayNameForColumnGroup=function(e,t){return this.getDisplayNameForProvidedColumnGroup(e,e.getProvidedColumnGroup(),t)},t.prototype.getHeaderName=function(e,t,o,n,r){var i=e.headerValueGetter;if(i){var a={colDef:e,column:t,columnGroup:o,providedColumnGroup:n,location:r,api:this.gridOptionsService.api,columnApi:this.gridOptionsService.columnApi,context:this.gridOptionsService.context};return"function"===typeof i?i(a):"string"===typeof i?this.expressionService.evaluate(i,a):(console.warn("AG Grid: headerValueGetter must be a function or a string"),"")}return null!=e.headerName?e.headerName:e.field?bt(e.field):""},t.prototype.wrapHeaderNameWithAggFunc=function(e,t){if(this.gridOptionsService.is("suppressAggFuncInHeader"))return t;var o,n=e.getColDef().pivotValueColumn,i=null;if(r(n)){var a=this.gridOptionsService.is("removePivotHeaderRowWhenSingleValueColumn")&&1===this.valueColumns.length,s=void 0!==e.getColDef().pivotTotalColumnIds;if(a&&!s)return t;i=n?n.getAggFunc():null,o=!0}else{var l=e.isValueActive(),c=this.pivotMode||!this.isRowGroupEmpty();l&&c?(i=e.getAggFunc(),o=!0):o=!1}if(o){var d="string"===typeof i?i:"func";return this.localeService.getLocaleTextFunc()(d,d)+"("+t+")"}return t},t.prototype.getColumnGroup=function(e,t){if(!e)return null;if(e instanceof ct)return e;var o=this.getAllDisplayedTrees(),n="number"===typeof t,r=null;return this.columnUtils.depthFirstAllColumnTreeSearch(o,(function(o){if(o instanceof ct){var i=o;(n?e===i.getGroupId()&&t===i.getPartId():e===i.getGroupId())&&(r=i)}})),r},t.prototype.isReady=function(){return this.ready},t.prototype.extractValueColumns=function(e,t){this.valueColumns=this.extractColumns(t,this.valueColumns,(function(t,o){return t.setValueActive(o,e)}),(function(){}),(function(){}),(function(e){var t=e.aggFunc;return null===t||""===t?null:void 0!==t?!!t:void 0}),(function(e){return null!=e.initialAggFunc&&""!=e.initialAggFunc})),this.valueColumns.forEach((function(e){var t=e.getColDef();null!=t.aggFunc&&""!=t.aggFunc?e.setAggFunc(t.aggFunc):e.getAggFunc()||e.setAggFunc(t.initialAggFunc)}))},t.prototype.extractRowGroupColumns=function(e,t){this.rowGroupColumns=this.extractColumns(t,this.rowGroupColumns,(function(t,o){return t.setRowGroupActive(o,e)}),(function(e){return e.rowGroupIndex}),(function(e){return e.initialRowGroupIndex}),(function(e){return e.rowGroup}),(function(e){return e.initialRowGroup}))},t.prototype.extractColumns=function(e,t,o,n,r,i,a){void 0===e&&(e=[]),void 0===t&&(t=[]);var s=[],d=[];(this.primaryColumns||[]).forEach((function(o){var u=e.indexOf(o)<0,p=o.getColDef(),h=c(i(p)),f=c(a(p)),g=l(n(p)),m=l(r(p));(void 0!==h?h:void 0!==g?null!==g&&g>=0:u?void 0!==f?f:!!(void 0!==m)&&(null!=m&&m>=0):t.indexOf(o)>=0)&&((u?null!=g||null!=m:null!=g)?s.push(o):d.push(o))}));var u=function(e){var t=n(e.getColDef()),o=r(e.getColDef());return null!=t?t:o};s.sort((function(e,t){var o=u(e),n=u(t);return o===n?0:o<n?-1:1}));var p=[].concat(s);return t.forEach((function(e){d.indexOf(e)>=0&&p.push(e)})),d.forEach((function(e){p.indexOf(e)<0&&p.push(e)})),t.forEach((function(e){p.indexOf(e)<0&&o(e,!1)})),p.forEach((function(e){t.indexOf(e)<0&&o(e,!0)})),p},t.prototype.extractPivotColumns=function(e,t){this.pivotColumns=this.extractColumns(t,this.pivotColumns,(function(t,o){return t.setPivotActive(o,e)}),(function(e){return e.pivotIndex}),(function(e){return e.initialPivotIndex}),(function(e){return e.pivot}),(function(e){return e.initialPivot}))},t.prototype.resetColumnGroupState=function(e){void 0===e&&(e="api");var t=[];this.columnUtils.depthFirstOriginalTreeSearch(null,this.primaryColumnTree,(function(e){if(e instanceof ue){var o=e.getColGroupDef(),n={groupId:e.getGroupId(),open:o?o.openByDefault:void 0};t.push(n)}})),this.setColumnGroupState(t,e)},t.prototype.getColumnGroupState=function(){var e=[];return this.columnUtils.depthFirstOriginalTreeSearch(null,this.gridBalancedTree,(function(t){t instanceof ue&&e.push({groupId:t.getGroupId(),open:t.isExpanded()})})),e},t.prototype.setColumnGroupState=function(e,t){var o=this;void 0===t&&(t="api"),this.columnAnimationService.start();var n=[];e.forEach((function(e){var t=e.groupId,r=e.open,i=o.getProvidedColumnGroup(t);i&&i.isExpanded()!==r&&(o.logger.log("columnGroupOpened("+i.getGroupId()+","+r+")"),i.setExpanded(r),n.push(i))})),this.updateGroupsAndDisplayedColumns(t),this.setFirstRightAndLastLeftPinned(t),n.forEach((function(e){var t={type:$e.EVENT_COLUMN_GROUP_OPENED,columnGroup:e};o.eventService.dispatchEvent(t)})),this.columnAnimationService.finish()},t.prototype.setColumnGroupOpened=function(e,t,o){var n;void 0===o&&(o="api"),n=e instanceof ue?e.getId():e||"",this.setColumnGroupState([{groupId:n,open:t}],o)},t.prototype.getProvidedColumnGroup=function(e){"string"!==typeof e&&console.error("AG Grid: group key must be a string");var t=null;return this.columnUtils.depthFirstOriginalTreeSearch(null,this.gridBalancedTree,(function(o){o instanceof ue&&o.getId()===e&&(t=o)})),t},t.prototype.calculateColumnsForDisplay=function(){var e=this;return this.pivotMode&&i(this.secondaryColumns)?this.gridColumns.filter((function(t){var o=e.groupAutoColumns&&we(e.groupAutoColumns,t),n=e.valueColumns&&we(e.valueColumns,t);return o||n})):this.gridColumns.filter((function(t){return e.groupAutoColumns&&we(e.groupAutoColumns,t)||t.isVisible()}))},t.prototype.checkColSpanActiveInCols=function(e){var t=!1;return e.forEach((function(e){r(e.getColDef().colSpan)&&(t=!0)})),t},t.prototype.calculateColumnsForGroupDisplay=function(){var e=this;this.groupDisplayColumns=[],this.groupDisplayColumnsMap={};var t=function(t){var o=t.getColDef(),n=o.showRowGroup;o&&r(n)&&(e.groupDisplayColumns.push(t),"string"===typeof n?e.groupDisplayColumnsMap[n]=t:!0===n&&e.getRowGroupColumns().forEach((function(o){e.groupDisplayColumnsMap[o.getId()]=t})))};this.gridColumns.forEach(t),this.groupAutoColumns&&this.groupAutoColumns.forEach(t)},t.prototype.getGroupDisplayColumns=function(){return this.groupDisplayColumns},t.prototype.getGroupDisplayColumnForGroup=function(e){return this.groupDisplayColumnsMap[e]},t.prototype.updateDisplayedColumns=function(e){var t=this.calculateColumnsForDisplay();this.buildDisplayedTrees(t),this.calculateColumnsForGroupDisplay(),this.updateGroupsAndDisplayedColumns(e),this.setFirstRightAndLastLeftPinned(e)},t.prototype.isSecondaryColumnsPresent=function(){return r(this.secondaryColumns)},t.prototype.setSecondaryColumns=function(e,t){var o=this;void 0===t&&(t="api");var n=e&&e.length>0;if(n||!i(this.secondaryColumns)){if(n){this.processSecondaryColumnDefinitions(e);var r=this.columnFactory.createColumnTree(e,!1,this.secondaryBalancedTree||this.previousSecondaryColumns||void 0);this.destroyOldColumns(this.secondaryBalancedTree,r.columnTree),this.secondaryBalancedTree=r.columnTree,this.secondaryHeaderRowCount=r.treeDept+1,this.secondaryColumns=this.getColumnsFromTree(this.secondaryBalancedTree),this.secondaryColumnsMap={},this.secondaryColumns.forEach((function(e){return o.secondaryColumnsMap[e.getId()]=e})),this.previousSecondaryColumns=null}else this.previousSecondaryColumns=this.secondaryBalancedTree,this.secondaryBalancedTree=null,this.secondaryHeaderRowCount=-1,this.secondaryColumns=null,this.secondaryColumnsMap={};this.updateGridColumns(),this.updateDisplayedColumns(t)}},t.prototype.processSecondaryColumnDefinitions=function(e){var t=this.gridOptionsService.get("processPivotResultColDef")||this.gridOptionsService.get("processSecondaryColDef"),o=this.gridOptionsService.get("processPivotResultColGroupDef")||this.gridOptionsService.get("processSecondaryColGroupDef");if(t||o){var n=function(e){e.forEach((function(e){if(r(e.children)){var i=e;o&&o(i),n(i.children)}else{t&&t(e)}}))};e&&n(e)}},t.prototype.updateGridColumns=function(){var e,t=this,o=this.gridBalancedTree;if(this.gridColsArePrimary?this.lastPrimaryOrder=this.gridColumns:this.lastSecondaryOrder=this.gridColumns,this.secondaryColumns&&this.secondaryBalancedTree){var n=this.secondaryColumns.every((function(e){return void 0!==t.gridColumnsMap[e.getColId()]}));this.gridBalancedTree=this.secondaryBalancedTree.slice(),this.gridHeaderRowCount=this.secondaryHeaderRowCount,this.gridColumns=this.secondaryColumns.slice(),this.gridColsArePrimary=!1,n&&(e=this.lastSecondaryOrder)}else this.primaryColumns&&(this.gridBalancedTree=this.primaryColumnTree.slice(),this.gridHeaderRowCount=this.primaryHeaderRowCount,this.gridColumns=this.primaryColumns.slice(),this.gridColsArePrimary=!0,e=this.lastPrimaryOrder);if(this.createGroupAutoColumnsIfNeeded()&&e){var r=wt(this.groupAutoColumns.map((function(e){return[e,!0]})));e=e.filter((function(e){return!r.has(e)})),e=Rt(this.groupAutoColumns,e)}if(this.addAutoGroupToGridColumns(),this.orderGridColsLike(e),this.gridColumns=this.placeLockedColumns(this.gridColumns),this.refreshQuickFilterColumns(),this.clearDisplayedAndViewportColumns(),this.colSpanActive=this.checkColSpanActiveInCols(this.gridColumns),this.gridColumnsMap={},this.gridColumns.forEach((function(e){return t.gridColumnsMap[e.getId()]=e})),this.setAutoHeightActive(),!ge(o,this.gridBalancedTree)){var i={type:$e.EVENT_GRID_COLUMNS_CHANGED};this.eventService.dispatchEvent(i)}},t.prototype.setAutoHeightActive=function(){if((this.autoHeightActive=this.gridColumns.filter((function(e){return e.isAutoHeight()})).length>0,this.autoHeightActive)&&(this.autoHeightActiveAtLeastOnce=!0,!(this.gridOptionsService.isRowModelType("clientSide")||this.gridOptionsService.isRowModelType("serverSide")))){j((function(){return console.warn("AG Grid - autoHeight columns only work with Client Side Row Model and Server Side Row Model.")}),"autoHeightActive.wrongRowModel")}},t.prototype.orderGridColsLike=function(e){if(!i(e)){var t=wt(e.map((function(e,t){return[e,t]}))),o=!0;if(this.gridColumns.forEach((function(e){t.has(e)&&(o=!1)})),!o){var n=wt(this.gridColumns.map((function(e){return[e,!0]}))),r=e.filter((function(e){return n.has(e)})),a=wt(r.map((function(e){return[e,!0]}))),s=this.gridColumns.filter((function(e){return!a.has(e)})),l=r.slice();s.forEach((function(e){var t=e.getOriginalParent();if(t){for(var o=[];!o.length&&t;){t.getLeafColumns().forEach((function(e){var t=l.indexOf(e)>=0,n=o.indexOf(e)<0;t&&n&&o.push(e)})),t=t.getOriginalParent()}if(o.length){var n=o.map((function(e){return l.indexOf(e)})),r=Math.max.apply(Math,Rt(n));be(l,e,r+1)}else l.push(e)}else l.push(e)})),this.gridColumns=l}}},t.prototype.isPrimaryColumnGroupsPresent=function(){return this.primaryHeaderRowCount>1},t.prototype.refreshQuickFilterColumns=function(){var e,t;this.groupAutoColumns?t=(null!==(e=this.primaryColumns)&&void 0!==e?e:[]).concat(this.groupAutoColumns):this.primaryColumns&&(t=this.primaryColumns),t=null!==t&&void 0!==t?t:[],this.columnsForQuickFilter=this.gridOptionsService.is("excludeHiddenColumnsFromQuickFilter")?t.filter((function(e){return e.isVisible()||e.isRowGroupActive()})):t},t.prototype.placeLockedColumns=function(e){var t=[],o=[],n=[];return e.forEach((function(e){var r=e.getColDef().lockPosition;"right"===r?n.push(e):"left"===r||!0===r?t.push(e):o.push(e)})),Rt(t,o,n)},t.prototype.addAutoGroupToGridColumns=function(){if(i(this.groupAutoColumns))return this.destroyOldColumns(this.groupAutoColsBalancedTree),void(this.groupAutoColsBalancedTree=null);this.gridColumns=this.groupAutoColumns?this.groupAutoColumns.concat(this.gridColumns):this.gridColumns;var e=this.columnFactory.createForAutoGroups(this.groupAutoColumns,this.gridBalancedTree);this.destroyOldColumns(this.groupAutoColsBalancedTree,e),this.groupAutoColsBalancedTree=e,this.gridBalancedTree=e.concat(this.gridBalancedTree)},t.prototype.clearDisplayedAndViewportColumns=function(){this.viewportRowLeft={},this.viewportRowRight={},this.viewportRowCenter={},this.displayedColumnsLeft=[],this.displayedColumnsRight=[],this.displayedColumnsCenter=[],this.displayedColumns=[],this.viewportColumns=[],this.headerViewportColumns=[],this.viewportColumnsHash=""},t.prototype.updateGroupsAndDisplayedColumns=function(e){this.updateOpenClosedVisibilityInColumnGroups(),this.deriveDisplayedColumns(e),this.refreshFlexedColumns(),this.extractViewport(),this.updateBodyWidths();var t={type:$e.EVENT_DISPLAYED_COLUMNS_CHANGED};this.eventService.dispatchEvent(t)},t.prototype.deriveDisplayedColumns=function(e){this.derivedDisplayedColumnsFromDisplayedTree(this.displayedTreeLeft,this.displayedColumnsLeft),this.derivedDisplayedColumnsFromDisplayedTree(this.displayedTreeCentre,this.displayedColumnsCenter),this.derivedDisplayedColumnsFromDisplayedTree(this.displayedTreeRight,this.displayedColumnsRight),this.joinDisplayedColumns(),this.setLeftValues(e),this.displayedAutoHeightCols=this.displayedColumns.filter((function(e){return e.isAutoHeight()}))},t.prototype.isAutoRowHeightActive=function(){return this.autoHeightActive},t.prototype.wasAutoRowHeightEverActive=function(){return this.autoHeightActiveAtLeastOnce},t.prototype.joinDisplayedColumns=function(){this.gridOptionsService.is("enableRtl")?this.displayedColumns=this.displayedColumnsRight.concat(this.displayedColumnsCenter).concat(this.displayedColumnsLeft):this.displayedColumns=this.displayedColumnsLeft.concat(this.displayedColumnsCenter).concat(this.displayedColumnsRight)},t.prototype.setLeftValues=function(e){this.setLeftValuesOfColumns(e),this.setLeftValuesOfGroups()},t.prototype.setLeftValuesOfColumns=function(e){var t=this;if(this.primaryColumns){var o=this.primaryColumns.slice(0),n=this.gridOptionsService.is("enableRtl");[this.displayedColumnsLeft,this.displayedColumnsRight,this.displayedColumnsCenter].forEach((function(r){if(n){var i=t.getWidthOfColsInList(r);r.forEach((function(t){i-=t.getActualWidth(),t.setLeft(i,e)}))}else{var a=0;r.forEach((function(t){t.setLeft(a,e),a+=t.getActualWidth()}))}ve(o,r)})),o.forEach((function(t){t.setLeft(null,e)}))}},t.prototype.setLeftValuesOfGroups=function(){[this.displayedTreeLeft,this.displayedTreeRight,this.displayedTreeCentre].forEach((function(e){e.forEach((function(e){e instanceof ct&&e.checkLeft()}))}))},t.prototype.derivedDisplayedColumnsFromDisplayedTree=function(e,t){t.length=0,this.columnUtils.depthFirstDisplayedColumnTreeSearch(e,(function(e){e instanceof ce&&t.push(e)}))},t.prototype.extractViewportColumns=function(){this.suppressColumnVirtualisation?(this.viewportColumnsCenter=this.displayedColumnsCenter,this.headerViewportColumnsCenter=this.displayedColumnsCenter):(this.viewportColumnsCenter=this.displayedColumnsCenter.filter(this.isColumnInRowViewport.bind(this)),this.headerViewportColumnsCenter=this.displayedColumnsCenter.filter(this.isColumnInHeaderViewport.bind(this))),this.viewportColumns=this.viewportColumnsCenter.concat(this.displayedColumnsLeft).concat(this.displayedColumnsRight),this.headerViewportColumns=this.headerViewportColumnsCenter.concat(this.displayedColumnsLeft).concat(this.displayedColumnsRight)},t.prototype.getVirtualHeaderGroupRow=function(e,t){var o;switch(e){case"left":o=this.viewportRowLeft[t];break;case"right":o=this.viewportRowRight[t];break;default:o=this.viewportRowCenter[t]}return i(o)&&(o=[]),o},t.prototype.calculateHeaderRows=function(){this.viewportRowLeft={},this.viewportRowRight={},this.viewportRowCenter={};var e={};this.headerViewportColumns.forEach((function(t){return e[t.getId()]=!0}));var t=function(o,n,r){for(var i=!1,a=0;a<o.length;a++){var s=o[a],l=!1;if(s instanceof ce)l=!0===e[s.getId()];else{var c=s.getDisplayedChildren();c&&(l=t(c,n,r+1))}l&&(i=!0,n[r]||(n[r]=[]),n[r].push(s))}return i};t(this.displayedTreeLeft,this.viewportRowLeft,0),t(this.displayedTreeRight,this.viewportRowRight,0),t(this.displayedTreeCentre,this.viewportRowCenter,0)},t.prototype.extractViewport=function(){this.extractViewportColumns();var e=this.viewportColumns.map((function(e){return e.getId()+"-"+(e.getPinned()||"normal")})).join("#"),t=this.viewportColumnsHash!==e;return t&&(this.viewportColumnsHash=e,this.calculateHeaderRows()),t},t.prototype.refreshFlexedColumns=function(e){var t=this;void 0===e&&(e={});var o=e.source?e.source:"flex";if(null!=e.viewportWidth&&(this.flexViewportWidth=e.viewportWidth),!this.flexViewportWidth)return[];var n=-1;e.resizingCols&&e.resizingCols.forEach((function(e){var o=t.displayedColumnsCenter.indexOf(e);n<o&&(n=o)}));var i=function(e){var o=t.displayedColumnsCenter.indexOf(e)>n;return e.getFlex()&&o},a=this.displayedColumnsCenter.filter((function(e){return!i(e)})),s=this.displayedColumnsCenter.filter((function(e){return i(e)})),l=[];if(!s.length)return[];var c,d=[];e:for(;;){var u=s.reduce((function(e,t){return e+t.getFlex()}),0);c=this.flexViewportWidth-this.getWidthOfColsInList(a);for(var p=0;p<s.length;p++){var h=s[p],f=c*h.getFlex()/u,g=0,m=h.getMinWidth(),y=h.getMaxWidth();if(r(m)&&f<m?g=m:r(y)&&f>y&&(g=y),g){h.setActualWidth(g,o),ye(s,h),l.push(h),a.push(h);continue e}d[p]=Math.round(f)}break}var v=c;return s.forEach((function(e,t){e.setActualWidth(Math.min(d[t],v),o),l.push(e),v-=d[t]})),e.skipSetLeft||this.setLeftValues(o),e.updateBodyWidths&&this.updateBodyWidths(),e.fireResizedEvent&&this.dispatchColumnResizedEvent(l,!0,o,s),s},t.prototype.sizeColumnsToFit=function(e,t,o,n){var i,a,s,l,c;void 0===t&&(t="sizeColumnsToFit");var d={};n&&(null===(i=null===n||void 0===n?void 0:n.columnLimits)||void 0===i||i.forEach((function(e){var t=e.key,o=kt(e,["key"]);d["string"===typeof t?t:t.getColId()]=o})));var u=this.getAllDisplayedColumns(),p=e===this.getWidthOfColsInList(u);if(!(e<=0||!u.length||p)){var h=[],f=[];u.forEach((function(e){!0===e.getColDef().suppressSizeToFit?f.push(e):h.push(e)}));var g=h.slice(0),m=!1,y=function(e){ye(h,e),f.push(e)};for(h.forEach((function(e){return e.resetActualWidth(t)}));!m;){m=!0;var v=e-this.getWidthOfColsInList(f);if(v<=0)h.forEach((function(e){var o,r,i=null!==(r=null===(o=null===d||void 0===d?void 0:d[e.getId()])||void 0===o?void 0:o.minWidth)&&void 0!==r?r:null===n||void 0===n?void 0:n.defaultMinWidth;"number"!==typeof i?e.setMinimum(t):e.setActualWidth(i)}));else for(var b=v/this.getWidthOfColsInList(h),x=v,w=h.length-1;w>=0;w--){var C=h[w],_=null===d||void 0===d?void 0:d[C.getId()],S=null!==(a=null===_||void 0===_?void 0:_.minWidth)&&void 0!==a?a:null===n||void 0===n?void 0:n.defaultMinWidth,E=null!==(s=null===_||void 0===_?void 0:_.maxWidth)&&void 0!==s?s:null===n||void 0===n?void 0:n.defaultMaxWidth,k=null!==(l=C.getMinWidth())&&void 0!==l?l:0,j=null!==(c=C.getMaxWidth())&&void 0!==c?c:Number.MAX_VALUE,A="number"===typeof S&&S>k?S:C.getMinWidth(),R="number"===typeof E&&E<j?E:C.getMaxWidth(),O=Math.round(C.getActualWidth()*b);r(A)&&O<A?(O=A,y(C),m=!1):r(R)&&O>R?(O=R,y(C),m=!1):0===w&&(O=x),C.setActualWidth(O,t,!0),x-=O}}g.forEach((function(e){e.fireColumnWidthChangedEvent(t)})),this.setLeftValues(t),this.updateBodyWidths(),o||this.dispatchColumnResizedEvent(g,!0,t)}},t.prototype.buildDisplayedTrees=function(e){var t=[],o=[],n=[];e.forEach((function(e){switch(e.getPinned()){case"left":t.push(e);break;case"right":o.push(e);break;default:n.push(e)}}));var r=new dt;this.displayedTreeLeft=this.displayedGroupCreator.createDisplayedGroups(t,this.gridBalancedTree,r,"left",this.displayedTreeLeft),this.displayedTreeRight=this.displayedGroupCreator.createDisplayedGroups(o,this.gridBalancedTree,r,"right",this.displayedTreeRight),this.displayedTreeCentre=this.displayedGroupCreator.createDisplayedGroups(n,this.gridBalancedTree,r,null,this.displayedTreeCentre),this.updateDisplayedMap()},t.prototype.updateDisplayedMap=function(){var e=this;this.displayedColumnsAndGroupsMap={};var t=function(t){e.displayedColumnsAndGroupsMap[t.getUniqueId()]=t};this.columnUtils.depthFirstAllColumnTreeSearch(this.displayedTreeCentre,t),this.columnUtils.depthFirstAllColumnTreeSearch(this.displayedTreeLeft,t),this.columnUtils.depthFirstAllColumnTreeSearch(this.displayedTreeRight,t)},t.prototype.isDisplayed=function(e){return this.displayedColumnsAndGroupsMap[e.getUniqueId()]===e},t.prototype.updateOpenClosedVisibilityInColumnGroups=function(){var e=this.getAllDisplayedTrees();this.columnUtils.depthFirstAllColumnTreeSearch(e,(function(e){e instanceof ct&&e.calculateDisplayedColumns()}))},t.prototype.getGroupAutoColumns=function(){return this.groupAutoColumns},t.prototype.createGroupAutoColumnsIfNeeded=function(){if(!this.autoGroupsNeedBuilding)return!1;this.autoGroupsNeedBuilding=!1;var e=this.gridOptionsService.isGroupUseEntireRow(this.pivotMode),t=this.pivotMode?this.gridOptionsService.is("pivotSuppressAutoColumn"):this.isGroupSuppressAutoColumn();if((this.rowGroupColumns.length>0||this.usingTreeData)&&!t&&!e){var o=this.groupAutoColumns||[],n=this.autoGroupColService.createAutoGroupColumns(o,this.rowGroupColumns);if(!this.autoColsEqual(n,this.groupAutoColumns)||this.forceRecreateAutoGroups)return this.groupAutoColumns=n,!0}else this.groupAutoColumns=null;return!1},t.prototype.isGroupSuppressAutoColumn=function(){var e=this.gridOptionsService.get("groupDisplayType");if(!!e&&st("custom",e))return!0;var t=this.gridOptionsService.get("treeDataDisplayType");return!!t&&function(e,t){var o=["auto","custom"];return o.indexOf(t)<0?(console.warn("AG Grid: '"+t+"' is not a valid treeDataDisplayType value - possible values are: '"+o.join("', '")+"'"),!1):t===e}("custom",t)},t.prototype.autoColsEqual=function(e,t){return ge(e,t,(function(e,t){return e.getColId()===t.getColId()}))},t.prototype.getWidthOfColsInList=function(e){return e.reduce((function(e,t){return e+t.getActualWidth()}),0)},t.prototype.getGridBalancedTree=function(){return this.gridBalancedTree},t.prototype.hasFloatingFilters=function(){return!!this.gridColumns&&this.gridColumns.some((function(e){return e.getColDef().floatingFilter}))},t.prototype.getFirstDisplayedColumn=function(){var e=this.gridOptionsService.is("enableRtl"),t=["getDisplayedLeftColumns","getDisplayedCenterColumns","getDisplayedRightColumns"];e&&t.reverse();for(var o=0;o<t.length;o++){var n=this[t[o]]();if(n.length)return e?fe(n):n[0]}return null},t.prototype.setColumnHeaderHeight=function(e,t){if(e.setAutoHeaderHeight(t)){var o={type:$e.EVENT_COLUMN_HEADER_HEIGHT_CHANGED,column:e,columns:[e],source:"autosizeColumnHeaderHeight"};this.eventService.dispatchEvent(o)}},t.prototype.getColumnGroupHeaderRowHeight=function(){return this.isPivotMode()?this.getPivotGroupHeaderHeight():this.getGroupHeaderHeight()},t.prototype.getColumnHeaderRowHeight=function(){var e=this.isPivotMode()?this.getPivotHeaderHeight():this.getHeaderHeight(),t=this.getAllDisplayedColumns().filter((function(e){return e.isAutoHeaderHeight()})).map((function(e){return e.getAutoHeaderHeight()||0}));return Math.max.apply(Math,Rt([e],t))},t.prototype.getHeaderHeight=function(){var e;return null!==(e=this.gridOptionsService.getNum("headerHeight"))&&void 0!==e?e:this.environment.getFromTheme(25,"headerHeight")},t.prototype.getFloatingFiltersHeight=function(){var e;return null!==(e=this.gridOptionsService.getNum("floatingFiltersHeight"))&&void 0!==e?e:this.getHeaderHeight()},t.prototype.getGroupHeaderHeight=function(){var e;return null!==(e=this.gridOptionsService.getNum("groupHeaderHeight"))&&void 0!==e?e:this.getHeaderHeight()},t.prototype.getPivotHeaderHeight=function(){var e;return null!==(e=this.gridOptionsService.getNum("pivotHeaderHeight"))&&void 0!==e?e:this.getHeaderHeight()},t.prototype.getPivotGroupHeaderHeight=function(){var e;return null!==(e=this.gridOptionsService.getNum("pivotGroupHeaderHeight"))&&void 0!==e?e:this.getGroupHeaderHeight()},St([q("expressionService")],t.prototype,"expressionService",void 0),St([q("columnFactory")],t.prototype,"columnFactory",void 0),St([q("displayedGroupCreator")],t.prototype,"displayedGroupCreator",void 0),St([q("ctrlsService")],t.prototype,"ctrlsService",void 0),St([q("autoWidthCalculator")],t.prototype,"autoWidthCalculator",void 0),St([q("columnUtils")],t.prototype,"columnUtils",void 0),St([q("columnAnimationService")],t.prototype,"columnAnimationService",void 0),St([q("autoGroupColService")],t.prototype,"autoGroupColService",void 0),St([K("aggFuncService")],t.prototype,"aggFuncService",void 0),St([K("valueCache")],t.prototype,"valueCache",void 0),St([K("animationFrameService")],t.prototype,"animationFrameService",void 0),St([q("sortController")],t.prototype,"sortController",void 0),St([q("columnDefFactory")],t.prototype,"columnDefFactory",void 0),St([$],t.prototype,"init",null),St([U],t.prototype,"destroyColumns",null),St([Et(0,J("loggerFactory"))],t.prototype,"setBeans",null),t=St([W("columnModel")],t)}(Fe),Tt=function(){var e=function(t,o){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])},e(t,o)};return function(t,o){function n(){this.constructor=t}e(t,o),t.prototype=null===o?Object.create(o):(n.prototype=o.prototype,new n)}}(),Dt=function(e,t,o,n){var r,i=arguments.length,a=i<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,o):n;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)a=Reflect.decorate(e,t,o,n);else for(var s=e.length-1;s>=0;s--)(r=e[s])&&(a=(i<3?r(a):i>3?r(t,o,a):r(t,o))||a);return i>3&&a&&Object.defineProperty(t,o,a),a},Pt=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Tt(t,e),t.prototype.calculateColMinWidth=function(e){return null!=e.minWidth?e.minWidth:this.environment.getMinColWidth()},t.prototype.calculateColMaxWidth=function(e){return null!=e.maxWidth?e.maxWidth:Number.MAX_SAFE_INTEGER},t.prototype.calculateColInitialWidth=function(e){var t,o=this.calculateColMinWidth(e),n=this.calculateColMaxWidth(e),r=l(e.width),i=l(e.initialWidth);return t=null!=r?r:null!=i?i:200,Math.max(Math.min(t,n),o)},t.prototype.getOriginalPathForColumn=function(e,t){var o=[],n=!1,r=function(t,i){for(var a=0;a<t.length;a++){if(n)return;var s=t[a];if(s instanceof ue)r(s.getChildren(),i+1),o[i]=s;else s===e&&(n=!0)}};return r(t,0),n?o:null},t.prototype.depthFirstOriginalTreeSearch=function(e,t,o){var n=this;t&&t.forEach((function(t){t instanceof ue&&n.depthFirstOriginalTreeSearch(t,t.getChildren(),o),o(t,e)}))},t.prototype.depthFirstAllColumnTreeSearch=function(e,t){var o=this;e&&e.forEach((function(e){e instanceof ct&&o.depthFirstAllColumnTreeSearch(e.getChildren(),t),t(e)}))},t.prototype.depthFirstDisplayedColumnTreeSearch=function(e,t){var o=this;e&&e.forEach((function(e){e instanceof ct&&o.depthFirstDisplayedColumnTreeSearch(e.getDisplayedChildren(),t),t(e)}))},t=Dt([W("columnUtils")],t)}(Fe),Nt=function(){var e=function(t,o){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])},e(t,o)};return function(t,o){function n(){this.constructor=t}e(t,o),t.prototype=null===o?Object.create(o):(n.prototype=o.prototype,new n)}}(),It=function(e,t,o,n){var r,i=arguments.length,a=i<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,o):n;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)a=Reflect.decorate(e,t,o,n);else for(var s=e.length-1;s>=0;s--)(r=e[s])&&(a=(i<3?r(a):i>3?r(t,o,a):r(t,o))||a);return i>3&&a&&Object.defineProperty(t,o,a),a},Mt=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Nt(t,e),t.prototype.createDisplayedGroups=function(e,t,o,n,r){var i,a,s=this,l=[],c=this.mapOldGroupsById(r);return e.forEach((function(e){for(var r=s.getOriginalPathForColumn(t,e),d=[],u=!a,p=0;p<r.length;p++)if(u||r[p]!==a[p]){var h=s.createColumnGroup(r[p],o,c,n);d[p]=h,0==p?l.push(h):d[p-1].addChild(h)}else d[p]=i[p];0===d.length?l.push(e):fe(d).addChild(e);i=d,a=r})),this.setupParentsIntoColumns(l,null),l},t.prototype.createColumnGroup=function(e,t,o,n){var i=e.getGroupId(),a=t.getInstanceIdForKey(i),s=o[ct.createUniqueId(i,a)];return s&&s.getProvidedColumnGroup()!==e&&(s=null),r(s)?s.reset():(s=new ct(e,i,a,n),this.context.createBean(s)),s},t.prototype.mapOldGroupsById=function(e){var t={},o=function(e){e.forEach((function(e){if(e instanceof ct){var n=e;t[e.getUniqueId()]=n,o(n.getChildren())}}))};return e&&o(e),t},t.prototype.setupParentsIntoColumns=function(e,t){var o=this;e.forEach((function(e){if(e.setParent(t),e instanceof ct){var n=e;o.setupParentsIntoColumns(n.getChildren(),n)}}))},t.prototype.getOriginalPathForColumn=function(e,t){var o=[],n=!1,r=function(e,i){for(var a=0;a<e.length;a++){if(n)return;var s=e[a];s instanceof ue?(r(s.getChildren(),i+1),o[i]=s):s===t&&(n=!0)}};return r(e,0),n?o:(console.warn("AG Grid: could not get path"),null)},t=It([W("displayedGroupCreator")],t)}(Fe),Lt=function(){var e=function(t,o){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])},e(t,o)};return function(t,o){function n(){this.constructor=t}e(t,o),t.prototype=null===o?Object.create(o):(n.prototype=o.prototype,new n)}}(),Ft=function(e,t,o,n){var r,i=arguments.length,a=i<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,o):n;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)a=Reflect.decorate(e,t,o,n);else for(var s=e.length-1;s>=0;s--)(r=e[s])&&(a=(i<3?r(a):i>3?r(t,o,a):r(t,o))||a);return i>3&&a&&Object.defineProperty(t,o,a),a},Gt=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.componentsMappedByName={},t}return Lt(t,e),t.prototype.setupComponents=function(e){var t=this;e&&e.forEach((function(e){return t.addComponent(e)}))},t.prototype.addComponent=function(e){var t=e.componentName.replace(/([a-z])([A-Z])/g,"$1-$2").toLowerCase().toUpperCase();this.componentsMappedByName[t]=e.componentClass},t.prototype.getComponentClass=function(e){return this.componentsMappedByName[e]},t=Ft([W("agStackComponentsRegistry")],t)}(Fe);function zt(e,t,o){null==o||""==o?Bt(e,t):Ht(e,t,o)}function Ht(e,t,o){e.setAttribute(Vt(t),o.toString())}function Bt(e,t){e.removeAttribute(Vt(t))}function Vt(e){return"aria-"+e}function $t(e,t){t?e.setAttribute("role",t):e.removeAttribute("role")}function Ut(e){return"asc"===e?"ascending":"desc"===e?"descending":"mixed"===e?"other":"none"}function Wt(e){return parseInt(e.getAttribute("aria-level"),10)}function qt(e){return parseInt(e.getAttribute("aria-posinset"),10)}function Kt(e,t){zt(e,"label",t)}function Yt(e,t){zt(e,"labelledby",t)}function Jt(e,t){zt(e,"description",t)}function Xt(e,t){zt(e,"describedby",t)}function Qt(e,t){zt(e,"level",t)}function Zt(e,t){zt(e,"disabled",t)}function eo(e,t){zt(e,"hidden",t)}function to(e,t){Ht(e,"expanded",t)}function oo(e){Bt(e,"expanded")}function no(e,t){Ht(e,"setsize",t)}function ro(e,t){Ht(e,"posinset",t)}function io(e,t){Ht(e,"multiselectable",t)}function ao(e,t){Ht(e,"rowcount",t)}function so(e,t){Ht(e,"rowindex",t)}function lo(e,t){Ht(e,"colcount",t)}function co(e,t){Ht(e,"colindex",t)}function uo(e,t){Ht(e,"colspan",t)}function po(e,t){Ht(e,"sort",t)}function ho(e){Bt(e,"sort")}function fo(e,t){zt(e,"selected",t)}function go(e,t){Ht(e,"checked",void 0===t?"mixed":t)}var mo,yo,vo,bo,xo,wo,Co,_o,So=Object.freeze({__proto__:null,setAriaRole:$t,getAriaSortState:Ut,getAriaLevel:Wt,getAriaPosInSet:qt,getAriaDescribedBy:function(e){return e.getAttribute("aria-describedby")||""},setAriaLabel:Kt,setAriaLabelledBy:Yt,setAriaDescription:Jt,setAriaDescribedBy:Xt,setAriaLive:function(e,t){zt(e,"live",t)},setAriaLevel:Qt,setAriaDisabled:Zt,setAriaHidden:eo,setAriaExpanded:to,removeAriaExpanded:oo,setAriaSetSize:no,setAriaPosInSet:ro,setAriaMultiSelectable:io,setAriaRowCount:ao,setAriaRowIndex:so,setAriaColCount:lo,setAriaColIndex:co,setAriaColSpan:uo,setAriaSort:po,removeAriaSort:ho,setAriaSelected:fo,setAriaChecked:go});function Eo(){return void 0===mo&&(mo=/^((?!chrome|android).)*safari/i.test(navigator.userAgent)),mo}function ko(){if(void 0===yo)if(Eo()){var e=navigator.userAgent.match(/version\/(\d+)/i);e&&(yo=null!=e[1]?parseFloat(e[1]):0)}else yo=0;return yo}function jo(){if(void 0===vo){var e=window;vo=!!e.chrome&&(!!e.chrome.webstore||!!e.chrome.runtime)||/Chrome/.test(navigator.userAgent)&&/Google Inc/.test(navigator.vendor)}return vo}function Ao(){return void 0===bo&&(bo=/(firefox)/i.test(navigator.userAgent)),bo}function Ro(){return void 0===xo&&(xo=/(Mac|iPhone|iPod|iPad)/i.test(navigator.platform)),xo}function Oo(){return void 0===wo&&(wo=/iPad|iPhone|iPod/.test(navigator.platform)||"MacIntel"===navigator.platform&&navigator.maxTouchPoints>1),wo}function To(){return!Eo()||ko()>=15}function Do(e){if(!e)return null;var t=e.tabIndex,o=e.getAttribute("tabIndex");return-1!==t||null!==o&&(""!==o||Ao())?t.toString():null}function Po(){if(!document.body)return-1;var e=1e6,t=navigator.userAgent.toLowerCase().match(/firefox/)?6e6:1e9,o=document.createElement("div");for(document.body.appendChild(o);;){var n=2*e;if(o.style.height=n+"px",n>t||o.clientHeight!==n)break;e=n}return document.body.removeChild(o),e}function No(){var e,t,o;return null!==(t=null===(e=document.body)||void 0===e?void 0:e.clientWidth)&&void 0!==t?t:window.innerHeight||(null===(o=document.documentElement)||void 0===o?void 0:o.clientWidth)||-1}function Io(){var e,t,o;return null!==(t=null===(e=document.body)||void 0===e?void 0:e.clientHeight)&&void 0!==t?t:window.innerHeight||(null===(o=document.documentElement)||void 0===o?void 0:o.clientHeight)||-1}function Mo(){return null==_o&&Lo(),_o}function Lo(){var e=document.body,t=document.createElement("div");t.style.width=t.style.height="100px",t.style.opacity="0",t.style.overflow="scroll",t.style.msOverflowStyle="scrollbar",t.style.position="absolute",e.appendChild(t);var o=t.offsetWidth-t.clientWidth;0===o&&0===t.clientWidth&&(o=null),t.parentNode&&t.parentNode.removeChild(t),null!=o&&(_o=o,Co=0===o)}function Fo(){return null==Co&&Lo(),Co}var Go=Object.freeze({__proto__:null,isBrowserSafari:Eo,getSafariVersion:ko,isBrowserChrome:jo,isBrowserFirefox:Ao,isMacOsUserAgent:Ro,isIOSUserAgent:Oo,browserSupportsPreventScroll:To,getTabIndex:Do,getMaxDivHeight:Po,getBodyWidth:No,getBodyHeight:Io,getScrollbarWidth:Mo,isInvisibleScrollbar:Fo});function zo(e,t){return e.toString().padStart(t,"0")}function Ho(e,t){for(var o=[],n=e;n<=t;n++)o.push(n);return o}function Bo(e,t,o){return"number"!==typeof e?"":e.toString().replace(".",o).replace(/(\d)(?=(\d{3})+(?!\d))/g,"$1"+t)}var Vo=Object.freeze({__proto__:null,padStartWidthZeros:zo,createArrayOfNumbers:Ho,cleanNumber:function(e){return"string"===typeof e&&(e=parseInt(e,10)),"number"===typeof e?Math.floor(e):null},decToHex:function(e,t){for(var o="",n=0;n<t;n++)o+=String.fromCharCode(255&e),e>>>=8;return o},formatNumberTwoDecimalPlacesAndCommas:function(e,t,o){return"number"!==typeof e?"":Bo(Math.round(100*e)/100,t,o)},formatNumberCommas:Bo,sum:function(e){return null==e?null:e.reduce((function(e,t){return e+t}),0)},zeroOrGreater:function(e,t){return e>=0?e:t},oneOrGreater:function(e,t){var o=parseInt(e,10);return!isNaN(o)&&isFinite(o)&&o>0?o:t}}),$o=function(e,t){var o="function"===typeof Symbol&&e[Symbol.iterator];if(!o)return e;var n,r,i=o.call(e),a=[];try{for(;(void 0===t||t-- >0)&&!(n=i.next()).done;)a.push(n.value)}catch(s){r={error:s}}finally{try{n&&!n.done&&(o=i.return)&&o.call(i)}finally{if(r)throw r.error}}return a};function Uo(e,t,o){if(void 0===t&&(t=!0),void 0===o&&(o="-"),!e)return null;var n=[e.getFullYear(),e.getMonth()+1,e.getDate()].map((function(e){return zo(e,2)})).join(o);return t&&(n+=" "+[e.getHours(),e.getMinutes(),e.getSeconds()].map((function(e){return zo(e,2)})).join(":")),n}var Wo=function(e){if(e>3&&e<21)return"th";switch(e%10){case 1:return"st";case 2:return"nd";case 3:return"rd"}return"th"};function qo(e,t){void 0===t&&(t="YYYY-MM-DD");var o=zo(e.getFullYear(),4),n=["January","February","March","April","May","June","July","August","September","October","November","December"],r=["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],i={YYYY:function(){return o.slice(o.length-4,o.length)},YY:function(){return o.slice(o.length-2,o.length)},Y:function(){return""+e.getFullYear()},MMMM:function(){return n[e.getMonth()]},MMM:function(){return n[e.getMonth()].slice(0,3)},MM:function(){return zo(e.getMonth()+1,2)},Mo:function(){return""+(e.getMonth()+1)+Wo(e.getMonth()+1)},M:function(){return""+(e.getMonth()+1)},Do:function(){return""+e.getDate()+Wo(e.getDate())},DD:function(){return zo(e.getDate(),2)},D:function(){return""+e.getDate()},dddd:function(){return r[e.getDay()]},ddd:function(){return r[e.getDay()].slice(0,3)},dd:function(){return r[e.getDay()].slice(0,2)},do:function(){return""+e.getDay()+Wo(e.getDay())},d:function(){return""+e.getDay()}},a=new RegExp(Object.keys(i).join("|"),"g");return t.replace(a,(function(e){return e in i?i[e]():e}))}function Ko(e){if(!e)return null;var t=$o(e.split(" "),2),o=t[0],n=t[1];if(!o)return null;var r=o.split("-").map((function(e){return parseInt(e,10)}));if(3!==r.filter((function(e){return!isNaN(e)})).length)return null;var i=$o(r,3),a=i[0],s=i[1],l=i[2],c=new Date(a,s-1,l);if(c.getFullYear()!==a||c.getMonth()!==s-1||c.getDate()!==l)return null;if(!n||"00:00:00"===n)return c;var d=$o(n.split(":").map((function(e){return parseInt(e,10)})),3),u=d[0],p=d[1],h=d[2];return u>=0&&u<24&&c.setHours(u),p>=0&&p<60&&c.setMinutes(p),h>=0&&h<60&&c.setSeconds(h),c}var Yo,Jo=Object.freeze({__proto__:null,serialiseDate:Uo,dateToFormattedString:qo,parseDateTimeFromString:Ko}),Xo=function(e){var t="function"===typeof Symbol&&Symbol.iterator,o=t&&e[t],n=0;if(o)return o.call(e);if(e&&"number"===typeof e.length)return{next:function(){return e&&n>=e.length&&(e=void 0),{value:e&&e[n++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")},Qo=function(e,t){var o="function"===typeof Symbol&&e[Symbol.iterator];if(!o)return e;var n,r,i=o.call(e),a=[];try{for(;(void 0===t||t-- >0)&&!(n=i.next()).done;)a.push(n.value)}catch(s){r={error:s}}finally{try{n&&!n.done&&(o=i.return)&&o.call(i)}finally{if(r)throw r.error}}return a};var Zo="[tabindex], input, select, button, textarea, [href]",en=".ag-hidden, .ag-hidden *, [disabled], .ag-disabled, .ag-disabled *";function tn(e){var t=Element.prototype.matches||Element.prototype.msMatchesSelector,o=t.call(e,"input, select, button, textarea"),n=t.call(e,en),r=yn(e);return o&&!n&&r}function on(e,t,o){void 0===o&&(o={});var n=o.skipAriaHidden;e.classList.toggle("ag-hidden",!t),n||eo(e,!t)}function nn(e,t,o){void 0===o&&(o={});var n=o.skipAriaHidden;e.classList.toggle("ag-invisible",!t),n||eo(e,!t)}function rn(e,t){var o="disabled",n=t?function(e){return e.setAttribute(o,"")}:function(e){return e.removeAttribute(o)};n(e),In(e.querySelectorAll("input"),(function(e){return n(e)}))}function an(e,t,o){for(var n=0;e;){if(e.classList.contains(t))return!0;if(e=e.parentElement,"number"==typeof o){if(++n>o)break}else if(e===o)break}return!1}function sn(e){var t=window.getComputedStyle(e),o=t.height,n=t.width,r=t.borderTopWidth,i=t.borderRightWidth,a=t.borderBottomWidth,s=t.borderLeftWidth,l=t.paddingTop,c=t.paddingRight,d=t.paddingBottom,u=t.paddingLeft,p=t.marginTop,h=t.marginRight,f=t.marginBottom,g=t.marginLeft,m=t.boxSizing;return{height:parseFloat(o),width:parseFloat(n),borderTopWidth:parseFloat(r),borderRightWidth:parseFloat(i),borderBottomWidth:parseFloat(a),borderLeftWidth:parseFloat(s),paddingTop:parseFloat(l),paddingRight:parseFloat(c),paddingBottom:parseFloat(d),paddingLeft:parseFloat(u),marginTop:parseFloat(p),marginRight:parseFloat(h),marginBottom:parseFloat(f),marginLeft:parseFloat(g),boxSizing:m}}function ln(e){var t=sn(e);return"border-box"===t.boxSizing?t.height-t.paddingTop-t.paddingBottom:t.height}function cn(e){var t=sn(e);return"border-box"===t.boxSizing?t.width-t.paddingLeft-t.paddingRight:t.width}function dn(e){var t=sn(e),o=t.marginBottom+t.marginTop;return Math.ceil(e.offsetHeight+o)}function un(e){var t=sn(e),o=t.marginLeft+t.marginRight;return Math.ceil(e.offsetWidth+o)}function pn(){if("boolean"===typeof Yo)return Yo;var e=document.createElement("div");return e.style.direction="rtl",e.style.width="1px",e.style.height="1px",e.style.position="fixed",e.style.top="0px",e.style.overflow="hidden",e.dir="rtl",e.innerHTML='<div style="width: 2px">\n            <span style="display: inline-block; width: 1px"></span>\n            <span style="display: inline-block; width: 1px"></span>\n        </div>',document.body.appendChild(e),e.scrollLeft=1,Yo=0===Math.floor(e.scrollLeft),document.body.removeChild(e),Yo}function hn(e,t){var o=e.scrollLeft;return t&&(o=Math.abs(o),jo()&&!pn()&&(o=e.scrollWidth-e.clientWidth-o)),o}function fn(e,t,o){o&&(pn()?t*=-1:(Eo()||jo())&&(t=e.scrollWidth-e.clientWidth-t)),e.scrollLeft=t}function gn(e){for(;e&&e.firstChild;)e.removeChild(e.firstChild)}function mn(e){e&&e.parentNode&&e.parentNode.removeChild(e)}function yn(e){return null!==e.offsetParent}function vn(e){var t=document.createElement("div");return t.innerHTML=(e||"").trim(),t.firstChild}function bn(e){return e&&e.clientHeight?e.clientHeight:0}function xn(e){return e&&e.clientWidth?e.clientWidth:0}function wn(e,t,o){if(!o||o.nextSibling!==t){var n=document.activeElement,r=t.contains(n);o?o.nextSibling?e.insertBefore(t,o.nextSibling):e.appendChild(t):e.firstChild&&e.firstChild!==t&&e.insertAdjacentElement("afterbegin",t),r&&n&&To()&&n.focus({preventScroll:!0})}}function Cn(e,t){for(var o=0;o<t.length;o++){var n=t[o],r=e.children[o];r!==n&&e.insertBefore(n,r)}}function _n(e,t,o){o?o.insertAdjacentElement("afterend",t):e.firstChild?e.insertAdjacentElement("afterbegin",t):e.appendChild(t)}function Sn(e,t){var o,n;if(t)try{for(var r=Xo(Object.entries(t)),i=r.next();!i.done;i=r.next()){var a=Qo(i.value,2),s=a[0],l=a[1];if(s&&s.length&&null!=l){var c=s.replace(/[A-Z]/g,(function(e){return"-"+e.toLocaleLowerCase()})),d=l.toString(),u=d.replace(/\s*!important/g,"").length!=d.length?"important":void 0;e.style.setProperty(c,l,u)}}}catch(p){o={error:p}}finally{try{i&&!i.done&&(n=r.return)&&n.call(r)}finally{if(o)throw o.error}}}function En(e){return e.clientWidth<e.scrollWidth}function kn(e){return e.clientHeight<e.scrollHeight}function jn(e,t){"flex"===t?(e.style.removeProperty("width"),e.style.removeProperty("minWidth"),e.style.removeProperty("maxWidth"),e.style.flex="1 1 auto"):An(e,t)}function An(e,t){t=On(t),e.style.width=t.toString(),e.style.maxWidth=t.toString(),e.style.minWidth=t.toString()}function Rn(e,t){t=On(t),e.style.height=t.toString(),e.style.maxHeight=t.toString(),e.style.minHeight=t.toString()}function On(e){return"number"===typeof e?e+"px":e}function Tn(e){return e instanceof Node||e instanceof HTMLElement}function Dn(e){if(null==e)return[];var t=[];return In(e,(function(e){return t.push(e)})),t}function Pn(e,t){if(e)for(var o=0;o<e.length;o++){var n=e[o];t(n.name,n.value)}}function Nn(e,t,o){null==o?e.removeAttribute(t):e.setAttribute(t,o.toString())}function In(e,t){if(null!=e)for(var o=0;o<e.length;o++)t(e[o])}var Mn=Object.freeze({__proto__:null,radioCssClass:function(e,t,o){for(var n=e.parentElement,r=n&&n.firstChild;r;)t&&r.classList.toggle(t,r===e),o&&r.classList.toggle(o,r!==e),r=r.nextSibling},FOCUSABLE_SELECTOR:Zo,FOCUSABLE_EXCLUDE:en,isFocusableFormField:tn,setDisplayed:on,setVisible:nn,setDisabled:rn,isElementChildOfClass:an,getElementSize:sn,getInnerHeight:ln,getInnerWidth:cn,getAbsoluteHeight:dn,getAbsoluteWidth:un,isRtlNegativeScroll:pn,getScrollLeft:hn,setScrollLeft:fn,clearElement:gn,removeElement:function(e,t){mn(e.querySelector(t))},removeFromParent:mn,isVisible:yn,loadTemplate:vn,appendHtml:function(e,t){e.lastChild?e.insertAdjacentHTML("afterbegin",t):e.innerHTML=t},getElementAttribute:function(e,t){return e.attributes&&e.attributes[t]?e.attributes[t].value:null},offsetHeight:bn,offsetWidth:xn,ensureDomOrder:wn,setDomChildOrder:Cn,insertWithDomOrder:_n,prependDC:function(e,t){r(e.firstChild)?e.insertBefore(t,e.firstChild):e.appendChild(t)},addStylesToElement:Sn,isHorizontalScrollShowing:En,isVerticalScrollShowing:kn,setElementWidth:jn,setFixedWidth:An,setElementHeight:function(e,t){"flex"===t?(e.style.removeProperty("height"),e.style.removeProperty("minHeight"),e.style.removeProperty("maxHeight"),e.style.flex="1 1 auto"):Rn(e,t)},setFixedHeight:Rn,formatSize:On,isNodeOrElement:Tn,copyNodeList:Dn,iterateNamedNodeMap:Pn,addOrRemoveAttribute:Nn,nodeListForEach:In}),Ln={columnGroupOpened:"expanded",columnGroupClosed:"contracted",columnSelectClosed:"tree-closed",columnSelectOpen:"tree-open",columnSelectIndeterminate:"tree-indeterminate",columnMovePin:"pin",columnMoveHide:"eye-slash",columnMoveMove:"arrows",columnMoveLeft:"left",columnMoveRight:"right",columnMoveGroup:"group",columnMoveValue:"aggregation",columnMovePivot:"pivot",dropNotAllowed:"not-allowed",groupContracted:"tree-closed",groupExpanded:"tree-open",setFilterGroupClosed:"tree-closed",setFilterGroupOpen:"tree-open",setFilterGroupIndeterminate:"tree-indeterminate",chart:"chart",close:"cross",cancel:"cancel",check:"tick",first:"first",previous:"previous",next:"next",last:"last",linked:"linked",unlinked:"unlinked",colorPicker:"color-picker",groupLoading:"loading",menu:"menu",filter:"filter",columns:"columns",maximize:"maximize",minimize:"minimize",menuPin:"pin",menuValue:"aggregation",menuAddRowGroup:"group",menuRemoveRowGroup:"group",clipboardCopy:"copy",clipboardCut:"cut",clipboardPaste:"paste",pivotPanel:"pivot",rowGroupPanel:"group",valuePanel:"aggregation",columnDrag:"grip",rowDrag:"grip",save:"save",csvExport:"csv",excelExport:"excel",smallDown:"small-down",smallLeft:"small-left",smallRight:"small-right",smallUp:"small-up",sortAscending:"asc",sortDescending:"desc",sortUnSort:"none"};function Fn(e,t,o){var n=Gn(e,t,o);if(n){var r=n.className;if("string"===typeof r&&r.indexOf("ag-icon")>-1||"object"===typeof r&&r["ag-icon"])return n}var i=document.createElement("span");return i.appendChild(n),i}function Gn(e,t,o,n){var r=null,i=o&&o.getColDef().icons;if(i&&(r=i[e]),t&&!r){var a=t.get("icons");a&&(r=a[e])}if(!r){var s=document.createElement("span"),l=Ln[e];return l||(n?l=e:(console.warn("AG Grid: Did not find icon "+e),l="")),s.setAttribute("class","ag-icon ag-icon-"+l),s.setAttribute("unselectable","on"),$t(s,"presentation"),s}var c=void 0;if("function"===typeof r)c=r();else{if("string"!==typeof r)throw new Error("icon from grid options needs to be a string or a function");c=r}return"string"===typeof c?vn(c):Tn(c)?c:void console.warn("AG Grid: iconRenderer should return back a string or a dom object")}var zn=Object.freeze({__proto__:null,iconNameClassMap:Ln,createIcon:Fn,createIconNoSpan:Gn}),Hn=function(){function e(){}return e.BACKSPACE="Backspace",e.TAB="Tab",e.ENTER="Enter",e.ESCAPE="Escape",e.SPACE=" ",e.LEFT="ArrowLeft",e.UP="ArrowUp",e.RIGHT="ArrowRight",e.DOWN="ArrowDown",e.DELETE="Delete",e.F2="F2",e.PAGE_UP="PageUp",e.PAGE_DOWN="PageDown",e.PAGE_HOME="Home",e.PAGE_END="End",e.A="KeyA",e.C="KeyC",e.D="KeyD",e.V="KeyV",e.X="KeyX",e.Y="KeyY",e.Z="KeyZ",e}();function Bn(e){return!(e.altKey||e.ctrlKey||e.metaKey)&&1===e.key.length}function Vn(e,t,o,n,r){var i=n?n.getColDef().suppressKeyboardEvent:void 0;if(!i)return!1;var a={event:t,editing:r,column:n,api:e.api,node:o,data:o.data,colDef:n.getColDef(),context:e.context,columnApi:e.columnApi};if(i&&i(a))return!0;return!1}function $n(e,t,o,n){var i=n.getDefinition(),a=i&&i.suppressHeaderKeyboardEvent;return!!r(a)&&!!a({api:e.api,columnApi:e.columnApi,context:e.context,colDef:i,column:n,headerRowIndex:o,event:t})}function Un(e){var t;switch(e.keyCode){case 65:t=Hn.A;break;case 67:t=Hn.C;break;case 86:t=Hn.V;break;case 68:t=Hn.D;break;case 90:t=Hn.Z;break;case 89:t=Hn.Y;break;default:t=e.code}return t}function Wn(e,t){return void 0===t&&(t=!1),e===Hn.DELETE||!t&&e===Hn.BACKSPACE&&Ro()}var qn=Object.freeze({__proto__:null,isEventFromPrintableCharacter:Bn,isUserSuppressingKeyboardEvent:Vn,isUserSuppressingHeaderKeyboardEvent:$n,normaliseQwertyAzerty:Un,isDeleteKey:Wn});function Kn(e,t,o){if(0===o)return!1;var n=Math.abs(e.clientX-t.clientX),r=Math.abs(e.clientY-t.clientY);return Math.max(n,r)<=o}var Yn=Object.freeze({__proto__:null,areEventsNear:Kn});var Jn=Object.freeze({__proto__:null,sortRowNodesByOrder:function(e,t){if(!e)return!1;for(var o=function(e,o){var n=t[e.id],r=t[o.id],i=void 0!==n,a=void 0!==r;return i&&a?n-r:!i&&!a?e.__objectId-o.__objectId:i?1:-1},n=!1,r=0;r<e.length-1;r++)if(o(e[r],e[r+1])>0){n=!0;break}return!!n&&(e.sort(o),!0)},traverseNodesWithKey:function(e,t){var o=[];!function e(n){if(!n)return;n.forEach((function(n){if(n.group||n.hasChildren()){o.push(n.key);var r=o.join("|");t(n,r),e(n.childrenAfterGroup),o.pop()}}))}(e)}});function Xn(e){var t=new Set;return e.forEach((function(e){return t.add(e)})),t}var Qn,Zn=Object.freeze({__proto__:null,convertToSet:Xn}),er=function(){return er=Object.assign||function(e){for(var t,o=1,n=arguments.length;o<n;o++)for(var r in t=arguments[o])Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e},er.apply(this,arguments)},tr=er(er(er(er(er(er(er(er(er(er(er(er(er(er(er(er(er(er({},So),Se),Go),Jo),Mn),Me),G),tt),u),zn),qn),Ct),Yn),Vo),E),Jn),Zn),xt),or=function(){function e(e,t){void 0===e&&(e=0),void 0===t&&(t=1),this.nextValue=e,this.step=t}return e.prototype.next=function(){var e=this.nextValue;return this.nextValue+=this.step,e},e.prototype.peek=function(){return this.nextValue},e.prototype.skip=function(e){this.nextValue+=e},e}();!function(e){e[e.IN_PROGRESS=0]="IN_PROGRESS",e[e.RESOLVED=1]="RESOLVED"}(Qn||(Qn={}));var nr,rr=function(){function e(e){var t=this;this.status=Qn.IN_PROGRESS,this.resolution=null,this.waiters=[],e((function(e){return t.onDone(e)}),(function(e){return t.onReject(e)}))}return e.all=function(t){return new e((function(e){var o=t.length,n=new Array(o);t.forEach((function(t,r){t.then((function(t){n[r]=t,0===--o&&e(n)}))}))}))},e.resolve=function(t){return void 0===t&&(t=null),new e((function(e){return e(t)}))},e.prototype.then=function(t){var o=this;return new e((function(e){o.status===Qn.RESOLVED?e(t(o.resolution)):o.waiters.push((function(o){return e(t(o))}))}))},e.prototype.resolveNow=function(e,t){return this.status===Qn.RESOLVED?t(this.resolution):e},e.prototype.onDone=function(e){this.status=Qn.RESOLVED,this.resolution=e,this.waiters.forEach((function(t){return t(e)}))},e.prototype.onReject=function(e){console.warn("TBI")},e}(),ir=function(){function e(){this.timestamp=(new Date).getTime()}return e.prototype.print=function(e){var t=(new Date).getTime()-this.timestamp;console.info(e+" = "+t),this.timestamp=(new Date).getTime()},e}(),ar=function(){var e=function(t,o){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])},e(t,o)};return function(t,o){function n(){this.constructor=t}e(t,o),t.prototype=null===o?Object.create(o):(n.prototype=o.prototype,new n)}}(),sr=function(){return sr=Object.assign||function(e){for(var t,o=1,n=arguments.length;o<n;o++)for(var r in t=arguments[o])Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e},sr.apply(this,arguments)},lr=function(e,t,o,n){var r,i=arguments.length,a=i<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,o):n;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)a=Reflect.decorate(e,t,o,n);else for(var s=e.length-1;s>=0;s--)(r=e[s])&&(a=(i<3?r(a):i>3?r(t,o,a):r(t,o))||a);return i>3&&a&&Object.defineProperty(t,o,a),a};!function(e){e[e.NOTHING=0]="NOTHING",e[e.WAITING_TO_SHOW=1]="WAITING_TO_SHOW",e[e.SHOWING=2]="SHOWING"}(nr||(nr={}));var cr=function(e){function t(t){var o=e.call(this)||this;return o.DEFAULT_SHOW_TOOLTIP_DELAY=2e3,o.DEFAULT_HIDE_TOOLTIP_DELAY=1e4,o.SHOW_QUICK_TOOLTIP_DIFF=1e3,o.FADE_OUT_TOOLTIP_TIMEOUT=1e3,o.state=nr.NOTHING,o.tooltipInstanceCount=0,o.tooltipMouseTrack=!1,o.parentComp=t,o}return ar(t,e),t.prototype.postConstruct=function(){this.tooltipShowDelay=this.getTooltipDelay("show")||this.DEFAULT_SHOW_TOOLTIP_DELAY,this.tooltipHideDelay=this.getTooltipDelay("hide")||this.DEFAULT_HIDE_TOOLTIP_DELAY,this.tooltipMouseTrack=this.gridOptionsService.is("tooltipMouseTrack");var e=this.parentComp.getGui();this.addManagedListener(e,"mouseenter",this.onMouseEnter.bind(this)),this.addManagedListener(e,"mouseleave",this.onMouseLeave.bind(this)),this.addManagedListener(e,"mousemove",this.onMouseMove.bind(this)),this.addManagedListener(e,"mousedown",this.onMouseDown.bind(this)),this.addManagedListener(e,"keydown",this.onKeyDown.bind(this))},t.prototype.destroy=function(){this.setToDoNothing(),e.prototype.destroy.call(this)},t.prototype.onMouseEnter=function(e){if(!Oo()&&this.state==nr.NOTHING){var t=this.isLastTooltipHiddenRecently()?200:this.tooltipShowDelay;this.showTooltipTimeoutId=window.setTimeout(this.showTooltip.bind(this),t),this.lastMouseEvent=e,this.state=nr.WAITING_TO_SHOW}},t.prototype.onMouseLeave=function(){this.setToDoNothing()},t.prototype.onKeyDown=function(){this.setToDoNothing()},t.prototype.setToDoNothing=function(){this.state===nr.SHOWING&&this.hideTooltip(),this.clearTimeouts(),this.state=nr.NOTHING},t.prototype.onMouseMove=function(e){this.lastMouseEvent=e,this.tooltipMouseTrack&&this.state===nr.SHOWING&&this.tooltipComp&&this.positionTooltipUnderLastMouseEvent()},t.prototype.onMouseDown=function(){this.setToDoNothing()},t.prototype.getTooltipDelay=function(e){var t=this.gridOptionsService.getNum("tooltipShowDelay"),o=this.gridOptionsService.getNum("tooltipHideDelay"),n="show"===e?t:o,i=yt(e);return r(n)?(n<0&&j((function(){return console.warn("AG Grid: tooltip"+i+"Delay should not be lower than 0")}),"tooltip"+i+"DelayWarn"),Math.max(200,n)):null},t.prototype.hideTooltip=function(){this.tooltipComp&&(this.destroyTooltipComp(),t.lastTooltipHideTime=(new Date).getTime()),this.state=nr.NOTHING},t.prototype.destroyTooltipComp=function(){var e=this;this.tooltipComp.getGui().classList.add("ag-tooltip-hiding");var t=this.tooltipPopupDestroyFunc,o=this.tooltipComp;window.setTimeout((function(){t(),e.getContext().destroyBean(o)}),this.FADE_OUT_TOOLTIP_TIMEOUT),this.tooltipPopupDestroyFunc=void 0,this.tooltipComp=void 0},t.prototype.isLastTooltipHiddenRecently=function(){return(new Date).getTime()-t.lastTooltipHideTime<this.SHOW_QUICK_TOOLTIP_DIFF},t.prototype.showTooltip=function(){var e=sr({},this.parentComp.getTooltipParams());if(r(e.value)){this.state=nr.SHOWING,this.tooltipInstanceCount++;var t=this.newTooltipComponentCallback.bind(this,this.tooltipInstanceCount);this.userComponentFactory.getTooltipCompDetails(e).newAgStackInstance().then(t)}else this.setToDoNothing()},t.prototype.newTooltipComponentCallback=function(e,t){if(this.state!==nr.SHOWING||this.tooltipInstanceCount!==e)this.getContext().destroyBean(t);else{var o=t.getGui();this.tooltipComp=t,o.classList.contains("ag-tooltip")||o.classList.add("ag-tooltip-custom");var n=this.localeService.getLocaleTextFunc(),r=this.popupService.addPopup({eChild:o,ariaLabel:n("ariaLabelTooltip","Tooltip")});r&&(this.tooltipPopupDestroyFunc=r.hideFunc),this.positionTooltipUnderLastMouseEvent(),this.hideTooltipTimeoutId=window.setTimeout(this.hideTooltip.bind(this),this.tooltipHideDelay)}},t.prototype.positionTooltipUnderLastMouseEvent=function(){this.popupService.positionPopupUnderMouseEvent({type:"tooltip",mouseEvent:this.lastMouseEvent,ePopup:this.tooltipComp.getGui(),nudgeY:18,skipObserver:this.tooltipMouseTrack})},t.prototype.clearTimeouts=function(){this.showTooltipTimeoutId&&(window.clearTimeout(this.showTooltipTimeoutId),this.showTooltipTimeoutId=void 0),this.hideTooltipTimeoutId&&(window.clearTimeout(this.hideTooltipTimeoutId),this.hideTooltipTimeoutId=void 0)},lr([q("popupService")],t.prototype,"popupService",void 0),lr([q("userComponentFactory")],t.prototype,"userComponentFactory",void 0),lr([$],t.prototype,"postConstruct",null),t}(Fe),dr=function(){function e(e){this.cssClassStates={},this.getGui=e}return e.prototype.addCssClass=function(e){var t=this,o=(e||"").split(" ");if(o.length>1)o.forEach((function(e){return t.addCssClass(e)}));else if(!0!==this.cssClassStates[e]&&e.length){var n=this.getGui();n&&n.classList.add(e),this.cssClassStates[e]=!0}},e.prototype.removeCssClass=function(e){var t=this,o=(e||"").split(" ");if(o.length>1)o.forEach((function(e){return t.removeCssClass(e)}));else if(!1!==this.cssClassStates[e]&&e.length){var n=this.getGui();n&&n.classList.remove(e),this.cssClassStates[e]=!1}},e.prototype.containsCssClass=function(e){var t=this.getGui();return!!t&&t.classList.contains(e)},e.prototype.addOrRemoveCssClass=function(e,t){var o=this;if(e){if(e.indexOf(" ")>=0){var n=(e||"").split(" ");if(n.length>1)return void n.forEach((function(e){return o.addOrRemoveCssClass(e,t)}))}if(this.cssClassStates[e]!==t&&e.length){var r=this.getGui();r&&r.classList.toggle(e,t),this.cssClassStates[e]=t}}},e}(),ur=function(){var e=function(t,o){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])},e(t,o)};return function(t,o){function n(){this.constructor=t}e(t,o),t.prototype=null===o?Object.create(o):(n.prototype=o.prototype,new n)}}(),pr=function(e,t,o,n){var r,i=arguments.length,a=i<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,o):n;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)a=Reflect.decorate(e,t,o,n);else for(var s=e.length-1;s>=0;s--)(r=e[s])&&(a=(i<3?r(a):i>3?r(t,o,a):r(t,o))||a);return i>3&&a&&Object.defineProperty(t,o,a),a},hr=new or,fr=function(e){function t(t){var o=e.call(this)||this;return o.displayed=!0,o.visible=!0,o.compId=hr.next(),o.cssClassManager=new dr((function(){return o.eGui})),t&&o.setTemplate(t),o}return ur(t,e),t.prototype.preConstructOnComponent=function(){this.usingBrowserTooltips=this.gridOptionsService.is("enableBrowserTooltips")},t.prototype.getCompId=function(){return this.compId},t.prototype.getTooltipParams=function(){return{value:this.tooltipText,location:"UNKNOWN"}},t.prototype.setTooltip=function(e){var t=this;this.tooltipText!=e&&(this.tooltipText&&(t.usingBrowserTooltips?t.getGui().removeAttribute("title"):t.tooltipFeature=t.destroyBean(t.tooltipFeature)),null!=e&&(this.tooltipText=e,this.tooltipText&&(t.usingBrowserTooltips?t.getGui().setAttribute("title",t.tooltipText):t.tooltipFeature=t.createBean(new cr(t)))))},t.prototype.createChildComponentsFromTags=function(e,t){var o=this;Dn(e.childNodes).forEach((function(n){if(n instanceof HTMLElement){var r=o.createComponentFromElement(n,(function(e){e.getGui()&&o.copyAttributesFromNode(n,e.getGui())}),t);if(r){if(r.addItems&&n.children.length){o.createChildComponentsFromTags(n,t);var i=Array.prototype.slice.call(n.children);r.addItems(i)}o.swapComponentForNode(r,e,n)}else n.childNodes&&o.createChildComponentsFromTags(n,t)}}))},t.prototype.createComponentFromElement=function(e,o,n){var r=e.nodeName,i=n?n[e.getAttribute("ref")]:void 0,a=this.agStackComponentsRegistry.getComponentClass(r);if(a){t.elementGettingCreated=e;var s=new a(i);return s.setParentComponent(this),this.createBean(s,null,o),s}return null},t.prototype.copyAttributesFromNode=function(e,t){Pn(e.attributes,(function(e,o){return t.setAttribute(e,o)}))},t.prototype.swapComponentForNode=function(e,t,o){var n=e.getGui();t.replaceChild(n,o),t.insertBefore(document.createComment(o.nodeName),n),this.addDestroyFunc(this.destroyBean.bind(this,e)),this.swapInComponentForQuerySelectors(e,o)},t.prototype.swapInComponentForQuerySelectors=function(e,t){var o=this;this.iterateOverQuerySelectors((function(n){o[n.attributeName]===t&&(o[n.attributeName]=e)}))},t.prototype.iterateOverQuerySelectors=function(e){for(var t=Object.getPrototypeOf(this);null!=t;){var o=t.__agComponentMetaData,n=A(t.constructor);o&&o[n]&&o[n].querySelectors&&o[n].querySelectors.forEach((function(t){return e(t)})),t=Object.getPrototypeOf(t)}},t.prototype.setTemplate=function(e,t){var o=vn(e);this.setTemplateFromElement(o,t)},t.prototype.setTemplateFromElement=function(e,t){this.eGui=e,this.eGui.__agComponent=this,this.wireQuerySelectors(),this.getContext()&&this.createChildComponentsFromTags(this.getGui(),t)},t.prototype.createChildComponentsPreConstruct=function(){this.getGui()&&this.createChildComponentsFromTags(this.getGui())},t.prototype.wireQuerySelectors=function(){var e=this;if(this.eGui){var t=this;this.iterateOverQuerySelectors((function(o){var n=function(e){return t[o.attributeName]=e};if(o.refSelector&&e.eGui.getAttribute("ref")===o.refSelector)n(e.eGui);else{var r=e.eGui.querySelector(o.querySelector);r&&n(r.__agComponent||r)}}))}},t.prototype.getGui=function(){return this.eGui},t.prototype.getFocusableElement=function(){return this.eGui},t.prototype.setParentComponent=function(e){this.parentComponent=e},t.prototype.getParentComponent=function(){return this.parentComponent},t.prototype.setGui=function(e){this.eGui=e},t.prototype.queryForHtmlElement=function(e){return this.eGui.querySelector(e)},t.prototype.queryForHtmlInputElement=function(e){return this.eGui.querySelector(e)},t.prototype.appendChild=function(e,t){if(null!=e)if(t||(t=this.eGui),Tn(e))t.appendChild(e);else{var o=e;t.appendChild(o.getGui())}},t.prototype.isDisplayed=function(){return this.displayed},t.prototype.setVisible=function(e,t){if(void 0===t&&(t={}),e!==this.visible){this.visible=e;var o=t.skipAriaHidden;nn(this.eGui,e,{skipAriaHidden:o})}},t.prototype.setDisplayed=function(e,o){if(void 0===o&&(o={}),e!==this.displayed){this.displayed=e;var n=o.skipAriaHidden;on(this.eGui,e,{skipAriaHidden:n});var r={type:t.EVENT_DISPLAYED_CHANGED,visible:this.displayed};this.dispatchEvent(r)}},t.prototype.destroy=function(){this.tooltipFeature&&(this.tooltipFeature=this.destroyBean(this.tooltipFeature)),this.parentComponent&&(this.parentComponent=void 0);var t=this.eGui;t&&t.__agComponent&&(t.__agComponent=void 0),e.prototype.destroy.call(this)},t.prototype.addGuiEventListener=function(e,t,o){var n=this;this.eGui.addEventListener(e,t,o),this.addDestroyFunc((function(){return n.eGui.removeEventListener(e,t)}))},t.prototype.addCssClass=function(e){this.cssClassManager.addCssClass(e)},t.prototype.removeCssClass=function(e){this.cssClassManager.removeCssClass(e)},t.prototype.containsCssClass=function(e){return this.cssClassManager.containsCssClass(e)},t.prototype.addOrRemoveCssClass=function(e,t){this.cssClassManager.addOrRemoveCssClass(e,t)},t.prototype.getAttribute=function(e){var t=this.eGui;return t?t.getAttribute(e):null},t.prototype.getRefElement=function(e){return this.queryForHtmlElement('[ref="'+e+'"]')},t.EVENT_DISPLAYED_CHANGED="displayedChanged",pr([q("agStackComponentsRegistry")],t.prototype,"agStackComponentsRegistry",void 0),pr([V],t.prototype,"preConstructOnComponent",null),pr([V],t.prototype,"createChildComponentsPreConstruct",null),t}(Fe);function gr(e){return yr.bind(this,e,void 0)}function mr(e){return yr.bind(this,"[ref="+e+"]",e)}function yr(e,t,o,n,r){null!==e?"number"!==typeof r?function(e,t,o){var n=function(e,t){e.__agComponentMetaData||(e.__agComponentMetaData={});e.__agComponentMetaData[t]||(e.__agComponentMetaData[t]={});return e.__agComponentMetaData[t]}(e,A(e.constructor));n[t]||(n[t]=[]);n[t].push(o)}(o,"querySelectors",{attributeName:n,querySelector:e,refSelector:t}):console.error("AG Grid: QuerySelector should be on an attribute"):console.error("AG Grid: QuerySelector selector should not be null")}var vr=function(){var e=function(t,o){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])},e(t,o)};return function(t,o){function n(){this.constructor=t}e(t,o),t.prototype=null===o?Object.create(o):(n.prototype=o.prototype,new n)}}(),br=function(e,t,o,n){var r,i=arguments.length,a=i<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,o):n;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)a=Reflect.decorate(e,t,o,n);else for(var s=e.length-1;s>=0;s--)(r=e[s])&&(a=(i<3?r(a):i>3?r(t,o,a):r(t,o))||a);return i>3&&a&&Object.defineProperty(t,o,a),a},xr=function(e){function t(){return e.call(this,'\n            <div class="ag-floating-filter-input" role="presentation">\n                <ag-input-text-field ref="eFloatingFilterText"></ag-input-text-field>\n            </div>')||this}return vr(t,e),t.prototype.destroy=function(){e.prototype.destroy.call(this)},t.prototype.init=function(e){this.params=e;var t=this.columnModel.getDisplayNameForColumn(e.column,"header",!0),o=this.localeService.getLocaleTextFunc();this.eFloatingFilterText.setDisabled(!0).setInputAriaLabel(t+" "+o("ariaFilterInput","Filter Input"))},t.prototype.onParentModelChanged=function(e){var t=this;e?this.params.parentFilterInstance((function(o){if(o.getModelAsString){var n=o.getModelAsString(e);t.eFloatingFilterText.setValue(n)}})):this.eFloatingFilterText.setValue("")},br([mr("eFloatingFilterText")],t.prototype,"eFloatingFilterText",void 0),br([q("columnModel")],t.prototype,"columnModel",void 0),t}(fr),wr=function(){function e(e,t,o,n){var r=this;this.alive=!0,this.context=e,this.eParent=n,t.getDateCompDetails(o).newAgStackInstance().then((function(t){r.alive?(r.dateComp=t,t&&(n.appendChild(t.getGui()),t.afterGuiAttached&&t.afterGuiAttached(),r.tempValue&&t.setDate(r.tempValue),null!=r.disabled&&r.setDateCompDisabled(r.disabled))):e.destroyBean(t)}))}return e.prototype.destroy=function(){this.alive=!1,this.dateComp=this.context.destroyBean(this.dateComp)},e.prototype.getDate=function(){return this.dateComp?this.dateComp.getDate():this.tempValue},e.prototype.setDate=function(e){this.dateComp?this.dateComp.setDate(e):this.tempValue=e},e.prototype.setDisabled=function(e){this.dateComp?this.setDateCompDisabled(e):this.disabled=e},e.prototype.setDisplayed=function(e){on(this.eParent,e)},e.prototype.setInputPlaceholder=function(e){this.dateComp&&this.dateComp.setInputPlaceholder&&this.dateComp.setInputPlaceholder(e)},e.prototype.setInputAriaLabel=function(e){this.dateComp&&this.dateComp.setInputAriaLabel&&this.dateComp.setInputAriaLabel(e)},e.prototype.afterGuiAttached=function(e){this.dateComp&&"function"===typeof this.dateComp.afterGuiAttached&&this.dateComp.afterGuiAttached(e)},e.prototype.setDateCompDisabled=function(e){null!=this.dateComp&&null!=this.dateComp.setDisabled&&this.dateComp.setDisabled(e)},e}(),Cr=function(){return Cr=Object.assign||function(e){for(var t,o=1,n=arguments.length;o<n;o++)for(var r in t=arguments[o])Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e},Cr.apply(this,arguments)},_r=function(){function e(){this.customFilterOptions={}}return e.prototype.init=function(e,t){this.filterOptions=e.filterOptions||t,this.mapCustomOptions(),this.selectDefaultItem(e),this.checkForDeprecatedParams()},e.prototype.checkForDeprecatedParams=function(){this.filterOptions.some((function(e){return"string"!=typeof e&&null!=e.test}))&&console.warn("AG Grid: [IFilterOptionDef] since v26.2.0, test() has been replaced with predicate()."),this.filterOptions.some((function(e){return"string"!=typeof e&&null!=e.hideFilterInput}))&&console.warn("AG Grid: [IFilterOptionDef] since v26.2.0, useOfHideFilterInput has been replaced with numberOfInputs.")},e.prototype.getFilterOptions=function(){return this.filterOptions},e.prototype.mapCustomOptions=function(){var e=this;this.filterOptions&&this.filterOptions.forEach((function(t){if("string"!==typeof t){if([["displayKey"],["displayName"],["predicate","test"]].every((function(e){return!!e.some((function(e){return null!=t[e]}))||(console.warn("AG Grid: ignoring FilterOptionDef as it doesn't contain one of '"+e+"'"),!1)}))){var o=t.test,n=Cr({},t);null!=o&&null==t.predicate&&(n.predicate=function(e,t){return o(e[0],t)},delete n.test),n.hideFilterInput&&null==n.numberOfInputs&&(n.numberOfInputs=0,delete n.hideFilterInput),e.customFilterOptions[t.displayKey]=n}else e.filterOptions=e.filterOptions.filter((function(e){return e===t}))||[]}}))},e.prototype.selectDefaultItem=function(e){if(e.defaultOption)this.defaultOption=e.defaultOption;else if(this.filterOptions.length>=1){var t=this.filterOptions[0];"string"===typeof t?this.defaultOption=t:t.displayKey?this.defaultOption=t.displayKey:console.warn("AG Grid: invalid FilterOptionDef supplied as it doesn't contain a 'displayKey'")}else console.warn("AG Grid: no filter options for filter")},e.prototype.getDefaultOption=function(){return this.defaultOption},e.prototype.getCustomOption=function(e){return this.customFilterOptions[e]},e}(),Sr={applyFilter:"Apply",clearFilter:"Clear",resetFilter:"Reset",cancelFilter:"Cancel",textFilter:"Text Filter",numberFilter:"Number Filter",dateFilter:"Date Filter",setFilter:"Set Filter",filterOoo:"Filter...",empty:"Choose One",equals:"Equals",notEqual:"Not equal",lessThan:"Less than",greaterThan:"Greater than",inRange:"In range",inRangeStart:"From",inRangeEnd:"To",lessThanOrEqual:"Less than or equals",greaterThanOrEqual:"Greater than or equals",contains:"Contains",notContains:"Not contains",startsWith:"Starts with",endsWith:"Ends with",blank:"Blank",notBlank:"Not blank",andCondition:"AND",orCondition:"OR",dateFormatOoo:"yyyy-mm-dd"},Er=function(){var e=function(t,o){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])},e(t,o)};return function(t,o){function n(){this.constructor=t}e(t,o),t.prototype=null===o?Object.create(o):(n.prototype=o.prototype,new n)}}(),kr=function(){return kr=Object.assign||function(e){for(var t,o=1,n=arguments.length;o<n;o++)for(var r in t=arguments[o])Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e},kr.apply(this,arguments)},jr=function(e,t,o,n){var r,i=arguments.length,a=i<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,o):n;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)a=Reflect.decorate(e,t,o,n);else for(var s=e.length-1;s>=0;s--)(r=e[s])&&(a=(i<3?r(a):i>3?r(t,o,a):r(t,o))||a);return i>3&&a&&Object.defineProperty(t,o,a),a},Ar=function(e){function t(t,o){void 0===o&&(o={});var n=e.call(this)||this;return n.eFocusableElement=t,n.callbacks=o,n.callbacks=kr({shouldStopEventPropagation:function(){return!1},onTabKeyDown:function(e){if(!e.defaultPrevented){var t=n.focusService.findNextFocusableElement(n.eFocusableElement,!1,e.shiftKey);t&&(t.focus(),e.preventDefault())}}},o),n}return Er(t,e),t.prototype.postConstruct=function(){this.eFocusableElement.classList.add(t.FOCUS_MANAGED_CLASS),this.addKeyDownListeners(this.eFocusableElement),this.callbacks.onFocusIn&&this.addManagedListener(this.eFocusableElement,"focusin",this.callbacks.onFocusIn),this.callbacks.onFocusOut&&this.addManagedListener(this.eFocusableElement,"focusout",this.callbacks.onFocusOut)},t.prototype.addKeyDownListeners=function(e){var t=this;this.addManagedListener(e,"keydown",(function(e){e.defaultPrevented||Re(e)||(t.callbacks.shouldStopEventPropagation(e)?Ae(e):e.key===Hn.TAB?t.callbacks.onTabKeyDown(e):t.callbacks.handleKeyDown&&t.callbacks.handleKeyDown(e))}))},t.FOCUS_MANAGED_CLASS="ag-focus-managed",jr([q("focusService")],t.prototype,"focusService",void 0),jr([$],t.prototype,"postConstruct",null),t}(Fe),Rr=function(){var e=function(t,o){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])},e(t,o)};return function(t,o){function n(){this.constructor=t}e(t,o),t.prototype=null===o?Object.create(o):(n.prototype=o.prototype,new n)}}(),Or=function(e,t,o,n){var r,i=arguments.length,a=i<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,o):n;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)a=Reflect.decorate(e,t,o,n);else for(var s=e.length-1;s>=0;s--)(r=e[s])&&(a=(i<3?r(a):i>3?r(t,o,a):r(t,o))||a);return i>3&&a&&Object.defineProperty(t,o,a),a},Tr="ag-resizer-wrapper",Dr='<div class="'+Tr+'">\n        <div ref="eTopLeftResizer" class="ag-resizer ag-resizer-topLeft"></div>\n        <div ref="eTopResizer" class="ag-resizer ag-resizer-top"></div>\n        <div ref="eTopRightResizer" class="ag-resizer ag-resizer-topRight"></div>\n        <div ref="eRightResizer" class="ag-resizer ag-resizer-right"></div>\n        <div ref="eBottomRightResizer" class="ag-resizer ag-resizer-bottomRight"></div>\n        <div ref="eBottomResizer" class="ag-resizer ag-resizer-bottom"></div>\n        <div ref="eBottomLeftResizer" class="ag-resizer ag-resizer-bottomLeft"></div>\n        <div ref="eLeftResizer" class="ag-resizer ag-resizer-left"></div>\n    </div>',Pr=function(e){function t(t,o){var n=e.call(this)||this;return n.element=t,n.dragStartPosition={x:0,y:0},n.position={x:0,y:0},n.lastSize={width:-1,height:-1},n.positioned=!1,n.resizersAdded=!1,n.resizeListeners=[],n.boundaryEl=null,n.isResizing=!1,n.isMoving=!1,n.resizable={},n.movable=!1,n.currentResizer=null,n.config=Object.assign({},{popup:!1},o),n}return Rr(t,e),t.prototype.center=function(){var e=this.offsetParent,t=e.clientHeight,o=e.clientWidth/2-this.getWidth()/2,n=t/2-this.getHeight()/2;this.offsetElement(o,n)},t.prototype.initialisePosition=function(){if(!this.positioned){var e=this.config,t=e.centered,o=e.forcePopupParentAsOffsetParent,n=e.minWidth,r=e.width,i=e.minHeight,a=e.height,s=e.x,l=e.y;this.offsetParent||this.setOffsetParent();var c=0,d=0,u=!!this.element.offsetParent;if(u){var p=this.findBoundaryElement(),h=window.getComputedStyle(p);if(null!=h.minWidth){var f=p.offsetWidth-this.element.offsetWidth;d=parseInt(h.minWidth,10)-f}if(null!=h.minHeight){var g=p.offsetHeight-this.element.offsetHeight;c=parseInt(h.minHeight,10)-g}}if(this.minHeight=i||c,this.minWidth=n||d,r&&this.setWidth(r),a&&this.setHeight(a),r&&a||this.refreshSize(),t)this.center();else if(s||l)this.offsetElement(s,l);else if(u&&o&&this.boundaryEl){var m=parseFloat(this.boundaryEl.style.top),y=parseFloat(this.boundaryEl.style.left);this.offsetElement(isNaN(y)?0:y,isNaN(m)?0:m)}this.positioned=!!this.offsetParent}},t.prototype.isPositioned=function(){return this.positioned},t.prototype.getPosition=function(){return this.position},t.prototype.setMovable=function(e,t){if(this.config.popup&&e!==this.movable){this.movable=e;var o=this.moveElementDragListener||{eElement:t,onDragStart:this.onMoveStart.bind(this),onDragging:this.onMove.bind(this),onDragStop:this.onMoveEnd.bind(this)};e?(this.dragService.addDragSource(o),this.moveElementDragListener=o):(this.dragService.removeDragSource(o),this.moveElementDragListener=void 0)}},t.prototype.setResizable=function(e){var t=this;if(this.clearResizeListeners(),e?this.addResizers():this.removeResizers(),"boolean"===typeof e){if(!1===e)return;e={topLeft:e,top:e,topRight:e,right:e,bottomRight:e,bottom:e,bottomLeft:e,left:e}}Object.keys(e).forEach((function(o){var n=!!e[o],r=t.getResizerElement(o),i={dragStartPixels:0,eElement:r,onDragStart:function(e){return t.onResizeStart(e,o)},onDragging:t.onResize.bind(t),onDragStop:function(e){return t.onResizeEnd(e,o)}};(n||!t.isAlive()&&!n)&&(n?(t.dragService.addDragSource(i),t.resizeListeners.push(i),r.style.pointerEvents="all"):r.style.pointerEvents="none",t.resizable[o]=n)}))},t.prototype.removeSizeFromEl=function(){this.element.style.removeProperty("height"),this.element.style.removeProperty("width"),this.element.style.removeProperty("flex")},t.prototype.restoreLastSize=function(){this.element.style.flex="0 0 auto";var e=this.lastSize,t=e.height,o=e.width;-1!==o&&(this.element.style.width=o+"px"),-1!==t&&(this.element.style.height=t+"px")},t.prototype.getHeight=function(){return this.element.offsetHeight},t.prototype.setHeight=function(e){var t=this.config.popup,o=this.element,n=!1;if("string"===typeof e&&-1!==e.indexOf("%"))Rn(o,e),e=dn(o),n=!0;else if(this.positioned){e=Math.max(this.minHeight,e);var r=this.getAvailableHeight();r&&e>r&&(e=r)}this.getHeight()!==e&&(n?(o.style.maxHeight="unset",o.style.minHeight="unset"):t?Rn(o,e):(o.style.height=e+"px",o.style.flex="0 0 auto",this.lastSize.height="number"===typeof e?e:parseFloat(e)))},t.prototype.getAvailableHeight=function(){var e=this.config,t=e.popup,o=e.forcePopupParentAsOffsetParent;this.positioned||this.initialisePosition();var n=this.offsetParent.clientHeight;if(!n)return null;var r=this.element.getBoundingClientRect(),i=this.offsetParent.getBoundingClientRect(),a=t?this.position.y:r.top,s=t?0:i.top,l=0;if(o){var c=this.element.parentElement;if(c)l=c.getBoundingClientRect().bottom-r.bottom}return n+s-a-l},t.prototype.getWidth=function(){return this.element.offsetWidth},t.prototype.setWidth=function(e){var t=this.element,o=this.config.popup,n=!1;if("string"===typeof e&&-1!==e.indexOf("%"))An(t,e),e=un(t),n=!0;else if(this.positioned){e=Math.max(this.minWidth,e);var r=this.offsetParent.clientWidth,i=o?this.position.x:this.element.getBoundingClientRect().left;r&&e+i>r&&(e=r-i)}this.getWidth()!==e&&(n?(t.style.maxWidth="unset",t.style.minWidth="unset"):this.config.popup?An(t,e):(t.style.width=e+"px",t.style.flex=" unset",this.lastSize.width="number"===typeof e?e:parseFloat(e)))},t.prototype.offsetElement=function(e,t){void 0===e&&(e=0),void 0===t&&(t=0);var o=this.config.forcePopupParentAsOffsetParent?this.boundaryEl:this.element;this.popupService.positionPopup({ePopup:o,keepWithinBounds:!0,skipObserver:this.movable||this.isResizable(),updatePosition:function(){return{x:e,y:t}}}),this.setPosition(parseFloat(o.style.left),parseFloat(o.style.top))},t.prototype.constrainSizeToAvailableHeight=function(e){var t=this;if(this.config.forcePopupParentAsOffsetParent){e?this.resizeObserverSubscriber=this.resizeObserverService.observeResize(this.popupService.getPopupParent(),(function(){var e=t.getAvailableHeight();t.element.style.setProperty("max-height",e+"px")})):(this.element.style.removeProperty("max-height"),this.resizeObserverSubscriber&&(this.resizeObserverSubscriber(),this.resizeObserverSubscriber=void 0))}},t.prototype.setPosition=function(e,t){this.position.x=e,this.position.y=t},t.prototype.updateDragStartPosition=function(e,t){this.dragStartPosition={x:e,y:t}},t.prototype.calculateMouseMovement=function(e){var t=e.e,o=e.isLeft,n=e.isTop,r=e.anywhereWithin,i=e.topBuffer,a=t.clientX-this.dragStartPosition.x,s=t.clientY-this.dragStartPosition.y;return{movementX:this.shouldSkipX(t,!!o,!!r,a)?0:a,movementY:this.shouldSkipY(t,!!n,i,s)?0:s}},t.prototype.shouldSkipX=function(e,t,o,n){var r=this.element.getBoundingClientRect(),i=this.offsetParent.getBoundingClientRect(),a=this.boundaryEl.getBoundingClientRect(),s=this.config.popup?this.position.x:r.left,l=s<=0&&i.left>=e.clientX||i.right<=e.clientX&&i.right<=a.right;return!!l||(l=t?n<0&&e.clientX>s+i.left||n>0&&e.clientX<s+i.left:o?n<0&&e.clientX>a.right||n>0&&e.clientX<s+i.left:n<0&&e.clientX>a.right||n>0&&e.clientX<a.right)},t.prototype.shouldSkipY=function(e,t,o,n){void 0===o&&(o=0);var r=this.element.getBoundingClientRect(),i=this.offsetParent.getBoundingClientRect(),a=this.boundaryEl.getBoundingClientRect(),s=this.config.popup?this.position.y:r.top,l=s<=0&&i.top>=e.clientY||i.bottom<=e.clientY&&i.bottom<=a.bottom;return!!l||(l=t?n<0&&e.clientY>s+i.top+o||n>0&&e.clientY<s+i.top:n<0&&e.clientY>a.bottom||n>0&&e.clientY<a.bottom)},t.prototype.createResizeMap=function(){var e=this.element;this.resizerMap={topLeft:{element:e.querySelector("[ref=eTopLeftResizer]")},top:{element:e.querySelector("[ref=eTopResizer]")},topRight:{element:e.querySelector("[ref=eTopRightResizer]")},right:{element:e.querySelector("[ref=eRightResizer]")},bottomRight:{element:e.querySelector("[ref=eBottomRightResizer]")},bottom:{element:e.querySelector("[ref=eBottomResizer]")},bottomLeft:{element:e.querySelector("[ref=eBottomLeftResizer]")},left:{element:e.querySelector("[ref=eLeftResizer]")}}},t.prototype.addResizers=function(){if(!this.resizersAdded){var e=this.element;if(e){var t=(new DOMParser).parseFromString(Dr,"text/html").body;e.appendChild(t.firstChild),this.createResizeMap(),this.resizersAdded=!0}}},t.prototype.removeResizers=function(){this.resizerMap=void 0;var e=this.element.querySelector("."+Tr);e&&this.element.removeChild(e),this.resizersAdded=!1},t.prototype.getResizerElement=function(e){return this.resizerMap[e].element},t.prototype.onResizeStart=function(e,t){this.boundaryEl=this.findBoundaryElement(),this.positioned||this.initialisePosition(),this.currentResizer={isTop:!!t.match(/top/i),isRight:!!t.match(/right/i),isBottom:!!t.match(/bottom/i),isLeft:!!t.match(/left/i)},this.element.classList.add("ag-resizing"),this.resizerMap[t].element.classList.add("ag-active");var o=this.config,n=o.popup,r=o.forcePopupParentAsOffsetParent;n||r||this.applySizeToSiblings(this.currentResizer.isBottom||this.currentResizer.isTop),this.isResizing=!0,this.updateDragStartPosition(e.clientX,e.clientY)},t.prototype.getSiblings=function(){var e=this.element.parentElement;return e?Array.prototype.slice.call(e.children).filter((function(e){return!e.classList.contains("ag-hidden")})):null},t.prototype.getMinSizeOfSiblings=function(){for(var e=this.getSiblings()||[],t=0,o=0,n=0;n<e.length;n++){var r=e[n],i=!!r.style.flex&&"0 0 auto"!==r.style.flex;if(r!==this.element){var a=this.minHeight||0,s=this.minWidth||0;if(i){var l=window.getComputedStyle(r);l.minHeight&&(a=parseInt(l.minHeight,10)),l.minWidth&&(s=parseInt(l.minWidth,10))}else a=r.offsetHeight,s=r.offsetWidth;t+=a,o+=s}}return{height:t,width:o}},t.prototype.applySizeToSiblings=function(e){var t=null,o=this.getSiblings();if(o){for(var n=0;n<o.length;n++){var r=o[n];r!==t&&(e?r.style.height=r.offsetHeight+"px":r.style.width=r.offsetWidth+"px",r.style.flex="0 0 auto",r===this.element&&(t=o[n+1]))}t&&(t.style.removeProperty("height"),t.style.removeProperty("min-height"),t.style.removeProperty("max-height"),t.style.flex="1 1 auto")}},t.prototype.isResizable=function(){return Object.values(this.resizable).some((function(e){return e}))},t.prototype.onResize=function(e){if(this.isResizing&&this.currentResizer){var t=this.config,o=t.popup,n=t.forcePopupParentAsOffsetParent,r=this.currentResizer,i=r.isTop,a=r.isRight,s=r.isBottom,l=r.isLeft,c=a||l,d=s||i,u=this.calculateMouseMovement({e:e,isLeft:l,isTop:i}),p=u.movementX,h=u.movementY,f=this.position.x,g=this.position.y,m=0,y=0;if(c&&p){var v=l?-1:1,b=this.getWidth(),x=b+p*v,w=!1;l&&(f+(m=b-x)<=0||x<=this.minWidth)&&(w=!0,m=0),w||this.setWidth(x)}if(d&&h){v=i?-1:1;var C=this.getHeight(),_=C+h*v,S=!1;i?(g+(y=C-_)<=0||_<=this.minHeight)&&(S=!0,y=0):!this.config.popup&&!this.config.forcePopupParentAsOffsetParent&&C<_&&this.getMinSizeOfSiblings().height+_>this.element.parentElement.offsetHeight&&(S=!0),S||this.setHeight(_)}this.updateDragStartPosition(e.clientX,e.clientY),((o||n)&&m||y)&&this.offsetElement(f+m,g+y)}},t.prototype.onResizeEnd=function(e,t){this.isResizing=!1,this.currentResizer=null,this.boundaryEl=null;var o={type:"resize",api:this.gridOptionsService.api,columnApi:this.gridOptionsService.columnApi};this.element.classList.remove("ag-resizing"),this.resizerMap[t].element.classList.remove("ag-active"),this.dispatchEvent(o)},t.prototype.refreshSize=function(){var e=this.element;this.config.popup&&(this.config.width||this.setWidth(e.offsetWidth),this.config.height||this.setHeight(e.offsetHeight))},t.prototype.onMoveStart=function(e){this.boundaryEl=this.findBoundaryElement(),this.positioned||this.initialisePosition(),this.isMoving=!0,this.element.classList.add("ag-moving"),this.updateDragStartPosition(e.clientX,e.clientY)},t.prototype.onMove=function(e){if(this.isMoving){var t,o=this.position,n=o.x,r=o.y;this.config.calculateTopBuffer&&(t=this.config.calculateTopBuffer());var i=this.calculateMouseMovement({e:e,isTop:!0,anywhereWithin:!0,topBuffer:t}),a=i.movementX,s=i.movementY;this.offsetElement(n+a,r+s),this.updateDragStartPosition(e.clientX,e.clientY)}},t.prototype.onMoveEnd=function(){this.isMoving=!1,this.boundaryEl=null,this.element.classList.remove("ag-moving")},t.prototype.setOffsetParent=function(){this.config.forcePopupParentAsOffsetParent?this.offsetParent=this.popupService.getPopupParent():this.offsetParent=this.element.offsetParent},t.prototype.findBoundaryElement=function(){for(var e=this.element;e;){if("static"!==window.getComputedStyle(e).position)return e;e=e.parentElement}return this.element},t.prototype.clearResizeListeners=function(){for(;this.resizeListeners.length;){var e=this.resizeListeners.pop();this.dragService.removeDragSource(e)}},t.prototype.destroy=function(){e.prototype.destroy.call(this),this.moveElementDragListener&&this.dragService.removeDragSource(this.moveElementDragListener),this.constrainSizeToAvailableHeight(!1),this.clearResizeListeners(),this.removeResizers()},Or([q("popupService")],t.prototype,"popupService",void 0),Or([q("resizeObserverService")],t.prototype,"resizeObserverService",void 0),Or([q("dragService")],t.prototype,"dragService",void 0),t}(Fe),Nr=function(){var e=function(t,o){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])},e(t,o)};return function(t,o){function n(){this.constructor=t}e(t,o),t.prototype=null===o?Object.create(o):(n.prototype=o.prototype,new n)}}(),Ir=function(e,t,o,n){var r,i=arguments.length,a=i<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,o):n;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)a=Reflect.decorate(e,t,o,n);else for(var s=e.length-1;s>=0;s--)(r=e[s])&&(a=(i<3?r(a):i>3?r(t,o,a):r(t,o))||a);return i>3&&a&&Object.defineProperty(t,o,a),a},Mr=function(e){function t(t){var o=e.call(this)||this;return o.filterNameKey=t,o.applyActive=!1,o.hidePopup=null,o.debouncePending=!1,o.appliedModel=null,o}return Nr(t,e),t.prototype.postConstruct=function(){this.resetTemplate(),this.createManagedBean(new Ar(this.getFocusableElement(),{handleKeyDown:this.handleKeyDown.bind(this)})),this.positionableFeature=new Pr(this.getPositionableElement(),{forcePopupParentAsOffsetParent:!0}),this.createBean(this.positionableFeature)},t.prototype.handleKeyDown=function(e){},t.prototype.getFilterTitle=function(){return this.translate(this.filterNameKey)},t.prototype.isFilterActive=function(){return!!this.appliedModel},t.prototype.resetTemplate=function(e){var t=this.getGui();t&&t.removeEventListener("submit",this.onFormSubmit);var o='\n            <form class="ag-filter-wrapper">\n                <div class="ag-filter-body-wrapper ag-'+this.getCssIdentifier()+'-body-wrapper" ref="eFilterBody">\n                    '+this.createBodyTemplate()+"\n                </div>\n            </form>";this.setTemplate(o,e),(t=this.getGui())&&t.addEventListener("submit",this.onFormSubmit)},t.prototype.isReadOnly=function(){return!!this.providedFilterParams.readOnly},t.prototype.init=function(e){var t=this;this.setParams(e),this.resetUiToDefaults(!0).then((function(){t.updateUiVisibility(),t.setupOnBtApplyDebounce()}))},t.prototype.setParams=function(e){this.providedFilterParams=e,this.applyActive=t.isUseApplyButton(e),this.createButtonPanel()},t.prototype.createButtonPanel=function(){var e=this,t=this.providedFilterParams.buttons;if(!(!t||t.length<1||this.isReadOnly())){var o=document.createElement("div");o.classList.add("ag-filter-apply-panel");Xn(t).forEach((function(t){return function(t){var n,r;switch(t){case"apply":n=e.translate("applyFilter"),r=function(t){return e.onBtApply(!1,!1,t)};break;case"clear":n=e.translate("clearFilter"),r=function(){return e.onBtClear()};break;case"reset":n=e.translate("resetFilter"),r=function(){return e.onBtReset()};break;case"cancel":n=e.translate("cancelFilter"),r=function(t){e.onBtCancel(t)};break;default:return void console.warn("AG Grid: Unknown button type specified")}var i=vn('<button\n                    type="'+("apply"===t?"submit":"button")+'"\n                    ref="'+t+'FilterButton"\n                    class="ag-standard-button ag-filter-apply-panel-button"\n                >'+n+"\n                </button>");o.appendChild(i),e.addManagedListener(i,"click",r)}(t)})),this.getGui().appendChild(o)}},t.prototype.getDefaultDebounceMs=function(){return 0},t.prototype.setupOnBtApplyDebounce=function(){var e=this,o=t.getDebounceMs(this.providedFilterParams,this.getDefaultDebounceMs()),n=I(this.checkApplyDebounce.bind(this),o);this.onBtApplyDebounce=function(){e.debouncePending=!0,n()}},t.prototype.checkApplyDebounce=function(){this.debouncePending&&(this.debouncePending=!1,this.onBtApply())},t.prototype.getModel=function(){return this.appliedModel?this.appliedModel:null},t.prototype.setModel=function(e){var t=this;return(null!=e?this.setModelIntoUi(e):this.resetUiToDefaults()).then((function(){t.updateUiVisibility(),t.applyModel("api")}))},t.prototype.onBtCancel=function(e){var t=this;this.resetUiToActiveModel(this.getModel(),(function(){t.handleCancelEnd(e)}))},t.prototype.handleCancelEnd=function(e){this.providedFilterParams.closeOnApply&&this.close(e)},t.prototype.resetUiToActiveModel=function(e,t){var o=this,n=function(){o.onUiChanged(!1,"prevent"),null===t||void 0===t||t()};null!=e?this.setModelIntoUi(e).then(n):this.resetUiToDefaults().then(n)},t.prototype.onBtClear=function(){var e=this;this.resetUiToDefaults().then((function(){return e.onUiChanged()}))},t.prototype.onBtReset=function(){this.onBtClear(),this.onBtApply()},t.prototype.applyModel=function(e){var t=this.getModelFromUi();if(!this.isModelValid(t))return!1;var o=this.appliedModel;return this.appliedModel=t,!this.areModelsEqual(o,t)},t.prototype.isModelValid=function(e){return!0},t.prototype.onFormSubmit=function(e){e.preventDefault()},t.prototype.onBtApply=function(e,t,o){void 0===e&&(e=!1),void 0===t&&(t=!1),o&&o.preventDefault(),this.applyModel(t?"rowDataUpdated":"ui")&&this.providedFilterParams.filterChangedCallback({afterFloatingFilter:e,afterDataChange:t}),this.providedFilterParams.closeOnApply&&this.applyActive&&!e&&!t&&this.close(o)},t.prototype.onNewRowsLoaded=function(){},t.prototype.close=function(e){if(this.hidePopup){var t,o=e,n=o&&o.key;"Enter"!==n&&"Space"!==n||(t={keyboardEvent:o}),this.hidePopup(t),this.hidePopup=null}},t.prototype.onUiChanged=function(e,t){if(void 0===e&&(e=!1),this.updateUiVisibility(),this.providedFilterParams.filterModifiedCallback(),this.applyActive&&!this.isReadOnly()){var o=this.isModelValid(this.getModelFromUi());rn(this.getRefElement("applyFilterButton"),!o)}e&&!t||"immediately"===t?this.onBtApply(e):(this.applyActive||t)&&"debounce"!==t||this.onBtApplyDebounce()},t.prototype.afterGuiAttached=function(e){e&&(this.hidePopup=e.hidePopup),this.refreshFilterResizer(null===e||void 0===e?void 0:e.container)},t.prototype.refreshFilterResizer=function(e){if(this.positionableFeature&&"toolPanel"!==e){var t="floatingFilter"===e,o=this.positionableFeature,n=this.gridOptionsService;t?(o.restoreLastSize(),o.setResizable(n.is("enableRtl")?{bottom:!0,bottomLeft:!0,left:!0}:{bottom:!0,bottomRight:!0,right:!0})):(this.positionableFeature.removeSizeFromEl(),this.positionableFeature.setResizable(!1)),this.positionableFeature.constrainSizeToAvailableHeight(!0)}},t.prototype.afterGuiDetached=function(){this.checkApplyDebounce(),this.positionableFeature&&this.positionableFeature.constrainSizeToAvailableHeight(!1)},t.getDebounceMs=function(e,o){return t.isUseApplyButton(e)?(null!=e.debounceMs&&console.warn("AG Grid: debounceMs is ignored when apply button is present"),0):null!=e.debounceMs?e.debounceMs:o},t.isUseApplyButton=function(e){return!!e.buttons&&e.buttons.indexOf("apply")>=0},t.prototype.destroy=function(){var t=this.getGui();t&&t.removeEventListener("submit",this.onFormSubmit),this.hidePopup=null,this.positionableFeature&&(this.positionableFeature=this.destroyBean(this.positionableFeature)),e.prototype.destroy.call(this)},t.prototype.translate=function(e){return this.localeService.getLocaleTextFunc()(e,Sr[e])},t.prototype.getCellValue=function(e){var t=this.providedFilterParams,o=t.api,n=t.colDef,r=t.column,i=t.columnApi,a=t.context;return this.providedFilterParams.valueGetter({api:o,colDef:n,column:r,columnApi:i,context:a,data:e.data,getValue:function(t){return e.data[t]},node:e})},t.prototype.getPositionableElement=function(){return this.eFilterBody},Ir([q("rowModel")],t.prototype,"rowModel",void 0),Ir([mr("eFilterBody")],t.prototype,"eFilterBody",void 0),Ir([$],t.prototype,"postConstruct",null),t}(fr),Lr=function(){var e=function(t,o){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])},e(t,o)};return function(t,o){function n(){this.constructor=t}e(t,o),t.prototype=null===o?Object.create(o):(n.prototype=o.prototype,new n)}}(),Fr=function(e,t,o,n){var r,i=arguments.length,a=i<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,o):n;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)a=Reflect.decorate(e,t,o,n);else for(var s=e.length-1;s>=0;s--)(r=e[s])&&(a=(i<3?r(a):i>3?r(t,o,a):r(t,o))||a);return i>3&&a&&Object.defineProperty(t,o,a),a},Gr=function(e){function t(t,o){var n=e.call(this,o)||this;return n.labelSeparator="",n.labelAlignment="left",n.disabled=!1,n.label="",n.config=t||{},n}return Lr(t,e),t.prototype.postConstruct=function(){this.addCssClass("ag-labeled"),this.eLabel.classList.add("ag-label");var e=this.config,t=e.labelSeparator,o=e.label,n=e.labelWidth,r=e.labelAlignment;null!=t&&this.setLabelSeparator(t),null!=o&&this.setLabel(o),null!=n&&this.setLabelWidth(n),this.setLabelAlignment(r||this.labelAlignment),this.refreshLabel()},t.prototype.refreshLabel=function(){gn(this.eLabel),"string"===typeof this.label?this.eLabel.innerText=this.label+this.labelSeparator:this.label&&this.eLabel.appendChild(this.label),""===this.label?(on(this.eLabel,!1),$t(this.eLabel,"presentation")):(on(this.eLabel,!0),$t(this.eLabel,null))},t.prototype.setLabelSeparator=function(e){return this.labelSeparator===e||(this.labelSeparator=e,null!=this.label&&this.refreshLabel()),this},t.prototype.getLabelId=function(){return this.eLabel.id=this.eLabel.id||"ag-"+this.getCompId()+"-label",this.eLabel.id},t.prototype.getLabel=function(){return this.label},t.prototype.setLabel=function(e){return this.label===e||(this.label=e,this.refreshLabel()),this},t.prototype.setLabelAlignment=function(e){var t=this.getGui().classList;return t.toggle("ag-label-align-left","left"===e),t.toggle("ag-label-align-right","right"===e),t.toggle("ag-label-align-top","top"===e),this},t.prototype.setLabelEllipsis=function(e){return this.eLabel.classList.toggle("ag-label-ellipsis",e),this},t.prototype.setLabelWidth=function(e){return null==this.label||jn(this.eLabel,e),this},t.prototype.setDisabled=function(e){e=!!e;var t=this.getGui();return rn(t,e),t.classList.toggle("ag-disabled",e),this.disabled=e,this},t.prototype.isDisabled=function(){return!!this.disabled},Fr([$],t.prototype,"postConstruct",null),t}(fr),zr=function(){var e=function(t,o){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])},e(t,o)};return function(t,o){function n(){this.constructor=t}e(t,o),t.prototype=null===o?Object.create(o):(n.prototype=o.prototype,new n)}}(),Hr=function(e){function t(t,o,n){var r=e.call(this,t,o)||this;return r.className=n,r}return zr(t,e),t.prototype.postConstruct=function(){e.prototype.postConstruct.call(this),this.className&&this.addCssClass(this.className)},t.prototype.onValueChange=function(e){var o=this;return this.addManagedListener(this,t.EVENT_CHANGED,(function(){return e(o.getValue())})),this},t.prototype.getWidth=function(){return this.getGui().clientWidth},t.prototype.setWidth=function(e){return An(this.getGui(),e),this},t.prototype.getPreviousValue=function(){return this.previousValue},t.prototype.getValue=function(){return this.value},t.prototype.setValue=function(e,o){return this.value===e||(this.previousValue=this.value,this.value=e,o||this.dispatchEvent({type:t.EVENT_CHANGED})),this},t.EVENT_CHANGED="valueChange",t}(Gr),Br=function(){var e=function(t,o){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])},e(t,o)};return function(t,o){function n(){this.constructor=t}e(t,o),t.prototype=null===o?Object.create(o):(n.prototype=o.prototype,new n)}}(),Vr=function(e,t,o,n){var r,i=arguments.length,a=i<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,o):n;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)a=Reflect.decorate(e,t,o,n);else for(var s=e.length-1;s>=0;s--)(r=e[s])&&(a=(i<3?r(a):i>3?r(t,o,a):r(t,o))||a);return i>3&&a&&Object.defineProperty(t,o,a),a},$r=function(e){function t(t,o,n,r){var i=e.call(this,t,'<div class="ag-picker-field" role="presentation">\n                <div ref="eLabel"></div>\n                <div ref="eWrapper"\n                    class="ag-wrapper ag-picker-field-wrapper"\n                    tabIndex="-1"\n                    aria-expanded="false"\n                    '+(r?'role="'+r+'"':"")+'\n                >\n                    <div ref="eDisplayField" class="ag-picker-field-display"></div>\n                    <div ref="eIcon" class="ag-picker-field-icon" aria-hidden="true"></div>\n                </div>\n            </div>',o)||this;return i.pickerIcon=n,i.isPickerDisplayed=!1,i.isDestroyingPicker=!1,i.skipClick=!1,i}return Br(t,e),t.prototype.postConstruct=function(){var t=this;e.prototype.postConstruct.call(this);var o=this.getCompId()+"-display";this.eDisplayField.setAttribute("id",o),Xt(this.eWrapper,o);var n=function(){t.skipClick?t.skipClick=!1:t.isDisabled()||(t.pickerComponent=t.showPicker())},r=this.getGui();if(this.addManagedListener(r,"mousedown",(function(e){!t.skipClick&&t.pickerComponent&&t.pickerComponent.isAlive()&&yn(t.pickerComponent.getGui())&&r.contains(e.target)&&(t.skipClick=!0)})),this.addManagedListener(r,"keydown",(function(e){switch(e.key){case Hn.UP:case Hn.DOWN:case Hn.ENTER:case Hn.SPACE:n();case Hn.ESCAPE:t.isPickerDisplayed&&e.preventDefault()}})),this.addManagedListener(this.eWrapper,"click",n),this.addManagedListener(this.eLabel,"click",n),this.pickerIcon){var i=Gn(this.pickerIcon,this.gridOptionsService);i&&this.eIcon.appendChild(i)}},t.prototype.refreshLabel=function(){r(this.getLabel())?Yt(this.eWrapper,this.getLabelId()):this.eWrapper.removeAttribute("aria-labelledby"),e.prototype.refreshLabel.call(this)},t.prototype.setAriaLabel=function(e){return Kt(this.eWrapper,e),this},t.prototype.setInputWidth=function(e){return jn(this.eWrapper,e),this},t.prototype.getFocusableElement=function(){return this.eWrapper},Vr([mr("eLabel")],t.prototype,"eLabel",void 0),Vr([mr("eWrapper")],t.prototype,"eWrapper",void 0),Vr([mr("eDisplayField")],t.prototype,"eDisplayField",void 0),Vr([mr("eIcon")],t.prototype,"eIcon",void 0),t}(Hr),Ur=function(){var e=function(t,o){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])},e(t,o)};return function(t,o){function n(){this.constructor=t}e(t,o),t.prototype=null===o?Object.create(o):(n.prototype=o.prototype,new n)}}(),Wr=function(e,t,o,n){var r,i=arguments.length,a=i<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,o):n;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)a=Reflect.decorate(e,t,o,n);else for(var s=e.length-1;s>=0;s--)(r=e[s])&&(a=(i<3?r(a):i>3?r(t,o,a):r(t,o))||a);return i>3&&a&&Object.defineProperty(t,o,a),a},qr=function(e){function t(t){void 0===t&&(t="default");var o=e.call(this,'<div class="ag-list ag-'+t+'-list" role="listbox"></div>')||this;return o.cssIdentifier=t,o.options=[],o.itemEls=[],o}return Ur(t,e),t.prototype.init=function(){this.addManagedListener(this.getGui(),"keydown",this.handleKeyDown.bind(this))},t.prototype.handleKeyDown=function(e){var t=e.key;switch(t){case Hn.ENTER:if(this.highlightedEl){var o=this.itemEls.indexOf(this.highlightedEl);this.setValueByIndex(o)}else this.setValue(this.getValue());break;case Hn.DOWN:case Hn.UP:var n=t===Hn.DOWN,r=void 0;if(e.preventDefault(),this.highlightedEl){var i=this.itemEls.indexOf(this.highlightedEl)+(n?1:-1);i=Math.min(Math.max(i,0),this.itemEls.length-1),r=this.itemEls[i]}else r=this.itemEls[n?0:this.itemEls.length-1];this.highlightItem(r)}},t.prototype.addOptions=function(e){var t=this;return e.forEach((function(e){return t.addOption(e)})),this},t.prototype.addOption=function(e){var t=e.value,o=vt(e.text||t);return this.options.push({value:t,text:o}),this.renderOption(t,o),this.updateIndices(),this},t.prototype.updateIndices=function(){var e=this.getGui().querySelectorAll(".ag-list-item");e.forEach((function(t,o){ro(t,o+1),no(t,e.length)}))},t.prototype.renderOption=function(e,t){var o=this,n=document.createElement("div");$t(n,"option"),n.classList.add("ag-list-item","ag-"+this.cssIdentifier+"-list-item"),n.innerHTML="<span>"+t+"</span>",n.tabIndex=-1,this.itemEls.push(n),this.addManagedListener(n,"mouseover",(function(){return o.highlightItem(n)})),this.addManagedListener(n,"mouseleave",(function(){return o.clearHighlighted()})),this.addManagedListener(n,"click",(function(){return o.setValue(e)})),this.getGui().appendChild(n)},t.prototype.setValue=function(e,t){if(this.value===e)return this.fireItemSelected(),this;if(null==e)return this.reset(),this;var o=this.options.findIndex((function(t){return t.value===e}));if(-1!==o){var n=this.options[o];this.value=n.value,this.displayValue=null!=n.text?n.text:n.value,this.highlightItem(this.itemEls[o]),t||this.fireChangeEvent()}return this},t.prototype.setValueByIndex=function(e){return this.setValue(this.options[e].value)},t.prototype.getValue=function(){return this.value},t.prototype.getDisplayValue=function(){return this.displayValue},t.prototype.refreshHighlighted=function(){var e=this;this.clearHighlighted();var t=this.options.findIndex((function(t){return t.value===e.value}));-1!==t&&this.highlightItem(this.itemEls[t])},t.prototype.reset=function(){this.value=null,this.displayValue=null,this.clearHighlighted(),this.fireChangeEvent()},t.prototype.highlightItem=function(e){e.offsetParent&&(this.clearHighlighted(),this.highlightedEl=e,this.highlightedEl.classList.add(t.ACTIVE_CLASS),fo(this.highlightedEl,!0),this.highlightedEl.focus())},t.prototype.clearHighlighted=function(){this.highlightedEl&&this.highlightedEl.offsetParent&&(this.highlightedEl.classList.remove(t.ACTIVE_CLASS),fo(this.highlightedEl,!1),this.highlightedEl=null)},t.prototype.fireChangeEvent=function(){this.dispatchEvent({type:Hr.EVENT_CHANGED}),this.fireItemSelected()},t.prototype.fireItemSelected=function(){this.dispatchEvent({type:t.EVENT_ITEM_SELECTED})},t.EVENT_ITEM_SELECTED="selectedItem",t.ACTIVE_CLASS="ag-active-item",Wr([$],t.prototype,"init",null),t}(fr),Kr=function(){var e=function(t,o){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])},e(t,o)};return function(t,o){function n(){this.constructor=t}e(t,o),t.prototype=null===o?Object.create(o):(n.prototype=o.prototype,new n)}}(),Yr=function(e,t,o,n){var r,i=arguments.length,a=i<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,o):n;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)a=Reflect.decorate(e,t,o,n);else for(var s=e.length-1;s>=0;s--)(r=e[s])&&(a=(i<3?r(a):i>3?r(t,o,a):r(t,o))||a);return i>3&&a&&Object.defineProperty(t,o,a),a},Jr=function(e){function t(t){return e.call(this,t,"ag-select","smallDown","listbox")||this}return Kr(t,e),t.prototype.init=function(){var e=this;this.listComponent=this.createBean(new qr("select")),this.listComponent.setParentComponent(this),this.eWrapper.tabIndex=0,this.listComponent.addManagedListener(this.listComponent,qr.EVENT_ITEM_SELECTED,(function(){e.hideList&&e.hideList(),e.dispatchEvent({type:t.EVENT_ITEM_SELECTED})})),this.listComponent.addManagedListener(this.listComponent,Hr.EVENT_CHANGED,(function(){e.setValue(e.listComponent.getValue(),!1,!0),e.hideList&&e.hideList()}))},t.prototype.showPicker=function(){var e=this,t=this.listComponent.getGui(),o=this.gridOptionsService.getDocument(),n=this.addManagedListener(o.body,"wheel",(function(o){!t.contains(o.target)&&e.hideList&&e.hideList()})),r=this.addManagedListener(t,"focusout",(function(o){!t.contains(o.relatedTarget)&&e.hideList&&e.hideList()})),i=this.localeService.getLocaleTextFunc(),a=this.popupService.addPopup({modal:!0,eChild:t,closeOnEsc:!0,closedCallback:function(){e.hideList=null,e.isPickerDisplayed=!1,r(),n(),e.isAlive()&&(to(e.eWrapper,!1),e.getFocusableElement().focus())},ariaLabel:i("ariaLabelSelectField","Select Field")});return a&&(this.hideList=a.hideFunc),this.isPickerDisplayed=!0,jn(t,un(this.eWrapper)),to(this.eWrapper,!0),t.style.maxHeight=ln(this.popupService.getPopupParent())+"px",t.style.position="absolute",this.popupService.positionPopupByComponent({type:"ag-list",eventSource:this.eWrapper,ePopup:t,position:"under",keepWithinBounds:!0}),this.listComponent.refreshHighlighted(),this.listComponent},t.prototype.addOptions=function(e){var t=this;return e.forEach((function(e){return t.addOption(e)})),this},t.prototype.addOption=function(e){return this.listComponent.addOption(e),this},t.prototype.setValue=function(t,o,n){return this.value===t?this:(n||this.listComponent.setValue(t,!0),this.listComponent.getValue()===this.getValue()?this:(this.eDisplayField.innerHTML=this.listComponent.getDisplayValue(),e.prototype.setValue.call(this,t,o)))},t.prototype.destroy=function(){this.hideList&&this.hideList(),this.destroyBean(this.listComponent),e.prototype.destroy.call(this)},t.EVENT_ITEM_SELECTED="selectedItem",Yr([q("popupService")],t.prototype,"popupService",void 0),Yr([$],t.prototype,"init",null),t}($r),Xr=function(){var e=function(t,o){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])},e(t,o)};return function(t,o){function n(){this.constructor=t}e(t,o),t.prototype=null===o?Object.create(o):(n.prototype=o.prototype,new n)}}(),Qr=function(e,t,o,n){var r,i=arguments.length,a=i<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,o):n;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)a=Reflect.decorate(e,t,o,n);else for(var s=e.length-1;s>=0;s--)(r=e[s])&&(a=(i<3?r(a):i>3?r(t,o,a):r(t,o))||a);return i>3&&a&&Object.defineProperty(t,o,a),a},Zr=function(e){function t(t,o,n,r){void 0===n&&(n="text"),void 0===r&&(r="input");var i=e.call(this,t,'\n            <div role="presentation">\n                <div ref="eLabel" class="ag-input-field-label"></div>\n                <div ref="eWrapper" class="ag-wrapper ag-input-wrapper" role="presentation">\n                    <'+r+' ref="eInput" class="ag-input-field-input"></'+r+">\n                </div>\n            </div>",o)||this;return i.inputType=n,i.displayFieldTag=r,i}return Xr(t,e),t.prototype.postConstruct=function(){e.prototype.postConstruct.call(this),this.setInputType(),this.eLabel.classList.add(this.className+"-label"),this.eWrapper.classList.add(this.className+"-input-wrapper"),this.eInput.classList.add(this.className+"-input"),this.addCssClass("ag-input-field"),this.eInput.id=this.eInput.id||"ag-"+this.getCompId()+"-input";var t=this.config,o=t.width,n=t.value;null!=o&&this.setWidth(o),null!=n&&this.setValue(n),this.addInputListeners()},t.prototype.refreshLabel=function(){r(this.getLabel())?Yt(this.eInput,this.getLabelId()):this.eInput.removeAttribute("aria-labelledby"),e.prototype.refreshLabel.call(this)},t.prototype.addInputListeners=function(){var e=this;this.addManagedListener(this.eInput,"input",(function(t){return e.setValue(t.target.value)}))},t.prototype.setInputType=function(){"input"===this.displayFieldTag&&this.eInput.setAttribute("type",this.inputType)},t.prototype.getInputElement=function(){return this.eInput},t.prototype.setInputWidth=function(e){return jn(this.eWrapper,e),this},t.prototype.setInputName=function(e){return this.getInputElement().setAttribute("name",e),this},t.prototype.getFocusableElement=function(){return this.eInput},t.prototype.setMaxLength=function(e){return this.eInput.maxLength=e,this},t.prototype.setInputPlaceholder=function(e){return Nn(this.eInput,"placeholder",e),this},t.prototype.setInputAriaLabel=function(e){return Kt(this.eInput,e),this},t.prototype.setDisabled=function(t){return rn(this.eInput,t),e.prototype.setDisabled.call(this,t)},Qr([mr("eLabel")],t.prototype,"eLabel",void 0),Qr([mr("eWrapper")],t.prototype,"eWrapper",void 0),Qr([mr("eInput")],t.prototype,"eInput",void 0),t}(Hr),ei=function(){var e=function(t,o){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])},e(t,o)};return function(t,o){function n(){this.constructor=t}e(t,o),t.prototype=null===o?Object.create(o):(n.prototype=o.prototype,new n)}}(),ti=function(e){function t(t,o,n){void 0===o&&(o="ag-checkbox"),void 0===n&&(n="checkbox");var r=e.call(this,t,o,n)||this;return r.labelAlignment="right",r.selected=!1,r.readOnly=!1,r.passive=!1,r}return ei(t,e),t.prototype.addInputListeners=function(){this.addManagedListener(this.eInput,"click",this.onCheckboxClick.bind(this)),this.addManagedListener(this.eLabel,"click",this.toggle.bind(this))},t.prototype.getNextValue=function(){return void 0===this.selected||!this.selected},t.prototype.setPassive=function(e){this.passive=e},t.prototype.isReadOnly=function(){return this.readOnly},t.prototype.setReadOnly=function(e){this.eWrapper.classList.toggle("ag-disabled",e),this.eInput.disabled=e,this.readOnly=e},t.prototype.setDisabled=function(t){return this.eWrapper.classList.toggle("ag-disabled",t),e.prototype.setDisabled.call(this,t)},t.prototype.toggle=function(){if(!this.eInput.disabled){var e=this.isSelected(),t=this.getNextValue();this.passive?this.dispatchChange(t,e):this.setValue(t)}},t.prototype.getValue=function(){return this.isSelected()},t.prototype.setValue=function(e,t){return this.refreshSelectedClass(e),this.setSelected(e,t),this},t.prototype.setName=function(e){return this.getInputElement().name=e,this},t.prototype.isSelected=function(){return this.selected},t.prototype.setSelected=function(e,t){this.isSelected()!==e&&(this.previousValue=this.isSelected(),e=this.selected="boolean"===typeof e?e:void 0,this.eInput.checked=e,this.eInput.indeterminate=void 0===e,t||this.dispatchChange(this.selected,this.previousValue))},t.prototype.dispatchChange=function(e,o,n){this.dispatchEvent({type:t.EVENT_CHANGED,selected:e,previousValue:o,event:n});var r=this.getInputElement(),i={type:$e.EVENT_CHECKBOX_CHANGED,id:r.id,name:r.name,selected:e,previousValue:o};this.eventService.dispatchEvent(i)},t.prototype.onCheckboxClick=function(e){if(!this.passive&&!this.eInput.disabled){var t=this.isSelected(),o=this.selected=e.target.checked;this.refreshSelectedClass(o),this.dispatchChange(o,t,e)}},t.prototype.refreshSelectedClass=function(e){this.eWrapper.classList.toggle("ag-checked",!0===e),this.eWrapper.classList.toggle("ag-indeterminate",null==e)},t}(Zr),oi=function(){var e=function(t,o){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])},e(t,o)};return function(t,o){function n(){this.constructor=t}e(t,o),t.prototype=null===o?Object.create(o):(n.prototype=o.prototype,new n)}}(),ni=function(e){function t(t){return e.call(this,t,"ag-radio-button","radio")||this}return oi(t,e),t.prototype.isSelected=function(){return this.eInput.checked},t.prototype.toggle=function(){this.eInput.disabled||this.isSelected()||this.setValue(!0)},t.prototype.addInputListeners=function(){e.prototype.addInputListeners.call(this),this.addManagedListener(this.eventService,$e.EVENT_CHECKBOX_CHANGED,this.onChange.bind(this))},t.prototype.onChange=function(e){e.selected&&e.name&&this.eInput.name&&this.eInput.name===e.name&&e.id&&this.eInput.id!==e.id&&this.setValue(!1,!0)},t}(ti),ri=function(){var e=function(t,o){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])},e(t,o)};return function(t,o){function n(){this.constructor=t}e(t,o),t.prototype=null===o?Object.create(o):(n.prototype=o.prototype,new n)}}(),ii=function(e,t){var o="function"===typeof Symbol&&e[Symbol.iterator];if(!o)return e;var n,r,i=o.call(e),a=[];try{for(;(void 0===t||t-- >0)&&!(n=i.next()).done;)a.push(n.value)}catch(s){r={error:s}}finally{try{n&&!n.done&&(o=i.return)&&o.call(i)}finally{if(r)throw r.error}}return a},ai=function(){for(var e=[],t=0;t<arguments.length;t++)e=e.concat(ii(arguments[t]));return e},si=function(){function e(e,t){this.localeService=e,this.optionsFactory=t}return e.prototype.getModelAsString=function(e){var t=this;if(!e)return null;var o=null!=e.operator,n=this.localeService.getLocaleTextFunc();if(o){var r=e,i=r.conditions;if(!i)i=[r.condition1,r.condition2];var a=i.map((function(e){return t.getModelAsString(e)})),s="AND"===r.operator?"andCondition":"orCondition";return a.join(" "+n(s,Sr[s])+" ")}if(e.type===li.BLANK||e.type===li.NOT_BLANK)return n(e.type,e.type);var l=e,c=this.optionsFactory.getCustomOption(l.type),d=c||{},u=d.displayKey,p=d.displayName,h=d.numberOfInputs;return u&&p&&0===h?(n(u,p),p):this.conditionToString(l,c)},e}(),li=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.eTypes=[],t.eJoinOperatorPanels=[],t.eJoinOperatorsAnd=[],t.eJoinOperatorsOr=[],t.eConditionBodies=[],t.listener=function(){return t.onUiChanged()},t.lastUiCompletePosition=null,t.joinOperatorId=0,t}return ri(t,e),t.prototype.getNumberOfInputs=function(e){var o=this.optionsFactory.getCustomOption(e);if(o){var n=o.numberOfInputs;return null!=n?n:1}var r=[t.EMPTY,t.NOT_BLANK,t.BLANK];return e&&r.indexOf(e)>=0?0:e===t.IN_RANGE?2:1},t.prototype.onFloatingFilterChanged=function(e,t){this.setTypeFromFloatingFilter(e),this.setValueFromFloatingFilter(t),this.onUiChanged(!0)},t.prototype.setTypeFromFloatingFilter=function(e){var t=this;this.eTypes.forEach((function(o,n){0===n?o.setValue(e,!0):o.setValue(t.optionsFactory.getDefaultOption(),!0)}))},t.prototype.getModelFromUi=function(){var e=this.getUiCompleteConditions();return 0===e.length?null:this.maxNumConditions>1&&e.length>1?{filterType:this.getFilterType(),operator:this.getJoinOperator(),condition1:e[0],condition2:e[1],conditions:e}:e[0]},t.prototype.getConditionTypes=function(){return this.eTypes.map((function(e){return e.getValue()}))},t.prototype.getConditionType=function(e){return this.eTypes[e].getValue()},t.prototype.getJoinOperator=function(){return 0===this.eJoinOperatorsOr.length?this.defaultJoinOperator:!0===this.eJoinOperatorsOr[0].getValue()?"OR":"AND"},t.prototype.areModelsEqual=function(e,t){var o=this;if(!e&&!t)return!0;if(!e&&t||e&&!t)return!1;var n,r=!e.operator,i=!t.operator;if(!r&&i||r&&!i)return!1;if(r){var a=e,s=t;n=this.areSimpleModelsEqual(a,s)}else{var l=e,c=t;n=l.operator===c.operator&&ge(l.conditions,c.conditions,(function(e,t){return o.areSimpleModelsEqual(e,t)}))}return n},t.prototype.setModelIntoUi=function(e){var t=this;if(e.operator){var o=e;o.conditions||(o.conditions=[o.condition1,o.condition2]);var n=this.validateAndUpdateConditions(o.conditions),r=this.getNumConditions();if(n<r)this.removeConditionsAndOperators(n);else if(n>r)for(var i=r;i<n;i++)this.createJoinOperatorPanel(),this.createOption();var a="OR"===o.operator;this.eJoinOperatorsAnd.forEach((function(e){return e.setValue(!a,!0)})),this.eJoinOperatorsOr.forEach((function(e){return e.setValue(a,!0)})),o.conditions.forEach((function(e,o){t.eTypes[o].setValue(e.type,!0),t.setConditionIntoUi(e,o)}))}else{var s=e;this.getNumConditions()>1&&this.removeConditionsAndOperators(1),this.eTypes[0].setValue(s.type,!0),this.setConditionIntoUi(s,0)}return this.lastUiCompletePosition=this.getNumConditions()-1,this.createMissingConditionsAndOperators(),this.onUiChanged(),rr.resolve()},t.prototype.validateAndUpdateConditions=function(e){var t=e.length;return t>this.maxNumConditions&&(e.splice(this.maxNumConditions),j((function(){return console.warn('AG Grid: Filter Model contains more conditions than "filterParams.maxNumConditions". Additional conditions have been ignored.')}),"simpleFilterSetModelMaxNumConditions"),t=this.maxNumConditions),t},t.prototype.doesFilterPass=function(e){var t,o=this,n=this.getModel();if(null==n)return!0;var r=n.operator,i=[];if(r){var a=n;i.push.apply(i,ai(null!==(t=a.conditions)&&void 0!==t?t:[]))}else i.push(n);return i[r&&"OR"===r?"some":"every"]((function(t){return o.individualConditionPasses(e,t)}))},t.prototype.setParams=function(t){e.prototype.setParams.call(this,t),this.setNumConditions(t),this.defaultJoinOperator=this.getDefaultJoinOperator(t.defaultJoinOperator),this.filterPlaceholder=t.filterPlaceholder,this.optionsFactory=new _r,this.optionsFactory.init(t,this.getDefaultFilterOptions()),this.createOption(),this.createMissingConditionsAndOperators()},t.prototype.setNumConditions=function(e){var t,o;null!=e.suppressAndOrCondition&&j((function(){return console.warn('AG Grid: Since v29.2 "filterParams.suppressAndOrCondition" is deprecated. Use "filterParams.maxNumConditions = 1" instead.')}),"simpleFilterSuppressAndOrCondition"),null!=e.alwaysShowBothConditions&&j((function(){return console.warn('AG Grid: Since v29.2 "filterParams.alwaysShowBothConditions" is deprecated. Use "filterParams.numAlwaysVisibleConditions = 2" instead.')}),"simpleFilterAlwaysShowBothConditions"),this.maxNumConditions=null!==(t=e.maxNumConditions)&&void 0!==t?t:e.suppressAndOrCondition?1:2,this.maxNumConditions<1&&(j((function(){return console.warn('AG Grid: "filterParams.maxNumConditions" must be greater than or equal to zero.')}),"simpleFilterMaxNumConditions"),this.maxNumConditions=1),this.numAlwaysVisibleConditions=null!==(o=e.numAlwaysVisibleConditions)&&void 0!==o?o:e.alwaysShowBothConditions?2:1,this.numAlwaysVisibleConditions<1&&(j((function(){return console.warn('AG Grid: "filterParams.numAlwaysVisibleConditions" must be greater than or equal to zero.')}),"simpleFilterNumAlwaysVisibleConditions"),this.numAlwaysVisibleConditions=1),this.numAlwaysVisibleConditions>this.maxNumConditions&&(j((function(){return console.warn('AG Grid: "filterParams.numAlwaysVisibleConditions" cannot be greater than "filterParams.maxNumConditions".')}),"simpleFilterNumAlwaysVisibleGreaterThanMaxNumConditions"),this.numAlwaysVisibleConditions=this.maxNumConditions)},t.prototype.createOption=function(){var e=this,t=this.createManagedBean(new Jr);this.eTypes.push(t),t.addCssClass("ag-filter-select"),this.eFilterBody.appendChild(t.getGui());var o=this.createValueElement();this.eConditionBodies.push(o),this.eFilterBody.appendChild(o),this.putOptionsIntoDropdown(t),this.resetType(t);var n=this.getNumConditions()-1;this.forEachPositionInput(n,(function(t){return e.resetInput(t)})),this.addChangedListeners(t,n)},t.prototype.createJoinOperatorPanel=function(){var e=document.createElement("div");this.eJoinOperatorPanels.push(e),e.classList.add("ag-filter-condition");var t=this.createJoinOperator(this.eJoinOperatorsAnd,e,"and"),o=this.createJoinOperator(this.eJoinOperatorsOr,e,"or");this.eFilterBody.appendChild(e);var n=this.eJoinOperatorPanels.length-1,r=this.joinOperatorId++;this.resetJoinOperatorAnd(t,n,r),this.resetJoinOperatorOr(o,n,r),this.isReadOnly()||(t.onValueChange(this.listener),o.onValueChange(this.listener))},t.prototype.createJoinOperator=function(e,t,o){var n=this.createManagedBean(new ni);return e.push(n),n.addCssClass("ag-filter-condition-operator"),n.addCssClass("ag-filter-condition-operator-"+o),t.appendChild(n.getGui()),n},t.prototype.getDefaultJoinOperator=function(e){return"AND"===e||"OR"===e?e:"AND"},t.prototype.putOptionsIntoDropdown=function(e){var t=this,o=this.optionsFactory.getFilterOptions();o.forEach((function(o){var n="string"===typeof o?t.createBoilerplateListOption(o):t.createCustomListOption(o);e.addOption(n)})),e.setDisabled(o.length<=1)},t.prototype.createBoilerplateListOption=function(e){return{value:e,text:this.translate(e)}},t.prototype.createCustomListOption=function(e){var t=e.displayKey,o=this.optionsFactory.getCustomOption(e.displayKey);return{value:t,text:o?this.localeService.getLocaleTextFunc()(o.displayKey,o.displayName):this.translate(t)}},t.prototype.isAllowTwoConditions=function(){return this.maxNumConditions>=2},t.prototype.createBodyTemplate=function(){return""},t.prototype.getCssIdentifier=function(){return"simple-filter"},t.prototype.updateUiVisibility=function(){var e=this.getJoinOperator();this.updateNumConditions(),this.updateConditionStatusesAndValues(this.lastUiCompletePosition,e)},t.prototype.updateNumConditions=function(){for(var e,t=-1,o=!0,n=0;n<this.getNumConditions();n++)this.isConditionUiComplete(n)?t=n:o=!1;if(this.shouldAddNewConditionAtEnd(o))this.createJoinOperatorPanel(),this.createOption();else{var r=null!==(e=this.lastUiCompletePosition)&&void 0!==e?e:this.getNumConditions()-2;if(t<r){this.removeConditionsAndOperators(r+1);var i=t+1,a=r-i;a>0&&this.removeConditionsAndOperators(i,a),this.createMissingConditionsAndOperators()}}this.lastUiCompletePosition=t},t.prototype.updateConditionStatusesAndValues=function(e,t){var o=this;this.eTypes.forEach((function(t,n){var r=o.isConditionDisabled(n,e);(1===n?[t,o.eJoinOperatorPanels[0],o.eJoinOperatorsAnd[0],o.eJoinOperatorsOr[0]]:[t]).forEach((function(e){e instanceof Zr||e instanceof Jr?e.setDisabled(r):rn(e,r)}))})),this.eConditionBodies.forEach((function(e,t){on(e,o.isConditionBodyVisible(t))}));var n="OR"===(null!==t&&void 0!==t?t:this.getJoinOperator());this.eJoinOperatorsAnd.forEach((function(e,t){e.setValue(!n,!0)})),this.eJoinOperatorsOr.forEach((function(e,t){e.setValue(n,!0)})),this.forEachInput((function(t,n,r,i){o.setElementDisplayed(t,n<i),o.setElementDisabled(t,o.isConditionDisabled(r,e))})),this.resetPlaceholder()},t.prototype.shouldAddNewConditionAtEnd=function(e){return e&&this.getNumConditions()<this.maxNumConditions&&!this.isReadOnly()},t.prototype.removeConditionsAndOperators=function(e,t){if(!(e>=this.getNumConditions())){this.removeComponents(this.eTypes,e,t),this.removeElements(this.eConditionBodies,e,t),this.removeValueElements(e,t);var o=Math.max(e-1,0);this.removeElements(this.eJoinOperatorPanels,o,t),this.removeComponents(this.eJoinOperatorsAnd,o,t),this.removeComponents(this.eJoinOperatorsOr,o,t)}},t.prototype.removeElements=function(e,t,o){this.removeItems(e,t,o).forEach((function(e){return mn(e)}))},t.prototype.removeComponents=function(e,t,o){var n=this;this.removeItems(e,t,o).forEach((function(e){mn(e.getGui()),n.destroyBean(e)}))},t.prototype.removeItems=function(e,t,o){return null==o?e.splice(t):e.splice(t,o)},t.prototype.afterGuiAttached=function(t){if(e.prototype.afterGuiAttached.call(this,t),this.resetPlaceholder(),!t||!t.suppressFocus&&!this.isReadOnly()){var o=this.getInputs(0)[0];if(!o)return;o instanceof Zr&&o.getInputElement().focus()}},t.prototype.afterGuiDetached=function(){e.prototype.afterGuiDetached.call(this);var t=this.getModel();this.areModelsEqual(t,this.getModelFromUi())||this.resetUiToActiveModel(t);for(var o=-1,n=-1,r=!1,i=this.getJoinOperator(),a=this.getNumConditions()-1;a>=0;a--)if(this.isConditionUiComplete(a))-1===o&&(o=a,n=a);else{var s=a<o;(a>=this.numAlwaysVisibleConditions&&!this.isConditionUiComplete(a-1)||s)&&(this.removeConditionsAndOperators(a,1),r=!0,s&&n--)}var l=!1;this.getNumConditions()<this.numAlwaysVisibleConditions&&(this.createMissingConditionsAndOperators(),l=!0),this.shouldAddNewConditionAtEnd(n===this.getNumConditions()-1)&&(this.createJoinOperatorPanel(),this.createOption(),l=!0),l&&this.updateConditionStatusesAndValues(n,i),r&&this.updateJoinOperatorsDisabled(),this.lastUiCompletePosition=n},t.prototype.getPlaceholderText=function(e,t){var o=this.translate(e);if(R(this.filterPlaceholder)){var n=this.filterPlaceholder,r=this.eTypes[t].getValue();o=n({filterOptionKey:r,filterOption:this.translate(r),placeholder:o})}else"string"===typeof this.filterPlaceholder&&(o=this.filterPlaceholder);return o},t.prototype.resetPlaceholder=function(){var e=this,t=this.localeService.getLocaleTextFunc();this.forEachInput((function(o,n,r,i){if(o instanceof Zr){var a=0===n&&i>1?"inRangeStart":0===n?"filterOoo":"inRangeEnd",s=0===n&&i>1?t("ariaFilterFromValue","Filter from value"):0===n?t("ariaFilterValue","Filter Value"):t("ariaFilterToValue","Filter to Value");o.setInputPlaceholder(e.getPlaceholderText(a,r)),o.setInputAriaLabel(s)}}))},t.prototype.setElementValue=function(e,t){e instanceof Zr&&e.setValue(null!=t?String(t):null,!0)},t.prototype.setElementDisplayed=function(e,t){e instanceof fr&&on(e.getGui(),t)},t.prototype.setElementDisabled=function(e,t){e instanceof fr&&rn(e.getGui(),t)},t.prototype.attachElementOnChange=function(e,t){e instanceof Zr&&e.onValueChange(t)},t.prototype.forEachInput=function(e){var t=this;this.getConditionTypes().forEach((function(o,n){t.forEachPositionTypeInput(n,o,e)}))},t.prototype.forEachPositionInput=function(e,t){var o=this.getConditionType(e);this.forEachPositionTypeInput(e,o,t)},t.prototype.forEachPositionTypeInput=function(e,t,o){for(var n=this.getNumberOfInputs(t),r=this.getInputs(e),i=0;i<r.length;i++){var a=r[i];null!=a&&o(a,i,e,n)}},t.prototype.isConditionDisabled=function(e,t){return!!this.isReadOnly()||0!==e&&e>t+1},t.prototype.isConditionBodyVisible=function(e){var t=this.getConditionType(e);return this.getNumberOfInputs(t)>0},t.prototype.isConditionUiComplete=function(e){return!(e>=this.getNumConditions())&&(this.getConditionType(e)!==t.EMPTY&&!this.getValues(e).some((function(e){return null==e})))},t.prototype.getNumConditions=function(){return this.eTypes.length},t.prototype.getUiCompleteConditions=function(){for(var e=[],t=0;t<this.getNumConditions();t++)this.isConditionUiComplete(t)&&e.push(this.createCondition(t));return e},t.prototype.createMissingConditionsAndOperators=function(){if(!this.isReadOnly())for(var e=this.getNumConditions();e<this.numAlwaysVisibleConditions;e++)this.createJoinOperatorPanel(),this.createOption()},t.prototype.resetUiToDefaults=function(e){var t=this;return this.removeConditionsAndOperators(this.isReadOnly()?1:this.numAlwaysVisibleConditions),this.eTypes.forEach((function(e){return t.resetType(e)})),this.eJoinOperatorsAnd.forEach((function(e,o){return t.resetJoinOperatorAnd(e,o,t.joinOperatorId+o)})),this.eJoinOperatorsOr.forEach((function(e,o){return t.resetJoinOperatorOr(e,o,t.joinOperatorId+o)})),this.joinOperatorId++,this.forEachInput((function(e){return t.resetInput(e)})),this.resetPlaceholder(),this.createMissingConditionsAndOperators(),this.lastUiCompletePosition=null,e||this.onUiChanged(),rr.resolve()},t.prototype.resetType=function(e){var t=this.localeService.getLocaleTextFunc()("ariaFilteringOperator","Filtering operator");e.setValue(this.optionsFactory.getDefaultOption(),!0).setAriaLabel(t).setDisabled(this.isReadOnly())},t.prototype.resetJoinOperatorAnd=function(e,t,o){this.resetJoinOperator(e,t,this.isDefaultOperator("AND"),this.translate("andCondition"),o)},t.prototype.resetJoinOperatorOr=function(e,t,o){this.resetJoinOperator(e,t,this.isDefaultOperator("OR"),this.translate("orCondition"),o)},t.prototype.resetJoinOperator=function(e,t,o,n,r){this.updateJoinOperatorDisabled(e.setValue(o,!0).setName("ag-simple-filter-and-or-"+this.getCompId()+"-"+r).setLabel(n),t)},t.prototype.updateJoinOperatorsDisabled=function(){var e=this;this.eJoinOperatorsAnd.forEach((function(t,o){return e.updateJoinOperatorDisabled(t,o)})),this.eJoinOperatorsOr.forEach((function(t,o){return e.updateJoinOperatorDisabled(t,o)}))},t.prototype.updateJoinOperatorDisabled=function(e,t){e.setDisabled(this.isReadOnly()||t>0)},t.prototype.resetInput=function(e){this.setElementValue(e,null),this.setElementDisabled(e,this.isReadOnly())},t.prototype.setConditionIntoUi=function(e,t){var o=this,n=this.mapValuesFromModel(e);this.forEachInput((function(e,r,i,a){i===t&&o.setElementValue(e,null!=n[r]?n[r]:null)}))},t.prototype.setValueFromFloatingFilter=function(e){var t=this;this.forEachInput((function(o,n,r,i){t.setElementValue(o,0===n&&0===r?e:null)}))},t.prototype.isDefaultOperator=function(e){return e===this.defaultJoinOperator},t.prototype.addChangedListeners=function(e,t){var o=this;this.isReadOnly()||(e.onValueChange(this.listener),this.forEachPositionInput(t,(function(e){o.attachElementOnChange(e,o.listener)})))},t.prototype.individualConditionPasses=function(e,t){var o=this.getCellValue(e.node),n=this.mapValuesFromModel(t),r=this.optionsFactory.getCustomOption(t.type),i=this.evaluateCustomFilter(r,n,o);return null!=i?i:null==o?this.evaluateNullValue(t.type):this.evaluateNonNullValue(n,o,t,e)},t.prototype.evaluateCustomFilter=function(e,t,o){if(null!=e){var n=e.predicate;return null==n||t.some((function(e){return null==e}))?void 0:n(t,o)}},t.prototype.isBlank=function(e){return null==e||"string"===typeof e&&0===e.trim().length},t.EMPTY="empty",t.BLANK="blank",t.NOT_BLANK="notBlank",t.EQUALS="equals",t.NOT_EQUAL="notEqual",t.LESS_THAN="lessThan",t.LESS_THAN_OR_EQUAL="lessThanOrEqual",t.GREATER_THAN="greaterThan",t.GREATER_THAN_OR_EQUAL="greaterThanOrEqual",t.IN_RANGE="inRange",t.CONTAINS="contains",t.NOT_CONTAINS="notContains",t.STARTS_WITH="startsWith",t.ENDS_WITH="endsWith",t}(Mr),ci=function(){var e=function(t,o){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])},e(t,o)};return function(t,o){function n(){this.constructor=t}e(t,o),t.prototype=null===o?Object.create(o):(n.prototype=o.prototype,new n)}}(),di=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return ci(t,e),t.prototype.setParams=function(t){e.prototype.setParams.call(this,t),this.scalarFilterParams=t},t.prototype.evaluateNullValue=function(e){switch(e){case t.EQUALS:case t.NOT_EQUAL:if(this.scalarFilterParams.includeBlanksInEquals)return!0;break;case t.GREATER_THAN:case t.GREATER_THAN_OR_EQUAL:if(this.scalarFilterParams.includeBlanksInGreaterThan)return!0;break;case t.LESS_THAN:case t.LESS_THAN_OR_EQUAL:if(this.scalarFilterParams.includeBlanksInLessThan)return!0;break;case t.IN_RANGE:if(this.scalarFilterParams.includeBlanksInRange)return!0;break;case t.BLANK:return!0;case t.NOT_BLANK:return!1}return!1},t.prototype.evaluateNonNullValue=function(e,o,n){var r=this.comparator(),i=null!=e[0]?r(e[0],o):0;switch(n.type){case t.EQUALS:return 0===i;case t.NOT_EQUAL:return 0!==i;case t.GREATER_THAN:return i>0;case t.GREATER_THAN_OR_EQUAL:return i>=0;case t.LESS_THAN:return i<0;case t.LESS_THAN_OR_EQUAL:return i<=0;case t.IN_RANGE:var a=r(e[1],o);return this.scalarFilterParams.inRangeInclusive?i>=0&&a<=0:i>0&&a<0;case t.BLANK:return this.isBlank(o);case t.NOT_BLANK:return!this.isBlank(o);default:return console.warn('AG Grid: Unexpected type of filter "'+n.type+'", it looks like the filter was configured with incorrect Filter Options'),!0}},t}(li),ui=function(){var e=function(t,o){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])},e(t,o)};return function(t,o){function n(){this.constructor=t}e(t,o),t.prototype=null===o?Object.create(o):(n.prototype=o.prototype,new n)}}(),pi=function(){return pi=Object.assign||function(e){for(var t,o=1,n=arguments.length;o<n;o++)for(var r in t=arguments[o])Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e},pi.apply(this,arguments)},hi=function(e,t,o,n){var r,i=arguments.length,a=i<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,o):n;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)a=Reflect.decorate(e,t,o,n);else for(var s=e.length-1;s>=0;s--)(r=e[s])&&(a=(i<3?r(a):i>3?r(t,o,a):r(t,o))||a);return i>3&&a&&Object.defineProperty(t,o,a),a},fi=1/0,gi=function(e){function t(t,o,n){var r=e.call(this,o,n)||this;return r.dateFilterParams=t,r}return ui(t,e),t.prototype.conditionToString=function(e,t){var o=e.type,n=(t||{}).numberOfInputs,r=o==li.IN_RANGE||2===n,i=Ko(e.dateFrom),a=Ko(e.dateTo),s=this.dateFilterParams.inRangeFloatingFilterDateFormat;return r?(null!==i?qo(i,s):"null")+"-"+(null!==a?qo(a,s):"null"):null!=i?qo(i,s):""+o},t}(si),mi=function(e){function t(){var t=e.call(this,"dateFilter")||this;return t.eConditionPanelsFrom=[],t.eConditionPanelsTo=[],t.dateConditionFromComps=[],t.dateConditionToComps=[],t.minValidYear=1e3,t.maxValidYear=fi,t}return ui(t,e),t.prototype.afterGuiAttached=function(t){e.prototype.afterGuiAttached.call(this,t),this.dateConditionFromComps[0].afterGuiAttached(t)},t.prototype.mapValuesFromModel=function(e){var t=e||{},o=t.dateFrom,n=t.dateTo,r=t.type;return[o&&Ko(o)||null,n&&Ko(n)||null].slice(0,this.getNumberOfInputs(r))},t.prototype.comparator=function(){return this.dateFilterParams.comparator?this.dateFilterParams.comparator:this.defaultComparator.bind(this)},t.prototype.defaultComparator=function(e,t){return null==t||t<e?-1:t>e?1:0},t.prototype.setParams=function(t){this.dateFilterParams=t,e.prototype.setParams.call(this,t);var o=function(e,o){if(null!=t[e]){if(!isNaN(t[e]))return null==t[e]?o:Number(t[e]);console.warn("AG Grid: DateFilter "+e+" is not a number")}return o};this.minValidYear=o("minValidYear",1e3),this.maxValidYear=o("maxValidYear",fi),this.minValidYear>this.maxValidYear&&console.warn("AG Grid: DateFilter minValidYear should be <= maxValidYear"),this.filterModelFormatter=new gi(this.dateFilterParams,this.localeService,this.optionsFactory)},t.prototype.createDateCompWrapper=function(e){var t=this,o=new wr(this.getContext(),this.userComponentFactory,{onDateChanged:function(){return t.onUiChanged()},filterParams:this.dateFilterParams},e);return this.addDestroyFunc((function(){return o.destroy()})),o},t.prototype.setElementValue=function(e,t){e.setDate(t)},t.prototype.setElementDisplayed=function(e,t){e.setDisplayed(t)},t.prototype.setElementDisabled=function(e,t){e.setDisabled(t)},t.prototype.getDefaultFilterOptions=function(){return t.DEFAULT_FILTER_OPTIONS},t.prototype.createValueElement=function(){var e=document.createElement("div");return e.classList.add("ag-filter-body"),this.createFromToElement(e,this.eConditionPanelsFrom,this.dateConditionFromComps,"from"),this.createFromToElement(e,this.eConditionPanelsTo,this.dateConditionToComps,"to"),e},t.prototype.createFromToElement=function(e,t,o,n){var r=document.createElement("div");r.classList.add("ag-filter-"+n),r.classList.add("ag-filter-date-"+n),t.push(r),e.appendChild(r),o.push(this.createDateCompWrapper(r))},t.prototype.removeValueElements=function(e,t){this.removeDateComps(this.dateConditionFromComps,e,t),this.removeDateComps(this.dateConditionToComps,e,t),this.removeItems(this.eConditionPanelsFrom,e,t),this.removeItems(this.eConditionPanelsTo,e,t)},t.prototype.removeDateComps=function(e,t,o){this.removeItems(e,t,o).forEach((function(e){return e.destroy()}))},t.prototype.isConditionUiComplete=function(t){var o=this;if(!e.prototype.isConditionUiComplete.call(this,t))return!1;var n=!0;return this.forEachInput((function(e,r,i,a){var s;i!==t||!n||r>=a||(n=n&&(null!=(s=e.getDate())&&s.getUTCFullYear()>=o.minValidYear&&s.getUTCFullYear()<=o.maxValidYear))})),n},t.prototype.areSimpleModelsEqual=function(e,t){return e.dateFrom===t.dateFrom&&e.dateTo===t.dateTo&&e.type===t.type},t.prototype.getFilterType=function(){return"date"},t.prototype.createCondition=function(e){var t=this.getConditionType(e),o={},n=this.getValues(e);return n.length>0&&(o.dateFrom=Uo(n[0])),n.length>1&&(o.dateTo=Uo(n[1])),pi({dateFrom:null,dateTo:null,filterType:this.getFilterType(),type:t},o)},t.prototype.resetPlaceholder=function(){var e=this.localeService.getLocaleTextFunc(),t=this.translate("dateFormatOoo"),o=e("ariaFilterValue","Filter Value");this.forEachInput((function(e){e.setInputPlaceholder(t),e.setInputAriaLabel(o)}))},t.prototype.getInputs=function(e){return e>=this.dateConditionFromComps.length?[null,null]:[this.dateConditionFromComps[e],this.dateConditionToComps[e]]},t.prototype.getValues=function(e){var t=[];return this.forEachPositionInput(e,(function(e,o,n,r){o<r&&t.push(e.getDate())})),t},t.prototype.getModelAsString=function(e){var t;return null!==(t=this.filterModelFormatter.getModelAsString(e))&&void 0!==t?t:""},t.DEFAULT_FILTER_OPTIONS=[di.EQUALS,di.GREATER_THAN,di.LESS_THAN,di.NOT_EQUAL,di.IN_RANGE,di.BLANK,di.NOT_BLANK],hi([q("userComponentFactory")],t.prototype,"userComponentFactory",void 0),t}(di),yi=function(){var e=function(t,o){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])},e(t,o)};return function(t,o){function n(){this.constructor=t}e(t,o),t.prototype=null===o?Object.create(o):(n.prototype=o.prototype,new n)}}(),vi=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return yi(t,e),t.prototype.getDefaultDebounceMs=function(){return 0},t.prototype.destroy=function(){e.prototype.destroy.call(this)},t.prototype.isEventFromFloatingFilter=function(e){return e&&e.afterFloatingFilter},t.prototype.isEventFromDataChange=function(e){return null===e||void 0===e?void 0:e.afterDataChange},t.prototype.getLastType=function(){return this.lastType},t.prototype.isReadOnly=function(){return this.readOnly},t.prototype.setLastTypeFromModel=function(e){if(e){var t;if(e.operator)t=e.conditions[0];else t=e;this.lastType=t.type}else this.lastType=this.optionsFactory.getDefaultOption()},t.prototype.canWeEditAfterModelFromParentFilter=function(e){if(!e)return this.isTypeEditable(this.lastType);if(e.operator)return!1;var t=e;return this.isTypeEditable(t.type)},t.prototype.init=function(e){this.optionsFactory=new _r,this.optionsFactory.init(e.filterParams,this.getDefaultFilterOptions()),this.lastType=this.optionsFactory.getDefaultOption(),this.readOnly=!!e.filterParams.readOnly;var t=this.isTypeEditable(this.lastType);this.setEditable(t)},t.prototype.doesFilterHaveSingleInput=function(e){var t=(this.optionsFactory.getCustomOption(e)||{}).numberOfInputs;return null==t||1==t},t.prototype.isTypeEditable=function(e){var t=[li.IN_RANGE,li.EMPTY,li.BLANK,li.NOT_BLANK];return!!e&&!this.isReadOnly()&&this.doesFilterHaveSingleInput(e)&&t.indexOf(e)<0},t}(fr),bi=function(){var e=function(t,o){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])},e(t,o)};return function(t,o){function n(){this.constructor=t}e(t,o),t.prototype=null===o?Object.create(o):(n.prototype=o.prototype,new n)}}(),xi=function(e,t,o,n){var r,i=arguments.length,a=i<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,o):n;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)a=Reflect.decorate(e,t,o,n);else for(var s=e.length-1;s>=0;s--)(r=e[s])&&(a=(i<3?r(a):i>3?r(t,o,a):r(t,o))||a);return i>3&&a&&Object.defineProperty(t,o,a),a},wi=function(e){function t(){return e.call(this,'\n            <div class="ag-floating-filter-input" role="presentation">\n                <ag-input-text-field ref="eReadOnlyText"></ag-input-text-field>\n                <div ref="eDateWrapper" style="display: flex;"></div>\n            </div>')||this}return bi(t,e),t.prototype.getDefaultFilterOptions=function(){return mi.DEFAULT_FILTER_OPTIONS},t.prototype.init=function(t){e.prototype.init.call(this,t),this.params=t,this.filterParams=t.filterParams,this.createDateComponent();var o=this.localeService.getLocaleTextFunc();this.eReadOnlyText.setDisabled(!0).setInputAriaLabel(o("ariaDateFilterInput","Date Filter Input")),this.filterModelFormatter=new gi(this.filterParams,this.localeService,this.optionsFactory)},t.prototype.setEditable=function(e){on(this.eDateWrapper,e),on(this.eReadOnlyText.getGui(),!e)},t.prototype.onParentModelChanged=function(t,o){if(!this.isEventFromFloatingFilter(o)&&!this.isEventFromDataChange(o)){e.prototype.setLastTypeFromModel.call(this,t);var n=!this.isReadOnly()&&this.canWeEditAfterModelFromParentFilter(t);if(this.setEditable(n),n){if(t){var r=t;this.dateComp.setDate(Ko(r.dateFrom))}else this.dateComp.setDate(null);this.eReadOnlyText.setValue("")}else this.eReadOnlyText.setValue(this.filterModelFormatter.getModelAsString(t)),this.dateComp.setDate(null)}},t.prototype.onDateChanged=function(){var e=this,t=Uo(this.dateComp.getDate());this.params.parentFilterInstance((function(o){if(o){var n=Ko(t);o.onFloatingFilterChanged(e.getLastType()||null,n)}}))},t.prototype.createDateComponent=function(){var e=this,t=Mr.getDebounceMs(this.params.filterParams,this.getDefaultDebounceMs()),o={onDateChanged:I(this.onDateChanged.bind(this),t),filterParams:this.params.column.getColDef().filterParams};this.dateComp=new wr(this.getContext(),this.userComponentFactory,o,this.eDateWrapper),this.addDestroyFunc((function(){return e.dateComp.destroy()}))},t.prototype.getFilterModelFormatter=function(){return this.filterModelFormatter},xi([q("userComponentFactory")],t.prototype,"userComponentFactory",void 0),xi([mr("eReadOnlyText")],t.prototype,"eReadOnlyText",void 0),xi([mr("eDateWrapper")],t.prototype,"eDateWrapper",void 0),t}(vi),Ci=function(){var e=function(t,o){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])},e(t,o)};return function(t,o){function n(){this.constructor=t}e(t,o),t.prototype=null===o?Object.create(o):(n.prototype=o.prototype,new n)}}(),_i=function(e,t,o,n){var r,i=arguments.length,a=i<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,o):n;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)a=Reflect.decorate(e,t,o,n);else for(var s=e.length-1;s>=0;s--)(r=e[s])&&(a=(i<3?r(a):i>3?r(t,o,a):r(t,o))||a);return i>3&&a&&Object.defineProperty(t,o,a),a},Si=function(e){function t(){return e.call(this,'\n            <div class="ag-filter-filter">\n                <ag-input-text-field class="ag-date-filter" ref="eDateInput"></ag-input-text-field>\n            </div>')||this}return Ci(t,e),t.prototype.destroy=function(){e.prototype.destroy.call(this)},t.prototype.init=function(e){var t=this,o=this.gridOptionsService.getDocument(),n=this.eDateInput.getInputElement(),r=this.shouldUseBrowserDatePicker(e);r&&(n.type="date");var i=r&&Eo();this.addManagedListener(n,"mousedown",(function(){t.eDateInput.isDisabled()||i||n.focus()})),this.addManagedListener(n,"input",(function(n){n.target===o.activeElement&&(t.eDateInput.isDisabled()||e.onDateChanged())}));var a=e.filterParams||{},s=a.minValidYear,l=a.maxValidYear;s&&(n.min=s+"-01-01"),l&&(n.max=l+"-12-31")},t.prototype.getDate=function(){return Ko(this.eDateInput.getValue())},t.prototype.setDate=function(e){this.eDateInput.setValue(Uo(e,!1))},t.prototype.setInputPlaceholder=function(e){this.eDateInput.setInputPlaceholder(e)},t.prototype.setDisabled=function(e){this.eDateInput.setDisabled(e)},t.prototype.afterGuiAttached=function(e){e&&e.suppressFocus||this.eDateInput.getInputElement().focus()},t.prototype.shouldUseBrowserDatePicker=function(e){return e.filterParams&&null!=e.filterParams.browserDatePicker?e.filterParams.browserDatePicker:jo()||Ao()||Eo()&&ko()>=14.1},_i([mr("eDateInput")],t.prototype,"eDateInput",void 0),t}(fr),Ei=function(){var e=function(t,o){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])},e(t,o)};return function(t,o){function n(){this.constructor=t}e(t,o),t.prototype=null===o?Object.create(o):(n.prototype=o.prototype,new n)}}(),ki=function(e){function t(t,o,n){return void 0===o&&(o="ag-text-field"),void 0===n&&(n="text"),e.call(this,t,o,n)||this}return Ei(t,e),t.prototype.postConstruct=function(){e.prototype.postConstruct.call(this),this.config.allowedCharPattern&&this.preventDisallowedCharacters()},t.prototype.setValue=function(t,o){var n=e.prototype.setValue.call(this,t,o);return this.eInput.value!==t&&(this.eInput.value=r(t)?t:""),n},t.prototype.preventDisallowedCharacters=function(){var e=new RegExp("["+this.config.allowedCharPattern+"]");this.addManagedListener(this.eInput,"keypress",(function(t){t.ctrlKey||t.metaKey||t.key&&!e.test(t.key)&&t.preventDefault()})),this.addManagedListener(this.eInput,"paste",(function(t){var o,n=null===(o=t.clipboardData)||void 0===o?void 0:o.getData("text");n&&n.split("").some((function(t){return!e.test(t)}))&&t.preventDefault()}))},t}(Zr),ji=function(){var e=function(t,o){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])},e(t,o)};return function(t,o){function n(){this.constructor=t}e(t,o),t.prototype=null===o?Object.create(o):(n.prototype=o.prototype,new n)}}(),Ai=function(e){function t(t){return e.call(this,t,"ag-number-field","number")||this}return ji(t,e),t.prototype.postConstruct=function(){var t=this;e.prototype.postConstruct.call(this),this.addManagedListener(this.eInput,"blur",(function(){var e=parseFloat(t.eInput.value),o=isNaN(e)?"":t.normalizeValue(e.toString());t.value!==o&&t.setValue(o)})),this.addManagedListener(this.eInput,"wheel",this.onWheel.bind(this)),this.eInput.step="any"},t.prototype.onWheel=function(e){document.activeElement===this.eInput&&e.preventDefault()},t.prototype.normalizeValue=function(e){if(""===e)return"";this.precision&&(e=this.adjustPrecision(e));var t=parseFloat(e);return null!=this.min&&t<this.min?e=this.min.toString():null!=this.max&&t>this.max&&(e=this.max.toString()),e},t.prototype.adjustPrecision=function(e){if(this.precision){var t=parseFloat(e).toFixed(this.precision);e=parseFloat(t).toString()}return e},t.prototype.setMin=function(e){return this.min===e||(this.min=e,Nn(this.eInput,"min",e)),this},t.prototype.setMax=function(e){return this.max===e||(this.max=e,Nn(this.eInput,"max",e)),this},t.prototype.setPrecision=function(e){return this.precision=e,this},t.prototype.setStep=function(e){return this.step===e||(this.step=e,Nn(this.eInput,"step",e)),this},t.prototype.setValue=function(t,o){if(null!=t&&(t=this.adjustPrecision(t))!=this.normalizeValue(t))return this;return e.prototype.setValue.call(this,t,o)},t}(ki),Ri=function(){var e=function(t,o){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])},e(t,o)};return function(t,o){function n(){this.constructor=t}e(t,o),t.prototype=null===o?Object.create(o):(n.prototype=o.prototype,new n)}}(),Oi=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Ri(t,e),t.prototype.conditionToString=function(e,t){var o=(t||{}).numberOfInputs;return e.type==li.IN_RANGE||2===o?e.filter+"-"+e.filterTo:null!=e.filter?""+e.filter:""+e.type},t}(si);function Ti(e){var t=(null!==e&&void 0!==e?e:{}).allowedCharPattern;return t||(jo()?null:"\\d\\-\\.")}var Di,Pi,Ni,Ii=function(e){function t(){var t=e.call(this,"numberFilter")||this;return t.eValuesFrom=[],t.eValuesTo=[],t}return Ri(t,e),t.prototype.mapValuesFromModel=function(e){var t=e||{},o=t.filter,n=t.filterTo,r=t.type;return[this.processValue(o),this.processValue(n)].slice(0,this.getNumberOfInputs(r))},t.prototype.getDefaultDebounceMs=function(){return 500},t.prototype.comparator=function(){return function(e,t){return e===t?0:e<t?1:-1}},t.prototype.setParams=function(t){this.numberFilterParams=t,e.prototype.setParams.call(this,t),this.filterModelFormatter=new Oi(this.localeService,this.optionsFactory)},t.prototype.getDefaultFilterOptions=function(){return t.DEFAULT_FILTER_OPTIONS},t.prototype.createValueElement=function(){var e=Ti(this.numberFilterParams),t=document.createElement("div");return t.classList.add("ag-filter-body"),$t(t,"presentation"),this.createFromToElement(t,this.eValuesFrom,"from",e),this.createFromToElement(t,this.eValuesTo,"to",e),t},t.prototype.createFromToElement=function(e,t,o,n){var r=this.createManagedBean(n?new ki({allowedCharPattern:n}):new Ai);r.addCssClass("ag-filter-"+o),r.addCssClass("ag-filter-filter"),t.push(r),e.appendChild(r.getGui())},t.prototype.removeValueElements=function(e,t){this.removeComponents(this.eValuesFrom,e,t),this.removeComponents(this.eValuesTo,e,t)},t.prototype.getValues=function(e){var t=this,o=[];return this.forEachPositionInput(e,(function(e,n,r,i){n<i&&o.push(t.processValue(t.stringToFloat(e.getValue())))})),o},t.prototype.areSimpleModelsEqual=function(e,t){return e.filter===t.filter&&e.filterTo===t.filterTo&&e.type===t.type},t.prototype.getFilterType=function(){return"number"},t.prototype.processValue=function(e){return null==e||isNaN(e)?null:e},t.prototype.stringToFloat=function(e){if("number"===typeof e)return e;var t=n(e);return null!=t&&""===t.trim()&&(t=null),this.numberFilterParams.numberParser?this.numberFilterParams.numberParser(t):null==t||"-"===t.trim()?null:parseFloat(t)},t.prototype.createCondition=function(e){var t=this.getConditionType(e),o={filterType:this.getFilterType(),type:t},n=this.getValues(e);return n.length>0&&(o.filter=n[0]),n.length>1&&(o.filterTo=n[1]),o},t.prototype.getInputs=function(e){return e>=this.eValuesFrom.length?[null,null]:[this.eValuesFrom[e],this.eValuesTo[e]]},t.prototype.getModelAsString=function(e){var t;return null!==(t=this.filterModelFormatter.getModelAsString(e))&&void 0!==t?t:""},t.DEFAULT_FILTER_OPTIONS=[di.EQUALS,di.NOT_EQUAL,di.LESS_THAN,di.LESS_THAN_OR_EQUAL,di.GREATER_THAN,di.GREATER_THAN_OR_EQUAL,di.IN_RANGE,di.BLANK,di.NOT_BLANK],t}(di),Mi=function(){var e=function(t,o){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])},e(t,o)};return function(t,o){function n(){this.constructor=t}e(t,o),t.prototype=null===o?Object.create(o):(n.prototype=o.prototype,new n)}}(),Li=function(){return Li=Object.assign||function(e){for(var t,o=1,n=arguments.length;o<n;o++)for(var r in t=arguments[o])Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e},Li.apply(this,arguments)},Fi=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Mi(t,e),t.prototype.conditionToString=function(e,t){var o=(t||{}).numberOfInputs;return e.type==li.IN_RANGE||2===o?e.filter+"-"+e.filterTo:null!=e.filter?""+e.filter:""+e.type},t}(si),Gi=function(e){function t(){var t=e.call(this,"textFilter")||this;return t.eValuesFrom=[],t.eValuesTo=[],t}return Mi(t,e),t.trimInput=function(e){var t=e&&e.trim();return""===t?e:t},t.prototype.getDefaultDebounceMs=function(){return 500},t.prototype.setParams=function(o){this.textFilterParams=o,e.prototype.setParams.call(this,o),this.matcher=this.getTextMatcher(),this.formatter=this.textFilterParams.textFormatter||(this.textFilterParams.caseSensitive?t.DEFAULT_FORMATTER:t.DEFAULT_LOWERCASE_FORMATTER),this.filterModelFormatter=new Fi(this.localeService,this.optionsFactory)},t.prototype.getTextMatcher=function(){var e=this.textFilterParams.textCustomComparator;return e?(tr.doOnce((function(){return console.warn("AG Grid - textCustomComparator is deprecated, use textMatcher instead.")}),"textCustomComparator.deprecated"),function(t){var o=t.filterOption,n=t.value,r=t.filterText;return e(o,n,r)}):this.textFilterParams.textMatcher||t.DEFAULT_MATCHER},t.prototype.createCondition=function(e){var t=this.getConditionType(e),o={filterType:this.getFilterType(),type:t},n=this.getValues(e);return n.length>0&&(o.filter=n[0]),n.length>1&&(o.filterTo=n[1]),o},t.prototype.getFilterType=function(){return"text"},t.prototype.areSimpleModelsEqual=function(e,t){return e.filter===t.filter&&e.filterTo===t.filterTo&&e.type===t.type},t.prototype.getInputs=function(e){return e>=this.eValuesFrom.length?[null,null]:[this.eValuesFrom[e],this.eValuesTo[e]]},t.prototype.getValues=function(e){var o=this,r=[];return this.forEachPositionInput(e,(function(e,i,a,s){if(i<s){var l=n(e.getValue()),c=(o.textFilterParams.trimInput?t.trimInput(l):l)||null;r.push(c),e.setValue(c,!0)}})),r},t.prototype.getDefaultFilterOptions=function(){return t.DEFAULT_FILTER_OPTIONS},t.prototype.createValueElement=function(){var e=document.createElement("div");return e.classList.add("ag-filter-body"),$t(e,"presentation"),this.createFromToElement(e,this.eValuesFrom,"from"),this.createFromToElement(e,this.eValuesTo,"to"),e},t.prototype.createFromToElement=function(e,t,o){var n=this.createManagedBean(new ki);n.addCssClass("ag-filter-"+o),n.addCssClass("ag-filter-filter"),t.push(n),e.appendChild(n.getGui())},t.prototype.removeValueElements=function(e,t){this.removeComponents(this.eValuesFrom,e,t),this.removeComponents(this.eValuesTo,e,t)},t.prototype.mapValuesFromModel=function(e){var t=e||{},o=t.filter,n=t.filterTo,r=t.type;return[o||null,n||null].slice(0,this.getNumberOfInputs(r))},t.prototype.evaluateNullValue=function(e){var t=[li.NOT_EQUAL,li.NOT_CONTAINS,li.BLANK];return!!e&&t.indexOf(e)>=0},t.prototype.evaluateNonNullValue=function(e,t,o,n){var r=this,i=e.map((function(e){return r.formatter(e)}))||[],a=this.formatter(t),s=this.textFilterParams,l=s.api,c=s.colDef,d=s.column,u=s.columnApi,p=s.context,h=s.textFormatter;if(o.type===li.BLANK)return this.isBlank(t);if(o.type===li.NOT_BLANK)return!this.isBlank(t);var f={api:l,colDef:c,column:d,columnApi:u,context:p,node:n.node,data:n.data,filterOption:o.type,value:a,textFormatter:h};return i.some((function(e){return r.matcher(Li(Li({},f),{filterText:e}))}))},t.prototype.getModelAsString=function(e){var t;return null!==(t=this.filterModelFormatter.getModelAsString(e))&&void 0!==t?t:""},t.DEFAULT_FILTER_OPTIONS=[li.CONTAINS,li.NOT_CONTAINS,li.EQUALS,li.NOT_EQUAL,li.STARTS_WITH,li.ENDS_WITH,li.BLANK,li.NOT_BLANK],t.DEFAULT_FORMATTER=function(e){return e},t.DEFAULT_LOWERCASE_FORMATTER=function(e){return null==e?null:e.toString().toLowerCase()},t.DEFAULT_MATCHER=function(e){var o=e.filterOption,n=e.value,r=e.filterText;if(null==r)return!1;switch(o){case t.CONTAINS:return n.indexOf(r)>=0;case t.NOT_CONTAINS:return n.indexOf(r)<0;case t.EQUALS:return n===r;case t.NOT_EQUAL:return n!=r;case t.STARTS_WITH:return 0===n.indexOf(r);case t.ENDS_WITH:var i=n.lastIndexOf(r);return i>=0&&i===n.length-r.length;default:return!1}},t}(li),zi=function(){var e=function(t,o){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])},e(t,o)};return function(t,o){function n(){this.constructor=t}e(t,o),t.prototype=null===o?Object.create(o):(n.prototype=o.prototype,new n)}}(),Hi=function(e,t,o,n){var r,i=arguments.length,a=i<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,o):n;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)a=Reflect.decorate(e,t,o,n);else for(var s=e.length-1;s>=0;s--)(r=e[s])&&(a=(i<3?r(a):i>3?r(t,o,a):r(t,o))||a);return i>3&&a&&Object.defineProperty(t,o,a),a},Bi=function(e){function t(t){var o=e.call(this)||this;return o.params=t,o}return zi(t,e),t.prototype.setupGui=function(e){this.eFloatingFilterTextInput=this.createManagedBean(new ki(this.params.config)),this.eFloatingFilterTextInput.setInputAriaLabel(this.params.ariaLabel),e.appendChild(this.eFloatingFilterTextInput.getGui())},t.prototype.setEditable=function(e){this.eFloatingFilterTextInput.setDisabled(!e)},t.prototype.getValue=function(){return this.eFloatingFilterTextInput.getValue()},t.prototype.setValue=function(e,t){this.eFloatingFilterTextInput.setValue(e,t)},t.prototype.addValueChangedListener=function(e){var t=this.eFloatingFilterTextInput.getGui();this.addManagedListener(t,"input",e),this.addManagedListener(t,"keypress",e),this.addManagedListener(t,"keydown",e)},t}(Fe),Vi=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return zi(t,e),t.prototype.postConstruct=function(){this.setTemplate('\n            <div class="ag-floating-filter-input" role="presentation" ref="eFloatingFilterInputContainer"></div>\n        ')},t.prototype.getDefaultDebounceMs=function(){return 500},t.prototype.onParentModelChanged=function(e,t){this.isEventFromFloatingFilter(t)||this.isEventFromDataChange(t)||(this.setLastTypeFromModel(e),this.setEditable(this.canWeEditAfterModelFromParentFilter(e)),this.floatingFilterInputService.setValue(this.getFilterModelFormatter().getModelAsString(e)))},t.prototype.init=function(t){this.params=t;var o=this.columnModel.getDisplayNameForColumn(t.column,"header",!0)+" "+this.localeService.getLocaleTextFunc()("ariaFilterInput","Filter Input");if(this.floatingFilterInputService=this.createFloatingFilterInputService(o),this.floatingFilterInputService.setupGui(this.eFloatingFilterInputContainer),e.prototype.init.call(this,t),this.applyActive=Mr.isUseApplyButton(this.params.filterParams),!this.isReadOnly()){var n=Mr.getDebounceMs(this.params.filterParams,this.getDefaultDebounceMs()),r=I(this.syncUpWithParentFilter.bind(this),n);this.floatingFilterInputService.addValueChangedListener(r)}},t.prototype.syncUpWithParentFilter=function(e){var t=this,o=e.key===Hn.ENTER;if(!this.applyActive||o){var n=this.floatingFilterInputService.getValue();this.params.filterParams.trimInput&&(n=Gi.trimInput(n),this.floatingFilterInputService.setValue(n,!0)),this.params.parentFilterInstance((function(e){e&&e.onFloatingFilterChanged(t.getLastType()||null,n||null)}))}},t.prototype.setEditable=function(e){this.floatingFilterInputService.setEditable(e)},Hi([q("columnModel")],t.prototype,"columnModel",void 0),Hi([mr("eFloatingFilterInputContainer")],t.prototype,"eFloatingFilterInputContainer",void 0),Hi([$],t.prototype,"postConstruct",null),t}(vi),$i=function(){var e=function(t,o){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])},e(t,o)};return function(t,o){function n(){this.constructor=t}e(t,o),t.prototype=null===o?Object.create(o):(n.prototype=o.prototype,new n)}}(),Ui=function(e){function t(t){var o=e.call(this)||this;return o.params=t,o.numberInputActive=!0,o}return $i(t,e),t.prototype.setupGui=function(e){this.eFloatingFilterNumberInput=this.createManagedBean(new Ai),this.eFloatingFilterTextInput=this.createManagedBean(new ki),this.eFloatingFilterTextInput.setDisabled(!0),this.eFloatingFilterNumberInput.setInputAriaLabel(this.params.ariaLabel),this.eFloatingFilterTextInput.setInputAriaLabel(this.params.ariaLabel),e.appendChild(this.eFloatingFilterNumberInput.getGui()),e.appendChild(this.eFloatingFilterTextInput.getGui())},t.prototype.setEditable=function(e){this.numberInputActive=e,this.eFloatingFilterNumberInput.setDisplayed(this.numberInputActive),this.eFloatingFilterTextInput.setDisplayed(!this.numberInputActive)},t.prototype.getValue=function(){return this.getActiveInputElement().getValue()},t.prototype.setValue=function(e,t){this.getActiveInputElement().setValue(e,t)},t.prototype.getActiveInputElement=function(){return this.numberInputActive?this.eFloatingFilterNumberInput:this.eFloatingFilterTextInput},t.prototype.addValueChangedListener=function(e){this.setupListeners(this.eFloatingFilterNumberInput.getGui(),e),this.setupListeners(this.eFloatingFilterTextInput.getGui(),e)},t.prototype.setupListeners=function(e,t){this.addManagedListener(e,"input",t),this.addManagedListener(e,"keypress",t),this.addManagedListener(e,"keydown",t)},t}(Fe),Wi=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return $i(t,e),t.prototype.init=function(t){e.prototype.init.call(this,t),this.filterModelFormatter=new Oi(this.localeService,this.optionsFactory)},t.prototype.getDefaultFilterOptions=function(){return Ii.DEFAULT_FILTER_OPTIONS},t.prototype.getFilterModelFormatter=function(){return this.filterModelFormatter},t.prototype.createFloatingFilterInputService=function(e){var t=Ti(this.params.filterParams);return t?this.createManagedBean(new Bi({config:{allowedCharPattern:t},ariaLabel:e})):this.createManagedBean(new Ui({ariaLabel:e}))},t}(Vi),qi=function(){var e=function(t,o){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])},e(t,o)};return function(t,o){function n(){this.constructor=t}e(t,o),t.prototype=null===o?Object.create(o):(n.prototype=o.prototype,new n)}}(),Ki=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return qi(t,e),t.prototype.init=function(t){e.prototype.init.call(this,t),this.filterModelFormatter=new Fi(this.localeService,this.optionsFactory)},t.prototype.getDefaultFilterOptions=function(){return Gi.DEFAULT_FILTER_OPTIONS},t.prototype.getFilterModelFormatter=function(){return this.filterModelFormatter},t.prototype.createFloatingFilterInputService=function(e){return this.createManagedBean(new Bi({ariaLabel:e}))},t}(Vi),Yi=function(){function e(e,t){var o=this;void 0===t&&(t=!1),this.destroyFuncs=[],this.touching=!1,this.eventService=new te,this.eElement=e,this.preventMouseClick=t;var n=this.onTouchStart.bind(this),r=this.onTouchMove.bind(this),i=this.onTouchEnd.bind(this);this.eElement.addEventListener("touchstart",n,{passive:!0}),this.eElement.addEventListener("touchmove",r,{passive:!0}),this.eElement.addEventListener("touchend",i,{passive:!1}),this.destroyFuncs.push((function(){o.eElement.removeEventListener("touchstart",n,{passive:!0}),o.eElement.removeEventListener("touchmove",r,{passive:!0}),o.eElement.removeEventListener("touchend",i,{passive:!1})}))}return e.prototype.getActiveTouch=function(e){for(var t=0;t<e.length;t++){if(e[t].identifier===this.touchStart.identifier)return e[t]}return null},e.prototype.addEventListener=function(e,t){this.eventService.addEventListener(e,t)},e.prototype.removeEventListener=function(e,t){this.eventService.removeEventListener(e,t)},e.prototype.onTouchStart=function(t){var o=this;if(!this.touching){this.touchStart=t.touches[0],this.touching=!0,this.moved=!1;var n=this.touchStart;window.setTimeout((function(){var r=o.touchStart===n;if(o.touching&&r&&!o.moved){o.moved=!0;var i={type:e.EVENT_LONG_TAP,touchStart:o.touchStart,touchEvent:t};o.eventService.dispatchEvent(i)}}),500)}},e.prototype.onTouchMove=function(e){if(this.touching){var t=this.getActiveTouch(e.touches);if(t)!Kn(t,this.touchStart,4)&&(this.moved=!0)}},e.prototype.onTouchEnd=function(t){if(this.touching){if(!this.moved){var o={type:e.EVENT_TAP,touchStart:this.touchStart};this.eventService.dispatchEvent(o),this.checkForDoubleTap()}this.preventMouseClick&&t.cancelable&&t.preventDefault(),this.touching=!1}},e.prototype.checkForDoubleTap=function(){var t=(new Date).getTime();if(this.lastTapTime&&this.lastTapTime>0)if(t-this.lastTapTime>e.DOUBLE_TAP_MILLIS){var o={type:e.EVENT_DOUBLE_TAP,touchStart:this.touchStart};this.eventService.dispatchEvent(o),this.lastTapTime=null}else this.lastTapTime=t;else this.lastTapTime=t},e.prototype.destroy=function(){this.destroyFuncs.forEach((function(e){return e()}))},e.EVENT_TAP="tap",e.EVENT_DOUBLE_TAP="doubleTap",e.EVENT_LONG_TAP="longTap",e.DOUBLE_TAP_MILLIS=500,e}(),Ji=function(){var e=function(t,o){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])},e(t,o)};return function(t,o){function n(){this.constructor=t}e(t,o),t.prototype=null===o?Object.create(o):(n.prototype=o.prototype,new n)}}(),Xi=function(e,t,o,n){var r,i=arguments.length,a=i<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,o):n;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)a=Reflect.decorate(e,t,o,n);else for(var s=e.length-1;s>=0;s--)(r=e[s])&&(a=(i<3?r(a):i>3?r(t,o,a):r(t,o))||a);return i>3&&a&&Object.defineProperty(t,o,a),a},Qi=function(e){function t(o){var n=e.call(this)||this;return o||n.setTemplate(t.TEMPLATE),n}return Ji(t,e),t.prototype.attachCustomElements=function(e,t,o,n,r){this.eSortOrder=e,this.eSortAsc=t,this.eSortDesc=o,this.eSortMixed=n,this.eSortNone=r},t.prototype.setupSort=function(e,t){var o=this;void 0===t&&(t=!1),this.column=e,this.suppressOrder=t,this.setupMultiSortIndicator(),!!this.column.getColDef().sortable&&(this.addInIcon("sortAscending",this.eSortAsc,e),this.addInIcon("sortDescending",this.eSortDesc,e),this.addInIcon("sortUnSort",this.eSortNone,e),this.addManagedListener(this.eventService,$e.EVENT_SORT_CHANGED,(function(){return o.onSortChanged()})),this.addManagedListener(this.eventService,$e.EVENT_COLUMN_ROW_GROUP_CHANGED,(function(){return o.onSortChanged()})),this.onSortChanged())},t.prototype.addInIcon=function(e,t,o){if(null!=t){var n=Gn(e,this.gridOptionsService,o);n&&t.appendChild(n)}},t.prototype.onSortChanged=function(){this.updateIcons(),this.suppressOrder||this.updateSortOrder()},t.prototype.updateIcons=function(){var e=this.sortController.getDisplaySortForColumn(this.column);if(this.eSortAsc){var t="asc"===e;on(this.eSortAsc,t,{skipAriaHidden:!0})}if(this.eSortDesc){var o="desc"===e;on(this.eSortDesc,o,{skipAriaHidden:!0})}if(this.eSortNone){var n=!this.column.getColDef().unSortIcon&&!this.gridOptionsService.is("unSortIcon"),r=null===e||void 0===e;on(this.eSortNone,!n&&r,{skipAriaHidden:!0})}},t.prototype.setupMultiSortIndicator=function(){var e=this;this.addInIcon("sortUnSort",this.eSortMixed,this.column);var t=this.column.getColDef().showRowGroup;this.gridOptionsService.isColumnsSortingCoupledToGroup()&&t&&(this.addManagedListener(this.eventService,$e.EVENT_SORT_CHANGED,(function(){return e.updateMultiSortIndicator()})),this.addManagedListener(this.eventService,$e.EVENT_COLUMN_ROW_GROUP_CHANGED,(function(){return e.updateMultiSortIndicator()})),this.updateMultiSortIndicator())},t.prototype.updateMultiSortIndicator=function(){if(this.eSortMixed){var e="mixed"===this.sortController.getDisplaySortForColumn(this.column);on(this.eSortMixed,e,{skipAriaHidden:!0})}},t.prototype.updateSortOrder=function(){var e,t=this;if(this.eSortOrder){var o=this.sortController.getColumnsWithSortingOrdered(),n=null!==(e=this.sortController.getDisplaySortIndexForColumn(this.column))&&void 0!==e?e:-1,r=o.some((function(e){var o;return null!==(o=t.sortController.getDisplaySortIndexForColumn(e))&&void 0!==o&&o})),i=n>=0&&r;on(this.eSortOrder,i,{skipAriaHidden:!0}),n>=0?this.eSortOrder.innerHTML=(n+1).toString():gn(this.eSortOrder)}},t.TEMPLATE='<span class="ag-sort-indicator-container">\n            <span ref="eSortOrder" class="ag-sort-indicator-icon ag-sort-order ag-hidden" aria-hidden="true"></span>\n            <span ref="eSortAsc" class="ag-sort-indicator-icon ag-sort-ascending-icon ag-hidden" aria-hidden="true"></span>\n            <span ref="eSortDesc" class="ag-sort-indicator-icon ag-sort-descending-icon ag-hidden" aria-hidden="true"></span>\n            <span ref="eSortMixed" class="ag-sort-indicator-icon ag-sort-mixed-icon ag-hidden" aria-hidden="true"></span>\n            <span ref="eSortNone" class="ag-sort-indicator-icon ag-sort-none-icon ag-hidden" aria-hidden="true"></span>\n        </span>',Xi([mr("eSortOrder")],t.prototype,"eSortOrder",void 0),Xi([mr("eSortAsc")],t.prototype,"eSortAsc",void 0),Xi([mr("eSortDesc")],t.prototype,"eSortDesc",void 0),Xi([mr("eSortMixed")],t.prototype,"eSortMixed",void 0),Xi([mr("eSortNone")],t.prototype,"eSortNone",void 0),Xi([q("columnModel")],t.prototype,"columnModel",void 0),Xi([q("sortController")],t.prototype,"sortController",void 0),t}(fr),Zi=function(){var e=function(t,o){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])},e(t,o)};return function(t,o){function n(){this.constructor=t}e(t,o),t.prototype=null===o?Object.create(o):(n.prototype=o.prototype,new n)}}(),ea=function(e,t,o,n){var r,i=arguments.length,a=i<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,o):n;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)a=Reflect.decorate(e,t,o,n);else for(var s=e.length-1;s>=0;s--)(r=e[s])&&(a=(i<3?r(a):i>3?r(t,o,a):r(t,o))||a);return i>3&&a&&Object.defineProperty(t,o,a),a},ta=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.lastMovingChanged=0,t}return Zi(t,e),t.prototype.destroy=function(){e.prototype.destroy.call(this)},t.prototype.refresh=function(e){return this.params=e,this.workOutTemplate()==this.currentTemplate&&(this.workOutShowMenu()==this.currentShowMenu&&(this.workOutSort()==this.currentSort&&(this.setDisplayName(e),!0)))},t.prototype.workOutTemplate=function(){var e=he(this.params.template,t.TEMPLATE);return e=e&&e.trim?e.trim():e},t.prototype.init=function(e){this.params=e,this.currentTemplate=this.workOutTemplate(),this.setTemplate(this.currentTemplate),this.setupTap(),this.setupIcons(e.column),this.setMenu(),this.setupSort(),this.setupFilterIcon(),this.setDisplayName(e)},t.prototype.setDisplayName=function(e){if(this.currentDisplayName!=e.displayName){this.currentDisplayName=e.displayName;var t=vt(this.currentDisplayName);this.eText&&(this.eText.innerHTML=t)}},t.prototype.setupIcons=function(e){this.addInIcon("menu",this.eMenu,e),this.addInIcon("filter",this.eFilter,e)},t.prototype.addInIcon=function(e,t,o){if(null!=t){var n=Gn(e,this.gridOptionsService,o);n&&t.appendChild(n)}},t.prototype.setupTap=function(){var e=this,t=this.gridOptionsService;if(!t.is("suppressTouch")){var o=new Yi(this.getGui(),!0),n=t.is("suppressMenuHide"),i=n&&r(this.eMenu),a=i?new Yi(this.eMenu,!0):o;if(this.params.enableMenu){var s=i?"EVENT_TAP":"EVENT_LONG_TAP";this.addManagedListener(a,Yi[s],(function(o){t.api.showColumnMenuAfterMouseClick(e.params.column,o.touchStart)}))}if(this.params.enableSorting){this.addManagedListener(o,Yi.EVENT_TAP,(function(t){var o=t.touchStart.target;n&&e.eMenu.contains(o)||e.sortController.progressSort(e.params.column,!1,"uiColumnSorted")}))}this.addDestroyFunc((function(){return o.destroy()})),i&&this.addDestroyFunc((function(){return a.destroy()}))}},t.prototype.workOutShowMenu=function(){var e=!this.gridOptionsService.is("suppressMenuHide"),t=Oo()&&e;return this.params.enableMenu&&!t},t.prototype.setMenu=function(){var e=this;if(this.eMenu)if(this.currentShowMenu=this.workOutShowMenu(),this.currentShowMenu){var t=this.gridOptionsService.is("suppressMenuHide");this.addManagedListener(this.eMenu,"click",(function(){return e.showMenu(e.eMenu)})),this.eMenu.classList.toggle("ag-header-menu-always-show",t)}else mn(this.eMenu)},t.prototype.showMenu=function(e){e||(e=this.eMenu),this.menuFactory.showMenuAfterButtonClick(this.params.column,e,"columnMenu")},t.prototype.workOutSort=function(){return this.params.enableSorting},t.prototype.setupSort=function(){var e=this;if(this.currentSort=this.params.enableSorting,this.eSortIndicator||(this.eSortIndicator=this.context.createBean(new Qi(!0)),this.eSortIndicator.attachCustomElements(this.eSortOrder,this.eSortAsc,this.eSortDesc,this.eSortMixed,this.eSortNone)),this.eSortIndicator.setupSort(this.params.column),this.currentSort){var t="ctrl"===this.gridOptionsService.get("multiSortKey");this.addManagedListener(this.params.column,ce.EVENT_MOVING_CHANGED,(function(){e.lastMovingChanged=(new Date).getTime()})),this.eLabel&&this.addManagedListener(this.eLabel,"click",(function(o){var n=e.params.column.isMoving(),r=(new Date).getTime()-e.lastMovingChanged<50;if(!(n||r)){var i=t?o.ctrlKey||o.metaKey:o.shiftKey;e.params.progressSort(i)}}));var o=function(){if(e.addOrRemoveCssClass("ag-header-cell-sorted-asc",e.params.column.isSortAscending()),e.addOrRemoveCssClass("ag-header-cell-sorted-desc",e.params.column.isSortDescending()),e.addOrRemoveCssClass("ag-header-cell-sorted-none",e.params.column.isSortNone()),e.params.column.getColDef().showRowGroup){var t=e.columnModel.getSourceColumnsForGroupColumn(e.params.column),o=!(null===t||void 0===t?void 0:t.every((function(t){return e.params.column.getSort()==t.getSort()})));e.addOrRemoveCssClass("ag-header-cell-sorted-mixed",o)}};this.addManagedListener(this.eventService,$e.EVENT_SORT_CHANGED,o),this.addManagedListener(this.eventService,$e.EVENT_COLUMN_ROW_GROUP_CHANGED,o)}},t.prototype.setupFilterIcon=function(){this.eFilter&&(this.addManagedListener(this.params.column,ce.EVENT_FILTER_CHANGED,this.onFilterChanged.bind(this)),this.onFilterChanged())},t.prototype.onFilterChanged=function(){var e=this.params.column.isFilterActive();on(this.eFilter,e,{skipAriaHidden:!0})},t.TEMPLATE='<div class="ag-cell-label-container" role="presentation">\n            <span ref="eMenu" class="ag-header-icon ag-header-cell-menu-button" aria-hidden="true"></span>\n            <div ref="eLabel" class="ag-header-cell-label" role="presentation">\n                <span ref="eText" class="ag-header-cell-text"></span>\n                <span ref="eFilter" class="ag-header-icon ag-header-label-icon ag-filter-icon" aria-hidden="true"></span>\n                <ag-sort-indicator ref="eSortIndicator"></ag-sort-indicator>\n            </div>\n        </div>',ea([q("sortController")],t.prototype,"sortController",void 0),ea([q("menuFactory")],t.prototype,"menuFactory",void 0),ea([q("columnModel")],t.prototype,"columnModel",void 0),ea([mr("eFilter")],t.prototype,"eFilter",void 0),ea([mr("eSortIndicator")],t.prototype,"eSortIndicator",void 0),ea([mr("eMenu")],t.prototype,"eMenu",void 0),ea([mr("eLabel")],t.prototype,"eLabel",void 0),ea([mr("eText")],t.prototype,"eText",void 0),ea([mr("eSortOrder")],t.prototype,"eSortOrder",void 0),ea([mr("eSortAsc")],t.prototype,"eSortAsc",void 0),ea([mr("eSortDesc")],t.prototype,"eSortDesc",void 0),ea([mr("eSortMixed")],t.prototype,"eSortMixed",void 0),ea([mr("eSortNone")],t.prototype,"eSortNone",void 0),t}(fr),oa=function(){var e=function(t,o){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])},e(t,o)};return function(t,o){function n(){this.constructor=t}e(t,o),t.prototype=null===o?Object.create(o):(n.prototype=o.prototype,new n)}}(),na=function(e,t,o,n){var r,i=arguments.length,a=i<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,o):n;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)a=Reflect.decorate(e,t,o,n);else for(var s=e.length-1;s>=0;s--)(r=e[s])&&(a=(i<3?r(a):i>3?r(t,o,a):r(t,o))||a);return i>3&&a&&Object.defineProperty(t,o,a),a},ra=function(e){function t(){return e.call(this,t.TEMPLATE)||this}return oa(t,e),t.prototype.destroy=function(){e.prototype.destroy.call(this)},t.prototype.init=function(e){this.params=e,this.checkWarnings(),this.setupLabel(),this.addGroupExpandIcon(),this.setupExpandIcons()},t.prototype.checkWarnings=function(){if(this.params.template){j((function(){return console.warn("AG Grid: A template was provided for Header Group Comp - templates are only supported for Header Comps (not groups)")}),"HeaderGroupComp.templateNotSupported")}},t.prototype.setupExpandIcons=function(){var e=this;this.addInIcon("columnGroupOpened","agOpened"),this.addInIcon("columnGroupClosed","agClosed");var t=function(t){if(!Re(t)){var o=!e.params.columnGroup.isExpanded();e.columnModel.setColumnGroupOpened(e.params.columnGroup.getProvidedColumnGroup(),o,"uiColumnExpanded")}};this.addTouchAndClickListeners(this.eCloseIcon,t),this.addTouchAndClickListeners(this.eOpenIcon,t);var o=function(e){Ae(e)};this.addManagedListener(this.eCloseIcon,"dblclick",o),this.addManagedListener(this.eOpenIcon,"dblclick",o),this.addManagedListener(this.getGui(),"dblclick",t),this.updateIconVisibility();var n=this.params.columnGroup.getProvidedColumnGroup();this.addManagedListener(n,ue.EVENT_EXPANDED_CHANGED,this.updateIconVisibility.bind(this)),this.addManagedListener(n,ue.EVENT_EXPANDABLE_CHANGED,this.updateIconVisibility.bind(this))},t.prototype.addTouchAndClickListeners=function(e,t){var o=new Yi(e,!0);this.addManagedListener(o,Yi.EVENT_TAP,t),this.addDestroyFunc((function(){return o.destroy()})),this.addManagedListener(e,"click",t)},t.prototype.updateIconVisibility=function(){if(this.params.columnGroup.isExpandable()){var e=this.params.columnGroup.isExpanded();on(this.eOpenIcon,e),on(this.eCloseIcon,!e)}else on(this.eOpenIcon,!1),on(this.eCloseIcon,!1)},t.prototype.addInIcon=function(e,t){var o=Gn(e,this.gridOptionsService,null);o&&this.getRefElement(t).appendChild(o)},t.prototype.addGroupExpandIcon=function(){if(!this.params.columnGroup.isExpandable())return on(this.eOpenIcon,!1),void on(this.eCloseIcon,!1)},t.prototype.setupLabel=function(){var e,t=this.params,o=t.displayName,n=t.columnGroup;if(r(o)){var i=vt(o);this.getRefElement("agLabel").innerHTML=i}this.addOrRemoveCssClass("ag-sticky-label",!!(null===(e=n.getColGroupDef())||void 0===e?void 0:e.stickyLabel))},t.TEMPLATE='<div class="ag-header-group-cell-label" ref="agContainer" role="presentation">\n            <span ref="agLabel" class="ag-header-group-text" role="presentation"></span>\n            <span ref="agOpened" class="ag-header-icon ag-header-expand-icon ag-header-expand-icon-expanded"></span>\n            <span ref="agClosed" class="ag-header-icon ag-header-expand-icon ag-header-expand-icon-collapsed"></span>\n        </div>',na([q("columnModel")],t.prototype,"columnModel",void 0),na([mr("agOpened")],t.prototype,"eOpenIcon",void 0),na([mr("agClosed")],t.prototype,"eCloseIcon",void 0),t}(fr),ia=function(){var e=function(t,o){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])},e(t,o)};return function(t,o){function n(){this.constructor=t}e(t,o),t.prototype=null===o?Object.create(o):(n.prototype=o.prototype,new n)}}(),aa=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return ia(t,e),t.prototype.isPopup=function(){return!0},t.prototype.setParentComponent=function(t){t.addCssClass("ag-has-popup"),e.prototype.setParentComponent.call(this,t)},t.prototype.destroy=function(){var t=this.parentComponent;t&&t.isAlive()&&t.getGui().classList.remove("ag-has-popup"),e.prototype.destroy.call(this)},t}(fr),sa=function(){var e=function(t,o){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])},e(t,o)};return function(t,o){function n(){this.constructor=t}e(t,o),t.prototype=null===o?Object.create(o):(n.prototype=o.prototype,new n)}}(),la=function(e,t,o,n){var r,i=arguments.length,a=i<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,o):n;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)a=Reflect.decorate(e,t,o,n);else for(var s=e.length-1;s>=0;s--)(r=e[s])&&(a=(i<3?r(a):i>3?r(t,o,a):r(t,o))||a);return i>3&&a&&Object.defineProperty(t,o,a),a},ca=function(e){function t(){return e.call(this,t.TEMPLATE)||this}return sa(t,e),t.prototype.init=function(e){this.params=e,this.focusAfterAttached=e.cellStartedEdit,this.eTextArea.setMaxLength(e.maxLength||200).setCols(e.cols||60).setRows(e.rows||10),r(e.value,!0)&&this.eTextArea.setValue(e.value.toString(),!0),this.addGuiEventListener("keydown",this.onKeyDown.bind(this))},t.prototype.onKeyDown=function(e){var t=e.key;(t===Hn.LEFT||t===Hn.UP||t===Hn.RIGHT||t===Hn.DOWN||e.shiftKey&&t===Hn.ENTER)&&e.stopPropagation()},t.prototype.afterGuiAttached=function(){var e=this.localeService.getLocaleTextFunc();this.eTextArea.setInputAriaLabel(e("ariaInputEditor","Input Editor")),this.focusAfterAttached&&this.eTextArea.getFocusableElement().focus()},t.prototype.getValue=function(){return this.params.parseValue(this.eTextArea.getValue())},t.TEMPLATE='<div class="ag-large-text" tabindex="0">\n            <ag-input-text-area ref="eTextArea" class="ag-large-text-input"></ag-input-text-area>\n        </div>',la([mr("eTextArea")],t.prototype,"eTextArea",void 0),t}(aa),da=function(){var e=function(t,o){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])},e(t,o)};return function(t,o){function n(){this.constructor=t}e(t,o),t.prototype=null===o?Object.create(o):(n.prototype=o.prototype,new n)}}(),ua=function(e,t,o,n){var r,i=arguments.length,a=i<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,o):n;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)a=Reflect.decorate(e,t,o,n);else for(var s=e.length-1;s>=0;s--)(r=e[s])&&(a=(i<3?r(a):i>3?r(t,o,a):r(t,o))||a);return i>3&&a&&Object.defineProperty(t,o,a),a},pa=function(e){function t(){var t=e.call(this,'<div class="ag-cell-edit-wrapper"><ag-select class="ag-cell-editor" ref="eSelect"></ag-select></div>')||this;return t.startedByEnter=!1,t}return da(t,e),t.prototype.init=function(e){var t=this;if(this.focusAfterAttached=e.cellStartedEdit,i(e.values))console.warn("AG Grid: no values found for select cellEditor");else{this.startedByEnter=null!=e.eventKey&&e.eventKey===Hn.ENTER;var o=!1;e.values.forEach((function(n){var r={value:n},i=t.valueFormatterService.formatValue(e.column,null,n),a=null!==i&&void 0!==i;r.text=a?i:n,t.eSelect.addOption(r),o=o||e.value===n})),o?this.eSelect.setValue(e.value,!0):e.values.length&&this.eSelect.setValue(e.values[0],!0),"fullRow"!==this.gridOptionsService.get("editType")&&this.addManagedListener(this.eSelect,Jr.EVENT_ITEM_SELECTED,(function(){return e.stopEditing()}))}},t.prototype.afterGuiAttached=function(){this.focusAfterAttached&&this.eSelect.getFocusableElement().focus(),this.startedByEnter&&this.eSelect.showPicker()},t.prototype.focusIn=function(){this.eSelect.getFocusableElement().focus()},t.prototype.getValue=function(){return this.eSelect.getValue()},t.prototype.isPopup=function(){return!1},ua([q("valueFormatterService")],t.prototype,"valueFormatterService",void 0),ua([mr("eSelect")],t.prototype,"eSelect",void 0),t}(aa),ha=function(){var e=function(t,o){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])},e(t,o)};return function(t,o){function n(){this.constructor=t}e(t,o),t.prototype=null===o?Object.create(o):(n.prototype=o.prototype,new n)}}(),fa=function(e,t,o,n){var r,i=arguments.length,a=i<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,o):n;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)a=Reflect.decorate(e,t,o,n);else for(var s=e.length-1;s>=0;s--)(r=e[s])&&(a=(i<3?r(a):i>3?r(t,o,a):r(t,o))||a);return i>3&&a&&Object.defineProperty(t,o,a),a},ga=function(e){function t(){return e.call(this,t.TEMPLATE)||this}return ha(t,e),t.prototype.init=function(e){this.params=e;var t,o=this.eInput;e.cellStartedEdit?(this.focusAfterAttached=!0,e.eventKey===Hn.BACKSPACE||e.eventKey===Hn.DELETE?t="":e.charPress?t=e.charPress:(t=this.getStartValue(e),e.eventKey!==Hn.F2&&(this.highlightAllOnFocus=!0))):(this.focusAfterAttached=!1,t=this.getStartValue(e)),null!=t&&o.setValue(t,!0),null!=e.maxLength&&o.setMaxLength(e.maxLength),this.addManagedListener(o.getGui(),"keydown",(function(e){var t=e.key;t!==Hn.PAGE_UP&&t!==Hn.PAGE_DOWN||e.preventDefault()}))},t.prototype.afterGuiAttached=function(){var e=this.localeService.getLocaleTextFunc(),t=this.eInput;if(t.setInputAriaLabel(e("ariaInputEditor","Input Editor")),this.focusAfterAttached){Eo()||t.getFocusableElement().focus();var o=t.getInputElement();if(this.highlightAllOnFocus)o.select();else{var n=t.getValue(),i=r(n)&&n.length||0;i&&o.setSelectionRange(i,i)}}},t.prototype.focusIn=function(){var e=this.eInput,t=e.getFocusableElement(),o=e.getInputElement();t.focus(),o.select()},t.prototype.getValue=function(){var e=this.eInput;return this.params.parseValue(e.getValue())},t.prototype.getStartValue=function(e){return e.useFormatter||e.column.getColDef().refData?e.formatValue(e.value):e.value},t.prototype.isPopup=function(){return!1},t.TEMPLATE='<div class="ag-cell-edit-wrapper">\n            <ag-input-text-field class="ag-cell-editor" ref="eInput"></ag-input-text-field>\n        </div>',fa([mr("eInput")],t.prototype,"eInput",void 0),t}(aa),ma=function(){var e=function(t,o){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])},e(t,o)};return function(t,o){function n(){this.constructor=t}e(t,o),t.prototype=null===o?Object.create(o):(n.prototype=o.prototype,new n)}}(),ya=function(e,t,o,n){var r,i=arguments.length,a=i<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,o):n;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)a=Reflect.decorate(e,t,o,n);else for(var s=e.length-1;s>=0;s--)(r=e[s])&&(a=(i<3?r(a):i>3?r(t,o,a):r(t,o))||a);return i>3&&a&&Object.defineProperty(t,o,a),a},va=function(e){function t(){var o=e.call(this,t.TEMPLATE)||this;return o.refreshCount=0,o}return ma(t,e),t.prototype.init=function(e){this.eValue=this.queryForHtmlElement(".ag-value-change-value"),this.eDelta=this.queryForHtmlElement(".ag-value-change-delta"),this.refresh(e)},t.prototype.showDelta=function(e,t){var o=Math.abs(t),n=e.formatValue(o),i=r(n)?n:o,a=t>=0;this.eDelta.innerHTML=a?"\u2191"+i:"\u2193"+i,this.eDelta.classList.toggle("ag-value-change-delta-up",a),this.eDelta.classList.toggle("ag-value-change-delta-down",!a)},t.prototype.setTimerToRemoveDelta=function(){var e=this;this.refreshCount++;var t=this.refreshCount;window.setTimeout((function(){t===e.refreshCount&&e.hideDeltaValue()}),2e3)},t.prototype.hideDeltaValue=function(){this.eValue.classList.remove("ag-value-change-value-highlight"),gn(this.eDelta)},t.prototype.refresh=function(e){var t=e.value;if(t===this.lastValue)return!1;if(r(e.valueFormatted)?this.eValue.innerHTML=e.valueFormatted:r(e.value)?this.eValue.innerHTML=t:gn(this.eValue),this.filterManager.isSuppressFlashingCellsBecauseFiltering())return!1;if("number"===typeof t&&"number"===typeof this.lastValue){var o=t-this.lastValue;this.showDelta(e,o)}return this.lastValue&&this.eValue.classList.add("ag-value-change-value-highlight"),this.setTimerToRemoveDelta(),this.lastValue=t,!0},t.TEMPLATE='<span><span class="ag-value-change-delta"></span><span class="ag-value-change-value"></span></span>',ya([q("filterManager")],t.prototype,"filterManager",void 0),t}(fr),ba=function(){var e=function(t,o){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])},e(t,o)};return function(t,o){function n(){this.constructor=t}e(t,o),t.prototype=null===o?Object.create(o):(n.prototype=o.prototype,new n)}}(),xa=function(e,t,o,n){var r,i=arguments.length,a=i<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,o):n;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)a=Reflect.decorate(e,t,o,n);else for(var s=e.length-1;s>=0;s--)(r=e[s])&&(a=(i<3?r(a):i>3?r(t,o,a):r(t,o))||a);return i>3&&a&&Object.defineProperty(t,o,a),a},wa=function(e){function t(){var o=e.call(this,t.TEMPLATE)||this;return o.refreshCount=0,o.eCurrent=o.queryForHtmlElement(".ag-value-slide-current"),o}return ba(t,e),t.prototype.init=function(e){this.refresh(e)},t.prototype.addSlideAnimation=function(){var e=this;this.refreshCount++;var t=this.refreshCount;this.ePrevious&&this.getGui().removeChild(this.ePrevious),this.ePrevious=vn('<span class="ag-value-slide-previous ag-value-slide-out"></span>'),this.ePrevious.innerHTML=this.eCurrent.innerHTML,this.getGui().insertBefore(this.ePrevious,this.eCurrent),window.setTimeout((function(){t===e.refreshCount&&e.ePrevious.classList.add("ag-value-slide-out-end")}),50),window.setTimeout((function(){t===e.refreshCount&&(e.getGui().removeChild(e.ePrevious),e.ePrevious=null)}),3e3)},t.prototype.refresh=function(e){var t=e.value;return i(t)&&(t=""),t!==this.lastValue&&(!this.filterManager.isSuppressFlashingCellsBecauseFiltering()&&(this.addSlideAnimation(),this.lastValue=t,r(e.valueFormatted)?this.eCurrent.innerHTML=e.valueFormatted:r(e.value)?this.eCurrent.innerHTML=t:gn(this.eCurrent),!0))},t.TEMPLATE='<span>\n            <span class="ag-value-slide-current"></span>\n        </span>',xa([q("filterManager")],t.prototype,"filterManager",void 0),t}(fr),Ca=function(){return Ca=Object.assign||function(e){for(var t,o=1,n=arguments.length;o<n;o++)for(var r in t=arguments[o])Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e},Ca.apply(this,arguments)},_a=function(){function e(t){this.rowIndex=null,this.key=null,this.childrenMapped={},this.displayed=!1,this.rowTop=null,this.oldRowTop=null,this.selectable=!0,this.__objectId=e.OBJECT_ID_SEQUENCE++,this.__autoHeights={},this.alreadyRendered=!1,this.highlighted=null,this.hovered=!1,this.selected=!1,this.beans=t}return e.prototype.setData=function(e){this.setDataCommon(e,!1)},e.prototype.updateData=function(e){this.setDataCommon(e,!0)},e.prototype.setDataCommon=function(e,t){var o=this.data;this.data=e,this.beans.valueCache.onDataChanged(),this.updateDataOnDetailNode(),this.checkRowSelectable(),this.resetQuickFilterAggregateText();var n=this.createDataChangedEvent(e,o,t);this.dispatchLocalEvent(n)},e.prototype.updateDataOnDetailNode=function(){this.detailNode&&(this.detailNode.data=this.data)},e.prototype.createDataChangedEvent=function(t,o,n){return{type:e.EVENT_DATA_CHANGED,node:this,oldData:o,newData:t,update:n}},e.prototype.createLocalRowEvent=function(e){return{type:e,node:this}},e.prototype.getRowIndexString=function(){return"top"===this.rowPinned?"t-"+this.rowIndex:"bottom"===this.rowPinned?"b-"+this.rowIndex:this.rowIndex.toString()},e.prototype.createDaemonNode=function(){var t=new e(this.beans);return t.id=this.id,t.data=this.data,t.__daemon=!0,t.selected=this.selected,t.level=this.level,t},e.prototype.setDataAndId=function(e,t){var o=r(this.id)?this.createDaemonNode():null,n=this.data;this.data=e,this.updateDataOnDetailNode(),this.setId(t),this.beans.selectionService.syncInRowNode(this,o),this.checkRowSelectable();var i=this.createDataChangedEvent(e,n,!1);this.dispatchLocalEvent(i)},e.prototype.checkRowSelectable=function(){var e=this.beans.gridOptionsService.get("isRowSelectable");this.setRowSelectable(!e||e(this))},e.prototype.setRowSelectable=function(t){if(this.selectable!==t&&(this.selectable=t,this.eventService&&this.eventService.dispatchEvent(this.createLocalRowEvent(e.EVENT_SELECTABLE_CHANGED)),this.beans.gridOptionsService.is("groupSelectsChildren"))){var o=this.calculateSelectedFromChildren();this.setSelectedParams({newValue:null!==o&&void 0!==o&&o,source:"selectableChanged"})}},e.prototype.setId=function(t){var o=this.beans.gridOptionsService.getRowIdFunc();if(o)if(this.data){var n=this.getGroupKeys(!0);this.id=o({data:this.data,parentKeys:n.length>0?n:void 0,level:this.level}),null!==this.id&&"string"===typeof this.id&&this.id.startsWith(e.ID_PREFIX_ROW_GROUP)&&console.error("AG Grid: Row IDs cannot start with "+e.ID_PREFIX_ROW_GROUP+", this is a reserved prefix for AG Grid's row grouping feature."),null!==this.id&&"string"!==typeof this.id&&(this.id=""+this.id)}else this.id=void 0;else this.id=t},e.prototype.getGroupKeys=function(e){void 0===e&&(e=!1);var t=[],o=this;for(e&&(o=o.parent);o&&o.level>=0;)t.push(o.key),o=o.parent;return t.reverse(),t},e.prototype.isPixelInRange=function(e){return!(!r(this.rowTop)||!r(this.rowHeight))&&(e>=this.rowTop&&e<this.rowTop+this.rowHeight)},e.prototype.setFirstChild=function(t){this.firstChild!==t&&(this.firstChild=t,this.eventService&&this.eventService.dispatchEvent(this.createLocalRowEvent(e.EVENT_FIRST_CHILD_CHANGED)))},e.prototype.setLastChild=function(t){this.lastChild!==t&&(this.lastChild=t,this.eventService&&this.eventService.dispatchEvent(this.createLocalRowEvent(e.EVENT_LAST_CHILD_CHANGED)))},e.prototype.setChildIndex=function(t){this.childIndex!==t&&(this.childIndex=t,this.eventService&&this.eventService.dispatchEvent(this.createLocalRowEvent(e.EVENT_CHILD_INDEX_CHANGED)))},e.prototype.setRowTop=function(t){this.oldRowTop=this.rowTop,this.rowTop!==t&&(this.rowTop=t,this.eventService&&this.eventService.dispatchEvent(this.createLocalRowEvent(e.EVENT_TOP_CHANGED)),this.setDisplayed(null!==t))},e.prototype.clearRowTopAndRowIndex=function(){this.oldRowTop=null,this.setRowTop(null),this.setRowIndex(null)},e.prototype.setDisplayed=function(t){this.displayed!==t&&(this.displayed=t,this.eventService&&this.eventService.dispatchEvent(this.createLocalRowEvent(e.EVENT_DISPLAYED_CHANGED)))},e.prototype.setDragging=function(t){this.dragging!==t&&(this.dragging=t,this.eventService&&this.eventService.dispatchEvent(this.createLocalRowEvent(e.EVENT_DRAGGING_CHANGED)))},e.prototype.setHighlighted=function(t){t!==this.highlighted&&(this.highlighted=t,this.eventService&&this.eventService.dispatchEvent(this.createLocalRowEvent(e.EVENT_HIGHLIGHT_CHANGED)))},e.prototype.setHovered=function(e){this.hovered!==e&&(this.hovered=e)},e.prototype.isHovered=function(){return this.hovered},e.prototype.setAllChildrenCount=function(t){this.allChildrenCount!==t&&(this.allChildrenCount=t,this.eventService&&this.eventService.dispatchEvent(this.createLocalRowEvent(e.EVENT_ALL_CHILDREN_COUNT_CHANGED)))},e.prototype.setMaster=function(t){this.master!==t&&(this.master&&!t&&(this.expanded=!1),this.master=t,this.eventService&&this.eventService.dispatchEvent(this.createLocalRowEvent(e.EVENT_MASTER_CHANGED)))},e.prototype.setGroup=function(t){this.group!==t&&(this.group&&!t&&(this.expanded=!1),this.group=t,this.updateHasChildren(),this.eventService&&this.eventService.dispatchEvent(this.createLocalRowEvent(e.EVENT_GROUP_CHANGED)))},e.prototype.setRowHeight=function(t,o){void 0===o&&(o=!1),this.rowHeight=t,this.rowHeightEstimated=o,this.eventService&&this.eventService.dispatchEvent(this.createLocalRowEvent(e.EVENT_HEIGHT_CHANGED))},e.prototype.setRowAutoHeight=function(e,t){this.__autoHeights||(this.__autoHeights={}),this.__autoHeights[t.getId()]=e,null!=e&&(null==this.checkAutoHeightsDebounced&&(this.checkAutoHeightsDebounced=I(this.checkAutoHeights.bind(this),1)),this.checkAutoHeightsDebounced())},e.prototype.checkAutoHeights=function(){var e=this,t=!1,o=!0,n=0,r=this.__autoHeights;if(null!=r&&(this.beans.columnModel.getAllDisplayedAutoHeightCols().forEach((function(i){var a=r[i.getId()];if(null==a){if(!e.beans.columnModel.isColSpanActive())return void(t=!0);var s=[];switch(i.getPinned()){case"left":s=e.beans.columnModel.getDisplayedLeftColumnsForRow(e);break;case"right":s=e.beans.columnModel.getDisplayedRightColumnsForRow(e);break;case null:s=e.beans.columnModel.getViewportCenterColumnsForRow(e)}if(s.includes(i))return void(t=!0);a=-1}else o=!1;a>n&&(n=a)})),!t&&((o||n<10)&&(n=this.beans.gridOptionsService.getRowHeightForNode(this).height),n!=this.rowHeight))){this.setRowHeight(n);var i=this.beans.rowModel;i.onRowHeightChangedDebounced&&i.onRowHeightChangedDebounced()}},e.prototype.setRowIndex=function(t){this.rowIndex!==t&&(this.rowIndex=t,this.eventService&&this.eventService.dispatchEvent(this.createLocalRowEvent(e.EVENT_ROW_INDEX_CHANGED)))},e.prototype.setUiLevel=function(t){this.uiLevel!==t&&(this.uiLevel=t,this.eventService&&this.eventService.dispatchEvent(this.createLocalRowEvent(e.EVENT_UI_LEVEL_CHANGED)))},e.prototype.setExpanded=function(t,o){if(this.expanded!==t){this.expanded=t,this.eventService&&this.eventService.dispatchEvent(this.createLocalRowEvent(e.EVENT_EXPANDED_CHANGED));var n=Object.assign({},this.createGlobalRowEvent($e.EVENT_ROW_GROUP_OPENED),{expanded:t,event:o||null});this.beans.rowNodeEventThrottle.dispatchExpanded(n),this.beans.gridOptionsService.is("groupIncludeFooter")&&this.beans.rowRenderer.refreshCells({rowNodes:[this]})}},e.prototype.createGlobalRowEvent=function(e){return{type:e,node:this,data:this.data,rowIndex:this.rowIndex,rowPinned:this.rowPinned,context:this.beans.gridOptionsService.context,api:this.beans.gridOptionsService.api,columnApi:this.beans.gridOptionsService.columnApi}},e.prototype.dispatchLocalEvent=function(e){this.eventService&&this.eventService.dispatchEvent(e)},e.prototype.setDataValue=function(e,t,o){var n=this,r=function(){var t;return"string"!==typeof e?e:null!==(t=n.beans.columnModel.getGridColumn(e))&&void 0!==t?t:n.beans.columnModel.getPrimaryColumn(e)}(),i=this.getValueFromValueService(r);if(this.beans.gridOptionsService.is("readOnlyEdit"))return this.dispatchEventForSaveValueReadOnly(r,i,t,o),!1;var a=this.beans.valueService.setValue(this,r,t,o);return this.dispatchCellChangedEvent(r,t,i),this.checkRowSelectable(),a},e.prototype.getValueFromValueService=function(e){var t=this.leafGroup&&this.beans.columnModel.isPivotMode(),o=this.group&&this.expanded&&!this.footer&&!t,n=this.beans.gridOptionsService.is("groupIncludeFooter"),r=this.beans.gridOptionsService.is("groupSuppressBlankHeader"),i=o&&n&&!r;return this.beans.valueService.getValue(e,this,!1,i)},e.prototype.dispatchEventForSaveValueReadOnly=function(e,t,o,n){var r={type:$e.EVENT_CELL_EDIT_REQUEST,event:null,rowIndex:this.rowIndex,rowPinned:this.rowPinned,column:e,colDef:e.getColDef(),context:this.beans.gridOptionsService.context,api:this.beans.gridOptionsService.api,columnApi:this.beans.gridOptionsService.columnApi,data:this.data,node:this,oldValue:t,newValue:o,value:o,source:n};this.beans.eventService.dispatchEvent(r)},e.prototype.setGroupValue=function(e,t){var o=this.beans.columnModel.getGridColumn(e);i(this.groupData)&&(this.groupData={});var n=o.getColId(),r=this.groupData[n];r!==t&&(this.groupData[n]=t,this.dispatchCellChangedEvent(o,t,r))},e.prototype.setAggData=function(e){var t=this,o=b([this.aggData,e]),n=this.aggData;this.aggData=e,this.eventService&&o.forEach((function(e){var o=t.beans.columnModel.getGridColumn(e),r=t.aggData?t.aggData[e]:void 0,i=n?n[e]:void 0;t.dispatchCellChangedEvent(o,r,i)}))},e.prototype.updateHasChildren=function(){var t=this.group&&!this.footer||this.childrenAfterGroup&&this.childrenAfterGroup.length>0;if(this.beans.gridOptionsService.isRowModelType("serverSide")){var o=this.beans.gridOptionsService.isTreeData(),n=this.beans.gridOptionsService.get("isServerSideGroup");t=!this.stub&&!this.footer&&(o?!!n&&n(this.data):!!this.group)}t!==this.__hasChildren&&(this.__hasChildren=!!t,this.eventService&&this.eventService.dispatchEvent(this.createLocalRowEvent(e.EVENT_HAS_CHILDREN_CHANGED)))},e.prototype.hasChildren=function(){return null==this.__hasChildren&&this.updateHasChildren(),this.__hasChildren},e.prototype.isEmptyRowGroupNode=function(){return this.group&&a(this.childrenAfterGroup)},e.prototype.dispatchCellChangedEvent=function(t,o,n){var r={type:e.EVENT_CELL_CHANGED,node:this,column:t,newValue:o,oldValue:n};this.dispatchLocalEvent(r)},e.prototype.resetQuickFilterAggregateText=function(){this.quickFilterAggregateText=null},e.prototype.isExpandable=function(){return!!(this.hasChildren()&&!this.footer||this.master)},e.prototype.isSelected=function(){return this.footer?this.sibling.isSelected():this.selected},e.prototype.depthFirstSearch=function(e){this.childrenAfterGroup&&this.childrenAfterGroup.forEach((function(t){return t.depthFirstSearch(e)})),e(this)},e.prototype.calculateSelectedFromChildren=function(){var e,t=!1,o=!1,n=!1;if(!(null===(e=this.childrenAfterGroup)||void 0===e?void 0:e.length))return this.selectable?this.selected:null;for(var r=0;r<this.childrenAfterGroup.length;r++){var i=this.childrenAfterGroup[r],a=i.isSelected();if(!i.selectable){var s=i.calculateSelectedFromChildren();if(null===s)continue;a=s}switch(a){case!0:t=!0;break;case!1:o=!0;break;default:n=!0}}return n||t&&o?void 0:!!t||!o&&(this.selectable?this.selected:null)},e.prototype.setSelectedInitialValue=function(e){this.selected=e},e.prototype.selectThisNode=function(t,o,n){void 0===n&&(n="api");var r=!this.selectable&&t,i=this.selected===t;if(r||i)return!1;this.selected=t,this.eventService&&this.dispatchLocalEvent(this.createLocalRowEvent(e.EVENT_ROW_SELECTED));var a=Ca(Ca({},this.createGlobalRowEvent($e.EVENT_ROW_SELECTED)),{event:o||null,source:n});return this.beans.eventService.dispatchEvent(a),!0},e.prototype.setSelected=function(e,t,o,n){void 0===t&&(t=!1),void 0===o&&(o=!1),void 0===n&&(n="api"),this.setSelectedParams({newValue:e,clearSelection:t,suppressFinishActions:o,rangeSelect:!1,source:n})},e.prototype.setSelectedParams=function(e){return this.rowPinned?(console.warn("AG Grid: cannot select pinned rows"),0):void 0===this.id?(console.warn("AG Grid: cannot select node until id for node is known"),0):this.beans.selectionService.setNodeSelected(Ca(Ca({},e),{node:this.footer?this.sibling:this}))},e.prototype.isRowPinned=function(){return"top"===this.rowPinned||"bottom"===this.rowPinned},e.prototype.isParentOfNode=function(e){for(var t=this.parent;t;){if(t===e)return!0;t=t.parent}return!1},e.prototype.addEventListener=function(e,t){this.eventService||(this.eventService=new te),this.eventService.addEventListener(e,t)},e.prototype.removeEventListener=function(e,t){this.eventService&&(this.eventService.removeEventListener(e,t),this.eventService.noRegisteredListenersExist()&&(this.eventService=null))},e.prototype.onMouseEnter=function(){this.dispatchLocalEvent(this.createLocalRowEvent(e.EVENT_MOUSE_ENTER))},e.prototype.onMouseLeave=function(){this.dispatchLocalEvent(this.createLocalRowEvent(e.EVENT_MOUSE_LEAVE))},e.prototype.getFirstChildOfFirstChild=function(e){for(var t=this,o=!0,n=!1,i=null;o&&!n;){var a=t.parent;r(a)&&t.firstChild?a.rowGroupColumn===e&&(n=!0,i=a):o=!1,t=a}return n?i:null},e.prototype.isFullWidthCell=function(){var e=this.getIsFullWidthCellFunc();return!!e&&e({rowNode:this})},e.prototype.getIsFullWidthCellFunc=function(){var e=this.beans.gridOptionsService.getCallback("isFullWidthRow");if(e)return e;var t=this.beans.gridOptionsService.get("isFullWidthCell");return t?function(e){return t(e.rowNode)}:void 0},e.prototype.getRoute=function(){if(null!=this.key){for(var e=[],t=this;null!=t.key;)e.push(t.key),t=t.parent;return e.reverse()}},e.prototype.createFooter=function(){var t=this;if(!this.sibling){var o=new e(this.beans);Object.keys(this).forEach((function(e){o[e]=t[e]})),o.footer=!0,o.setRowTop(null),o.setRowIndex(null),o.oldRowTop=null,o.id="rowGroupFooter_"+this.id,o.sibling=this,this.sibling=o}},e.ID_PREFIX_ROW_GROUP="row-group-",e.ID_PREFIX_TOP_PINNED="t-",e.ID_PREFIX_BOTTOM_PINNED="b-",e.OBJECT_ID_SEQUENCE=0,e.EVENT_ROW_SELECTED="rowSelected",e.EVENT_DATA_CHANGED="dataChanged",e.EVENT_CELL_CHANGED="cellChanged",e.EVENT_ALL_CHILDREN_COUNT_CHANGED="allChildrenCountChanged",e.EVENT_MASTER_CHANGED="masterChanged",e.EVENT_GROUP_CHANGED="groupChanged",e.EVENT_MOUSE_ENTER="mouseEnter",e.EVENT_MOUSE_LEAVE="mouseLeave",e.EVENT_HEIGHT_CHANGED="heightChanged",e.EVENT_TOP_CHANGED="topChanged",e.EVENT_DISPLAYED_CHANGED="displayedChanged",e.EVENT_FIRST_CHILD_CHANGED="firstChildChanged",e.EVENT_LAST_CHILD_CHANGED="lastChildChanged",e.EVENT_CHILD_INDEX_CHANGED="childIndexChanged",e.EVENT_ROW_INDEX_CHANGED="rowIndexChanged",e.EVENT_EXPANDED_CHANGED="expandedChanged",e.EVENT_HAS_CHILDREN_CHANGED="hasChildrenChanged",e.EVENT_SELECTABLE_CHANGED="selectableChanged",e.EVENT_UI_LEVEL_CHANGED="uiLevelChanged",e.EVENT_HIGHLIGHT_CHANGED="rowHighlightChanged",e.EVENT_DRAGGING_CHANGED="draggingChanged",e}(),Sa=function(){var e=function(t,o){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])},e(t,o)};return function(t,o){function n(){this.constructor=t}e(t,o),t.prototype=null===o?Object.create(o):(n.prototype=o.prototype,new n)}}(),Ea=function(){return Ea=Object.assign||function(e){for(var t,o=1,n=arguments.length;o<n;o++)for(var r in t=arguments[o])Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e},Ea.apply(this,arguments)},ka=function(e,t,o,n){var r,i=arguments.length,a=i<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,o):n;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)a=Reflect.decorate(e,t,o,n);else for(var s=e.length-1;s>=0;s--)(r=e[s])&&(a=(i<3?r(a):i>3?r(t,o,a):r(t,o))||a);return i>3&&a&&Object.defineProperty(t,o,a),a},ja=function(e){function t(){return e.call(this,'\n            <div class="ag-selection-checkbox" role="presentation">\n                <ag-checkbox role="presentation" ref="eCheckbox"></ag-checkbox>\n            </div>')||this}return Sa(t,e),t.prototype.postConstruct=function(){this.eCheckbox.setPassive(!0)},t.prototype.getCheckboxId=function(){return this.eCheckbox.getInputElement().id},t.prototype.onDataChanged=function(){this.onSelectionChanged()},t.prototype.onSelectableChanged=function(){this.showOrHideSelect()},t.prototype.onSelectionChanged=function(){var e=this.localeService.getLocaleTextFunc(),t=this.rowNode.isSelected(),o=void 0===t?e("ariaIndeterminate","indeterminate"):!0===t?e("ariaChecked","checked"):e("ariaUnchecked","unchecked"),n=e("ariaRowToggleSelection","Press Space to toggle row selection");this.eCheckbox.setValue(t,!0),this.eCheckbox.setInputAriaLabel(n+" ("+o+")")},t.prototype.onCheckedClicked=function(e){var t=this.gridOptionsService.is("groupSelectsFiltered");return this.rowNode.setSelectedParams({newValue:!1,rangeSelect:e.shiftKey,groupSelectsFiltered:t,event:e,source:"checkboxSelected"})},t.prototype.onUncheckedClicked=function(e){var t=this.gridOptionsService.is("groupSelectsFiltered");return this.rowNode.setSelectedParams({newValue:!0,rangeSelect:e.shiftKey,groupSelectsFiltered:t,event:e,source:"checkboxSelected"})},t.prototype.init=function(e){var t=this;if(this.rowNode=e.rowNode,this.column=e.column,this.overrides=e.overrides,this.onSelectionChanged(),this.addManagedListener(this.eCheckbox.getInputElement(),"dblclick",(function(e){Ae(e)})),this.addManagedListener(this.eCheckbox.getInputElement(),"click",(function(e){Ae(e),t.eCheckbox.getValue()?t.onCheckedClicked(e):t.onUncheckedClicked(e||{})})),this.addManagedListener(this.rowNode,_a.EVENT_ROW_SELECTED,this.onSelectionChanged.bind(this)),this.addManagedListener(this.rowNode,_a.EVENT_DATA_CHANGED,this.onDataChanged.bind(this)),this.addManagedListener(this.rowNode,_a.EVENT_SELECTABLE_CHANGED,this.onSelectableChanged.bind(this)),this.gridOptionsService.get("isRowSelectable")||"function"===typeof this.getIsVisible()){var o=this.showOrHideSelect.bind(this);this.addManagedListener(this.eventService,$e.EVENT_DISPLAYED_COLUMNS_CHANGED,o),this.addManagedListener(this.rowNode,_a.EVENT_DATA_CHANGED,o),this.addManagedListener(this.rowNode,_a.EVENT_CELL_CHANGED,o),this.showOrHideSelect()}this.eCheckbox.getInputElement().setAttribute("tabindex","-1")},t.prototype.showOrHideSelect=function(){var e,t,o,n,r=this.rowNode.selectable,i=this.getIsVisible();if(r)if("function"===typeof i){var a=null===(e=this.overrides)||void 0===e?void 0:e.callbackParams,s=null===(t=this.column)||void 0===t?void 0:t.createColumnFunctionCallbackParams(this.rowNode);r=!!s&&i(Ea(Ea({},a),s))}else r=null!==i&&void 0!==i&&i;if(null===(o=this.column)||void 0===o?void 0:o.getColDef().showDisabledCheckboxes)return this.eCheckbox.setDisabled(!r),this.setVisible(!0),void this.setDisplayed(!0);(null===(n=this.overrides)||void 0===n?void 0:n.removeHidden)?this.setDisplayed(r):this.setVisible(r)},t.prototype.getIsVisible=function(){var e,t;return this.overrides?this.overrides.isVisible:null===(t=null===(e=this.column)||void 0===e?void 0:e.getColDef())||void 0===t?void 0:t.checkboxSelection},ka([mr("eCheckbox")],t.prototype,"eCheckbox",void 0),ka([$],t.prototype,"postConstruct",null),t}(fr),Aa=function(){var e=function(t,o){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])},e(t,o)};return function(t,o){function n(){this.constructor=t}e(t,o),t.prototype=null===o?Object.create(o):(n.prototype=o.prototype,new n)}}(),Ra=function(e,t,o,n){var r,i=arguments.length,a=i<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,o):n;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)a=Reflect.decorate(e,t,o,n);else for(var s=e.length-1;s>=0;s--)(r=e[s])&&(a=(i<3?r(a):i>3?r(t,o,a):r(t,o))||a);return i>3&&a&&Object.defineProperty(t,o,a),a},Oa=function(e){var t="function"===typeof Symbol&&Symbol.iterator,o=t&&e[t],n=0;if(o)return o.call(e);if(e&&"number"===typeof e.length)return{next:function(){return e&&n>=e.length&&(e=void 0),{value:e&&e[n++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")};!function(e){e[e.ToolPanel=0]="ToolPanel",e[e.HeaderCell=1]="HeaderCell",e[e.RowDrag=2]="RowDrag",e[e.ChartPanel=3]="ChartPanel"}(Di||(Di={})),function(e){e[e.Up=0]="Up",e[e.Down=1]="Down"}(Pi||(Pi={})),function(e){e[e.Left=0]="Left",e[e.Right=1]="Right"}(Ni||(Ni={}));var Ta,Da=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.dragSourceAndParamsList=[],t.dropTargets=[],t}var o;return Aa(t,e),o=t,t.prototype.init=function(){this.ePinnedIcon=Fn("columnMovePin",this.gridOptionsService,null),this.eHideIcon=Fn("columnMoveHide",this.gridOptionsService,null),this.eMoveIcon=Fn("columnMoveMove",this.gridOptionsService,null),this.eLeftIcon=Fn("columnMoveLeft",this.gridOptionsService,null),this.eRightIcon=Fn("columnMoveRight",this.gridOptionsService,null),this.eGroupIcon=Fn("columnMoveGroup",this.gridOptionsService,null),this.eAggregateIcon=Fn("columnMoveValue",this.gridOptionsService,null),this.ePivotIcon=Fn("columnMovePivot",this.gridOptionsService,null),this.eDropNotAllowedIcon=Fn("dropNotAllowed",this.gridOptionsService,null)},t.prototype.addDragSource=function(e,t){void 0===t&&(t=!1);var o={eElement:e.eElement,dragStartPixels:e.dragStartPixels,onDragStart:this.onDragStart.bind(this,e),onDragStop:this.onDragStop.bind(this),onDragging:this.onDragging.bind(this)};this.dragSourceAndParamsList.push({params:o,dragSource:e}),this.dragService.addDragSource(o,t)},t.prototype.removeDragSource=function(e){var t=this.dragSourceAndParamsList.find((function(t){return t.dragSource===e}));t&&(this.dragService.removeDragSource(t.params),ye(this.dragSourceAndParamsList,t))},t.prototype.clearDragSourceParamsList=function(){var e=this;this.dragSourceAndParamsList.forEach((function(t){return e.dragService.removeDragSource(t.params)})),this.dragSourceAndParamsList.length=0,this.dropTargets.length=0},t.prototype.nudge=function(){this.dragging&&this.onDragging(this.eventLastTime,!0)},t.prototype.onDragStart=function(e,t){this.dragging=!0,this.dragSource=e,this.eventLastTime=t,this.dragItem=this.dragSource.getDragItem(),this.lastDropTarget=this.dragSource.dragSourceDropTarget,this.dragSource.onDragStarted&&this.dragSource.onDragStarted(),this.createGhost()},t.prototype.onDragStop=function(e){if(this.eventLastTime=null,this.dragging=!1,this.dragSource.onDragStopped&&this.dragSource.onDragStopped(),this.lastDropTarget&&this.lastDropTarget.onDragStop){var t=this.createDropTargetEvent(this.lastDropTarget,e,null,null,!1);this.lastDropTarget.onDragStop(t)}this.lastDropTarget=null,this.dragItem=null,this.removeGhost()},t.prototype.onDragging=function(e,t){var o,n,r,i,a=this,s=this.getHorizontalDirection(e),l=this.getVerticalDirection(e);this.eventLastTime=e,this.positionGhost(e);var c=this.dropTargets.filter((function(t){return a.isMouseOnDropTarget(e,t)})),d=this.findCurrentDropTarget(e,c);if(d!==this.lastDropTarget)this.leaveLastTargetIfExists(e,s,l,t),null!==this.lastDropTarget&&null===d&&(null===(n=(o=this.dragSource).onGridExit)||void 0===n||n.call(o,this.dragItem)),null===this.lastDropTarget&&null!==d&&(null===(i=(r=this.dragSource).onGridEnter)||void 0===i||i.call(r,this.dragItem)),this.enterDragTargetIfExists(d,e,s,l,t),this.lastDropTarget=d;else if(d&&d.onDragging){var u=this.createDropTargetEvent(d,e,s,l,t);d.onDragging(u)}},t.prototype.getAllContainersFromDropTarget=function(e){var t=e.getSecondaryContainers?e.getSecondaryContainers():null,o=[[e.getContainer()]];return t?o.concat(t):o},t.prototype.allContainersIntersect=function(e,t){var o,n;try{for(var r=Oa(t),i=r.next();!i.done;i=r.next()){var a=i.value.getBoundingClientRect();if(0===a.width||0===a.height)return!1;var s=e.clientX>=a.left&&e.clientX<a.right,l=e.clientY>=a.top&&e.clientY<a.bottom;if(!s||!l)return!1}}catch(c){o={error:c}}finally{try{i&&!i.done&&(n=r.return)&&n.call(r)}finally{if(o)throw o.error}}return!0},t.prototype.isMouseOnDropTarget=function(e,t){var o,n,r=this.getAllContainersFromDropTarget(t),i=!1;try{for(var a=Oa(r),s=a.next();!s.done;s=a.next()){var l=s.value;if(this.allContainersIntersect(e,l)){i=!0;break}}}catch(c){o={error:c}}finally{try{s&&!s.done&&(n=a.return)&&n.call(a)}finally{if(o)throw o.error}}return!(t.targetContainsSource&&!t.getContainer().contains(this.dragSource.eElement))&&(i&&t.isInterestedIn(this.dragSource.type,this.dragSource.eElement))},t.prototype.findCurrentDropTarget=function(e,t){var o,n,r,i,a=t.length;if(0===a)return null;if(1===a)return t[0];var s=this.gridOptionsService.getRootNode().elementsFromPoint(e.clientX,e.clientY);try{for(var l=Oa(s),c=l.next();!c.done;c=l.next()){var d=c.value;try{for(var u=(r=void 0,Oa(t)),p=u.next();!p.done;p=u.next()){var h=p.value;if(-1!==Ce(this.getAllContainersFromDropTarget(h)).indexOf(d))return h}}catch(f){r={error:f}}finally{try{p&&!p.done&&(i=u.return)&&i.call(u)}finally{if(r)throw r.error}}}}catch(g){o={error:g}}finally{try{c&&!c.done&&(n=l.return)&&n.call(l)}finally{if(o)throw o.error}}return null},t.prototype.enterDragTargetIfExists=function(e,t,o,n,r){if(e){if(e.onDragEnter){var i=this.createDropTargetEvent(e,t,o,n,r);e.onDragEnter(i)}this.setGhostIcon(e.getIconName?e.getIconName():null)}},t.prototype.leaveLastTargetIfExists=function(e,t,o,n){if(this.lastDropTarget){if(this.lastDropTarget.onDragLeave){var r=this.createDropTargetEvent(this.lastDropTarget,e,t,o,n);this.lastDropTarget.onDragLeave(r)}this.setGhostIcon(null)}},t.prototype.addDropTarget=function(e){this.dropTargets.push(e)},t.prototype.removeDropTarget=function(e){this.dropTargets=this.dropTargets.filter((function(t){return t.getContainer()!==e.getContainer()}))},t.prototype.hasExternalDropZones=function(){return this.dropTargets.some((function(e){return e.external}))},t.prototype.findExternalZone=function(e){return this.dropTargets.filter((function(e){return e.external})).find((function(t){return t.getContainer()===e.getContainer()}))||null},t.prototype.getHorizontalDirection=function(e){var t=this.eventLastTime&&this.eventLastTime.clientX,o=e.clientX;return t===o?null:t>o?Ni.Left:Ni.Right},t.prototype.getVerticalDirection=function(e){var t=this.eventLastTime&&this.eventLastTime.clientY,o=e.clientY;return t===o?null:t>o?Pi.Up:Pi.Down},t.prototype.createDropTargetEvent=function(e,t,o,n,r){var i=e.getContainer(),a=i.getBoundingClientRect(),s=this,l=s.gridApi,c=s.columnApi,d=s.dragItem,u=s.dragSource;return{event:t,x:t.clientX-a.left,y:t.clientY-a.top,vDirection:n,hDirection:o,dragSource:u,fromNudge:r,dragItem:d,api:l,columnApi:c,dropZoneTarget:i}},t.prototype.positionGhost=function(e){var t=this.eGhost;if(t){var o=t.getBoundingClientRect().height,n=No()-2,r=Io()-2,i=e.pageY-o/2,a=e.pageX-10,s=this.gridOptionsService.getDocument(),l=s.defaultView||window,c=l.pageYOffset||s.documentElement.scrollTop,d=l.pageXOffset||s.documentElement.scrollLeft;n>0&&a+t.clientWidth>n+d&&(a=n+d-t.clientWidth),a<0&&(a=0),r>0&&i+t.clientHeight>r+c&&(i=r+c-t.clientHeight),i<0&&(i=0),t.style.left=a+"px",t.style.top=i+"px"}},t.prototype.removeGhost=function(){this.eGhost&&this.eGhostParent&&this.eGhostParent.removeChild(this.eGhost),this.eGhost=null},t.prototype.createGhost=function(){this.eGhost=vn(o.GHOST_TEMPLATE),this.mouseEventService.stampTopLevelGridCompWithGridInstance(this.eGhost);var e=this.environment.getTheme().theme;e&&this.eGhost.classList.add(e),this.eGhostIcon=this.eGhost.querySelector(".ag-dnd-ghost-icon"),this.setGhostIcon(null);var t=this.eGhost.querySelector(".ag-dnd-ghost-label"),n=this.dragSource.dragItemName;R(n)&&(n=n()),t.innerHTML=vt(n)||"",this.eGhost.style.height="25px",this.eGhost.style.top="20px",this.eGhost.style.left="20px";var r=this.gridOptionsService.getDocument(),i=null;try{i=r.fullscreenElement}catch(l){}finally{if(!i){var a=this.gridOptionsService.getRootNode(),s=a.querySelector("body");i=s||(a instanceof ShadowRoot?a:null===a||void 0===a?void 0:a.documentElement)}}this.eGhostParent=i,this.eGhostParent?this.eGhostParent.appendChild(this.eGhost):console.warn("AG Grid: could not find document body, it is needed for dragging columns")},t.prototype.setGhostIcon=function(e,t){void 0===t&&(t=!1),gn(this.eGhostIcon);var n=null;switch(e||(e=this.dragSource.defaultIconName||o.ICON_NOT_ALLOWED),e){case o.ICON_PINNED:n=this.ePinnedIcon;break;case o.ICON_MOVE:n=this.eMoveIcon;break;case o.ICON_LEFT:n=this.eLeftIcon;break;case o.ICON_RIGHT:n=this.eRightIcon;break;case o.ICON_GROUP:n=this.eGroupIcon;break;case o.ICON_AGGREGATE:n=this.eAggregateIcon;break;case o.ICON_PIVOT:n=this.ePivotIcon;break;case o.ICON_NOT_ALLOWED:n=this.eDropNotAllowedIcon;break;case o.ICON_HIDE:n=this.eHideIcon}this.eGhostIcon.classList.toggle("ag-shake-left-to-right",t),n===this.eHideIcon&&this.gridOptionsService.is("suppressDragLeaveHidesColumns")||n&&this.eGhostIcon.appendChild(n)},t.ICON_PINNED="pinned",t.ICON_MOVE="move",t.ICON_LEFT="left",t.ICON_RIGHT="right",t.ICON_GROUP="group",t.ICON_AGGREGATE="aggregate",t.ICON_PIVOT="pivot",t.ICON_NOT_ALLOWED="notAllowed",t.ICON_HIDE="hide",t.GHOST_TEMPLATE='<div class="ag-dnd-ghost ag-unselectable">\n            <span class="ag-dnd-ghost-icon ag-shake-left-to-right"></span>\n            <div class="ag-dnd-ghost-label"></div>\n        </div>',Ra([q("dragService")],t.prototype,"dragService",void 0),Ra([q("mouseEventService")],t.prototype,"mouseEventService",void 0),Ra([q("columnApi")],t.prototype,"columnApi",void 0),Ra([q("gridApi")],t.prototype,"gridApi",void 0),Ra([$],t.prototype,"init",null),Ra([U],t.prototype,"clearDragSourceParamsList",null),t=o=Ra([W("dragAndDropService")],t)}(Fe),Pa=function(){var e=function(t,o){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])},e(t,o)};return function(t,o){function n(){this.constructor=t}e(t,o),t.prototype=null===o?Object.create(o):(n.prototype=o.prototype,new n)}}(),Na=function(e,t,o,n){var r,i=arguments.length,a=i<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,o):n;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)a=Reflect.decorate(e,t,o,n);else for(var s=e.length-1;s>=0;s--)(r=e[s])&&(a=(i<3?r(a):i>3?r(t,o,a):r(t,o))||a);return i>3&&a&&Object.defineProperty(t,o,a),a},Ia=function(e){function t(t,o,n,r,i,a){var s=e.call(this)||this;return s.cellValueFn=t,s.rowNode=o,s.column=n,s.customGui=r,s.dragStartPixels=i,s.suppressVisibilityChange=a,s.dragSource=null,s}return Pa(t,e),t.prototype.isCustomGui=function(){return null!=this.customGui},t.prototype.postConstruct=function(){if(this.customGui?this.setDragElement(this.customGui,this.dragStartPixels):(this.setTemplate('<div class="ag-drag-handle ag-row-drag" aria-hidden="true"></div>'),this.getGui().appendChild(Gn("rowDrag",this.beans.gridOptionsService,null)),this.addDragSource()),this.checkCompatibility(),!this.suppressVisibilityChange){var e=this.beans.gridOptionsService.is("rowDragManaged")?new Fa(this,this.beans,this.rowNode,this.column):new La(this,this.beans,this.rowNode,this.column);this.createManagedBean(e,this.beans.context)}},t.prototype.setDragElement=function(e,t){this.setTemplateFromElement(e),this.addDragSource(t)},t.prototype.getSelectedNodes=function(){if(!this.beans.gridOptionsService.is("rowDragMultiRow"))return[this.rowNode];var e=this.beans.selectionService.getSelectedNodes();return-1!==e.indexOf(this.rowNode)?e:[this.rowNode]},t.prototype.checkCompatibility=function(){var e=this.beans.gridOptionsService.is("rowDragManaged");this.beans.gridOptionsService.isTreeData()&&e&&j((function(){return console.warn("AG Grid: If using row drag with tree data, you cannot have rowDragManaged=true")}),"RowDragComp.managedAndTreeData")},t.prototype.getDragItem=function(){return{rowNode:this.rowNode,rowNodes:this.getSelectedNodes(),columns:this.column?[this.column]:void 0,defaultTextValue:this.cellValueFn()}},t.prototype.getRowDragText=function(e){if(e){var t=e.getColDef();if(t.rowDragText)return t.rowDragText}return this.gridOptionsService.get("rowDragText")},t.prototype.addDragSource=function(e){var t=this;void 0===e&&(e=4),this.dragSource&&this.removeDragSource();var o=this.getRowDragText(this.column),n=this.localeService.getLocaleTextFunc();this.dragSource={type:Di.RowDrag,eElement:this.getGui(),dragItemName:function(){var e,r=t.getDragItem(),i=(null===(e=r.rowNodes)||void 0===e?void 0:e.length)||1;return o?o(r,i):1===i?t.cellValueFn():i+" "+n("rowDragRows","rows")},getDragItem:function(){return t.getDragItem()},dragStartPixels:e,dragSourceDomDataKey:this.beans.gridOptionsService.getDomDataKey()},this.beans.dragAndDropService.addDragSource(this.dragSource,!0)},t.prototype.removeDragSource=function(){this.dragSource&&this.beans.dragAndDropService.removeDragSource(this.dragSource),this.dragSource=null},Na([q("beans")],t.prototype,"beans",void 0),Na([$],t.prototype,"postConstruct",null),Na([U],t.prototype,"removeDragSource",null),t}(fr),Ma=function(e){function t(t,o,n){var r=e.call(this)||this;return r.parent=t,r.rowNode=o,r.column=n,r}return Pa(t,e),t.prototype.setDisplayedOrVisible=function(e){var t={skipAriaHidden:!0};if(e)this.parent.setDisplayed(!1,t);else{var o=!0,n=!1;this.column&&(o=this.column.isRowDrag(this.rowNode)||this.parent.isCustomGui(),n=R(this.column.getColDef().rowDrag)),n?(this.parent.setDisplayed(!0,t),this.parent.setVisible(o,t)):(this.parent.setDisplayed(o,t),this.parent.setVisible(!0,t))}},t}(Fe),La=function(e){function t(t,o,n,r){var i=e.call(this,t,n,r)||this;return i.beans=o,i}return Pa(t,e),t.prototype.postConstruct=function(){this.addManagedPropertyListener("suppressRowDrag",this.onSuppressRowDrag.bind(this)),this.addManagedListener(this.rowNode,_a.EVENT_DATA_CHANGED,this.workOutVisibility.bind(this)),this.addManagedListener(this.rowNode,_a.EVENT_CELL_CHANGED,this.workOutVisibility.bind(this)),this.addManagedListener(this.rowNode,_a.EVENT_CELL_CHANGED,this.workOutVisibility.bind(this)),this.addManagedListener(this.beans.eventService,$e.EVENT_NEW_COLUMNS_LOADED,this.workOutVisibility.bind(this)),this.workOutVisibility()},t.prototype.onSuppressRowDrag=function(){this.workOutVisibility()},t.prototype.workOutVisibility=function(){var e=this.beans.gridOptionsService.is("suppressRowDrag");this.setDisplayedOrVisible(e)},Na([$],t.prototype,"postConstruct",null),t}(Ma),Fa=function(e){function t(t,o,n,r){var i=e.call(this,t,n,r)||this;return i.beans=o,i}return Pa(t,e),t.prototype.postConstruct=function(){this.addManagedListener(this.beans.eventService,$e.EVENT_SORT_CHANGED,this.workOutVisibility.bind(this)),this.addManagedListener(this.beans.eventService,$e.EVENT_FILTER_CHANGED,this.workOutVisibility.bind(this)),this.addManagedListener(this.beans.eventService,$e.EVENT_COLUMN_ROW_GROUP_CHANGED,this.workOutVisibility.bind(this)),this.addManagedListener(this.beans.eventService,$e.EVENT_NEW_COLUMNS_LOADED,this.workOutVisibility.bind(this)),this.addManagedListener(this.rowNode,_a.EVENT_DATA_CHANGED,this.workOutVisibility.bind(this)),this.addManagedListener(this.rowNode,_a.EVENT_CELL_CHANGED,this.workOutVisibility.bind(this)),this.addManagedPropertyListener("suppressRowDrag",this.onSuppressRowDrag.bind(this)),this.workOutVisibility()},t.prototype.onSuppressRowDrag=function(){this.workOutVisibility()},t.prototype.workOutVisibility=function(){var e=this.beans.ctrlsService.getGridBodyCtrl().getRowDragFeature(),t=e&&e.shouldPreventRowMove(),o=this.beans.gridOptionsService.is("suppressRowDrag"),n=this.beans.dragAndDropService.hasExternalDropZones(),r=t&&!n||o;this.setDisplayedOrVisible(r)},Na([$],t.prototype,"postConstruct",null),t}(Ma),Ga=function(){var e=function(t,o){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])},e(t,o)};return function(t,o){function n(){this.constructor=t}e(t,o),t.prototype=null===o?Object.create(o):(n.prototype=o.prototype,new n)}}(),za=function(){return za=Object.assign||function(e){for(var t,o=1,n=arguments.length;o<n;o++)for(var r in t=arguments[o])Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e},za.apply(this,arguments)},Ha=function(e,t,o,n){var r,i=arguments.length,a=i<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,o):n;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)a=Reflect.decorate(e,t,o,n);else for(var s=e.length-1;s>=0;s--)(r=e[s])&&(a=(i<3?r(a):i>3?r(t,o,a):r(t,o))||a);return i>3&&a&&Object.defineProperty(t,o,a),a},Ba=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Ga(t,e),t.prototype.init=function(e,t,o,n,r,i,a){this.params=a,this.eGui=t,this.eCheckbox=o,this.eExpanded=n,this.eContracted=r,this.comp=e,this.compClass=i;var s=this.isTopLevelFooter(),l=this.isEmbeddedRowMismatch(),c=null==a.value&&!a.node.master,d=!1;if(this.gridOptionsService.is("groupIncludeFooter")&&this.gridOptionsService.is("groupHideOpenParents")){var u=a.node;if(u.footer)d=(a.colDef&&a.colDef.showRowGroup)!==(u.rowGroupColumn&&u.rowGroupColumn.getColId())}this.cellIsBlank=!s&&(l||c&&!a.node.master||d),this.cellIsBlank||(this.setupShowingValueForOpenedParent(),this.findDisplayedGroupNode(),this.addFullWidthRowDraggerIfNeeded(),this.addExpandAndContract(),this.addCheckboxIfNeeded(),this.addValueElement(),this.setupIndent(),this.refreshAriaExpanded())},t.prototype.destroy=function(){e.prototype.destroy.call(this),this.expandListener=null},t.prototype.refreshAriaExpanded=function(){var e=this.params,t=e.node,o=e.eParentOfValue;if(this.expandListener&&(this.expandListener=this.expandListener()),this.isExpandable()){var n=function(){to(o,!!t.expanded)};this.expandListener=this.addManagedListener(t,_a.EVENT_EXPANDED_CHANGED,n)||null,n()}else oo(o)},t.prototype.isTopLevelFooter=function(){if(!this.gridOptionsService.is("groupIncludeTotalFooter"))return!1;if(null!=this.params.value||-1!=this.params.node.level)return!1;var e=this.params.colDef;if(null==e)return!0;if(!0===e.showRowGroup)return!0;var t=this.columnModel.getRowGroupColumns();return!t||0===t.length||t[0].getId()===e.showRowGroup},t.prototype.isEmbeddedRowMismatch=function(){if(!this.params.fullWidth||!this.gridOptionsService.is("embedFullWidthRows"))return!1;var e="left"===this.params.pinned,t="right"===this.params.pinned,o=!e&&!t;return this.gridOptionsService.is("enableRtl")?this.columnModel.isPinningLeft()?!t:!o:this.columnModel.isPinningLeft()?!e:!o},t.prototype.findDisplayedGroupNode=function(){var e=this.params.column,t=this.params.node;if(this.showingValueForOpenedParent)for(var o=t.parent;null!=o;){if(o.rowGroupColumn&&e.isRowGroupDisplayed(o.rowGroupColumn.getId())){this.displayedGroupNode=o;break}o=o.parent}i(this.displayedGroupNode)&&(this.displayedGroupNode=t)},t.prototype.setupShowingValueForOpenedParent=function(){var e=this.params.node,t=this.params.column;if(this.gridOptionsService.is("groupHideOpenParents"))if(e.groupData){if(null!=e.rowGroupColumn){var o=e.rowGroupColumn.getId();if(t.isRowGroupDisplayed(o))return void(this.showingValueForOpenedParent=!1)}var n=null!=e.groupData[t.getId()];this.showingValueForOpenedParent=n}else this.showingValueForOpenedParent=!1;else this.showingValueForOpenedParent=!1},t.prototype.addValueElement=function(){this.displayedGroupNode.footer?this.addFooterValue():(this.addGroupValue(),this.addChildCount())},t.prototype.addGroupValue=function(){var e=this.adjustParamsWithDetailsFromRelatedColumn(),t=this.getInnerCompDetails(e),o=e.valueFormatted,n=e.value,r=o;null==r&&(r=""===n&&this.params.node.group?this.localeService.getLocaleTextFunc()("blanks","(Blanks)"):null!==n&&void 0!==n?n:null);this.comp.setInnerRenderer(t,r)},t.prototype.adjustParamsWithDetailsFromRelatedColumn=function(){var e=this.displayedGroupNode.rowGroupColumn,t=this.params.column;if(!e)return this.params;if(null!=t&&!t.isRowGroupDisplayed(e.getId()))return this.params;var o=this.params,n=this.params,r=n.value,i=n.node,a=this.valueFormatterService.formatValue(e,i,r);return za(za({},o),{valueFormatted:a})},t.prototype.addFooterValue=function(){var e=this.params.footerValueGetter,t="";if(e){var o=f(this.params);o.value=this.params.value,"function"===typeof e?t=e(o):"string"===typeof e?t=this.expressionService.evaluate(e,o):console.warn("AG Grid: footerValueGetter should be either a function or a string (expression)")}else t="Total "+(null!=this.params.value?this.params.value:"");var n=this.getInnerCompDetails(this.params);this.comp.setInnerRenderer(n,t)},t.prototype.getInnerCompDetails=function(e){var t=this;if(e.fullWidth)return this.userComponentFactory.getFullWidthGroupRowInnerCellRenderer(this.gridOptionsService.get("groupRowRendererParams"),e);var o=this.userComponentFactory.getInnerRendererDetails(e,e),n=function(e){return e&&e.componentClass==t.compClass};if(o&&!n(o))return o;var r=this.displayedGroupNode.rowGroupColumn,i=r?r.getColDef():void 0;if(i){var a=this.userComponentFactory.getCellRendererDetails(i,e);if(a&&!n(a))return a;if(n(a)&&i.cellRendererParams&&i.cellRendererParams.innerRenderer)return this.userComponentFactory.getInnerRendererDetails(i.cellRendererParams,e)}},t.prototype.addChildCount=function(){this.params.suppressCount||(this.addManagedListener(this.displayedGroupNode,_a.EVENT_ALL_CHILDREN_COUNT_CHANGED,this.updateChildCount.bind(this)),this.updateChildCount())},t.prototype.updateChildCount=function(){var e=this.displayedGroupNode.allChildrenCount,t=this.isShowRowGroupForThisRow()&&null!=e&&e>=0?"("+e+")":"";this.comp.setChildCount(t)},t.prototype.isShowRowGroupForThisRow=function(){if(this.gridOptionsService.isTreeData())return!0;var e=this.displayedGroupNode.rowGroupColumn;if(!e)return!1;var t=this.params.column;return null==t||t.isRowGroupDisplayed(e.getId())},t.prototype.addExpandAndContract=function(){var e,t=this.params,o=Gn("groupExpanded",this.gridOptionsService,null),n=Gn("groupContracted",this.gridOptionsService,null);o&&this.eExpanded.appendChild(o),n&&this.eContracted.appendChild(n);var r=t.eGridCell;(null===(e=this.params.column)||void 0===e?void 0:e.isCellEditable(t.node))&&this.gridOptionsService.is("enableGroupEdit")||!this.isExpandable()||t.suppressDoubleClickExpand||this.addManagedListener(r,"dblclick",this.onCellDblClicked.bind(this)),this.addManagedListener(this.eExpanded,"click",this.onExpandClicked.bind(this)),this.addManagedListener(this.eContracted,"click",this.onExpandClicked.bind(this)),this.addManagedListener(r,"keydown",this.onKeyDown.bind(this)),this.addManagedListener(t.node,_a.EVENT_EXPANDED_CHANGED,this.showExpandAndContractIcons.bind(this)),this.showExpandAndContractIcons();var i=this.onRowNodeIsExpandableChanged.bind(this);this.addManagedListener(this.displayedGroupNode,_a.EVENT_ALL_CHILDREN_COUNT_CHANGED,i),this.addManagedListener(this.displayedGroupNode,_a.EVENT_MASTER_CHANGED,i),this.addManagedListener(this.displayedGroupNode,_a.EVENT_GROUP_CHANGED,i),this.addManagedListener(this.displayedGroupNode,_a.EVENT_HAS_CHILDREN_CHANGED,i)},t.prototype.onExpandClicked=function(e){Re(e)||(Ae(e),this.onExpandOrContract(e))},t.prototype.onExpandOrContract=function(e){var t=this.displayedGroupNode,o=!t.expanded;!o&&t.sticky&&this.scrollToStickyNode(t),t.setExpanded(o,e)},t.prototype.scrollToStickyNode=function(e){this.ctrlsService.getGridBodyCtrl().getScrollFeature().setVerticalScrollPosition(e.rowTop-e.stickyRowTop)},t.prototype.isExpandable=function(){if(this.showingValueForOpenedParent)return!0;var e=this.displayedGroupNode,t=this.columnModel.isPivotMode()&&e.leafGroup;if(!(e.isExpandable()&&!e.footer&&!t))return!1;var o=this.params.column;return null==o||"string"!==typeof o.getColDef().showRowGroup||this.isShowRowGroupForThisRow()},t.prototype.showExpandAndContractIcons=function(){var e=this,t=e.params,o=e.displayedGroupNode,n=e.columnModel,r=t.node,i=this.isExpandable();if(i){var a=!!this.showingValueForOpenedParent||r.expanded;this.comp.setExpandedDisplayed(a),this.comp.setContractedDisplayed(!a)}else this.comp.setExpandedDisplayed(!1),this.comp.setContractedDisplayed(!1);var s=n.isPivotMode(),l=s&&o.leafGroup,c=i&&!l,d=r.footer&&-1===r.level;this.comp.addOrRemoveCssClass("ag-cell-expandable",c),this.comp.addOrRemoveCssClass("ag-row-group",c),s?this.comp.addOrRemoveCssClass("ag-pivot-leaf-group",l):d||this.comp.addOrRemoveCssClass("ag-row-group-leaf-indent",!c)},t.prototype.onRowNodeIsExpandableChanged=function(){this.showExpandAndContractIcons(),this.setIndent(),this.refreshAriaExpanded()},t.prototype.setupIndent=function(){var e=this.params.node;this.params.suppressPadding||(this.addManagedListener(e,_a.EVENT_UI_LEVEL_CHANGED,this.setIndent.bind(this)),this.setIndent())},t.prototype.setIndent=function(){if(!this.gridOptionsService.is("groupHideOpenParents")){var e=this.params,t=e.node,o=!!e.colDef,n=this.gridOptionsService.isTreeData(),r=!o||n||!0===e.colDef.showRowGroup?t.uiLevel:0;this.indentClass&&this.comp.addOrRemoveCssClass(this.indentClass,!1),this.indentClass="ag-row-group-indent-"+r,this.comp.addOrRemoveCssClass(this.indentClass,!0)}},t.prototype.addFullWidthRowDraggerIfNeeded=function(){var e=this;if(this.params.fullWidth&&this.params.rowDrag){var t=new Ia((function(){return e.params.value}),this.params.node);this.createManagedBean(t,this.context),this.eGui.insertAdjacentElement("afterbegin",t.getGui())}},t.prototype.isUserWantsSelected=function(){var e=this.params.checkbox;return"function"===typeof e||!0===e},t.prototype.addCheckboxIfNeeded=function(){var e=this,t=this.displayedGroupNode,o=this.isUserWantsSelected()&&!t.footer&&!t.rowPinned&&!t.detail;if(o){var n=new ja;this.getContext().createBean(n),n.init({rowNode:t,column:this.params.column,overrides:{isVisible:this.params.checkbox,callbackParams:this.params,removeHidden:!0}}),this.eCheckbox.appendChild(n.getGui()),this.addDestroyFunc((function(){return e.getContext().destroyBean(n)}))}this.comp.setCheckboxVisible(o)},t.prototype.onKeyDown=function(e){e.key!==Hn.ENTER||this.params.suppressEnterExpand||(this.params.column&&this.params.column.isCellEditable(this.params.node)||this.onExpandOrContract(e))},t.prototype.onCellDblClicked=function(e){Re(e)||(De(this.eExpanded,e)||De(this.eContracted,e)||this.onExpandOrContract(e))},Ha([q("expressionService")],t.prototype,"expressionService",void 0),Ha([q("valueFormatterService")],t.prototype,"valueFormatterService",void 0),Ha([q("columnModel")],t.prototype,"columnModel",void 0),Ha([q("userComponentFactory")],t.prototype,"userComponentFactory",void 0),Ha([q("ctrlsService")],t.prototype,"ctrlsService",void 0),t}(Fe),Va=function(){var e=function(t,o){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])},e(t,o)};return function(t,o){function n(){this.constructor=t}e(t,o),t.prototype=null===o?Object.create(o):(n.prototype=o.prototype,new n)}}(),$a=function(e,t,o,n){var r,i=arguments.length,a=i<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,o):n;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)a=Reflect.decorate(e,t,o,n);else for(var s=e.length-1;s>=0;s--)(r=e[s])&&(a=(i<3?r(a):i>3?r(t,o,a):r(t,o))||a);return i>3&&a&&Object.defineProperty(t,o,a),a},Ua=function(e){function t(){return e.call(this,t.TEMPLATE)||this}return Va(t,e),t.prototype.init=function(e){var t=this,o={setInnerRenderer:function(e,o){return t.setRenderDetails(e,o)},setChildCount:function(e){return t.eChildCount.innerHTML=e},addOrRemoveCssClass:function(e,o){return t.addOrRemoveCssClass(e,o)},setContractedDisplayed:function(e){return on(t.eContracted,e)},setExpandedDisplayed:function(e){return on(t.eExpanded,e)},setCheckboxVisible:function(e){return t.eCheckbox.classList.toggle("ag-invisible",!e)}},n=this.createManagedBean(new Ba),r=!e.colDef,i=this.getGui();n.init(o,i,this.eCheckbox,this.eExpanded,this.eContracted,this.constructor,e),r&&$t(i,"gridcell")},t.prototype.setRenderDetails=function(e,t){var o=this;if(e){var n=e.newAgStackInstance();if(!n)return;n.then((function(e){if(e){var t=function(){return o.context.destroyBean(e)};o.isAlive()?(o.eValue.appendChild(e.getGui()),o.addDestroyFunc(t)):t()}}))}else this.eValue.innerText=t},t.prototype.destroy=function(){this.getContext().destroyBean(this.innerCellRenderer),e.prototype.destroy.call(this)},t.prototype.refresh=function(){return!1},t.TEMPLATE='<span class="ag-cell-wrapper">\n            <span class="ag-group-expanded" ref="eExpanded"></span>\n            <span class="ag-group-contracted" ref="eContracted"></span>\n            <span class="ag-group-checkbox ag-invisible" ref="eCheckbox"></span>\n            <span class="ag-group-value" ref="eValue"></span>\n            <span class="ag-group-child-count" ref="eChildCount"></span>\n        </span>',$a([mr("eExpanded")],t.prototype,"eExpanded",void 0),$a([mr("eContracted")],t.prototype,"eContracted",void 0),$a([mr("eCheckbox")],t.prototype,"eCheckbox",void 0),$a([mr("eValue")],t.prototype,"eValue",void 0),$a([mr("eChildCount")],t.prototype,"eChildCount",void 0),t}(fr),Wa=function(){var e=function(t,o){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])},e(t,o)};return function(t,o){function n(){this.constructor=t}e(t,o),t.prototype=null===o?Object.create(o):(n.prototype=o.prototype,new n)}}(),qa=function(e,t,o,n){var r,i=arguments.length,a=i<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,o):n;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)a=Reflect.decorate(e,t,o,n);else for(var s=e.length-1;s>=0;s--)(r=e[s])&&(a=(i<3?r(a):i>3?r(t,o,a):r(t,o))||a);return i>3&&a&&Object.defineProperty(t,o,a),a},Ka=function(e){function t(){return e.call(this,t.TEMPLATE)||this}return Wa(t,e),t.prototype.init=function(e){e.node.failedLoad?this.setupFailed():this.setupLoading()},t.prototype.setupFailed=function(){var e=this.localeService.getLocaleTextFunc();this.eLoadingText.innerText=e("loadingError","ERR")},t.prototype.setupLoading=function(){var e=Gn("groupLoading",this.gridOptionsService,null);e&&this.eLoadingIcon.appendChild(e);var t=this.localeService.getLocaleTextFunc();this.eLoadingText.innerText=t("loadingOoo","Loading")},t.prototype.refresh=function(e){return!1},t.prototype.destroy=function(){e.prototype.destroy.call(this)},t.TEMPLATE='<div class="ag-loading">\n            <span class="ag-loading-icon" ref="eLoadingIcon"></span>\n            <span class="ag-loading-text" ref="eLoadingText"></span>\n        </div>',qa([mr("eLoadingIcon")],t.prototype,"eLoadingIcon",void 0),qa([mr("eLoadingText")],t.prototype,"eLoadingText",void 0),t}(fr),Ya=function(){var e=function(t,o){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])},e(t,o)};return function(t,o){function n(){this.constructor=t}e(t,o),t.prototype=null===o?Object.create(o):(n.prototype=o.prototype,new n)}}(),Ja=function(e){function t(){return e.call(this)||this}return Ya(t,e),t.prototype.destroy=function(){e.prototype.destroy.call(this)},t.prototype.init=function(e){var o,n=null!==(o=this.gridOptionsService.get("overlayLoadingTemplate"))&&void 0!==o?o:t.DEFAULT_LOADING_OVERLAY_TEMPLATE,r=this.localeService.getLocaleTextFunc(),i=n.replace("[LOADING...]",r("loadingOoo","Loading..."));this.setTemplate(i)},t.DEFAULT_LOADING_OVERLAY_TEMPLATE='<span class="ag-overlay-loading-center">[LOADING...]</span>',t}(fr),Xa=function(){var e=function(t,o){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])},e(t,o)};return function(t,o){function n(){this.constructor=t}e(t,o),t.prototype=null===o?Object.create(o):(n.prototype=o.prototype,new n)}}(),Qa=function(e){function t(){return e.call(this)||this}return Xa(t,e),t.prototype.destroy=function(){e.prototype.destroy.call(this)},t.prototype.init=function(e){var o,n=null!==(o=this.gridOptionsService.get("overlayNoRowsTemplate"))&&void 0!==o?o:t.DEFAULT_NO_ROWS_TEMPLATE,r=this.localeService.getLocaleTextFunc(),i=n.replace("[NO_ROWS_TO_SHOW]",r("noRowsToShow","No Rows To Show"));this.setTemplate(i)},t.DEFAULT_NO_ROWS_TEMPLATE='<span class="ag-overlay-no-rows-center">[NO_ROWS_TO_SHOW]</span>',t}(fr),Za=function(){var e=function(t,o){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])},e(t,o)};return function(t,o){function n(){this.constructor=t}e(t,o),t.prototype=null===o?Object.create(o):(n.prototype=o.prototype,new n)}}(),es=function(e){function t(){return e.call(this,'<div class="ag-tooltip"></div>')||this}return Za(t,e),t.prototype.init=function(e){var t=e.value;this.getGui().innerHTML=vt(t)},t}(aa),ts=function(){var e=function(t,o){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])},e(t,o)};return function(t,o){function n(){this.constructor=t}e(t,o),t.prototype=null===o?Object.create(o):(n.prototype=o.prototype,new n)}}(),os=function(e,t,o,n){var r,i=arguments.length,a=i<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,o):n;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)a=Reflect.decorate(e,t,o,n);else for(var s=e.length-1;s>=0;s--)(r=e[s])&&(a=(i<3?r(a):i>3?r(t,o,a):r(t,o))||a);return i>3&&a&&Object.defineProperty(t,o,a),a},ns=function(e,t){var o="function"===typeof Symbol&&e[Symbol.iterator];if(!o)return e;var n,r,i=o.call(e),a=[];try{for(;(void 0===t||t-- >0)&&!(n=i.next()).done;)a.push(n.value)}catch(s){r={error:s}}finally{try{n&&!n.done&&(o=i.return)&&o.call(i)}finally{if(r)throw r.error}}return a},rs=function(){for(var e=[],t=0;t<arguments.length;t++)e=e.concat(ns(arguments[t]));return e},is=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.agGridDefaults={agDateInput:Si,agColumnHeader:ta,agColumnGroupHeader:ra,agSortIndicator:Qi,agTextColumnFloatingFilter:Ki,agNumberColumnFloatingFilter:Wi,agDateColumnFloatingFilter:wi,agReadOnlyFloatingFilter:xr,agAnimateShowChangeCellRenderer:va,agAnimateSlideCellRenderer:wa,agGroupCellRenderer:Ua,agGroupRowRenderer:Ua,agLoadingCellRenderer:Ka,agCellEditor:ga,agTextCellEditor:ga,agSelectCellEditor:pa,agLargeTextCellEditor:ca,agTextColumnFilter:Gi,agNumberColumnFilter:Ii,agDateColumnFilter:mi,agLoadingOverlay:Ja,agNoRowsOverlay:Qa,agTooltipComponent:es},t.enterpriseAgDefaultCompsModule={agSetColumnFilter:Q.SetFilterModule,agSetColumnFloatingFilter:Q.SetFilterModule,agMultiColumnFilter:Q.MultiFilterModule,agMultiColumnFloatingFilter:Q.MultiFilterModule,agGroupColumnFilter:Q.RowGroupingModule,agGroupColumnFloatingFilter:Q.RowGroupingModule,agRichSelect:Q.RichSelectModule,agRichSelectCellEditor:Q.RichSelectModule,agDetailCellRenderer:Q.MasterDetailModule,agSparklineCellRenderer:Q.SparklinesModule},t.deprecatedAgGridDefaults={agPopupTextCellEditor:'AG Grid: Since v27.1 The agPopupTextCellEditor is deprecated. Instead use { cellEditor: "agTextCellEditor", cellEditorPopup: true }',agPopupSelectCellEditor:'AG Grid: Since v27.1 the agPopupSelectCellEditor is deprecated. Instead use { cellEditor: "agSelectCellEditor", cellEditorPopup: true }'},t.jsComps={},t.fwComps={},t}return ts(t,e),t.prototype.init=function(){var e=this;null!=this.gridOptions.components&&h(this.gridOptions.components,(function(t,o){return e.registerJsComponent(t,o)})),null!=this.gridOptions.frameworkComponents&&h(this.gridOptions.frameworkComponents,(function(t,o){return e.registerFwComponent(t,o)}))},t.prototype.registerDefaultComponent=function(e,t){this.agGridDefaults[e]?console.error("Trying to overwrite a default component. You should call registerComponent"):this.agGridDefaults[e]=t},t.prototype.registerJsComponent=function(e,t){this.fwComps[e]?console.error("Trying to register a component that you have already registered for frameworks: "+e):this.jsComps[e]=t},t.prototype.registerFwComponent=function(e,t){j((function(){return console.warn("AG Grid: As of v27, registering components via grid property frameworkComponents is deprecated. Instead register both JavaScript AND Framework Components via the components property.")}),"UserComponentRegistry.frameworkComponentsDeprecated"),this.fwComps[e]=t},t.prototype.retrieve=function(e,t){var o=this,n=function(e,t){return{componentFromFramework:t,component:e}},r=this.getFrameworkOverrides().frameworkComponent(t,this.gridOptions.components);if(null!=r)return n(r,!0);var i=this.fwComps[t];if(i)return n(i,!0);var a=this.jsComps[t];if(a)return n(a,this.getFrameworkOverrides().isFrameworkComponent(a));var s=this.agGridDefaults[t];if(s)return n(s,!1);var l=this.enterpriseAgDefaultCompsModule[t];return l?ne.assertRegistered(l,"AG Grid '"+e+"' component: "+t):this.deprecatedAgGridDefaults[t]?j((function(){return console.warn(o.deprecatedAgGridDefaults[t])}),t):j((function(){o.warnAboutMissingComponent(e,t)}),"MissingComp"+t),null},t.prototype.warnAboutMissingComponent=function(e,t){var o=Ze(t,rs(Object.keys(this.agGridDefaults).filter((function(e){return!["agCellEditor","agGroupRowRenderer","agSortIndicator"].includes(e)})),Object.keys(this.jsComps),Object.keys(this.fwComps)),!0,.8);console.warn("AG Grid: Could not find '"+t+"' component. It was configured as \""+e+": '"+t+"'\" but it wasn't found in the list of registered components."),o.length>0&&console.warn("         Did you mean: ["+o.slice(0,3)+"]?"),console.warn("If using a custom component check it has been registered as described in: https://ag-grid.com/javascript-data-grid/components/")},os([q("gridOptions")],t.prototype,"gridOptions",void 0),os([$],t.prototype,"init",null),t=os([W("userComponentRegistry")],t)}(Fe),as={propertyName:"dateComponent",cellRenderer:!1},ss={propertyName:"headerComponent",cellRenderer:!1},ls={propertyName:"headerGroupComponent",cellRenderer:!1},cs={propertyName:"cellRenderer",cellRenderer:!0},ds={propertyName:"cellEditor",cellRenderer:!1},us={propertyName:"innerRenderer",cellRenderer:!0},ps={propertyName:"loadingOverlayComponent",cellRenderer:!1},hs={propertyName:"noRowsOverlayComponent",cellRenderer:!1},fs={propertyName:"tooltipComponent",cellRenderer:!1},gs={propertyName:"filter",cellRenderer:!1},ms={propertyName:"floatingFilterComponent",cellRenderer:!1},ys={propertyName:"toolPanel",cellRenderer:!1},vs={propertyName:"statusPanel",cellRenderer:!1},bs={propertyName:"fullWidthCellRenderer",cellRenderer:!0},xs={propertyName:"loadingCellRenderer",cellRenderer:!0},ws={propertyName:"groupRowRenderer",cellRenderer:!0},Cs={propertyName:"detailCellRenderer",cellRenderer:!0},_s=function(){function e(){}return e.getFloatingFilterType=function(e){return this.filterToFloatingFilterMapping[e]},e.filterToFloatingFilterMapping={set:"agSetColumnFloatingFilter",agSetColumnFilter:"agSetColumnFloatingFilter",multi:"agMultiColumnFloatingFilter",agMultiColumnFilter:"agMultiColumnFloatingFilter",group:"agGroupColumnFloatingFilter",agGroupColumnFilter:"agGroupColumnFloatingFilter",number:"agNumberColumnFloatingFilter",agNumberColumnFilter:"agNumberColumnFloatingFilter",date:"agDateColumnFloatingFilter",agDateColumnFilter:"agDateColumnFloatingFilter",text:"agTextColumnFloatingFilter",agTextColumnFilter:"agTextColumnFloatingFilter"},e}(),Ss=function(){var e=function(t,o){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])},e(t,o)};return function(t,o){function n(){this.constructor=t}e(t,o),t.prototype=null===o?Object.create(o):(n.prototype=o.prototype,new n)}}(),Es=function(e,t,o,n){var r,i=arguments.length,a=i<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,o):n;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)a=Reflect.decorate(e,t,o,n);else for(var s=e.length-1;s>=0;s--)(r=e[s])&&(a=(i<3?r(a):i>3?r(t,o,a):r(t,o))||a);return i>3&&a&&Object.defineProperty(t,o,a),a},ks=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Ss(t,e),t.prototype.getHeaderCompDetails=function(e,t){return this.getCompDetails(e,ss,"agColumnHeader",t)},t.prototype.getHeaderGroupCompDetails=function(e){var t=e.columnGroup.getColGroupDef();return this.getCompDetails(t,ls,"agColumnGroupHeader",e)},t.prototype.getFullWidthCellRendererDetails=function(e){return this.getCompDetails(this.gridOptions,bs,null,e,!0)},t.prototype.getFullWidthLoadingCellRendererDetails=function(e){return this.getCompDetails(this.gridOptions,xs,"agLoadingCellRenderer",e,!0)},t.prototype.getFullWidthGroupCellRendererDetails=function(e){return this.getCompDetails(this.gridOptions,ws,"agGroupRowRenderer",e,!0)},t.prototype.getFullWidthDetailCellRendererDetails=function(e){return this.getCompDetails(this.gridOptions,Cs,"agDetailCellRenderer",e,!0)},t.prototype.getInnerRendererDetails=function(e,t){return this.getCompDetails(e,us,null,t)},t.prototype.getFullWidthGroupRowInnerCellRenderer=function(e,t){return this.getCompDetails(e,us,null,t)},t.prototype.getCellRendererDetails=function(e,t){return this.getCompDetails(e,cs,null,t)},t.prototype.getCellEditorDetails=function(e,t){return this.getCompDetails(e,ds,"agCellEditor",t,!0)},t.prototype.getFilterDetails=function(e,t,o){return this.getCompDetails(e,gs,o,t,!0)},t.prototype.getDateCompDetails=function(e){return this.getCompDetails(this.gridOptions,as,"agDateInput",e,!0)},t.prototype.getLoadingOverlayCompDetails=function(e){return this.getCompDetails(this.gridOptions,ps,"agLoadingOverlay",e,!0)},t.prototype.getNoRowsOverlayCompDetails=function(e){return this.getCompDetails(this.gridOptions,hs,"agNoRowsOverlay",e,!0)},t.prototype.getTooltipCompDetails=function(e){return this.getCompDetails(e.colDef,fs,"agTooltipComponent",e,!0)},t.prototype.getSetFilterCellRendererDetails=function(e,t){return this.getCompDetails(e,cs,null,t)},t.prototype.getFloatingFilterCompDetails=function(e,t,o){return this.getCompDetails(e,ms,o,t)},t.prototype.getToolPanelCompDetails=function(e,t){return this.getCompDetails(e,ys,null,t,!0)},t.prototype.getStatusPanelCompDetails=function(e,t){return this.getCompDetails(e,vs,null,t,!0)},t.prototype.getCompDetails=function(e,t,o,n,r){var i=this;void 0===r&&(r=!1);var a=t.propertyName,s=t.cellRenderer,l=this.getCompKeys(e,t,n),c=l.compName,d=l.jsComp,u=l.fwComp,p=l.paramsFromSelector,h=l.popupFromSelector,f=l.popupPositionFromSelector,g=function(e){var t=i.userComponentRegistry.retrieve(a,e);t&&(d=t.componentFromFramework?void 0:t.component,u=t.componentFromFramework?t.component:void 0)};if(null!=c&&g(c),null==d&&null==u&&null!=o&&g(o),d&&s&&!this.agComponentUtils.doesImplementIComponent(d)&&(d=this.agComponentUtils.adaptFunction(a,d)),d||u){var m=this.mergeParamsWithApplicationProvidedParams(e,t,n,p),y=null==d,v=d||u;return{componentFromFramework:y,componentClass:v,params:m,type:t,popupFromSelector:h,popupPositionFromSelector:f,newAgStackInstance:function(){return i.newAgStackInstance(v,y,m,t)}}}r&&console.error("AG Grid: Could not find component "+c+", did you forget to configure this component?")},t.prototype.getCompKeys=function(e,t,o){var n,r,i,a,s,l,c=this,d=t.propertyName;if(e){var u=e,p=u[d+"Selector"],h=p?p(o):null,f=function(e,t){var o=function(){var e="AG Grid: As of v27, the property "+d+"Framework is deprecated. The property "+d+" can now be used for JavaScript AND Framework Components.";j((function(){return console.warn(e)}),"UserComponentFactory."+d+"FrameworkDeprecated")};if("string"===typeof e)n=e;else if("string"===typeof t)o(),n=t;else if(null!=e&&!0!==e){c.getFrameworkOverrides().isFrameworkComponent(e)?i=e:r=e}else null!=t&&(o(),i=t)};if(h){if(null!=h.frameworkComponent){var g="AG Grid: As of v27, the return for "+d+"Selector has attributes [component, params] only. The attribute frameworkComponent is deprecated. You should now return back Framework Components using the 'component' attribute and the grid works out if it's a framework component or not.";j((function(){return console.warn(g)}),"UserComponentFactory."+d+"FrameworkSelectorDeprecated"),f(h.frameworkComponent,void 0)}else f(h.component,void 0);a=h.params,s=h.popup,l=h.popupPosition}else f(u[d],u[d+"Framework"])}return{compName:n,jsComp:r,fwComp:i,paramsFromSelector:a,popupFromSelector:s,popupPositionFromSelector:l}},t.prototype.newAgStackInstance=function(e,t,o,n){var r,i=n.propertyName;if(!t)r=new e;else{var a=this.componentMetadataProvider.retrieve(i);r=this.frameworkComponentWrapper.wrap(e,a.mandatoryMethodList,a.optionalMethodList,n)}var s=this.initComponent(r,o);return null==s?rr.resolve(r):s.then((function(){return r}))},t.prototype.mergeParamsWithApplicationProvidedParams=function(e,t,o,n){void 0===n&&(n=null);var r={context:this.gridOptionsService.context,columnApi:this.gridOptionsService.columnApi,api:this.gridOptionsService.api};w(r,o);var i=e&&e[t.propertyName+"Params"];"function"===typeof i?w(r,i(o)):"object"===typeof i&&w(r,i);return w(r,n),r},t.prototype.initComponent=function(e,t){if(this.context.createBean(e),null!=e.init)return e.init(t)},t.prototype.getDefaultFloatingFilterType=function(e){if(null==e)return null;var t=null,o=this.getCompKeys(e,gs),n=o.compName,r=o.jsComp,i=o.fwComp;n?t=_s.getFloatingFilterType(n):null==r&&null==i&&!0===e.filter&&(t=ne.isRegistered(Q.SetFilterModule)?"agSetColumnFloatingFilter":"agTextColumnFloatingFilter");return t},Es([q("gridOptions")],t.prototype,"gridOptions",void 0),Es([q("agComponentUtils")],t.prototype,"agComponentUtils",void 0),Es([q("componentMetadataProvider")],t.prototype,"componentMetadataProvider",void 0),Es([q("userComponentRegistry")],t.prototype,"userComponentRegistry",void 0),Es([K("frameworkComponentWrapper")],t.prototype,"frameworkComponentWrapper",void 0),t=Es([W("userComponentFactory")],t)}(Fe);!function(e){e[e.SINGLE_SHEET=0]="SINGLE_SHEET",e[e.MULTI_SHEET=1]="MULTI_SHEET"}(Ta||(Ta={}));var js,As,Rs=function(){var e=function(t,o){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])},e(t,o)};return function(t,o){function n(){this.constructor=t}e(t,o),t.prototype=null===o?Object.create(o):(n.prototype=o.prototype,new n)}}(),Os=function(e,t,o,n){var r,i=arguments.length,a=i<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,o):n;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)a=Reflect.decorate(e,t,o,n);else for(var s=e.length-1;s>=0;s--)(r=e[s])&&(a=(i<3?r(a):i>3?r(t,o,a):r(t,o))||a);return i>3&&a&&Object.defineProperty(t,o,a),a},Ts=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.dragEndFunctions=[],t.dragSources=[],t}return Rs(t,e),t.prototype.removeAllListeners=function(){this.dragSources.forEach(this.removeListener.bind(this)),this.dragSources.length=0},t.prototype.removeListener=function(e){var t=e.dragSource.eElement,o=e.mouseDownListener;if(t.removeEventListener("mousedown",o),e.touchEnabled){var n=e.touchStartListener;t.removeEventListener("touchstart",n,{passive:!0})}},t.prototype.removeDragSource=function(e){var t=this.dragSources.find((function(t){return t.dragSource===e}));t&&(this.removeListener(t),ye(this.dragSources,t))},t.prototype.isDragging=function(){return this.dragging},t.prototype.addDragSource=function(e,t){var o=this;void 0===t&&(t=!1);var n=this.onMouseDown.bind(this,e);e.eElement.addEventListener("mousedown",n);var r=null,i=this.gridOptionsService.is("suppressTouch");t&&!i&&(r=function(t){tn(t.target)||(t.cancelable&&(t.preventDefault(),t.stopPropagation()),o.onTouchStart(e,t))},e.eElement.addEventListener("touchstart",r,{passive:!1})),this.dragSources.push({dragSource:e,mouseDownListener:n,touchStartListener:r,touchEnabled:t})},t.prototype.getStartTarget=function(){return this.startTarget},t.prototype.onTouchStart=function(e,t){var o=this;this.currentDragParams=e,this.dragging=!1;var n=t.touches[0];this.touchLastTime=n,this.touchStart=n;var r=function(t){return o.onTouchUp(t,e.eElement)},i=t.target,a=[{target:this.gridOptionsService.getRootNode(),type:"touchmove",listener:function(e){e.cancelable&&e.preventDefault()},options:{passive:!1}},{target:i,type:"touchmove",listener:function(t){return o.onTouchMove(t,e.eElement)},options:{passive:!0}},{target:i,type:"touchend",listener:r,options:{passive:!0}},{target:i,type:"touchcancel",listener:r,options:{passive:!0}}];this.addTemporaryEvents(a),0===e.dragStartPixels&&this.onCommonMove(n,this.touchStart,e.eElement)},t.prototype.onMouseDown=function(e,t){var o=this,n=t;if((!e.skipMouseEvent||!e.skipMouseEvent(t))&&!n._alreadyProcessedByDragService&&(n._alreadyProcessedByDragService=!0,0===t.button)){this.currentDragParams=e,this.dragging=!1,this.mouseStartEvent=t,this.startTarget=t.target;var r=this.gridOptionsService.getRootNode(),i=[{target:r,type:"mousemove",listener:function(t){return o.onMouseMove(t,e.eElement)}},{target:r,type:"mouseup",listener:function(t){return o.onMouseUp(t,e.eElement)}},{target:r,type:"contextmenu",listener:function(e){return e.preventDefault()}}];this.addTemporaryEvents(i),0===e.dragStartPixels&&this.onMouseMove(t,e.eElement)}},t.prototype.addTemporaryEvents=function(e){e.forEach((function(e){var t=e.target,o=e.type,n=e.listener,r=e.options;t.addEventListener(o,n,r)})),this.dragEndFunctions.push((function(){e.forEach((function(e){var t=e.target,o=e.type,n=e.listener,r=e.options;t.removeEventListener(o,n,r)}))}))},t.prototype.isEventNearStartEvent=function(e,t){var o=this.currentDragParams.dragStartPixels;return Kn(e,t,r(o)?o:4)},t.prototype.getFirstActiveTouch=function(e){for(var t=0;t<e.length;t++)if(e[t].identifier===this.touchStart.identifier)return e[t];return null},t.prototype.onCommonMove=function(e,t,o){if(!this.dragging){if(!this.dragging&&this.isEventNearStartEvent(e,t))return;this.dragging=!0;var n={type:$e.EVENT_DRAG_STARTED,target:o};this.eventService.dispatchEvent(n),this.currentDragParams.onDragStart(t),this.currentDragParams.onDragging(t)}this.currentDragParams.onDragging(e)},t.prototype.onTouchMove=function(e,t){var o=this.getFirstActiveTouch(e.touches);o&&this.onCommonMove(o,this.touchStart,t)},t.prototype.onMouseMove=function(e,t){(this.gridOptionsService.is("enableCellTextSelection")||Eo())&&"mousemove"===e.type&&e.cancelable&&this.mouseEventService.isEventFromThisGrid(e)&&!this.isOverFormFieldElement(e)&&e.preventDefault(),this.onCommonMove(e,this.mouseStartEvent,t)},t.prototype.isOverFormFieldElement=function(e){var t=e.target,o=null===t||void 0===t?void 0:t.tagName.toLocaleLowerCase();return!!(null===o||void 0===o?void 0:o.match("^a$|textarea|input|select|button"))},t.prototype.onTouchUp=function(e,t){var o=this.getFirstActiveTouch(e.changedTouches);o||(o=this.touchLastTime),this.onUpCommon(o,t)},t.prototype.onMouseUp=function(e,t){this.onUpCommon(e,t)},t.prototype.onUpCommon=function(e,t){if(this.dragging){this.dragging=!1,this.currentDragParams.onDragStop(e);var o={type:$e.EVENT_DRAG_STOPPED,target:t};this.eventService.dispatchEvent(o)}this.mouseStartEvent=null,this.startTarget=null,this.touchStart=null,this.touchLastTime=null,this.currentDragParams=null,this.dragEndFunctions.forEach((function(e){return e()})),this.dragEndFunctions.length=0},Os([q("mouseEventService")],t.prototype,"mouseEventService",void 0),Os([U],t.prototype,"removeAllListeners",null),t=Os([W("dragService")],t)}(Fe);!function(e){e[e.Above=0]="Above",e[e.Below=1]="Below"}(js||(js={})),function(e){e.EVERYTHING="group",e.FILTER="filter",e.SORT="sort",e.MAP="map",e.AGGREGATE="aggregate",e.FILTER_AGGREGATES="filter_aggregates",e.PIVOT="pivot",e.NOTHING="nothing"}(As||(As={}));var Ds=function(e,t,o,n){var r,i=arguments.length,a=i<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,o):n;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)a=Reflect.decorate(e,t,o,n);else for(var s=e.length-1;s>=0;s--)(r=e[s])&&(a=(i<3?r(a):i>3?r(t,o,a):r(t,o))||a);return i>3&&a&&Object.defineProperty(t,o,a),a};function Ps(e){var t=e;return null!=t&&null!=t.getFrameworkComponentInstance?t.getFrameworkComponentInstance():e}var Ns,Is=function(){function e(){this.detailGridInfoMap={},this.destroyCalled=!1}return e.prototype.registerOverlayWrapperComp=function(e){this.overlayWrapperComp=e},e.prototype.registerSideBarComp=function(e){this.sideBarComp=e},e.prototype.init=function(){var e=this;switch(this.rowModel.getType()){case"clientSide":this.clientSideRowModel=this.rowModel;break;case"infinite":this.infiniteRowModel=this.rowModel;break;case"serverSide":this.serverSideRowModel=this.rowModel}this.ctrlsService.whenReady((function(){e.gridBodyCtrl=e.ctrlsService.getGridBodyCtrl()}))},e.prototype.__getAlignedGridService=function(){return this.alignedGridsService},e.prototype.__getContext=function(){return this.context},e.prototype.getSetterMethod=function(e){return"set"+e.charAt(0).toUpperCase()+e.substring(1)},e.prototype.__setProperty=function(e,t){this.gridOptionsService.set(e,t);var o=this.getSetterMethod(e);this[o]&&this[o](t)},e.prototype.addDetailGridInfo=function(e,t){this.detailGridInfoMap[e]=t},e.prototype.removeDetailGridInfo=function(e){this.detailGridInfoMap[e]=void 0},e.prototype.getDetailGridInfo=function(e){return this.detailGridInfoMap[e]},e.prototype.forEachDetailGridInfo=function(e){var t=0;h(this.detailGridInfoMap,(function(o,n){r(n)&&(e(n,t),t++)}))},e.prototype.getDataAsCsv=function(e){if(ne.assertRegistered(Q.CsvExportModule,"api.getDataAsCsv"))return this.csvCreator.getDataAsCsv(e)},e.prototype.exportDataAsCsv=function(e){ne.assertRegistered(Q.CsvExportModule,"api.exportDataAsCSv")&&this.csvCreator.exportDataAsCsv(e)},e.prototype.getExcelExportMode=function(e){var t=this.gridOptionsService.get("defaultExcelExportParams");return Object.assign({exportMode:"xlsx"},t,e).exportMode},e.prototype.assertNotExcelMultiSheet=function(e,t){if(!ne.assertRegistered(Q.ExcelExportModule,"api."+e))return!1;var o=this.getExcelExportMode(t);return this.excelCreator.getFactoryMode(o)!==Ta.MULTI_SHEET||(console.warn("AG Grid: The Excel Exporter is currently on Multi Sheet mode. End that operation by calling 'api.getMultipleSheetAsExcel()' or 'api.exportMultipleSheetsAsExcel()'"),!1)},e.prototype.getDataAsExcel=function(e){if(this.assertNotExcelMultiSheet("getDataAsExcel",e))return this.excelCreator.getDataAsExcel(e)},e.prototype.exportDataAsExcel=function(e){this.assertNotExcelMultiSheet("exportDataAsExcel",e)&&this.excelCreator.exportDataAsExcel(e)},e.prototype.getSheetDataForExcel=function(e){if(ne.assertRegistered(Q.ExcelExportModule,"api.getSheetDataForExcel")){var t=this.getExcelExportMode(e);return this.excelCreator.setFactoryMode(Ta.MULTI_SHEET,t),this.excelCreator.getSheetDataForExcel(e)}},e.prototype.getMultipleSheetsAsExcel=function(e){if(ne.assertRegistered(Q.ExcelExportModule,"api.getMultipleSheetsAsExcel"))return this.excelCreator.getMultipleSheetsAsExcel(e)},e.prototype.exportMultipleSheetsAsExcel=function(e){if(ne.assertRegistered(Q.ExcelExportModule,"api.exportMultipleSheetsAsExcel"))return this.excelCreator.exportMultipleSheetsAsExcel(e)},e.prototype.setGridAriaProperty=function(e,t){if(e){var o=this.ctrlsService.getGridBodyCtrl().getGui(),n="aria-"+e;null===t?o.removeAttribute(n):o.setAttribute(n,t)}},e.prototype.logMissingRowModel=function(e){for(var t=[],o=1;o<arguments.length;o++)t[o-1]=arguments[o];console.error("AG Grid: api."+e+" can only be called when gridOptions.rowModelType is "+t.join(" or "))},e.prototype.setServerSideDatasource=function(e){this.serverSideRowModel?this.serverSideRowModel.setDatasource(e):this.logMissingRowModel("setServerSideDatasource","serverSide")},e.prototype.setCacheBlockSize=function(e){this.serverSideRowModel?(this.gridOptionsService.set("cacheBlockSize",e),this.serverSideRowModel.resetRootStore()):this.logMissingRowModel("setCacheBlockSize","serverSide")},e.prototype.setDatasource=function(e){this.gridOptionsService.isRowModelType("infinite")?this.rowModel.setDatasource(e):this.logMissingRowModel("setDatasource","infinite")},e.prototype.setViewportDatasource=function(e){this.gridOptionsService.isRowModelType("viewport")?this.rowModel.setViewportDatasource(e):this.logMissingRowModel("setViewportDatasource","viewport")},e.prototype.setRowData=function(e){null==this.immutableService?this.logMissingRowModel("setRowData","clientSide"):this.immutableService.isActive()?this.immutableService.setRowData(e):(this.selectionService.reset(),this.clientSideRowModel.setRowData(e))},e.prototype.setPinnedTopRowData=function(e){this.pinnedRowModel.setPinnedTopRowData(e)},e.prototype.setPinnedBottomRowData=function(e){this.pinnedRowModel.setPinnedBottomRowData(e)},e.prototype.getPinnedTopRowCount=function(){return this.pinnedRowModel.getPinnedTopRowCount()},e.prototype.getPinnedBottomRowCount=function(){return this.pinnedRowModel.getPinnedBottomRowCount()},e.prototype.getPinnedTopRow=function(e){return this.pinnedRowModel.getPinnedTopRow(e)},e.prototype.getPinnedBottomRow=function(e){return this.pinnedRowModel.getPinnedBottomRow(e)},e.prototype.setColumnDefs=function(e,t){void 0===t&&(t="api"),this.columnModel.setColumnDefs(e,t),this.gridOptionsService.set("columnDefs",e,!0,{source:t})},e.prototype.setAutoGroupColumnDef=function(e,t){void 0===t&&(t="api"),this.gridOptionsService.set("autoGroupColumnDef",e,!0,{source:t})},e.prototype.setDefaultColDef=function(e,t){void 0===t&&(t="api"),this.gridOptionsService.set("defaultColDef",e,!0,{source:t})},e.prototype.setColumnTypes=function(e,t){void 0===t&&(t="api"),this.gridOptionsService.set("columnTypes",e,!0,{source:t})},e.prototype.expireValueCache=function(){this.valueCache.expire()},e.prototype.getVerticalPixelRange=function(){return this.gridBodyCtrl.getScrollFeature().getVScrollPosition()},e.prototype.getHorizontalPixelRange=function(){return this.gridBodyCtrl.getScrollFeature().getHScrollPosition()},e.prototype.setAlwaysShowHorizontalScroll=function(e){this.gridOptionsService.set("alwaysShowHorizontalScroll",e)},e.prototype.setAlwaysShowVerticalScroll=function(e){this.gridOptionsService.set("alwaysShowVerticalScroll",e)},e.prototype.refreshCells=function(e){void 0===e&&(e={}),this.rowRenderer.refreshCells(e)},e.prototype.flashCells=function(e){void 0===e&&(e={}),this.rowRenderer.flashCells(e)},e.prototype.redrawRows=function(e){void 0===e&&(e={});var t=e?e.rowNodes:void 0;this.rowRenderer.redrawRows(t)},e.prototype.setFunctionsReadOnly=function(e){this.gridOptionsService.set("functionsReadOnly",e)},e.prototype.refreshHeader=function(){this.ctrlsService.getHeaderRowContainerCtrls().forEach((function(e){return e.refresh()}))},e.prototype.isAnyFilterPresent=function(){return this.filterManager.isAnyFilterPresent()},e.prototype.isColumnFilterPresent=function(){return this.filterManager.isColumnFilterPresent()||this.filterManager.isAggregateFilterPresent()},e.prototype.isQuickFilterPresent=function(){return this.filterManager.isQuickFilterPresent()},e.prototype.getModel=function(){return this.rowModel},e.prototype.setRowNodeExpanded=function(e,t,o){e&&(o&&e.parent&&-1!==e.parent.level&&this.setRowNodeExpanded(e.parent,t,o),e.setExpanded(t))},e.prototype.onGroupExpandedOrCollapsed=function(){i(this.clientSideRowModel)?this.logMissingRowModel("onGroupExpandedOrCollapsed","clientSide"):this.clientSideRowModel.refreshModel({step:As.MAP})},e.prototype.refreshClientSideRowModel=function(e){i(this.clientSideRowModel)?this.logMissingRowModel("refreshClientSideRowModel","clientSide"):this.clientSideRowModel.refreshModel(e)},e.prototype.isAnimationFrameQueueEmpty=function(){return this.animationFrameService.isQueueEmpty()},e.prototype.flushAllAnimationFrames=function(){this.animationFrameService.flushAllFrames()},e.prototype.getRowNode=function(e){return this.rowModel.getRowNode(e)},e.prototype.getSizesForCurrentTheme=function(){return{rowHeight:this.gridOptionsService.getRowHeightAsNumber(),headerHeight:this.columnModel.getHeaderHeight()}},e.prototype.expandAll=function(){this.clientSideRowModel?this.clientSideRowModel.expandOrCollapseAll(!0):this.serverSideRowModel?this.serverSideRowModel.expandAll(!0):this.logMissingRowModel("expandAll","clientSide","serverSide")},e.prototype.collapseAll=function(){this.clientSideRowModel?this.clientSideRowModel.expandOrCollapseAll(!1):this.serverSideRowModel?this.serverSideRowModel.expandAll(!1):this.logMissingRowModel("expandAll","clientSide","serverSide")},e.prototype.addRenderedRowListener=function(e,t,o){this.rowRenderer.addRenderedRowListener(e,t,o)},e.prototype.getQuickFilter=function(){return this.gridOptionsService.get("quickFilterText")},e.prototype.setQuickFilter=function(e){this.gridOptionsService.set("quickFilterText",e)},e.prototype.setExcludeHiddenColumnsFromQuickFilter=function(e){this.gridOptionsService.set("excludeHiddenColumnsFromQuickFilter",e)},e.prototype.selectAll=function(e){void 0===e&&(e="apiSelectAll"),this.selectionService.selectAllRowNodes({source:e})},e.prototype.deselectAll=function(e){void 0===e&&(e="apiSelectAll"),this.selectionService.deselectAllRowNodes({source:e})},e.prototype.selectAllFiltered=function(e){void 0===e&&(e="apiSelectAllFiltered"),this.selectionService.selectAllRowNodes({source:e,justFiltered:!0})},e.prototype.deselectAllFiltered=function(e){void 0===e&&(e="apiSelectAllFiltered"),this.selectionService.deselectAllRowNodes({source:e,justFiltered:!0})},e.prototype.getServerSideSelectionState=function(){return i(this.serverSideRowModel)?(this.logMissingRowModel("getServerSideSelectionState","serverSide"),null):this.selectionService.getServerSideSelectionState()},e.prototype.setServerSideSelectionState=function(e){i(this.serverSideRowModel)?this.logMissingRowModel("setServerSideSelectionState","serverSide"):this.selectionService.setServerSideSelectionState(e)},e.prototype.selectAllOnCurrentPage=function(e){void 0===e&&(e="apiSelectAllCurrentPage"),this.selectionService.selectAllRowNodes({source:e,justCurrentPage:!0})},e.prototype.deselectAllOnCurrentPage=function(e){void 0===e&&(e="apiSelectAllCurrentPage"),this.selectionService.deselectAllRowNodes({source:e,justCurrentPage:!0})},e.prototype.sizeColumnsToFit=function(e){this.gridBodyCtrl.sizeColumnsToFit(e)},e.prototype.showLoadingOverlay=function(){this.overlayWrapperComp.showLoadingOverlay()},e.prototype.showNoRowsOverlay=function(){this.overlayWrapperComp.showNoRowsOverlay()},e.prototype.hideOverlay=function(){this.overlayWrapperComp.hideOverlay()},e.prototype.getSelectedNodes=function(){return this.selectionService.getSelectedNodes()},e.prototype.getSelectedRows=function(){return this.selectionService.getSelectedRows()},e.prototype.getBestCostNodeSelection=function(){if(!i(this.clientSideRowModel))return this.selectionService.getBestCostNodeSelection();this.logMissingRowModel("getBestCostNodeSelection","clientSide")},e.prototype.getRenderedNodes=function(){return this.rowRenderer.getRenderedNodes()},e.prototype.ensureColumnVisible=function(e,t){void 0===t&&(t="auto"),this.gridBodyCtrl.getScrollFeature().ensureColumnVisible(e,t)},e.prototype.ensureIndexVisible=function(e,t){this.gridBodyCtrl.getScrollFeature().ensureIndexVisible(e,t)},e.prototype.ensureNodeVisible=function(e,t){void 0===t&&(t=null),this.gridBodyCtrl.getScrollFeature().ensureNodeVisible(e,t)},e.prototype.forEachLeafNode=function(e){i(this.clientSideRowModel)?this.logMissingRowModel("forEachLeafNode","clientSide"):this.clientSideRowModel.forEachLeafNode(e)},e.prototype.forEachNode=function(e,t){this.rowModel.forEachNode(e,t)},e.prototype.forEachNodeAfterFilter=function(e){i(this.clientSideRowModel)?this.logMissingRowModel("forEachNodeAfterFilter","clientSide"):this.clientSideRowModel.forEachNodeAfterFilter(e)},e.prototype.forEachNodeAfterFilterAndSort=function(e){i(this.clientSideRowModel)?this.logMissingRowModel("forEachNodeAfterFilterAndSort","clientSide"):this.clientSideRowModel.forEachNodeAfterFilterAndSort(e)},e.prototype.getFilterInstance=function(e,t){var o=this.getFilterInstanceImpl(e,(function(e){if(t){var o=Ps(e);t(o)}}));return Ps(o)},e.prototype.getFilterInstanceImpl=function(e,t){var o=this.columnModel.getPrimaryColumn(e);if(o){var n=this.filterManager.getFilterComponent(o,"NO_UI"),r=n&&n.resolveNow(null,(function(e){return e}));return r?setTimeout(t,0,r):n&&n.then((function(e){t(e)})),r}},e.prototype.destroyFilter=function(e){var t=this.columnModel.getPrimaryColumn(e);if(t)return this.filterManager.destroyFilter(t,"api")},e.prototype.getStatusPanel=function(e){if(ne.assertRegistered(Q.StatusBarModule,"api.getStatusPanel"))return Ps(this.statusBarService.getStatusPanel(e))},e.prototype.getColumnDef=function(e){var t=this.columnModel.getPrimaryColumn(e);return t?t.getColDef():null},e.prototype.getColumnDefs=function(){return this.columnModel.getColumnDefs()},e.prototype.onFilterChanged=function(){this.filterManager.onFilterChanged()},e.prototype.onSortChanged=function(){this.sortController.onSortChanged("api")},e.prototype.setFilterModel=function(e){this.filterManager.setFilterModel(e)},e.prototype.getFilterModel=function(){return this.filterManager.getFilterModel()},e.prototype.getFocusedCell=function(){return this.focusService.getFocusedCell()},e.prototype.clearFocusedCell=function(){return this.focusService.clearFocusedCell()},e.prototype.setFocusedCell=function(e,t,o){this.focusService.setFocusedCell({rowIndex:e,column:t,rowPinned:o,forceBrowserFocus:!0})},e.prototype.setSuppressRowDrag=function(e){this.gridOptionsService.set("suppressRowDrag",e)},e.prototype.setSuppressMoveWhenRowDragging=function(e){this.gridOptionsService.set("suppressMoveWhenRowDragging",e)},e.prototype.setSuppressRowClickSelection=function(e){this.gridOptionsService.set("suppressRowClickSelection",e)},e.prototype.addRowDropZone=function(e){this.gridBodyCtrl.getRowDragFeature().addRowDropZone(e)},e.prototype.removeRowDropZone=function(e){var t=this.dragAndDropService.findExternalZone(e);t&&this.dragAndDropService.removeDropTarget(t)},e.prototype.getRowDropZoneParams=function(e){return this.gridBodyCtrl.getRowDragFeature().getRowDropZone(e)},e.prototype.setHeaderHeight=function(e){this.gridOptionsService.set("headerHeight",e)},e.prototype.setDomLayout=function(e){this.clientSideRowModel||"autoHeight"!==e||this.gridOptionsService.is("pagination")?this.gridOptionsService.set("domLayout",e):console.error("AG Grid: domLayout can only be set to 'autoHeight' when using the client side row model or when using pagination.")},e.prototype.setEnableCellTextSelection=function(e){this.gridBodyCtrl.setCellTextSelection(e)},e.prototype.setFillHandleDirection=function(e){this.gridOptionsService.set("fillHandleDirection",e)},e.prototype.setGroupHeaderHeight=function(e){this.gridOptionsService.set("groupHeaderHeight",e)},e.prototype.setFloatingFiltersHeight=function(e){this.gridOptionsService.set("floatingFiltersHeight",e)},e.prototype.setPivotHeaderHeight=function(e){this.gridOptionsService.set("pivotHeaderHeight",e)},e.prototype.setPivotGroupHeaderHeight=function(e){this.gridOptionsService.set("pivotGroupHeaderHeight",e)},e.prototype.setPivotMode=function(e){this.columnModel.setPivotMode(e)},e.prototype.setAnimateRows=function(e){this.gridOptionsService.set("animateRows",e)},e.prototype.setIsExternalFilterPresent=function(e){this.gridOptionsService.set("isExternalFilterPresent",e)},e.prototype.setDoesExternalFilterPass=function(e){this.gridOptionsService.set("doesExternalFilterPass",e)},e.prototype.setNavigateToNextCell=function(e){this.gridOptionsService.set("navigateToNextCell",e)},e.prototype.setTabToNextCell=function(e){this.gridOptionsService.set("tabToNextCell",e)},e.prototype.setTabToNextHeader=function(e){this.gridOptionsService.set("tabToNextHeader",e)},e.prototype.setNavigateToNextHeader=function(e){this.gridOptionsService.set("navigateToNextHeader",e)},e.prototype.setRowGroupPanelShow=function(e){this.gridOptionsService.set("rowGroupPanelShow",e)},e.prototype.setGroupRowAggNodes=function(e){it("27.2","setGroupRowAggNodes","setGetGroupRowAgg"),this.gridOptionsService.set("groupRowAggNodes",e)},e.prototype.setGetGroupRowAgg=function(e){this.gridOptionsService.set("getGroupRowAgg",e)},e.prototype.setGetBusinessKeyForNode=function(e){this.gridOptionsService.set("getBusinessKeyForNode",e)},e.prototype.setGetChildCount=function(e){this.gridOptionsService.set("getChildCount",e)},e.prototype.setProcessRowPostCreate=function(e){this.gridOptionsService.set("processRowPostCreate",e)},e.prototype.setGetRowNodeId=function(e){it("27.1","setGetRowNodeId","setGetRowId"),this.gridOptionsService.set("getRowNodeId",e)},e.prototype.setGetRowId=function(e){this.gridOptionsService.set("getRowId",e)},e.prototype.setGetRowClass=function(e){this.gridOptionsService.set("getRowClass",e)},e.prototype.setIsFullWidthCell=function(e){it("27.2","setIsFullWidthCell","setIsFullWidthRow"),this.gridOptionsService.set("isFullWidthCell",e)},e.prototype.setIsFullWidthRow=function(e){this.gridOptionsService.set("isFullWidthRow",e)},e.prototype.setIsRowSelectable=function(e){this.gridOptionsService.set("isRowSelectable",e)},e.prototype.setIsRowMaster=function(e){this.gridOptionsService.set("isRowMaster",e)},e.prototype.setPostSort=function(e){it("27.2","setPostSort","setPostSortRows"),this.gridOptionsService.set("postSort",e)},e.prototype.setPostSortRows=function(e){this.gridOptionsService.set("postSortRows",e)},e.prototype.setGetDocument=function(e){this.gridOptionsService.set("getDocument",e)},e.prototype.setGetContextMenuItems=function(e){this.gridOptionsService.set("getContextMenuItems",e)},e.prototype.setGetMainMenuItems=function(e){this.gridOptionsService.set("getMainMenuItems",e)},e.prototype.setProcessCellForClipboard=function(e){this.gridOptionsService.set("processCellForClipboard",e)},e.prototype.setSendToClipboard=function(e){this.gridOptionsService.set("sendToClipboard",e)},e.prototype.setProcessCellFromClipboard=function(e){this.gridOptionsService.set("processCellFromClipboard",e)},e.prototype.setProcessSecondaryColDef=function(e){it("28.0","setProcessSecondaryColDef","setProcessPivotResultColDef"),this.setProcessPivotResultColDef(e)},e.prototype.setProcessSecondaryColGroupDef=function(e){it("28.0","setProcessSecondaryColGroupDef","setProcessPivotResultColGroupDef"),this.setProcessPivotResultColGroupDef(e)},e.prototype.setProcessPivotResultColDef=function(e){this.gridOptionsService.set("processPivotResultColDef",e)},e.prototype.setProcessPivotResultColGroupDef=function(e){this.gridOptionsService.set("processPivotResultColGroupDef",e)},e.prototype.setPostProcessPopup=function(e){this.gridOptionsService.set("postProcessPopup",e)},e.prototype.setDefaultGroupOrderComparator=function(e){it("27.2","setDefaultGroupOrderComparator","setInitialGroupOrderComparator"),this.gridOptionsService.set("defaultGroupOrderComparator",e)},e.prototype.setInitialGroupOrderComparator=function(e){this.gridOptionsService.set("initialGroupOrderComparator",e)},e.prototype.setGetChartToolbarItems=function(e){this.gridOptionsService.set("getChartToolbarItems",e)},e.prototype.setPaginationNumberFormatter=function(e){this.gridOptionsService.set("paginationNumberFormatter",e)},e.prototype.setGetServerSideStoreParams=function(e){it("28.0","setGetServerSideStoreParams","setGetServerSideGroupLevelParams"),this.setGetServerSideGroupLevelParams(e)},e.prototype.setGetServerSideGroupLevelParams=function(e){this.gridOptionsService.set("getServerSideGroupLevelParams",e)},e.prototype.setIsServerSideGroupOpenByDefault=function(e){this.gridOptionsService.set("isServerSideGroupOpenByDefault",e)},e.prototype.setIsApplyServerSideTransaction=function(e){this.gridOptionsService.set("isApplyServerSideTransaction",e)},e.prototype.setIsServerSideGroup=function(e){this.gridOptionsService.set("isServerSideGroup",e)},e.prototype.setGetServerSideGroupKey=function(e){this.gridOptionsService.set("getServerSideGroupKey",e)},e.prototype.setGetRowStyle=function(e){this.gridOptionsService.set("getRowStyle",e)},e.prototype.setGetRowHeight=function(e){this.gridOptionsService.set("getRowHeight",e)},e.prototype.assertSideBarLoaded=function(e){return ne.assertRegistered(Q.SideBarModule,"api."+e)},e.prototype.isSideBarVisible=function(){return this.assertSideBarLoaded("isSideBarVisible")&&this.sideBarComp.isDisplayed()},e.prototype.setSideBarVisible=function(e){this.assertSideBarLoaded("setSideBarVisible")&&this.sideBarComp.setDisplayed(e)},e.prototype.setSideBarPosition=function(e){this.assertSideBarLoaded("setSideBarPosition")&&this.sideBarComp.setSideBarPosition(e)},e.prototype.openToolPanel=function(e){this.assertSideBarLoaded("openToolPanel")&&this.sideBarComp.openToolPanel(e,"api")},e.prototype.closeToolPanel=function(){this.assertSideBarLoaded("closeToolPanel")&&this.sideBarComp.close("api")},e.prototype.getOpenedToolPanel=function(){return this.assertSideBarLoaded("getOpenedToolPanel")?this.sideBarComp.openedItem():null},e.prototype.refreshToolPanel=function(){this.assertSideBarLoaded("refreshToolPanel")&&this.sideBarComp.refresh()},e.prototype.isToolPanelShowing=function(){return this.assertSideBarLoaded("isToolPanelShowing")&&this.sideBarComp.isToolPanelShowing()},e.prototype.getToolPanelInstance=function(e){if(this.assertSideBarLoaded("getToolPanelInstance"))return Ps(this.sideBarComp.getToolPanelInstance(e))},e.prototype.getSideBar=function(){if(this.assertSideBarLoaded("getSideBar"))return this.sideBarComp.getDef()},e.prototype.setSideBar=function(e){this.gridOptionsService.set("sideBar",e)},e.prototype.setSuppressClipboardPaste=function(e){this.gridOptionsService.set("suppressClipboardPaste",e)},e.prototype.resetRowHeights=function(){if(r(this.clientSideRowModel)){if(this.columnModel.isAutoRowHeightActive())return void console.warn("AG Grid: calling gridApi.resetRowHeights() makes no sense when using Auto Row Height.");this.clientSideRowModel.resetRowHeights()}},e.prototype.setGroupRemoveSingleChildren=function(e){this.gridOptionsService.set("groupRemoveSingleChildren",e)},e.prototype.setGroupRemoveLowestSingleChildren=function(e){this.gridOptionsService.set("groupRemoveLowestSingleChildren",e)},e.prototype.setGroupDisplayType=function(e){this.gridOptionsService.set("groupDisplayType",e)},e.prototype.setRowClass=function(e){this.gridOptionsService.set("rowClass",e)},e.prototype.setDeltaSort=function(e){this.gridOptionsService.set("deltaSort",e)},e.prototype.setRowCount=function(e,t){if(this.serverSideRowModel)return this.columnModel.isRowGroupEmpty()?void this.serverSideRowModel.setRowCount(e,t):void console.error("AG Grid: setRowCount cannot be used while using row grouping.");this.infiniteRowModel?this.infiniteRowModel.setRowCount(e,t):this.logMissingRowModel("setRowCount","infinite","serverSide")},e.prototype.onRowHeightChanged=function(){this.clientSideRowModel?this.clientSideRowModel.onRowHeightChanged():this.serverSideRowModel&&this.serverSideRowModel.onRowHeightChanged()},e.prototype.getValue=function(e,t){var o=this.columnModel.getPrimaryColumn(e);return i(o)&&(o=this.columnModel.getGridColumn(e)),i(o)?null:this.valueService.getValue(o,t)},e.prototype.addEventListener=function(e,t){var o=this.gridOptionsService.useAsyncEvents();this.eventService.addEventListener(e,t,o)},e.prototype.addGlobalListener=function(e){var t=this.gridOptionsService.useAsyncEvents();this.eventService.addGlobalListener(e,t)},e.prototype.removeEventListener=function(e,t){var o=this.gridOptionsService.useAsyncEvents();this.eventService.removeEventListener(e,t,o)},e.prototype.removeGlobalListener=function(e){var t=this.gridOptionsService.useAsyncEvents();this.eventService.removeGlobalListener(e,t)},e.prototype.dispatchEvent=function(e){this.eventService.dispatchEvent(e)},e.prototype.destroy=function(){if(!this.destroyCalled){this.destroyCalled=!0;var e=this.ctrlsService.getGridCtrl();e&&e.destroyGridUi(),this.context.destroy()}},e.prototype.cleanDownReferencesToAvoidMemoryLeakInCaseApplicationIsKeepingReferenceToDestroyedGrid=function(){setTimeout(_.bind(window,this,"Grid API"),100)},e.prototype.warnIfDestroyed=function(e){return this.destroyCalled&&console.warn("AG Grid: Grid API method "+e+" was called on a grid that was destroyed."),this.destroyCalled},e.prototype.resetQuickFilter=function(){this.warnIfDestroyed("resetQuickFilter")||this.filterManager.resetQuickFilterCache()},e.prototype.getCellRanges=function(){return this.rangeService?this.rangeService.getCellRanges():(ne.assertRegistered(Q.RangeSelectionModule,"api.getCellRanges"),null)},e.prototype.addCellRange=function(e){this.rangeService?this.rangeService.addCellRange(e):ne.assertRegistered(Q.RangeSelectionModule,"api.addCellRange")},e.prototype.clearRangeSelection=function(){this.rangeService&&this.rangeService.removeAllCellRanges(),ne.assertRegistered(Q.RangeSelectionModule,"gridApi.clearRangeSelection")},e.prototype.undoCellEditing=function(){this.undoRedoService.undo("api")},e.prototype.redoCellEditing=function(){this.undoRedoService.redo("api")},e.prototype.getCurrentUndoSize=function(){return this.undoRedoService.getCurrentUndoStackSize()},e.prototype.getCurrentRedoSize=function(){return this.undoRedoService.getCurrentRedoStackSize()},e.prototype.getChartModels=function(){if(ne.assertRegistered(Q.GridChartsModule,"api.getChartModels"))return this.chartService.getChartModels()},e.prototype.getChartRef=function(e){if(ne.assertRegistered(Q.GridChartsModule,"api.getChartRef"))return this.chartService.getChartRef(e)},e.prototype.getChartImageDataURL=function(e){if(ne.assertRegistered(Q.GridChartsModule,"api.getChartImageDataURL"))return this.chartService.getChartImageDataURL(e)},e.prototype.downloadChart=function(e){if(ne.assertRegistered(Q.GridChartsModule,"api.downloadChart"))return this.chartService.downloadChart(e)},e.prototype.openChartToolPanel=function(e){if(ne.assertRegistered(Q.GridChartsModule,"api.openChartToolPanel"))return this.chartService.openChartToolPanel(e)},e.prototype.closeChartToolPanel=function(e){if(ne.assertRegistered(Q.GridChartsModule,"api.closeChartToolPanel"))return this.chartService.closeChartToolPanel(e.chartId)},e.prototype.createRangeChart=function(e){if(ne.assertRegistered(Q.GridChartsModule,"api.createRangeChart"))return this.chartService.createRangeChart(e)},e.prototype.createCrossFilterChart=function(e){if(ne.assertRegistered(Q.GridChartsModule,"api.createCrossFilterChart"))return this.chartService.createCrossFilterChart(e)},e.prototype.restoreChart=function(e,t){if(ne.assertRegistered(Q.GridChartsModule,"api.restoreChart"))return this.chartService.restoreChart(e,t)},e.prototype.createPivotChart=function(e){if(ne.assertRegistered(Q.GridChartsModule,"api.createPivotChart"))return this.chartService.createPivotChart(e)},e.prototype.copyToClipboard=function(e){ne.assertRegistered(Q.ClipboardModule,"api.copyToClipboard")&&this.clipboardService.copyToClipboard(e)},e.prototype.cutToClipboard=function(e){ne.assertRegistered(Q.ClipboardModule,"api.cutToClipboard")&&this.clipboardService.cutToClipboard(e)},e.prototype.copySelectedRowsToClipboard=function(e){ne.assertRegistered(Q.ClipboardModule,"api.copySelectedRowsToClipboard")&&this.clipboardService.copySelectedRowsToClipboard(e)},e.prototype.copySelectedRangeToClipboard=function(e){ne.assertRegistered(Q.ClipboardModule,"api.copySelectedRangeToClipboard")&&this.clipboardService.copySelectedRangeToClipboard(e)},e.prototype.copySelectedRangeDown=function(){ne.assertRegistered(Q.ClipboardModule,"api.copySelectedRangeDown")&&this.clipboardService.copyRangeDown()},e.prototype.showColumnMenuAfterButtonClick=function(e,t){var o=this.columnModel.getGridColumn(e);this.menuFactory.showMenuAfterButtonClick(o,t,"columnMenu")},e.prototype.showColumnMenuAfterMouseClick=function(e,t){var o=this.columnModel.getGridColumn(e);o||(o=this.columnModel.getPrimaryColumn(e)),o?this.menuFactory.showMenuAfterMouseEvent(o,t):console.error("AG Grid: column '"+e+"' not found")},e.prototype.hidePopupMenu=function(){this.contextMenuFactory&&this.contextMenuFactory.hideActiveMenu(),this.menuFactory.hideActiveMenu()},e.prototype.setPopupParent=function(e){this.gridOptionsService.set("popupParent",e)},e.prototype.tabToNextCell=function(e){return this.navigationService.tabToNextCell(!1,e)},e.prototype.tabToPreviousCell=function(e){return this.navigationService.tabToNextCell(!0,e)},e.prototype.getCellRendererInstances=function(e){return void 0===e&&(e={}),this.rowRenderer.getCellRendererInstances(e).map(Ps)},e.prototype.getCellEditorInstances=function(e){return void 0===e&&(e={}),this.rowRenderer.getCellEditorInstances(e).map(Ps)},e.prototype.getEditingCells=function(){return this.rowRenderer.getEditingCells()},e.prototype.stopEditing=function(e){void 0===e&&(e=!1),this.rowRenderer.stopEditing(e)},e.prototype.startEditingCell=function(e){var t=this.columnModel.getGridColumn(e.colKey);if(t){var o={rowIndex:e.rowIndex,rowPinned:e.rowPinned||null,column:t};null==e.rowPinned&&this.gridBodyCtrl.getScrollFeature().ensureIndexVisible(e.rowIndex);var n=this.navigationService.getCellByPosition(o);n&&n.startRowOrCellEdit(e.key,e.charPress)}else console.warn("AG Grid: no column found for "+e.colKey)},e.prototype.addAggFunc=function(e,t){this.aggFuncService&&this.aggFuncService.addAggFunc(e,t)},e.prototype.addAggFuncs=function(e){this.aggFuncService&&this.aggFuncService.addAggFuncs(e)},e.prototype.clearAggFuncs=function(){this.aggFuncService&&this.aggFuncService.clear()},e.prototype.applyServerSideTransaction=function(e){if(this.serverSideTransactionManager)return this.serverSideTransactionManager.applyTransaction(e);this.logMissingRowModel("applyServerSideTransaction","serverSide")},e.prototype.applyServerSideTransactionAsync=function(e,t){if(this.serverSideTransactionManager)return this.serverSideTransactionManager.applyTransactionAsync(e,t);this.logMissingRowModel("applyServerSideTransactionAsync","serverSide")},e.prototype.retryServerSideLoads=function(){this.serverSideRowModel?this.serverSideRowModel.retryLoads():this.logMissingRowModel("retryServerSideLoads","serverSide")},e.prototype.flushServerSideAsyncTransactions=function(){if(this.serverSideTransactionManager)return this.serverSideTransactionManager.flushAsyncTransactions();this.logMissingRowModel("flushServerSideAsyncTransactions","serverSide")},e.prototype.applyTransaction=function(e){if(this.clientSideRowModel){var t=this.clientSideRowModel.updateRowData(e);return this.gridOptionsService.is("suppressChangeDetection")||this.rowRenderer.refreshCells(),t}this.logMissingRowModel("applyTransaction","clientSide")},e.prototype.applyTransactionAsync=function(e,t){this.clientSideRowModel?this.clientSideRowModel.batchUpdateRowData(e,t):this.logMissingRowModel("applyTransactionAsync","clientSide")},e.prototype.flushAsyncTransactions=function(){this.clientSideRowModel?this.clientSideRowModel.flushAsyncTransactions():this.logMissingRowModel("flushAsyncTransactions","clientSide")},e.prototype.setSuppressModelUpdateAfterUpdateTransaction=function(e){this.gridOptionsService.set("suppressModelUpdateAfterUpdateTransaction",e)},e.prototype.refreshInfiniteCache=function(){this.infiniteRowModel?this.infiniteRowModel.refreshCache():this.logMissingRowModel("refreshInfiniteCache","infinite")},e.prototype.purgeInfiniteCache=function(){this.infiniteRowModel?this.infiniteRowModel.purgeCache():this.logMissingRowModel("purgeInfiniteCache","infinite")},e.prototype.refreshServerSide=function(e){this.serverSideRowModel?this.serverSideRowModel.refreshStore(e):this.logMissingRowModel("refreshServerSide","serverSide")},e.prototype.refreshServerSideStore=function(e){return it("28.0","refreshServerSideStore","refreshServerSide"),this.refreshServerSide(e)},e.prototype.getServerSideStoreState=function(){return it("28.0","getServerSideStoreState","getServerSideGroupLevelState"),this.getServerSideGroupLevelState()},e.prototype.getServerSideGroupLevelState=function(){return this.serverSideRowModel?this.serverSideRowModel.getStoreState():(this.logMissingRowModel("getServerSideGroupLevelState","serverSide"),[])},e.prototype.getInfiniteRowCount=function(){if(this.infiniteRowModel)return this.infiniteRowModel.getRowCount();this.logMissingRowModel("getInfiniteRowCount","infinite")},e.prototype.isLastRowIndexKnown=function(){if(this.infiniteRowModel)return this.infiniteRowModel.isLastRowIndexKnown();this.logMissingRowModel("isLastRowIndexKnown","infinite")},e.prototype.getCacheBlockState=function(){return this.rowNodeBlockLoader.getBlockState()},e.prototype.getFirstDisplayedRow=function(){return this.rowRenderer.getFirstVirtualRenderedRow()},e.prototype.getLastDisplayedRow=function(){return this.rowRenderer.getLastVirtualRenderedRow()},e.prototype.getDisplayedRowAtIndex=function(e){return this.rowModel.getRow(e)},e.prototype.getDisplayedRowCount=function(){return this.rowModel.getRowCount()},e.prototype.setPagination=function(e){this.clientSideRowModel||"autoHeight"!==this.gridOptionsService.get("domLayout")||e?this.gridOptionsService.set("pagination",e):console.error("AG Grid: Pagination cannot be disabled when using domLayout set to 'autoHeight' unless using the client-side row model.")},e.prototype.paginationIsLastPageFound=function(){return this.paginationProxy.isLastPageFound()},e.prototype.paginationGetPageSize=function(){return this.paginationProxy.getPageSize()},e.prototype.paginationSetPageSize=function(e){this.gridOptionsService.set("paginationPageSize",e)},e.prototype.paginationGetCurrentPage=function(){return this.paginationProxy.getCurrentPage()},e.prototype.paginationGetTotalPages=function(){return this.paginationProxy.getTotalPages()},e.prototype.paginationGetRowCount=function(){return this.paginationProxy.getMasterRowCount()},e.prototype.paginationGoToNextPage=function(){this.paginationProxy.goToNextPage()},e.prototype.paginationGoToPreviousPage=function(){this.paginationProxy.goToPreviousPage()},e.prototype.paginationGoToFirstPage=function(){this.paginationProxy.goToFirstPage()},e.prototype.paginationGoToLastPage=function(){this.paginationProxy.goToLastPage()},e.prototype.paginationGoToPage=function(e){this.paginationProxy.goToPage(e)},Ds([K("immutableService")],e.prototype,"immutableService",void 0),Ds([K("csvCreator")],e.prototype,"csvCreator",void 0),Ds([K("excelCreator")],e.prototype,"excelCreator",void 0),Ds([q("rowRenderer")],e.prototype,"rowRenderer",void 0),Ds([q("navigationService")],e.prototype,"navigationService",void 0),Ds([q("filterManager")],e.prototype,"filterManager",void 0),Ds([q("columnModel")],e.prototype,"columnModel",void 0),Ds([q("selectionService")],e.prototype,"selectionService",void 0),Ds([q("gridOptionsService")],e.prototype,"gridOptionsService",void 0),Ds([q("valueService")],e.prototype,"valueService",void 0),Ds([q("alignedGridsService")],e.prototype,"alignedGridsService",void 0),Ds([q("eventService")],e.prototype,"eventService",void 0),Ds([q("pinnedRowModel")],e.prototype,"pinnedRowModel",void 0),Ds([q("context")],e.prototype,"context",void 0),Ds([q("rowModel")],e.prototype,"rowModel",void 0),Ds([q("sortController")],e.prototype,"sortController",void 0),Ds([q("paginationProxy")],e.prototype,"paginationProxy",void 0),Ds([q("focusService")],e.prototype,"focusService",void 0),Ds([q("dragAndDropService")],e.prototype,"dragAndDropService",void 0),Ds([K("rangeService")],e.prototype,"rangeService",void 0),Ds([K("clipboardService")],e.prototype,"clipboardService",void 0),Ds([K("aggFuncService")],e.prototype,"aggFuncService",void 0),Ds([q("menuFactory")],e.prototype,"menuFactory",void 0),Ds([K("contextMenuFactory")],e.prototype,"contextMenuFactory",void 0),Ds([q("valueCache")],e.prototype,"valueCache",void 0),Ds([q("animationFrameService")],e.prototype,"animationFrameService",void 0),Ds([K("statusBarService")],e.prototype,"statusBarService",void 0),Ds([K("chartService")],e.prototype,"chartService",void 0),Ds([K("undoRedoService")],e.prototype,"undoRedoService",void 0),Ds([K("rowNodeBlockLoader")],e.prototype,"rowNodeBlockLoader",void 0),Ds([K("ssrmTransactionManager")],e.prototype,"serverSideTransactionManager",void 0),Ds([q("ctrlsService")],e.prototype,"ctrlsService",void 0),Ds([$],e.prototype,"init",null),Ds([U],e.prototype,"cleanDownReferencesToAvoidMemoryLeakInCaseApplicationIsKeepingReferenceToDestroyedGrid",null),e=Ds([W("gridApi")],e)}(),Ms=function(){var e=function(t,o){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])},e(t,o)};return function(t,o){function n(){this.constructor=t}e(t,o),t.prototype=null===o?Object.create(o):(n.prototype=o.prototype,new n)}}(),Ls=function(){return Ls=Object.assign||function(e){for(var t,o=1,n=arguments.length;o<n;o++)for(var r in t=arguments[o])Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e},Ls.apply(this,arguments)},Fs=function(e,t,o,n){var r,i=arguments.length,a=i<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,o):n;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)a=Reflect.decorate(e,t,o,n);else for(var s=e.length-1;s>=0;s--)(r=e[s])&&(a=(i<3?r(a):i>3?r(t,o,a):r(t,o))||a);return i>3&&a&&Object.defineProperty(t,o,a),a},Gs=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.allColumnFilters=new Map,t.activeAggregateFilters=[],t.activeColumnFilters=[],t.quickFilter=null,t.quickFilterParts=null,t.processingFilterChange=!1,t}var o;return Ms(t,e),o=t,t.prototype.init=function(){var e=this;this.addManagedListener(this.eventService,$e.EVENT_GRID_COLUMNS_CHANGED,(function(){return e.onColumnsChanged()})),this.addManagedListener(this.eventService,$e.EVENT_COLUMN_VALUE_CHANGED,(function(){return e.refreshFiltersForAggregations()})),this.addManagedListener(this.eventService,$e.EVENT_COLUMN_PIVOT_CHANGED,(function(){return e.refreshFiltersForAggregations()})),this.addManagedListener(this.eventService,$e.EVENT_COLUMN_PIVOT_MODE_CHANGED,(function(){e.refreshFiltersForAggregations(),e.resetQuickFilterCache()})),this.addManagedListener(this.eventService,$e.EVENT_NEW_COLUMNS_LOADED,(function(){return e.resetQuickFilterCache()})),this.addManagedListener(this.eventService,$e.EVENT_COLUMN_ROW_GROUP_CHANGED,(function(){return e.resetQuickFilterCache()})),this.addManagedListener(this.eventService,$e.EVENT_COLUMN_VISIBLE,(function(){e.gridOptionsService.is("excludeHiddenColumnsFromQuickFilter")&&e.resetQuickFilterCache()})),this.addManagedPropertyListener("quickFilterText",(function(t){return e.setQuickFilter(t.currentValue)})),this.addManagedPropertyListener("excludeHiddenColumnsFromQuickFilter",(function(){return e.onExcludeHiddenColumnsFromQuickFilterChanged()})),this.quickFilter=this.parseQuickFilter(this.gridOptionsService.get("quickFilterText")),this.setQuickFilterParts(),this.allowShowChangeAfterFilter=this.gridOptionsService.is("allowShowChangeAfterFilter"),this.externalFilterPresent=this.isExternalFilterPresentCallback()},t.prototype.isExternalFilterPresentCallback=function(){var e=this.gridOptionsService.getCallback("isExternalFilterPresent");return"function"===typeof e&&e({})},t.prototype.doesExternalFilterPass=function(e){var t=this.gridOptionsService.get("doesExternalFilterPass");return"function"===typeof t&&t(e)},t.prototype.setQuickFilterParts=function(){this.quickFilterParts=this.quickFilter?this.quickFilter.split(" "):null},t.prototype.setFilterModel=function(e){var t=this,o=[],n=this.getFilterModel();if(e){var r=Xn(Object.keys(e));this.allColumnFilters.forEach((function(n,i){var a=e[i];o.push(t.setModelOnFilterWrapper(n.filterPromise,a)),r.delete(i)})),r.forEach((function(n){var r=t.columnModel.getPrimaryColumn(n)||t.columnModel.getGridColumn(n);if(r)if(r.isFilterAllowed()){var i=t.getOrCreateFilterWrapper(r,"NO_UI");i?o.push(t.setModelOnFilterWrapper(i.filterPromise,e[n])):console.warn("AG-Grid: setFilterModel() - unable to fully apply model, unable to create filter for colId: "+n)}else console.warn("AG Grid: setFilterModel() - unable to fully apply model, filtering disabled for colId: "+n);else console.warn("AG Grid: setFilterModel() - no column found for colId: "+n)}))}else this.allColumnFilters.forEach((function(e){o.push(t.setModelOnFilterWrapper(e.filterPromise,null))}));rr.all(o).then((function(){var e=t.getFilterModel(),o=[];t.allColumnFilters.forEach((function(t,r){var i=n?n[r]:null,a=e?e[r]:null;tr.jsonEquals(i,a)||o.push(t.column)})),o.length>0&&t.onFilterChanged({columns:o})}))},t.prototype.setModelOnFilterWrapper=function(e,t){return new rr((function(o){e.then((function(e){"function"!==typeof e.setModel&&(console.warn("AG Grid: filter missing setModel method, which is needed for setFilterModel"),o()),(e.setModel(t)||rr.resolve()).then((function(){return o()}))}))}))},t.prototype.getFilterModel=function(){var e={};return this.allColumnFilters.forEach((function(t,o){var n=t.filterPromise.resolveNow(null,(function(e){return e}));if(null==n)return null;if("function"===typeof n.getModel){var i=n.getModel();r(i)&&(e[o]=i)}else console.warn("AG Grid: filter API missing getModel method, which is needed for getFilterModel")})),e},t.prototype.isColumnFilterPresent=function(){return this.activeColumnFilters.length>0},t.prototype.isAggregateFilterPresent=function(){return!!this.activeAggregateFilters.length},t.prototype.isExternalFilterPresent=function(){return this.externalFilterPresent},t.prototype.doAggregateFiltersPass=function(e,t){return this.doColumnFiltersPass(e,t,!0)},t.prototype.updateActiveFilters=function(){var e=this;this.activeColumnFilters.length=0,this.activeAggregateFilters.length=0;var t=function(e){return!!e&&(e.isFilterActive?e.isFilterActive():(console.warn("AG Grid: Filter is missing isFilterActive() method"),!1))},o=!!this.gridOptionsService.getGroupAggFiltering();this.allColumnFilters.forEach((function(n){if(n.filterPromise.resolveNow(!1,t)){var r=n.filterPromise.resolveNow(null,(function(e){return e}));!function(t){if(!t.isPrimary())return!0;var n=!e.columnModel.isPivotActive();return!(!t.isValueActive()||!n)&&(!!e.columnModel.isPivotMode()||o)}(n.column)?e.activeColumnFilters.push(r):e.activeAggregateFilters.push(r)}}))},t.prototype.updateFilterFlagInColumns=function(e,t){this.allColumnFilters.forEach((function(o){var n=o.filterPromise.resolveNow(!1,(function(e){return e.isFilterActive()}));o.column.setFilterActive(n,e,t)}))},t.prototype.isAnyFilterPresent=function(){return this.isQuickFilterPresent()||this.isColumnFilterPresent()||this.isAggregateFilterPresent()||this.isExternalFilterPresent()},t.prototype.doColumnFiltersPass=function(e,t,o){for(var n=e.data,r=e.aggData,i=o?this.activeAggregateFilters:this.activeColumnFilters,a=o?r:n,s=0;s<i.length;s++){var l=i[s];if(null!=l&&l!==t){if("function"!==typeof l.doesFilterPass)throw new Error("Filter is missing method doesFilterPass");if(!l.doesFilterPass({node:e,data:a}))return!1}}return!0},t.prototype.parseQuickFilter=function(e){return r(e)?this.gridOptionsService.isRowModelType("clientSide")?e.toUpperCase():(console.warn("AG Grid - Quick filtering only works with the Client-Side Row Model"),null):null},t.prototype.setQuickFilter=function(e){if(null==e||"string"===typeof e){var t=this.parseQuickFilter(e);this.quickFilter!==t&&(this.quickFilter=t,this.setQuickFilterParts(),this.onFilterChanged())}else console.warn("AG Grid - setQuickFilter() only supports string inputs, received: "+typeof e)},t.prototype.resetQuickFilterCache=function(){this.rowModel.forEachNode((function(e){return e.quickFilterAggregateText=null}))},t.prototype.onExcludeHiddenColumnsFromQuickFilterChanged=function(){this.columnModel.refreshQuickFilterColumns(),this.resetQuickFilterCache(),this.isQuickFilterPresent()&&this.onFilterChanged()},t.prototype.refreshFiltersForAggregations=function(){this.gridOptionsService.getGroupAggFiltering()&&this.onFilterChanged()},t.prototype.callOnFilterChangedOutsideRenderCycle=function(e){var t=this;void 0===e&&(e={});var o=function(){return t.onFilterChanged(e)};this.rowRenderer.isRefreshInProgress()?setTimeout(o,0):o()},t.prototype.onFilterChanged=function(e){void 0===e&&(e={});var t=e.filterInstance,o=e.additionalEventAttributes,n=e.columns;this.updateDependantFilters(),this.updateActiveFilters(),this.updateFilterFlagInColumns("filterChanged",o),this.externalFilterPresent=this.isExternalFilterPresentCallback(),this.allColumnFilters.forEach((function(e){e.filterPromise&&e.filterPromise.then((function(e){e&&e!==t&&e.onAnyFilterChanged&&e.onAnyFilterChanged()}))}));var r={type:$e.EVENT_FILTER_CHANGED,columns:n||[]};o&&w(r,o),this.processingFilterChange=!0,this.eventService.dispatchEvent(r),this.processingFilterChange=!1},t.prototype.isSuppressFlashingCellsBecauseFiltering=function(){return!this.allowShowChangeAfterFilter&&this.processingFilterChange},t.prototype.isQuickFilterPresent=function(){return null!==this.quickFilter},t.prototype.doesRowPassOtherFilters=function(e,t){return this.doesRowPassFilter({rowNode:t,filterInstanceToSkip:e})},t.prototype.doesRowPassQuickFilterNoCache=function(e,t){var o=this;return this.columnModel.getAllColumnsForQuickFilter().some((function(n){var i=o.getQuickFilterTextForColumn(n,e);return r(i)&&i.indexOf(t)>=0}))},t.prototype.doesRowPassQuickFilterCache=function(e,t){return e.quickFilterAggregateText||this.aggregateRowForQuickFilter(e),e.quickFilterAggregateText.indexOf(t)>=0},t.prototype.doesRowPassQuickFilter=function(e){var t=this,o=this.gridOptionsService.is("cacheQuickFilter");return this.quickFilterParts.every((function(n){return o?t.doesRowPassQuickFilterCache(e,n):t.doesRowPassQuickFilterNoCache(e,n)}))},t.prototype.doesRowPassAggregateFilters=function(e){return!(this.isAggregateFilterPresent()&&!this.doAggregateFiltersPass(e.rowNode,e.filterInstanceToSkip))},t.prototype.doesRowPassFilter=function(e){return!(this.isQuickFilterPresent()&&!this.doesRowPassQuickFilter(e.rowNode))&&(!(this.isExternalFilterPresent()&&!this.doesExternalFilterPass(e.rowNode))&&!(this.isColumnFilterPresent()&&!this.doColumnFiltersPass(e.rowNode,e.filterInstanceToSkip)))},t.prototype.getQuickFilterTextForColumn=function(e,t){var o=this.valueService.getValue(e,t,!0),n=e.getColDef();if(n.getQuickFilterText){var i={value:o,node:t,data:t.data,column:e,colDef:n,api:this.gridOptionsService.api,columnApi:this.gridOptionsService.columnApi,context:this.gridOptionsService.context};o=n.getQuickFilterText(i)}return r(o)?o.toString().toUpperCase():null},t.prototype.aggregateRowForQuickFilter=function(e){var t=this,n=[];this.columnModel.getAllColumnsForQuickFilter().forEach((function(o){var i=t.getQuickFilterTextForColumn(o,e);r(i)&&n.push(i)})),e.quickFilterAggregateText=n.join(o.QUICK_FILTER_SEPARATOR)},t.prototype.onNewRowsLoaded=function(e){this.allColumnFilters.forEach((function(e){e.filterPromise.then((function(e){e.onNewRowsLoaded&&e.onNewRowsLoaded()}))})),this.updateFilterFlagInColumns(e,{afterDataChange:!0}),this.updateActiveFilters()},t.prototype.createValueGetter=function(e){var t=this;return function(o){var n=o.node;return t.valueService.getValue(e,n,!0)}},t.prototype.getFilterComponent=function(e,t,o){var n;if(void 0===o&&(o=!0),o)return(null===(n=this.getOrCreateFilterWrapper(e,t))||void 0===n?void 0:n.filterPromise)||null;var r=this.cachedFilter(e);return r?r.filterPromise:null},t.prototype.isFilterActive=function(e){var t=this.cachedFilter(e);return!!t&&t.filterPromise.resolveNow(!1,(function(e){return e.isFilterActive()}))},t.prototype.getOrCreateFilterWrapper=function(e,t){if(!e.isFilterAllowed())return null;var o=this.cachedFilter(e);return o?"NO_UI"!==t&&this.putIntoGui(o,t):(o=this.createFilterWrapper(e,t),this.allColumnFilters.set(e.getColId(),o)),o},t.prototype.cachedFilter=function(e){return this.allColumnFilters.get(e.getColId())},t.prototype.createFilterInstance=function(e){var t,o=this,n=ne.isRegistered(Q.SetFilterModule)?"agSetColumnFilter":"agTextColumnFilter",r=e.getColDef(),i=Ls(Ls({},this.createFilterParams(e,r)),{filterModifiedCallback:function(){var n={type:$e.EVENT_FILTER_MODIFIED,column:e,filterInstance:t};o.eventService.dispatchEvent(n)},filterChangedCallback:function(n){var r={filterInstance:t,additionalEventAttributes:n,columns:[e]};o.callOnFilterChangedOutsideRenderCycle(r)},doesRowPassOtherFilter:function(e){return o.doesRowPassOtherFilters(t,e)}}),a=this.userComponentFactory.getFilterDetails(r,i,n);if(!a)return null;var s=a.newAgStackInstance();return s&&s.then((function(e){return t=e})),s},t.prototype.createFilterParams=function(e,t){return{column:e,colDef:f(t),rowModel:this.rowModel,filterChangedCallback:function(){},filterModifiedCallback:function(){},valueGetter:this.createValueGetter(e),doesRowPassOtherFilter:function(){return!0},api:this.gridOptionsService.api,columnApi:this.gridOptionsService.columnApi,context:this.gridOptionsService.context}},t.prototype.createFilterWrapper=function(e,t){var o={column:e,filterPromise:null,compiledElement:null,guiPromise:rr.resolve(null)};return o.filterPromise=this.createFilterInstance(e),o.filterPromise&&this.putIntoGui(o,t),o},t.prototype.putIntoGui=function(e,t){var o=this,n=document.createElement("div");n.className="ag-filter",e.guiPromise=new rr((function(i){e.filterPromise.then((function(a){var s=a.getGui();r(s)||console.warn("AG Grid: getGui method from filter returned "+s+", it should be a DOM element or an HTML template string."),"string"===typeof s&&(s=vn(s)),n.appendChild(s),i(n);var l={type:$e.EVENT_FILTER_OPENED,column:e.column,source:t,eGui:n};o.eventService.dispatchEvent(l)}))}))},t.prototype.onColumnsChanged=function(){var e=this,t=[];this.allColumnFilters.forEach((function(o,n){(o.column.isPrimary()?e.columnModel.getPrimaryColumn(n):e.columnModel.getGridColumn(n))||(t.push(o.column),e.disposeFilterWrapper(o,"columnChanged"))})),t.length>0?this.onFilterChanged({columns:t}):this.updateDependantFilters()},t.prototype.updateDependantFilters=function(){var e=this,t=this.columnModel.getGroupAutoColumns();null===t||void 0===t||t.forEach((function(t){"agGroupColumnFilter"===t.getColDef().filter&&e.getOrCreateFilterWrapper(t,"NO_UI")}))},t.prototype.isFilterAllowed=function(e){var t,o;if(!e.isFilterAllowed())return!1;var n=this.allColumnFilters.get(e.getColId());return null===(o=null===(t=null===n||void 0===n?void 0:n.filterPromise)||void 0===t?void 0:t.resolveNow(!0,(function(e){var t,o;return"function"!==typeof(null===(t=e)||void 0===t?void 0:t.isFilterAllowed)||(null===(o=e)||void 0===o?void 0:o.isFilterAllowed())})))||void 0===o||o},t.prototype.getFloatingFilterCompDetails=function(e,t){var o=this,n=e.getColDef(),r=this.createFilterParams(e,n),i=this.userComponentFactory.mergeParamsWithApplicationProvidedParams(n,gs,r),a=this.userComponentFactory.getDefaultFloatingFilterType(n);null==a&&(a="agReadOnlyFloatingFilter");var s={column:e,filterParams:i,currentParentModel:function(){return o.getCurrentFloatingFilterParentModel(e)},parentFilterInstance:function(t){var n=o.getFilterComponent(e,"NO_UI");null!=n&&n.then((function(e){t(Ps(e))}))},showParentFilter:t,suppressFilterButton:!1};return this.userComponentFactory.getFloatingFilterCompDetails(n,s,a)},t.prototype.getCurrentFloatingFilterParentModel=function(e){var t=this.getFilterComponent(e,"NO_UI",!1);return t?t.resolveNow(null,(function(e){return e&&e.getModel()})):null},t.prototype.destroyFilter=function(e,t){void 0===t&&(t="api");var o=this.allColumnFilters.get(e.getColId());o&&(this.disposeFilterWrapper(o,t),this.onFilterChanged({columns:[e]}))},t.prototype.disposeFilterWrapper=function(e,t){var o=this;e.filterPromise.then((function(n){(n.setModel(null)||rr.resolve()).then((function(){o.getContext().destroyBean(n),e.column.setFilterActive(!1,"filterDestroyed"),o.allColumnFilters.delete(e.column.getColId());var r={type:$e.EVENT_FILTER_DESTROYED,source:t,column:e.column};o.eventService.dispatchEvent(r)}))}))},t.prototype.destroy=function(){var t=this;e.prototype.destroy.call(this),this.allColumnFilters.forEach((function(e){return t.disposeFilterWrapper(e,"gridDestroyed")}))},t.QUICK_FILTER_SEPARATOR="\n",Fs([q("valueService")],t.prototype,"valueService",void 0),Fs([q("columnModel")],t.prototype,"columnModel",void 0),Fs([q("rowModel")],t.prototype,"rowModel",void 0),Fs([q("userComponentFactory")],t.prototype,"userComponentFactory",void 0),Fs([q("rowRenderer")],t.prototype,"rowRenderer",void 0),Fs([$],t.prototype,"init",null),t=o=Fs([W("filterManager")],t)}(Fe),zs=function(){var e=function(t,o){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])},e(t,o)};return function(t,o){function n(){this.constructor=t}e(t,o),t.prototype=null===o?Object.create(o):(n.prototype=o.prototype,new n)}}(),Hs=function(e){function t(t,o){var n=e.call(this,t)||this;return n.ctrl=o,n}return zs(t,e),t.prototype.getCtrl=function(){return this.ctrl},t}(fr),Bs=function(){var e=function(t,o){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])},e(t,o)};return function(t,o){function n(){this.constructor=t}e(t,o),t.prototype=null===o?Object.create(o):(n.prototype=o.prototype,new n)}}(),Vs=function(e,t,o,n){var r,i=arguments.length,a=i<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,o):n;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)a=Reflect.decorate(e,t,o,n);else for(var s=e.length-1;s>=0;s--)(r=e[s])&&(a=(i<3?r(a):i>3?r(t,o,a):r(t,o))||a);return i>3&&a&&Object.defineProperty(t,o,a),a},$s=function(e){function t(o){return e.call(this,t.TEMPLATE,o)||this}return Bs(t,e),t.prototype.postConstruct=function(){var e=this,t=this.getGui(),o={addOrRemoveCssClass:function(t,o){return e.addOrRemoveCssClass(t,o)},addOrRemoveBodyCssClass:function(t,o){return e.eFloatingFilterBody.classList.toggle(t,o)},setButtonWrapperDisplayed:function(t){return on(e.eButtonWrapper,t)},setCompDetails:function(t){return e.setCompDetails(t)},getFloatingFilterComp:function(){return e.compPromise},setWidth:function(e){return t.style.width=e},setMenuIcon:function(t){return e.eButtonShowMainFilter.appendChild(t)}};this.ctrl.setComp(o,t,this.eButtonShowMainFilter,this.eFloatingFilterBody)},t.prototype.setCompDetails=function(e){var t=this;this.compPromise=e.newAgStackInstance(),this.compPromise.then((function(e){return t.afterCompCreated(e)}))},t.prototype.afterCompCreated=function(e){var t=this;e&&(this.addDestroyFunc((function(){return t.context.destroyBean(e)})),this.isAlive()&&(this.eFloatingFilterBody.appendChild(e.getGui()),e.afterGuiAttached&&e.afterGuiAttached()))},t.TEMPLATE='<div class="ag-header-cell ag-floating-filter" role="gridcell" tabindex="-1">\n            <div ref="eFloatingFilterBody" role="presentation"></div>\n            <div class="ag-floating-filter-button ag-hidden" ref="eButtonWrapper" role="presentation">\n                <button type="button" aria-label="Open Filter Menu" class="ag-floating-filter-button-button" ref="eButtonShowMainFilter" tabindex="-1"></button>\n            </div>\n        </div>',Vs([mr("eFloatingFilterBody")],t.prototype,"eFloatingFilterBody",void 0),Vs([mr("eButtonWrapper")],t.prototype,"eButtonWrapper",void 0),Vs([mr("eButtonShowMainFilter")],t.prototype,"eButtonShowMainFilter",void 0),Vs([$],t.prototype,"postConstruct",null),t}(Hs),Us=function(){var e=function(t,o){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])},e(t,o)};return function(t,o){function n(){this.constructor=t}e(t,o),t.prototype=null===o?Object.create(o):(n.prototype=o.prototype,new n)}}(),Ws=function(e,t,o,n){var r,i=arguments.length,a=i<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,o):n;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)a=Reflect.decorate(e,t,o,n);else for(var s=e.length-1;s>=0;s--)(r=e[s])&&(a=(i<3?r(a):i>3?r(t,o,a):r(t,o))||a);return i>3&&a&&Object.defineProperty(t,o,a),a};!function(e){e.AUTO_HEIGHT="ag-layout-auto-height",e.NORMAL="ag-layout-normal",e.PRINT="ag-layout-print"}(Ns||(Ns={}));var qs,Ks=function(e){function t(t){var o=e.call(this)||this;return o.view=t,o}return Us(t,e),t.prototype.postConstruct=function(){this.addManagedPropertyListener("domLayout",this.updateLayoutClasses.bind(this)),this.updateLayoutClasses()},t.prototype.updateLayoutClasses=function(){var e=this.getDomLayout(),t={autoHeight:"autoHeight"===e,normal:"normal"===e,print:"print"===e},o=t.autoHeight?Ns.AUTO_HEIGHT:t.print?Ns.PRINT:Ns.NORMAL;this.view.updateLayoutClasses(o,t)},t.prototype.getDomLayout=function(){var e,t=null!==(e=this.gridOptionsService.get("domLayout"))&&void 0!==e?e:"normal";return-1===["normal","print","autoHeight"].indexOf(t)?(j((function(){return console.warn("AG Grid: "+t+" is not valid for DOM Layout, valid values are 'normal', 'autoHeight', 'print'.")}),"warn about dom layout values"),"normal"):t},Ws([$],t.prototype,"postConstruct",null),t}(Fe),Ys=function(){var e=function(t,o){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])},e(t,o)};return function(t,o){function n(){this.constructor=t}e(t,o),t.prototype=null===o?Object.create(o):(n.prototype=o.prototype,new n)}}(),Js=function(){return Js=Object.assign||function(e){for(var t,o=1,n=arguments.length;o<n;o++)for(var r in t=arguments[o])Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e},Js.apply(this,arguments)},Xs=function(e,t,o,n){var r,i=arguments.length,a=i<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,o):n;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)a=Reflect.decorate(e,t,o,n);else for(var s=e.length-1;s>=0;s--)(r=e[s])&&(a=(i<3?r(a):i>3?r(t,o,a):r(t,o))||a);return i>3&&a&&Object.defineProperty(t,o,a),a},Qs=function(e){function t(t){var o=e.call(this)||this;return o.scrollLeft=-1,o.nextScrollTop=-1,o.scrollTop=-1,o.eBodyViewport=t,o.resetLastHScrollDebounced=I((function(){return o.eLastHScroll=null}),500),o.resetLastVScrollDebounced=I((function(){return o.eLastVScroll=null}),500),o}return Ys(t,e),t.prototype.postConstruct=function(){var e=this;this.enableRtl=this.gridOptionsService.is("enableRtl"),this.addManagedListener(this.eventService,$e.EVENT_DISPLAYED_COLUMNS_WIDTH_CHANGED,this.onDisplayedColumnsWidthChanged.bind(this)),this.ctrlsService.whenReady((function(t){e.centerRowContainerCtrl=t.centerRowContainerCtrl,e.onDisplayedColumnsWidthChanged(),e.addScrollListener()}))},t.prototype.addScrollListener=function(){var e=this.ctrlsService.getFakeHScrollComp(),t=this.ctrlsService.getFakeVScrollComp();this.addManagedListener(this.centerRowContainerCtrl.getViewportElement(),"scroll",this.onHScroll.bind(this)),this.addManagedListener(e.getViewport(),"scroll",this.onFakeHScroll.bind(this));var o=this.gridOptionsService.is("debounceVerticalScrollbar"),n=o?I(this.onVScroll.bind(this),100):this.onVScroll.bind(this),r=o?I(this.onFakeVScroll.bind(this),100):this.onFakeVScroll.bind(this);this.addManagedListener(this.eBodyViewport,"scroll",n),this.addManagedListener(t.getViewport(),"scroll",r)},t.prototype.onDisplayedColumnsWidthChanged=function(){this.enableRtl&&this.horizontallyScrollHeaderCenterAndFloatingCenter()},t.prototype.horizontallyScrollHeaderCenterAndFloatingCenter=function(e){if(!(null==this.centerRowContainerCtrl)){void 0===e&&(e=this.centerRowContainerCtrl.getCenterViewportScrollLeft());var t=this.enableRtl?e:-e,o=this.ctrlsService.getTopCenterRowContainerCtrl(),n=this.ctrlsService.getStickyTopCenterRowContainerCtrl(),r=this.ctrlsService.getBottomCenterRowContainerCtrl(),i=this.ctrlsService.getFakeHScrollComp();this.ctrlsService.getHeaderRowContainerCtrl().setHorizontalScroll(-t),r.setContainerTranslateX(t),o.setContainerTranslateX(t),n.setContainerTranslateX(t);var a=this.centerRowContainerCtrl.getViewportElement();fn(this.eLastHScroll===a?i.getViewport():this.centerRowContainerCtrl.getViewportElement(),Math.abs(e),this.enableRtl)}},t.prototype.isControllingHScroll=function(e){return this.eLastHScroll?e===this.eLastHScroll:(this.eLastHScroll=e,!0)},t.prototype.isControllingVScroll=function(e){return this.eLastVScroll?e===this.eLastVScroll:(this.eLastVScroll=e,!0)},t.prototype.onFakeHScroll=function(){var e=this.ctrlsService.getFakeHScrollComp().getViewport();this.isControllingHScroll(e)&&this.onHScrollCommon(e)},t.prototype.onHScroll=function(){var e=this.centerRowContainerCtrl.getViewportElement();this.isControllingHScroll(e)&&this.onHScrollCommon(e)},t.prototype.onHScrollCommon=function(e){var t=this.centerRowContainerCtrl.getViewportElement().scrollLeft;this.shouldBlockScrollUpdate("horizontal",t,!0)||(this.doHorizontalScroll(Math.round(hn(e,this.enableRtl))),this.resetLastHScrollDebounced())},t.prototype.onFakeVScroll=function(){var e=this.ctrlsService.getFakeVScrollComp().getViewport();this.isControllingVScroll(e)&&this.onVScrollCommon(e)},t.prototype.onVScroll=function(){this.isControllingVScroll(this.eBodyViewport)&&this.onVScrollCommon(this.eBodyViewport)},t.prototype.onVScrollCommon=function(e){var t=e.scrollTop;if(!this.shouldBlockScrollUpdate("vertical",t,!0)){if(this.animationFrameService.setScrollTop(t),this.nextScrollTop=t,e===this.eBodyViewport)this.ctrlsService.getFakeVScrollComp().getViewport().scrollTop=t;else this.eBodyViewport.scrollTop=t;this.gridOptionsService.is("suppressAnimationFrame")?this.scrollGridIfNeeded():this.animationFrameService.schedule(),this.resetLastVScrollDebounced()}},t.prototype.doHorizontalScroll=function(e){var t=hn(this.ctrlsService.getFakeHScrollComp().getViewport(),this.enableRtl);this.scrollLeft===e&&e===t||(this.scrollLeft=e,this.fireScrollEvent("horizontal"),this.horizontallyScrollHeaderCenterAndFloatingCenter(e),this.onHorizontalViewportChanged())},t.prototype.fireScrollEvent=function(e){var t=this,o={type:$e.EVENT_BODY_SCROLL,direction:e,left:this.scrollLeft,top:this.scrollTop};this.eventService.dispatchEvent(o),window.clearTimeout(this.scrollTimer),this.scrollTimer=void 0,this.scrollTimer=window.setTimeout((function(){var e=Js(Js({},o),{type:$e.EVENT_BODY_SCROLL_END});t.eventService.dispatchEvent(e)}),100)},t.prototype.shouldBlockScrollUpdate=function(e,t,o){return void 0===o&&(o=!1),!(o&&!Oo())&&("vertical"===e?this.shouldBlockVerticalScroll(t):this.shouldBlockHorizontalScroll(t))},t.prototype.shouldBlockVerticalScroll=function(e){var t=ln(this.eBodyViewport),o=this.eBodyViewport.scrollHeight;return e<0||e+t>o},t.prototype.shouldBlockHorizontalScroll=function(e){var t=this.centerRowContainerCtrl.getCenterWidth(),o=this.centerRowContainerCtrl.getViewportElement().scrollWidth;if(this.enableRtl&&pn()){if(e>0)return!0}else if(e<0)return!0;return Math.abs(e)+t>o},t.prototype.redrawRowsAfterScroll=function(){this.fireScrollEvent("vertical")},t.prototype.onHorizontalViewportChanged=function(){this.centerRowContainerCtrl.onHorizontalViewportChanged()},t.prototype.checkScrollLeft=function(){this.scrollLeft!==this.centerRowContainerCtrl.getCenterViewportScrollLeft()&&this.onHScrollCommon(this.centerRowContainerCtrl.getViewportElement())},t.prototype.scrollGridIfNeeded=function(){var e=this.scrollTop!=this.nextScrollTop;return e&&(this.scrollTop=this.nextScrollTop,this.redrawRowsAfterScroll()),e},t.prototype.setHorizontalScrollPosition=function(e){var t=this.centerRowContainerCtrl.getViewportElement().scrollWidth-this.centerRowContainerCtrl.getCenterWidth();this.shouldBlockScrollUpdate("horizontal",e)&&(e=this.enableRtl&&pn()?e>0?0:t:Math.min(Math.max(e,0),t)),fn(this.centerRowContainerCtrl.getViewportElement(),Math.abs(e),this.enableRtl),this.doHorizontalScroll(e)},t.prototype.setVerticalScrollPosition=function(e){this.eBodyViewport.scrollTop=e},t.prototype.getVScrollPosition=function(){return{top:this.eBodyViewport.scrollTop,bottom:this.eBodyViewport.scrollTop+this.eBodyViewport.offsetHeight}},t.prototype.getHScrollPosition=function(){return this.centerRowContainerCtrl.getHScrollPosition()},t.prototype.isHorizontalScrollShowing=function(){return this.centerRowContainerCtrl.isHorizontalScrollShowing()},t.prototype.scrollHorizontally=function(e){var t=this.centerRowContainerCtrl.getViewportElement().scrollLeft;return this.setHorizontalScrollPosition(t+e),this.centerRowContainerCtrl.getViewportElement().scrollLeft-t},t.prototype.scrollToTop=function(){this.eBodyViewport.scrollTop=0},t.prototype.ensureNodeVisible=function(e,t){void 0===t&&(t=null);for(var o=this.rowModel.getRowCount(),n=-1,r=0;r<o;r++){var i=this.rowModel.getRow(r);if("function"===typeof e){if(i&&e(i)){n=r;break}}else if(e===i||e===i.data){n=r;break}}n>=0&&this.ensureIndexVisible(n,t)},t.prototype.ensureIndexVisible=function(e,t){if(!this.gridOptionsService.isDomLayout("print")){var o=this.paginationProxy.getRowCount();if("number"!==typeof e||e<0||e>=o)console.warn("AG Grid: Invalid row index for ensureIndexVisible: "+e);else{this.gridOptionsService.is("pagination")&&!this.gridOptionsService.is("suppressPaginationPanel")||this.paginationProxy.goToPageWithIndex(e);var n,r=this.ctrlsService.getGridBodyCtrl().getStickyTopHeight(),i=this.paginationProxy.getRow(e);do{var a=i.rowTop,s=i.rowHeight,l=this.paginationProxy.getPixelOffset(),c=i.rowTop-l,d=c+i.rowHeight,u=this.getVScrollPosition(),p=this.heightScaler.getDivStretchOffset(),h=u.top+p,f=u.bottom+p,g=f-h,m=this.heightScaler.getScrollPositionForPixel(c),y=this.heightScaler.getScrollPositionForPixel(d-g),v=Math.min((m+y)/2,c),b=null;"top"===t?b=m:"bottom"===t?b=y:"middle"===t?b=v:h+r>c?b=m-r:f<d&&(b=y),null!==b&&(this.eBodyViewport.scrollTop=b,this.rowRenderer.redrawAfterScroll()),n=a!==i.rowTop||s!==i.rowHeight}while(n);this.animationFrameService.flushAllFrames()}}},t.prototype.ensureColumnVisible=function(e,t){void 0===t&&(t="auto");var o=this.columnModel.getGridColumn(e);if(o&&!o.isPinned()&&this.columnModel.isColumnDisplayed(o)){var n=this.getPositionedHorizontalScroll(o,t);null!==n&&this.centerRowContainerCtrl.setCenterViewportScrollLeft(n),this.centerRowContainerCtrl.onHorizontalViewportChanged(),this.animationFrameService.flushAllFrames()}},t.prototype.getPositionedHorizontalScroll=function(e,t){var o=this.isColumnOutsideViewport(e),n=o.columnBeforeStart,r=o.columnAfterEnd,i=this.centerRowContainerCtrl.getCenterWidth()<e.getActualWidth(),a=this.centerRowContainerCtrl.getCenterWidth(),s=this.enableRtl,l=(s?n:r)||i,c=s?r:n;"auto"!==t&&(l="start"===t,c="end"===t);var d="middle"===t;if(l||c||d){var u=this.getColumnBounds(e),p=u.colLeft,h=u.colMiddle,f=u.colRight;return d?h-a/2:l?s?f:p:s?p-a:f-a}return null},t.prototype.isColumnOutsideViewport=function(e){var t=this.getViewportBounds(),o=t.start,n=t.end,r=this.getColumnBounds(e),i=r.colLeft,a=r.colRight,s=this.enableRtl;return{columnBeforeStart:s?o>a:n<a,columnAfterEnd:s?n<i:o>i}},t.prototype.getColumnBounds=function(e){var t=this.enableRtl,o=this.columnModel.getBodyContainerWidth(),n=e.getActualWidth(),r=e.getLeft(),i=t?-1:1,a=t?o-r:r;return{colLeft:a,colMiddle:a+n/2*i,colRight:a+n*i}},t.prototype.getViewportBounds=function(){var e=this.centerRowContainerCtrl.getCenterWidth(),t=this.centerRowContainerCtrl.getCenterViewportScrollLeft();return{start:t,end:e+t,width:e}},Xs([q("ctrlsService")],t.prototype,"ctrlsService",void 0),Xs([q("animationFrameService")],t.prototype,"animationFrameService",void 0),Xs([q("paginationProxy")],t.prototype,"paginationProxy",void 0),Xs([q("rowModel")],t.prototype,"rowModel",void 0),Xs([q("rowContainerHeightService")],t.prototype,"heightScaler",void 0),Xs([q("rowRenderer")],t.prototype,"rowRenderer",void 0),Xs([q("columnModel")],t.prototype,"columnModel",void 0),Xs([$],t.prototype,"postConstruct",null),t}(Fe),Zs=function(){function e(e){this.tickingInterval=null,this.onScrollCallback=null,this.scrollContainer=e.scrollContainer,this.scrollHorizontally=-1!==e.scrollAxis.indexOf("x"),this.scrollVertically=-1!==e.scrollAxis.indexOf("y"),this.scrollByTick=null!=e.scrollByTick?e.scrollByTick:20,e.onScrollCallback&&(this.onScrollCallback=e.onScrollCallback),this.scrollVertically&&(this.getVerticalPosition=e.getVerticalPosition,this.setVerticalPosition=e.setVerticalPosition),this.scrollHorizontally&&(this.getHorizontalPosition=e.getHorizontalPosition,this.setHorizontalPosition=e.setHorizontalPosition),this.shouldSkipVerticalScroll=e.shouldSkipVerticalScroll||function(){return!1},this.shouldSkipHorizontalScroll=e.shouldSkipHorizontalScroll||function(){return!1}}return e.prototype.check=function(e,t){void 0===t&&(t=!1);var o=t||this.shouldSkipVerticalScroll();if(!o||!this.shouldSkipHorizontalScroll()){var n=this.scrollContainer.getBoundingClientRect(),r=this.scrollByTick;this.tickLeft=e.clientX<n.left+r,this.tickRight=e.clientX>n.right-r,this.tickUp=e.clientY<n.top+r&&!o,this.tickDown=e.clientY>n.bottom-r&&!o,this.tickLeft||this.tickRight||this.tickUp||this.tickDown?this.ensureTickingStarted():this.ensureCleared()}},e.prototype.ensureTickingStarted=function(){null===this.tickingInterval&&(this.tickingInterval=window.setInterval(this.doTick.bind(this),100),this.tickCount=0)},e.prototype.doTick=function(){var e;if(this.tickCount++,e=this.tickCount>20?200:this.tickCount>10?80:40,this.scrollVertically){var t=this.getVerticalPosition();this.tickUp&&this.setVerticalPosition(t-e),this.tickDown&&this.setVerticalPosition(t+e)}if(this.scrollHorizontally){var o=this.getHorizontalPosition();this.tickLeft&&this.setHorizontalPosition(o-e),this.tickRight&&this.setHorizontalPosition(o+e)}this.onScrollCallback&&this.onScrollCallback()},e.prototype.ensureCleared=function(){this.tickingInterval&&(window.clearInterval(this.tickingInterval),this.tickingInterval=null)},e}(),el=function(){var e=function(t,o){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])},e(t,o)};return function(t,o){function n(){this.constructor=t}e(t,o),t.prototype=null===o?Object.create(o):(n.prototype=o.prototype,new n)}}(),tl=function(){return tl=Object.assign||function(e){for(var t,o=1,n=arguments.length;o<n;o++)for(var r in t=arguments[o])Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e},tl.apply(this,arguments)},ol=function(e,t,o,n){var r,i=arguments.length,a=i<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,o):n;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)a=Reflect.decorate(e,t,o,n);else for(var s=e.length-1;s>=0;s--)(r=e[s])&&(a=(i<3?r(a):i>3?r(t,o,a):r(t,o))||a);return i>3&&a&&Object.defineProperty(t,o,a),a},nl=function(e,t){var o="function"===typeof Symbol&&e[Symbol.iterator];if(!o)return e;var n,r,i=o.call(e),a=[];try{for(;(void 0===t||t-- >0)&&!(n=i.next()).done;)a.push(n.value)}catch(s){r={error:s}}finally{try{n&&!n.done&&(o=i.return)&&o.call(i)}finally{if(r)throw r.error}}return a},rl=function(){for(var e=[],t=0;t<arguments.length;t++)e=e.concat(nl(arguments[t]));return e},il=function(e){function t(t){var o=e.call(this)||this;return o.isMultiRowDrag=!1,o.isGridSorted=!1,o.isGridFiltered=!1,o.isRowGroupActive=!1,o.eContainer=t,o}return el(t,e),t.prototype.postConstruct=function(){var e=this;this.gridOptionsService.isRowModelType("clientSide")&&(this.clientSideRowModel=this.rowModel);var t=function(){e.onSortChanged(),e.onFilterChanged(),e.onRowGroupChanged()};this.addManagedListener(this.eventService,$e.EVENT_SORT_CHANGED,this.onSortChanged.bind(this)),this.addManagedListener(this.eventService,$e.EVENT_FILTER_CHANGED,this.onFilterChanged.bind(this)),this.addManagedListener(this.eventService,$e.EVENT_COLUMN_ROW_GROUP_CHANGED,this.onRowGroupChanged.bind(this)),this.addManagedListener(this.eventService,$e.EVENT_MODEL_UPDATED,(function(){t()})),t(),this.ctrlsService.whenReady((function(){var t=e.ctrlsService.getGridBodyCtrl();e.autoScrollService=new Zs({scrollContainer:t.getBodyViewportElement(),scrollAxis:"y",getVerticalPosition:function(){return t.getScrollFeature().getVScrollPosition().top},setVerticalPosition:function(e){return t.getScrollFeature().setVerticalScrollPosition(e)},onScrollCallback:function(){e.onDragging(e.lastDraggingEvent)}})}))},t.prototype.onSortChanged=function(){this.isGridSorted=this.sortController.isSortActive()},t.prototype.onFilterChanged=function(){this.isGridFiltered=this.filterManager.isAnyFilterPresent()},t.prototype.onRowGroupChanged=function(){var e=this.columnModel.getRowGroupColumns();this.isRowGroupActive=!a(e)},t.prototype.getContainer=function(){return this.eContainer},t.prototype.isInterestedIn=function(e){return e===Di.RowDrag},t.prototype.getIconName=function(){return this.gridOptionsService.is("rowDragManaged")&&this.shouldPreventRowMove()?Da.ICON_NOT_ALLOWED:Da.ICON_MOVE},t.prototype.shouldPreventRowMove=function(){return this.isGridSorted||this.isGridFiltered||this.isRowGroupActive},t.prototype.getRowNodes=function(e){var t=this;if(!this.isFromThisGrid(e))return e.dragItem.rowNodes||[];var o=this.gridOptionsService.is("rowDragMultiRow"),n=rl(this.selectionService.getSelectedNodes()).sort((function(e,o){return null==e.rowIndex||null==o.rowIndex?0:t.getRowIndexNumber(e)-t.getRowIndexNumber(o)})),r=e.dragItem.rowNode;return o&&-1!==n.indexOf(r)?(this.isMultiRowDrag=!0,n):(this.isMultiRowDrag=!1,[r])},t.prototype.onDragEnter=function(e){e.dragItem.rowNodes=this.getRowNodes(e),this.dispatchGridEvent($e.EVENT_ROW_DRAG_ENTER,e),this.getRowNodes(e).forEach((function(e){e.setDragging(!0)})),this.onEnterOrDragging(e)},t.prototype.onDragging=function(e){this.onEnterOrDragging(e)},t.prototype.isFromThisGrid=function(e){return e.dragSource.dragSourceDomDataKey===this.gridOptionsService.getDomDataKey()},t.prototype.isDropZoneWithinThisGrid=function(e){var t=this.ctrlsService.getGridBodyCtrl().getGui(),o=e.dropZoneTarget;return!t.contains(o)},t.prototype.onEnterOrDragging=function(e){this.dispatchGridEvent($e.EVENT_ROW_DRAG_MOVE,e),this.lastDraggingEvent=e;var t=this.mouseEventService.getNormalisedPosition(e).y;this.gridOptionsService.is("rowDragManaged")&&this.doManagedDrag(e,t),this.autoScrollService.check(e.event)},t.prototype.doManagedDrag=function(e,t){var o=this.isFromThisGrid(e),n=this.gridOptionsService.is("rowDragManaged"),r=e.dragItem.rowNodes;n&&this.shouldPreventRowMove()||(this.gridOptionsService.is("suppressMoveWhenRowDragging")||!o?this.isDropZoneWithinThisGrid(e)||this.clientSideRowModel.highlightRowAtPixel(r[0],t):this.moveRows(r,t))},t.prototype.getRowIndexNumber=function(e){return parseInt(fe(e.getRowIndexString().split("-")),10)},t.prototype.moveRowAndClearHighlight=function(e){var t=this,o=this.clientSideRowModel.getLastHighlightedRowNode(),n=o&&o.highlighted===js.Below,r=this.mouseEventService.getNormalisedPosition(e).y,i=e.dragItem.rowNodes,a=n?1:0;if(this.isFromThisGrid(e))i.forEach((function(e){e.rowTop<r&&(a-=1)})),this.moveRows(i,r,a);else{var s=this.gridOptionsService.getRowIdFunc(),l=this.clientSideRowModel.getRowIndexAtPixel(r)+1;this.clientSideRowModel.getHighlightPosition(r)===js.Above&&l--,this.clientSideRowModel.updateRowData({add:i.map((function(e){return e.data})).filter((function(e){return!t.clientSideRowModel.getRowNode(s?s({data:e,level:0}):e.id)})),addIndex:l})}this.clearRowHighlight()},t.prototype.clearRowHighlight=function(){this.clientSideRowModel.highlightRowAtPixel(null)},t.prototype.moveRows=function(e,t,o){void 0===o&&(o=0),this.clientSideRowModel.ensureRowsAtPixel(e,t,o)&&(this.focusService.clearFocusedCell(),this.rangeService&&this.rangeService.removeAllCellRanges())},t.prototype.addRowDropZone=function(e){var t=this;if(e.getContainer())if(this.dragAndDropService.findExternalZone(e))console.warn("AG Grid: addRowDropZone - target already exists in the list of DropZones. Use `removeRowDropZone` before adding it again.");else{var o={getContainer:e.getContainer};e.fromGrid?(e.fromGrid=void 0,o=e):(e.onDragEnter&&(o.onDragEnter=function(o){e.onDragEnter(t.draggingToRowDragEvent($e.EVENT_ROW_DRAG_ENTER,o))}),e.onDragLeave&&(o.onDragLeave=function(o){e.onDragLeave(t.draggingToRowDragEvent($e.EVENT_ROW_DRAG_LEAVE,o))}),e.onDragging&&(o.onDragging=function(o){e.onDragging(t.draggingToRowDragEvent($e.EVENT_ROW_DRAG_MOVE,o))}),e.onDragStop&&(o.onDragStop=function(o){e.onDragStop(t.draggingToRowDragEvent($e.EVENT_ROW_DRAG_END,o))})),this.dragAndDropService.addDropTarget(tl({isInterestedIn:function(e){return e===Di.RowDrag},getIconName:function(){return Da.ICON_MOVE},external:!0},o))}else j((function(){return console.warn("AG Grid: addRowDropZone - A container target needs to be provided")}),"add-drop-zone-empty-target")},t.prototype.getRowDropZone=function(e){var t=this,o=this.getContainer.bind(this),n=this.onDragEnter.bind(this),r=this.onDragLeave.bind(this),i=this.onDragging.bind(this),a=this.onDragStop.bind(this);return e?{getContainer:o,onDragEnter:e.onDragEnter?function(o){n(o),e.onDragEnter(t.draggingToRowDragEvent($e.EVENT_ROW_DRAG_ENTER,o))}:n,onDragLeave:e.onDragLeave?function(o){r(o),e.onDragLeave(t.draggingToRowDragEvent($e.EVENT_ROW_DRAG_LEAVE,o))}:r,onDragging:e.onDragging?function(o){i(o),e.onDragging(t.draggingToRowDragEvent($e.EVENT_ROW_DRAG_MOVE,o))}:i,onDragStop:e.onDragStop?function(o){a(o),e.onDragStop(t.draggingToRowDragEvent($e.EVENT_ROW_DRAG_END,o))}:a,fromGrid:!0}:{getContainer:o,onDragEnter:n,onDragLeave:r,onDragging:i,onDragStop:a,fromGrid:!0}},t.prototype.draggingToRowDragEvent=function(e,t){var o,n,r=this.mouseEventService.getNormalisedPosition(t).y,i=-1;switch(r>this.paginationProxy.getCurrentPageHeight()||(i=this.rowModel.getRowIndexAtPixel(r),o=this.rowModel.getRow(i)),t.vDirection){case Pi.Down:n="down";break;case Pi.Up:n="up";break;default:n=null}return{type:e,api:this.gridOptionsService.api,columnApi:this.gridOptionsService.columnApi,context:this.gridOptionsService.context,event:t.event,node:t.dragItem.rowNode,nodes:t.dragItem.rowNodes,overIndex:i,overNode:o,y:r,vDirection:n}},t.prototype.dispatchGridEvent=function(e,t){var o=this.draggingToRowDragEvent(e,t);this.eventService.dispatchEvent(o)},t.prototype.onDragLeave=function(e){this.dispatchGridEvent($e.EVENT_ROW_DRAG_LEAVE,e),this.stopDragging(e),this.gridOptionsService.is("rowDragManaged")&&this.clearRowHighlight(),this.isFromThisGrid(e)&&(this.isMultiRowDrag=!1)},t.prototype.onDragStop=function(e){this.dispatchGridEvent($e.EVENT_ROW_DRAG_END,e),this.stopDragging(e),!this.gridOptionsService.is("rowDragManaged")||!this.gridOptionsService.is("suppressMoveWhenRowDragging")&&this.isFromThisGrid(e)||this.isDropZoneWithinThisGrid(e)||this.moveRowAndClearHighlight(e)},t.prototype.stopDragging=function(e){this.autoScrollService.ensureCleared(),this.getRowNodes(e).forEach((function(e){e.setDragging(!1)}))},ol([q("dragAndDropService")],t.prototype,"dragAndDropService",void 0),ol([q("rowModel")],t.prototype,"rowModel",void 0),ol([q("paginationProxy")],t.prototype,"paginationProxy",void 0),ol([q("columnModel")],t.prototype,"columnModel",void 0),ol([q("focusService")],t.prototype,"focusService",void 0),ol([q("sortController")],t.prototype,"sortController",void 0),ol([q("filterManager")],t.prototype,"filterManager",void 0),ol([q("selectionService")],t.prototype,"selectionService",void 0),ol([q("mouseEventService")],t.prototype,"mouseEventService",void 0),ol([q("ctrlsService")],t.prototype,"ctrlsService",void 0),ol([K("rangeService")],t.prototype,"rangeService",void 0),ol([$],t.prototype,"postConstruct",null),t}(Fe),al=function(){var e=function(t,o){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])},e(t,o)};return function(t,o){function n(){this.constructor=t}e(t,o),t.prototype=null===o?Object.create(o):(n.prototype=o.prototype,new n)}}(),sl=function(e,t,o,n){var r,i=arguments.length,a=i<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,o):n;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)a=Reflect.decorate(e,t,o,n);else for(var s=e.length-1;s>=0;s--)(r=e[s])&&(a=(i<3?r(a):i>3?r(t,o,a):r(t,o))||a);return i>3&&a&&Object.defineProperty(t,o,a),a};!function(e){e.ANIMATION_ON="ag-row-animation",e.ANIMATION_OFF="ag-row-no-animation"}(qs||(qs={}));var ll,cl,dl="ag-selectable",ul="ag-force-vertical-scroll",pl=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.stickyTopHeight=0,t}return al(t,e),t.prototype.getScrollFeature=function(){return this.bodyScrollFeature},t.prototype.getBodyViewportElement=function(){return this.eBodyViewport},t.prototype.setComp=function(e,t,o,n,r,i){this.comp=e,this.eGridBody=t,this.eBodyViewport=o,this.eTop=n,this.eBottom=r,this.eStickyTop=i,this.setCellTextSelection(this.gridOptionsService.is("enableCellTextSelection")),this.createManagedBean(new Ks(this.comp)),this.bodyScrollFeature=this.createManagedBean(new Qs(this.eBodyViewport)),this.addRowDragListener(),this.setupRowAnimationCssClass(),this.addEventListeners(),this.addFocusListeners([n,o,r,i]),this.onGridColumnsChanged(),this.addBodyViewportListener(),this.setFloatingHeights(),this.disableBrowserDragging(),this.addStopEditingWhenGridLosesFocus(),this.ctrlsService.registerGridBodyCtrl(this)},t.prototype.getComp=function(){return this.comp},t.prototype.addEventListeners=function(){this.addManagedListener(this.eventService,$e.EVENT_GRID_COLUMNS_CHANGED,this.onGridColumnsChanged.bind(this)),this.addManagedListener(this.eventService,$e.EVENT_SCROLL_VISIBILITY_CHANGED,this.onScrollVisibilityChanged.bind(this)),this.addManagedListener(this.eventService,$e.EVENT_PINNED_ROW_DATA_CHANGED,this.onPinnedRowDataChanged.bind(this)),this.addManagedListener(this.eventService,$e.EVENT_HEADER_HEIGHT_CHANGED,this.onHeaderHeightChanged.bind(this))},t.prototype.addFocusListeners=function(e){var t=this;e.forEach((function(e){t.addManagedListener(e,"focusin",(function(t){var o=an(t.target,"ag-root",e);e.classList.toggle("ag-has-focus",!o)})),t.addManagedListener(e,"focusout",(function(t){var o=t.target,n=t.relatedTarget,r=e.contains(n),i=an(n,"ag-root",e);an(o,"ag-root",e)||r&&!i||e.classList.remove("ag-has-focus")}))}))},t.prototype.setColumnMovingCss=function(e){this.comp.setColumnMovingCss("ag-column-moving",e)},t.prototype.setCellTextSelection=function(e){void 0===e&&(e=!1);var t=e?dl:null;this.comp.setCellSelectableCss(t,e)},t.prototype.onScrollVisibilityChanged=function(){var e=this.scrollVisibleService.isVerticalScrollShowing();this.setVerticalScrollPaddingVisible(e),this.setStickyTopWidth(e);var t="calc(100% + "+((e&&this.gridOptionsService.getScrollbarWidth()||0)+(Fo()?16:0))+"px)";this.comp.setBodyViewportWidth(t)},t.prototype.onGridColumnsChanged=function(){var e=this.columnModel.getAllGridColumns();this.comp.setColumnCount(e?e.length:0)},t.prototype.disableBrowserDragging=function(){this.addManagedListener(this.eGridBody,"dragstart",(function(e){if(e.target instanceof HTMLImageElement)return e.preventDefault(),!1}))},t.prototype.addStopEditingWhenGridLosesFocus=function(){var e=this;if(this.gridOptionsService.is("stopEditingWhenCellsLoseFocus")){var t=function(t){var n=t.relatedTarget;if(null!==Do(n)){var r=o.some((function(e){return e.contains(n)}))&&e.mouseEventService.isElementInThisGrid(n);if(!r){var i=e.popupService;r=i.getActivePopups().some((function(e){return e.contains(n)}))||i.isElementWithinCustomPopup(n)}r||e.rowRenderer.stopEditing()}else e.rowRenderer.stopEditing()},o=[this.eBodyViewport,this.eBottom,this.eTop,this.eStickyTop];o.forEach((function(o){return e.addManagedListener(o,"focusout",t)}))}},t.prototype.updateRowCount=function(){var e=this.headerNavigationService.getHeaderRowCount(),t=this.rowModel.isLastRowIndexKnown()?this.rowModel.getRowCount():-1,o=-1===t?-1:e+t;this.comp.setRowCount(o)},t.prototype.registerBodyViewportResizeListener=function(e){this.comp.registerBodyViewportResizeListener(e)},t.prototype.setVerticalScrollPaddingVisible=function(e){var t=e?"scroll":"hidden";this.comp.setPinnedTopBottomOverflowY(t)},t.prototype.isVerticalScrollShowing=function(){var e=this.gridOptionsService.is("alwaysShowVerticalScroll"),t=e?ul:null,o=this.gridOptionsService.isDomLayout("normal");return this.comp.setAlwaysVerticalScrollClass(t,e),e||o&&kn(this.eBodyViewport)},t.prototype.setupRowAnimationCssClass=function(){var e=this,t=function(){var t=e.gridOptionsService.isAnimateRows()&&!e.rowContainerHeightService.isStretching(),o=t?qs.ANIMATION_ON:qs.ANIMATION_OFF;e.comp.setRowAnimationCssOnBodyViewport(o,t)};t(),this.addManagedListener(this.eventService,$e.EVENT_HEIGHT_SCALE_CHANGED,t),this.addManagedPropertyListener("animateRows",t)},t.prototype.getGridBodyElement=function(){return this.eGridBody},t.prototype.addBodyViewportListener=function(){var e=this.onBodyViewportContextMenu.bind(this);this.addManagedListener(this.eBodyViewport,"contextmenu",e),this.mockContextMenuForIPad(e),this.addManagedListener(this.eBodyViewport,"wheel",this.onBodyViewportWheel.bind(this)),this.addManagedListener(this.eStickyTop,"wheel",this.onStickyTopWheel.bind(this)),this.addFullWidthContainerWheelListener()},t.prototype.addFullWidthContainerWheelListener=function(){var e=this,t=this.eBodyViewport.querySelector(".ag-full-width-container"),o=this.eBodyViewport.querySelector(".ag-center-cols-viewport");t&&o&&this.addManagedListener(t,"wheel",(function(t){return e.onFullWidthContainerWheel(t,o)}))},t.prototype.onFullWidthContainerWheel=function(e,t){!e.deltaX||Math.abs(e.deltaY)>Math.abs(e.deltaX)||(e.preventDefault(),t.scrollBy({left:e.deltaX}))},t.prototype.onBodyViewportContextMenu=function(e,t,o){if(e||o){if(this.gridOptionsService.is("preventDefaultOnContextMenu"))(e||o).preventDefault();var n=(e||t).target;if(n===this.eBodyViewport||n===this.ctrlsService.getCenterRowContainerCtrl().getViewportElement()){if(!this.contextMenuFactory)return;e?this.contextMenuFactory.onContextMenu(e,null,null,null,null,this.eGridBody):o&&this.contextMenuFactory.onContextMenu(null,o,null,null,null,this.eGridBody)}}},t.prototype.mockContextMenuForIPad=function(e){if(Oo()){var t=new Yi(this.eBodyViewport);this.addManagedListener(t,Yi.EVENT_LONG_TAP,(function(t){e(void 0,t.touchStart,t.touchEvent)})),this.addDestroyFunc((function(){return t.destroy()}))}},t.prototype.onBodyViewportWheel=function(e){this.gridOptionsService.is("suppressScrollWhenPopupsAreOpen")&&this.popupService.hasAnchoredPopup()&&e.preventDefault()},t.prototype.onStickyTopWheel=function(e){e.preventDefault(),e.offsetY&&this.scrollVertically(e.deltaY)},t.prototype.getGui=function(){return this.eGridBody},t.prototype.scrollVertically=function(e){var t=this.eBodyViewport.scrollTop;return this.bodyScrollFeature.setVerticalScrollPosition(t+e),this.eBodyViewport.scrollTop-t},t.prototype.addRowDragListener=function(){this.rowDragFeature=this.createManagedBean(new il(this.eBodyViewport)),this.dragAndDropService.addDropTarget(this.rowDragFeature)},t.prototype.getRowDragFeature=function(){return this.rowDragFeature},t.prototype.onPinnedRowDataChanged=function(){this.setFloatingHeights()},t.prototype.setFloatingHeights=function(){var e=this.pinnedRowModel,t=e.getPinnedTopTotalHeight();t&&(t+=1);var o=e.getPinnedBottomTotalHeight();o&&(o+=1),this.comp.setTopHeight(t),this.comp.setBottomHeight(o),this.comp.setTopDisplay(t?"inherit":"none"),this.comp.setBottomDisplay(o?"inherit":"none"),this.setStickyTopOffsetTop()},t.prototype.setStickyTopHeight=function(e){void 0===e&&(e=0),this.comp.setStickyTopHeight(e+"px"),this.stickyTopHeight=e},t.prototype.getStickyTopHeight=function(){return this.stickyTopHeight},t.prototype.setStickyTopWidth=function(e){if(e){var t=this.gridOptionsService.getScrollbarWidth();this.comp.setStickyTopWidth("calc(100% - "+t+"px)")}else this.comp.setStickyTopWidth("100%")},t.prototype.onHeaderHeightChanged=function(){this.setStickyTopOffsetTop()},t.prototype.setStickyTopOffsetTop=function(){var e=this.ctrlsService.getGridHeaderCtrl().getHeaderHeight(),t=this.pinnedRowModel.getPinnedTopTotalHeight(),o=0;e>0&&(o+=e+1),t>0&&(o+=t+1),this.comp.setStickyTopTop(o+"px")},t.prototype.sizeColumnsToFit=function(e,t){var o=this,n=this.isVerticalScrollShowing()?this.gridOptionsService.getScrollbarWidth():0,r=cn(this.eGridBody)-n;r>0?this.columnModel.sizeColumnsToFit(r,"sizeColumnsToFit",!1,e):void 0===t?window.setTimeout((function(){o.sizeColumnsToFit(e,100)}),0):100===t?window.setTimeout((function(){o.sizeColumnsToFit(e,500)}),100):500===t?window.setTimeout((function(){o.sizeColumnsToFit(e,-1)}),500):console.warn("AG Grid: tried to call sizeColumnsToFit() but the grid is coming back with zero width, maybe the grid is not visible yet on the screen?")},t.prototype.addScrollEventListener=function(e){this.eBodyViewport.addEventListener("scroll",e,{passive:!0})},t.prototype.removeScrollEventListener=function(e){this.eBodyViewport.removeEventListener("scroll",e)},sl([q("rowContainerHeightService")],t.prototype,"rowContainerHeightService",void 0),sl([q("ctrlsService")],t.prototype,"ctrlsService",void 0),sl([q("columnModel")],t.prototype,"columnModel",void 0),sl([q("scrollVisibleService")],t.prototype,"scrollVisibleService",void 0),sl([K("contextMenuFactory")],t.prototype,"contextMenuFactory",void 0),sl([q("headerNavigationService")],t.prototype,"headerNavigationService",void 0),sl([q("dragAndDropService")],t.prototype,"dragAndDropService",void 0),sl([q("pinnedRowModel")],t.prototype,"pinnedRowModel",void 0),sl([q("rowRenderer")],t.prototype,"rowRenderer",void 0),sl([q("popupService")],t.prototype,"popupService",void 0),sl([q("mouseEventService")],t.prototype,"mouseEventService",void 0),sl([q("rowModel")],t.prototype,"rowModel",void 0),t}(Fe);!function(e){e[e.FILL=0]="FILL",e[e.RANGE=1]="RANGE"}(ll||(ll={})),function(e){e[e.VALUE=0]="VALUE",e[e.DIMENSION=1]="DIMENSION"}(cl||(cl={}));var hl,fl="ag-cell-range-selected",gl=function(){function e(e,t){this.beans=e,this.cellCtrl=t}return e.prototype.setComp=function(e,t){this.cellComp=e,this.eGui=t,this.onRangeSelectionChanged()},e.prototype.onRangeSelectionChanged=function(){this.cellComp&&(this.rangeCount=this.beans.rangeService.getCellRangeCount(this.cellCtrl.getCellPosition()),this.hasChartRange=this.getHasChartRange(),this.cellComp.addOrRemoveCssClass(fl,0!==this.rangeCount),this.cellComp.addOrRemoveCssClass(fl+"-1",1===this.rangeCount),this.cellComp.addOrRemoveCssClass(fl+"-2",2===this.rangeCount),this.cellComp.addOrRemoveCssClass(fl+"-3",3===this.rangeCount),this.cellComp.addOrRemoveCssClass(fl+"-4",this.rangeCount>=4),this.cellComp.addOrRemoveCssClass("ag-cell-range-chart",this.hasChartRange),fo(this.eGui,this.rangeCount>0||void 0),this.cellComp.addOrRemoveCssClass("ag-cell-range-single-cell",this.isSingleCell()),this.updateRangeBorders(),this.refreshHandle())},e.prototype.updateRangeBorders=function(){var e=this.getRangeBorders(),t=this.isSingleCell(),o=!t&&e.top,n=!t&&e.right,r=!t&&e.bottom,i=!t&&e.left;this.cellComp.addOrRemoveCssClass("ag-cell-range-top",o),this.cellComp.addOrRemoveCssClass("ag-cell-range-right",n),this.cellComp.addOrRemoveCssClass("ag-cell-range-bottom",r),this.cellComp.addOrRemoveCssClass("ag-cell-range-left",i)},e.prototype.isSingleCell=function(){var e=this.beans.rangeService;return 1===this.rangeCount&&e&&!e.isMoreThanOneCell()},e.prototype.getHasChartRange=function(){var e=this.beans.rangeService;if(!this.rangeCount||!e)return!1;var t=e.getCellRanges();return t.length>0&&t.every((function(e){return we([cl.DIMENSION,cl.VALUE],e.type)}))},e.prototype.updateRangeBordersIfRangeCount=function(){this.rangeCount>0&&(this.updateRangeBorders(),this.refreshHandle())},e.prototype.getRangeBorders=function(){var e,t,o=this,n=this.beans.gridOptionsService.is("enableRtl"),r=!1,i=!1,a=!1,s=!1,l=this.cellCtrl.getCellPosition().column,c=this.beans,d=c.rangeService,u=c.columnModel;n?(e=u.getDisplayedColAfter(l),t=u.getDisplayedColBefore(l)):(e=u.getDisplayedColBefore(l),t=u.getDisplayedColAfter(l));var p=d.getCellRanges().filter((function(e){return d.isCellInSpecificRange(o.cellCtrl.getCellPosition(),e)}));e||(s=!0),t||(i=!0);for(var h=0;h<p.length&&!(r&&i&&a&&s);h++){var f=p[h],g=d.getRangeStartRow(f),m=d.getRangeEndRow(f);!r&&this.beans.rowPositionUtils.sameRow(g,this.cellCtrl.getCellPosition())&&(r=!0),!a&&this.beans.rowPositionUtils.sameRow(m,this.cellCtrl.getCellPosition())&&(a=!0),!s&&e&&f.columns.indexOf(e)<0&&(s=!0),!i&&t&&f.columns.indexOf(t)<0&&(i=!0)}return{top:r,right:i,bottom:a,left:s}},e.prototype.refreshHandle=function(){if(this.beans.rangeService){var e=this.shouldHaveSelectionHandle();this.selectionHandle&&!e&&(this.selectionHandle=this.beans.context.destroyBean(this.selectionHandle)),e&&this.addSelectionHandle(),this.cellComp.addOrRemoveCssClass("ag-cell-range-handle",!!this.selectionHandle)}},e.prototype.shouldHaveSelectionHandle=function(){var e=this.beans,t=e.gridOptionsService,o=e.rangeService,n=o.getCellRanges(),r=n.length;if(this.rangeCount<1||r<1)return!1;var i=fe(n),a=this.cellCtrl.getCellPosition(),s=t.is("enableFillHandle")&&!this.cellCtrl.isSuppressFillHandle(),l=t.is("enableRangeHandle"),c=1===r&&!this.cellCtrl.isEditing()&&(s||l);if(this.hasChartRange){var d=n[0].type===cl.DIMENSION&&o.isCellInSpecificRange(a,n[0]);this.cellComp.addOrRemoveCssClass("ag-cell-range-chart-category",d),c=i.type===cl.VALUE}return c&&null!=i.endRow&&o.isContiguousRange(i)&&o.isBottomRightCell(i,a)},e.prototype.addSelectionHandle=function(){var e=this.beans,t=e.gridOptionsService,o=fe(e.rangeService.getCellRanges()).type,n=t.is("enableFillHandle")&&i(o)?ll.FILL:ll.RANGE;this.selectionHandle&&this.selectionHandle.getType()!==n&&(this.selectionHandle=this.beans.context.destroyBean(this.selectionHandle)),this.selectionHandle||(this.selectionHandle=this.beans.selectionHandleFactory.createSelectionHandle(n)),this.selectionHandle.refresh(this.cellCtrl)},e.prototype.destroy=function(){this.beans.context.destroyBean(this.selectionHandle)},e}(),ml=function(){var e=function(t,o){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])},e(t,o)};return function(t,o){function n(){this.constructor=t}e(t,o),t.prototype=null===o?Object.create(o):(n.prototype=o.prototype,new n)}}(),yl=function(e){function t(t,o){var n=e.call(this)||this;return n.cellCtrl=t,n.beans=o,n.column=t.getColumn(),n.rowNode=t.getRowNode(),n.setupColSpan(),n.setupRowSpan(),n}return ml(t,e),t.prototype.setupRowSpan=function(){this.rowSpan=this.column.getRowSpan(this.rowNode)},t.prototype.setComp=function(e){this.eGui=e,this.onLeftChanged(),this.onWidthChanged(),this.applyRowSpan()},t.prototype.onDisplayColumnsChanged=function(){var e=this.getColSpanningList();ge(this.colsSpanning,e)||(this.colsSpanning=e,this.onWidthChanged(),this.onLeftChanged())},t.prototype.setupColSpan=function(){null!=this.column.getColDef().colSpan&&(this.colsSpanning=this.getColSpanningList(),this.addManagedListener(this.beans.eventService,$e.EVENT_DISPLAYED_COLUMNS_CHANGED,this.onDisplayColumnsChanged.bind(this)),this.addManagedListener(this.beans.eventService,$e.EVENT_DISPLAYED_COLUMNS_WIDTH_CHANGED,this.onWidthChanged.bind(this)))},t.prototype.onWidthChanged=function(){if(this.eGui){var e=this.getCellWidth();this.eGui.style.width=e+"px"}},t.prototype.getCellWidth=function(){return this.colsSpanning?this.colsSpanning.reduce((function(e,t){return e+t.getActualWidth()}),0):this.column.getActualWidth()},t.prototype.getColSpanningList=function(){var e=this.column.getColSpan(this.rowNode),t=[];if(1===e)t.push(this.column);else for(var o=this.column,n=this.column.getPinned(),r=0;o&&r<e&&(t.push(o),(o=this.beans.columnModel.getDisplayedColAfter(o))&&!i(o))&&n===o.getPinned();r++);return t},t.prototype.onLeftChanged=function(){if(this.eGui){var e=this.modifyLeftForPrintLayout(this.getCellLeft());this.eGui.style.left=e+"px"}},t.prototype.getCellLeft=function(){return(this.beans.gridOptionsService.is("enableRtl")&&this.colsSpanning?fe(this.colsSpanning):this.column).getLeft()},t.prototype.modifyLeftForPrintLayout=function(e){if(!this.cellCtrl.isPrintLayout()||"left"===this.column.getPinned())return e;var t=this.beans.columnModel.getDisplayedColumnsLeftWidth();return"right"===this.column.getPinned()?t+this.beans.columnModel.getBodyContainerWidth()+(e||0):t+(e||0)},t.prototype.applyRowSpan=function(){if(1!==this.rowSpan){var e=this.beans.gridOptionsService.getRowHeightAsNumber()*this.rowSpan;this.eGui.style.height=e+"px",this.eGui.style.zIndex="1"}},t.prototype.destroy=function(){e.prototype.destroy.call(this)},t}(Fe),vl=function(){var e=function(t,o){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])},e(t,o)};return function(t,o){function n(){this.constructor=t}e(t,o),t.prototype=null===o?Object.create(o):(n.prototype=o.prototype,new n)}}(),bl=function(e){function t(t,o){var n=e.call(this)||this;return n.staticClasses=[],n.cellCtrl=t,n.beans=o,n.column=t.getColumn(),n.rowNode=t.getRowNode(),n}return vl(t,e),t.prototype.setComp=function(e){this.cellComp=e,this.applyUserStyles(),this.applyCellClassRules(),this.applyClassesFromColDef()},t.prototype.applyCellClassRules=function(){var e=this,t=this.column.getColDef(),o={value:this.cellCtrl.getValue(),data:this.rowNode.data,node:this.rowNode,colDef:t,column:this.column,rowIndex:this.rowNode.rowIndex,api:this.beans.gridOptionsService.api,columnApi:this.beans.gridOptionsService.columnApi,context:this.beans.gridOptionsService.context};this.beans.stylingService.processClassRules(t.cellClassRules,o,(function(t){return e.cellComp.addOrRemoveCssClass(t,!0)}),(function(t){return e.cellComp.addOrRemoveCssClass(t,!1)}))},t.prototype.applyUserStyles=function(){var e=this.column.getColDef();if(e.cellStyle){var t;if("function"===typeof e.cellStyle){var o={column:this.column,value:this.cellCtrl.getValue(),colDef:e,data:this.rowNode.data,node:this.rowNode,rowIndex:this.rowNode.rowIndex,api:this.beans.gridOptionsService.api,columnApi:this.beans.gridOptionsService.columnApi,context:this.beans.gridOptionsService.context};t=(0,e.cellStyle)(o)}else t=e.cellStyle;t&&this.cellComp.setUserStyles(t)}},t.prototype.applyClassesFromColDef=function(){var e=this,t=this.column.getColDef(),o={value:this.cellCtrl.getValue(),data:this.rowNode.data,node:this.rowNode,column:this.column,colDef:t,rowIndex:this.rowNode.rowIndex,api:this.beans.gridOptionsService.api,columnApi:this.beans.gridOptionsService.columnApi,context:this.beans.gridOptionsService.context};this.staticClasses.length&&this.staticClasses.forEach((function(t){return e.cellComp.addOrRemoveCssClass(t,!1)})),this.staticClasses=this.beans.stylingService.getStaticCellClasses(t,o),this.staticClasses.length&&this.staticClasses.forEach((function(t){return e.cellComp.addOrRemoveCssClass(t,!0)}))},t.prototype.destroy=function(){e.prototype.destroy.call(this)},t}(Fe),xl=function(){var e=function(t,o){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])},e(t,o)};return function(t,o){function n(){this.constructor=t}e(t,o),t.prototype=null===o?Object.create(o):(n.prototype=o.prototype,new n)}}(),wl=function(e){function t(t,o){var n=e.call(this)||this;return n.ctrl=t,n.beans=o,n}return xl(t,e),t.prototype.setComp=function(e){this.comp=e,this.setupTooltip()},t.prototype.setupTooltip=function(){this.browserTooltips=this.beans.gridOptionsService.is("enableBrowserTooltips"),this.updateTooltipText(),this.browserTooltips?this.comp.setTitle(null!=this.tooltip?this.tooltip:void 0):this.createTooltipFeatureIfNeeded()},t.prototype.updateTooltipText=function(){this.tooltip=this.ctrl.getTooltipValue()},t.prototype.createTooltipFeatureIfNeeded=function(){var e=this;if(null==this.genericTooltipFeature){var t={getTooltipParams:function(){return e.getTooltipParams()},getGui:function(){return e.ctrl.getGui()}};this.genericTooltipFeature=this.createManagedBean(new cr(t),this.beans.context)}},t.prototype.refreshToolTip=function(){this.updateTooltipText(),this.browserTooltips&&this.comp.setTitle(null!=this.tooltip?this.tooltip:void 0)},t.prototype.getTooltipParams=function(){var e=this.ctrl,t=e.getColumn?e.getColumn():void 0,o=e.getColDef?e.getColDef():void 0,n=e.getRowNode?e.getRowNode():void 0;return{location:e.getLocation(),colDef:o,column:t,rowIndex:e.getRowIndex?e.getRowIndex():void 0,node:n,data:n?n.data:void 0,value:this.getTooltipText(),valueFormatted:e.getValueFormatted?e.getValueFormatted():void 0}},t.prototype.getTooltipText=function(){return this.tooltip},t.prototype.destroy=function(){e.prototype.destroy.call(this)},t}(Fe),Cl=function(e,t,o,n){var r,i=arguments.length,a=i<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,o):n;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)a=Reflect.decorate(e,t,o,n);else for(var s=e.length-1;s>=0;s--)(r=e[s])&&(a=(i<3?r(a):i>3?r(t,o,a):r(t,o))||a);return i>3&&a&&Object.defineProperty(t,o,a),a},_l=function(){function e(){}return e.prototype.postConstruct=function(){this.doingMasterDetail=this.gridOptionsService.isMasterDetail(),this.gridOptionsService.isRowModelType("clientSide")&&(this.clientSideRowModel=this.rowModel),this.gridOptionsService.isRowModelType("serverSide")&&(this.serverSideRowModel=this.rowModel)},Cl([q("resizeObserverService")],e.prototype,"resizeObserverService",void 0),Cl([q("paginationProxy")],e.prototype,"paginationProxy",void 0),Cl([q("context")],e.prototype,"context",void 0),Cl([q("columnApi")],e.prototype,"columnApi",void 0),Cl([q("gridApi")],e.prototype,"gridApi",void 0),Cl([q("gridOptionsService")],e.prototype,"gridOptionsService",void 0),Cl([q("expressionService")],e.prototype,"expressionService",void 0),Cl([q("environment")],e.prototype,"environment",void 0),Cl([q("rowRenderer")],e.prototype,"rowRenderer",void 0),Cl([q("templateService")],e.prototype,"templateService",void 0),Cl([q("valueService")],e.prototype,"valueService",void 0),Cl([q("eventService")],e.prototype,"eventService",void 0),Cl([q("columnModel")],e.prototype,"columnModel",void 0),Cl([q("headerNavigationService")],e.prototype,"headerNavigationService",void 0),Cl([q("navigationService")],e.prototype,"navigationService",void 0),Cl([q("columnAnimationService")],e.prototype,"columnAnimationService",void 0),Cl([K("rangeService")],e.prototype,"rangeService",void 0),Cl([q("focusService")],e.prototype,"focusService",void 0),Cl([K("contextMenuFactory")],e.prototype,"contextMenuFactory",void 0),Cl([q("popupService")],e.prototype,"popupService",void 0),Cl([q("valueFormatterService")],e.prototype,"valueFormatterService",void 0),Cl([q("stylingService")],e.prototype,"stylingService",void 0),Cl([q("columnHoverService")],e.prototype,"columnHoverService",void 0),Cl([q("userComponentFactory")],e.prototype,"userComponentFactory",void 0),Cl([q("userComponentRegistry")],e.prototype,"userComponentRegistry",void 0),Cl([q("animationFrameService")],e.prototype,"animationFrameService",void 0),Cl([q("dragService")],e.prototype,"dragService",void 0),Cl([q("dragAndDropService")],e.prototype,"dragAndDropService",void 0),Cl([q("sortController")],e.prototype,"sortController",void 0),Cl([q("filterManager")],e.prototype,"filterManager",void 0),Cl([q("rowContainerHeightService")],e.prototype,"rowContainerHeightService",void 0),Cl([q("frameworkOverrides")],e.prototype,"frameworkOverrides",void 0),Cl([q("cellPositionUtils")],e.prototype,"cellPositionUtils",void 0),Cl([q("rowPositionUtils")],e.prototype,"rowPositionUtils",void 0),Cl([q("selectionService")],e.prototype,"selectionService",void 0),Cl([K("selectionHandleFactory")],e.prototype,"selectionHandleFactory",void 0),Cl([q("rowCssClassCalculator")],e.prototype,"rowCssClassCalculator",void 0),Cl([q("rowModel")],e.prototype,"rowModel",void 0),Cl([q("ctrlsService")],e.prototype,"ctrlsService",void 0),Cl([q("ctrlsFactory")],e.prototype,"ctrlsFactory",void 0),Cl([q("agStackComponentsRegistry")],e.prototype,"agStackComponentsRegistry",void 0),Cl([q("valueCache")],e.prototype,"valueCache",void 0),Cl([q("rowNodeEventThrottle")],e.prototype,"rowNodeEventThrottle",void 0),Cl([q("localeService")],e.prototype,"localeService",void 0),Cl([$],e.prototype,"postConstruct",null),e=Cl([W("beans")],e)}(),Sl=function(){var e=function(t,o){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])},e(t,o)};return function(t,o){function n(){this.constructor=t}e(t,o),t.prototype=null===o?Object.create(o):(n.prototype=o.prototype,new n)}}(),El=function(e){function t(t,o,n){var r=e.call(this)||this;return r.cellCtrl=t,r.beans=o,r.column=n,r}return Sl(t,e),t.prototype.onMouseEvent=function(e,t){if(!Re(t))switch(e){case"click":this.onCellClicked(t);break;case"mousedown":case"touchstart":this.onMouseDown(t);break;case"dblclick":this.onCellDoubleClicked(t);break;case"mouseout":this.onMouseOut(t);break;case"mouseover":this.onMouseOver(t)}},t.prototype.onCellClicked=function(e){if(this.isDoubleClickOnIPad())return this.onCellDoubleClicked(e),void e.preventDefault();var t=this.beans,o=t.eventService,n=t.rangeService,r=t.gridOptionsService,i=e.ctrlKey||e.metaKey;n&&i&&n.getCellRangeCount(this.cellCtrl.getCellPosition())>1&&n.intersectLastRange(!0);var a=this.cellCtrl.createEvent(e,$e.EVENT_CELL_CLICKED);o.dispatchEvent(a);var s=this.column.getColDef();s.onCellClicked&&window.setTimeout((function(){return s.onCellClicked(a)}),0),(r.is("singleClickEdit")||s.singleClickEdit)&&!r.is("suppressClickEdit")&&this.cellCtrl.startRowOrCellEdit()},t.prototype.isDoubleClickOnIPad=function(){if(!Oo()||Oe("dblclick"))return!1;var e=(new Date).getTime(),t=e-this.lastIPadMouseClickEvent<200;return this.lastIPadMouseClickEvent=e,t},t.prototype.onCellDoubleClicked=function(e){var t=this.column.getColDef(),o=this.cellCtrl.createEvent(e,$e.EVENT_CELL_DOUBLE_CLICKED);this.beans.eventService.dispatchEvent(o),"function"===typeof t.onCellDoubleClicked&&window.setTimeout((function(){return t.onCellDoubleClicked(o)}),0),!this.beans.gridOptionsService.is("singleClickEdit")&&!this.beans.gridOptionsService.is("suppressClickEdit")&&this.cellCtrl.startRowOrCellEdit(null,null,e)},t.prototype.onMouseDown=function(e){var t=e.ctrlKey,o=e.metaKey,n=e.shiftKey,r=e.target,i=this.beans,a=i.eventService,s=i.rangeService;if(!this.isRightClickInExistingRange(e)){var l=s&&0!=s.getCellRanges().length;if(!n||!l){var c=Eo()&&!this.cellCtrl.isEditing()&&!tn(r);this.cellCtrl.focusCell(c)}if(n&&l&&e.preventDefault(),!this.containsWidget(r)){if(s){var d=this.cellCtrl.getCellPosition();if(n)s.extendLatestRangeToCell(d);else{var u=t||o;s.setRangeToCell(d,u)}}a.dispatchEvent(this.cellCtrl.createEvent(e,$e.EVENT_CELL_MOUSE_DOWN))}}},t.prototype.isRightClickInExistingRange=function(e){var t=this.beans.rangeService;if(t&&(t.isCellInAnyRange(this.cellCtrl.getCellPosition())&&2===e.button))return!0;return!1},t.prototype.containsWidget=function(e){return an(e,"ag-selection-checkbox",3)},t.prototype.onMouseOut=function(e){if(!this.mouseStayingInsideCell(e)){var t=this.cellCtrl.createEvent(e,$e.EVENT_CELL_MOUSE_OUT);this.beans.eventService.dispatchEvent(t),this.beans.columnHoverService.clearMouseOver()}},t.prototype.onMouseOver=function(e){if(!this.mouseStayingInsideCell(e)){var t=this.cellCtrl.createEvent(e,$e.EVENT_CELL_MOUSE_OVER);this.beans.eventService.dispatchEvent(t),this.beans.columnHoverService.setMouseOver([this.column])}},t.prototype.mouseStayingInsideCell=function(e){if(!e.target||!e.relatedTarget)return!1;var t=this.cellCtrl.getGui(),o=t.contains(e.target),n=t.contains(e.relatedTarget);return o&&n},t.prototype.destroy=function(){},t}(_l),kl=function(){var e=function(t,o){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])},e(t,o)};return function(t,o){function n(){this.constructor=t}e(t,o),t.prototype=null===o?Object.create(o):(n.prototype=o.prototype,new n)}}(),jl=function(e){function t(t,o,n,r,i){var a=e.call(this)||this;return a.cellCtrl=t,a.beans=o,a.rowNode=r,a.rowCtrl=i,a}return kl(t,e),t.prototype.setComp=function(e){this.eGui=e},t.prototype.onKeyDown=function(e){var t=e.key;switch(t){case Hn.ENTER:this.onEnterKeyDown(e);break;case Hn.F2:this.onF2KeyDown(e);break;case Hn.ESCAPE:this.onEscapeKeyDown(e);break;case Hn.TAB:this.onTabKeyDown(e);break;case Hn.BACKSPACE:case Hn.DELETE:this.onBackspaceOrDeleteKeyPressed(t,e);break;case Hn.DOWN:case Hn.UP:case Hn.RIGHT:case Hn.LEFT:this.onNavigationKeyPressed(e,t)}},t.prototype.onNavigationKeyPressed=function(e,t){this.cellCtrl.isEditing()||(e.shiftKey&&this.cellCtrl.isRangeSelectionEnabled()?this.onShiftRangeSelect(e):this.beans.navigationService.navigateToNextCell(e,t,this.cellCtrl.getCellPosition(),!0),e.preventDefault())},t.prototype.onShiftRangeSelect=function(e){if(this.beans.rangeService){var t=this.beans.rangeService.extendLatestRangeInDirection(e);t&&this.beans.navigationService.ensureCellVisible(t)}},t.prototype.onTabKeyDown=function(e){this.beans.navigationService.onTabKeyDown(this.cellCtrl,e)},t.prototype.onBackspaceOrDeleteKeyPressed=function(e,t){var o=this,n=o.cellCtrl,r=o.beans,i=o.rowNode,a=r.gridOptionsService,s=r.rangeService,l=r.eventService;n.isEditing()||(l.dispatchEvent({type:$e.EVENT_KEY_SHORTCUT_CHANGED_CELL_START}),Wn(e,a.is("enableCellEditingOnBackspace"))?s&&a.isEnableRangeSelection()?s.clearCellRangeCellValues():n.isCellEditable()&&i.setDataValue(n.getColumn(),null,"cellClear"):n.startRowOrCellEdit(e,void 0,t),l.dispatchEvent({type:$e.EVENT_KEY_SHORTCUT_CHANGED_CELL_END}))},t.prototype.onEnterKeyDown=function(e){this.cellCtrl.isEditing()||this.rowCtrl.isEditing()?this.cellCtrl.stopEditingAndFocus():this.beans.gridOptionsService.is("enterMovesDown")?this.beans.navigationService.navigateToNextCell(null,Hn.DOWN,this.cellCtrl.getCellPosition(),!1):(this.cellCtrl.startRowOrCellEdit(Hn.ENTER,void 0,e),this.cellCtrl.isEditing()&&e.preventDefault())},t.prototype.onF2KeyDown=function(e){this.cellCtrl.isEditing()||this.cellCtrl.startRowOrCellEdit(Hn.F2,void 0,e)},t.prototype.onEscapeKeyDown=function(e){this.cellCtrl.isEditing()&&(this.cellCtrl.stopRowOrCellEdit(!0),this.cellCtrl.focusCell(!0))},t.prototype.onKeyPress=function(e){if(!(e.target!==this.eGui)&&!this.cellCtrl.isEditing()){var t=String.fromCharCode(e.charCode);" "===t?this.onSpaceKeyPressed(e):Bn(e)&&(this.cellCtrl.startRowOrCellEdit(null,t,e),e.preventDefault())}},t.prototype.onSpaceKeyPressed=function(e){var t=this.beans.gridOptionsService;if(!this.cellCtrl.isEditing()&&t.isRowSelection()){var o=this.rowNode.isSelected(),n=!o;if(n||!t.is("suppressRowDeselection")){var r=this.beans.gridOptionsService.is("groupSelectsFiltered"),i=this.rowNode.setSelectedParams({newValue:n,rangeSelect:e.shiftKey,groupSelectsFiltered:r,event:e,source:"spacePressed"});void 0===o&&0===i&&this.rowNode.setSelectedParams({newValue:!1,rangeSelect:e.shiftKey,groupSelectsFiltered:r,event:e,source:"spacePressed"})}}e.preventDefault()},t.prototype.destroy=function(){e.prototype.destroy.call(this)},t}(Fe),Al=function(){var e=function(t,o){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])},e(t,o)};return function(t,o){function n(){this.constructor=t}e(t,o),t.prototype=null===o?Object.create(o):(n.prototype=o.prototype,new n)}}(),Rl=function(e,t,o,n){var r,i=arguments.length,a=i<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,o):n;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)a=Reflect.decorate(e,t,o,n);else for(var s=e.length-1;s>=0;s--)(r=e[s])&&(a=(i<3?r(a):i>3?r(t,o,a):r(t,o))||a);return i>3&&a&&Object.defineProperty(t,o,a),a},Ol=function(e){function t(t,o,n,r){var i=e.call(this,'<div class="ag-drag-handle ag-row-drag" draggable="true"></div>')||this;return i.rowNode=t,i.column=o,i.beans=n,i.eCell=r,i}return Al(t,e),t.prototype.postConstruct=function(){this.getGui().appendChild(Gn("rowDrag",this.beans.gridOptionsService,null)),this.addGuiEventListener("mousedown",(function(e){e.stopPropagation()})),this.addDragSource(),this.checkVisibility()},t.prototype.addDragSource=function(){this.addGuiEventListener("dragstart",this.onDragStart.bind(this))},t.prototype.onDragStart=function(e){var t=this,o=this.column.getColDef().dndSourceOnRowDrag;e.dataTransfer.setDragImage(this.eCell,0,0);o?o({rowNode:this.rowNode,dragEvent:e,api:this.gridOptionsService.api,columnApi:this.gridOptionsService.columnApi,context:this.gridOptionsService.context}):function(){try{var o=JSON.stringify(t.rowNode.data);e.dataTransfer.setData("application/json",o),e.dataTransfer.setData("text/plain",o)}catch(n){}}()},t.prototype.checkVisibility=function(){var e=this.column.isDndSource(this.rowNode);this.setDisplayed(e)},Rl([$],t.prototype,"postConstruct",null),t}(fr),Tl=function(){var e=function(t,o){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])},e(t,o)};return function(t,o){function n(){this.constructor=t}e(t,o),t.prototype=null===o?Object.create(o):(n.prototype=o.prototype,new n)}}(),Dl=function(){return Dl=Object.assign||function(e){for(var t,o=1,n=arguments.length;o<n;o++)for(var r in t=arguments[o])Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e},Dl.apply(this,arguments)},Pl=0,Nl=function(e){function t(t,o,n,r){var i=e.call(this)||this;return i.cellRangeFeature=null,i.cellPositionFeature=null,i.cellCustomStyleFeature=null,i.tooltipFeature=null,i.cellMouseListenerFeature=null,i.cellKeyboardListenerFeature=null,i.suppressRefreshCell=!1,i.onCellCompAttachedFuncs=[],i.column=t,i.rowNode=o,i.beans=n,i.rowCtrl=r,i.instanceId=t.getId()+"-"+Pl++,i.createCellPosition(),i.addFeatures(),i}return Tl(t,e),t.prototype.addFeatures=function(){var e=this;this.cellPositionFeature=new yl(this,this.beans),this.addDestroyFunc((function(){var t;null===(t=e.cellPositionFeature)||void 0===t||t.destroy(),e.cellPositionFeature=null})),this.cellCustomStyleFeature=new bl(this,this.beans),this.addDestroyFunc((function(){var t;null===(t=e.cellCustomStyleFeature)||void 0===t||t.destroy(),e.cellCustomStyleFeature=null})),this.cellMouseListenerFeature=new El(this,this.beans,this.column),this.addDestroyFunc((function(){var t;null===(t=e.cellMouseListenerFeature)||void 0===t||t.destroy(),e.cellMouseListenerFeature=null})),this.cellKeyboardListenerFeature=new jl(this,this.beans,this.column,this.rowNode,this.rowCtrl),this.addDestroyFunc((function(){var t;null===(t=e.cellKeyboardListenerFeature)||void 0===t||t.destroy(),e.cellKeyboardListenerFeature=null})),this.beans.rangeService&&this.beans.gridOptionsService.isEnableRangeSelection()&&(this.cellRangeFeature=new gl(this.beans,this),this.addDestroyFunc((function(){var t;null===(t=e.cellRangeFeature)||void 0===t||t.destroy(),e.cellRangeFeature=null}))),this.column.isTooltipEnabled()&&this.addTooltipFeature()},t.prototype.addTooltipFeature=function(){var e=this,t={getColumn:function(){return e.column},getColDef:function(){return e.column.getColDef()},getRowIndex:function(){return e.cellPosition.rowIndex},getRowNode:function(){return e.rowNode},getGui:function(){return e.getGui()},getLocation:function(){return"cell"},getTooltipValue:function(){var t=e.column.getColDef(),o=e.rowNode.data;if(t.tooltipField&&r(o))return C(o,t.tooltipField,e.column.isTooltipFieldContainsDots());var n=t.tooltipValueGetter;return n?n({location:"cell",api:e.beans.gridOptionsService.api,columnApi:e.beans.gridOptionsService.columnApi,context:e.beans.gridOptionsService.context,colDef:e.column.getColDef(),column:e.column,rowIndex:e.cellPosition.rowIndex,node:e.rowNode,data:e.rowNode.data,value:e.value,valueFormatted:e.valueFormatted}):null},getValueFormatted:function(){return e.valueFormatted}};this.tooltipFeature=new wl(t,this.beans),this.addDestroyFunc((function(){var t;null===(t=e.tooltipFeature)||void 0===t||t.destroy(),e.tooltipFeature=null}))},t.prototype.setComp=function(e,t,o,n,r){var i,a,s,l;this.cellComp=e,this.eGui=t,this.printLayout=n,this.updateAndFormatValue(!0),this.addDomData(),this.onCellFocused(),this.applyStaticCssClasses(),this.setWrapText(),this.onFirstRightPinnedChanged(),this.onLastLeftPinnedChanged(),this.onColumnHover(),this.setupControlComps(),o&&this.setupAutoHeight(o),this.setAriaColIndex(),this.beans.gridOptionsService.is("suppressCellFocus")||this.cellComp.setTabIndex(-1);var c=vt(this.column.getId());this.cellComp.setColId(c),this.cellComp.setRole("gridcell"),null===(i=this.cellPositionFeature)||void 0===i||i.setComp(t),null===(a=this.cellCustomStyleFeature)||void 0===a||a.setComp(e),null===(s=this.tooltipFeature)||void 0===s||s.setComp(e),null===(l=this.cellKeyboardListenerFeature)||void 0===l||l.setComp(this.eGui),this.cellRangeFeature&&this.cellRangeFeature.setComp(e,t),r&&this.isCellEditable()?this.startEditing():this.showValue(),this.onCellCompAttachedFuncs.length&&(this.onCellCompAttachedFuncs.forEach((function(e){return e()})),this.onCellCompAttachedFuncs=[])},t.prototype.setupAutoHeight=function(e){var t=this;if(this.column.isAutoHeight()){var o=e.parentElement,n=this.beans.gridOptionsService.getRowHeightForNode(this.rowNode).height,r=function(i){if(!t.editing&&t.isAlive()){var a=sn(o),s=a.paddingTop+a.paddingBottom+a.borderBottomWidth+a.borderTopWidth,l=e.offsetHeight+s;if(i<5){var c=t.beans.gridOptionsService.getDocument();if(!c||!c.contains(e)||0==l)return void t.beans.frameworkOverrides.setTimeout((function(){return r(i+1)}),0)}var d=Math.max(l,n);t.rowNode.setRowAutoHeight(d,t.column)}},i=function(){return r(0)};i();var a=this.beans.resizeObserverService.observeResize(e,i);this.addDestroyFunc((function(){a(),t.rowNode.setRowAutoHeight(void 0,t.column)}))}},t.prototype.getInstanceId=function(){return this.instanceId},t.prototype.showValue=function(e){void 0===e&&(e=!1);var t=null!=this.valueFormatted?this.valueFormatted:this.value,o=this.createCellRendererParams(),n=this.beans.userComponentFactory.getCellRendererDetails(this.column.getColDef(),o);this.cellComp.setRenderDetails(n,t,e),this.refreshHandle()},t.prototype.setupControlComps=function(){var e=this.column.getColDef();this.includeSelection=this.isIncludeControl(e.checkboxSelection),this.includeRowDrag=this.isIncludeControl(e.rowDrag),this.includeDndSource=this.isIncludeControl(e.dndSource),this.cellComp.setIncludeSelection(this.includeSelection),this.cellComp.setIncludeDndSource(this.includeDndSource),this.cellComp.setIncludeRowDrag(this.includeRowDrag)},t.prototype.isForceWrapper=function(){return this.beans.gridOptionsService.is("enableCellTextSelection")||this.column.isAutoHeight()},t.prototype.isIncludeControl=function(e){return!(null!=this.rowNode.rowPinned)&&("function"===typeof e||!0===e)},t.prototype.refreshShouldDestroy=function(){var e=this.column.getColDef(),t=this.includeSelection!=this.isIncludeControl(e.checkboxSelection),o=this.includeRowDrag!=this.isIncludeControl(e.rowDrag),n=this.includeDndSource!=this.isIncludeControl(e.dndSource);return t||o||n},t.prototype.startEditing=function(e,t,o,n){var r=this;if(void 0===e&&(e=null),void 0===t&&(t=null),void 0===o&&(o=!1),void 0===n&&(n=null),this.isCellEditable()&&!this.editing)if(this.cellComp){var i=this.createCellEditorParams(e,t,o),a=this.column.getColDef(),s=this.beans.userComponentFactory.getCellEditorDetails(a,i),l=null!=(null===s||void 0===s?void 0:s.popupFromSelector)?s.popupFromSelector:!!a.cellEditorPopup,c=null!=(null===s||void 0===s?void 0:s.popupPositionFromSelector)?s.popupPositionFromSelector:a.cellEditorPopupPosition;this.setEditing(!0),this.cellComp.setEditDetails(s,l,c);var d=this.createEvent(n,$e.EVENT_CELL_EDITING_STARTED);this.beans.eventService.dispatchEvent(d)}else this.onCellCompAttachedFuncs.push((function(){r.startEditing(e,t,o,n)}))},t.prototype.setEditing=function(e){this.editing!==e&&(this.editing=e,this.refreshHandle())},t.prototype.stopRowOrCellEdit=function(e){void 0===e&&(e=!1),"fullRow"===this.beans.gridOptionsService.get("editType")?this.rowCtrl.stopRowEditing(e):this.stopEditing(e)},t.prototype.onPopupEditorClosed=function(){this.isEditing()&&this.stopEditingAndFocus()},t.prototype.takeValueFromCellEditor=function(e){var t={newValueExists:!1};if(e)return t;var o=this.cellComp.getCellEditor();return o?o.isCancelAfterEnd&&o.isCancelAfterEnd()?t:{newValue:o.getValue(),newValueExists:!0}:t},t.prototype.saveNewValue=function(e,t){if(t===e)return!1;this.suppressRefreshCell=!0;var o=this.rowNode.setDataValue(this.column,t,"edit");return this.suppressRefreshCell=!1,o},t.prototype.stopEditing=function(e){if(void 0===e&&(e=!1),!this.editing)return!1;var t=this.takeValueFromCellEditor(e),o=t.newValue,n=t.newValueExists,r=this.rowNode.getValueFromValueService(this.column),i=!1;return n&&(i=this.saveNewValue(r,o)),this.setEditing(!1),this.cellComp.setEditDetails(),this.updateAndFormatValue(),this.refreshCell({forceRefresh:!0,suppressFlash:!0}),this.dispatchEditingStoppedEvent(r,o,!e&&!!i),i},t.prototype.dispatchEditingStoppedEvent=function(e,t,o){var n=Dl(Dl({},this.createEvent(null,$e.EVENT_CELL_EDITING_STOPPED)),{oldValue:e,newValue:t,valueChanged:o});this.beans.eventService.dispatchEvent(n)},t.prototype.createCellEditorParams=function(e,t,o){return{value:this.rowNode.getValueFromValueService(this.column),eventKey:e,charPress:t,column:this.column,colDef:this.column.getColDef(),rowIndex:this.getCellPosition().rowIndex,node:this.rowNode,data:this.rowNode.data,api:this.beans.gridOptionsService.api,cellStartedEdit:o,columnApi:this.beans.gridOptionsService.columnApi,context:this.beans.gridOptionsService.context,onKeyDown:this.onKeyDown.bind(this),stopEditing:this.stopEditingAndFocus.bind(this),eGridCell:this.getGui(),parseValue:this.parseValue.bind(this),formatValue:this.formatValue.bind(this)}},t.prototype.createCellRendererParams=function(){var e=this;return{value:this.value,valueFormatted:this.valueFormatted,getValue:function(){return e.rowNode.getValueFromValueService(e.column)},setValue:function(t){return e.beans.valueService.setValue(e.rowNode,e.column,t)},formatValue:this.formatValue.bind(this),data:this.rowNode.data,node:this.rowNode,pinned:this.column.getPinned(),colDef:this.column.getColDef(),column:this.column,rowIndex:this.getCellPosition().rowIndex,api:this.beans.gridOptionsService.api,columnApi:this.beans.gridOptionsService.columnApi,context:this.beans.gridOptionsService.context,refreshCell:this.refreshCell.bind(this),eGridCell:this.getGui(),eParentOfValue:this.cellComp.getParentOfValue(),registerRowDragger:function(t,o,n,r){return e.registerRowDragger(t,o,r)}}},t.prototype.parseValue=function(e){var t=this.column.getColDef(),o={node:this.rowNode,data:this.rowNode.data,oldValue:this.getValue(),newValue:e,colDef:t,column:this.column,api:this.beans.gridOptionsService.api,columnApi:this.beans.gridOptionsService.columnApi,context:this.beans.gridOptionsService.context},n=t.valueParser;return r(n)?"function"===typeof n?n(o):this.beans.expressionService.evaluate(n,o):e},t.prototype.setFocusOutOnEditor=function(){if(this.editing){var e=this.cellComp.getCellEditor();e&&e.focusOut&&e.focusOut()}},t.prototype.setFocusInOnEditor=function(){if(this.editing){var e=this.cellComp.getCellEditor();e&&e.focusIn?e.focusIn():this.focusCell(!0)}},t.prototype.onCellChanged=function(e){this.cellComp&&(e.column===this.column&&this.refreshCell({}))},t.prototype.refreshCell=function(e){var t,o,n;if(!this.suppressRefreshCell&&!this.editing&&this.cellComp){var r=this.column.getColDef(),i=null!=e&&!!e.newData,a=null!=e&&!!e.suppressFlash||!!r.suppressCellFlash,s=null==r.field&&null==r.valueGetter&&null==r.showRowGroup,l=e&&e.forceRefresh||s||i,c=this.updateAndFormatValue();if(l||c){this.showValue(i);var d=this.beans.filterManager.isSuppressFlashingCellsBecauseFiltering();!a&&!d&&(this.beans.gridOptionsService.is("enableCellChangeFlash")||r.enableCellChangeFlash)&&this.flashCell(),null===(t=this.cellCustomStyleFeature)||void 0===t||t.applyUserStyles(),null===(o=this.cellCustomStyleFeature)||void 0===o||o.applyClassesFromColDef()}this.refreshToolTip(),null===(n=this.cellCustomStyleFeature)||void 0===n||n.applyCellClassRules()}},t.prototype.stopEditingAndFocus=function(e){void 0===e&&(e=!1),this.stopRowOrCellEdit(),this.focusCell(!0),e||this.navigateAfterEdit()},t.prototype.navigateAfterEdit=function(){"fullRow"===this.beans.gridOptionsService.get("editType")||this.beans.gridOptionsService.is("enterMovesDownAfterEdit")&&this.beans.navigationService.navigateToNextCell(null,Hn.DOWN,this.getCellPosition(),!1)},t.prototype.flashCell=function(e){var t=e&&e.flashDelay,o=e&&e.fadeDelay;this.animateCell("data-changed",t,o)},t.prototype.animateCell=function(e,t,o){var n,i,a=this,s="ag-cell-"+e,l="ag-cell-"+e+"-animation",c=this.beans.gridOptionsService;t||(t=null!==(n=c.getNum("cellFlashDelay"))&&void 0!==n?n:500),r(o)||(o=null!==(i=c.getNum("cellFadeDelay"))&&void 0!==i?i:1e3),this.cellComp.addOrRemoveCssClass(s,!0),this.cellComp.addOrRemoveCssClass(l,!1),window.setTimeout((function(){a.isAlive()&&(a.cellComp.addOrRemoveCssClass(s,!1),a.cellComp.addOrRemoveCssClass(l,!0),a.eGui.style.transition="background-color "+o+"ms",window.setTimeout((function(){a.isAlive()&&(a.cellComp.addOrRemoveCssClass(l,!1),a.eGui.style.transition="")}),o))}),t)},t.prototype.onFlashCells=function(e){if(this.cellComp){var t=this.beans.cellPositionUtils.createId(this.getCellPosition());e.cells[t]&&this.animateCell("highlight")}},t.prototype.isCellEditable=function(){return this.column.isCellEditable(this.rowNode)},t.prototype.isSuppressFillHandle=function(){return this.column.isSuppressFillHandle()},t.prototype.formatValue=function(e){var t=this.callValueFormatter(e);return null!=t?t:e},t.prototype.callValueFormatter=function(e){return this.beans.valueFormatterService.formatValue(this.column,this.rowNode,e)},t.prototype.updateAndFormatValue=function(e){void 0===e&&(e=!1);var t=this.value,o=this.valueFormatted;return this.value=this.rowNode.getValueFromValueService(this.column),this.valueFormatted=this.callValueFormatter(this.value),!!e||(!this.valuesAreEqual(t,this.value)||this.valueFormatted!=o)},t.prototype.valuesAreEqual=function(e,t){var o=this.column.getColDef();return o.equals?o.equals(e,t):e===t},t.prototype.getComp=function(){return this.cellComp},t.prototype.getValue=function(){return this.value},t.prototype.getValueFormatted=function(){return this.valueFormatted},t.prototype.addDomData=function(){var e=this,o=this.getGui();this.beans.gridOptionsService.setDomData(o,t.DOM_DATA_KEY_CELL_CTRL,this),this.addDestroyFunc((function(){return e.beans.gridOptionsService.setDomData(o,t.DOM_DATA_KEY_CELL_CTRL,null)}))},t.prototype.createEvent=function(e,t){return{type:t,node:this.rowNode,data:this.rowNode.data,value:this.value,column:this.column,colDef:this.column.getColDef(),context:this.beans.gridOptionsService.context,api:this.beans.gridApi,columnApi:this.beans.columnApi,rowPinned:this.rowNode.rowPinned,event:e,rowIndex:this.rowNode.rowIndex}},t.prototype.onKeyPress=function(e){var t;null===(t=this.cellKeyboardListenerFeature)||void 0===t||t.onKeyPress(e)},t.prototype.onKeyDown=function(e){var t;null===(t=this.cellKeyboardListenerFeature)||void 0===t||t.onKeyDown(e)},t.prototype.onMouseEvent=function(e,t){var o;null===(o=this.cellMouseListenerFeature)||void 0===o||o.onMouseEvent(e,t)},t.prototype.getGui=function(){return this.eGui},t.prototype.refreshToolTip=function(){var e;null===(e=this.tooltipFeature)||void 0===e||e.refreshToolTip()},t.prototype.getColSpanningList=function(){return this.cellPositionFeature.getColSpanningList()},t.prototype.onLeftChanged=function(){var e;this.cellComp&&(null===(e=this.cellPositionFeature)||void 0===e||e.onLeftChanged())},t.prototype.onDisplayedColumnsChanged=function(){this.eGui&&this.setAriaColIndex()},t.prototype.setAriaColIndex=function(){var e=this.beans.columnModel.getAriaColumnIndex(this.column);co(this.getGui(),e)},t.prototype.isSuppressNavigable=function(){return this.column.isSuppressNavigable(this.rowNode)},t.prototype.onWidthChanged=function(){var e;return null===(e=this.cellPositionFeature)||void 0===e?void 0:e.onWidthChanged()},t.prototype.getColumn=function(){return this.column},t.prototype.getRowNode=function(){return this.rowNode},t.prototype.getBeans=function(){return this.beans},t.prototype.isPrintLayout=function(){return this.printLayout},t.prototype.appendChild=function(e){this.eGui.appendChild(e)},t.prototype.refreshHandle=function(){this.cellRangeFeature&&this.cellRangeFeature.refreshHandle()},t.prototype.getCellPosition=function(){return this.cellPosition},t.prototype.isEditing=function(){return this.editing},t.prototype.startRowOrCellEdit=function(e,t,o){void 0===o&&(o=null),this.cellComp&&("fullRow"===this.beans.gridOptionsService.get("editType")?this.rowCtrl.startRowEditing(e,t,this):this.startEditing(e,t,!0,o))},t.prototype.getRowCtrl=function(){return this.rowCtrl},t.prototype.getRowPosition=function(){return{rowIndex:this.cellPosition.rowIndex,rowPinned:this.cellPosition.rowPinned}},t.prototype.updateRangeBordersIfRangeCount=function(){this.cellComp&&this.cellRangeFeature&&this.cellRangeFeature.updateRangeBordersIfRangeCount()},t.prototype.onRangeSelectionChanged=function(){this.cellComp&&this.cellRangeFeature&&this.cellRangeFeature.onRangeSelectionChanged()},t.prototype.isRangeSelectionEnabled=function(){return null!=this.cellRangeFeature},t.prototype.focusCell=function(e){void 0===e&&(e=!1),this.beans.focusService.setFocusedCell({rowIndex:this.getCellPosition().rowIndex,column:this.column,rowPinned:this.rowNode.rowPinned,forceBrowserFocus:e})},t.prototype.onRowIndexChanged=function(){this.createCellPosition(),this.onCellFocused(),this.cellRangeFeature&&this.cellRangeFeature.onRangeSelectionChanged()},t.prototype.onFirstRightPinnedChanged=function(){if(this.cellComp){var e=this.column.isFirstRightPinned();this.cellComp.addOrRemoveCssClass("ag-cell-first-right-pinned",e)}},t.prototype.onLastLeftPinnedChanged=function(){if(this.cellComp){var e=this.column.isLastLeftPinned();this.cellComp.addOrRemoveCssClass("ag-cell-last-left-pinned",e)}},t.prototype.onCellFocused=function(e){if(this.cellComp&&!this.beans.gridOptionsService.is("suppressCellFocus")){var t=this.beans.focusService.isCellFocused(this.cellPosition);if(this.cellComp.addOrRemoveCssClass("ag-cell-focus",t),t&&e&&e.forceBrowserFocus)this.cellComp.getFocusableElement().focus({preventScroll:!!e.preventScrollOnBrowserFocus});var o="fullRow"===this.beans.gridOptionsService.get("editType");t||o||!this.editing||this.stopRowOrCellEdit()}},t.prototype.createCellPosition=function(){this.cellPosition={rowIndex:this.rowNode.rowIndex,rowPinned:n(this.rowNode.rowPinned),column:this.column}},t.prototype.applyStaticCssClasses=function(){this.cellComp.addOrRemoveCssClass("ag-cell",!0),this.cellComp.addOrRemoveCssClass("ag-cell-not-inline-editing",!0);var e=1==this.column.isAutoHeight();this.cellComp.addOrRemoveCssClass("ag-cell-auto-height",e),this.cellComp.addOrRemoveCssClass("ag-cell-normal-height",!e)},t.prototype.onColumnHover=function(){if(this.cellComp&&this.beans.gridOptionsService.is("columnHoverHighlight")){var e=this.beans.columnHoverService.isHovered(this.column);this.cellComp.addOrRemoveCssClass("ag-column-hover",e)}},t.prototype.onColDefChanged=function(){this.cellComp&&(this.setWrapText(),this.editing||this.refreshCell({forceRefresh:!0,suppressFlash:!0}))},t.prototype.setWrapText=function(){var e=1==this.column.getColDef().wrapText;this.cellComp.addOrRemoveCssClass("ag-cell-wrap-text",e)},t.prototype.dispatchCellContextMenuEvent=function(e){var t=this.column.getColDef(),o=this.createEvent(e,$e.EVENT_CELL_CONTEXT_MENU);this.beans.eventService.dispatchEvent(o),t.onCellContextMenu&&window.setTimeout((function(){return t.onCellContextMenu(o)}),0)},t.prototype.getCellRenderer=function(){return this.cellComp?this.cellComp.getCellRenderer():null},t.prototype.getCellEditor=function(){return this.cellComp?this.cellComp.getCellEditor():null},t.prototype.destroy=function(){this.onCellCompAttachedFuncs=[],e.prototype.destroy.call(this)},t.prototype.createSelectionCheckbox=function(){var e=new ja;return this.beans.context.createBean(e),e.init({rowNode:this.rowNode,column:this.column}),e},t.prototype.createDndSource=function(){var e=new Ol(this.rowNode,this.column,this.beans,this.eGui);return this.beans.context.createBean(e),e},t.prototype.registerRowDragger=function(e,t,o){var n=this;if(this.customRowDragComp)this.customRowDragComp.setDragElement(e,t);else{var r=this.createRowDragComp(e,t,o);r&&(this.customRowDragComp=r,this.addDestroyFunc((function(){n.beans.context.destroyBean(r),n.customRowDragComp=null})))}},t.prototype.createRowDragComp=function(e,t,o){var n=this,r=this.beans.gridOptionsService.is("pagination"),i=this.beans.gridOptionsService.is("rowDragManaged"),a=this.beans.gridOptionsService.isRowModelType("clientSide");if(i){if(!a)return void j((function(){return console.warn("AG Grid: managed row dragging is only allowed in the Client Side Row Model")}),"CellComp.addRowDragging");if(r)return void j((function(){return console.warn("AG Grid: managed row dragging is not possible when doing pagination")}),"CellComp.addRowDragging")}var s=new Ia((function(){return n.value}),this.rowNode,this.column,e,t,o);return this.beans.context.createBean(s),s},t.DOM_DATA_KEY_CELL_CTRL="cellCtrl",t}(Fe),Il=function(){var e=function(t,o){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])},e(t,o)};return function(t,o){function n(){this.constructor=t}e(t,o),t.prototype=null===o?Object.create(o):(n.prototype=o.prototype,new n)}}(),Ml=function(e){var t="function"===typeof Symbol&&Symbol.iterator,o=t&&e[t],n=0;if(o)return o.call(e);if(e&&"number"===typeof e.length)return{next:function(){return e&&n>=e.length&&(e=void 0),{value:e&&e[n++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")},Ll=function(e,t){var o="function"===typeof Symbol&&e[Symbol.iterator];if(!o)return e;var n,r,i=o.call(e),a=[];try{for(;(void 0===t||t-- >0)&&!(n=i.next()).done;)a.push(n.value)}catch(s){r={error:s}}finally{try{n&&!n.done&&(o=i.return)&&o.call(i)}finally{if(r)throw r.error}}return a},Fl=function(){for(var e=[],t=0;t<arguments.length;t++)e=e.concat(Ll(arguments[t]));return e};!function(e){e.Normal="Normal",e.FullWidth="FullWidth",e.FullWidthLoading="FullWidthLoading",e.FullWidthGroup="FullWidthGroup",e.FullWidthDetail="FullWidthDetail"}(hl||(hl={}));var Gl,zl,Hl=0,Bl=function(e){function t(t,o,n,r,i){var a=e.call(this)||this;return a.allRowGuis=[],a.active=!0,a.centerCellCtrls={list:[],map:{}},a.leftCellCtrls={list:[],map:{}},a.rightCellCtrls={list:[],map:{}},a.slideInAnimation={left:!1,center:!1,right:!1,fullWidth:!1},a.fadeInAnimation={left:!1,center:!1,right:!1,fullWidth:!1},a.lastMouseDownOnDragger=!1,a.updateColumnListsPending=!1,a.businessKeySanitised=null,a.beans=o,a.rowNode=t,a.paginationPage=a.beans.paginationProxy.getCurrentPage(),a.useAnimationFrameForCreate=r,a.printLayout=i,a.instanceId=t.id+"-"+Hl++,a.setAnimateFlags(n),a.initRowBusinessKey(),a.rowFocused=a.beans.focusService.isRowFocused(a.rowNode.rowIndex,a.rowNode.rowPinned),a.rowLevel=a.beans.rowCssClassCalculator.calculateRowLevel(a.rowNode),a.setRowType(),a.addListeners(),a}return Il(t,e),t.prototype.initRowBusinessKey=function(){var e=this.beans.gridOptionsService.get("getBusinessKeyForNode");if("function"===typeof e){var t=e(this.rowNode);this.businessKeySanitised=vt(t)}},t.prototype.isSticky=function(){return this.rowNode.sticky},t.prototype.getBeans=function(){return this.beans},t.prototype.getInstanceId=function(){return this.instanceId},t.prototype.setComp=function(e,t,o){var n={rowComp:e,element:t,containerType:o};this.allRowGuis.push(n),o===zl.LEFT?this.leftGui=n:o===zl.RIGHT?this.rightGui=n:o===zl.FULL_WIDTH?this.fullWidthGui=n:this.centerGui=n,this.initialiseRowComp(n),"FullWidthLoading"===this.rowType||this.rowNode.rowPinned||this.beans.rowRenderer.dispatchFirstDataRenderedEvent()},t.prototype.unsetComp=function(e){this.allRowGuis=this.allRowGuis.filter((function(t){return t.containerType!==e})),e===zl.LEFT?this.leftGui=void 0:e===zl.RIGHT?this.rightGui=void 0:e===zl.FULL_WIDTH&&(this.fullWidthGui=void 0)},t.prototype.isCacheable=function(){return this.rowType===hl.FullWidthDetail&&this.beans.gridOptionsService.is("keepDetailRows")},t.prototype.setCached=function(e){var t=e?"none":"";this.allRowGuis.forEach((function(e){return e.element.style.display=t}))},t.prototype.initialiseRowComp=function(e){var o=this,n=this.beans.gridOptionsService;this.onRowHeightChanged(e),this.updateRowIndexes(e),this.setFocusedClasses(e),this.setStylesFromGridOptions(e),n.isRowSelection()&&this.rowNode.selectable&&this.onRowSelected(e),this.updateColumnLists(!this.useAnimationFrameForCreate);var r=e.rowComp;r.setRole("row"),this.getInitialRowClasses(e.containerType).forEach((function(e){return r.addOrRemoveCssClass(e,!0)})),this.executeSlideAndFadeAnimations(e),this.rowNode.group&&to(e.element,1==this.rowNode.expanded);var i=vt(this.rowNode.id);null!=i&&r.setRowId(i),null!=this.businessKeySanitised&&r.setRowBusinessKey(this.businessKeySanitised),this.isFullWidth()&&!this.beans.gridOptionsService.is("suppressCellFocus")&&r.setTabIndex(-1),n.setDomData(e.element,t.DOM_DATA_KEY_ROW_CTRL,this),this.addDestroyFunc((function(){return n.setDomData(e.element,t.DOM_DATA_KEY_ROW_CTRL,null)})),this.useAnimationFrameForCreate?this.beans.animationFrameService.createTask(this.addHoverFunctionality.bind(this,e.element),this.rowNode.rowIndex,"createTasksP2"):this.addHoverFunctionality(e.element),this.isFullWidth()&&this.setupFullWidth(e),n.is("rowDragEntireRow")&&this.addRowDraggerToRow(e),this.useAnimationFrameForCreate&&this.beans.animationFrameService.addDestroyTask((function(){o.isAlive()&&e.rowComp.addOrRemoveCssClass("ag-after-created",!0)})),this.executeProcessRowPostCreateFunc()},t.prototype.executeSlideAndFadeAnimations=function(e){var t=this,o=e.containerType;this.slideInAnimation[o]&&(P((function(){t.onTopChanged()})),this.slideInAnimation[o]=!1),this.fadeInAnimation[o]&&(P((function(){e.rowComp.addOrRemoveCssClass("ag-opacity-zero",!1)})),this.fadeInAnimation[o]=!1)},t.prototype.addRowDraggerToRow=function(e){if(this.beans.gridOptionsService.isEnableRangeSelection())j((function(){console.warn("AG Grid: Setting `rowDragEntireRow: true` in the gridOptions doesn't work with `enableRangeSelection: true`")}),"rowDragAndRangeSelectionEnabled");else{var t=this.beans.localeService.getLocaleTextFunc(),o=new Ia((function(){return"1 "+t("rowDragRow","row")}),this.rowNode,void 0,e.element,void 0,!0);this.createManagedBean(o,this.beans.context)}},t.prototype.setupFullWidth=function(e){var t=this.getPinnedForContainer(e.containerType),o=this.createFullWidthParams(e.element,t);if(this.rowType!=hl.FullWidthDetail||ne.assertRegistered(Q.MasterDetailModule,"cell renderer 'agDetailCellRenderer' (for master detail)")){var n;switch(this.rowType){case hl.FullWidthDetail:n=this.beans.userComponentFactory.getFullWidthDetailCellRendererDetails(o);break;case hl.FullWidthGroup:n=this.beans.userComponentFactory.getFullWidthGroupCellRendererDetails(o);break;case hl.FullWidthLoading:n=this.beans.userComponentFactory.getFullWidthLoadingCellRendererDetails(o);break;default:n=this.beans.userComponentFactory.getFullWidthCellRendererDetails(o)}e.rowComp.showFullWidth(n)}},t.prototype.isPrintLayout=function(){return this.printLayout},t.prototype.getFullWidthCellRenderer=function(){var e,t;return null===(t=null===(e=this.fullWidthGui)||void 0===e?void 0:e.rowComp)||void 0===t?void 0:t.getFullWidthCellRenderer()},t.prototype.getCellElement=function(e){var t=this.getCellCtrl(e);return t?t.getGui():null},t.prototype.executeProcessRowPostCreateFunc=function(){var e,t=this.beans.gridOptionsService.getCallback("processRowPostCreate");t&&this.areAllContainersReady()&&t({eRow:null===(e=this.centerGui)||void 0===e?void 0:e.element,ePinnedLeftRow:this.leftGui?this.leftGui.element:void 0,ePinnedRightRow:this.rightGui?this.rightGui.element:void 0,node:this.rowNode,rowIndex:this.rowNode.rowIndex,addRenderedRowListener:this.addEventListener.bind(this)})},t.prototype.areAllContainersReady=function(){var e=!!this.leftGui||!this.beans.columnModel.isPinningLeft(),t=!!this.centerGui,o=!!this.rightGui||!this.beans.columnModel.isPinningRight();return e&&t&&o},t.prototype.setRowType=function(){var e=this.rowNode.stub,t=this.rowNode.isFullWidthCell(),o=this.beans.doingMasterDetail&&this.rowNode.detail,n=this.beans.columnModel.isPivotMode(),r=!!this.rowNode.group&&!this.rowNode.footer&&this.beans.gridOptionsService.isGroupUseEntireRow(n);this.rowType=e?hl.FullWidthLoading:o?hl.FullWidthDetail:t?hl.FullWidth:r?hl.FullWidthGroup:hl.Normal},t.prototype.updateColumnLists=function(e,t){var o=this;(void 0===e&&(e=!1),void 0===t&&(t=!1),this.isFullWidth())||(e||this.beans.gridOptionsService.is("suppressAnimationFrame")||this.printLayout?this.updateColumnListsImpl(t):this.updateColumnListsPending||(this.beans.animationFrameService.createTask((function(){o.active&&o.updateColumnListsImpl(!0)}),this.rowNode.rowIndex,"createTasksP1"),this.updateColumnListsPending=!0))},t.prototype.createCellCtrls=function(e,t,o){var n=this;void 0===o&&(o=null);var r={list:[],map:{}},i=function(e,t){r.list.push(t),r.map[e]=t};return t.forEach((function(t){var o=t.getInstanceId(),r=e.map[o];r||(r=new Nl(t,n.rowNode,n.beans,n)),i(o,r)})),e.list.forEach((function(e){null!=r.map[e.getColumn().getInstanceId()]||(!n.isCellEligibleToBeRemoved(e,o)?i(e.getColumn().getInstanceId(),e):e.destroy())})),r},t.prototype.updateColumnListsImpl=function(e){var t=this;void 0===e&&(e=!1),this.updateColumnListsPending=!1;var o=this.beans.columnModel;if(this.printLayout)this.centerCellCtrls=this.createCellCtrls(this.centerCellCtrls,o.getAllDisplayedColumns()),this.leftCellCtrls={list:[],map:{}},this.rightCellCtrls={list:[],map:{}};else{var n=o.getViewportCenterColumnsForRow(this.rowNode);this.centerCellCtrls=this.createCellCtrls(this.centerCellCtrls,n);var r=o.getDisplayedLeftColumnsForRow(this.rowNode);this.leftCellCtrls=this.createCellCtrls(this.leftCellCtrls,r,"left");var i=o.getDisplayedRightColumnsForRow(this.rowNode);this.rightCellCtrls=this.createCellCtrls(this.rightCellCtrls,i,"right")}this.allRowGuis.forEach((function(o){var n=o.containerType===zl.LEFT?t.leftCellCtrls:o.containerType===zl.RIGHT?t.rightCellCtrls:t.centerCellCtrls;o.rowComp.setCellCtrls(n.list,e)}))},t.prototype.isCellEligibleToBeRemoved=function(e,t){var o=!0;if(e.getColumn().getPinned()!=t)return o;var n=e.isEditing(),r=this.beans.focusService.isCellFocused(e.getCellPosition());if(n||r){var i=e.getColumn();return!(this.beans.columnModel.getAllDisplayedColumns().indexOf(i)>=0)&&o}return o},t.prototype.setAnimateFlags=function(e){if(!this.isSticky()&&e){var t=r(this.rowNode.oldRowTop),o=this.beans.columnModel.isPinningLeft(),n=this.beans.columnModel.isPinningRight();t?(this.slideInAnimation.center=!0,this.slideInAnimation.left=o,this.slideInAnimation.right=n):(this.fadeInAnimation.center=!0,this.fadeInAnimation.left=o,this.fadeInAnimation.right=n)}},t.prototype.isEditing=function(){return this.editingRow},t.prototype.stopRowEditing=function(e){this.stopEditing(e)},t.prototype.isFullWidth=function(){return this.rowType!==hl.Normal},t.prototype.getRowType=function(){return this.rowType},t.prototype.refreshFullWidth=function(){var e=this,t=function(t,o){if(!t)return!0;var n=t.rowComp.getFullWidthCellRenderer();if(!n)return!1;if(!n.refresh)return!1;var r=e.createFullWidthParams(t.element,o);return n.refresh(r)},o=t(this.fullWidthGui,null),n=t(this.centerGui,null),r=t(this.leftGui,"left"),i=t(this.rightGui,"right");return o&&n&&r&&i},t.prototype.addListeners=function(){var e=this;this.addManagedListener(this.rowNode,_a.EVENT_HEIGHT_CHANGED,(function(){return e.onRowHeightChanged()})),this.addManagedListener(this.rowNode,_a.EVENT_ROW_SELECTED,(function(){return e.onRowSelected()})),this.addManagedListener(this.rowNode,_a.EVENT_ROW_INDEX_CHANGED,this.onRowIndexChanged.bind(this)),this.addManagedListener(this.rowNode,_a.EVENT_TOP_CHANGED,this.onTopChanged.bind(this)),this.addManagedListener(this.rowNode,_a.EVENT_EXPANDED_CHANGED,this.updateExpandedCss.bind(this)),this.addManagedListener(this.rowNode,_a.EVENT_HAS_CHILDREN_CHANGED,this.updateExpandedCss.bind(this)),this.addManagedListener(this.rowNode,_a.EVENT_DATA_CHANGED,this.onRowNodeDataChanged.bind(this)),this.addManagedListener(this.rowNode,_a.EVENT_CELL_CHANGED,this.onRowNodeCellChanged.bind(this)),this.addManagedListener(this.rowNode,_a.EVENT_HIGHLIGHT_CHANGED,this.onRowNodeHighlightChanged.bind(this)),this.addManagedListener(this.rowNode,_a.EVENT_DRAGGING_CHANGED,this.onRowNodeDraggingChanged.bind(this)),this.addManagedListener(this.rowNode,_a.EVENT_UI_LEVEL_CHANGED,this.onUiLevelChanged.bind(this));var t=this.beans.eventService;this.addManagedListener(t,$e.EVENT_PAGINATION_PIXEL_OFFSET_CHANGED,this.onPaginationPixelOffsetChanged.bind(this)),this.addManagedListener(t,$e.EVENT_HEIGHT_SCALE_CHANGED,this.onTopChanged.bind(this)),this.addManagedListener(t,$e.EVENT_DISPLAYED_COLUMNS_CHANGED,this.onDisplayedColumnsChanged.bind(this)),this.addManagedListener(t,$e.EVENT_VIRTUAL_COLUMNS_CHANGED,this.onVirtualColumnsChanged.bind(this)),this.addManagedListener(t,$e.EVENT_CELL_FOCUSED,this.onCellFocused.bind(this)),this.addManagedListener(t,$e.EVENT_CELL_FOCUS_CLEARED,this.onCellFocusCleared.bind(this)),this.addManagedListener(t,$e.EVENT_PAGINATION_CHANGED,this.onPaginationChanged.bind(this)),this.addManagedListener(t,$e.EVENT_MODEL_UPDATED,this.onModelUpdated.bind(this)),this.addManagedListener(t,$e.EVENT_COLUMN_MOVED,this.onColumnMoved.bind(this)),this.addListenersForCellComps()},t.prototype.onColumnMoved=function(){this.updateColumnLists()},t.prototype.addListenersForCellComps=function(){var e=this;this.addManagedListener(this.rowNode,_a.EVENT_ROW_INDEX_CHANGED,(function(){e.getAllCellCtrls().forEach((function(e){return e.onRowIndexChanged()}))})),this.addManagedListener(this.rowNode,_a.EVENT_CELL_CHANGED,(function(t){e.getAllCellCtrls().forEach((function(e){return e.onCellChanged(t)}))}))},t.prototype.onRowNodeDataChanged=function(e){this.rowNode.detailNode&&this.beans.rowRenderer.refreshFullWidthRow(this.rowNode.detailNode),this.isFullWidth()?this.beans.rowRenderer.refreshFullWidthRow(this.rowNode):(this.getAllCellCtrls().forEach((function(t){return t.refreshCell({suppressFlash:!e.update,newData:!e.update})})),this.onRowSelected(),this.postProcessCss())},t.prototype.onRowNodeCellChanged=function(){this.postProcessCss()},t.prototype.postProcessCss=function(){this.setStylesFromGridOptions(),this.postProcessClassesFromGridOptions(),this.postProcessRowClassRules(),this.postProcessRowDragging()},t.prototype.onRowNodeHighlightChanged=function(){var e=this.rowNode.highlighted;this.allRowGuis.forEach((function(t){var o=e===js.Above,n=e===js.Below;t.rowComp.addOrRemoveCssClass("ag-row-highlight-above",o),t.rowComp.addOrRemoveCssClass("ag-row-highlight-below",n)}))},t.prototype.onRowNodeDraggingChanged=function(){this.postProcessRowDragging()},t.prototype.postProcessRowDragging=function(){var e=this.rowNode.dragging;this.allRowGuis.forEach((function(t){return t.rowComp.addOrRemoveCssClass("ag-row-dragging",e)}))},t.prototype.updateExpandedCss=function(){var e=this.rowNode.isExpandable(),t=1==this.rowNode.expanded;this.allRowGuis.forEach((function(o){o.rowComp.addOrRemoveCssClass("ag-row-group",e),o.rowComp.addOrRemoveCssClass("ag-row-group-expanded",e&&t),o.rowComp.addOrRemoveCssClass("ag-row-group-contracted",e&&!t),to(o.element,e&&t)}))},t.prototype.onDisplayedColumnsChanged=function(){this.updateColumnLists(!0),this.beans.columnModel.wasAutoRowHeightEverActive()&&this.rowNode.checkAutoHeights()},t.prototype.onVirtualColumnsChanged=function(){this.updateColumnLists(!1,!0)},t.prototype.getRowPosition=function(){return{rowPinned:n(this.rowNode.rowPinned),rowIndex:this.rowNode.rowIndex}},t.prototype.onKeyboardNavigate=function(e){var t=this.allRowGuis.find((function(t){return t.element.contains(e.target)}));if((t?t.element:null)===e.target){var o=this.rowNode,n=this.beans.focusService.getFocusedCell(),r={rowIndex:o.rowIndex,rowPinned:o.rowPinned,column:n&&n.column};this.beans.navigationService.navigateToNextCell(e,e.key,r,!0),e.preventDefault()}},t.prototype.onTabKeyDown=function(e){if(!e.defaultPrevented&&!Re(e)){var t=this.allRowGuis.find((function(t){return t.element.contains(e.target)})),o=t?t.element:null,n=o===e.target,r=null;n||(r=this.beans.focusService.findNextFocusableElement(o,!1,e.shiftKey)),(this.isFullWidth()&&n||!r)&&this.beans.navigationService.onTabKeyDown(this,e)}},t.prototype.onFullWidthRowFocused=function(e){var t,o=this.rowNode,n=!!e&&(this.isFullWidth()&&e.rowIndex===o.rowIndex&&e.rowPinned==o.rowPinned),r=this.fullWidthGui?this.fullWidthGui.element:null===(t=this.centerGui)||void 0===t?void 0:t.element;r&&(r.classList.toggle("ag-full-width-focus",n),n&&r.focus({preventScroll:!0}))},t.prototype.refreshCell=function(e){this.centerCellCtrls=this.removeCellCtrl(this.centerCellCtrls,e),this.leftCellCtrls=this.removeCellCtrl(this.leftCellCtrls,e),this.rightCellCtrls=this.removeCellCtrl(this.rightCellCtrls,e),this.updateColumnLists()},t.prototype.removeCellCtrl=function(e,t){var o={list:[],map:{}};return e.list.forEach((function(e){e!==t&&(o.list.push(e),o.map[e.getInstanceId()]=e)})),o},t.prototype.onMouseEvent=function(e,t){switch(e){case"dblclick":this.onRowDblClick(t);break;case"click":this.onRowClick(t);break;case"touchstart":case"mousedown":this.onRowMouseDown(t)}},t.prototype.createRowEvent=function(e,t){return{type:e,node:this.rowNode,data:this.rowNode.data,rowIndex:this.rowNode.rowIndex,rowPinned:this.rowNode.rowPinned,context:this.beans.gridOptionsService.context,api:this.beans.gridOptionsService.api,columnApi:this.beans.gridOptionsService.columnApi,event:t}},t.prototype.createRowEventWithSource=function(e,t){var o=this.createRowEvent(e,t);return o.source=this,o},t.prototype.onRowDblClick=function(e){if(!Re(e)){var t=this.createRowEventWithSource($e.EVENT_ROW_DOUBLE_CLICKED,e);this.beans.eventService.dispatchEvent(t)}},t.prototype.onRowMouseDown=function(e){if(this.lastMouseDownOnDragger=an(e.target,"ag-row-drag",3),this.isFullWidth()){var t=this.rowNode,o=this.beans.columnModel;this.beans.rangeService&&this.beans.rangeService.removeAllCellRanges(),this.beans.focusService.setFocusedCell({rowIndex:t.rowIndex,column:o.getAllDisplayedColumns()[0],rowPinned:t.rowPinned,forceBrowserFocus:!0})}},t.prototype.onRowClick=function(e){if(!(Re(e)||this.lastMouseDownOnDragger)){var t=this.createRowEventWithSource($e.EVENT_ROW_CLICKED,e);this.beans.eventService.dispatchEvent(t);var o=e.ctrlKey||e.metaKey,n=e.shiftKey;if(!(this.beans.gridOptionsService.is("groupSelectsChildren")&&this.rowNode.group||!this.rowNode.selectable||this.rowNode.rowPinned||!this.beans.gridOptionsService.isRowSelection()||this.beans.gridOptionsService.is("suppressRowClickSelection"))){var r=this.beans.gridOptionsService.is("rowMultiSelectWithClick"),i=!this.beans.gridOptionsService.is("suppressRowDeselection"),a="rowClicked";if(this.rowNode.isSelected())r?this.rowNode.setSelectedParams({newValue:!1,event:e,source:a}):o?i&&this.rowNode.setSelectedParams({newValue:!1,event:e,source:a}):this.rowNode.setSelectedParams({newValue:!0,clearSelection:!n,rangeSelect:n,event:e,source:a});else{var s=!r&&!o;this.rowNode.setSelectedParams({newValue:!0,clearSelection:s,rangeSelect:n,event:e,source:a})}}}},t.prototype.setupDetailRowAutoHeight=function(e){var t=this;if(this.rowType===hl.FullWidthDetail&&this.beans.gridOptionsService.is("detailRowAutoHeight")){var o=function(){var o=e.clientHeight;if(null!=o&&o>0){t.beans.frameworkOverrides.setTimeout((function(){t.rowNode.setRowHeight(o),t.beans.clientSideRowModel?t.beans.clientSideRowModel.onRowHeightChanged():t.beans.serverSideRowModel&&t.beans.serverSideRowModel.onRowHeightChanged()}),0)}},n=this.beans.resizeObserverService.observeResize(e,o);this.addDestroyFunc(n),o()}},t.prototype.createFullWidthParams=function(e,t){var o=this;return{fullWidth:!0,data:this.rowNode.data,node:this.rowNode,value:this.rowNode.key,valueFormatted:this.rowNode.key,rowIndex:this.rowNode.rowIndex,api:this.beans.gridOptionsService.api,columnApi:this.beans.gridOptionsService.columnApi,context:this.beans.gridOptionsService.context,eGridCell:e,eParentOfValue:e,pinned:t,addRenderedRowListener:this.addEventListener.bind(this),registerRowDragger:function(e,t,n,r){return o.addFullWidthRowDragging(e,t,n,r)}}},t.prototype.addFullWidthRowDragging=function(e,t,o,n){if(void 0===o&&(o=""),this.isFullWidth()){var r=new Ia((function(){return o}),this.rowNode,void 0,e,t,n);this.createManagedBean(r,this.beans.context)}},t.prototype.onUiLevelChanged=function(){var e=this.beans.rowCssClassCalculator.calculateRowLevel(this.rowNode);if(this.rowLevel!=e){var t="ag-row-level-"+e,o="ag-row-level-"+this.rowLevel;this.allRowGuis.forEach((function(e){e.rowComp.addOrRemoveCssClass(t,!0),e.rowComp.addOrRemoveCssClass(o,!1)}))}this.rowLevel=e},t.prototype.isFirstRowOnPage=function(){return this.rowNode.rowIndex===this.beans.paginationProxy.getPageFirstRow()},t.prototype.isLastRowOnPage=function(){return this.rowNode.rowIndex===this.beans.paginationProxy.getPageLastRow()},t.prototype.onModelUpdated=function(){this.refreshFirstAndLastRowStyles()},t.prototype.refreshFirstAndLastRowStyles=function(){var e=this.isFirstRowOnPage(),t=this.isLastRowOnPage();this.firstRowOnPage!==e&&(this.firstRowOnPage=e,this.allRowGuis.forEach((function(t){return t.rowComp.addOrRemoveCssClass("ag-row-first",e)}))),this.lastRowOnPage!==t&&(this.lastRowOnPage=t,this.allRowGuis.forEach((function(e){return e.rowComp.addOrRemoveCssClass("ag-row-last",t)})))},t.prototype.stopEditing=function(e){var t,o;if(void 0===e&&(e=!1),!this.stoppingRowEdit){var n=this.getAllCellCtrls(),r=this.editingRow;this.stoppingRowEdit=!0;var i=!1;try{for(var a=Ml(n),s=a.next();!s.done;s=a.next()){var l=s.value.stopEditing(e);r&&!e&&!i&&l&&(i=!0)}}catch(d){t={error:d}}finally{try{s&&!s.done&&(o=a.return)&&o.call(a)}finally{if(t)throw t.error}}if(i){var c=this.createRowEvent($e.EVENT_ROW_VALUE_CHANGED);this.beans.eventService.dispatchEvent(c)}r&&this.setEditingRow(!1),this.stoppingRowEdit=!1}},t.prototype.setInlineEditingCss=function(e){this.allRowGuis.forEach((function(t){t.rowComp.addOrRemoveCssClass("ag-row-inline-editing",e),t.rowComp.addOrRemoveCssClass("ag-row-not-inline-editing",!e)}))},t.prototype.setEditingRow=function(e){this.editingRow=e,this.allRowGuis.forEach((function(t){return t.rowComp.addOrRemoveCssClass("ag-row-editing",e)}));var t=e?this.createRowEvent($e.EVENT_ROW_EDITING_STARTED):this.createRowEvent($e.EVENT_ROW_EDITING_STOPPED);this.beans.eventService.dispatchEvent(t)},t.prototype.startRowEditing=function(e,t,o,n){(void 0===e&&(e=null),void 0===t&&(t=null),void 0===o&&(o=null),void 0===n&&(n=null),this.editingRow)||this.getAllCellCtrls().reduce((function(r,i){var a=i===o;return a?i.startEditing(e,t,a,n):i.startEditing(null,null,a,n),!!r||i.isEditing()}),!1)&&this.setEditingRow(!0)},t.prototype.getAllCellCtrls=function(){return 0===this.leftCellCtrls.list.length&&0===this.rightCellCtrls.list.length?this.centerCellCtrls.list:Fl(this.centerCellCtrls.list,this.leftCellCtrls.list,this.rightCellCtrls.list)},t.prototype.postProcessClassesFromGridOptions=function(){var e=this,t=this.beans.rowCssClassCalculator.processClassesFromGridOptions(this.rowNode);t&&t.length&&t.forEach((function(t){e.allRowGuis.forEach((function(e){return e.rowComp.addOrRemoveCssClass(t,!0)}))}))},t.prototype.postProcessRowClassRules=function(){var e=this;this.beans.rowCssClassCalculator.processRowClassRules(this.rowNode,(function(t){e.allRowGuis.forEach((function(e){return e.rowComp.addOrRemoveCssClass(t,!0)}))}),(function(t){e.allRowGuis.forEach((function(e){return e.rowComp.addOrRemoveCssClass(t,!1)}))}))},t.prototype.setStylesFromGridOptions=function(e){var t=this.processStylesFromGridOptions();this.forEachGui(e,(function(e){return e.rowComp.setUserStyles(t)}))},t.prototype.getPinnedForContainer=function(e){return e===zl.LEFT?"left":e===zl.RIGHT?"right":null},t.prototype.getInitialRowClasses=function(e){var t=this.getPinnedForContainer(e),o={rowNode:this.rowNode,rowFocused:this.rowFocused,fadeRowIn:this.fadeInAnimation[e],rowIsEven:this.rowNode.rowIndex%2===0,rowLevel:this.rowLevel,fullWidthRow:this.isFullWidth(),firstRowOnPage:this.isFirstRowOnPage(),lastRowOnPage:this.isLastRowOnPage(),printLayout:this.printLayout,expandable:this.rowNode.isExpandable(),pinned:t};return this.beans.rowCssClassCalculator.getInitialRowClasses(o)},t.prototype.processStylesFromGridOptions=function(){var e=this.beans.gridOptionsService.get("rowStyle");if(!e||"function"!==typeof e){var t,o=this.beans.gridOptionsService.getCallback("getRowStyle");if(o)t=o({data:this.rowNode.data,node:this.rowNode,rowIndex:this.rowNode.rowIndex});return Object.assign({},e,t)}console.warn("AG Grid: rowStyle should be an object of key/value styles, not be a function, use getRowStyle() instead")},t.prototype.onRowSelected=function(e){var t=this,o=!!this.rowNode.isSelected();this.forEachGui(e,(function(e){e.rowComp.addOrRemoveCssClass("ag-row-selected",o),fo(e.element,!!o||void 0);var n=t.createAriaLabel();Kt(e.element,null==n?"":n)}))},t.prototype.createAriaLabel=function(){var e=this.rowNode.isSelected();if(!e||!this.beans.gridOptionsService.is("suppressRowDeselection"))return this.beans.localeService.getLocaleTextFunc()(e?"ariaRowDeselect":"ariaRowSelect","Press SPACE to "+(e?"deselect":"select")+" this row.")},t.prototype.isUseAnimationFrameForCreate=function(){return this.useAnimationFrameForCreate},t.prototype.addHoverFunctionality=function(e){var t=this;this.active&&(this.addManagedListener(e,"mouseenter",(function(){return t.rowNode.onMouseEnter()})),this.addManagedListener(e,"mouseleave",(function(){return t.rowNode.onMouseLeave()})),this.addManagedListener(this.rowNode,_a.EVENT_MOUSE_ENTER,(function(){t.beans.dragService.isDragging()||t.beans.gridOptionsService.is("suppressRowHoverHighlight")||(e.classList.add("ag-row-hover"),t.rowNode.setHovered(!0))})),this.addManagedListener(this.rowNode,_a.EVENT_MOUSE_LEAVE,(function(){e.classList.remove("ag-row-hover"),t.rowNode.setHovered(!1)})))},t.prototype.roundRowTopToBounds=function(e){var t=this.beans.ctrlsService.getGridBodyCtrl().getScrollFeature().getVScrollPosition(),o=this.applyPaginationOffset(t.top,!0)-100,n=this.applyPaginationOffset(t.bottom,!0)+100;return Math.min(Math.max(o,e),n)},t.prototype.getFrameworkOverrides=function(){return this.beans.frameworkOverrides},t.prototype.forEachGui=function(e,t){(e?[e]:this.allRowGuis).forEach(t)},t.prototype.onRowHeightChanged=function(e){if(null!=this.rowNode.rowHeight){var t=this.rowNode.rowHeight,o=this.beans.environment.getDefaultRowHeight(),n=this.beans.gridOptionsService.isGetRowHeightFunction()?this.beans.gridOptionsService.getRowHeightForNode(this.rowNode).height:void 0,r=n?Math.min(o,n)-2+"px":void 0;this.forEachGui(e,(function(e){e.element.style.height=t+"px",r&&e.element.style.setProperty("--ag-line-height",r)}))}},t.prototype.addEventListener=function(t,o){e.prototype.addEventListener.call(this,t,o)},t.prototype.removeEventListener=function(t,o){e.prototype.removeEventListener.call(this,t,o)},t.prototype.destroyFirstPass=function(){this.active=!1,this.beans.gridOptionsService.isAnimateRows()&&this.setupRemoveAnimation(),this.rowNode.setHovered(!1);var t=this.createRowEvent($e.EVENT_VIRTUAL_ROW_REMOVED);this.dispatchEvent(t),this.beans.eventService.dispatchEvent(t),e.prototype.destroy.call(this)},t.prototype.setupRemoveAnimation=function(){if(!this.isSticky())if(null!=this.rowNode.rowTop){var e=this.roundRowTopToBounds(this.rowNode.rowTop);this.setRowTop(e)}else this.allRowGuis.forEach((function(e){return e.rowComp.addOrRemoveCssClass("ag-opacity-zero",!0)}))},t.prototype.destroySecondPass=function(){this.allRowGuis.length=0;var e=function(e){return e.list.forEach((function(e){return e.destroy()})),{list:[],map:{}}};this.centerCellCtrls=e(this.centerCellCtrls),this.leftCellCtrls=e(this.leftCellCtrls),this.rightCellCtrls=e(this.rightCellCtrls)},t.prototype.setFocusedClasses=function(e){var t=this;this.forEachGui(e,(function(e){e.rowComp.addOrRemoveCssClass("ag-row-focus",t.rowFocused),e.rowComp.addOrRemoveCssClass("ag-row-no-focus",!t.rowFocused)}))},t.prototype.onCellFocused=function(){this.onCellFocusChanged()},t.prototype.onCellFocusCleared=function(){this.onCellFocusChanged()},t.prototype.onCellFocusChanged=function(){var e=this.beans.focusService.isRowFocused(this.rowNode.rowIndex,this.rowNode.rowPinned);e!==this.rowFocused&&(this.rowFocused=e,this.setFocusedClasses()),!e&&this.editingRow&&this.stopEditing(!1)},t.prototype.onPaginationChanged=function(){var e=this.beans.paginationProxy.getCurrentPage();this.paginationPage!==e&&(this.paginationPage=e,this.onTopChanged()),this.refreshFirstAndLastRowStyles()},t.prototype.onTopChanged=function(){this.setRowTop(this.rowNode.rowTop)},t.prototype.onPaginationPixelOffsetChanged=function(){this.onTopChanged()},t.prototype.applyPaginationOffset=function(e,t){return void 0===t&&(t=!1),this.rowNode.isRowPinned()?e:e+this.beans.paginationProxy.getPixelOffset()*(t?1:-1)},t.prototype.setRowTop=function(e){if(!this.printLayout&&r(e)){var t=this.applyPaginationOffset(e),o=(this.rowNode.isRowPinned()?t:this.beans.rowContainerHeightService.getRealPixelPosition(t))+"px";this.setRowTopStyle(o)}},t.prototype.getInitialRowTop=function(e){return this.beans.gridOptionsService.is("suppressRowTransform")?this.getInitialRowTopShared(e):void 0},t.prototype.getInitialTransform=function(e){return this.beans.gridOptionsService.is("suppressRowTransform")?void 0:"translateY("+this.getInitialRowTopShared(e)+")"},t.prototype.getInitialRowTopShared=function(e){if(this.printLayout)return"";var t;if(this.isSticky())t=this.rowNode.stickyRowTop;else{var o=this.slideInAnimation[e]?this.roundRowTopToBounds(this.rowNode.oldRowTop):this.rowNode.rowTop,n=this.applyPaginationOffset(o);t=this.rowNode.isRowPinned()?n:this.beans.rowContainerHeightService.getRealPixelPosition(n)}return t+"px"},t.prototype.setRowTopStyle=function(e){var t=this.beans.gridOptionsService.is("suppressRowTransform");this.allRowGuis.forEach((function(o){return t?o.rowComp.setTop(e):o.rowComp.setTransform("translateY("+e+")")}))},t.prototype.getRowNode=function(){return this.rowNode},t.prototype.getCellCtrl=function(e){var t=null;return this.getAllCellCtrls().forEach((function(o){o.getColumn()==e&&(t=o)})),null!=t||this.getAllCellCtrls().forEach((function(o){o.getColSpanningList().indexOf(e)>=0&&(t=o)})),t},t.prototype.onRowIndexChanged=function(){null!=this.rowNode.rowIndex&&(this.onCellFocusChanged(),this.updateRowIndexes(),this.postProcessCss())},t.prototype.updateRowIndexes=function(e){var t=this.rowNode.getRowIndexString(),o=this.beans.headerNavigationService.getHeaderRowCount(),n=this.rowNode.rowIndex%2===0,r=o+this.rowNode.rowIndex+1;this.forEachGui(e,(function(e){e.rowComp.setRowIndex(t),e.rowComp.addOrRemoveCssClass("ag-row-even",n),e.rowComp.addOrRemoveCssClass("ag-row-odd",!n),so(e.element,r)}))},t.prototype.getPinnedLeftRowElement=function(){return this.leftGui?this.leftGui.element:void 0},t.prototype.getPinnedRightRowElement=function(){return this.rightGui?this.rightGui.element:void 0},t.prototype.getBodyRowElement=function(){return this.centerGui?this.centerGui.element:void 0},t.prototype.getFullWidthRowElement=function(){return this.fullWidthGui?this.fullWidthGui.element:void 0},t.DOM_DATA_KEY_ROW_CTRL="renderedRow",t}(Fe),Vl=function(){var e=function(t,o){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])},e(t,o)};return function(t,o){function n(){this.constructor=t}e(t,o),t.prototype=null===o?Object.create(o):(n.prototype=o.prototype,new n)}}(),$l=function(e,t,o,n){var r,i=arguments.length,a=i<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,o):n;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)a=Reflect.decorate(e,t,o,n);else for(var s=e.length-1;s>=0;s--)(r=e[s])&&(a=(i<3?r(a):i>3?r(t,o,a):r(t,o))||a);return i>3&&a&&Object.defineProperty(t,o,a),a},Ul=function(e,t){var o="function"===typeof Symbol&&e[Symbol.iterator];if(!o)return e;var n,r,i=o.call(e),a=[];try{for(;(void 0===t||t-- >0)&&!(n=i.next()).done;)a.push(n.value)}catch(s){r={error:s}}finally{try{n&&!n.done&&(o=i.return)&&o.call(i)}finally{if(r)throw r.error}}return a},Wl=function(e){function t(t){var o=e.call(this)||this;return o.element=t,o}return Vl(t,e),t.prototype.postConstruct=function(){this.addMouseListeners(),this.mockContextMenuForIPad(),this.addKeyboardEvents()},t.prototype.addKeyboardEvents=function(){var e=this;["keydown","keypress"].forEach((function(t){var o=e.processKeyboardEvent.bind(e,t);e.addManagedListener(e.element,t,o)}))},t.prototype.addMouseListeners=function(){var e=this;["dblclick","contextmenu","mouseover","mouseout","click",Oe("touchstart")?"touchstart":"mousedown"].forEach((function(t){var o=e.processMouseEvent.bind(e,t);e.addManagedListener(e.element,t,o)}))},t.prototype.processMouseEvent=function(e,t){if(this.mouseEventService.isEventFromThisGrid(t)&&!Re(t)){var o=this.getRowForEvent(t),n=this.mouseEventService.getRenderedCellForEvent(t);"contextmenu"===e?this.handleContextMenuMouseEvent(t,null,o,n):(n&&n.onMouseEvent(e,t),o&&o.onMouseEvent(e,t))}},t.prototype.mockContextMenuForIPad=function(){var e=this;if(Oo()){var t=new Yi(this.element);this.addManagedListener(t,Yi.EVENT_LONG_TAP,(function(t){var o=e.getRowForEvent(t.touchEvent),n=e.mouseEventService.getRenderedCellForEvent(t.touchEvent);e.handleContextMenuMouseEvent(null,t.touchEvent,o,n)})),this.addDestroyFunc((function(){return t.destroy()}))}},t.prototype.getRowForEvent=function(e){for(var t=e.target;t;){var o=this.gridOptionsService.getDomData(t,Bl.DOM_DATA_KEY_ROW_CTRL);if(o)return o;t=t.parentElement}return null},t.prototype.handleContextMenuMouseEvent=function(e,t,o,n){var r=o?o.getRowNode():null,i=n?n.getColumn():null,a=null;if(i){var s=e||t;n.dispatchCellContextMenuEvent(s),a=this.valueService.getValue(i,r)}var l=this.ctrlsService.getGridBodyCtrl(),c=n?n.getGui():l.getGridBodyElement();this.contextMenuFactory&&this.contextMenuFactory.onContextMenu(e,t,r,i,a,c)},t.prototype.processKeyboardEvent=function(e,t){var o=Te(this.gridOptionsService,t.target,Nl.DOM_DATA_KEY_CELL_CTRL),n=Te(this.gridOptionsService,t.target,Bl.DOM_DATA_KEY_ROW_CTRL);t.defaultPrevented||(o?this.processCellKeyboardEvent(o,e,t):n&&n.isFullWidth()&&this.processFullWidthRowKeyboardEvent(n,e,t))},t.prototype.processCellKeyboardEvent=function(e,t,o){var n=e.getRowNode(),r=e.getColumn(),i=e.isEditing();if(!Vn(this.gridOptionsService,o,n,r,i))switch(t){case"keydown":!i&&this.navigationService.handlePageScrollingKey(o)||e.onKeyDown(o),this.doGridOperations(o,e.isEditing());break;case"keypress":e.onKeyPress(o)}if("keydown"===t){var a=e.createEvent(o,$e.EVENT_CELL_KEY_DOWN);this.eventService.dispatchEvent(a)}if("keypress"===t){var s=e.createEvent(o,$e.EVENT_CELL_KEY_PRESS);this.eventService.dispatchEvent(s)}},t.prototype.processFullWidthRowKeyboardEvent=function(e,t,o){var n=e.getRowNode(),r=this.focusService.getFocusedCell(),i=r&&r.column;if(!Vn(this.gridOptionsService,o,n,i,!1)){var a=o.key;if("keydown"===t)switch(a){case Hn.PAGE_HOME:case Hn.PAGE_END:this.navigationService.handlePageScrollingKey(o);break;case Hn.UP:case Hn.DOWN:e.onKeyboardNavigate(o);break;case Hn.TAB:e.onTabKeyDown(o)}}if("keydown"===t){var s=e.createRowEvent($e.EVENT_CELL_KEY_DOWN,o);this.eventService.dispatchEvent(s)}if("keypress"===t){var l=e.createRowEvent($e.EVENT_CELL_KEY_PRESS,o);this.eventService.dispatchEvent(l)}},t.prototype.doGridOperations=function(e,t){if((e.ctrlKey||e.metaKey)&&!t&&this.mouseEventService.isEventFromThisGrid(e)){var o=Un(e);return o===Hn.A?this.onCtrlAndA(e):o===Hn.C?this.onCtrlAndC(e):o===Hn.X?this.onCtrlAndX(e):o===Hn.V?this.onCtrlAndV():o===Hn.D?this.onCtrlAndD(e):o===Hn.Z?this.onCtrlAndZ(e):o===Hn.Y?this.onCtrlAndY():void 0}},t.prototype.onCtrlAndA=function(e){var t=this,o=t.pinnedRowModel,n=t.paginationProxy,r=t.rangeService;if(r&&n.isRowsToRender()){var i=Ul([o.isEmpty("top"),o.isEmpty("bottom")],2),s=i[0]?null:"top",l=void 0,c=void 0;i[1]?(l=null,c=this.paginationProxy.getRowCount()-1):(l="bottom",c=o.getPinnedBottomRowData().length-1);var d=this.columnModel.getAllDisplayedColumns();if(a(d))return;r.setCellRange({rowStartIndex:0,rowStartPinned:s,rowEndIndex:c,rowEndPinned:l,columnStart:d[0],columnEnd:fe(d)})}e.preventDefault()},t.prototype.onCtrlAndC=function(e){this.clipboardService&&!this.gridOptionsService.is("enableCellTextSelection")&&(this.clipboardService.copyToClipboard(),e.preventDefault())},t.prototype.onCtrlAndX=function(e){!this.clipboardService||this.gridOptionsService.is("enableCellTextSelection")||this.gridOptionsService.is("suppressCutToClipboard")||(this.clipboardService.cutToClipboard(),e.preventDefault())},t.prototype.onCtrlAndV=function(){ne.isRegistered(Q.ClipboardModule)&&!this.gridOptionsService.is("suppressClipboardPaste")&&this.clipboardService.pasteFromClipboard()},t.prototype.onCtrlAndD=function(e){ne.isRegistered(Q.ClipboardModule)&&!this.gridOptionsService.is("suppressClipboardPaste")&&this.clipboardService.copyRangeDown(),e.preventDefault()},t.prototype.onCtrlAndZ=function(e){this.gridOptionsService.is("undoRedoCellEditing")&&(e.preventDefault(),e.shiftKey?this.undoRedoService.redo("ui"):this.undoRedoService.undo("ui"))},t.prototype.onCtrlAndY=function(){this.undoRedoService.redo("ui")},$l([q("mouseEventService")],t.prototype,"mouseEventService",void 0),$l([q("valueService")],t.prototype,"valueService",void 0),$l([K("contextMenuFactory")],t.prototype,"contextMenuFactory",void 0),$l([q("ctrlsService")],t.prototype,"ctrlsService",void 0),$l([q("navigationService")],t.prototype,"navigationService",void 0),$l([q("focusService")],t.prototype,"focusService",void 0),$l([q("undoRedoService")],t.prototype,"undoRedoService",void 0),$l([q("columnModel")],t.prototype,"columnModel",void 0),$l([q("paginationProxy")],t.prototype,"paginationProxy",void 0),$l([q("pinnedRowModel")],t.prototype,"pinnedRowModel",void 0),$l([K("rangeService")],t.prototype,"rangeService",void 0),$l([K("clipboardService")],t.prototype,"clipboardService",void 0),$l([$],t.prototype,"postConstruct",null),t}(Fe),ql=function(){var e=function(t,o){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])},e(t,o)};return function(t,o){function n(){this.constructor=t}e(t,o),t.prototype=null===o?Object.create(o):(n.prototype=o.prototype,new n)}}(),Kl=function(e,t,o,n){var r,i=arguments.length,a=i<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,o):n;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)a=Reflect.decorate(e,t,o,n);else for(var s=e.length-1;s>=0;s--)(r=e[s])&&(a=(i<3?r(a):i>3?r(t,o,a):r(t,o))||a);return i>3&&a&&Object.defineProperty(t,o,a),a},Yl=function(e){function t(t){var o=e.call(this)||this;return o.centerContainerCtrl=t,o}return ql(t,e),t.prototype.postConstruct=function(){var e=this;this.ctrlsService.whenReady((function(){e.gridBodyCtrl=e.ctrlsService.getGridBodyCtrl(),e.listenForResize()})),this.addManagedListener(this.eventService,$e.EVENT_SCROLLBAR_WIDTH_CHANGED,this.onScrollbarWidthChanged.bind(this))},t.prototype.listenForResize=function(){var e=this,t=function(){return e.onCenterViewportResized()};this.centerContainerCtrl.registerViewportResizeListener(t),this.gridBodyCtrl.registerBodyViewportResizeListener(t)},t.prototype.onScrollbarWidthChanged=function(){this.checkViewportAndScrolls()},t.prototype.onCenterViewportResized=function(){if(this.centerContainerCtrl.isViewportVisible()){this.checkViewportAndScrolls();var e=this.centerContainerCtrl.getCenterWidth();e!==this.centerWidth&&(this.centerWidth=e,this.columnModel.refreshFlexedColumns({viewportWidth:this.centerWidth,updateBodyWidths:!0,fireResizedEvent:!0}))}else this.bodyHeight=0},t.prototype.checkViewportAndScrolls=function(){this.updateScrollVisibleService(),this.checkBodyHeight(),this.onHorizontalViewportChanged(),this.gridBodyCtrl.getScrollFeature().checkScrollLeft()},t.prototype.getBodyHeight=function(){return this.bodyHeight},t.prototype.checkBodyHeight=function(){var e=ln(this.gridBodyCtrl.getBodyViewportElement());if(this.bodyHeight!==e){this.bodyHeight=e;var t={type:$e.EVENT_BODY_HEIGHT_CHANGED};this.eventService.dispatchEvent(t)}},t.prototype.updateScrollVisibleService=function(){this.updateScrollVisibleServiceImpl(),setTimeout(this.updateScrollVisibleServiceImpl.bind(this),500)},t.prototype.updateScrollVisibleServiceImpl=function(){var e={horizontalScrollShowing:this.isHorizontalScrollShowing(),verticalScrollShowing:this.gridBodyCtrl.isVerticalScrollShowing()};this.scrollVisibleService.setScrollsVisible(e)},t.prototype.isHorizontalScrollShowing=function(){return this.centerContainerCtrl.isHorizontalScrollShowing()},t.prototype.onHorizontalViewportChanged=function(){var e=this.centerContainerCtrl.getCenterWidth(),t=this.centerContainerCtrl.getViewportScrollLeft();this.columnModel.setViewportPosition(e,t)},Kl([q("ctrlsService")],t.prototype,"ctrlsService",void 0),Kl([q("columnModel")],t.prototype,"columnModel",void 0),Kl([q("scrollVisibleService")],t.prototype,"scrollVisibleService",void 0),Kl([$],t.prototype,"postConstruct",null),t}(Fe),Jl=function(){var e=function(t,o){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])},e(t,o)};return function(t,o){function n(){this.constructor=t}e(t,o),t.prototype=null===o?Object.create(o):(n.prototype=o.prototype,new n)}}(),Xl=function(e,t,o,n){var r,i=arguments.length,a=i<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,o):n;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)a=Reflect.decorate(e,t,o,n);else for(var s=e.length-1;s>=0;s--)(r=e[s])&&(a=(i<3?r(a):i>3?r(t,o,a):r(t,o))||a);return i>3&&a&&Object.defineProperty(t,o,a),a},Ql=function(e){function t(t){var o=e.call(this)||this;return o.element=t,o}return Jl(t,e),t.prototype.postConstruct=function(){this.addManagedListener(this.eventService,$e.EVENT_LEFT_PINNED_WIDTH_CHANGED,this.onPinnedLeftWidthChanged.bind(this))},t.prototype.onPinnedLeftWidthChanged=function(){var e=this.pinnedWidthService.getPinnedLeftWidth(),t=e>0;on(this.element,t),An(this.element,e)},t.prototype.getWidth=function(){return this.pinnedWidthService.getPinnedLeftWidth()},Xl([q("pinnedWidthService")],t.prototype,"pinnedWidthService",void 0),Xl([$],t.prototype,"postConstruct",null),t}(Fe),Zl=function(){var e=function(t,o){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])},e(t,o)};return function(t,o){function n(){this.constructor=t}e(t,o),t.prototype=null===o?Object.create(o):(n.prototype=o.prototype,new n)}}(),ec=function(e,t,o,n){var r,i=arguments.length,a=i<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,o):n;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)a=Reflect.decorate(e,t,o,n);else for(var s=e.length-1;s>=0;s--)(r=e[s])&&(a=(i<3?r(a):i>3?r(t,o,a):r(t,o))||a);return i>3&&a&&Object.defineProperty(t,o,a),a},tc=function(e){function t(t){var o=e.call(this)||this;return o.element=t,o}return Zl(t,e),t.prototype.postConstruct=function(){this.addManagedListener(this.eventService,$e.EVENT_RIGHT_PINNED_WIDTH_CHANGED,this.onPinnedRightWidthChanged.bind(this))},t.prototype.onPinnedRightWidthChanged=function(){var e=this.pinnedWidthService.getPinnedRightWidth(),t=e>0;on(this.element,t),An(this.element,e)},t.prototype.getWidth=function(){return this.pinnedWidthService.getPinnedRightWidth()},ec([q("pinnedWidthService")],t.prototype,"pinnedWidthService",void 0),ec([$],t.prototype,"postConstruct",null),t}(Fe),oc=function(){var e=function(t,o){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])},e(t,o)};return function(t,o){function n(){this.constructor=t}e(t,o),t.prototype=null===o?Object.create(o):(n.prototype=o.prototype,new n)}}(),nc=function(e,t,o,n){var r,i=arguments.length,a=i<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,o):n;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)a=Reflect.decorate(e,t,o,n);else for(var s=e.length-1;s>=0;s--)(r=e[s])&&(a=(i<3?r(a):i>3?r(t,o,a):r(t,o))||a);return i>3&&a&&Object.defineProperty(t,o,a),a},rc=function(e){function t(t,o){var n=e.call(this)||this;return n.eContainer=t,n.eWrapper=o,n}return oc(t,e),t.prototype.postConstruct=function(){this.addManagedListener(this.eventService,$e.EVENT_ROW_CONTAINER_HEIGHT_CHANGED,this.onHeightChanged.bind(this))},t.prototype.onHeightChanged=function(){var e=this.maxDivHeightScaler.getUiContainerHeight(),t=null!=e?e+"px":"";this.eContainer.style.height=t,this.eWrapper&&(this.eWrapper.style.height=t)},nc([q("rowContainerHeightService")],t.prototype,"maxDivHeightScaler",void 0),nc([$],t.prototype,"postConstruct",null),t}(Fe),ic=function(){var e=function(t,o){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])},e(t,o)};return function(t,o){function n(){this.constructor=t}e(t,o),t.prototype=null===o?Object.create(o):(n.prototype=o.prototype,new n)}}(),ac=function(e,t,o,n){var r,i=arguments.length,a=i<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,o):n;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)a=Reflect.decorate(e,t,o,n);else for(var s=e.length-1;s>=0;s--)(r=e[s])&&(a=(i<3?r(a):i>3?r(t,o,a):r(t,o))||a);return i>3&&a&&Object.defineProperty(t,o,a),a},sc=function(e){function t(t){var o=e.call(this)||this;return o.eContainer=t,o}return ic(t,e),t.prototype.postConstruct=function(){var e=this;if(this.gridOptionsService.isEnableRangeSelection()&&!i(this.rangeService)){var t={eElement:this.eContainer,onDragStart:this.rangeService.onDragStart.bind(this.rangeService),onDragStop:this.rangeService.onDragStop.bind(this.rangeService),onDragging:this.rangeService.onDragging.bind(this.rangeService)};this.dragService.addDragSource(t),this.addDestroyFunc((function(){return e.dragService.removeDragSource(t)}))}},ac([K("rangeService")],t.prototype,"rangeService",void 0),ac([q("dragService")],t.prototype,"dragService",void 0),ac([$],t.prototype,"postConstruct",null),t}(Fe),lc=function(){var e=function(t,o){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])},e(t,o)};return function(t,o){function n(){this.constructor=t}e(t,o),t.prototype=null===o?Object.create(o):(n.prototype=o.prototype,new n)}}(),cc=function(e,t,o,n){var r,i=arguments.length,a=i<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,o):n;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)a=Reflect.decorate(e,t,o,n);else for(var s=e.length-1;s>=0;s--)(r=e[s])&&(a=(i<3?r(a):i>3?r(t,o,a):r(t,o))||a);return i>3&&a&&Object.defineProperty(t,o,a),a},dc=function(e){function t(t,o){void 0===o&&(o=!1);var n=e.call(this)||this;return n.callback=t,n.addSpacer=o,n}return lc(t,e),t.prototype.postConstruct=function(){var e=this.setWidth.bind(this);this.addManagedPropertyListener("domLayout",e),this.addManagedListener(this.eventService,$e.EVENT_DISPLAYED_COLUMNS_CHANGED,e),this.addManagedListener(this.eventService,$e.EVENT_DISPLAYED_COLUMNS_WIDTH_CHANGED,e),this.addManagedListener(this.eventService,$e.EVENT_LEFT_PINNED_WIDTH_CHANGED,e),this.addSpacer&&(this.addManagedListener(this.eventService,$e.EVENT_RIGHT_PINNED_WIDTH_CHANGED,e),this.addManagedListener(this.eventService,$e.EVENT_SCROLL_VISIBILITY_CHANGED,e),this.addManagedListener(this.eventService,$e.EVENT_SCROLLBAR_WIDTH_CHANGED,e)),this.setWidth()},t.prototype.setWidth=function(){var e,t=this.columnModel,o=this.gridOptionsService.isDomLayout("print"),n=t.getBodyContainerWidth(),r=t.getDisplayedColumnsLeftWidth(),i=t.getDisplayedColumnsRightWidth();o?e=n+r+i:(e=n,this.addSpacer&&0===(this.gridOptionsService.is("enableRtl")?r:i)&&this.scrollVisibleService.isVerticalScrollShowing()&&(e+=this.gridOptionsService.getScrollbarWidth()));this.callback(e)},cc([q("columnModel")],t.prototype,"columnModel",void 0),cc([q("scrollVisibleService")],t.prototype,"scrollVisibleService",void 0),cc([$],t.prototype,"postConstruct",null),t}(Fe),uc=function(){var e=function(t,o){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])},e(t,o)};return function(t,o){function n(){this.constructor=t}e(t,o),t.prototype=null===o?Object.create(o):(n.prototype=o.prototype,new n)}}(),pc=function(e,t,o,n){var r,i=arguments.length,a=i<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,o):n;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)a=Reflect.decorate(e,t,o,n);else for(var s=e.length-1;s>=0;s--)(r=e[s])&&(a=(i<3?r(a):i>3?r(t,o,a):r(t,o))||a);return i>3&&a&&Object.defineProperty(t,o,a),a},hc=function(e,t){var o="function"===typeof Symbol&&e[Symbol.iterator];if(!o)return e;var n,r,i=o.call(e),a=[];try{for(;(void 0===t||t-- >0)&&!(n=i.next()).done;)a.push(n.value)}catch(s){r={error:s}}finally{try{n&&!n.done&&(o=i.return)&&o.call(i)}finally{if(r)throw r.error}}return a},fc=function(){for(var e=[],t=0;t<arguments.length;t++)e=e.concat(hc(arguments[t]));return e};function gc(e){switch(e){case Gl.CENTER:case Gl.TOP_CENTER:case Gl.STICKY_TOP_CENTER:case Gl.BOTTOM_CENTER:return zl.CENTER;case Gl.LEFT:case Gl.TOP_LEFT:case Gl.STICKY_TOP_LEFT:case Gl.BOTTOM_LEFT:return zl.LEFT;case Gl.RIGHT:case Gl.TOP_RIGHT:case Gl.STICKY_TOP_RIGHT:case Gl.BOTTOM_RIGHT:return zl.RIGHT;case Gl.FULL_WIDTH:case Gl.TOP_FULL_WIDTH:case Gl.STICKY_TOP_FULL_WIDTH:case Gl.BOTTOM_FULL_WIDTH:return zl.FULL_WIDTH;default:throw Error("Invalid Row Container Type")}}!function(e){e.LEFT="left",e.RIGHT="right",e.CENTER="center",e.FULL_WIDTH="fullWidth",e.TOP_LEFT="topLeft",e.TOP_RIGHT="topRight",e.TOP_CENTER="topCenter",e.TOP_FULL_WIDTH="topFullWidth",e.STICKY_TOP_LEFT="stickyTopLeft",e.STICKY_TOP_RIGHT="stickyTopRight",e.STICKY_TOP_CENTER="stickyTopCenter",e.STICKY_TOP_FULL_WIDTH="stickyTopFullWidth",e.BOTTOM_LEFT="bottomLeft",e.BOTTOM_RIGHT="bottomRight",e.BOTTOM_CENTER="bottomCenter",e.BOTTOM_FULL_WIDTH="bottomFullWidth"}(Gl||(Gl={})),function(e){e.LEFT="left",e.RIGHT="right",e.CENTER="center",e.FULL_WIDTH="fullWidth"}(zl||(zl={}));var mc=wt([[Gl.CENTER,"ag-center-cols-container"],[Gl.LEFT,"ag-pinned-left-cols-container"],[Gl.RIGHT,"ag-pinned-right-cols-container"],[Gl.FULL_WIDTH,"ag-full-width-container"],[Gl.TOP_CENTER,"ag-floating-top-container"],[Gl.TOP_LEFT,"ag-pinned-left-floating-top"],[Gl.TOP_RIGHT,"ag-pinned-right-floating-top"],[Gl.TOP_FULL_WIDTH,"ag-floating-top-full-width-container"],[Gl.STICKY_TOP_CENTER,"ag-sticky-top-container"],[Gl.STICKY_TOP_LEFT,"ag-pinned-left-sticky-top"],[Gl.STICKY_TOP_RIGHT,"ag-pinned-right-sticky-top"],[Gl.STICKY_TOP_FULL_WIDTH,"ag-sticky-top-full-width-container"],[Gl.BOTTOM_CENTER,"ag-floating-bottom-container"],[Gl.BOTTOM_LEFT,"ag-pinned-left-floating-bottom"],[Gl.BOTTOM_RIGHT,"ag-pinned-right-floating-bottom"],[Gl.BOTTOM_FULL_WIDTH,"ag-floating-bottom-full-width-container"]]),yc=wt([[Gl.CENTER,"ag-center-cols-viewport"],[Gl.TOP_CENTER,"ag-floating-top-viewport"],[Gl.STICKY_TOP_CENTER,"ag-sticky-top-viewport"],[Gl.BOTTOM_CENTER,"ag-floating-bottom-viewport"]]),vc=wt([[Gl.CENTER,"ag-center-cols-clipper"]]),bc=function(e){function t(t){var o=e.call(this)||this;return o.visible=!0,o.EMPTY_CTRLS=[],o.name=t,o.isFullWithContainer=o.name===Gl.TOP_FULL_WIDTH||o.name===Gl.STICKY_TOP_FULL_WIDTH||o.name===Gl.BOTTOM_FULL_WIDTH||o.name===Gl.FULL_WIDTH,o}return uc(t,e),t.getRowContainerCssClasses=function(e){return{container:mc.get(e),viewport:yc.get(e),wrapper:vc.get(e)}},t.getPinned=function(e){switch(e){case Gl.BOTTOM_LEFT:case Gl.TOP_LEFT:case Gl.STICKY_TOP_LEFT:case Gl.LEFT:return"left";case Gl.BOTTOM_RIGHT:case Gl.TOP_RIGHT:case Gl.STICKY_TOP_RIGHT:case Gl.RIGHT:return"right";default:return null}},t.prototype.postConstruct=function(){var e=this;this.enableRtl=this.gridOptionsService.is("enableRtl"),this.embedFullWidthRows=this.gridOptionsService.is("embedFullWidthRows"),this.forContainers([Gl.CENTER],(function(){return e.viewportSizeFeature=e.createManagedBean(new Yl(e))}))},t.prototype.registerWithCtrlsService=function(){switch(this.name){case Gl.CENTER:this.ctrlsService.registerCenterRowContainerCtrl(this);break;case Gl.LEFT:this.ctrlsService.registerLeftRowContainerCtrl(this);break;case Gl.RIGHT:this.ctrlsService.registerRightRowContainerCtrl(this);break;case Gl.TOP_CENTER:this.ctrlsService.registerTopCenterRowContainerCtrl(this);break;case Gl.TOP_LEFT:this.ctrlsService.registerTopLeftRowContainerCon(this);break;case Gl.TOP_RIGHT:this.ctrlsService.registerTopRightRowContainerCtrl(this);break;case Gl.STICKY_TOP_CENTER:this.ctrlsService.registerStickyTopCenterRowContainerCtrl(this);break;case Gl.STICKY_TOP_LEFT:this.ctrlsService.registerStickyTopLeftRowContainerCon(this);break;case Gl.STICKY_TOP_RIGHT:this.ctrlsService.registerStickyTopRightRowContainerCtrl(this);break;case Gl.BOTTOM_CENTER:this.ctrlsService.registerBottomCenterRowContainerCtrl(this);break;case Gl.BOTTOM_LEFT:this.ctrlsService.registerBottomLeftRowContainerCtrl(this);break;case Gl.BOTTOM_RIGHT:this.ctrlsService.registerBottomRightRowContainerCtrl(this)}},t.prototype.forContainers=function(e,t){e.indexOf(this.name)>=0&&t()},t.prototype.getContainerElement=function(){return this.eContainer},t.prototype.getViewportSizeFeature=function(){return this.viewportSizeFeature},t.prototype.setComp=function(e,t,o,n){var r=this;this.comp=e,this.eContainer=t,this.eViewport=o,this.eWrapper=n,this.createManagedBean(new Wl(this.eContainer)),this.addPreventScrollWhileDragging(),this.listenOnDomOrder(),this.stopHScrollOnPinnedRows();var i=[Gl.TOP_CENTER,Gl.TOP_LEFT,Gl.TOP_RIGHT],a=[Gl.STICKY_TOP_CENTER,Gl.STICKY_TOP_LEFT,Gl.STICKY_TOP_RIGHT],s=[Gl.BOTTOM_CENTER,Gl.BOTTOM_LEFT,Gl.BOTTOM_RIGHT],l=[Gl.CENTER,Gl.LEFT,Gl.RIGHT],c=fc(i,s,l,a),d=[Gl.CENTER,Gl.LEFT,Gl.RIGHT,Gl.FULL_WIDTH],u=[Gl.CENTER,Gl.TOP_CENTER,Gl.STICKY_TOP_CENTER,Gl.BOTTOM_CENTER],p=[Gl.LEFT,Gl.BOTTOM_LEFT,Gl.TOP_LEFT,Gl.STICKY_TOP_LEFT],h=[Gl.RIGHT,Gl.BOTTOM_RIGHT,Gl.TOP_RIGHT,Gl.STICKY_TOP_RIGHT];this.forContainers(p,(function(){r.pinnedWidthFeature=r.createManagedBean(new Ql(r.eContainer)),r.addManagedListener(r.eventService,$e.EVENT_LEFT_PINNED_WIDTH_CHANGED,(function(){return r.onPinnedWidthChanged()}))})),this.forContainers(h,(function(){r.pinnedWidthFeature=r.createManagedBean(new tc(r.eContainer)),r.addManagedListener(r.eventService,$e.EVENT_RIGHT_PINNED_WIDTH_CHANGED,(function(){return r.onPinnedWidthChanged()}))})),this.forContainers(d,(function(){return r.createManagedBean(new rc(r.eContainer,r.eWrapper))})),this.forContainers(c,(function(){return r.createManagedBean(new sc(r.eContainer))})),this.forContainers(u,(function(){return r.createManagedBean(new dc((function(e){return r.comp.setContainerWidth(e+"px")})))})),Fo()&&(this.forContainers([Gl.CENTER],(function(){var e=r.enableRtl?$e.EVENT_LEFT_PINNED_WIDTH_CHANGED:$e.EVENT_RIGHT_PINNED_WIDTH_CHANGED;r.addManagedListener(r.eventService,e,(function(){return r.refreshPaddingForFakeScrollbar()}))})),this.refreshPaddingForFakeScrollbar()),this.addListeners(),this.registerWithCtrlsService()},t.prototype.refreshPaddingForFakeScrollbar=function(){var e=this,t=e.enableRtl,o=e.columnModel,n=e.name,r=e.eWrapper,i=e.eContainer,a=t?Gl.LEFT:Gl.RIGHT;this.forContainers([Gl.CENTER,a],(function(){var e=o.getContainerWidth(a),s=t?"marginLeft":"marginRight";n===Gl.CENTER?r.style[s]=e?"0px":"16px":i.style[s]=e?"16px":"0px"}))},t.prototype.addListeners=function(){var e=this;this.addManagedListener(this.eventService,$e.EVENT_SCROLL_VISIBILITY_CHANGED,(function(){return e.onScrollVisibilityChanged()})),this.addManagedListener(this.eventService,$e.EVENT_DISPLAYED_COLUMNS_CHANGED,(function(){return e.onDisplayedColumnsChanged()})),this.addManagedListener(this.eventService,$e.EVENT_DISPLAYED_COLUMNS_WIDTH_CHANGED,(function(){return e.onDisplayedColumnsWidthChanged()})),this.addManagedListener(this.eventService,$e.EVENT_DISPLAYED_ROWS_CHANGED,(function(t){return e.onDisplayedRowsChanged(t.afterScroll)})),this.onScrollVisibilityChanged(),this.onDisplayedColumnsChanged(),this.onDisplayedColumnsWidthChanged(),this.onDisplayedRowsChanged()},t.prototype.listenOnDomOrder=function(){var e=this;if([Gl.STICKY_TOP_CENTER,Gl.STICKY_TOP_LEFT,Gl.STICKY_TOP_RIGHT,Gl.STICKY_TOP_FULL_WIDTH].indexOf(this.name)>=0)this.comp.setDomOrder(!0);else{var t=function(){var t=e.gridOptionsService.is("ensureDomOrder"),o=e.gridOptionsService.isDomLayout("print");e.comp.setDomOrder(t||o)};this.addManagedPropertyListener("domLayout",t),t()}},t.prototype.stopHScrollOnPinnedRows=function(){var e=this;this.forContainers([Gl.TOP_CENTER,Gl.STICKY_TOP_CENTER,Gl.BOTTOM_CENTER],(function(){e.addManagedListener(e.eViewport,"scroll",(function(){return e.eViewport.scrollLeft=0}))}))},t.prototype.onDisplayedColumnsChanged=function(){var e=this;this.forContainers([Gl.CENTER],(function(){return e.onHorizontalViewportChanged()}))},t.prototype.onDisplayedColumnsWidthChanged=function(){var e=this;this.forContainers([Gl.CENTER],(function(){return e.onHorizontalViewportChanged()}))},t.prototype.onScrollVisibilityChanged=function(){var e=this.gridOptionsService.getScrollbarWidth()||0;if(this.name===Gl.CENTER){var t=this.scrollVisibleService.isHorizontalScrollShowing()?e:0,o=0==t?"100%":"calc(100% + "+t+"px)";this.comp.setViewportHeight(o)}if(this.name===Gl.FULL_WIDTH){o="calc(100% - "+(Fo()?16:0)+"px)";this.eContainer.style.setProperty("width",o)}},t.prototype.addPreventScrollWhileDragging=function(){var e=this,t=function(t){e.dragService.isDragging()&&t.cancelable&&t.preventDefault()};this.eContainer.addEventListener("touchmove",t,{passive:!1}),this.addDestroyFunc((function(){return e.eContainer.removeEventListener("touchmove",t)}))},t.prototype.onHorizontalViewportChanged=function(){var e=this.getCenterWidth(),t=this.getCenterViewportScrollLeft();this.columnModel.setViewportPosition(e,t)},t.prototype.getCenterWidth=function(){return cn(this.eViewport)},t.prototype.getCenterViewportScrollLeft=function(){return hn(this.eViewport,this.enableRtl)},t.prototype.registerViewportResizeListener=function(e){var t=this.resizeObserverService.observeResize(this.eViewport,e);this.addDestroyFunc((function(){return t()}))},t.prototype.isViewportVisible=function(){return yn(this.eViewport)},t.prototype.getViewportScrollLeft=function(){return hn(this.eViewport,this.enableRtl)},t.prototype.isHorizontalScrollShowing=function(){return this.gridOptionsService.is("alwaysShowHorizontalScroll")||En(this.eViewport)},t.prototype.getViewportElement=function(){return this.eViewport},t.prototype.setContainerTranslateX=function(e){this.eContainer.style.transform="translateX("+e+"px)"},t.prototype.getHScrollPosition=function(){return{left:this.eViewport.scrollLeft,right:this.eViewport.scrollLeft+this.eViewport.offsetWidth}},t.prototype.setCenterViewportScrollLeft=function(e){fn(this.eViewport,e,this.enableRtl)},t.prototype.isContainerVisible=function(){return!t.getPinned(this.name)||!!this.pinnedWidthFeature&&this.pinnedWidthFeature.getWidth()>0},t.prototype.onPinnedWidthChanged=function(){var e=this.isContainerVisible();this.visible!=e&&(this.visible=e,this.onDisplayedRowsChanged()),Fo()&&this.refreshPaddingForFakeScrollbar()},t.prototype.onDisplayedRowsChanged=function(e){var t=this;if(void 0===e&&(e=!1),this.visible){var o=this.gridOptionsService.isDomLayout("print"),n=this.getRowCtrls().filter((function(e){var n=e.isFullWidth(),r=t.embedFullWidthRows||o;return t.isFullWithContainer?!r&&n:r||!n}));this.comp.setRowCtrls(n,e)}else this.comp.setRowCtrls(this.EMPTY_CTRLS,!1)},t.prototype.getRowCtrls=function(){switch(this.name){case Gl.TOP_CENTER:case Gl.TOP_LEFT:case Gl.TOP_RIGHT:case Gl.TOP_FULL_WIDTH:return this.rowRenderer.getTopRowCtrls();case Gl.STICKY_TOP_CENTER:case Gl.STICKY_TOP_LEFT:case Gl.STICKY_TOP_RIGHT:case Gl.STICKY_TOP_FULL_WIDTH:return this.rowRenderer.getStickyTopRowCtrls();case Gl.BOTTOM_CENTER:case Gl.BOTTOM_LEFT:case Gl.BOTTOM_RIGHT:case Gl.BOTTOM_FULL_WIDTH:return this.rowRenderer.getBottomRowCtrls();default:return this.rowRenderer.getRowCtrls()}},pc([q("scrollVisibleService")],t.prototype,"scrollVisibleService",void 0),pc([q("dragService")],t.prototype,"dragService",void 0),pc([q("ctrlsService")],t.prototype,"ctrlsService",void 0),pc([q("columnModel")],t.prototype,"columnModel",void 0),pc([q("resizeObserverService")],t.prototype,"resizeObserverService",void 0),pc([q("rowRenderer")],t.prototype,"rowRenderer",void 0),pc([$],t.prototype,"postConstruct",null),t}(Fe),xc=function(){var e=function(t,o){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])},e(t,o)};return function(t,o){function n(){this.constructor=t}e(t,o),t.prototype=null===o?Object.create(o):(n.prototype=o.prototype,new n)}}(),wc=function(e,t,o,n){var r,i=arguments.length,a=i<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,o):n;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)a=Reflect.decorate(e,t,o,n);else for(var s=e.length-1;s>=0;s--)(r=e[s])&&(a=(i<3?r(a):i>3?r(t,o,a):r(t,o))||a);return i>3&&a&&Object.defineProperty(t,o,a),a},Cc='<div class="ag-root ag-unselectable" role="treegrid">\n        <ag-header-root ref="gridHeader"></ag-header-root>\n        <div class="ag-floating-top" ref="eTop" role="presentation">\n            <ag-row-container ref="topLeftContainer" name="'+Gl.TOP_LEFT+'"></ag-row-container>\n            <ag-row-container ref="topCenterContainer" name="'+Gl.TOP_CENTER+'"></ag-row-container>\n            <ag-row-container ref="topRightContainer" name="'+Gl.TOP_RIGHT+'"></ag-row-container>\n            <ag-row-container ref="topFullWidthContainer" name="'+Gl.TOP_FULL_WIDTH+'"></ag-row-container>\n        </div>\n        <div class="ag-body" ref="eBody" role="presentation">\n            <div class="ag-body-clipper" ref="eBodyClipper" role="presentation">\n                <div class="ag-body-viewport" ref="eBodyViewport" role="presentation">\n                    <ag-row-container ref="leftContainer" name="'+Gl.LEFT+'"></ag-row-container>\n                    <ag-row-container ref="centerContainer" name="'+Gl.CENTER+'"></ag-row-container>\n                    <ag-row-container ref="rightContainer" name="'+Gl.RIGHT+'"></ag-row-container>\n                    <ag-row-container ref="fullWidthContainer" name="'+Gl.FULL_WIDTH+'"></ag-row-container>\n                </div>\n            </div>\n            <ag-fake-vertical-scroll></ag-fake-vertical-scroll>\n        </div>\n        <div class="ag-sticky-top" ref="eStickyTop" role="presentation">\n            <ag-row-container ref="stickyTopLeftContainer" name="'+Gl.STICKY_TOP_LEFT+'"></ag-row-container>\n            <ag-row-container ref="stickyTopCenterContainer" name="'+Gl.STICKY_TOP_CENTER+'"></ag-row-container>\n            <ag-row-container ref="stickyTopRightContainer" name="'+Gl.STICKY_TOP_RIGHT+'"></ag-row-container>\n            <ag-row-container ref="stickyTopFullWidthContainer" name="'+Gl.STICKY_TOP_FULL_WIDTH+'"></ag-row-container>\n        </div>\n        <div class="ag-floating-bottom" ref="eBottom" role="presentation">\n            <ag-row-container ref="bottomLeftContainer" name="'+Gl.BOTTOM_LEFT+'"></ag-row-container>\n            <ag-row-container ref="bottomCenterContainer" name="'+Gl.BOTTOM_CENTER+'"></ag-row-container>\n            <ag-row-container ref="bottomRightContainer" name="'+Gl.BOTTOM_RIGHT+'"></ag-row-container>\n            <ag-row-container ref="bottomFullWidthContainer" name="'+Gl.BOTTOM_FULL_WIDTH+'"></ag-row-container>\n        </div>\n        <ag-fake-horizontal-scroll></ag-fake-horizontal-scroll>\n        <ag-overlay-wrapper></ag-overlay-wrapper>\n    </div>',_c=function(e){function t(){return e.call(this,Cc)||this}return xc(t,e),t.prototype.init=function(){var e=this,t=function(e,t){var o=e+"px";t.style.minHeight=o,t.style.height=o},o={setRowAnimationCssOnBodyViewport:function(t,o){return e.setRowAnimationCssOnBodyViewport(t,o)},setColumnCount:function(t){return lo(e.getGui(),t)},setRowCount:function(t){return ao(e.getGui(),t)},setTopHeight:function(o){return t(o,e.eTop)},setBottomHeight:function(o){return t(o,e.eBottom)},setTopDisplay:function(t){return e.eTop.style.display=t},setBottomDisplay:function(t){return e.eBottom.style.display=t},setStickyTopHeight:function(t){return e.eStickyTop.style.height=t},setStickyTopTop:function(t){return e.eStickyTop.style.top=t},setStickyTopWidth:function(t){return e.eStickyTop.style.width=t},setColumnMovingCss:function(t,o){return e.addOrRemoveCssClass(t,o)},updateLayoutClasses:function(t,o){[e.eBodyViewport.classList,e.eBodyClipper.classList,e.eBody.classList].forEach((function(e){e.toggle(Ns.AUTO_HEIGHT,o.autoHeight),e.toggle(Ns.NORMAL,o.normal),e.toggle(Ns.PRINT,o.print)})),e.addOrRemoveCssClass(Ns.AUTO_HEIGHT,o.autoHeight),e.addOrRemoveCssClass(Ns.NORMAL,o.normal),e.addOrRemoveCssClass(Ns.PRINT,o.print)},setAlwaysVerticalScrollClass:function(t,o){return e.eBodyViewport.classList.toggle(ul,o)},registerBodyViewportResizeListener:function(t){var o=e.resizeObserverService.observeResize(e.eBodyViewport,t);e.addDestroyFunc((function(){return o()}))},setPinnedTopBottomOverflowY:function(t){return e.eTop.style.overflowY=e.eBottom.style.overflowY=t},setCellSelectableCss:function(t,o){[e.eTop,e.eBodyViewport,e.eBottom].forEach((function(e){return e.classList.toggle(dl,o)}))},setBodyViewportWidth:function(t){return e.eBodyViewport.style.width=t}};this.ctrl=this.createManagedBean(new pl),this.ctrl.setComp(o,this.getGui(),this.eBodyViewport,this.eTop,this.eBottom,this.eStickyTop),(this.rangeService||"multiple"===this.gridOptionsService.get("rowSelection"))&&io(this.getGui(),!0)},t.prototype.setRowAnimationCssOnBodyViewport=function(e,t){var o=this.eBodyViewport.classList;o.toggle(qs.ANIMATION_ON,t),o.toggle(qs.ANIMATION_OFF,!t)},t.prototype.getFloatingTopBottom=function(){return[this.eTop,this.eBottom]},wc([q("resizeObserverService")],t.prototype,"resizeObserverService",void 0),wc([K("rangeService")],t.prototype,"rangeService",void 0),wc([mr("eBodyViewport")],t.prototype,"eBodyViewport",void 0),wc([mr("eStickyTop")],t.prototype,"eStickyTop",void 0),wc([mr("eTop")],t.prototype,"eTop",void 0),wc([mr("eBottom")],t.prototype,"eBottom",void 0),wc([mr("gridHeader")],t.prototype,"headerRootComp",void 0),wc([mr("eBodyClipper")],t.prototype,"eBodyClipper",void 0),wc([mr("eBody")],t.prototype,"eBody",void 0),wc([$],t.prototype,"init",null),t}(fr),Sc=function(){var e=function(t,o){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])},e(t,o)};return function(t,o){function n(){this.constructor=t}e(t,o),t.prototype=null===o?Object.create(o):(n.prototype=o.prototype,new n)}}(),Ec=function(e,t,o,n){var r,i=arguments.length,a=i<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,o):n;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)a=Reflect.decorate(e,t,o,n);else for(var s=e.length-1;s>=0;s--)(r=e[s])&&(a=(i<3?r(a):i>3?r(t,o,a):r(t,o))||a);return i>3&&a&&Object.defineProperty(t,o,a),a},kc=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Sc(t,e),t.prototype.postConstruct=function(){this.addManagedListener(this.eventService,$e.EVENT_DISPLAYED_COLUMNS_CHANGED,this.onDisplayedColumnsChanged.bind(this)),this.addManagedListener(this.eventService,$e.EVENT_DISPLAYED_COLUMNS_WIDTH_CHANGED,this.onDisplayedColumnsWidthChanged.bind(this))},t.prototype.onDisplayedColumnsChanged=function(){this.update()},t.prototype.onDisplayedColumnsWidthChanged=function(){this.update()},t.prototype.update=function(){this.updateImpl(),setTimeout(this.updateImpl.bind(this),500)},t.prototype.updateImpl=function(){var e=this.ctrlsService.getCenterRowContainerCtrl();if(e){var t={horizontalScrollShowing:e.isHorizontalScrollShowing(),verticalScrollShowing:this.isVerticalScrollShowing()};this.setScrollsVisible(t)}},t.prototype.setScrollsVisible=function(e){if(this.horizontalScrollShowing!==e.horizontalScrollShowing||this.verticalScrollShowing!==e.verticalScrollShowing){this.horizontalScrollShowing=e.horizontalScrollShowing,this.verticalScrollShowing=e.verticalScrollShowing;var t={type:$e.EVENT_SCROLL_VISIBILITY_CHANGED};this.eventService.dispatchEvent(t)}},t.prototype.isHorizontalScrollShowing=function(){return this.horizontalScrollShowing},t.prototype.isVerticalScrollShowing=function(){return this.verticalScrollShowing},Ec([q("ctrlsService")],t.prototype,"ctrlsService",void 0),Ec([$],t.prototype,"postConstruct",null),t=Ec([W("scrollVisibleService")],t)}(Fe),jc=function(){var e=function(t,o){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])},e(t,o)};return function(t,o){function n(){this.constructor=t}e(t,o),t.prototype=null===o?Object.create(o):(n.prototype=o.prototype,new n)}}(),Ac=function(e,t,o,n){var r,i=arguments.length,a=i<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,o):n;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)a=Reflect.decorate(e,t,o,n);else for(var s=e.length-1;s>=0;s--)(r=e[s])&&(a=(i<3?r(a):i>3?r(t,o,a):r(t,o))||a);return i>3&&a&&Object.defineProperty(t,o,a),a},Rc=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.gridInstanceId=o.gridInstanceSequence.next(),t}var o;return jc(t,e),o=t,t.prototype.stampTopLevelGridCompWithGridInstance=function(e){e[o.GRID_DOM_KEY]=this.gridInstanceId},t.prototype.getRenderedCellForEvent=function(e){return Te(this.gridOptionsService,e.target,Nl.DOM_DATA_KEY_CELL_CTRL)},t.prototype.isEventFromThisGrid=function(e){return this.isElementInThisGrid(e.target)},t.prototype.isElementInThisGrid=function(e){for(var t=e;t;){var n=t[o.GRID_DOM_KEY];if(r(n))return n===this.gridInstanceId;t=t.parentElement}return!1},t.prototype.getCellPositionForEvent=function(e){var t=this.getRenderedCellForEvent(e);return t?t.getCellPosition():null},t.prototype.getNormalisedPosition=function(e){var t,o,n=this.gridOptionsService.isDomLayout("normal"),r=e;if(null!=r.clientX||null!=r.clientY?(t=r.clientX,o=r.clientY):(t=r.x,o=r.y),n){var i=this.ctrlsService.getGridBodyCtrl(),a=i.getScrollFeature().getVScrollPosition();t+=i.getScrollFeature().getHScrollPosition().left,o+=a.top}return{x:t,y:o}},t.gridInstanceSequence=new or,t.GRID_DOM_KEY="__ag_grid_instance",Ac([q("ctrlsService")],t.prototype,"ctrlsService",void 0),t=o=Ac([W("mouseEventService")],t)}(Fe),Oc=function(){var e=function(t,o){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])},e(t,o)};return function(t,o){function n(){this.constructor=t}e(t,o),t.prototype=null===o?Object.create(o):(n.prototype=o.prototype,new n)}}(),Tc=function(){return Tc=Object.assign||function(e){for(var t,o=1,n=arguments.length;o<n;o++)for(var r in t=arguments[o])Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e},Tc.apply(this,arguments)},Dc=function(e,t,o,n){var r,i=arguments.length,a=i<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,o):n;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)a=Reflect.decorate(e,t,o,n);else for(var s=e.length-1;s>=0;s--)(r=e[s])&&(a=(i<3?r(a):i>3?r(t,o,a):r(t,o))||a);return i>3&&a&&Object.defineProperty(t,o,a),a},Pc=function(e){function t(){var t=e.call(this)||this;return t.onPageDown=M(t.onPageDown,100),t.onPageUp=M(t.onPageUp,100),t}return Oc(t,e),t.prototype.postConstruct=function(){var e=this;this.ctrlsService.whenReady((function(t){e.gridBodyCon=t.gridBodyCtrl}))},t.prototype.handlePageScrollingKey=function(e){var t=e.key,o=e.altKey,n=e.ctrlKey||e.metaKey,r=!!this.rangeService&&e.shiftKey,i=this.mouseEventService.getCellPositionForEvent(e),a=!1;switch(t){case Hn.PAGE_HOME:case Hn.PAGE_END:n||o||(this.onHomeOrEndKey(t),a=!0);break;case Hn.LEFT:case Hn.RIGHT:case Hn.UP:case Hn.DOWN:if(!i)return!1;!n||o||r||(this.onCtrlUpDownLeftRight(t,i),a=!0);break;case Hn.PAGE_DOWN:if(!i)return!1;n||o||(this.onPageDown(i),a=!0);break;case Hn.PAGE_UP:if(!i)return!1;n||o||(this.onPageUp(i),a=!0)}return a&&e.preventDefault(),a},t.prototype.navigateTo=function(e){var t=e.scrollIndex,o=e.scrollType,n=e.scrollColumn,i=e.focusIndex,a=e.focusColumn;if(r(n)&&!n.isPinned()&&this.gridBodyCon.getScrollFeature().ensureColumnVisible(n),r(t)&&this.gridBodyCon.getScrollFeature().ensureIndexVisible(t,o),e.isAsync||this.gridBodyCon.getScrollFeature().ensureIndexVisible(i),this.focusService.setFocusedCell({rowIndex:i,column:a,rowPinned:null,forceBrowserFocus:!0}),this.rangeService){var s={rowIndex:i,rowPinned:null,column:a};this.rangeService.setRangeToCell(s)}},t.prototype.onPageDown=function(e){var t=this.ctrlsService.getGridBodyCtrl().getScrollFeature().getVScrollPosition(),o=this.getViewportHeight(),n=this.paginationProxy.getPixelOffset(),r=t.top+o,i=this.paginationProxy.getRowIndexAtPixel(r+n);this.columnModel.isAutoRowHeightActive()?this.navigateToNextPageWithAutoHeight(e,i):this.navigateToNextPage(e,i)},t.prototype.onPageUp=function(e){var t=this.ctrlsService.getGridBodyCtrl().getScrollFeature().getVScrollPosition(),o=this.paginationProxy.getPixelOffset(),n=t.top,r=this.paginationProxy.getRowIndexAtPixel(n+o);this.columnModel.isAutoRowHeightActive()?this.navigateToNextPageWithAutoHeight(e,r,!0):this.navigateToNextPage(e,r,!0)},t.prototype.navigateToNextPage=function(e,t,o){void 0===o&&(o=!1);var n,r=this.getViewportHeight(),i=this.paginationProxy.getPageFirstRow(),a=this.paginationProxy.getPageLastRow(),s=this.paginationProxy.getPixelOffset(),l=this.paginationProxy.getRow(e.rowIndex),c=o?(null===l||void 0===l?void 0:l.rowHeight)-r-s:r-s,d=(null===l||void 0===l?void 0:l.rowTop)+c,u=this.paginationProxy.getRowIndexAtPixel(d+s);if(u===e.rowIndex){var p=o?-1:1;t=u=e.rowIndex+p}o?(n="bottom",u<i&&(u=i),t<i&&(t=i)):(n="top",u>a&&(u=a),t>a&&(t=a)),this.isRowTallerThanView(u)&&(t=u,n="top"),this.navigateTo({scrollIndex:t,scrollType:n,scrollColumn:null,focusIndex:u,focusColumn:e.column})},t.prototype.navigateToNextPageWithAutoHeight=function(e,t,o){var n=this;void 0===o&&(o=!1),this.navigateTo({scrollIndex:t,scrollType:o?"bottom":"top",scrollColumn:null,focusIndex:t,focusColumn:e.column}),setTimeout((function(){var r=n.getNextFocusIndexForAutoHeight(e,o);n.navigateTo({scrollIndex:t,scrollType:o?"bottom":"top",scrollColumn:null,focusIndex:r,focusColumn:e.column,isAsync:!0})}),50)},t.prototype.getNextFocusIndexForAutoHeight=function(e,t){var o;void 0===t&&(t=!1);for(var n=t?-1:1,r=this.getViewportHeight(),i=this.paginationProxy.getPageLastRow(),a=0,s=e.rowIndex;s>=0&&s<=i;){var l=this.paginationProxy.getRow(s);if(l){var c=null!==(o=l.rowHeight)&&void 0!==o?o:0;if(a+c>r)break;a+=c}s+=n}return Math.max(0,Math.min(s,i))},t.prototype.getViewportHeight=function(){var e=this.ctrlsService.getGridBodyCtrl().getScrollFeature().getVScrollPosition(),t=this.gridOptionsService.getScrollbarWidth(),o=e.bottom-e.top;return this.ctrlsService.getCenterRowContainerCtrl().isHorizontalScrollShowing()&&(o-=t),o},t.prototype.isRowTallerThanView=function(e){var t=this.paginationProxy.getRow(e);if(!t)return!1;var o=t.rowHeight;return"number"===typeof o&&o>this.getViewportHeight()},t.prototype.onCtrlUpDownLeftRight=function(e,t){var o=this.cellNavigationService.getNextCellToFocus(e,t,!0),n=o.rowIndex,r=o.column;this.navigateTo({scrollIndex:n,scrollType:null,scrollColumn:r,focusIndex:n,focusColumn:r})},t.prototype.onHomeOrEndKey=function(e){var t=e===Hn.PAGE_HOME,o=this.columnModel.getAllDisplayedColumns(),n=t?o[0]:fe(o),r=t?this.paginationProxy.getPageFirstRow():this.paginationProxy.getPageLastRow();this.navigateTo({scrollIndex:r,scrollType:null,scrollColumn:n,focusIndex:r,focusColumn:n})},t.prototype.onTabKeyDown=function(e,t){var o=t.shiftKey;if(this.tabToNextCellCommon(e,o,t))t.preventDefault();else if(o){var n=e.getRowPosition(),r=n.rowIndex;(n.rowPinned?0===r:r===this.paginationProxy.getPageFirstRow())&&(0===this.gridOptionsService.getNum("headerHeight")?this.focusService.focusNextGridCoreContainer(!0,!0):(t.preventDefault(),this.focusService.focusLastHeader(t)))}else e instanceof Nl&&e.focusCell(!0),this.focusService.focusNextGridCoreContainer(o)&&t.preventDefault()},t.prototype.tabToNextCell=function(e,t){var o=this.focusService.getFocusedCell();if(!o)return!1;var n=this.getCellByPosition(o);return!!(n||(n=this.rowRenderer.getRowByPosition(o))&&n.isFullWidth())&&this.tabToNextCellCommon(n,e,t)},t.prototype.tabToNextCellCommon=function(e,t,o){var n=e.isEditing();if(!n&&e instanceof Nl){var r=e.getRowCtrl();r&&(n=r.isEditing())}return(n?"fullRow"===this.gridOptionsService.get("editType")?this.moveToNextEditingRow(e,t,o):this.moveToNextEditingCell(e,t,o):this.moveToNextCellNotEditing(e,t))||!!this.focusService.getFocusedHeader()},t.prototype.moveToNextEditingCell=function(e,t,o){void 0===o&&(o=null);var n=e.getCellPosition();e.getGui().focus(),e.stopEditing();var r=this.findNextCellToFocusOn(n,t,!0);return null!=r&&(r.startEditing(null,null,!0,o),r.focusCell(!1),!0)},t.prototype.moveToNextEditingRow=function(e,t,o){void 0===o&&(o=null);var n=e.getCellPosition(),r=this.findNextCellToFocusOn(n,t,!0);if(null==r)return!1;var i=r.getCellPosition(),a=this.isCellEditable(n),s=this.isCellEditable(i),l=i&&n.rowIndex===i.rowIndex&&n.rowPinned===i.rowPinned;(a&&e.setFocusOutOnEditor(),l)||(e.getRowCtrl().stopEditing(),r.getRowCtrl().startRowEditing(void 0,void 0,void 0,o));return s?(r.setFocusInOnEditor(),r.focusCell()):r.focusCell(!0),!0},t.prototype.moveToNextCellNotEditing=function(e,t){var o,n=this.columnModel.getAllDisplayedColumns();o=e instanceof Bl?Tc(Tc({},e.getRowPosition()),{column:t?n[0]:fe(n)}):e.getCellPosition();var i=this.findNextCellToFocusOn(o,t,!1);if(i instanceof Nl)i.focusCell(!0);else if(i)return this.tryToFocusFullWidthRow(i.getRowPosition(),t);return r(i)},t.prototype.findNextCellToFocusOn=function(e,t,o){for(var n=e;;){e!==n&&(e=n),t||(n=this.getLastCellOfColSpan(n)),n=this.cellNavigationService.getNextTabbedCell(n,t);var i=this.gridOptionsService.getCallback("tabToNextCell");if(r(i)){var a=i({backwards:t,editing:o,previousCellPosition:e,nextCellPosition:n||null});r(a)?(a.floating&&(j((function(){console.warn("AG Grid: tabToNextCellFunc return type should have attributes: rowIndex, rowPinned, column. However you had 'floating', maybe you meant 'rowPinned'?")}),"no floating in userCell"),a.rowPinned=a.floating),n={rowIndex:a.rowIndex,column:a.column,rowPinned:a.rowPinned}):n=null}if(!n)return null;if(n.rowIndex<0){var s=this.headerNavigationService.getHeaderRowCount();return this.focusService.focusHeaderPosition({headerPosition:{headerRowIndex:s+n.rowIndex,column:n.column}}),null}var l="fullRow"===this.gridOptionsService.get("editType");if(o&&!l)if(!this.isCellEditable(n))continue;this.ensureCellVisible(n);var c=this.getCellByPosition(n);if(!c){var d=this.rowRenderer.getRowByPosition(n);if(!d||!d.isFullWidth()||o)continue;return d}if(!c.isSuppressNavigable())return this.rangeService&&this.rangeService.setRangeToCell(n),c}},t.prototype.isCellEditable=function(e){var t=this.lookupRowNodeForCell(e);return!!t&&e.column.isCellEditable(t)},t.prototype.getCellByPosition=function(e){var t=this.rowRenderer.getRowByPosition(e);return t?t.getCellCtrl(e.column):null},t.prototype.lookupRowNodeForCell=function(e){return"top"===e.rowPinned?this.pinnedRowModel.getPinnedTopRow(e.rowIndex):"bottom"===e.rowPinned?this.pinnedRowModel.getPinnedBottomRow(e.rowIndex):this.paginationProxy.getRow(e.rowIndex)},t.prototype.navigateToNextCell=function(e,t,o,n){for(var a=o,s=!1;a&&(a===o||!this.isValidNavigateCell(a));)this.gridOptionsService.is("enableRtl")?t===Hn.LEFT&&(a=this.getLastCellOfColSpan(a)):t===Hn.RIGHT&&(a=this.getLastCellOfColSpan(a)),s=i(a=this.cellNavigationService.getNextCellToFocus(t,a));if(s&&e&&e.key===Hn.UP&&(a={rowIndex:-1,rowPinned:null,column:o.column}),n){var l=this.gridOptionsService.getCallback("navigateToNextCell");if(r(l)){var c=l({key:t,previousCellPosition:o,nextCellPosition:a||null,event:e});r(c)?(c.floating&&(j((function(){console.warn("AG Grid: tabToNextCellFunc return type should have attributes: rowIndex, rowPinned, column. However you had 'floating', maybe you meant 'rowPinned'?")}),"no floating in userCell"),c.rowPinned=c.floating),a={rowPinned:c.rowPinned,rowIndex:c.rowIndex,column:c.column}):a=null}}if(a)if(a.rowIndex<0){var d=this.headerNavigationService.getHeaderRowCount();this.focusService.focusHeaderPosition({headerPosition:{headerRowIndex:d+a.rowIndex,column:o.column},event:e||void 0})}else{var u=this.getNormalisedPosition(a);u?this.focusPosition(u):this.tryToFocusFullWidthRow(a)}},t.prototype.getNormalisedPosition=function(e){this.ensureCellVisible(e);var t=this.getCellByPosition(e);return t?(e=t.getCellPosition(),this.ensureCellVisible(e),e):null},t.prototype.tryToFocusFullWidthRow=function(e,t){void 0===t&&(t=!1);var o=this.columnModel.getAllDisplayedColumns(),n=this.rowRenderer.getRowByPosition(e);if(!n||!n.isFullWidth())return!1;var r=this.focusService.getFocusedCell(),i={rowIndex:e.rowIndex,rowPinned:e.rowPinned,column:e.column||(t?fe(o):o[0])};this.focusPosition(i);var a=null!=r&&this.rowPositionUtils.before(i,r),s={type:$e.EVENT_FULL_WIDTH_ROW_FOCUSED,rowIndex:i.rowIndex,rowPinned:i.rowPinned,column:i.column,isFullWidthCell:!0,floating:i.rowPinned,fromBelow:a};return this.eventService.dispatchEvent(s),!0},t.prototype.focusPosition=function(e){this.focusService.setFocusedCell({rowIndex:e.rowIndex,column:e.column,rowPinned:e.rowPinned,forceBrowserFocus:!0}),this.rangeService&&this.rangeService.setRangeToCell(e)},t.prototype.isValidNavigateCell=function(e){return!!this.rowPositionUtils.getRowNode(e)},t.prototype.getLastCellOfColSpan=function(e){var t=this.getCellByPosition(e);if(!t)return e;var o=t.getColSpanningList();return 1===o.length?e:{rowIndex:e.rowIndex,column:fe(o),rowPinned:e.rowPinned}},t.prototype.ensureCellVisible=function(e){var t=this.gridOptionsService.is("groupRowsSticky"),o=this.rowModel.getRow(e.rowIndex);!(t&&(null===o||void 0===o?void 0:o.sticky))&&i(e.rowPinned)&&this.gridBodyCon.getScrollFeature().ensureIndexVisible(e.rowIndex),e.column.isPinned()||this.gridBodyCon.getScrollFeature().ensureColumnVisible(e.column)},Dc([q("mouseEventService")],t.prototype,"mouseEventService",void 0),Dc([q("paginationProxy")],t.prototype,"paginationProxy",void 0),Dc([q("focusService")],t.prototype,"focusService",void 0),Dc([K("rangeService")],t.prototype,"rangeService",void 0),Dc([q("columnModel")],t.prototype,"columnModel",void 0),Dc([q("rowModel")],t.prototype,"rowModel",void 0),Dc([q("ctrlsService")],t.prototype,"ctrlsService",void 0),Dc([q("rowRenderer")],t.prototype,"rowRenderer",void 0),Dc([q("headerNavigationService")],t.prototype,"headerNavigationService",void 0),Dc([q("rowPositionUtils")],t.prototype,"rowPositionUtils",void 0),Dc([q("cellNavigationService")],t.prototype,"cellNavigationService",void 0),Dc([q("pinnedRowModel")],t.prototype,"pinnedRowModel",void 0),Dc([$],t.prototype,"postConstruct",null),t=Dc([W("navigationService")],t)}(Fe),Nc=function(){var e=function(t,o){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])},e(t,o)};return function(t,o){function n(){this.constructor=t}e(t,o),t.prototype=null===o?Object.create(o):(n.prototype=o.prototype,new n)}}(),Ic=function(e,t,o,n){var r,i=arguments.length,a=i<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,o):n;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)a=Reflect.decorate(e,t,o,n);else for(var s=e.length-1;s>=0;s--)(r=e[s])&&(a=(i<3?r(a):i>3?r(t,o,a):r(t,o))||a);return i>3&&a&&Object.defineProperty(t,o,a),a},Mc=function(e){function t(t){var o=e.call(this,'<div class="ag-popup-editor" tabindex="-1"/>')||this;return o.params=t,o}return Nc(t,e),t.prototype.postConstruct=function(){this.gridOptionsService.setDomData(this.getGui(),t.DOM_KEY_POPUP_EDITOR_WRAPPER,!0),this.addKeyDownListener()},t.prototype.addKeyDownListener=function(){var e=this,t=this.getGui(),o=this.params;this.addManagedListener(t,"keydown",(function(t){Vn(e.gridOptionsService,t,o.node,o.column,!0)||o.onKeyDown(t)}))},t.DOM_KEY_POPUP_EDITOR_WRAPPER="popupEditorWrapper",Ic([$],t.prototype,"postConstruct",null),t}(aa),Lc=function(){var e=function(t,o){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])},e(t,o)};return function(t,o){function n(){this.constructor=t}e(t,o),t.prototype=null===o?Object.create(o):(n.prototype=o.prototype,new n)}}(),Fc=function(e){function t(t,o,n,r,i){var a=e.call(this)||this;a.rendererVersion=0,a.editorVersion=0,a.beans=t,a.column=o.getColumn(),a.rowNode=o.getRowNode(),a.rowCtrl=o.getRowCtrl(),a.eRow=r,a.setTemplate('<div comp-id="'+a.getCompId()+'"/>');var s=a.getGui();a.forceWrapper=o.isForceWrapper(),a.refreshWrapper(!1);var l=function(e,t,o){var n=o||s;null!=t&&""!=t?n.setAttribute(e,t):n.removeAttribute(e)},c={addOrRemoveCssClass:function(e,t){return a.addOrRemoveCssClass(e,t)},setUserStyles:function(e){return Sn(s,e)},getFocusableElement:function(){return a.getFocusableElement()},setTabIndex:function(e){return l("tabindex",e.toString())},setRole:function(e){return $t(s,e)},setColId:function(e){return l("col-id",e)},setTitle:function(e){return l("title",e)},setIncludeSelection:function(e){return a.includeSelection=e},setIncludeRowDrag:function(e){return a.includeRowDrag=e},setIncludeDndSource:function(e){return a.includeDndSource=e},setRenderDetails:function(e,t,o){return a.setRenderDetails(e,t,o)},setEditDetails:function(e,t,o){return a.setEditDetails(e,t,o)},getCellEditor:function(){return a.cellEditor||null},getCellRenderer:function(){return a.cellRenderer||null},getParentOfValue:function(){return a.getParentOfValue()}};return a.cellCtrl=o,o.setComp(c,a.getGui(),a.eCellWrapper,n,i),a}return Lc(t,e),t.prototype.getParentOfValue=function(){return this.eCellValue?this.eCellValue:this.eCellWrapper?this.eCellWrapper:this.getGui()},t.prototype.setRenderDetails=function(e,t,o){if(!(this.cellEditor&&!this.cellEditorPopupWrapper)){this.firstRender=null==this.firstRender;var n=this.refreshWrapper(!1);if(this.refreshEditStyles(!1),e)!(o||n)&&this.refreshCellRenderer(e)||(this.destroyRenderer(),this.createCellRendererInstance(e));else this.destroyRenderer(),this.insertValueWithoutCellRenderer(t)}},t.prototype.setEditDetails=function(e,t,o){e?this.createCellEditorInstance(e,t,o):this.destroyEditor()},t.prototype.removeControls=function(){this.checkboxSelectionComp=this.beans.context.destroyBean(this.checkboxSelectionComp),this.dndSourceComp=this.beans.context.destroyBean(this.dndSourceComp),this.rowDraggingComp=this.beans.context.destroyBean(this.rowDraggingComp)},t.prototype.refreshWrapper=function(e){var t=this.includeRowDrag||this.includeDndSource||this.includeSelection,o=t||this.forceWrapper,n=o&&null==this.eCellWrapper;n&&(this.eCellWrapper=vn('<div class="ag-cell-wrapper" role="presentation"></div>'),this.getGui().appendChild(this.eCellWrapper));var r=!o&&null!=this.eCellWrapper;r&&(mn(this.eCellWrapper),this.eCellWrapper=void 0),this.addOrRemoveCssClass("ag-cell-value",!o);var i=!e&&o,a=i&&null==this.eCellValue;a&&(this.eCellValue=vn('<span class="ag-cell-value" role="presentation"></span>'),this.eCellWrapper.appendChild(this.eCellValue));var s=!i&&null!=this.eCellValue;s&&(mn(this.eCellValue),this.eCellValue=void 0);var l=n||r||a||s;return l&&this.removeControls(),e||t&&this.addControls(),l},t.prototype.addControls=function(){this.includeRowDrag&&null==this.rowDraggingComp&&(this.rowDraggingComp=this.cellCtrl.createRowDragComp(),this.rowDraggingComp&&this.eCellWrapper.insertBefore(this.rowDraggingComp.getGui(),this.eCellValue)),this.includeDndSource&&null==this.dndSourceComp&&(this.dndSourceComp=this.cellCtrl.createDndSource(),this.eCellWrapper.insertBefore(this.dndSourceComp.getGui(),this.eCellValue)),this.includeSelection&&null==this.checkboxSelectionComp&&(this.checkboxSelectionComp=this.cellCtrl.createSelectionCheckbox(),this.eCellWrapper.insertBefore(this.checkboxSelectionComp.getGui(),this.eCellValue))},t.prototype.createCellEditorInstance=function(e,t,o){var n=this,r=this.editorVersion,a=e.newAgStackInstance();if(a){var s=e.params;a.then((function(e){return n.afterCellEditorCreated(r,e,s,t,o)})),i(this.cellEditor)&&s.cellStartedEdit&&this.cellCtrl.focusCell(!0)}},t.prototype.insertValueWithoutCellRenderer=function(e){var t=this.getParentOfValue();gn(t);var o=null!=e?vt(e):null;null!=o&&(t.innerHTML=o)},t.prototype.destroyEditorAndRenderer=function(){this.destroyRenderer(),this.destroyEditor()},t.prototype.destroyRenderer=function(){var e=this.beans.context;this.cellRenderer=e.destroyBean(this.cellRenderer),mn(this.cellRendererGui),this.cellRendererGui=null,this.rendererVersion++},t.prototype.destroyEditor=function(){var e=this.beans.context;this.hideEditorPopup&&this.hideEditorPopup(),this.hideEditorPopup=void 0,this.cellEditor=e.destroyBean(this.cellEditor),this.cellEditorPopupWrapper=e.destroyBean(this.cellEditorPopupWrapper),mn(this.cellEditorGui),this.cellEditorGui=null,this.editorVersion++},t.prototype.refreshCellRenderer=function(e){if(null==this.cellRenderer||null==this.cellRenderer.refresh)return!1;if(this.cellRendererClass!==e.componentClass)return!1;var t=this.cellRenderer.refresh(e.params);return!0===t||void 0===t},t.prototype.createCellRendererInstance=function(e){var t=this,o=!this.beans.gridOptionsService.is("suppressAnimationFrame"),n=this.rendererVersion,r=e.componentClass,i=function(){if(!(t.rendererVersion!==n||!t.isAlive())){var o=e.newAgStackInstance(),i=t.afterCellRendererCreated.bind(t,n,r);o&&o.then(i)}};o&&this.firstRender?this.beans.animationFrameService.createTask(i,this.rowNode.rowIndex,"createTasksP2"):i()},t.prototype.getCtrl=function(){return this.cellCtrl},t.prototype.getRowCtrl=function(){return this.rowCtrl},t.prototype.getCellRenderer=function(){return this.cellRenderer},t.prototype.getCellEditor=function(){return this.cellEditor},t.prototype.afterCellRendererCreated=function(e,t,o){if(!this.isAlive()||e!==this.rendererVersion)this.beans.context.destroyBean(o);else if(this.cellRenderer=o,this.cellRendererClass=t,this.cellRendererGui=this.cellRenderer.getGui(),null!=this.cellRendererGui){var n=this.getParentOfValue();gn(n),n.appendChild(this.cellRendererGui)}},t.prototype.afterCellEditorCreated=function(e,t,o,n,r){if(e!==this.editorVersion)this.beans.context.destroyBean(t);else{if(t.isCancelBeforeStart&&t.isCancelBeforeStart())return this.beans.context.destroyBean(t),void this.cellCtrl.stopEditing(!0);if(!t.getGui)return console.warn("AG Grid: cellEditor for column "+this.column.getId()+" is missing getGui() method"),void this.beans.context.destroyBean(t);this.cellEditor=t,this.cellEditorGui=t.getGui();var i=n||void 0!==t.isPopup&&t.isPopup();i?this.addPopupCellEditor(o,r):this.addInCellEditor(),this.refreshEditStyles(!0,i),t.afterGuiAttached&&t.afterGuiAttached()}},t.prototype.refreshEditStyles=function(e,t){var o;this.addOrRemoveCssClass("ag-cell-inline-editing",e&&!t),this.addOrRemoveCssClass("ag-cell-popup-editing",e&&!!t),this.addOrRemoveCssClass("ag-cell-not-inline-editing",!e||!!t),null===(o=this.rowCtrl)||void 0===o||o.setInlineEditingCss(e)},t.prototype.addInCellEditor=function(){var e=this.getGui(),t=this.beans.gridOptionsService.getDocument();(e.contains(t.activeElement)&&e.focus(),this.destroyRenderer(),this.refreshWrapper(!0),this.clearParentOfValue(),this.cellEditorGui)&&this.getParentOfValue().appendChild(this.cellEditorGui)},t.prototype.addPopupCellEditor=function(e,t){var o=this;"fullRow"===this.beans.gridOptionsService.get("editType")&&console.warn("AG Grid: popup cellEditor does not work with fullRowEdit - you cannot use them both - either turn off fullRowEdit, or stop using popup editors.");var n=this.cellEditor;this.cellEditorPopupWrapper=this.beans.context.createBean(new Mc(e));var r=this.cellEditorPopupWrapper.getGui();this.cellEditorGui&&r.appendChild(this.cellEditorGui);var i=this.beans.popupService,a=this.beans.gridOptionsService.is("stopEditingWhenCellsLoseFocus"),s=null!=t?t:n.getPopupPosition?n.getPopupPosition():"over",l=this.beans.gridOptionsService.is("enableRtl"),c={ePopup:r,column:this.column,rowNode:this.rowNode,type:"popupCellEditor",eventSource:this.getGui(),position:s,alignSide:l?"right":"left",keepWithinBounds:!0},d=i.positionPopupByComponent.bind(i,c),u=this.beans.localeService.getLocaleTextFunc(),p=i.addPopup({modal:a,eChild:r,closeOnEsc:!0,closedCallback:function(){o.cellCtrl.onPopupEditorClosed()},anchorToElement:this.getGui(),positionCallback:d,ariaLabel:u("ariaLabelCellEditor","Cell Editor")});p&&(this.hideEditorPopup=p.hideFunc)},t.prototype.detach=function(){this.eRow.removeChild(this.getGui())},t.prototype.destroy=function(){this.cellCtrl.stopEditing(),this.destroyEditorAndRenderer(),this.removeControls(),e.prototype.destroy.call(this)},t.prototype.clearParentOfValue=function(){var e=this.getGui(),t=this.beans.gridOptionsService.getDocument();e.contains(t.activeElement)&&To()&&e.focus({preventScroll:!0}),gn(this.getParentOfValue())},t}(fr),Gc=function(){var e=function(t,o){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])},e(t,o)};return function(t,o){function n(){this.constructor=t}e(t,o),t.prototype=null===o?Object.create(o):(n.prototype=o.prototype,new n)}}(),zc=function(e){function t(t,o,n){var r=e.call(this)||this;r.cellComps={},r.beans=o,r.rowCtrl=t,r.setTemplate('<div comp-id="'+r.getCompId()+'" style="'+r.getInitialStyle(n)+'"/>');var i=r.getGui(),a=i.style,s={setDomOrder:function(e){return r.domOrder=e},setCellCtrls:function(e){return r.setCellCtrls(e)},showFullWidth:function(e){return r.showFullWidth(e)},getFullWidthCellRenderer:function(){return r.getFullWidthCellRenderer()},addOrRemoveCssClass:function(e,t){return r.addOrRemoveCssClass(e,t)},setUserStyles:function(e){return Sn(i,e)},setTop:function(e){return a.top=e},setTransform:function(e){return a.transform=e},setRowIndex:function(e){return i.setAttribute("row-index",e)},setRole:function(e){return $t(i,e)},setRowId:function(e){return i.setAttribute("row-id",e)},setRowBusinessKey:function(e){return i.setAttribute("row-business-key",e)},setTabIndex:function(e){return i.setAttribute("tabindex",e.toString())}};return t.setComp(s,r.getGui(),n),r.addDestroyFunc((function(){t.unsetComp(n)})),r}return Gc(t,e),t.prototype.getInitialStyle=function(e){var t=this.rowCtrl.getInitialTransform(e),o=this.rowCtrl.getInitialRowTop(e);return t?"transform: "+t:"top: "+o},t.prototype.showFullWidth=function(e){var t=this,o=e.newAgStackInstance();o&&o.then((function(e){if(t.isAlive()){var o=e.getGui();t.getGui().appendChild(o),t.rowCtrl.setupDetailRowAutoHeight(o),t.setFullWidthRowComp(e)}else t.beans.context.destroyBean(e)}))},t.prototype.setCellCtrls=function(e){var t=this,o=Object.assign({},this.cellComps);e.forEach((function(e){var n=e.getInstanceId();null==t.cellComps[n]?t.newCellComp(e):o[n]=null}));var n=x(o).filter((function(e){return null!=e}));this.destroyCells(n),this.ensureDomOrder(e)},t.prototype.ensureDomOrder=function(e){var t=this;if(this.domOrder){var o=[];e.forEach((function(e){var n=t.cellComps[e.getInstanceId()];n&&o.push(n.getGui())})),Cn(this.getGui(),o)}},t.prototype.newCellComp=function(e){var t=new Fc(this.beans,e,this.rowCtrl.isPrintLayout(),this.getGui(),this.rowCtrl.isEditing());this.cellComps[e.getInstanceId()]=t,this.getGui().appendChild(t.getGui())},t.prototype.destroy=function(){e.prototype.destroy.call(this),this.destroyAllCells()},t.prototype.destroyAllCells=function(){var e=x(this.cellComps).filter((function(e){return null!=e}));this.destroyCells(e)},t.prototype.setFullWidthRowComp=function(e){var t=this;this.fullWidthCellRenderer&&console.error("AG Grid - should not be setting fullWidthRowComponent twice"),this.fullWidthCellRenderer=e,this.addDestroyFunc((function(){t.fullWidthCellRenderer=t.beans.context.destroyBean(t.fullWidthCellRenderer)}))},t.prototype.getFullWidthCellRenderer=function(){return this.fullWidthCellRenderer},t.prototype.destroyCells=function(e){var t=this;e.forEach((function(e){if(e){var o=e.getCtrl().getInstanceId();t.cellComps[o]===e&&(e.detach(),e.destroy(),t.cellComps[o]=null)}}))},t}(fr),Hc=function(){var e=function(t,o){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])},e(t,o)};return function(t,o){function n(){this.constructor=t}e(t,o),t.prototype=null===o?Object.create(o):(n.prototype=o.prototype,new n)}}(),Bc=function(){return Bc=Object.assign||function(e){for(var t,o=1,n=arguments.length;o<n;o++)for(var r in t=arguments[o])Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e},Bc.apply(this,arguments)},Vc=function(e,t,o,n){var r,i=arguments.length,a=i<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,o):n;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)a=Reflect.decorate(e,t,o,n);else for(var s=e.length-1;s>=0;s--)(r=e[s])&&(a=(i<3?r(a):i>3?r(t,o,a):r(t,o))||a);return i>3&&a&&Object.defineProperty(t,o,a),a};var $c,Uc=function(e){function t(){var t=e.call(this,function(){var e=fr.elementGettingCreated.getAttribute("name"),t=bc.getRowContainerCssClasses(e),o=e===Gl.CENTER,n=e===Gl.TOP_CENTER||e===Gl.STICKY_TOP_CENTER||e===Gl.BOTTOM_CENTER;return o?'<div class="'+t.wrapper+'" ref="eWrapper" role="presentation">\n                <div class="'+t.viewport+'" ref="eViewport" role="presentation">\n                    <div class="'+t.container+'" ref="eContainer"></div>\n                </div>\n            </div>':n?'<div class="'+t.viewport+'" ref="eViewport" role="presentation">\n                <div class="'+t.container+'" ref="eContainer"></div>\n            </div>':'<div class="'+t.container+'" ref="eContainer"></div>'}())||this;return t.rowComps={},t.name=fr.elementGettingCreated.getAttribute("name"),t.type=gc(t.name),t}return Hc(t,e),t.prototype.postConstruct=function(){var e=this,t={setViewportHeight:function(t){return e.eViewport.style.height=t},setRowCtrls:function(t){return e.setRowCtrls(t)},setDomOrder:function(t){e.domOrder=t},setContainerWidth:function(t){return e.eContainer.style.width=t}};this.createManagedBean(new bc(this.name)).setComp(t,this.eContainer,this.eViewport,this.eWrapper)},t.prototype.preDestroy=function(){this.setRowCtrls([])},t.prototype.setRowCtrls=function(e){var t=this,o=Bc({},this.rowComps);this.rowComps={},this.lastPlacedElement=null;e.forEach((function(e){var n=e.getInstanceId(),r=o[n];if(r)t.rowComps[n]=r,delete o[n],t.ensureDomOrder(r.getGui());else{var i=new zc(e,t.beans,t.type);t.rowComps[n]=i,t.appendRow(i.getGui())}})),x(o).forEach((function(e){t.eContainer.removeChild(e.getGui()),e.destroy()})),$t(this.eContainer,e.length?"rowgroup":"presentation")},t.prototype.appendRow=function(e){this.domOrder?_n(this.eContainer,e,this.lastPlacedElement):this.eContainer.appendChild(e),this.lastPlacedElement=e},t.prototype.ensureDomOrder=function(e){this.domOrder&&(wn(this.eContainer,e,this.lastPlacedElement),this.lastPlacedElement=e)},Vc([q("beans")],t.prototype,"beans",void 0),Vc([mr("eViewport")],t.prototype,"eViewport",void 0),Vc([mr("eContainer")],t.prototype,"eContainer",void 0),Vc([mr("eWrapper")],t.prototype,"eWrapper",void 0),Vc([$],t.prototype,"postConstruct",null),Vc([U],t.prototype,"preDestroy",null),t}(fr),Wc=function(e,t,o,n){var r,i=arguments.length,a=i<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,o):n;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)a=Reflect.decorate(e,t,o,n);else for(var s=e.length-1;s>=0;s--)(r=e[s])&&(a=(i<3?r(a):i>3?r(t,o,a):r(t,o))||a);return i>3&&a&&Object.defineProperty(t,o,a),a},qc=function(){function e(e){this.columnsToAggregate=[],this.columnsToGroup=[],this.columnsToPivot=[],this.pinned=e}return e.prototype.onDragEnter=function(e){var t=this;if(this.clearColumnsList(),!this.gridOptionsService.is("functionsReadOnly")){var o=e.dragItem.columns;o&&o.forEach((function(e){e.isPrimary()&&(e.isAnyFunctionActive()||(e.isAllowValue()?t.columnsToAggregate.push(e):e.isAllowRowGroup()?t.columnsToGroup.push(e):e.isAllowPivot()&&t.columnsToPivot.push(e)))}))}},e.prototype.getIconName=function(){return this.columnsToAggregate.length+this.columnsToGroup.length+this.columnsToPivot.length>0?this.pinned?Da.ICON_PINNED:Da.ICON_MOVE:null},e.prototype.onDragLeave=function(e){this.clearColumnsList()},e.prototype.clearColumnsList=function(){this.columnsToAggregate.length=0,this.columnsToGroup.length=0,this.columnsToPivot.length=0},e.prototype.onDragging=function(e){},e.prototype.onDragStop=function(e){this.columnsToAggregate.length>0&&this.columnModel.addValueColumns(this.columnsToAggregate,"toolPanelDragAndDrop"),this.columnsToGroup.length>0&&this.columnModel.addRowGroupColumns(this.columnsToGroup,"toolPanelDragAndDrop"),this.columnsToPivot.length>0&&this.columnModel.addPivotColumns(this.columnsToPivot,"toolPanelDragAndDrop")},Wc([q("columnModel")],e.prototype,"columnModel",void 0),Wc([q("gridOptionsService")],e.prototype,"gridOptionsService",void 0),e}(),Kc=function(e,t,o,n){var r,i=arguments.length,a=i<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,o):n;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)a=Reflect.decorate(e,t,o,n);else for(var s=e.length-1;s>=0;s--)(r=e[s])&&(a=(i<3?r(a):i>3?r(t,o,a):r(t,o))||a);return i>3&&a&&Object.defineProperty(t,o,a),a},Yc=function(e,t){var o="function"===typeof Symbol&&e[Symbol.iterator];if(!o)return e;var n,r,i=o.call(e),a=[];try{for(;(void 0===t||t-- >0)&&!(n=i.next()).done;)a.push(n.value)}catch(s){r={error:s}}finally{try{n&&!n.done&&(o=i.return)&&o.call(i)}finally{if(r)throw r.error}}return a},Jc=function(){function e(e,t){this.needToMoveLeft=!1,this.needToMoveRight=!1,this.lastMovedInfo=null,this.pinned=e,this.eContainer=t,this.centerContainer=!r(e)}return e.prototype.init=function(){var e=this;this.ctrlsService.whenReady((function(){e.gridBodyCon=e.ctrlsService.getGridBodyCtrl()}))},e.prototype.getIconName=function(){return this.pinned?Da.ICON_PINNED:Da.ICON_MOVE},e.prototype.onDragEnter=function(e){var t=e.dragItem.columns;if(e.dragSource.type===Di.ToolPanel)this.setColumnsVisible(t,!0,"uiColumnDragged");else{var o=e.dragItem.visibleState,n=(t||[]).filter((function(e){return o[e.getId()]}));this.setColumnsVisible(n,!0,"uiColumnDragged")}this.setColumnsPinned(t,this.pinned,"uiColumnDragged"),this.onDragging(e,!0,!0)},e.prototype.onDragLeave=function(){this.ensureIntervalCleared(),this.lastMovedInfo=null},e.prototype.setColumnsVisible=function(e,t,o){if(void 0===o&&(o="api"),e){var n=e.filter((function(e){return!e.getColDef().lockVisible}));this.columnModel.setColumnsVisible(n,t,o)}},e.prototype.setColumnsPinned=function(e,t,o){if(void 0===o&&(o="api"),e){var n=e.filter((function(e){return!e.getColDef().lockPinned}));this.columnModel.setColumnsPinned(n,t,o)}},e.prototype.onDragStop=function(){this.onDragging(this.lastDraggingEvent,!1,!0,!0),this.ensureIntervalCleared(),this.lastMovedInfo=null},e.prototype.normaliseX=function(e){this.gridOptionsService.is("enableRtl")&&(e=this.eContainer.clientWidth-e);return this.centerContainer&&(e+=this.ctrlsService.getCenterRowContainerCtrl().getCenterViewportScrollLeft()),e},e.prototype.checkCenterForScrolling=function(e){if(this.centerContainer){var t=this.ctrlsService.getCenterRowContainerCtrl().getCenterViewportScrollLeft(),o=t+this.ctrlsService.getCenterRowContainerCtrl().getCenterWidth();this.gridOptionsService.is("enableRtl")?(this.needToMoveRight=e<t+50,this.needToMoveLeft=e>o-50):(this.needToMoveLeft=e<t+50,this.needToMoveRight=e>o-50),this.needToMoveLeft||this.needToMoveRight?this.ensureIntervalStarted():this.ensureIntervalCleared()}},e.prototype.onDragging=function(e,t,o,n){var r,a=this;if(void 0===e&&(e=this.lastDraggingEvent),void 0===t&&(t=!1),void 0===o&&(o=!1),void 0===n&&(n=!1),n){if(this.lastMovedInfo){var s=this.lastMovedInfo,l=s.columns,c=s.toIndex;this.moveColumns(l,c,"uiColumnMoved",!0)}}else if(this.lastDraggingEvent=e,!i(e.hDirection)){var d=this.normaliseX(e.x);t||this.checkCenterForScrolling(d);var u=this.normaliseDirection(e.hDirection),p=e.dragSource.type,h=(null===(r=e.dragSource.getDragItem().columns)||void 0===r?void 0:r.filter((function(e){return!e.getColDef().lockPinned||e.getPinned()==a.pinned})))||[];this.attemptMoveColumns({dragSourceType:p,allMovingColumns:h,hDirection:u,mouseX:d,fromEnter:t,fakeEvent:o})}},e.prototype.normaliseDirection=function(e){if(!this.gridOptionsService.is("enableRtl"))return e;switch(e){case Ni.Left:return Ni.Right;case Ni.Right:return Ni.Left;default:console.error("AG Grid: Unknown direction "+e)}},e.prototype.attemptMoveColumns=function(e){var t=e.dragSourceType,o=e.hDirection,n=e.mouseX,r=e.fromEnter,i=e.fakeEvent,a=o===Ni.Left,s=o===Ni.Right,l=e.allMovingColumns;if(t===Di.HeaderCell){var c=[];l.forEach((function(e){for(var t=null,o=e.getParent();null!=o&&1===o.getDisplayedLeafColumns().length;)t=o,o=o.getParent();null!=t?t.getLeafColumns().forEach((function(e){c.includes(e)||c.push(e)})):c.includes(e)||c.push(e)})),l=c}var d=l.slice();this.columnModel.sortColumnsLikeGridColumns(d);var u=this.calculateValidMoves(d,s,n),p=this.calculateOldIndex(d);if(0!==u.length){var h=u[0],f=null!==p&&!r;if(t==Di.HeaderCell&&(f=null!==p),f&&!i){if(a&&h>=p)return;if(s&&h<=p)return}for(var g=this.columnModel.getAllDisplayedColumns(),m=[],y=null,v=0;v<u.length;v++){var b=u[v],x=this.columnModel.getProposedColumnOrder(d,b);if(this.columnModel.doesOrderPassRules(x)){var w=x.filter((function(e){return g.includes(e)}));if(null===y)y=w;else if(!tr.areEqual(w,y))break;var C=this.groupFragCount(x);m.push({move:b,fragCount:C})}}0!==m.length&&(m.sort((function(e,t){return e.fragCount-t.fragCount})),this.moveColumns(l,m[0].move,"uiColumnMoved",!1))}},e.prototype.calculateOldIndex=function(e){var t=this.columnModel.getAllGridColumns(),o=me(e.map((function(e){return t.indexOf(e)}))),n=o[0];return fe(o)-n!==o.length-1?null:n},e.prototype.moveColumns=function(e,t,o,n){this.columnModel.moveColumns(e,t,o,n),this.lastMovedInfo=n?null:{columns:e,toIndex:t}},e.prototype.groupFragCount=function(e){function t(e){for(var t=[],o=e.getOriginalParent();null!=o;)t.push(o),o=o.getOriginalParent();return t}for(var o=0,n=function(n){var r,i=t(e[n]),a=t(e[n+1]);i=(r=Yc(i.length>a.length?[i,a]:[a,i],2))[0],a=r[1],i.forEach((function(e){-1===a.indexOf(e)&&o++}))},r=0;r<e.length-1;r++)n(r);return o},e.prototype.calculateValidMoves=function(e,t,o){var n=this.gridOptionsService.is("suppressMovableColumns")||e.some((function(e){return e.getColDef().suppressMovable}));if(n)return[];var r,i=this.columnModel.getDisplayedColumns(this.pinned),a=this.columnModel.getAllGridColumns(),s=i.filter((function(t){return we(e,t)})),l=i.filter((function(t){return!we(e,t)})),c=a.filter((function(t){return!we(e,t)})),d=0,u=o;if(t){var p=0;s.forEach((function(e){return p+=e.getActualWidth()})),u-=p}if(u>0){for(var h=0;h<l.length;h++){if((u-=l[h].getActualWidth())<0)break;d++}t&&d++}if(d>0){var f=l[d-1];r=c.indexOf(f)+1}else-1===(r=c.indexOf(l[0]))&&(r=0);var g=[r],m=function(e,t){return e-t};if(t){for(var y=r+1,v=a.length-1;y<=v;)g.push(y),y++;g.sort(m)}else{y=r,v=a.length-1;for(var b=a[y];y<=v&&this.isColumnHidden(i,b);)y++,g.push(y),b=a[y];y=r-1;for(;y>=0;)g.push(y),y--;g.sort(m).reverse()}return g},e.prototype.isColumnHidden=function(e,t){return e.indexOf(t)<0},e.prototype.ensureIntervalStarted=function(){this.movingIntervalId||(this.intervalCount=0,this.failedMoveAttempts=0,this.movingIntervalId=window.setInterval(this.moveInterval.bind(this),100),this.needToMoveLeft?this.dragAndDropService.setGhostIcon(Da.ICON_LEFT,!0):this.dragAndDropService.setGhostIcon(Da.ICON_RIGHT,!0))},e.prototype.ensureIntervalCleared=function(){this.movingIntervalId&&(window.clearInterval(this.movingIntervalId),this.movingIntervalId=null,this.dragAndDropService.setGhostIcon(Da.ICON_MOVE))},e.prototype.moveInterval=function(){var e;this.intervalCount++,(e=10+5*this.intervalCount)>100&&(e=100);var t=null,o=this.gridBodyCon.getScrollFeature();if(this.needToMoveLeft?t=o.scrollHorizontally(-e):this.needToMoveRight&&(t=o.scrollHorizontally(e)),0!==t)this.onDragging(this.lastDraggingEvent),this.failedMoveAttempts=0;else{this.failedMoveAttempts++;var n=this.lastDraggingEvent.dragItem.columns.filter((function(e){return!e.getColDef().lockPinned}));if(n.length>0&&(this.dragAndDropService.setGhostIcon(Da.ICON_PINNED),this.failedMoveAttempts>7)){var r=this.needToMoveLeft?"left":"right";this.setColumnsPinned(n,r,"uiColumnDragged"),this.dragAndDropService.nudge()}}},Kc([q("columnModel")],e.prototype,"columnModel",void 0),Kc([q("dragAndDropService")],e.prototype,"dragAndDropService",void 0),Kc([q("gridOptionsService")],e.prototype,"gridOptionsService",void 0),Kc([q("ctrlsService")],e.prototype,"ctrlsService",void 0),Kc([$],e.prototype,"init",null),e}(),Xc=function(){var e=function(t,o){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])},e(t,o)};return function(t,o){function n(){this.constructor=t}e(t,o),t.prototype=null===o?Object.create(o):(n.prototype=o.prototype,new n)}}(),Qc=function(e,t,o,n){var r,i=arguments.length,a=i<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,o):n;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)a=Reflect.decorate(e,t,o,n);else for(var s=e.length-1;s>=0;s--)(r=e[s])&&(a=(i<3?r(a):i>3?r(t,o,a):r(t,o))||a);return i>3&&a&&Object.defineProperty(t,o,a),a},Zc=function(e){function t(t,o){var n=e.call(this)||this;return n.pinned=t,n.eContainer=o,n}return Xc(t,e),t.prototype.postConstruct=function(){var e=this;this.ctrlsService.whenReady((function(t){switch(e.pinned){case"left":e.eSecondaryContainers=[[t.gridBodyCtrl.getBodyViewportElement(),t.leftRowContainerCtrl.getContainerElement()],[t.bottomLeftRowContainerCtrl.getContainerElement()],[t.topLeftRowContainerCtrl.getContainerElement()]];break;case"right":e.eSecondaryContainers=[[t.gridBodyCtrl.getBodyViewportElement(),t.rightRowContainerCtrl.getContainerElement()],[t.bottomRightRowContainerCtrl.getContainerElement()],[t.topRightRowContainerCtrl.getContainerElement()]];break;default:e.eSecondaryContainers=[[t.gridBodyCtrl.getBodyViewportElement(),t.centerRowContainerCtrl.getViewportElement()],[t.bottomCenterRowContainerCtrl.getViewportElement()],[t.topCenterRowContainerCtrl.getViewportElement()]]}}))},t.prototype.isInterestedIn=function(e){return e===Di.HeaderCell||e===Di.ToolPanel&&this.gridOptionsService.is("allowDragFromColumnsToolPanel")},t.prototype.getSecondaryContainers=function(){return this.eSecondaryContainers},t.prototype.getContainer=function(){return this.eContainer},t.prototype.init=function(){this.moveColumnFeature=this.createManagedBean(new Jc(this.pinned,this.eContainer)),this.bodyDropPivotTarget=this.createManagedBean(new qc(this.pinned)),this.dragAndDropService.addDropTarget(this)},t.prototype.getIconName=function(){return this.currentDropListener.getIconName()},t.prototype.isDropColumnInPivotMode=function(e){return this.columnModel.isPivotMode()&&e.dragSource.type===Di.ToolPanel},t.prototype.onDragEnter=function(e){this.currentDropListener=this.isDropColumnInPivotMode(e)?this.bodyDropPivotTarget:this.moveColumnFeature,this.currentDropListener.onDragEnter(e)},t.prototype.onDragLeave=function(e){this.currentDropListener.onDragLeave(e)},t.prototype.onDragging=function(e){this.currentDropListener.onDragging(e)},t.prototype.onDragStop=function(e){this.currentDropListener.onDragStop(e)},Qc([q("dragAndDropService")],t.prototype,"dragAndDropService",void 0),Qc([q("columnModel")],t.prototype,"columnModel",void 0),Qc([q("ctrlsService")],t.prototype,"ctrlsService",void 0),Qc([$],t.prototype,"postConstruct",null),Qc([$],t.prototype,"init",null),t}(Fe),ed=function(e,t){var o="function"===typeof Symbol&&e[Symbol.iterator];if(!o)return e;var n,r,i=o.call(e),a=[];try{for(;(void 0===t||t-- >0)&&!(n=i.next()).done;)a.push(n.value)}catch(s){r={error:s}}finally{try{n&&!n.done&&(o=i.return)&&o.call(i)}finally{if(r)throw r.error}}return a},td=function(){for(var e=[],t=0;t<arguments.length;t++)e=e.concat(ed(arguments[t]));return e},od=function(){function e(){}return e.getHeaderClassesFromColDef=function(e,t,o,n){return i(e)?[]:this.getColumnClassesFromCollDef(e.headerClass,e,t,o,n)},e.getToolPanelClassesFromColDef=function(e,t,o,n){return i(e)?[]:this.getColumnClassesFromCollDef(e.toolPanelClass,e,t,o,n)},e.getClassParams=function(e,t,o,n){return{colDef:e,column:o,columnGroup:n,api:t.api,columnApi:t.columnApi,context:t.context}},e.getColumnClassesFromCollDef=function(e,t,o,n,r){if(i(e))return[];var a;"function"===typeof e?a=e(this.getClassParams(t,o,n,r)):a=e;return"string"===typeof a?[a]:Array.isArray(a)?td(a):[]},e}(),nd=function(){var e=function(t,o){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])},e(t,o)};return function(t,o){function n(){this.constructor=t}e(t,o),t.prototype=null===o?Object.create(o):(n.prototype=o.prototype,new n)}}(),rd=function(e,t,o,n){var r,i=arguments.length,a=i<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,o):n;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)a=Reflect.decorate(e,t,o,n);else for(var s=e.length-1;s>=0;s--)(r=e[s])&&(a=(i<3?r(a):i>3?r(t,o,a):r(t,o))||a);return i>3&&a&&Object.defineProperty(t,o,a),a},id=function(e){function t(o){var n=e.call(this,t.TEMPLATE,o)||this;return n.headerCompVersion=0,n.column=o.getColumnGroupChild(),n.pinned=o.getPinned(),n}return nd(t,e),t.prototype.postConstruct=function(){var e=this,t=this.getGui(),o=function(e,o,n){var r=n||t;null!=o&&""!=o?r.setAttribute(e,o):r.removeAttribute(e)},n={setWidth:function(e){return t.style.width=e},addOrRemoveCssClass:function(t,o){return e.addOrRemoveCssClass(t,o)},setColId:function(e){return o("col-id",e)},setTitle:function(e){return o("title",e)},setAriaDescription:function(e){return Jt(t,e)},setAriaSort:function(e){return e?po(t,e):ho(t)},setUserCompDetails:function(t){return e.setUserCompDetails(t)},getUserCompInstance:function(){return e.headerComp}};this.ctrl.setComp(n,this.getGui(),this.eResize,this.eHeaderCompWrapper);var r=this.ctrl.getSelectAllGui();this.eResize.insertAdjacentElement("afterend",r)},t.prototype.destroyHeaderComp=function(){this.headerComp&&(this.eHeaderCompWrapper.removeChild(this.headerCompGui),this.headerComp=this.destroyBean(this.headerComp),this.headerCompGui=void 0)},t.prototype.setUserCompDetails=function(e){var t=this;this.headerCompVersion++;var o=this.headerCompVersion;e.newAgStackInstance().then((function(e){return t.afterCompCreated(o,e)}))},t.prototype.afterCompCreated=function(e,t){e==this.headerCompVersion&&this.isAlive()?(this.destroyHeaderComp(),this.headerComp=t,this.headerCompGui=t.getGui(),this.eHeaderCompWrapper.appendChild(this.headerCompGui),this.ctrl.setDragSource(this.getGui())):this.destroyBean(t)},t.TEMPLATE='<div class="ag-header-cell" role="columnheader" tabindex="-1">\n            <div ref="eResize" class="ag-header-cell-resize" role="presentation"></div>\n            <div ref="eHeaderCompWrapper" class="ag-header-cell-comp-wrapper" role="presentation"></div>\n        </div>',rd([mr("eResize")],t.prototype,"eResize",void 0),rd([mr("eHeaderCompWrapper")],t.prototype,"eHeaderCompWrapper",void 0),rd([$],t.prototype,"postConstruct",null),rd([U],t.prototype,"destroyHeaderComp",null),t}(Hs),ad=function(){var e=function(t,o){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])},e(t,o)};return function(t,o){function n(){this.constructor=t}e(t,o),t.prototype=null===o?Object.create(o):(n.prototype=o.prototype,new n)}}(),sd=function(e,t,o,n){var r,i=arguments.length,a=i<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,o):n;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)a=Reflect.decorate(e,t,o,n);else for(var s=e.length-1;s>=0;s--)(r=e[s])&&(a=(i<3?r(a):i>3?r(t,o,a):r(t,o))||a);return i>3&&a&&Object.defineProperty(t,o,a),a},ld=function(e){function t(o){return e.call(this,t.TEMPLATE,o)||this}return ad(t,e),t.prototype.postConstruct=function(){var e=this,t=this.getGui(),o=function(e,o){return void 0!=o?t.setAttribute(e,o):t.removeAttribute(e)},n={addOrRemoveCssClass:function(t,o){return e.addOrRemoveCssClass(t,o)},setResizableDisplayed:function(t){return on(e.eResize,t)},setWidth:function(e){return t.style.width=e},setColId:function(e){return t.setAttribute("col-id",e)},setAriaExpanded:function(e){return o("aria-expanded",e)},setTitle:function(e){return o("title",e)},setUserCompDetails:function(t){return e.setUserCompDetails(t)}};this.ctrl.setComp(n,t,this.eResize)},t.prototype.setUserCompDetails=function(e){var t=this;e.newAgStackInstance().then((function(e){return t.afterHeaderCompCreated(e)}))},t.prototype.afterHeaderCompCreated=function(e){var t=this,o=function(){return t.destroyBean(e)};this.isAlive()?(this.getGui().appendChild(e.getGui()),this.addDestroyFunc(o),this.ctrl.setDragSource(e.getGui())):o()},t.TEMPLATE='<div class="ag-header-group-cell" role="columnheader" tabindex="-1">\n            <div ref="eResize" class="ag-header-cell-resize" role="presentation"></div>\n        </div>',sd([q("userComponentFactory")],t.prototype,"userComponentFactory",void 0),sd([mr("eResize")],t.prototype,"eResize",void 0),sd([$],t.prototype,"postConstruct",null),t}(Hs),cd=function(){var e=function(t,o){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])},e(t,o)};return function(t,o){function n(){this.constructor=t}e(t,o),t.prototype=null===o?Object.create(o):(n.prototype=o.prototype,new n)}}(),dd=function(e,t,o,n){var r,i=arguments.length,a=i<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,o):n;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)a=Reflect.decorate(e,t,o,n);else for(var s=e.length-1;s>=0;s--)(r=e[s])&&(a=(i<3?r(a):i>3?r(t,o,a):r(t,o))||a);return i>3&&a&&Object.defineProperty(t,o,a),a};!function(e){e.COLUMN_GROUP="group",e.COLUMN="column",e.FLOATING_FILTER="filter"}($c||($c={}));var ud,pd=function(e){function t(t){var o=e.call(this)||this;o.headerComps={};var n=t.getType()==$c.COLUMN_GROUP?"ag-header-row-column-group":t.getType()==$c.FLOATING_FILTER?"ag-header-row-column-filter":"ag-header-row-column";return o.setTemplate('<div class="ag-header-row '+n+'" role="row"></div>'),o.ctrl=t,o}return cd(t,e),t.prototype.init=function(){var e=this,t={setTransform:function(t){return e.getGui().style.transform=t},setHeight:function(t){return e.getGui().style.height=t},setTop:function(t){return e.getGui().style.top=t},setHeaderCtrls:function(t){return e.setHeaderCtrls(t)},setWidth:function(t){return e.getGui().style.width=t},setAriaRowIndex:function(t){return so(e.getGui(),t)}};this.ctrl.setComp(t)},t.prototype.destroyHeaderCtrls=function(){this.setHeaderCtrls([])},t.prototype.setHeaderCtrls=function(e){var t=this;if(this.isAlive()){var o=this.headerComps;this.headerComps={},e.forEach((function(e){var n=e.getInstanceId(),r=o[n];delete o[n],null==r&&(r=t.createHeaderComp(e),t.getGui().appendChild(r.getGui())),t.headerComps[n]=r})),h(o,(function(e,o){t.getGui().removeChild(o.getGui()),t.destroyBean(o)}));var n=this.gridOptionsService.is("ensureDomOrder"),r=this.gridOptionsService.isDomLayout("print");if(n||r){var i=x(this.headerComps);i.sort((function(e,t){return e.getCtrl().getColumnGroupChild().getLeft()-t.getCtrl().getColumnGroupChild().getLeft()}));var a=i.map((function(e){return e.getGui()}));Cn(this.getGui(),a)}}},t.prototype.createHeaderComp=function(e){var t;switch(this.ctrl.getType()){case $c.COLUMN_GROUP:t=new ld(e);break;case $c.FLOATING_FILTER:t=new $s(e);break;default:t=new id(e)}return this.createBean(t),t.setParentComponent(this),t},dd([$],t.prototype,"init",null),dd([U],t.prototype,"destroyHeaderCtrls",null),t}(fr),hd=function(){var e=function(t,o){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])},e(t,o)};return function(t,o){function n(){this.constructor=t}e(t,o),t.prototype=null===o?Object.create(o):(n.prototype=o.prototype,new n)}}(),fd=function(e,t,o,n){var r,i=arguments.length,a=i<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,o):n;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)a=Reflect.decorate(e,t,o,n);else for(var s=e.length-1;s>=0;s--)(r=e[s])&&(a=(i<3?r(a):i>3?r(t,o,a):r(t,o))||a);return i>3&&a&&Object.defineProperty(t,o,a),a},gd=0,md=function(e){function t(t,o){var n=e.call(this)||this;return n.lastFocusEvent=null,n.columnGroupChild=t,n.parentRowCtrl=o,n.instanceId=t.getUniqueId()+"-"+gd++,n}return hd(t,e),t.prototype.shouldStopEventPropagation=function(e){var t=this.focusService.getFocusedHeader(),o=t.headerRowIndex,n=t.column;return $n(this.gridOptionsService,e,o,n)},t.prototype.getWrapperHasFocus=function(){return this.gridOptionsService.getDocument().activeElement===this.eGui},t.prototype.setGui=function(e){this.eGui=e,this.addDomData()},t.prototype.handleKeyDown=function(e){var t=this.getWrapperHasFocus();switch(e.key){case Hn.PAGE_DOWN:case Hn.PAGE_UP:case Hn.PAGE_HOME:case Hn.PAGE_END:t&&e.preventDefault()}},t.prototype.addDomData=function(){var e=this,o=t.DOM_DATA_KEY_HEADER_CTRL;this.gridOptionsService.setDomData(this.eGui,o,this),this.addDestroyFunc((function(){return e.gridOptionsService.setDomData(e.eGui,o,null)}))},t.prototype.getGui=function(){return this.eGui},t.prototype.focus=function(e){return!!this.eGui&&(this.lastFocusEvent=e||null,this.eGui.focus(),!0)},t.prototype.getRowIndex=function(){return this.parentRowCtrl.getRowIndex()},t.prototype.getParentRowCtrl=function(){return this.parentRowCtrl},t.prototype.getPinned=function(){return this.parentRowCtrl.getPinned()},t.prototype.getInstanceId=function(){return this.instanceId},t.prototype.getColumnGroupChild=function(){return this.columnGroupChild},t.DOM_DATA_KEY_HEADER_CTRL="headerCtrl",fd([q("focusService")],t.prototype,"focusService",void 0),fd([q("beans")],t.prototype,"beans",void 0),fd([q("userComponentFactory")],t.prototype,"userComponentFactory",void 0),t}(Fe),yd=function(){var e=function(t,o){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])},e(t,o)};return function(t,o){function n(){this.constructor=t}e(t,o),t.prototype=null===o?Object.create(o):(n.prototype=o.prototype,new n)}}(),vd=function(e,t,o,n){var r,i=arguments.length,a=i<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,o):n;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)a=Reflect.decorate(e,t,o,n);else for(var s=e.length-1;s>=0;s--)(r=e[s])&&(a=(i<3?r(a):i>3?r(t,o,a):r(t,o))||a);return i>3&&a&&Object.defineProperty(t,o,a),a},bd=function(e){function t(t,o,n,r){var i=e.call(this)||this;return i.columnOrGroup=t,i.eCell=o,i.ariaEl=i.eCell.querySelector("[role=columnheader]")||i.eCell,i.colsSpanning=r,i.beans=n,i}return yd(t,e),t.prototype.setColsSpanning=function(e){this.colsSpanning=e,this.onLeftChanged()},t.prototype.getColumnOrGroup=function(){return this.beans.gridOptionsService.is("enableRtl")&&this.colsSpanning?fe(this.colsSpanning):this.columnOrGroup},t.prototype.postConstruct=function(){this.addManagedListener(this.columnOrGroup,ce.EVENT_LEFT_CHANGED,this.onLeftChanged.bind(this)),this.setLeftFirstTime(),this.addManagedListener(this.eventService,$e.EVENT_DISPLAYED_COLUMNS_WIDTH_CHANGED,this.onLeftChanged.bind(this)),this.addManagedPropertyListener("domLayout",this.onLeftChanged.bind(this))},t.prototype.setLeftFirstTime=function(){var e=this.beans.gridOptionsService.is("suppressColumnMoveAnimation"),t=r(this.columnOrGroup.getOldLeft());this.beans.columnAnimationService.isActive()&&t&&!e?this.animateInLeft():this.onLeftChanged()},t.prototype.animateInLeft=function(){var e=this,t=this.getColumnOrGroup(),o=t.getLeft(),n=t.getOldLeft(),r=this.modifyLeftForPrintLayout(t,n),i=this.modifyLeftForPrintLayout(t,o);this.setLeft(r),this.actualLeft=i,this.beans.columnAnimationService.executeNextVMTurn((function(){e.actualLeft===i&&e.setLeft(i)}))},t.prototype.onLeftChanged=function(){var e=this.getColumnOrGroup(),t=e.getLeft();this.actualLeft=this.modifyLeftForPrintLayout(e,t),this.setLeft(this.actualLeft)},t.prototype.modifyLeftForPrintLayout=function(e,t){if(!this.beans.gridOptionsService.isDomLayout("print"))return t;if("left"===e.getPinned())return t;var o=this.beans.columnModel.getDisplayedColumnsLeftWidth();return"right"===e.getPinned()?o+this.beans.columnModel.getBodyContainerWidth()+t:o+t},t.prototype.setLeft=function(e){var t;if(r(e)&&(this.eCell.style.left=e+"px"),this.columnOrGroup instanceof ce)t=this.columnOrGroup;else{var o=this.columnOrGroup.getLeafColumns();if(!o.length)return;o.length>1&&uo(this.ariaEl,o.length),t=o[0]}var n=this.beans.columnModel.getAriaColumnIndex(t);co(this.ariaEl,n)},vd([$],t.prototype,"postConstruct",null),t}(Fe),xd=function(){var e=function(t,o){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])},e(t,o)};return function(t,o){function n(){this.constructor=t}e(t,o),t.prototype=null===o?Object.create(o):(n.prototype=o.prototype,new n)}}(),wd=function(e,t,o,n){var r,i=arguments.length,a=i<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,o):n;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)a=Reflect.decorate(e,t,o,n);else for(var s=e.length-1;s>=0;s--)(r=e[s])&&(a=(i<3?r(a):i>3?r(t,o,a):r(t,o))||a);return i>3&&a&&Object.defineProperty(t,o,a),a},Cd=function(e){function t(t,o){var n=e.call(this)||this;return n.columns=t,n.element=o,n}return xd(t,e),t.prototype.postConstruct=function(){this.gridOptionsService.is("columnHoverHighlight")&&this.addMouseHoverListeners()},t.prototype.addMouseHoverListeners=function(){this.addManagedListener(this.element,"mouseout",this.onMouseOut.bind(this)),this.addManagedListener(this.element,"mouseover",this.onMouseOver.bind(this))},t.prototype.onMouseOut=function(){this.columnHoverService.clearMouseOver()},t.prototype.onMouseOver=function(){this.columnHoverService.setMouseOver(this.columns)},wd([q("columnHoverService")],t.prototype,"columnHoverService",void 0),wd([$],t.prototype,"postConstruct",null),t}(Fe),_d=function(){var e=function(t,o){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])},e(t,o)};return function(t,o){function n(){this.constructor=t}e(t,o),t.prototype=null===o?Object.create(o):(n.prototype=o.prototype,new n)}}(),Sd=function(e,t,o,n){var r,i=arguments.length,a=i<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,o):n;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)a=Reflect.decorate(e,t,o,n);else for(var s=e.length-1;s>=0;s--)(r=e[s])&&(a=(i<3?r(a):i>3?r(t,o,a):r(t,o))||a);return i>3&&a&&Object.defineProperty(t,o,a),a},Ed=function(e){function t(t,o){var n=e.call(this,t,o)||this;return n.column=t,n}return _d(t,e),t.prototype.setComp=function(t,o,n,r){e.prototype.setGui.call(this,o),this.comp=t,this.eButtonShowMainFilter=n,this.eFloatingFilterBody=r;var i=this.column.getColDef(),a=!!i.filter||!!i.filterFramework,s=!!i.floatingFilter;this.active=a&&s,this.setupWidth(),this.setupLeft(),this.setupHover(),this.setupFocus(),this.setupUserComp(),this.setupSyncWithFilter(),this.setupUi(),this.addManagedListener(this.eButtonShowMainFilter,"click",this.showParentFilter.bind(this)),this.active&&this.addManagedListener(this.column,ce.EVENT_FILTER_CHANGED,this.updateFilterButton.bind(this))},t.prototype.setupUi=function(){if(this.comp.setButtonWrapperDisplayed(!this.suppressFilterButton&&this.active),this.active){this.comp.addOrRemoveBodyCssClass("ag-floating-filter-full-body",this.suppressFilterButton),this.comp.addOrRemoveBodyCssClass("ag-floating-filter-body",!this.suppressFilterButton);var e=Gn("filter",this.gridOptionsService,this.column);e&&this.eButtonShowMainFilter.appendChild(e)}},t.prototype.setupFocus=function(){this.createManagedBean(new Ar(this.eGui,{shouldStopEventPropagation:this.shouldStopEventPropagation.bind(this),onTabKeyDown:this.onTabKeyDown.bind(this),handleKeyDown:this.handleKeyDown.bind(this),onFocusIn:this.onFocusIn.bind(this)}))},t.prototype.onTabKeyDown=function(e){if(!(this.gridOptionsService.getDocument().activeElement===this.eGui)){var t=this.focusService.findNextFocusableElement(this.eGui,null,e.shiftKey);if(t)return this.beans.headerNavigationService.scrollToColumn(this.column),e.preventDefault(),void t.focus();var o=this.findNextColumnWithFloatingFilter(e.shiftKey);o&&this.focusService.focusHeaderPosition({headerPosition:{headerRowIndex:this.getParentRowCtrl().getRowIndex(),column:o},event:e})&&e.preventDefault()}},t.prototype.findNextColumnWithFloatingFilter=function(e){var t=this.beans.columnModel,o=this.column;do{if(!(o=e?t.getDisplayedColBefore(o):t.getDisplayedColAfter(o)))break}while(!o.getColDef().filter||!o.getColDef().floatingFilter);return o},t.prototype.handleKeyDown=function(t){e.prototype.handleKeyDown.call(this,t);var o=this.getWrapperHasFocus();switch(t.key){case Hn.UP:case Hn.DOWN:o||t.preventDefault();case Hn.LEFT:case Hn.RIGHT:if(o)return;t.stopPropagation();case Hn.ENTER:o&&this.focusService.focusInto(this.eGui)&&t.preventDefault();break;case Hn.ESCAPE:o||this.eGui.focus()}},t.prototype.onFocusIn=function(e){if(!this.eGui.contains(e.relatedTarget)){var t=!!e.relatedTarget&&!e.relatedTarget.classList.contains("ag-floating-filter"),o=!!e.relatedTarget&&an(e.relatedTarget,"ag-floating-filter");if(t&&o&&e.target===this.eGui){var n=this.lastFocusEvent,r=!(!n||n.key!==Hn.TAB);if(n&&r){var i=n.shiftKey;this.focusService.focusInto(this.eGui,i)}}var a=this.getRowIndex();this.beans.focusService.setFocusedHeader(a,this.column)}},t.prototype.setupHover=function(){var e=this;this.createManagedBean(new Cd([this.column],this.eGui));var t=function(){if(e.gridOptionsService.is("columnHoverHighlight")){var t=e.columnHoverService.isHovered(e.column);e.comp.addOrRemoveCssClass("ag-column-hover",t)}};this.addManagedListener(this.eventService,$e.EVENT_COLUMN_HOVER_CHANGED,t),t()},t.prototype.setupLeft=function(){var e=new bd(this.column,this.eGui,this.beans);this.createManagedBean(e)},t.prototype.setupUserComp=function(){var e=this;if(this.active){var t=this.column.getColDef();this.suppressFilterButton=!!t.floatingFilterComponentParams&&!!t.floatingFilterComponentParams.suppressFilterButton;var o=this.filterManager.getFloatingFilterCompDetails(this.column,(function(){return e.showParentFilter()}));o&&this.comp.setCompDetails(o)}},t.prototype.showParentFilter=function(){var e=this.suppressFilterButton?this.eFloatingFilterBody:this.eButtonShowMainFilter;this.menuFactory.showMenuAfterButtonClick(this.column,e,"floatingFilter","filterMenuTab",["filterMenuTab"])},t.prototype.setupSyncWithFilter=function(){var e=this;if(this.active){var t=function(t){var o=e.comp.getFloatingFilterComp();if(o){var n=e.filterManager.getCurrentFloatingFilterParentModel(e.column);o.then((function(e){e&&e.onParentModelChanged(n,t)}))}};this.addManagedListener(this.column,ce.EVENT_FILTER_CHANGED,t),this.filterManager.isFilterActive(this.column)&&t(null)}},t.prototype.setupWidth=function(){var e=this,t=function(){var t=e.column.getActualWidth()+"px";e.comp.setWidth(t)};this.addManagedListener(this.column,ce.EVENT_WIDTH_CHANGED,t),t()},t.prototype.updateFilterButton=function(){!this.suppressFilterButton&&this.comp&&this.comp.setButtonWrapperDisplayed(this.filterManager.isFilterAllowed(this.column))},Sd([q("filterManager")],t.prototype,"filterManager",void 0),Sd([q("columnHoverService")],t.prototype,"columnHoverService",void 0),Sd([q("menuFactory")],t.prototype,"menuFactory",void 0),t}(md),kd=function(){var e=function(t,o){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])},e(t,o)};return function(t,o){function n(){this.constructor=t}e(t,o),t.prototype=null===o?Object.create(o):(n.prototype=o.prototype,new n)}}(),jd=function(e,t,o,n){var r,i=arguments.length,a=i<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,o):n;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)a=Reflect.decorate(e,t,o,n);else for(var s=e.length-1;s>=0;s--)(r=e[s])&&(a=(i<3?r(a):i>3?r(t,o,a):r(t,o))||a);return i>3&&a&&Object.defineProperty(t,o,a),a},Ad=function(e){function t(t,o,n,r,i){var a=e.call(this)||this;return a.pinned=t,a.column=o,a.eResize=n,a.comp=r,a.ctrl=i,a}return kd(t,e),t.prototype.postConstruct=function(){var e,t,o=this,n=this.column.getColDef(),r=[],i=function(){r.forEach((function(e){return e()})),r.length=0},a=function(){var a=o.column.isResizable(),s=!o.gridOptionsService.is("suppressAutoSize")&&!n.suppressAutoSize;(a!==e||s!==t)&&(e=a,t=s,i(),function(){if(on(o.eResize,e),e){var n=o.horizontalResizeService.addResizeBar({eResizeBar:o.eResize,onResizeStart:o.onResizeStart.bind(o),onResizing:o.onResizing.bind(o,!1),onResizeEnd:o.onResizing.bind(o,!0)});if(r.push(n),t){var i=o.gridOptionsService.is("skipHeaderOnAutoSize"),a=function(){o.columnModel.autoSizeColumn(o.column,i,"uiColumnResized")};o.eResize.addEventListener("dblclick",a);var s=new Yi(o.eResize);s.addEventListener(Yi.EVENT_DOUBLE_TAP,a),o.addDestroyFunc((function(){o.eResize.removeEventListener("dblclick",a),s.removeEventListener(Yi.EVENT_DOUBLE_TAP,a),s.destroy()}))}}}())};a(),this.addDestroyFunc(i),this.ctrl.addRefreshFunction(a)},t.prototype.onResizing=function(e,t){var o=this.normaliseResizeAmount(t),n=[{key:this.column,newWidth:this.resizeStartWidth+o}];this.columnModel.setColumnWidths(n,this.resizeWithShiftKey,e,"uiColumnResized"),e&&this.comp.addOrRemoveCssClass("ag-column-resizing",!1)},t.prototype.onResizeStart=function(e){this.resizeStartWidth=this.column.getActualWidth(),this.resizeWithShiftKey=e,this.comp.addOrRemoveCssClass("ag-column-resizing",!0)},t.prototype.normaliseResizeAmount=function(e){var t=e,o="left"!==this.pinned,n="right"===this.pinned;return this.gridOptionsService.is("enableRtl")?o&&(t*=-1):n&&(t*=-1),t},jd([q("horizontalResizeService")],t.prototype,"horizontalResizeService",void 0),jd([q("columnModel")],t.prototype,"columnModel",void 0),jd([$],t.prototype,"postConstruct",null),t}(Fe),Rd=function(){var e=function(t,o){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])},e(t,o)};return function(t,o){function n(){this.constructor=t}e(t,o),t.prototype=null===o?Object.create(o):(n.prototype=o.prototype,new n)}}(),Od=function(e,t,o,n){var r,i=arguments.length,a=i<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,o):n;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)a=Reflect.decorate(e,t,o,n);else for(var s=e.length-1;s>=0;s--)(r=e[s])&&(a=(i<3?r(a):i>3?r(t,o,a):r(t,o))||a);return i>3&&a&&Object.defineProperty(t,o,a),a},Td=function(e){function t(t){var o=e.call(this)||this;o.cbSelectAllVisible=!1,o.processingEventFromCheckbox=!1,o.column=t;var n=t.getColDef();return o.filteredOnly=!!(null===n||void 0===n?void 0:n.headerCheckboxSelectionFilteredOnly),o.currentPageOnly=!!(null===n||void 0===n?void 0:n.headerCheckboxSelectionCurrentPageOnly),o}return Rd(t,e),t.prototype.onSpaceKeyPressed=function(e){var t=this.cbSelectAll,o=this.gridOptionsService.getDocument();t.isDisplayed()&&!t.getGui().contains(o.activeElement)&&(e.preventDefault(),t.setValue(!t.getValue()))},t.prototype.getCheckboxGui=function(){return this.cbSelectAll.getGui()},t.prototype.setComp=function(e){this.headerCellCtrl=e,this.cbSelectAll=this.createManagedBean(new ti),this.cbSelectAll.addCssClass("ag-header-select-all"),$t(this.cbSelectAll.getGui(),"presentation"),this.showOrHideSelectAll(),this.addManagedListener(this.eventService,$e.EVENT_NEW_COLUMNS_LOADED,this.showOrHideSelectAll.bind(this)),this.addManagedListener(this.eventService,$e.EVENT_DISPLAYED_COLUMNS_CHANGED,this.showOrHideSelectAll.bind(this)),this.addManagedListener(this.eventService,$e.EVENT_SELECTION_CHANGED,this.onSelectionChanged.bind(this)),this.addManagedListener(this.eventService,$e.EVENT_PAGINATION_CHANGED,this.onSelectionChanged.bind(this)),this.addManagedListener(this.eventService,$e.EVENT_MODEL_UPDATED,this.onModelChanged.bind(this)),this.addManagedListener(this.cbSelectAll,ti.EVENT_CHANGED,this.onCbSelectAll.bind(this)),eo(this.cbSelectAll.getGui(),!0),this.cbSelectAll.getInputElement().setAttribute("tabindex","-1"),this.refreshSelectAllLabel()},t.prototype.showOrHideSelectAll=function(){this.cbSelectAllVisible=this.isCheckboxSelection(),this.cbSelectAll.setDisplayed(this.cbSelectAllVisible,{skipAriaHidden:!0}),this.cbSelectAllVisible&&(this.checkRightRowModelType("selectAllCheckbox"),this.updateStateOfCheckbox()),this.refreshSelectAllLabel()},t.prototype.onModelChanged=function(){this.cbSelectAllVisible&&this.updateStateOfCheckbox()},t.prototype.onSelectionChanged=function(){this.cbSelectAllVisible&&this.updateStateOfCheckbox()},t.prototype.updateStateOfCheckbox=function(){if(!this.processingEventFromCheckbox){this.processingEventFromCheckbox=!0;var e=this.selectionService.getSelectAllState(this.filteredOnly,this.currentPageOnly);this.cbSelectAll.setValue(e),this.refreshSelectAllLabel(),this.processingEventFromCheckbox=!1}},t.prototype.refreshSelectAllLabel=function(){if(this.cbSelectAllVisible){var e=this.localeService.getLocaleTextFunc(),t=this.cbSelectAll.getValue()?e("ariaChecked","checked"):e("ariaUnchecked","unchecked"),o=e("ariaRowSelectAll","Press Space to toggle all rows selection");this.headerCellCtrl.setAriaDescriptionProperty("selectAll",o+" ("+t+")"),this.cbSelectAll.setInputAriaLabel(o+" ("+t+")")}else this.headerCellCtrl.setAriaDescriptionProperty("selectAll",null),this.cbSelectAll.setInputAriaLabel(null);this.headerCellCtrl.refreshAriaDescription()},t.prototype.checkRightRowModelType=function(e){var t=this.rowModel.getType();return!("clientSide"!==t&&"serverSide"!==t)||(console.warn("AG Grid: "+e+" is only available if using 'clientSide' or 'serverSide' rowModelType, you are using "+t+"."),!1)},t.prototype.onCbSelectAll=function(){if(!this.processingEventFromCheckbox&&this.cbSelectAllVisible){var e=this.cbSelectAll.getValue(),t="uiSelectAll";this.currentPageOnly?t="uiSelectAllCurrentPage":this.filteredOnly&&(t="uiSelectAllFiltered");var o={source:t,justFiltered:this.filteredOnly,justCurrentPage:this.currentPageOnly};e?this.selectionService.selectAllRowNodes(o):this.selectionService.deselectAllRowNodes(o)}},t.prototype.isCheckboxSelection=function(){var e=this.column.getColDef().headerCheckboxSelection;"function"===typeof e&&(e=e({column:this.column,colDef:this.column.getColDef(),columnApi:this.columnApi,api:this.gridApi,context:this.gridOptionsService.context}));return!!e&&this.checkRightRowModelType("headerCheckboxSelection")},Od([q("gridApi")],t.prototype,"gridApi",void 0),Od([q("columnApi")],t.prototype,"columnApi",void 0),Od([q("rowModel")],t.prototype,"rowModel",void 0),Od([q("selectionService")],t.prototype,"selectionService",void 0),t}(Fe),Dd=function(){var e=function(t,o){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])},e(t,o)};return function(t,o){function n(){this.constructor=t}e(t,o),t.prototype=null===o?Object.create(o):(n.prototype=o.prototype,new n)}}(),Pd=function(e,t,o,n){var r,i=arguments.length,a=i<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,o):n;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)a=Reflect.decorate(e,t,o,n);else for(var s=e.length-1;s>=0;s--)(r=e[s])&&(a=(i<3?r(a):i>3?r(t,o,a):r(t,o))||a);return i>3&&a&&Object.defineProperty(t,o,a),a},Nd=function(e){function t(t,o){var n=e.call(this,t,o)||this;return n.refreshFunctions=[],n.userHeaderClasses=new Set,n.ariaDescriptionProperties=new Map,n.column=t,n}return Dd(t,e),t.prototype.setComp=function(t,o,n,r){var i=this;e.prototype.setGui.call(this,o),this.comp=t,this.updateState(),this.setupWidth(),this.setupMovingCss(),this.setupMenuClass(),this.setupSortableClass(),this.setupWrapTextClass(),this.refreshSpanHeaderHeight(),this.setupAutoHeight(r),this.addColumnHoverListener(),this.setupFilterCss(),this.setupColId(),this.setupClassesFromColDef(),this.setupTooltip(),this.addActiveHeaderMouseListeners(),this.setupSelectAll(),this.setupUserComp(),this.refreshAria(),this.createManagedBean(new Ad(this.getPinned(),this.column,n,t,this)),this.createManagedBean(new Cd([this.column],o)),this.createManagedBean(new bd(this.column,o,this.beans)),this.createManagedBean(new Ar(o,{shouldStopEventPropagation:function(e){return i.shouldStopEventPropagation(e)},onTabKeyDown:function(){return null},handleKeyDown:this.handleKeyDown.bind(this),onFocusIn:this.onFocusIn.bind(this),onFocusOut:this.onFocusOut.bind(this)})),this.addManagedListener(this.column,ce.EVENT_COL_DEF_CHANGED,this.onColDefChanged.bind(this)),this.addManagedListener(this.eventService,$e.EVENT_COLUMN_VALUE_CHANGED,this.onColumnValueChanged.bind(this)),this.addManagedListener(this.eventService,$e.EVENT_COLUMN_ROW_GROUP_CHANGED,this.onColumnRowGroupChanged.bind(this)),this.addManagedListener(this.eventService,$e.EVENT_COLUMN_PIVOT_CHANGED,this.onColumnPivotChanged.bind(this)),this.addManagedListener(this.eventService,$e.EVENT_HEADER_HEIGHT_CHANGED,this.onHeaderHeightChanged.bind(this))},t.prototype.setupUserComp=function(){var e=this.lookupUserCompDetails();this.setCompDetails(e)},t.prototype.setCompDetails=function(e){this.userCompDetails=e,this.comp.setUserCompDetails(e)},t.prototype.lookupUserCompDetails=function(){var e=this.createParams(),t=this.column.getColDef();return this.userComponentFactory.getHeaderCompDetails(t,e)},t.prototype.createParams=function(){var e=this,t=this.column.getColDef();return{column:this.column,displayName:this.displayName,enableSorting:t.sortable,enableMenu:this.menuEnabled,showColumnMenu:function(t){e.gridApi.showColumnMenuAfterButtonClick(e.column,t)},progressSort:function(t){e.sortController.progressSort(e.column,!!t,"uiColumnSorted")},setSort:function(t,o){e.sortController.setSortForColumn(e.column,t,!!o,"uiColumnSorted")},api:this.gridApi,columnApi:this.columnApi,context:this.gridOptionsService.context,eGridHeader:this.getGui()}},t.prototype.setupSelectAll=function(){this.selectAllFeature=this.createManagedBean(new Td(this.column)),this.selectAllFeature.setComp(this)},t.prototype.getSelectAllGui=function(){return this.selectAllFeature.getCheckboxGui()},t.prototype.handleKeyDown=function(t){e.prototype.handleKeyDown.call(this,t),t.key===Hn.SPACE&&this.selectAllFeature.onSpaceKeyPressed(t),t.key===Hn.ENTER&&this.onEnterKeyPressed(t)},t.prototype.onEnterKeyPressed=function(e){var t=this.comp.getUserCompInstance();if(t)if(e.ctrlKey||e.metaKey)this.menuEnabled&&t.showMenu&&(e.preventDefault(),t.showMenu());else if(this.sortable){var o=e.shiftKey;this.sortController.progressSort(this.column,o,"uiColumnSorted")}},t.prototype.isMenuEnabled=function(){return this.menuEnabled},t.prototype.onFocusIn=function(e){if(!this.getGui().contains(e.relatedTarget)){var t=this.getRowIndex();this.focusService.setFocusedHeader(t,this.column)}this.setActiveHeader(!0)},t.prototype.onFocusOut=function(e){this.getGui().contains(e.relatedTarget)||this.setActiveHeader(!1)},t.prototype.setupTooltip=function(){var e=this,t={getColumn:function(){return e.column},getColDef:function(){return e.column.getColDef()},getGui:function(){return e.eGui},getLocation:function(){return"header"},getTooltipValue:function(){return e.column.getColDef().headerTooltip}},o=this.createManagedBean(new wl(t,this.beans));o.setComp(this.comp),this.refreshFunctions.push((function(){return o.refreshToolTip()}))},t.prototype.setupClassesFromColDef=function(){var e=this,t=function(){var t=e.column.getColDef(),o=od.getHeaderClassesFromColDef(t,e.gridOptionsService,e.column,null),n=e.userHeaderClasses;e.userHeaderClasses=new Set(o),o.forEach((function(t){n.has(t)?n.delete(t):e.comp.addOrRemoveCssClass(t,!0)})),n.forEach((function(t){return e.comp.addOrRemoveCssClass(t,!1)}))};this.refreshFunctions.push(t),t()},t.prototype.setDragSource=function(e){var t=this;if(this.dragSourceElement=e,this.removeDragSource(),e&&this.draggable){var o=!this.gridOptionsService.is("suppressDragLeaveHidesColumns");this.moveDragSource={type:Di.HeaderCell,eElement:e,defaultIconName:o?Da.ICON_HIDE:Da.ICON_NOT_ALLOWED,getDragItem:function(){return t.createDragItem()},dragItemName:this.displayName,onDragStarted:function(){return t.column.setMoving(!0,"uiColumnMoved")},onDragStopped:function(){return t.column.setMoving(!1,"uiColumnMoved")},onGridEnter:function(e){var n;if(o){var r=(null===(n=null===e||void 0===e?void 0:e.columns)||void 0===n?void 0:n.filter((function(e){return!e.getColDef().lockVisible})))||[];t.columnModel.setColumnsVisible(r,!0,"uiColumnMoved")}},onGridExit:function(e){var n;if(o){var r=(null===(n=null===e||void 0===e?void 0:e.columns)||void 0===n?void 0:n.filter((function(e){return!e.getColDef().lockVisible})))||[];t.columnModel.setColumnsVisible(r,!1,"uiColumnMoved")}}},this.dragAndDropService.addDragSource(this.moveDragSource,!0)}},t.prototype.createDragItem=function(){var e={};return e[this.column.getId()]=this.column.isVisible(),{columns:[this.column],visibleState:e}},t.prototype.removeDragSource=function(){this.moveDragSource&&(this.dragAndDropService.removeDragSource(this.moveDragSource),this.moveDragSource=void 0)},t.prototype.onColDefChanged=function(){this.refresh()},t.prototype.updateState=function(){var e=this.column.getColDef();this.menuEnabled=this.menuFactory.isMenuEnabled(this.column)&&!e.suppressMenu,this.sortable=e.sortable,this.displayName=this.calculateDisplayName(),this.draggable=this.workOutDraggable()},t.prototype.addRefreshFunction=function(e){this.refreshFunctions.push(e)},t.prototype.refresh=function(){this.updateState(),this.refreshHeaderComp(),this.refreshAria(),this.refreshFunctions.forEach((function(e){return e()}))},t.prototype.refreshHeaderComp=function(){var e=this.lookupUserCompDetails();!!(null!=this.comp.getUserCompInstance()&&this.userCompDetails.componentClass==e.componentClass)&&this.attemptHeaderCompRefresh(e.params)?this.setDragSource(this.dragSourceElement):this.setCompDetails(e)},t.prototype.attemptHeaderCompRefresh=function(e){var t=this.comp.getUserCompInstance();return!!t&&(!!t.refresh&&t.refresh(e))},t.prototype.calculateDisplayName=function(){return this.columnModel.getDisplayNameForColumn(this.column,"header",!0)},t.prototype.checkDisplayName=function(){this.displayName!==this.calculateDisplayName()&&this.refresh()},t.prototype.workOutDraggable=function(){var e=this.column.getColDef();return!!(!this.gridOptionsService.is("suppressMovableColumns")&&!e.suppressMovable&&!e.lockPosition)||!!e.enableRowGroup||!!e.enablePivot},t.prototype.onColumnRowGroupChanged=function(){this.checkDisplayName()},t.prototype.onColumnPivotChanged=function(){this.checkDisplayName()},t.prototype.onColumnValueChanged=function(){this.checkDisplayName()},t.prototype.setupWidth=function(){var e=this,t=function(){var t=e.column.getActualWidth();e.comp.setWidth(t+"px")};this.addManagedListener(this.column,ce.EVENT_WIDTH_CHANGED,t),t()},t.prototype.setupMovingCss=function(){var e=this,t=function(){e.comp.addOrRemoveCssClass("ag-header-cell-moving",e.column.isMoving())};this.addManagedListener(this.column,ce.EVENT_MOVING_CHANGED,t),t()},t.prototype.setupMenuClass=function(){var e=this,t=function(){e.comp.addOrRemoveCssClass("ag-column-menu-visible",e.column.isMenuVisible())};this.addManagedListener(this.column,ce.EVENT_MENU_VISIBLE_CHANGED,t),t()},t.prototype.setupSortableClass=function(){var e=this,t=function(){e.comp.addOrRemoveCssClass("ag-header-cell-sortable",!!e.sortable)};t(),this.addRefreshFunction(t),this.addManagedListener(this.eventService,ce.EVENT_SORT_CHANGED,this.refreshAriaSort.bind(this))},t.prototype.setupWrapTextClass=function(){var e=this,t=function(){var t=!!e.column.getColDef().wrapHeaderText;e.comp.addOrRemoveCssClass("ag-header-cell-wrap-text",t)};t(),this.addRefreshFunction(t)},t.prototype.onHeaderHeightChanged=function(){this.refreshSpanHeaderHeight()},t.prototype.refreshSpanHeaderHeight=function(){var e=this,t=e.eGui,o=e.column,n=e.comp,r=e.columnModel,i=e.gridOptionsService;if(o.isSpanHeaderHeight()){var a=this.getColumnGroupPaddingInfo(),s=a.numberOfParents,l=a.isSpanningTotal;if(n.addOrRemoveCssClass("ag-header-span-height",s>0),0!==s){n.addOrRemoveCssClass("ag-header-span-total",l);var c=i.is("pivotMode")?r.getPivotGroupHeaderHeight():r.getGroupHeaderHeight(),d=r.getColumnHeaderRowHeight(),u=s*c;t.style.setProperty("top",-u+"px"),t.style.setProperty("height",d+u+"px")}}},t.prototype.getColumnGroupPaddingInfo=function(){var e=this.column.getParent();if(!e||!e.isPadding())return{numberOfParents:0,isSpanningTotal:!1};for(var t=e.getPaddingLevel()+1,o=!0;e;){if(!e.isPadding()){o=!1;break}e=e.getParent()}return{numberOfParents:t,isSpanningTotal:o}},t.prototype.setupAutoHeight=function(e){var t,o=this,n=function(t){if(o.isAlive()){var r=sn(o.getGui()),i=r.paddingTop+r.paddingBottom+r.borderBottomWidth+r.borderTopWidth,a=e.offsetHeight+i;if(t<5){var s=o.beans.gridOptionsService.getDocument();if(!s||!s.contains(e)||0==a)return void o.beans.frameworkOverrides.setTimeout((function(){return n(t+1)}),0)}o.columnModel.setColumnHeaderHeight(o.column,a)}},r=!1,i=function(){var e=o.column.isSpanHeaderHeight(),t=o.column.isAutoHeaderHeight();if(e){if(s(),t){j((function(){return console.warn("AG Grid: The properties `spanHeaderHeight` and `autoHeaderHeight` cannot be used together in the same column.")}),"HeaderCellCtrl.spanHeaderHeightAndAutoHeaderHeight")}}else t&&!r&&a(),!t&&r&&s()},a=function(){r=!0,n(0),o.comp.addOrRemoveCssClass("ag-header-cell-auto-height",!0),t=o.resizeObserverService.observeResize(e,(function(){return n(0)}))},s=function(){r=!1,t&&t(),o.comp.addOrRemoveCssClass("ag-header-cell-auto-height",!1),t=void 0};i(),this.addDestroyFunc((function(){return s()})),this.addManagedListener(this.column,ce.EVENT_WIDTH_CHANGED,(function(){return r&&n(0)})),this.addManagedListener(this.eventService,ce.EVENT_SORT_CHANGED,(function(){r&&o.beans.frameworkOverrides.setTimeout((function(){return n(0)}))})),this.addRefreshFunction(i)},t.prototype.refreshAriaSort=function(){if(this.sortable){var e=this.localeService.getLocaleTextFunc(),t=this.sortController.getDisplaySortForColumn(this.column)||null;this.comp.setAriaSort(Ut(t)),this.setAriaDescriptionProperty("sort",e("ariaSortableColumn","Press ENTER to sort."))}else this.comp.setAriaSort(),this.setAriaDescriptionProperty("sort",null)},t.prototype.refreshAriaMenu=function(){if(this.menuEnabled){var e=this.localeService.getLocaleTextFunc();this.setAriaDescriptionProperty("menu",e("ariaMenuColumn","Press CTRL ENTER to open column menu."))}else this.setAriaDescriptionProperty("menu",null)},t.prototype.setAriaDescriptionProperty=function(e,t){null!=t?this.ariaDescriptionProperties.set(e,t):this.ariaDescriptionProperties.delete(e)},t.prototype.refreshAriaDescription=function(){var e=Array.from(this.ariaDescriptionProperties.values());this.comp.setAriaDescription(e.length?e.join(" "):void 0)},t.prototype.refreshAria=function(){this.refreshAriaSort(),this.refreshAriaMenu(),this.refreshAriaDescription()},t.prototype.addColumnHoverListener=function(){var e=this,t=function(){if(e.gridOptionsService.is("columnHoverHighlight")){var t=e.columnHoverService.isHovered(e.column);e.comp.addOrRemoveCssClass("ag-column-hover",t)}};this.addManagedListener(this.eventService,$e.EVENT_COLUMN_HOVER_CHANGED,t),t()},t.prototype.setupFilterCss=function(){var e=this,t=function(){e.comp.addOrRemoveCssClass("ag-header-cell-filtered",e.column.isFilterActive())};this.addManagedListener(this.column,ce.EVENT_FILTER_ACTIVE_CHANGED,t),t()},t.prototype.setupColId=function(){this.comp.setColId(this.column.getColId())},t.prototype.addActiveHeaderMouseListeners=function(){var e=this,t=function(t){return e.setActiveHeader("mouseenter"===t.type)};this.addManagedListener(this.getGui(),"mouseenter",t),this.addManagedListener(this.getGui(),"mouseleave",t)},t.prototype.setActiveHeader=function(e){this.comp.addOrRemoveCssClass("ag-header-active",e)},Pd([q("columnModel")],t.prototype,"columnModel",void 0),Pd([q("columnHoverService")],t.prototype,"columnHoverService",void 0),Pd([q("sortController")],t.prototype,"sortController",void 0),Pd([q("menuFactory")],t.prototype,"menuFactory",void 0),Pd([q("dragAndDropService")],t.prototype,"dragAndDropService",void 0),Pd([q("resizeObserverService")],t.prototype,"resizeObserverService",void 0),Pd([q("gridApi")],t.prototype,"gridApi",void 0),Pd([q("columnApi")],t.prototype,"columnApi",void 0),Pd([U],t.prototype,"removeDragSource",null),t}(md),Id=function(){var e=function(t,o){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])},e(t,o)};return function(t,o){function n(){this.constructor=t}e(t,o),t.prototype=null===o?Object.create(o):(n.prototype=o.prototype,new n)}}(),Md=function(e,t,o,n){var r,i=arguments.length,a=i<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,o):n;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)a=Reflect.decorate(e,t,o,n);else for(var s=e.length-1;s>=0;s--)(r=e[s])&&(a=(i<3?r(a):i>3?r(t,o,a):r(t,o))||a);return i>3&&a&&Object.defineProperty(t,o,a),a},Ld=function(e){function t(t,o,n,r){var i=e.call(this)||this;return i.eResize=o,i.comp=t,i.pinned=n,i.columnGroup=r,i}return Id(t,e),t.prototype.postConstruct=function(){var e=this;if(this.columnGroup.isResizable()){var t=this.horizontalResizeService.addResizeBar({eResizeBar:this.eResize,onResizeStart:this.onResizeStart.bind(this),onResizing:this.onResizing.bind(this,!1),onResizeEnd:this.onResizing.bind(this,!0)});if(this.addDestroyFunc(t),!this.gridOptionsService.is("suppressAutoSize")){var o=this.gridOptionsService.is("skipHeaderOnAutoSize");this.eResize.addEventListener("dblclick",(function(){var t=[];e.columnGroup.getDisplayedLeafColumns().forEach((function(e){e.getColDef().suppressAutoSize||t.push(e.getColId())})),t.length>0&&e.columnModel.autoSizeColumns({columns:t,skipHeader:o,stopAtGroup:e.columnGroup,source:"uiColumnResized"}),e.resizeLeafColumnsToFit("uiColumnResized")}))}}else this.comp.setResizableDisplayed(!1)},t.prototype.onResizeStart=function(e){var t=this;this.calculateInitialValues();var o=null;if(e&&(o=this.columnModel.getDisplayedGroupAfter(this.columnGroup)),o){var n=o.getDisplayedLeafColumns();this.resizeTakeFromCols=n.filter((function(e){return e.isResizable()})),this.resizeTakeFromStartWidth=0,this.resizeTakeFromCols.forEach((function(e){return t.resizeTakeFromStartWidth+=e.getActualWidth()})),this.resizeTakeFromRatios=[],this.resizeTakeFromCols.forEach((function(e){return t.resizeTakeFromRatios.push(e.getActualWidth()/t.resizeTakeFromStartWidth)}))}else this.resizeTakeFromCols=null,this.resizeTakeFromStartWidth=null,this.resizeTakeFromRatios=null;this.comp.addOrRemoveCssClass("ag-column-resizing",!0)},t.prototype.onResizing=function(e,t,o){void 0===o&&(o="uiColumnResized");var n=this.normaliseDragChange(t),r=this.resizeStartWidth+n;this.resizeColumns(r,o,e)},t.prototype.resizeLeafColumnsToFit=function(e){var t=this.autoWidthCalculator.getPreferredWidthForColumnGroup(this.columnGroup);this.calculateInitialValues(),t>this.resizeStartWidth&&this.resizeColumns(t,e,!0)},t.prototype.resizeColumns=function(e,t,o){void 0===o&&(o=!0);var n=[];if(n.push({columns:this.resizeCols,ratios:this.resizeRatios,width:e}),this.resizeTakeFromCols){var r=e-this.resizeStartWidth;n.push({columns:this.resizeTakeFromCols,ratios:this.resizeTakeFromRatios,width:this.resizeTakeFromStartWidth-r})}this.columnModel.resizeColumnSets({resizeSets:n,finished:o,source:t}),o&&this.comp.addOrRemoveCssClass("ag-column-resizing",!1)},t.prototype.calculateInitialValues=function(){var e=this,t=this.columnGroup.getDisplayedLeafColumns();this.resizeCols=t.filter((function(e){return e.isResizable()})),this.resizeStartWidth=0,this.resizeCols.forEach((function(t){return e.resizeStartWidth+=t.getActualWidth()})),this.resizeRatios=[],this.resizeCols.forEach((function(t){return e.resizeRatios.push(t.getActualWidth()/e.resizeStartWidth)}))},t.prototype.normaliseDragChange=function(e){var t=e;return this.gridOptionsService.is("enableRtl")?"left"!==this.pinned&&(t*=-1):"right"===this.pinned&&(t*=-1),t},Md([q("horizontalResizeService")],t.prototype,"horizontalResizeService",void 0),Md([q("autoWidthCalculator")],t.prototype,"autoWidthCalculator",void 0),Md([q("columnModel")],t.prototype,"columnModel",void 0),Md([$],t.prototype,"postConstruct",null),t}(Fe),Fd=function(){var e=function(t,o){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])},e(t,o)};return function(t,o){function n(){this.constructor=t}e(t,o),t.prototype=null===o?Object.create(o):(n.prototype=o.prototype,new n)}}(),Gd=function(e,t,o,n){var r,i=arguments.length,a=i<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,o):n;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)a=Reflect.decorate(e,t,o,n);else for(var s=e.length-1;s>=0;s--)(r=e[s])&&(a=(i<3?r(a):i>3?r(t,o,a):r(t,o))||a);return i>3&&a&&Object.defineProperty(t,o,a),a},zd=function(e){function t(t,o){var n=e.call(this)||this;return n.removeChildListenersFuncs=[],n.columnGroup=o,n.comp=t,n}return Fd(t,e),t.prototype.postConstruct=function(){this.addListenersToChildrenColumns(),this.addManagedListener(this.columnGroup,ct.EVENT_DISPLAYED_CHILDREN_CHANGED,this.onDisplayedChildrenChanged.bind(this)),this.onWidthChanged(),this.addDestroyFunc(this.removeListenersOnChildrenColumns.bind(this))},t.prototype.addListenersToChildrenColumns=function(){var e=this;this.removeListenersOnChildrenColumns();var t=this.onWidthChanged.bind(this);this.columnGroup.getLeafColumns().forEach((function(o){o.addEventListener("widthChanged",t),o.addEventListener("visibleChanged",t),e.removeChildListenersFuncs.push((function(){o.removeEventListener("widthChanged",t),o.removeEventListener("visibleChanged",t)}))}))},t.prototype.removeListenersOnChildrenColumns=function(){this.removeChildListenersFuncs.forEach((function(e){return e()})),this.removeChildListenersFuncs=[]},t.prototype.onDisplayedChildrenChanged=function(){this.addListenersToChildrenColumns(),this.onWidthChanged()},t.prototype.onWidthChanged=function(){var e=this.columnGroup.getActualWidth();this.comp.setWidth(e+"px"),this.comp.addOrRemoveCssClass("ag-hidden",0===e)},Gd([$],t.prototype,"postConstruct",null),t}(Fe),Hd=function(){var e=function(t,o){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])},e(t,o)};return function(t,o){function n(){this.constructor=t}e(t,o),t.prototype=null===o?Object.create(o):(n.prototype=o.prototype,new n)}}(),Bd=function(e,t,o,n){var r,i=arguments.length,a=i<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,o):n;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)a=Reflect.decorate(e,t,o,n);else for(var s=e.length-1;s>=0;s--)(r=e[s])&&(a=(i<3?r(a):i>3?r(t,o,a):r(t,o))||a);return i>3&&a&&Object.defineProperty(t,o,a),a},Vd=function(e){function t(t,o){var n=e.call(this,t,o)||this;return n.columnGroup=t,n}return Hd(t,e),t.prototype.setComp=function(t,o,n){e.prototype.setGui.call(this,o),this.comp=t,this.displayName=this.columnModel.getDisplayNameForColumnGroup(this.columnGroup,"header"),this.addClasses(),this.addAttributes(),this.setupMovingCss(),this.setupExpandable(),this.setupTooltip(),this.setupUserComp();var r=this.getParentRowCtrl().getPinned(),i=this.columnGroup.getProvidedColumnGroup().getLeafColumns();this.createManagedBean(new Cd(i,o)),this.createManagedBean(new bd(this.columnGroup,o,this.beans)),this.createManagedBean(new zd(t,this.columnGroup)),this.groupResizeFeature=this.createManagedBean(new Ld(t,n,r,this.columnGroup)),this.createManagedBean(new Ar(o,{shouldStopEventPropagation:this.shouldStopEventPropagation.bind(this),onTabKeyDown:function(){},handleKeyDown:this.handleKeyDown.bind(this),onFocusIn:this.onFocusIn.bind(this)}))},t.prototype.resizeLeafColumnsToFit=function(e){var t,o;null===(t=this.groupResizeFeature)||void 0===t||t.onResizeStart(!1),null===(o=this.groupResizeFeature)||void 0===o||o.resizeLeafColumnsToFit(e)},t.prototype.setupUserComp=function(){var e=this,t=this.displayName,o={displayName:this.displayName,columnGroup:this.columnGroup,setExpanded:function(t){e.columnModel.setColumnGroupOpened(e.columnGroup.getProvidedColumnGroup(),t,"gridInitializing")},api:this.gridApi,columnApi:this.columnApi,context:this.gridOptionsService.context};if(!t){for(var n=this.columnGroup,r=n.getLeafColumns();n.getParent()&&n.getParent().getLeafColumns().length===r.length;)n=n.getParent();var i=n.getColGroupDef();i&&(t=i.headerName),t||(t=r?this.columnModel.getDisplayNameForColumn(r[0],"header",!0):"")}var a=this.userComponentFactory.getHeaderGroupCompDetails(o);this.comp.setUserCompDetails(a)},t.prototype.setupTooltip=function(){var e=this,t=this.columnGroup.getColGroupDef(),o={getColumn:function(){return e.columnGroup},getGui:function(){return e.eGui},getLocation:function(){return"headerGroup"},getTooltipValue:function(){return t&&t.headerTooltip}};t&&(o.getColDef=function(){return t}),this.createManagedBean(new wl(o,this.beans)).setComp(this.comp)},t.prototype.setupExpandable=function(){var e=this.columnGroup.getProvidedColumnGroup();this.refreshExpanded(),this.addManagedListener(e,ue.EVENT_EXPANDABLE_CHANGED,this.refreshExpanded.bind(this)),this.addManagedListener(e,ue.EVENT_EXPANDED_CHANGED,this.refreshExpanded.bind(this))},t.prototype.refreshExpanded=function(){var e=this.columnGroup;this.expandable=e.isExpandable();var t=e.isExpanded();this.expandable?this.comp.setAriaExpanded(t?"true":"false"):this.comp.setAriaExpanded(void 0)},t.prototype.addAttributes=function(){this.comp.setColId(this.columnGroup.getUniqueId())},t.prototype.addClasses=function(){var e=this,t=this.columnGroup.getColGroupDef(),o=od.getHeaderClassesFromColDef(t,this.gridOptionsService,null,this.columnGroup);this.columnGroup.isPadding()?(o.push("ag-header-group-cell-no-group"),this.columnGroup.getLeafColumns().every((function(e){return e.isSpanHeaderHeight()}))&&o.push("ag-header-span-height")):o.push("ag-header-group-cell-with-group");o.forEach((function(t){return e.comp.addOrRemoveCssClass(t,!0)}))},t.prototype.setupMovingCss=function(){var e=this,t=this.columnGroup.getProvidedColumnGroup().getLeafColumns(),o=function(){return e.comp.addOrRemoveCssClass("ag-header-cell-moving",e.columnGroup.isMoving())};t.forEach((function(t){e.addManagedListener(t,ce.EVENT_MOVING_CHANGED,o)})),o()},t.prototype.onFocusIn=function(e){if(!this.eGui.contains(e.relatedTarget)){var t=this.getRowIndex();this.beans.focusService.setFocusedHeader(t,this.columnGroup)}},t.prototype.handleKeyDown=function(t){e.prototype.handleKeyDown.call(this,t);var o=this.getWrapperHasFocus();if(this.expandable&&o&&t.key===Hn.ENTER){var n=this.columnGroup,r=!n.isExpanded();this.columnModel.setColumnGroupOpened(n.getProvidedColumnGroup(),r,"uiColumnExpanded")}},t.prototype.setDragSource=function(e){var t=this;if(!this.isSuppressMoving()){var o=this.columnGroup.getProvidedColumnGroup().getLeafColumns(),n=!this.gridOptionsService.is("suppressDragLeaveHidesColumns"),r={type:Di.HeaderCell,eElement:e,defaultIconName:n?Da.ICON_HIDE:Da.ICON_NOT_ALLOWED,dragItemName:this.displayName,getDragItem:this.getDragItemForGroup.bind(this),onDragStarted:function(){return o.forEach((function(e){return e.setMoving(!0,"uiColumnDragged")}))},onDragStopped:function(){return o.forEach((function(e){return e.setMoving(!1,"uiColumnDragged")}))},onGridEnter:function(e){var o;if(n){var r=(null===(o=null===e||void 0===e?void 0:e.columns)||void 0===o?void 0:o.filter((function(e){return!e.getColDef().lockVisible})))||[];t.columnModel.setColumnsVisible(r,!0,"uiColumnMoved")}},onGridExit:function(e){var o;if(n){var r=(null===(o=null===e||void 0===e?void 0:e.columns)||void 0===o?void 0:o.filter((function(e){return!e.getColDef().lockVisible})))||[];t.columnModel.setColumnsVisible(r,!1,"uiColumnMoved")}}};this.dragAndDropService.addDragSource(r,!0),this.addDestroyFunc((function(){return t.dragAndDropService.removeDragSource(r)}))}},t.prototype.getDragItemForGroup=function(){var e=this.columnGroup.getProvidedColumnGroup().getLeafColumns(),t={};e.forEach((function(e){return t[e.getId()]=e.isVisible()}));var o=[];return this.columnModel.getAllDisplayedColumns().forEach((function(t){e.indexOf(t)>=0&&(o.push(t),ye(e,t))})),e.forEach((function(e){return o.push(e)})),{columns:o,visibleState:t}},t.prototype.isSuppressMoving=function(){var e=!1;return this.columnGroup.getLeafColumns().forEach((function(t){(t.getColDef().suppressMovable||t.getColDef().lockPosition)&&(e=!0)})),e||this.gridOptionsService.is("suppressMovableColumns")},Bd([q("columnModel")],t.prototype,"columnModel",void 0),Bd([q("dragAndDropService")],t.prototype,"dragAndDropService",void 0),Bd([q("gridApi")],t.prototype,"gridApi",void 0),Bd([q("columnApi")],t.prototype,"columnApi",void 0),t}(md),$d=function(){var e=function(t,o){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])},e(t,o)};return function(t,o){function n(){this.constructor=t}e(t,o),t.prototype=null===o?Object.create(o):(n.prototype=o.prototype,new n)}}(),Ud=function(e,t,o,n){var r,i=arguments.length,a=i<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,o):n;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)a=Reflect.decorate(e,t,o,n);else for(var s=e.length-1;s>=0;s--)(r=e[s])&&(a=(i<3?r(a):i>3?r(t,o,a):r(t,o))||a);return i>3&&a&&Object.defineProperty(t,o,a),a},Wd=0,qd=function(e){function t(t,o,n){var r=e.call(this)||this;return r.instanceId=Wd++,r.headerCellCtrls={},r.rowIndex=t,r.pinned=o,r.type=n,r}return $d(t,e),t.prototype.getInstanceId=function(){return this.instanceId},t.prototype.setComp=function(e){this.comp=e,this.onRowHeightChanged(),this.onVirtualColumnsChanged(),this.setWidth(),this.addEventListeners(),Eo()&&this.comp.setTransform("translateZ(0)"),e.setAriaRowIndex(this.rowIndex+1)},t.prototype.addEventListeners=function(){this.addManagedListener(this.eventService,$e.EVENT_COLUMN_RESIZED,this.onColumnResized.bind(this)),this.addManagedListener(this.eventService,$e.EVENT_DISPLAYED_COLUMNS_CHANGED,this.onDisplayedColumnsChanged.bind(this)),this.addManagedListener(this.eventService,$e.EVENT_VIRTUAL_COLUMNS_CHANGED,this.onVirtualColumnsChanged.bind(this)),this.addManagedListener(this.eventService,$e.EVENT_COLUMN_HEADER_HEIGHT_CHANGED,this.onRowHeightChanged.bind(this)),this.addManagedListener(this.eventService,$e.EVENT_GRID_STYLES_CHANGED,this.onRowHeightChanged.bind(this)),this.addManagedPropertyListener("domLayout",this.onDisplayedColumnsChanged.bind(this)),this.addManagedPropertyListener("headerHeight",this.onRowHeightChanged.bind(this)),this.addManagedPropertyListener("pivotHeaderHeight",this.onRowHeightChanged.bind(this)),this.addManagedPropertyListener("groupHeaderHeight",this.onRowHeightChanged.bind(this)),this.addManagedPropertyListener("pivotGroupHeaderHeight",this.onRowHeightChanged.bind(this)),this.addManagedPropertyListener("floatingFiltersHeight",this.onRowHeightChanged.bind(this))},t.prototype.getHeaderCellCtrl=function(e){return d(this.headerCellCtrls).find((function(t){return t.getColumnGroupChild()===e}))},t.prototype.onDisplayedColumnsChanged=function(){this.onVirtualColumnsChanged(),this.setWidth(),this.onRowHeightChanged()},t.prototype.getType=function(){return this.type},t.prototype.onColumnResized=function(){this.setWidth()},t.prototype.setWidth=function(){var e=this.getWidthForRow();this.comp.setWidth(e+"px")},t.prototype.getWidthForRow=function(){return this.gridOptionsService.isDomLayout("print")?null!=this.pinned?0:this.columnModel.getContainerWidth("right")+this.columnModel.getContainerWidth("left")+this.columnModel.getContainerWidth(null):this.columnModel.getContainerWidth(this.pinned)},t.prototype.onRowHeightChanged=function(){var e=this.columnModel.getHeaderRowCount(),t=[],o=0;this.columnModel.hasFloatingFilters()&&(e++,o=1);for(var n=this.columnModel.getColumnGroupHeaderRowHeight(),r=this.columnModel.getColumnHeaderRowHeight(),i=e-(1+o),a=0;a<i;a++)t.push(n);t.push(r);for(a=0;a<o;a++)t.push(this.columnModel.getFloatingFiltersHeight());var s=0;for(a=0;a<this.rowIndex;a++)s+=t[a];var l=t[this.rowIndex]+"px";this.comp.setTop(s+"px"),this.comp.setHeight(l)},t.prototype.getPinned=function(){return this.pinned},t.prototype.getRowIndex=function(){return this.rowIndex},t.prototype.onVirtualColumnsChanged=function(){var e=this,t=this.headerCellCtrls;this.headerCellCtrls={},this.getColumnsInViewport().forEach((function(o){if(!o.isEmptyGroup()){var n=o.getUniqueId(),r=t[n];if(delete t[n],r&&r.getColumnGroupChild()!=o&&(e.destroyBean(r),r=void 0),null==r)switch(e.type){case $c.FLOATING_FILTER:r=e.createBean(new Ed(o,e));break;case $c.COLUMN_GROUP:r=e.createBean(new Vd(o,e));break;default:r=e.createBean(new Nd(o,e))}e.headerCellCtrls[n]=r}}));h(t,(function(t,o){var n;(n=o,!!e.focusService.isHeaderWrapperFocused(n)&&e.columnModel.isDisplayed(n.getColumnGroupChild()))?e.headerCellCtrls[t]=o:e.destroyBean(o)}));var o=x(this.headerCellCtrls);this.comp.setHeaderCtrls(o)},t.prototype.getColumnsInViewport=function(){return this.gridOptionsService.isDomLayout("print")?this.getColumnsInViewportPrintLayout():this.getColumnsInViewportNormalLayout()},t.prototype.getColumnsInViewportPrintLayout=function(){var e=this;if(null!=this.pinned)return[];var t=[],o=this.getActualDepth();return["left",null,"right"].forEach((function(n){var r=e.columnModel.getVirtualHeaderGroupRow(n,o);t=t.concat(r)})),t},t.prototype.getActualDepth=function(){return this.type==$c.FLOATING_FILTER?this.rowIndex-1:this.rowIndex},t.prototype.getColumnsInViewportNormalLayout=function(){return this.columnModel.getVirtualHeaderGroupRow(this.pinned,this.getActualDepth())},t.prototype.focusHeader=function(e,t){var o=x(this.headerCellCtrls).find((function(t){return t.getColumnGroupChild()==e}));return!!o&&(o.focus(t),!0)},t.prototype.destroy=function(){var t=this;h(this.headerCellCtrls,(function(e,o){t.destroyBean(o)})),this.headerCellCtrls={},e.prototype.destroy.call(this)},Ud([q("columnModel")],t.prototype,"columnModel",void 0),Ud([q("focusService")],t.prototype,"focusService",void 0),t}(Fe),Kd=function(){var e=function(t,o){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])},e(t,o)};return function(t,o){function n(){this.constructor=t}e(t,o),t.prototype=null===o?Object.create(o):(n.prototype=o.prototype,new n)}}(),Yd=function(e,t,o,n){var r,i=arguments.length,a=i<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,o):n;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)a=Reflect.decorate(e,t,o,n);else for(var s=e.length-1;s>=0;s--)(r=e[s])&&(a=(i<3?r(a):i>3?r(t,o,a):r(t,o))||a);return i>3&&a&&Object.defineProperty(t,o,a),a},Jd=function(e,t){var o="function"===typeof Symbol&&e[Symbol.iterator];if(!o)return e;var n,r,i=o.call(e),a=[];try{for(;(void 0===t||t-- >0)&&!(n=i.next()).done;)a.push(n.value)}catch(s){r={error:s}}finally{try{n&&!n.done&&(o=i.return)&&o.call(i)}finally{if(r)throw r.error}}return a},Xd=function(){for(var e=[],t=0;t<arguments.length;t++)e=e.concat(Jd(arguments[t]));return e},Qd=function(e){function t(t){var o=e.call(this)||this;return o.hidden=!1,o.groupsRowCtrls=[],o.pinned=t,o}return Kd(t,e),t.prototype.setComp=function(e,t){this.comp=e,this.eViewport=t,this.setupCenterWidth(),this.setupPinnedWidth(),this.setupDragAndDrop(this.eViewport),this.addManagedListener(this.eventService,$e.EVENT_GRID_COLUMNS_CHANGED,this.onGridColumnsChanged.bind(this)),this.ctrlsService.registerHeaderContainer(this,this.pinned),this.columnModel.isReady()&&this.refresh()},t.prototype.setupDragAndDrop=function(e){var t=new Zc(this.pinned,e);this.createManagedBean(t)},t.prototype.refresh=function(e){var t=this;void 0===e&&(e=!1);var o=new or,n=this.focusService.getFocusHeaderToUseAfterRefresh();!function(){var e=t.columnModel.getHeaderRowCount()-1;t.groupsRowCtrls=t.destroyBeans(t.groupsRowCtrls);for(var n=0;n<e;n++){var r=t.createBean(new qd(o.next(),t.pinned,$c.COLUMN_GROUP));t.groupsRowCtrls.push(r)}}(),function(){var n=o.next(),r=!t.hidden&&(null==t.columnsRowCtrl||!e||t.columnsRowCtrl.getRowIndex()!==n);(r||t.hidden)&&(t.columnsRowCtrl=t.destroyBean(t.columnsRowCtrl)),r&&(t.columnsRowCtrl=t.createBean(new qd(n,t.pinned,$c.COLUMN)))}(),function(){var n=function(){t.filtersRowCtrl=t.destroyBean(t.filtersRowCtrl)};if(t.columnModel.hasFloatingFilters()&&!t.hidden){var r=o.next();if(t.filtersRowCtrl){var i=t.filtersRowCtrl.getRowIndex()!==r;e&&!i||n()}t.filtersRowCtrl||(t.filtersRowCtrl=t.createBean(new qd(r,t.pinned,$c.FLOATING_FILTER)))}else n()}();var r=this.getAllCtrls();this.comp.setCtrls(r),this.restoreFocusOnHeader(n)},t.prototype.restoreFocusOnHeader=function(e){null!=e&&e.column.getPinned()==this.pinned&&this.focusService.focusHeaderPosition({headerPosition:e})},t.prototype.getAllCtrls=function(){var e=Xd(this.groupsRowCtrls);return this.columnsRowCtrl&&e.push(this.columnsRowCtrl),this.filtersRowCtrl&&e.push(this.filtersRowCtrl),e},t.prototype.onGridColumnsChanged=function(){this.refresh(!0)},t.prototype.setupCenterWidth=function(){var e=this;null==this.pinned&&this.createManagedBean(new dc((function(t){return e.comp.setCenterWidth(t+"px")}),!0))},t.prototype.setHorizontalScroll=function(e){this.comp.setViewportScrollLeft(e)},t.prototype.setupPinnedWidth=function(){var e=this;if(null!=this.pinned){var t="left"===this.pinned,o="right"===this.pinned;this.hidden=!0;var n=function(){var n=t?e.pinnedWidthService.getPinnedLeftWidth():e.pinnedWidthService.getPinnedRightWidth();if(null!=n){var r=0==n,i=e.hidden!==r,a=e.gridOptionsService.is("enableRtl"),s=e.gridOptionsService.getScrollbarWidth(),l=e.scrollVisibleService.isVerticalScrollShowing()&&(a&&t||!a&&o)?n+s:n;e.comp.setPinnedContainerWidth(l+"px"),e.comp.setDisplayed(!r),i&&(e.hidden=r,e.refresh())}};this.addManagedListener(this.eventService,$e.EVENT_LEFT_PINNED_WIDTH_CHANGED,n),this.addManagedListener(this.eventService,$e.EVENT_RIGHT_PINNED_WIDTH_CHANGED,n),this.addManagedListener(this.eventService,$e.EVENT_SCROLL_VISIBILITY_CHANGED,n),this.addManagedListener(this.eventService,$e.EVENT_SCROLLBAR_WIDTH_CHANGED,n)}},t.prototype.getHeaderCtrlForColumn=function(e){if(e instanceof ce){if(!this.columnsRowCtrl)return;return this.columnsRowCtrl.getHeaderCellCtrl(e)}if(0!==this.groupsRowCtrls.length)for(var t=0;t<this.groupsRowCtrls.length;t++){var o=this.groupsRowCtrls[t].getHeaderCellCtrl(e);if(o)return o}},t.prototype.getHtmlElementForColumnHeader=function(e){var t=this.getHeaderCtrlForColumn(e);return t?t.getGui():null},t.prototype.getRowType=function(e){var t=this.getAllCtrls()[e];return t?t.getType():void 0},t.prototype.focusHeader=function(e,t,o){var n=this.getAllCtrls()[e];return!!n&&n.focusHeader(t,o)},t.prototype.getRowCount=function(){return this.groupsRowCtrls.length+(this.columnsRowCtrl?1:0)+(this.filtersRowCtrl?1:0)},t.prototype.destroy=function(){this.filtersRowCtrl&&(this.filtersRowCtrl=this.destroyBean(this.filtersRowCtrl)),this.columnsRowCtrl&&(this.columnsRowCtrl=this.destroyBean(this.columnsRowCtrl)),this.groupsRowCtrls&&this.groupsRowCtrls.length&&(this.groupsRowCtrls=this.destroyBeans(this.groupsRowCtrls)),e.prototype.destroy.call(this)},Yd([q("ctrlsService")],t.prototype,"ctrlsService",void 0),Yd([q("scrollVisibleService")],t.prototype,"scrollVisibleService",void 0),Yd([q("pinnedWidthService")],t.prototype,"pinnedWidthService",void 0),Yd([q("columnModel")],t.prototype,"columnModel",void 0),Yd([q("focusService")],t.prototype,"focusService",void 0),t}(Fe),Zd=function(){var e=function(t,o){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])},e(t,o)};return function(t,o){function n(){this.constructor=t}e(t,o),t.prototype=null===o?Object.create(o):(n.prototype=o.prototype,new n)}}(),eu=function(e,t,o,n){var r,i=arguments.length,a=i<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,o):n;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)a=Reflect.decorate(e,t,o,n);else for(var s=e.length-1;s>=0;s--)(r=e[s])&&(a=(i<3?r(a):i>3?r(t,o,a):r(t,o))||a);return i>3&&a&&Object.defineProperty(t,o,a),a},tu=function(e){function t(t){var o=e.call(this)||this;return o.headerRowComps={},o.rowCompsList=[],o.pinned=t,o}return Zd(t,e),t.prototype.init=function(){var e=this;this.selectAndSetTemplate();var t={setDisplayed:function(t){return e.setDisplayed(t)},setCtrls:function(t){return e.setCtrls(t)},setCenterWidth:function(t){return e.eCenterContainer.style.width=t},setViewportScrollLeft:function(t){return e.getGui().scrollLeft=t},setPinnedContainerWidth:function(t){var o=e.getGui();o.style.width=t,o.style.maxWidth=t,o.style.minWidth=t}};this.createManagedBean(new Qd(this.pinned)).setComp(t,this.getGui())},t.prototype.selectAndSetTemplate=function(){var e="left"==this.pinned,o="right"==this.pinned,n=e?t.PINNED_LEFT_TEMPLATE:o?t.PINNED_RIGHT_TEMPLATE:t.CENTER_TEMPLATE;this.setTemplate(n),this.eRowContainer=this.eCenterContainer?this.eCenterContainer:this.getGui()},t.prototype.destroyRowComps=function(){this.setCtrls([])},t.prototype.destroyRowComp=function(e){this.destroyBean(e),this.eRowContainer.removeChild(e.getGui())},t.prototype.setCtrls=function(e){var t,o=this,n=this.headerRowComps;this.headerRowComps={},this.rowCompsList=[];e.forEach((function(e){var r=e.getInstanceId(),i=n[r];delete n[r];var a=i||o.createBean(new pd(e));o.headerRowComps[r]=a,o.rowCompsList.push(a),function(e){var n=e.getGui();n.parentElement!=o.eRowContainer&&o.eRowContainer.appendChild(n),t&&wn(o.eRowContainer,n,t),t=n}(a)})),x(n).forEach((function(e){return o.destroyRowComp(e)}))},t.PINNED_LEFT_TEMPLATE='<div class="ag-pinned-left-header" role="presentation"></div>',t.PINNED_RIGHT_TEMPLATE='<div class="ag-pinned-right-header" role="presentation"></div>',t.CENTER_TEMPLATE='<div class="ag-header-viewport" role="presentation">\n            <div class="ag-header-container" ref="eCenterContainer" role="rowgroup"></div>\n        </div>',eu([mr("eCenterContainer")],t.prototype,"eCenterContainer",void 0),eu([$],t.prototype,"init",null),eu([U],t.prototype,"destroyRowComps",null),t}(fr),ou=function(){var e=function(t,o){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])},e(t,o)};return function(t,o){function n(){this.constructor=t}e(t,o),t.prototype=null===o?Object.create(o):(n.prototype=o.prototype,new n)}}(),nu=function(e,t,o,n){var r,i=arguments.length,a=i<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,o):n;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)a=Reflect.decorate(e,t,o,n);else for(var s=e.length-1;s>=0;s--)(r=e[s])&&(a=(i<3?r(a):i>3?r(t,o,a):r(t,o))||a);return i>3&&a&&Object.defineProperty(t,o,a),a};!function(e){e[e.UP=0]="UP",e[e.DOWN=1]="DOWN",e[e.LEFT=2]="LEFT",e[e.RIGHT=3]="RIGHT"}(ud||(ud={}));var ru=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return ou(t,e),t.prototype.postConstruct=function(){var e=this;this.ctrlsService.whenReady((function(t){e.gridBodyCon=t.gridBodyCtrl}))},t.prototype.getHeaderRowCount=function(){var e=this.ctrlsService.getHeaderRowContainerCtrl();return e?e.getRowCount():0},t.prototype.navigateVertically=function(e,t,o){if(t||(t=this.focusService.getFocusedHeader()),!t)return!1;var n=t.headerRowIndex,r=t.column,i=this.getHeaderRowCount(),a=e===ud.UP?this.headerPositionUtils.getColumnVisibleParent(r,n):this.headerPositionUtils.getColumnVisibleChild(r,n),s=a.nextRow,l=a.nextFocusColumn,c=!1;return s<0&&(s=0,l=r,c=!0),s>=i&&(s=-1),!(!c&&!l)&&this.focusService.focusHeaderPosition({headerPosition:{headerRowIndex:s,column:l},allowUserOverride:!0,event:o})},t.prototype.navigateHorizontally=function(e,t,o){void 0===t&&(t=!1);var n,r,i=this.focusService.getFocusedHeader();return e===ud.LEFT!==this.gridOptionsService.is("enableRtl")?(r="Before",n=this.headerPositionUtils.findHeader(i,r)):(r="After",n=this.headerPositionUtils.findHeader(i,r)),n||!t?this.focusService.focusHeaderPosition({headerPosition:n,direction:r,fromTab:t,allowUserOverride:!0,event:o}):this.focusNextHeaderRow(i,r,o)},t.prototype.focusNextHeaderRow=function(e,t,o){var n,r=e.headerRowIndex,i=null;return"Before"===t?r>0&&(n=r-1,i=this.headerPositionUtils.findColAtEdgeForHeaderRow(n,"end")):(n=r+1,i=this.headerPositionUtils.findColAtEdgeForHeaderRow(n,"start")),this.focusService.focusHeaderPosition({headerPosition:i,direction:t,fromTab:!0,allowUserOverride:!0,event:o})},t.prototype.scrollToColumn=function(e,t){if(void 0===t&&(t="After"),!e.getPinned()){var o;if(e instanceof ct){var n=e.getDisplayedLeafColumns();o="Before"===t?fe(n):n[0]}else o=e;this.gridBodyCon.getScrollFeature().ensureColumnVisible(o)}},nu([q("focusService")],t.prototype,"focusService",void 0),nu([q("headerPositionUtils")],t.prototype,"headerPositionUtils",void 0),nu([q("ctrlsService")],t.prototype,"ctrlsService",void 0),nu([$],t.prototype,"postConstruct",null),t=nu([W("headerNavigationService")],t)}(Fe),iu=function(){var e=function(t,o){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])},e(t,o)};return function(t,o){function n(){this.constructor=t}e(t,o),t.prototype=null===o?Object.create(o):(n.prototype=o.prototype,new n)}}(),au=function(e,t,o,n){var r,i=arguments.length,a=i<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,o):n;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)a=Reflect.decorate(e,t,o,n);else for(var s=e.length-1;s>=0;s--)(r=e[s])&&(a=(i<3?r(a):i>3?r(t,o,a):r(t,o))||a);return i>3&&a&&Object.defineProperty(t,o,a),a},su=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return iu(t,e),t.prototype.setComp=function(e,t,o){this.comp=e,this.eGui=t,this.createManagedBean(new Ar(o,{onTabKeyDown:this.onTabKeyDown.bind(this),handleKeyDown:this.handleKeyDown.bind(this),onFocusOut:this.onFocusOut.bind(this)})),this.addManagedListener(this.eventService,$e.EVENT_COLUMN_PIVOT_MODE_CHANGED,this.onPivotModeChanged.bind(this)),this.addManagedListener(this.eventService,$e.EVENT_DISPLAYED_COLUMNS_CHANGED,this.onDisplayedColumnsChanged.bind(this)),this.onPivotModeChanged(),this.setupHeaderHeight(),this.ctrlsService.registerGridHeaderCtrl(this)},t.prototype.setupHeaderHeight=function(){var e=this.setHeaderHeight.bind(this);e(),this.addManagedPropertyListener("headerHeight",e),this.addManagedPropertyListener("pivotHeaderHeight",e),this.addManagedPropertyListener("groupHeaderHeight",e),this.addManagedPropertyListener("pivotGroupHeaderHeight",e),this.addManagedPropertyListener("floatingFiltersHeight",e),this.addManagedListener(this.eventService,$e.EVENT_DISPLAYED_COLUMNS_CHANGED,e),this.addManagedListener(this.eventService,$e.EVENT_COLUMN_HEADER_HEIGHT_CHANGED,e),this.addManagedListener(this.eventService,$e.EVENT_GRID_STYLES_CHANGED,e)},t.prototype.getHeaderHeight=function(){return this.headerHeight},t.prototype.setHeaderHeight=function(){var e,t=this.columnModel,o=0,n=t.getHeaderRowCount();t.hasFloatingFilters()&&(n++,o=1);var r=this.columnModel.getColumnGroupHeaderRowHeight(),i=this.columnModel.getColumnHeaderRowHeight(),a=n-(1+o);if(e=o*t.getFloatingFiltersHeight(),e+=a*r,e+=i,this.headerHeight!==e){this.headerHeight=e;var s=e+1+"px";this.comp.setHeightAndMinHeight(s),this.eventService.dispatchEvent({type:$e.EVENT_HEADER_HEIGHT_CHANGED})}},t.prototype.onPivotModeChanged=function(){var e=this.columnModel.isPivotMode();this.comp.addOrRemoveCssClass("ag-pivot-on",e),this.comp.addOrRemoveCssClass("ag-pivot-off",!e)},t.prototype.onDisplayedColumnsChanged=function(){var e=this.columnModel.getAllDisplayedColumns().some((function(e){return e.isSpanHeaderHeight()}));this.comp.addOrRemoveCssClass("ag-header-allow-overflow",e)},t.prototype.onTabKeyDown=function(e){var t=this.gridOptionsService.is("enableRtl"),o=e.shiftKey!==t?ud.LEFT:ud.RIGHT;(this.headerNavigationService.navigateHorizontally(o,!0,e)||this.focusService.focusNextGridCoreContainer(e.shiftKey))&&e.preventDefault()},t.prototype.handleKeyDown=function(e){var t=null;switch(e.key){case Hn.LEFT:t=ud.LEFT;case Hn.RIGHT:r(t)||(t=ud.RIGHT),this.headerNavigationService.navigateHorizontally(t,!1,e);break;case Hn.UP:t=ud.UP;case Hn.DOWN:r(t)||(t=ud.DOWN),this.headerNavigationService.navigateVertically(t,null,e)&&e.preventDefault();break;default:return}},t.prototype.onFocusOut=function(e){var t=this.gridOptionsService.getDocument(),o=e.relatedTarget;!o&&this.eGui.contains(t.activeElement)||this.eGui.contains(o)||this.focusService.clearFocusedHeader()},au([q("headerNavigationService")],t.prototype,"headerNavigationService",void 0),au([q("focusService")],t.prototype,"focusService",void 0),au([q("columnModel")],t.prototype,"columnModel",void 0),au([q("ctrlsService")],t.prototype,"ctrlsService",void 0),t}(Fe),lu=function(){var e=function(t,o){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])},e(t,o)};return function(t,o){function n(){this.constructor=t}e(t,o),t.prototype=null===o?Object.create(o):(n.prototype=o.prototype,new n)}}(),cu=function(e,t,o,n){var r,i=arguments.length,a=i<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,o):n;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)a=Reflect.decorate(e,t,o,n);else for(var s=e.length-1;s>=0;s--)(r=e[s])&&(a=(i<3?r(a):i>3?r(t,o,a):r(t,o))||a);return i>3&&a&&Object.defineProperty(t,o,a),a},du=function(e){function t(){return e.call(this,t.TEMPLATE)||this}return lu(t,e),t.prototype.postConstruct=function(){var e=this,t={addOrRemoveCssClass:function(t,o){return e.addOrRemoveCssClass(t,o)},setHeightAndMinHeight:function(t){e.getGui().style.height=t,e.getGui().style.minHeight=t}};this.createManagedBean(new su).setComp(t,this.getGui(),this.getFocusableElement());var o=function(t){e.createManagedBean(t),e.appendChild(t)};o(new tu("left")),o(new tu(null)),o(new tu("right"))},t.TEMPLATE='<div class="ag-header" role="presentation"/>',cu([$],t.prototype,"postConstruct",null),t}(fr),uu=function(){var e=function(t,o){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])},e(t,o)};return function(t,o){function n(){this.constructor=t}e(t,o),t.prototype=null===o?Object.create(o):(n.prototype=o.prototype,new n)}}(),pu=function(e,t,o,n){var r,i=arguments.length,a=i<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,o):n;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)a=Reflect.decorate(e,t,o,n);else for(var s=e.length-1;s>=0;s--)(r=e[s])&&(a=(i<3?r(a):i>3?r(t,o,a):r(t,o))||a);return i>3&&a&&Object.defineProperty(t,o,a),a},hu=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return uu(t,e),t.prototype.addResizeBar=function(e){var t=this,o={dragStartPixels:e.dragStartPixels||0,eElement:e.eResizeBar,onDragStart:this.onDragStart.bind(this,e),onDragStop:this.onDragStop.bind(this,e),onDragging:this.onDragging.bind(this,e)};this.dragService.addDragSource(o,!0);return function(){return t.dragService.removeDragSource(o)}},t.prototype.onDragStart=function(e,t){this.dragStartX=t.clientX,this.setResizeIcons();var o=t instanceof MouseEvent&&!0===t.shiftKey;e.onResizeStart(o)},t.prototype.setResizeIcons=function(){var e=this.ctrlsService.getGridCtrl();e.setResizeCursor(!0),e.disableUserSelect(!0)},t.prototype.onDragStop=function(e,t){e.onResizeEnd(this.resizeAmount),this.resetIcons()},t.prototype.resetIcons=function(){var e=this.ctrlsService.getGridCtrl();e.setResizeCursor(!1),e.disableUserSelect(!1)},t.prototype.onDragging=function(e,t){this.resizeAmount=t.clientX-this.dragStartX,e.onResizing(this.resizeAmount)},pu([q("dragService")],t.prototype,"dragService",void 0),pu([q("ctrlsService")],t.prototype,"ctrlsService",void 0),t=pu([W("horizontalResizeService")],t)}(Fe),fu=function(){var e=function(t,o){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])},e(t,o)};return function(t,o){function n(){this.constructor=t}e(t,o),t.prototype=null===o?Object.create(o):(n.prototype=o.prototype,new n)}}(),gu=function(e,t,o,n){var r,i=arguments.length,a=i<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,o):n;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)a=Reflect.decorate(e,t,o,n);else for(var s=e.length-1;s>=0;s--)(r=e[s])&&(a=(i<3?r(a):i>3?r(t,o,a):r(t,o))||a);return i>3&&a&&Object.defineProperty(t,o,a),a},mu=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return fu(t,e),t.prototype.hideActiveMenu=function(){this.hidePopup&&this.hidePopup()},t.prototype.showMenuAfterMouseEvent=function(e,t){var o=this;this.showPopup(e,(function(n){o.popupService.positionPopupUnderMouseEvent({column:e,type:"columnMenu",mouseEvent:t,ePopup:n})}),"columnMenu",t.target)},t.prototype.showMenuAfterButtonClick=function(e,t,o){var n=this;this.showPopup(e,(function(r){n.popupService.positionPopupByComponent({type:o,eventSource:t,ePopup:r,keepWithinBounds:!0,position:"under",column:e})}),o,t)},t.prototype.showPopup=function(e,t,o,n){var r=this,i=this.filterManager.getOrCreateFilterWrapper(e,"COLUMN_MENU");if(!i)throw new Error("AG Grid - unable to show popup filter, filter instantiation failed");var a,s=document.createElement("div");$t(s,"presentation"),s.classList.add("ag-menu"),this.tabListener=this.addManagedListener(s,"keydown",(function(e){return r.trapFocusWithin(e,s)})),i.guiPromise.then((function(e){return s.appendChild(e)}));var l=n||this.ctrlsService.getGridBodyCtrl().getGui(),c=this.localeService.getLocaleTextFunc(),d=this.popupService.addPopup({modal:!0,eChild:s,closeOnEsc:!0,closedCallback:function(t){e.setMenuVisible(!1,"contextMenu");var o=t instanceof KeyboardEvent;if(r.tabListener&&(r.tabListener=r.tabListener()),o&&n&&yn(n)){var a=r.focusService.findTabbableParent(n);a&&a.focus()}!function(){var e;null===(e=i.filterPromise)||void 0===e||e.then((function(e){var t;return null===(t=null===e||void 0===e?void 0:e.afterGuiDetached)||void 0===t?void 0:t.call(e)}))}()},positionCallback:function(){return t(s)},anchorToElement:l,ariaLabel:c("ariaLabelColumnMenu","Column Menu")});d&&(this.hidePopup=a=d.hideFunc),i.filterPromise.then((function(e){t(s),e.afterGuiAttached&&e.afterGuiAttached({container:o,hidePopup:a})})),e.setMenuVisible(!0,"contextMenu")},t.prototype.trapFocusWithin=function(e,t){e.key!==Hn.TAB||e.defaultPrevented||this.focusService.findNextFocusableElement(t,!1,e.shiftKey)||(e.preventDefault(),this.focusService.focusInto(t,e.shiftKey))},t.prototype.isMenuEnabled=function(e){return e.isFilterAllowed()&&e.getMenuTabs(["filterMenuTab"]).includes("filterMenuTab")},gu([q("filterManager")],t.prototype,"filterManager",void 0),gu([q("popupService")],t.prototype,"popupService",void 0),gu([q("focusService")],t.prototype,"focusService",void 0),gu([q("ctrlsService")],t.prototype,"ctrlsService",void 0),t=gu([W("menuFactory")],t)}(Fe),yu=function(){var e=function(t,o){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])},e(t,o)};return function(t,o){function n(){this.constructor=t}e(t,o),t.prototype=null===o?Object.create(o):(n.prototype=o.prototype,new n)}}(),vu=function(e,t,o,n){var r,i=arguments.length,a=i<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,o):n;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)a=Reflect.decorate(e,t,o,n);else for(var s=e.length-1;s>=0;s--)(r=e[s])&&(a=(i<3?r(a):i>3?r(t,o,a):r(t,o))||a);return i>3&&a&&Object.defineProperty(t,o,a),a},bu=function(e){function t(o){var n=e.call(this,t.getTemplate(o.cssClass))||this;return n.items=[],n.tabbedItemScrollMap=new Map,n.params=o,o.items&&o.items.forEach((function(e){return n.addItem(e)})),n}return yu(t,e),t.prototype.postConstruct=function(){var e=this;this.createManagedBean(new Ar(this.getFocusableElement(),{onTabKeyDown:this.onTabKeyDown.bind(this),handleKeyDown:this.handleKeyDown.bind(this)})),this.addDestroyFunc((function(){var t,o,n;return null===(n=null===(o=null===(t=e.activeItem)||void 0===t?void 0:t.tabbedItem)||void 0===o?void 0:o.afterDetachedCallback)||void 0===n?void 0:n.call(o)}))},t.getTemplate=function(e){return'<div class="ag-tabs '+e+'">\n            <div ref="eHeader" role="tablist" class="ag-tabs-header '+(e?e+"-header":"")+'"></div>\n            <div ref="eBody" role="presentation" class="ag-tabs-body '+(e?e+"-body":"")+'"></div>\n        </div>'},t.prototype.handleKeyDown=function(e){var t=this.gridOptionsService.getDocument();switch(e.key){case Hn.RIGHT:case Hn.LEFT:if(!this.eHeader.contains(t.activeElement))return;var o=e.key===Hn.RIGHT,n=this.gridOptionsService.is("enableRtl"),r=this.items.indexOf(this.activeItem),i=o!==n?Math.min(r+1,this.items.length-1):Math.max(r-1,0);if(r===i)return;e.preventDefault();var a=this.items[i];this.showItemWrapper(a),a.eHeaderButton.focus();break;case Hn.UP:case Hn.DOWN:e.stopPropagation()}},t.prototype.onTabKeyDown=function(e){if(!e.defaultPrevented){var t=this,o=t.focusService,n=t.eHeader,r=t.eBody,i=t.activeItem,a=this.gridOptionsService.getDocument().activeElement,s=e.target;if(e.preventDefault(),n.contains(a))o.focusInto(r,e.shiftKey);else{var l=null;o.isTargetUnderManagedComponent(r,s)&&(e.shiftKey&&(l=this.focusService.findFocusableElementBeforeTabGuard(r,s)),l||(l=i.eHeaderButton)),!l&&r.contains(a)&&((l=o.findNextFocusableElement(r,!1,e.shiftKey))||(l=i.eHeaderButton)),l&&l.focus()}}},t.prototype.setAfterAttachedParams=function(e){this.afterAttachedParams=e},t.prototype.showFirstItem=function(){this.items.length>0&&this.showItemWrapper(this.items[0])},t.prototype.addItem=function(e){var t=document.createElement("span");$t(t,"tab"),t.setAttribute("tabIndex","-1"),t.appendChild(e.title),t.classList.add("ag-tab"),this.eHeader.appendChild(t),Kt(t,e.titleLabel);var o={tabbedItem:e,eHeaderButton:t};this.items.push(o),t.addEventListener("click",this.showItemWrapper.bind(this,o))},t.prototype.showItem=function(e){var t=this.items.find((function(t){return t.tabbedItem===e}));t&&this.showItemWrapper(t)},t.prototype.showItemWrapper=function(e){var t,o,n=this,r=e.tabbedItem,i=e.eHeaderButton;this.params.onItemClicked&&this.params.onItemClicked({item:r}),this.activeItem!==e?(this.lastScrollListener&&(this.lastScrollListener=this.lastScrollListener()),gn(this.eBody),r.bodyPromise.then((function(e){n.eBody.appendChild(e);var t=!n.focusService.isKeyboardMode();if(n.focusService.focusInto(n.eBody,!1,t),r.afterAttachedCallback&&r.afterAttachedCallback(n.afterAttachedParams),n.params.keepScrollPosition){var o=r.getScrollableContainer&&r.getScrollableContainer()||e;n.lastScrollListener=n.addManagedListener(o,"scroll",(function(){n.tabbedItemScrollMap.set(r.name,o.scrollTop)}));var i=n.tabbedItemScrollMap.get(r.name);void 0!==i&&setTimeout((function(){o.scrollTop=i}),0)}})),this.activeItem&&(this.activeItem.eHeaderButton.classList.remove("ag-tab-selected"),null===(o=(t=this.activeItem.tabbedItem).afterDetachedCallback)||void 0===o||o.call(t)),i.classList.add("ag-tab-selected"),this.activeItem=e):F(this.params.onActiveItemClicked)},vu([q("focusService")],t.prototype,"focusService",void 0),vu([mr("eHeader")],t.prototype,"eHeader",void 0),vu([mr("eBody")],t.prototype,"eBody",void 0),vu([$],t.prototype,"postConstruct",null),t}(fr);function xu(e){return j((function(){return console.warn("AG Grid: Since v29 simpleHttpRequest has been deprecated as it was only meant for use in internal AG Grid documentation examples. Please use the browser fetch api directly.")}),"simpleHttpRequest"),new rr((function(t){var o=new XMLHttpRequest;o.open("GET",e.url),o.send(),o.onreadystatechange=function(){4===o.readyState&&200===o.status&&t(JSON.parse(o.responseText))}}))}var wu,Cu=function(){var e=function(t,o){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])},e(t,o)};return function(t,o){function n(){this.constructor=t}e(t,o),t.prototype=null===o?Object.create(o):(n.prototype=o.prototype,new n)}}(),_u=function(e,t,o,n){var r,i=arguments.length,a=i<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,o):n;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)a=Reflect.decorate(e,t,o,n);else for(var s=e.length-1;s>=0;s--)(r=e[s])&&(a=(i<3?r(a):i>3?r(t,o,a):r(t,o))||a);return i>3&&a&&Object.defineProperty(t,o,a),a},Su=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.polyfillFunctions=[],t}return Cu(t,e),t.prototype.observeResize=function(e,t){var o=this,n=this.gridOptionsService.getDocument().defaultView||window,r=this.gridOptionsService.is("suppressBrowserResizeObserver");return!!n.ResizeObserver&&!r?function(){var o=new n.ResizeObserver(t);return o.observe(e),function(){return o.disconnect()}}():function(){var n=xn(e),r=bn(e),i=!0,a=function(){if(i){var s=xn(e),l=bn(e);(s!==n||l!==r)&&(n=s,r=l,t()),o.doNextPolyfillTurn(a)}};return a(),function(){return i=!1}}()},t.prototype.doNextPolyfillTurn=function(e){this.polyfillFunctions.push(e),this.schedulePolyfill()},t.prototype.schedulePolyfill=function(){var e=this;if(!this.polyfillScheduled){this.polyfillScheduled=!0,this.getFrameworkOverrides().setTimeout((function(){var t=e.polyfillFunctions;e.polyfillScheduled=!1,e.polyfillFunctions=[],t.forEach((function(e){return e()}))}),50)}},t=_u([W("resizeObserverService")],t)}(Fe),Eu=function(){var e=function(t,o){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])},e(t,o)};return function(t,o){function n(){this.constructor=t}e(t,o),t.prototype=null===o?Object.create(o):(n.prototype=o.prototype,new n)}}(),ku=function(e,t,o,n){var r,i=arguments.length,a=i<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,o):n;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)a=Reflect.decorate(e,t,o,n);else for(var s=e.length-1;s>=0;s--)(r=e[s])&&(a=(i<3?r(a):i>3?r(t,o,a):r(t,o))||a);return i>3&&a&&Object.defineProperty(t,o,a),a},ju=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.createTasksP1={list:[],sorted:!1},t.createTasksP2={list:[],sorted:!1},t.destroyTasks=[],t.ticking=!1,t.scrollGoingDown=!0,t.lastPage=0,t.lastScrollTop=0,t.taskCount=0,t.cancelledTasks=new Set,t}return Eu(t,e),t.prototype.setScrollTop=function(e){var t=this.gridOptionsService.is("pagination");if(this.scrollGoingDown=e>=this.lastScrollTop,t&&0===e){var o=this.paginationProxy.getCurrentPage();o!==this.lastPage&&(this.lastPage=o,this.scrollGoingDown=!0)}this.lastScrollTop=e},t.prototype.init=function(){this.useAnimationFrame=!this.gridOptionsService.is("suppressAnimationFrame")},t.prototype.isOn=function(){return this.useAnimationFrame},t.prototype.verifyAnimationFrameOn=function(e){!1===this.useAnimationFrame&&console.warn("AG Grid: AnimationFrameService."+e+" called but animation frames are off")},t.prototype.createTask=function(e,t,o){this.verifyAnimationFrameOn(o);var n={task:e,index:t,createOrder:++this.taskCount};this.addTaskToList(this[o],n),this.schedule()},t.prototype.cancelTask=function(e){this.cancelledTasks.add(e)},t.prototype.addTaskToList=function(e,t){e.list.push(t),e.sorted=!1},t.prototype.sortTaskList=function(e){if(!e.sorted){var t=this.scrollGoingDown?1:-1;e.list.sort((function(e,o){return e.index!==o.index?t*(o.index-e.index):o.createOrder-e.createOrder})),e.sorted=!0}},t.prototype.addDestroyTask=function(e){this.verifyAnimationFrameOn("createTasksP3"),this.destroyTasks.push(e),this.schedule()},t.prototype.executeFrame=function(e){this.verifyAnimationFrameOn("executeFrame");for(var t=this.createTasksP1,o=t.list,n=this.createTasksP2,r=n.list,i=this.destroyTasks,a=(new Date).getTime(),s=(new Date).getTime()-a,l=e<=0,c=this.ctrlsService.getGridBodyCtrl();l||s<e;){if(!c.getScrollFeature().scrollGridIfNeeded()){var d=void 0;if(o.length)this.sortTaskList(t),d=o.pop().task;else if(r.length)this.sortTaskList(n),d=r.pop().task;else{if(!i.length){this.cancelledTasks.clear();break}d=i.pop()}this.cancelledTasks.has(d)||d()}s=(new Date).getTime()-a}o.length||r.length||i.length?this.requestFrame():this.stopTicking()},t.prototype.stopTicking=function(){this.ticking=!1},t.prototype.flushAllFrames=function(){this.useAnimationFrame&&this.executeFrame(-1)},t.prototype.schedule=function(){this.useAnimationFrame&&(this.ticking||(this.ticking=!0,this.requestFrame()))},t.prototype.requestFrame=function(){var e=this.executeFrame.bind(this,60),t=this.gridOptionsService.getDocument().defaultView||window;t.requestAnimationFrame?t.requestAnimationFrame(e):t.webkitRequestAnimationFrame?t.webkitRequestAnimationFrame(e):t.setTimeout(e,0)},t.prototype.isQueueEmpty=function(){return!this.ticking},t.prototype.debounce=function(e){var t=this,o=!1;return function(){t.isOn()?o||(o=!0,t.addDestroyTask((function(){o=!1,e()}))):t.getFrameworkOverrides().setTimeout(e,0)}},ku([q("ctrlsService")],t.prototype,"ctrlsService",void 0),ku([q("paginationProxy")],t.prototype,"paginationProxy",void 0),ku([$],t.prototype,"init",null),t=ku([W("animationFrameService")],t)}(Fe),Au=function(){var e=function(t,o){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])},e(t,o)};return function(t,o){function n(){this.constructor=t}e(t,o),t.prototype=null===o?Object.create(o):(n.prototype=o.prototype,new n)}}(),Ru=function(e,t,o,n){var r,i=arguments.length,a=i<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,o):n;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)a=Reflect.decorate(e,t,o,n);else for(var s=e.length-1;s>=0;s--)(r=e[s])&&(a=(i<3?r(a):i>3?r(t,o,a):r(t,o))||a);return i>3&&a&&Object.defineProperty(t,o,a),a},Ou=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Au(t,e),t.prototype.postConstruct=function(){var e=this;this.ctrlsService.whenReady((function(t){e.centerRowContainerCtrl=t.centerRowContainerCtrl}))},t.prototype.getPreferredWidthForColumn=function(e,t){var o=this.getHeaderCellForColumn(e);if(!o)return-1;var n=this.rowRenderer.getAllCellsForColumn(e);return t||n.push(o),this.addElementsToContainerAndGetWidth(n)},t.prototype.getPreferredWidthForColumnGroup=function(e){var t=this.getHeaderCellForColumn(e);return t?this.addElementsToContainerAndGetWidth([t]):-1},t.prototype.addElementsToContainerAndGetWidth=function(e){var t=this,o=document.createElement("form");o.style.position="fixed";var n=this.centerRowContainerCtrl.getContainerElement();n.appendChild(o),e.forEach((function(e){return t.cloneItemIntoDummy(e,o)}));var r=o.offsetWidth;return n.removeChild(o),r+this.getAutoSizePadding()},t.prototype.getAutoSizePadding=function(){var e=this.gridOptionsService.getNum("autoSizePadding");return null!=e&&e>=0?e:20},t.prototype.getHeaderCellForColumn=function(e){var t=null;return this.ctrlsService.getHeaderRowContainerCtrls().forEach((function(o){var n=o.getHtmlElementForColumnHeader(e);null!=n&&(t=n)})),t},t.prototype.cloneItemIntoDummy=function(e,t){var o=e.cloneNode(!0);o.style.width="",o.style.position="static",o.style.left="";var n=document.createElement("div"),r=n.classList;["ag-header-cell","ag-header-group-cell"].some((function(e){return o.classList.contains(e)}))?(r.add("ag-header","ag-header-row"),n.style.position="static"):r.add("ag-row");for(var i=e.parentElement;i;){if(["ag-header-row","ag-row"].some((function(e){return i.classList.contains(e)}))){for(var a=0;a<i.classList.length;a++){var s=i.classList[a];"ag-row-position-absolute"!=s&&r.add(s)}break}i=i.parentElement}n.appendChild(o),t.appendChild(n)},Ru([q("rowRenderer")],t.prototype,"rowRenderer",void 0),Ru([q("ctrlsService")],t.prototype,"ctrlsService",void 0),Ru([q("rowCssClassCalculator")],t.prototype,"rowCssClassCalculator",void 0),Ru([$],t.prototype,"postConstruct",null),t=Ru([W("autoWidthCalculator")],t)}(Fe),Tu=function(){var e=function(t,o){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])},e(t,o)};return function(t,o){function n(){this.constructor=t}e(t,o),t.prototype=null===o?Object.create(o):(n.prototype=o.prototype,new n)}}(),Du=function(e,t,o,n){var r,i=arguments.length,a=i<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,o):n;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)a=Reflect.decorate(e,t,o,n);else for(var s=e.length-1;s>=0;s--)(r=e[s])&&(a=(i<3?r(a):i>3?r(t,o,a):r(t,o))||a);return i>3&&a&&Object.defineProperty(t,o,a),a},Pu=function(e){var t="function"===typeof Symbol&&Symbol.iterator,o=t&&e[t],n=0;if(o)return o.call(e);if(e&&"number"===typeof e.length)return{next:function(){return e&&n>=e.length&&(e=void 0),{value:e&&e[n++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")},Nu=function(e,t){var o="function"===typeof Symbol&&e[Symbol.iterator];if(!o)return e;var n,r,i=o.call(e),a=[];try{for(;(void 0===t||t-- >0)&&!(n=i.next()).done;)a.push(n.value)}catch(s){r={error:s}}finally{try{n&&!n.done&&(o=i.return)&&o.call(i)}finally{if(r)throw r.error}}return a},Iu=function(){for(var e=[],t=0;t<arguments.length;t++)e=e.concat(Nu(arguments[t]));return e},Mu=function(e){function t(t,o){var n=e.call(this)||this;return n.createRowCon=t,n.destroyRowCtrls=o,n.stickyRowCtrls=[],n.containerHeight=0,n}return Tu(t,e),t.prototype.postConstruct=function(){var e=this;this.isClientSide="clientSide"===this.rowModel.getType(),this.ctrlsService.whenReady((function(t){e.gridBodyCtrl=t.gridBodyCtrl}))},t.prototype.getStickyRowCtrls=function(){return this.stickyRowCtrls},t.prototype.checkStickyRows=function(){var e=this,t=0;if(this.gridOptionsService.is("groupRowsSticky")){for(var o=[],n=this.rowRenderer.getFirstVisibleVerticalPixel(),r=function(r){var i,a,s,l;if(o.push(r),e.isClientSide){for(var c=r;c.expanded;)if(c.master)c=c.detailNode;else if(c.childrenAfterSort){if(0===c.childrenAfterSort.length)break;c=fe(c.childrenAfterSort)}l=c.rowTop+c.rowHeight}else{var d=null===(i=r.childStore)||void 0===i?void 0:i.getStoreBounds();l=(null!==(a=null===d||void 0===d?void 0:d.heightPx)&&void 0!==a?a:0)+(null!==(s=null===d||void 0===d?void 0:d.topPx)&&void 0!==s?s:0)}var u=n+t+r.rowHeight;r.stickyRowTop=l<u?t+(l-u):t,t=0,o.forEach((function(e){var o=e.stickyRowTop+e.rowHeight;t<o&&(t=o)}))};;){var i=n+t,a=this.rowModel.getRowIndexAtPixel(i),s=this.rowModel.getRow(a);if(null==s)break;if(s.level<0)break;for(var l=[],c=s.parent;c.level>=0;)l.push(c),c=c.parent;var d=l.reverse().find((function(e){return o.indexOf(e)<0&&e.displayed}));if(d)r(d);else{if(!(s.isExpandable()&&s.expanded&&s.rowTop<i))break;r(s)}}this.refreshNodesAndContainerHeight(o,t)}else this.refreshNodesAndContainerHeight([],t)},t.prototype.refreshStickyNode=function(e){for(var t=[],o=0;o<this.stickyRowCtrls.length;o++){var n=this.stickyRowCtrls[o].getRowNode();n!==e&&t.push(n)}this.refreshNodesAndContainerHeight(t,this.containerHeight),this.checkStickyRows()},t.prototype.refreshNodesAndContainerHeight=function(e,t){var o,n,r,i=this,a=this.stickyRowCtrls.filter((function(t){return-1===e.indexOf(t.getRowNode())})),s=e.filter((function(e){return-1===i.stickyRowCtrls.findIndex((function(t){return t.getRowNode()===e}))})),l={};a.forEach((function(e){l[e.getRowNode().id]=e,i.stickyRowCtrls=i.stickyRowCtrls.filter((function(t){return t!==e}))}));try{for(var c=Pu(Object.values(l)),d=c.next();!d.done;d=c.next()){d.value.getRowNode().sticky=!1}}catch(p){o={error:p}}finally{try{d&&!d.done&&(n=c.return)&&n.call(c)}finally{if(o)throw o.error}}this.destroyRowCtrls(l,!1);var u=s.map((function(e){return e.sticky=!0,i.createRowCon(e,!1,!1)}));(r=this.stickyRowCtrls).push.apply(r,Iu(u)),this.stickyRowCtrls.forEach((function(e){return e.setRowTop(e.getRowNode().stickyRowTop)})),this.stickyRowCtrls.sort((function(e,t){return t.getRowNode().rowIndex-e.getRowNode().rowIndex})),this.containerHeight!==t&&(this.containerHeight=t,this.gridBodyCtrl.setStickyTopHeight(t))},Du([q("rowModel")],t.prototype,"rowModel",void 0),Du([q("rowRenderer")],t.prototype,"rowRenderer",void 0),Du([q("ctrlsService")],t.prototype,"ctrlsService",void 0),Du([$],t.prototype,"postConstruct",null),t}(Fe),Lu=function(){var e=function(t,o){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])},e(t,o)};return function(t,o){function n(){this.constructor=t}e(t,o),t.prototype=null===o?Object.create(o):(n.prototype=o.prototype,new n)}}(),Fu=function(e,t,o,n){var r,i=arguments.length,a=i<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,o):n;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)a=Reflect.decorate(e,t,o,n);else for(var s=e.length-1;s>=0;s--)(r=e[s])&&(a=(i<3?r(a):i>3?r(t,o,a):r(t,o))||a);return i>3&&a&&Object.defineProperty(t,o,a),a},Gu=function(e,t){var o="function"===typeof Symbol&&e[Symbol.iterator];if(!o)return e;var n,r,i=o.call(e),a=[];try{for(;(void 0===t||t-- >0)&&!(n=i.next()).done;)a.push(n.value)}catch(s){r={error:s}}finally{try{n&&!n.done&&(o=i.return)&&o.call(i)}finally{if(r)throw r.error}}return a},zu=function(){for(var e=[],t=0;t<arguments.length;t++)e=e.concat(Gu(arguments[t]));return e},Hu=function(e){var t="function"===typeof Symbol&&Symbol.iterator,o=t&&e[t],n=0;if(o)return o.call(e);if(e&&"number"===typeof e.length)return{next:function(){return e&&n>=e.length&&(e=void 0),{value:e&&e[n++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")},Bu=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.destroyFuncsForColumnListeners=[],t.rowCtrlsByRowIndex={},t.zombieRowCtrls={},t.allRowCtrls=[],t.topRowCtrls=[],t.bottomRowCtrls=[],t.refreshInProgress=!1,t.dataFirstRenderedFired=!1,t}return Lu(t,e),t.prototype.postConstruct=function(){var e=this;this.ctrlsService.whenReady((function(){e.gridBodyCtrl=e.ctrlsService.getGridBodyCtrl(),e.initialise()}))},t.prototype.initialise=function(){if(this.addManagedListener(this.eventService,$e.EVENT_PAGINATION_CHANGED,this.onPageLoaded.bind(this)),this.addManagedListener(this.eventService,$e.EVENT_PINNED_ROW_DATA_CHANGED,this.onPinnedRowDataChanged.bind(this)),this.addManagedListener(this.eventService,$e.EVENT_DISPLAYED_COLUMNS_CHANGED,this.onDisplayedColumnsChanged.bind(this)),this.addManagedListener(this.eventService,$e.EVENT_BODY_SCROLL,this.onBodyScroll.bind(this)),this.addManagedListener(this.eventService,$e.EVENT_BODY_HEIGHT_CHANGED,this.redrawAfterScroll.bind(this)),this.addManagedPropertyListener("domLayout",this.onDomLayoutChanged.bind(this)),this.addManagedPropertyListener("rowClass",this.redrawRows.bind(this)),this.gridOptionsService.is("groupRowsSticky")){var e=this.rowModel.getType();"clientSide"!=e&&"serverSide"!=e?j((function(){return console.warn("AG Grid: The feature Sticky Row Groups only works with the Client Side or Server Side Row Model")}),"rowRenderer.stickyWorksWithCsrmOnly"):this.stickyRowFeature=this.createManagedBean(new Mu(this.createRowCon.bind(this),this.destroyRowCtrls.bind(this)))}this.registerCellEventListeners(),this.initialiseCache(),this.printLayout=this.gridOptionsService.isDomLayout("print"),this.embedFullWidthRows=this.printLayout||this.gridOptionsService.is("embedFullWidthRows"),this.redrawAfterModelUpdate()},t.prototype.initialiseCache=function(){if(this.gridOptionsService.is("keepDetailRows")){var e=this.getKeepDetailRowsCount(),t=null!=e?e:3;this.cachedRowCtrls=new Vu(t)}},t.prototype.getKeepDetailRowsCount=function(){var e=this.gridOptionsService.getNum("keepDetailRowsCount");return r(e)&&e>0?e:10},t.prototype.getRowCtrls=function(){return this.allRowCtrls},t.prototype.getStickyTopRowCtrls=function(){return this.stickyRowFeature?this.stickyRowFeature.getStickyRowCtrls():[]},t.prototype.updateAllRowCtrls=function(){var e=x(this.rowCtrlsByRowIndex),t=this.gridOptionsService.is("ensureDomOrder"),o=this.gridOptionsService.isDomLayout("print");(t||o)&&e.sort((function(e,t){return e.getRowNode().rowIndex-t.getRowNode.rowIndex}));var n=x(this.zombieRowCtrls),r=this.cachedRowCtrls?this.cachedRowCtrls.getEntries():[];this.allRowCtrls=zu(e,n,r)},t.prototype.onCellFocusChanged=function(e){this.getAllCellCtrls().forEach((function(t){return t.onCellFocused(e)})),this.getFullWidthRowCtrls().forEach((function(t){return t.onFullWidthRowFocused(e)}))},t.prototype.registerCellEventListeners=function(){var e=this;this.addManagedListener(this.eventService,$e.EVENT_CELL_FOCUSED,(function(t){e.onCellFocusChanged(t)})),this.addManagedListener(this.eventService,$e.EVENT_CELL_FOCUS_CLEARED,(function(){e.onCellFocusChanged()})),this.addManagedListener(this.eventService,$e.EVENT_FLASH_CELLS,(function(t){e.getAllCellCtrls().forEach((function(e){return e.onFlashCells(t)}))})),this.addManagedListener(this.eventService,$e.EVENT_COLUMN_HOVER_CHANGED,(function(){e.getAllCellCtrls().forEach((function(e){return e.onColumnHover()}))})),this.addManagedListener(this.eventService,$e.EVENT_DISPLAYED_COLUMNS_CHANGED,(function(){e.getAllCellCtrls().forEach((function(e){return e.onDisplayedColumnsChanged()}))})),this.addManagedListener(this.eventService,$e.EVENT_DISPLAYED_COLUMNS_WIDTH_CHANGED,(function(){e.printLayout&&e.getAllCellCtrls().forEach((function(e){return e.onLeftChanged()}))})),this.gridOptionsService.isEnableRangeSelection()&&(this.addManagedListener(this.eventService,$e.EVENT_RANGE_SELECTION_CHANGED,(function(){e.getAllCellCtrls().forEach((function(e){return e.onRangeSelectionChanged()}))})),this.addManagedListener(this.eventService,$e.EVENT_COLUMN_MOVED,(function(){e.getAllCellCtrls().forEach((function(e){return e.updateRangeBordersIfRangeCount()}))})),this.addManagedListener(this.eventService,$e.EVENT_COLUMN_PINNED,(function(){e.getAllCellCtrls().forEach((function(e){return e.updateRangeBordersIfRangeCount()}))})),this.addManagedListener(this.eventService,$e.EVENT_COLUMN_VISIBLE,(function(){e.getAllCellCtrls().forEach((function(e){return e.updateRangeBordersIfRangeCount()}))}))),this.refreshListenersToColumnsForCellComps(),this.addManagedListener(this.eventService,$e.EVENT_GRID_COLUMNS_CHANGED,this.refreshListenersToColumnsForCellComps.bind(this)),this.addDestroyFunc(this.removeGridColumnListeners.bind(this))},t.prototype.removeGridColumnListeners=function(){this.destroyFuncsForColumnListeners.forEach((function(e){return e()})),this.destroyFuncsForColumnListeners.length=0},t.prototype.refreshListenersToColumnsForCellComps=function(){var e=this;this.removeGridColumnListeners();var t=this.columnModel.getAllGridColumns();t&&t.forEach((function(t){var o=function(o){e.getAllCellCtrls().forEach((function(e){e.getColumn()===t&&o(e)}))},n=function(){o((function(e){return e.onLeftChanged()}))},r=function(){o((function(e){return e.onWidthChanged()}))},i=function(){o((function(e){return e.onFirstRightPinnedChanged()}))},a=function(){o((function(e){return e.onLastLeftPinnedChanged()}))},s=function(){o((function(e){return e.onColDefChanged()}))};t.addEventListener("leftChanged",n),t.addEventListener("widthChanged",r),t.addEventListener("firstRightPinnedChanged",i),t.addEventListener("lastLeftPinnedChanged",a),t.addEventListener("colDefChanged",s),e.destroyFuncsForColumnListeners.push((function(){t.removeEventListener("leftChanged",n),t.removeEventListener("widthChanged",r),t.removeEventListener("firstRightPinnedChanged",i),t.removeEventListener("lastLeftPinnedChanged",a),t.removeEventListener("colDefChanged",s)}))}))},t.prototype.onDomLayoutChanged=function(){var e=this.gridOptionsService.isDomLayout("print"),t=e||this.gridOptionsService.is("embedFullWidthRows"),o=t!==this.embedFullWidthRows||this.printLayout!==e;this.printLayout=e,this.embedFullWidthRows=t,o&&this.redrawAfterModelUpdate({domLayoutChanged:!0})},t.prototype.datasourceChanged=function(){this.firstRenderedRow=0,this.lastRenderedRow=-1;var e=Object.keys(this.rowCtrlsByRowIndex);this.removeRowCtrls(e)},t.prototype.onPageLoaded=function(e){var t={recycleRows:e.keepRenderedRows,animate:e.animate,newData:e.newData,newPage:e.newPage,onlyBody:!0};this.redrawAfterModelUpdate(t)},t.prototype.getAllCellsForColumn=function(e){var t=[];return this.getAllRowCtrls().forEach((function(o){var n=o.getCellElement(e);n&&t.push(n)})),t},t.prototype.refreshFloatingRowComps=function(){this.refreshFloatingRows(this.topRowCtrls,this.pinnedRowModel.getPinnedTopRowData()),this.refreshFloatingRows(this.bottomRowCtrls,this.pinnedRowModel.getPinnedBottomRowData())},t.prototype.getTopRowCtrls=function(){return this.topRowCtrls},t.prototype.getBottomRowCtrls=function(){return this.bottomRowCtrls},t.prototype.refreshFloatingRows=function(e,t){var o=this;e.forEach((function(e){e.destroyFirstPass(),e.destroySecondPass()})),e.length=0,t&&t.forEach((function(t){var n=new Bl(t,o.beans,!1,!1,o.printLayout);e.push(n)}))},t.prototype.onPinnedRowDataChanged=function(){this.redrawAfterModelUpdate({recycleRows:!0})},t.prototype.getRenderedIndexesForRowNodes=function(e){var t=[];return i(e)||h(this.rowCtrlsByRowIndex,(function(o,n){var r=n.getRowNode();e.indexOf(r)>=0&&t.push(o)})),t},t.prototype.redrawRows=function(e){var t=null!=e&&e.length>0;if(t){var o=this.getRenderedIndexesForRowNodes(e);this.removeRowCtrls(o)}this.redrawAfterModelUpdate({recycleRows:t})},t.prototype.getCellToRestoreFocusToAfterRefresh=function(e){var t=(null===e||void 0===e?void 0:e.suppressKeepFocus)?null:this.focusService.getFocusCellToUseAfterRefresh();if(null==t)return null;var o=this.gridOptionsService.getDocument().activeElement,n=this.gridOptionsService.getDomData(o,Nl.DOM_DATA_KEY_CELL_CTRL),r=this.gridOptionsService.getDomData(o,Bl.DOM_DATA_KEY_ROW_CTRL);return n||r?t:null},t.prototype.redrawAfterModelUpdate=function(e){void 0===e&&(e={}),this.getLockOnRefresh();var t=this.getCellToRestoreFocusToAfterRefresh(e);this.updateContainerHeights(),this.scrollToTopIfNewData(e);var o=!e.domLayoutChanged&&!!e.recycleRows,n=e.animate&&this.gridOptionsService.isAnimateRows(),r=o?this.recycleRows():null;o||this.removeAllRowComps(),this.redraw(r,n),this.gridBodyCtrl.updateRowCount(),e.onlyBody||this.refreshFloatingRowComps(),this.dispatchDisplayedRowsChanged(),null!=t&&this.restoreFocusedCell(t),this.releaseLockOnRefresh()},t.prototype.scrollToTopIfNewData=function(e){var t=e.newData||e.newPage,o=this.gridOptionsService.is("suppressScrollOnNewData");t&&!o&&this.gridBodyCtrl.getScrollFeature().scrollToTop()},t.prototype.updateContainerHeights=function(){if(this.printLayout)this.rowContainerHeightService.setModelHeight(null);else{var e=this.paginationProxy.getCurrentPageHeight();0===e&&(e=1),this.rowContainerHeightService.setModelHeight(e)}},t.prototype.getLockOnRefresh=function(){if(this.refreshInProgress)throw new Error("AG Grid: cannot get grid to draw rows when it is in the middle of drawing rows. Your code probably called a grid API method while the grid was in the render stage. To overcome this, put the API call into a timeout, e.g. instead of api.redrawRows(), call setTimeout(function() { api.redrawRows(); }, 0). To see what part of your code that caused the refresh check this stacktrace.");this.refreshInProgress=!0},t.prototype.releaseLockOnRefresh=function(){this.refreshInProgress=!1},t.prototype.isRefreshInProgress=function(){return this.refreshInProgress},t.prototype.restoreFocusedCell=function(e){e&&this.onCellFocusChanged({rowIndex:e.rowIndex,column:e.column,rowPinned:e.rowPinned,forceBrowserFocus:!0,preventScrollOnBrowserFocus:!0,api:this.beans.gridApi,columnApi:this.beans.columnApi,context:this.beans.gridOptionsService.context,type:"mock"})},t.prototype.stopEditing=function(e){void 0===e&&(e=!1),this.getAllRowCtrls().forEach((function(t){t.stopEditing(e)}))},t.prototype.getAllCellCtrls=function(){for(var e=[],t=this.getAllRowCtrls(),o=t.length,n=0;n<o;n++)for(var r=t[n].getAllCellCtrls(),i=r.length,a=0;a<i;a++)e.push(r[a]);return e},t.prototype.getAllRowCtrls=function(){var e,t,o=this.stickyRowFeature&&this.stickyRowFeature.getStickyRowCtrls()||[],n=zu(this.topRowCtrls,this.bottomRowCtrls,o);try{for(var r=Hu(Object.keys(this.rowCtrlsByRowIndex)),i=r.next();!i.done;i=r.next()){var a=i.value;n.push(this.rowCtrlsByRowIndex[a])}}catch(s){e={error:s}}finally{try{i&&!i.done&&(t=r.return)&&t.call(r)}finally{if(e)throw e.error}}return n},t.prototype.addRenderedRowListener=function(e,t,o){var n=this.rowCtrlsByRowIndex[t];n&&n.addEventListener(e,o)},t.prototype.flashCells=function(e){void 0===e&&(e={});var t=e.flashDelay,o=e.fadeDelay;this.getCellCtrls(e.rowNodes,e.columns).forEach((function(e){return e.flashCell({flashDelay:t,fadeDelay:o})}))},t.prototype.refreshCells=function(e){void 0===e&&(e={});var t={forceRefresh:e.force,newData:!1,suppressFlash:e.suppressFlash};this.getCellCtrls(e.rowNodes,e.columns).forEach((function(e){if(e.refreshShouldDestroy()){var o=e.getRowCtrl();o&&o.refreshCell(e)}else e.refreshCell(t)})),this.getFullWidthRowCtrls(e.rowNodes).forEach((function(e){e.refreshFullWidth()}))},t.prototype.getCellRendererInstances=function(e){var t,o=this,n=this.getCellCtrls(e.rowNodes,e.columns).map((function(e){return e.getCellRenderer()})).filter((function(e){return null!=e}));if(null===(t=e.columns)||void 0===t?void 0:t.length)return n;var r=[],i=this.mapRowNodes(e.rowNodes);return this.getAllRowCtrls().forEach((function(e){if((!i||o.isRowInMap(e.getRowNode(),i))&&e.isFullWidth()){var t=e.getFullWidthCellRenderer();t&&r.push(t)}})),zu(r,n)},t.prototype.getCellEditorInstances=function(e){var t=[];return this.getCellCtrls(e.rowNodes,e.columns).forEach((function(e){var o=e.getCellEditor();o&&t.push(o)})),t},t.prototype.getEditingCells=function(){var e=[];return this.getAllCellCtrls().forEach((function(t){if(t.isEditing()){var o=t.getCellPosition();e.push(o)}})),e},t.prototype.mapRowNodes=function(e){if(e){var t={top:{},bottom:{},normal:{}};return e.forEach((function(e){var o=e.id;"top"===e.rowPinned?t.top[o]=e:"bottom"===e.rowPinned?t.bottom[o]=e:t.normal[o]=e})),t}},t.prototype.isRowInMap=function(e,t){var o=e.id,n=e.rowPinned;return"bottom"===n?null!=t.bottom[o]:"top"===n?null!=t.top[o]:null!=t.normal[o]},t.prototype.getCellCtrls=function(e,t){var o,n=this,i=this.mapRowNodes(e),a=[];r(t)&&(o={},t.forEach((function(e){var t=n.columnModel.getGridColumn(e);r(t)&&(o[t.getId()]=!0)})));return this.getAllRowCtrls().forEach((function(e){return function(e){var t=e.getRowNode();(null==i||n.isRowInMap(t,i))&&e.getAllCellCtrls().forEach((function(e){var t=e.getColumn().getId();o&&!o[t]||a.push(e)}))}(e)})),a},t.prototype.destroy=function(){this.removeAllRowComps(),e.prototype.destroy.call(this)},t.prototype.removeAllRowComps=function(){var e=Object.keys(this.rowCtrlsByRowIndex);this.removeRowCtrls(e)},t.prototype.recycleRows=function(){var e=[];h(this.rowCtrlsByRowIndex,(function(t,o){null==o.getRowNode().id&&e.push(t)})),this.removeRowCtrls(e);var t={};return h(this.rowCtrlsByRowIndex,(function(e,o){var n=o.getRowNode();t[n.id]=o})),this.rowCtrlsByRowIndex={},t},t.prototype.removeRowCtrls=function(e){var t=this;e.forEach((function(e){var o=t.rowCtrlsByRowIndex[e];o&&(o.destroyFirstPass(),o.destroySecondPass()),delete t.rowCtrlsByRowIndex[e]}))},t.prototype.onBodyScroll=function(e){"vertical"===e.direction&&this.redrawAfterScroll()},t.prototype.redrawAfterScroll=function(){var e;if(this.stickyRowFeature&&To()&&(e=this.getCellToRestoreFocusToAfterRefresh()||void 0),this.getLockOnRefresh(),this.redraw(null,!1,!0),this.releaseLockOnRefresh(),this.dispatchDisplayedRowsChanged(!0),null!=e){var t=this.getCellToRestoreFocusToAfterRefresh();null!=e&&null==t&&(this.animationFrameService.flushAllFrames(),this.restoreFocusedCell(e))}},t.prototype.removeRowCompsNotToDraw=function(e){var t={};e.forEach((function(e){return t[e]=!0}));var o=Object.keys(this.rowCtrlsByRowIndex).filter((function(e){return!t[e]}));this.removeRowCtrls(o)},t.prototype.calculateIndexesToDraw=function(e){var t=this,o=Ho(this.firstRenderedRow,this.lastRenderedRow),n=function(e,n){var r=n.getRowNode().rowIndex;null!=r&&(r<t.firstRenderedRow||r>t.lastRenderedRow)&&t.doNotUnVirtualiseRow(n)&&o.push(r)};return h(this.rowCtrlsByRowIndex,n),h(e,n),o.sort((function(e,t){return e-t})),o=o.filter((function(e){var o=t.paginationProxy.getRow(e);return o&&!o.sticky}))},t.prototype.redraw=function(e,t,o){var n=this;void 0===t&&(t=!1),void 0===o&&(o=!1),this.rowContainerHeightService.updateOffset(),this.workOutFirstAndLastRowsToRender(),this.stickyRowFeature&&this.stickyRowFeature.checkStickyRows();var i=this.calculateIndexesToDraw(e);(this.removeRowCompsNotToDraw(i),this.printLayout&&(t=!1),i.forEach((function(i){r(n.createOrUpdateRowCtrl(i,e,t,o))})),e)&&(o&&!this.gridOptionsService.is("suppressAnimationFrame")&&!this.printLayout?this.beans.animationFrameService.addDestroyTask((function(){n.destroyRowCtrls(e,t),n.updateAllRowCtrls(),n.dispatchDisplayedRowsChanged()})):this.destroyRowCtrls(e,t));this.updateAllRowCtrls()},t.prototype.dispatchDisplayedRowsChanged=function(e){void 0===e&&(e=!1);var t={type:$e.EVENT_DISPLAYED_ROWS_CHANGED,afterScroll:e};this.eventService.dispatchEvent(t)},t.prototype.onDisplayedColumnsChanged=function(){var e=this.columnModel.isPinningLeft(),t=this.columnModel.isPinningRight();(this.pinningLeft!==e||t!==this.pinningRight)&&(this.pinningLeft=e,this.pinningRight=t,this.embedFullWidthRows&&this.redrawFullWidthEmbeddedRows())},t.prototype.redrawFullWidthEmbeddedRows=function(){var e=[];this.getFullWidthRowCtrls().forEach((function(t){var o=t.getRowNode().rowIndex;e.push(o.toString())})),this.refreshFloatingRowComps(),this.removeRowCtrls(e),this.redrawAfterScroll()},t.prototype.getFullWidthRowCtrls=function(e){var t=this,o=this.mapRowNodes(e);return this.getAllRowCtrls().filter((function(e){if(!e.isFullWidth())return!1;var n=e.getRowNode();return!(null!=o&&!t.isRowInMap(n,o))}))},t.prototype.refreshFullWidthRow=function(e){var t=this.getFullWidthRowCtrls().find((function(t){return t.getRowNode()===e}));t&&(t.refreshFullWidth()||(e.sticky?this.stickyRowFeature.refreshStickyNode(e):this.removeRowCtrls([e.rowIndex]),this.redrawAfterScroll()))},t.prototype.createOrUpdateRowCtrl=function(e,t,o,n){var i,a=this.rowCtrlsByRowIndex[e];if(a||r(i=this.paginationProxy.getRow(e))&&r(t)&&t[i.id]&&i.alreadyRendered&&(a=t[i.id],t[i.id]=null),!a){if(i||(i=this.paginationProxy.getRow(e)),!r(i))return;a=this.createRowCon(i,o,n)}return i&&(i.alreadyRendered=!0),this.rowCtrlsByRowIndex[e]=a,a},t.prototype.destroyRowCtrls=function(e,t){var o=this,n=[];h(e,(function(e,r){r&&(o.cachedRowCtrls&&r.isCacheable()?o.cachedRowCtrls.addRow(r):(r.destroyFirstPass(),t?(o.zombieRowCtrls[r.getInstanceId()]=r,n.push((function(){r.destroySecondPass(),delete o.zombieRowCtrls[r.getInstanceId()]}))):r.destroySecondPass()))})),t&&(n.push((function(){o.updateAllRowCtrls(),o.dispatchDisplayedRowsChanged()})),O(n))},t.prototype.getRowBuffer=function(){var e=this.gridOptionsService.getNum("rowBuffer");return"number"===typeof e?e<0&&(j((function(){return console.warn("AG Grid: rowBuffer should not be negative")}),"warn rowBuffer negative"),e=0,this.gridOptionsService.set("rowBuffer",0)):e=10,e},t.prototype.getRowBufferInPixels=function(){return this.getRowBuffer()*this.gridOptionsService.getRowHeightAsNumber()},t.prototype.workOutFirstAndLastRowsToRender=function(){var e,t;if(this.paginationProxy.isRowsToRender())if(this.printLayout)e=this.paginationProxy.getPageFirstRow(),t=this.paginationProxy.getPageLastRow();else{var o=this.getRowBufferInPixels(),n=this.ctrlsService.getGridBodyCtrl(),r=this.gridOptionsService.is("suppressRowVirtualisation"),i=!1,a=void 0,s=void 0;do{var l=this.paginationProxy.getPixelOffset(),c=this.paginationProxy.getCurrentPagePixelRange(),d=c.pageFirstPixel,u=c.pageLastPixel,p=this.rowContainerHeightService.getDivStretchOffset(),h=n.getScrollFeature().getVScrollPosition(),f=h.top,g=h.bottom;r?(a=d+p,s=u+p):(a=Math.max(f+l-o,d)+p,s=Math.min(g+l+o,u)+p),this.firstVisibleVPixel=Math.max(f+l,d)+p,i=this.ensureAllRowsInRangeHaveHeightsCalculated(a,s)}while(i);var m=this.paginationProxy.getRowIndexAtPixel(a),y=this.paginationProxy.getRowIndexAtPixel(s),v=this.paginationProxy.getPageFirstRow(),b=this.paginationProxy.getPageLastRow();m<v&&(m=v),y>b&&(y=b),e=m,t=y}else e=0,t=-1;var x=this.gridOptionsService.isDomLayout("normal"),w=this.gridOptionsService.is("suppressMaxRenderedRowRestriction"),C=Math.max(this.getRowBuffer(),500);x&&!w&&t-e>C&&(t=e+C);var _=e!==this.firstRenderedRow,S=t!==this.lastRenderedRow;if(_||S){this.firstRenderedRow=e,this.lastRenderedRow=t;var E={type:$e.EVENT_VIEWPORT_CHANGED,firstRow:e,lastRow:t};this.eventService.dispatchEvent(E)}},t.prototype.dispatchFirstDataRenderedEvent=function(){var e=this;if(!this.dataFirstRenderedFired){this.dataFirstRenderedFired=!0;var t={type:$e.EVENT_FIRST_DATA_RENDERED,firstRow:this.firstRenderedRow,lastRow:this.lastRenderedRow};window.requestAnimationFrame((function(){e.beans.eventService.dispatchEvent(t)}))}},t.prototype.ensureAllRowsInRangeHaveHeightsCalculated=function(e,t){var o=this.paginationProxy.ensureRowHeightsValid(e,t,-1,-1);return o&&this.updateContainerHeights(),o},t.prototype.getFirstVisibleVerticalPixel=function(){return this.firstVisibleVPixel},t.prototype.getFirstVirtualRenderedRow=function(){return this.firstRenderedRow},t.prototype.getLastVirtualRenderedRow=function(){return this.lastRenderedRow},t.prototype.doNotUnVirtualiseRow=function(e){var t=!1,o=e.getRowNode(),n=this.focusService.isRowNodeFocused(o),r=e.isEditing(),i=o.detail;return(n||r||i)&&!!this.paginationProxy.isRowPresent(o)||t},t.prototype.createRowCon=function(e,t,o){var n=this.cachedRowCtrls?this.cachedRowCtrls.getRow(e):null;if(n)return n;var r=this.gridOptionsService.is("suppressAnimationFrame"),i=o&&!r&&!this.printLayout;return new Bl(e,this.beans,t,i,this.printLayout)},t.prototype.getRenderedNodes=function(){var e=this.rowCtrlsByRowIndex;return Object.keys(e).map((function(t){return e[t].getRowNode()}))},t.prototype.getRowByPosition=function(e){var t,o=e.rowIndex;switch(e.rowPinned){case"top":t=this.topRowCtrls[o];break;case"bottom":t=this.bottomRowCtrls[o];break;default:(t=this.rowCtrlsByRowIndex[o])||(t=this.getStickyTopRowCtrls().find((function(e){return e.getRowNode().rowIndex===o}))||null)}return t},t.prototype.getRowNode=function(e){switch(e.rowPinned){case"top":return this.pinnedRowModel.getPinnedTopRowData()[e.rowIndex];case"bottom":return this.pinnedRowModel.getPinnedBottomRowData()[e.rowIndex];default:return this.rowModel.getRow(e.rowIndex)}},t.prototype.isRangeInRenderedViewport=function(e,t){if(null==e||null==t)return!1;var o=e>this.lastRenderedRow;return!(t<this.firstRenderedRow)&&!o},Fu([q("animationFrameService")],t.prototype,"animationFrameService",void 0),Fu([q("paginationProxy")],t.prototype,"paginationProxy",void 0),Fu([q("columnModel")],t.prototype,"columnModel",void 0),Fu([q("pinnedRowModel")],t.prototype,"pinnedRowModel",void 0),Fu([q("rowModel")],t.prototype,"rowModel",void 0),Fu([q("focusService")],t.prototype,"focusService",void 0),Fu([q("beans")],t.prototype,"beans",void 0),Fu([q("rowContainerHeightService")],t.prototype,"rowContainerHeightService",void 0),Fu([q("ctrlsService")],t.prototype,"ctrlsService",void 0),Fu([$],t.prototype,"postConstruct",null),t=Fu([W("rowRenderer")],t)}(Fe),Vu=function(){function e(e){this.entriesMap={},this.entriesList=[],this.maxCount=e}return e.prototype.addRow=function(e){if(this.entriesMap[e.getRowNode().id]=e,this.entriesList.push(e),e.setCached(!0),this.entriesList.length>this.maxCount){var t=this.entriesList[0];t.destroyFirstPass(),t.destroySecondPass(),this.removeFromCache(t)}},e.prototype.getRow=function(e){if(null==e||null==e.id)return null;var t=this.entriesMap[e.id];return t?(this.removeFromCache(t),t.setCached(!1),t.getRowNode()!=e?null:t):null},e.prototype.removeFromCache=function(e){var t=e.getRowNode().id;delete this.entriesMap[t],ye(this.entriesList,e)},e.prototype.getEntries=function(){return this.entriesList},e}(),$u=function(){var e=function(t,o){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])},e(t,o)};return function(t,o){function n(){this.constructor=t}e(t,o),t.prototype=null===o?Object.create(o):(n.prototype=o.prototype,new n)}}(),Uu=function(e,t,o,n){var r,i=arguments.length,a=i<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,o):n;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)a=Reflect.decorate(e,t,o,n);else for(var s=e.length-1;s>=0;s--)(r=e[s])&&(a=(i<3?r(a):i>3?r(t,o,a):r(t,o))||a);return i>3&&a&&Object.defineProperty(t,o,a),a},Wu=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return $u(t,e),t.prototype.formatValue=function(e,t,o,n,r){void 0===r&&(r=!0);var i,a=null,s=e.getColDef();if(n?i=n:r&&(i=s.valueFormatter),i){var l={value:o,node:t,data:t?t.data:null,colDef:s,column:e,api:this.gridOptionsService.api,columnApi:this.gridOptionsService.columnApi,context:this.gridOptionsService.context};a="function"===typeof i?i(l):this.expressionService.evaluate(i,l)}else if(s.refData)return s.refData[o]||"";return null==a&&Array.isArray(o)&&(a=o.join(", ")),a},Uu([q("expressionService")],t.prototype,"expressionService",void 0),t=Uu([W("valueFormatterService")],t)}(Fe),qu=function(){var e=function(t,o){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])},e(t,o)};return function(t,o){function n(){this.constructor=t}e(t,o),t.prototype=null===o?Object.create(o):(n.prototype=o.prototype,new n)}}(),Ku=function(e,t,o,n){var r,i=arguments.length,a=i<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,o):n;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)a=Reflect.decorate(e,t,o,n);else for(var s=e.length-1;s>=0;s--)(r=e[s])&&(a=(i<3?r(a):i>3?r(t,o,a):r(t,o))||a);return i>3&&a&&Object.defineProperty(t,o,a),a},Yu=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return qu(t,e),t.prototype.init=function(){this.setPinnedTopRowData(this.gridOptionsService.get("pinnedTopRowData")),this.setPinnedBottomRowData(this.gridOptionsService.get("pinnedBottomRowData"))},t.prototype.isEmpty=function(e){return a("top"===e?this.pinnedTopRows:this.pinnedBottomRows)},t.prototype.isRowsToRender=function(e){return!this.isEmpty(e)},t.prototype.getRowAtPixel=function(e,t){var o="top"===t?this.pinnedTopRows:this.pinnedBottomRows;if(a(o))return 0;for(var n=0;n<o.length;n++){var r=o[n];if(r.rowTop+r.rowHeight-1>=e)return n}return o.length-1},t.prototype.setPinnedTopRowData=function(e){this.pinnedTopRows=this.createNodesFromData(e,!0);var t={type:$e.EVENT_PINNED_ROW_DATA_CHANGED};this.eventService.dispatchEvent(t)},t.prototype.setPinnedBottomRowData=function(e){this.pinnedBottomRows=this.createNodesFromData(e,!1);var t={type:$e.EVENT_PINNED_ROW_DATA_CHANGED};this.eventService.dispatchEvent(t)},t.prototype.createNodesFromData=function(e,t){var o=this,n=[];if(e){var r=0;e.forEach((function(e,i){var a=new _a(o.beans);a.data=e;var s=t?_a.ID_PREFIX_TOP_PINNED:_a.ID_PREFIX_BOTTOM_PINNED;a.id=s+i,a.rowPinned=t?"top":"bottom",a.setRowTop(r),a.setRowHeight(o.gridOptionsService.getRowHeightForNode(a).height),a.setRowIndex(i),r+=a.rowHeight,n.push(a)}))}return n},t.prototype.getPinnedTopRowData=function(){return this.pinnedTopRows},t.prototype.getPinnedBottomRowData=function(){return this.pinnedBottomRows},t.prototype.getPinnedTopTotalHeight=function(){return this.getTotalHeight(this.pinnedTopRows)},t.prototype.getPinnedTopRowCount=function(){return this.pinnedTopRows?this.pinnedTopRows.length:0},t.prototype.getPinnedBottomRowCount=function(){return this.pinnedBottomRows?this.pinnedBottomRows.length:0},t.prototype.getPinnedTopRow=function(e){return this.pinnedTopRows[e]},t.prototype.getPinnedBottomRow=function(e){return this.pinnedBottomRows[e]},t.prototype.forEachPinnedTopRow=function(e){a(this.pinnedTopRows)||this.pinnedTopRows.forEach(e)},t.prototype.forEachPinnedBottomRow=function(e){a(this.pinnedBottomRows)||this.pinnedBottomRows.forEach(e)},t.prototype.getPinnedBottomTotalHeight=function(){return this.getTotalHeight(this.pinnedBottomRows)},t.prototype.getTotalHeight=function(e){if(!e||0===e.length)return 0;var t=fe(e);return t.rowTop+t.rowHeight},Ku([q("beans")],t.prototype,"beans",void 0),Ku([$],t.prototype,"init",null),t=Ku([W("pinnedRowModel")],t)}(Fe);!function(e){e.Applied="Applied",e.StoreNotFound="StoreNotFound",e.StoreLoading="StoreLoading",e.StoreWaitingToLoad="StoreWaitingToLoad",e.StoreLoadingFailed="StoreLoadingFailed",e.StoreWrongType="StoreWrongType",e.Cancelled="Cancelled"}(wu||(wu={}));var Ju,Xu=function(){function e(e,t){this.active=!0,this.nodeIdsToColumns={},this.mapToItems={},this.keepingColumns=e,this.pathRoot={rowNode:t,children:null},this.mapToItems[t.id]=this.pathRoot}return e.prototype.setInactive=function(){this.active=!1},e.prototype.isActive=function(){return this.active},e.prototype.depthFirstSearchChangedPath=function(e,t){if(e.children)for(var o=0;o<e.children.length;o++)this.depthFirstSearchChangedPath(e.children[o],t);t(e.rowNode)},e.prototype.depthFirstSearchEverything=function(e,t,o){if(e.childrenAfterGroup)for(var n=0;n<e.childrenAfterGroup.length;n++){var r=e.childrenAfterGroup[n];r.childrenAfterGroup?this.depthFirstSearchEverything(e.childrenAfterGroup[n],t,o):o&&t(r)}t(e)},e.prototype.forEachChangedNodeDepthFirst=function(e,t,o){void 0===t&&(t=!1),void 0===o&&(o=!1),this.active&&!o?this.depthFirstSearchChangedPath(this.pathRoot,e):this.depthFirstSearchEverything(this.pathRoot.rowNode,e,t)},e.prototype.executeFromRootNode=function(e){e(this.pathRoot.rowNode)},e.prototype.createPathItems=function(e){for(var t=e,o=0;!this.mapToItems[t.id];){var n={rowNode:t,children:null};this.mapToItems[t.id]=n,o++,t=t.parent}return o},e.prototype.populateColumnsMap=function(e,t){var o=this;if(this.keepingColumns&&t)for(var n=e;n;)this.nodeIdsToColumns[n.id]||(this.nodeIdsToColumns[n.id]={}),t.forEach((function(e){return o.nodeIdsToColumns[n.id][e.getId()]=!0})),n=n.parent},e.prototype.linkPathItems=function(e,t){for(var o=e,n=0;n<t;n++){var r=this.mapToItems[o.id],i=this.mapToItems[o.parent.id];i.children||(i.children=[]),i.children.push(r),o=o.parent}},e.prototype.addParentNode=function(e,t){if(e&&!e.isRowPinned()){var o=this.createPathItems(e);this.linkPathItems(e,o),this.populateColumnsMap(e,t)}},e.prototype.canSkip=function(e){return this.active&&!this.mapToItems[e.id]},e.prototype.getValueColumnsForNode=function(e,t){if(!this.keepingColumns)return t;var o=this.nodeIdsToColumns[e.id];return t.filter((function(e){return o[e.getId()]}))},e.prototype.getNotValueColumnsForNode=function(e,t){if(!this.keepingColumns)return null;var o=this.nodeIdsToColumns[e.id];return t.filter((function(e){return!o[e.getId()]}))},e}(),Qu=function(){var e=function(t,o){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])},e(t,o)};return function(t,o){function n(){this.constructor=t}e(t,o),t.prototype=null===o?Object.create(o):(n.prototype=o.prototype,new n)}}(),Zu=function(e){function t(o){var n=e.call(this)||this;return n.state=t.STATE_WAITING_TO_LOAD,n.version=0,n.id=o,n}return Qu(t,e),t.prototype.getId=function(){return this.id},t.prototype.load=function(){this.state=t.STATE_LOADING,this.loadFromDatasource()},t.prototype.getVersion=function(){return this.version},t.prototype.setStateWaitingToLoad=function(){this.version++,this.state=t.STATE_WAITING_TO_LOAD},t.prototype.getState=function(){return this.state},t.prototype.pageLoadFailed=function(e){this.isRequestMostRecentAndLive(e)&&(this.state=t.STATE_FAILED,this.processServerFail()),this.dispatchLoadCompleted(!1)},t.prototype.success=function(e,t){this.successCommon(e,t)},t.prototype.pageLoaded=function(e,t,o){this.successCommon(e,{rowData:t,rowCount:o})},t.prototype.isRequestMostRecentAndLive=function(e){var t=e===this.version,o=this.isAlive();return t&&o},t.prototype.successCommon=function(e,o){this.dispatchLoadCompleted(),this.isRequestMostRecentAndLive(e)&&(this.state=t.STATE_LOADED,this.processServerResult(o))},t.prototype.dispatchLoadCompleted=function(e){void 0===e&&(e=!0);var o={type:t.EVENT_LOAD_COMPLETE,success:e,block:this};this.dispatchEvent(o)},t.EVENT_LOAD_COMPLETE="loadComplete",t.STATE_WAITING_TO_LOAD="needsLoading",t.STATE_LOADING="loading",t.STATE_LOADED="loaded",t.STATE_FAILED="failed",t}(Fe),ep=function(){var e=function(t,o){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])},e(t,o)};return function(t,o){function n(){this.constructor=t}e(t,o),t.prototype=null===o?Object.create(o):(n.prototype=o.prototype,new n)}}(),tp=function(e,t,o,n){var r,i=arguments.length,a=i<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,o):n;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)a=Reflect.decorate(e,t,o,n);else for(var s=e.length-1;s>=0;s--)(r=e[s])&&(a=(i<3?r(a):i>3?r(t,o,a):r(t,o))||a);return i>3&&a&&Object.defineProperty(t,o,a),a},op=function(e,t){return function(o,n){t(o,n,e)}},np=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.activeBlockLoadsCount=0,t.blocks=[],t.active=!0,t}var o;return ep(t,e),o=t,t.prototype.postConstruct=function(){this.maxConcurrentRequests=this.getMaxConcurrentDatasourceRequests();var e=this.gridOptionsService.getNum("blockLoadDebounceMillis");e&&e>0&&(this.checkBlockToLoadDebounce=tr.debounce(this.performCheckBlocksToLoad.bind(this),e))},t.prototype.setBeans=function(e){this.logger=e.create("RowNodeBlockLoader")},t.prototype.getMaxConcurrentDatasourceRequests=function(){var e=this.gridOptionsService.getNum("maxConcurrentDatasourceRequests");return null==e?2:e<=0?void 0:e},t.prototype.addBlock=function(e){this.blocks.push(e),e.addEventListener(Zu.EVENT_LOAD_COMPLETE,this.loadComplete.bind(this)),this.checkBlockToLoad()},t.prototype.removeBlock=function(e){tr.removeFromArray(this.blocks,e)},t.prototype.destroy=function(){e.prototype.destroy.call(this),this.active=!1},t.prototype.loadComplete=function(){this.activeBlockLoadsCount--,this.checkBlockToLoad(),this.dispatchEvent({type:o.BLOCK_LOADED_EVENT}),0==this.activeBlockLoadsCount&&this.dispatchEvent({type:o.BLOCK_LOADER_FINISHED_EVENT})},t.prototype.checkBlockToLoad=function(){this.checkBlockToLoadDebounce?this.checkBlockToLoadDebounce():this.performCheckBlocksToLoad()},t.prototype.performCheckBlocksToLoad=function(){if(this.active)if(this.printCacheStatus(),null!=this.maxConcurrentRequests&&this.activeBlockLoadsCount>=this.maxConcurrentRequests)this.logger.log("checkBlockToLoad: max loads exceeded");else{var e=this.getAvailableLoadingCount(),t=this.blocks.filter((function(e){return e.getState()===Zu.STATE_WAITING_TO_LOAD})).slice(0,e);this.registerLoads(t.length),t.forEach((function(e){return e.load()})),this.printCacheStatus()}},t.prototype.getBlockState=function(){if(this.gridOptionsService.isRowModelType("serverSide"))return this.rowModel.getBlockStates();var e={};return this.blocks.forEach((function(t){var o=t.getBlockStateJson(),n=o.id,r=o.state;e[n]=r})),e},t.prototype.printCacheStatus=function(){this.logger.isLogging()&&this.logger.log("printCacheStatus: activePageLoadsCount = "+this.activeBlockLoadsCount+", blocks = "+JSON.stringify(this.getBlockState()))},t.prototype.isLoading=function(){return this.activeBlockLoadsCount>0},t.prototype.registerLoads=function(e){this.activeBlockLoadsCount+=e},t.prototype.getAvailableLoadingCount=function(){return void 0!==this.maxConcurrentRequests?this.maxConcurrentRequests-this.activeBlockLoadsCount:void 0},t.BLOCK_LOADED_EVENT="blockLoaded",t.BLOCK_LOADER_FINISHED_EVENT="blockLoaderFinished",tp([q("rowModel")],t.prototype,"rowModel",void 0),tp([$],t.prototype,"postConstruct",null),tp([op(0,J("loggerFactory"))],t.prototype,"setBeans",null),t=o=tp([W("rowNodeBlockLoader")],t)}(Fe),rp=function(){var e=function(t,o){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])},e(t,o)};return function(t,o){function n(){this.constructor=t}e(t,o),t.prototype=null===o?Object.create(o):(n.prototype=o.prototype,new n)}}(),ip=function(e,t,o,n){var r,i=arguments.length,a=i<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,o):n;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)a=Reflect.decorate(e,t,o,n);else for(var s=e.length-1;s>=0;s--)(r=e[s])&&(a=(i<3?r(a):i>3?r(t,o,a):r(t,o))||a);return i>3&&a&&Object.defineProperty(t,o,a),a},ap=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.currentPage=0,t.topDisplayedRowIndex=0,t.bottomDisplayedRowIndex=0,t.pixelOffset=0,t.masterRowCount=0,t}return rp(t,e),t.prototype.postConstruct=function(){this.active=this.gridOptionsService.is("pagination"),this.paginateChildRows=this.isPaginateChildRows(),this.addManagedListener(this.eventService,$e.EVENT_MODEL_UPDATED,this.onModelUpdated.bind(this)),this.addManagedPropertyListener("pagination",this.onPaginationPageSizeChanged.bind(this)),this.addManagedPropertyListener("paginationPageSize",this.onPaginationPageSizeChanged.bind(this)),this.onModelUpdated()},t.prototype.ensureRowHeightsValid=function(e,t,o,n){var r=this.rowModel.ensureRowHeightsValid(e,t,this.getPageFirstRow(),this.getPageLastRow());return r&&this.calculatePages(),r},t.prototype.isPaginateChildRows=function(){return!(!this.gridOptionsService.is("groupRemoveSingleChildren")&&!this.gridOptionsService.is("groupRemoveLowestSingleChildren"))||this.gridOptionsService.is("paginateChildRows")},t.prototype.onModelUpdated=function(e){this.calculatePages();var t={type:$e.EVENT_PAGINATION_CHANGED,animate:!!e&&e.animate,newData:!!e&&e.newData,newPage:!!e&&e.newPage,keepRenderedRows:!!e&&e.keepRenderedRows};this.eventService.dispatchEvent(t)},t.prototype.onPaginationPageSizeChanged=function(){this.active=this.gridOptionsService.is("pagination"),this.calculatePages();var e={type:$e.EVENT_PAGINATION_CHANGED,animate:!1,newData:!1,newPage:!1,keepRenderedRows:!0};this.eventService.dispatchEvent(e)},t.prototype.goToPage=function(e){if(this.active&&this.currentPage!==e&&"number"===typeof this.currentPage){this.currentPage=e;var t={type:$e.EVENT_MODEL_UPDATED,animate:!1,keepRenderedRows:!1,newData:!1,newPage:!0};this.onModelUpdated(t)}},t.prototype.getPixelOffset=function(){return this.pixelOffset},t.prototype.getRow=function(e){return this.rowModel.getRow(e)},t.prototype.getRowNode=function(e){return this.rowModel.getRowNode(e)},t.prototype.getRowIndexAtPixel=function(e){return this.rowModel.getRowIndexAtPixel(e)},t.prototype.getCurrentPageHeight=function(){return i(this.topRowBounds)||i(this.bottomRowBounds)?0:Math.max(this.bottomRowBounds.rowTop+this.bottomRowBounds.rowHeight-this.topRowBounds.rowTop,0)},t.prototype.getCurrentPagePixelRange=function(){return{pageFirstPixel:this.topRowBounds?this.topRowBounds.rowTop:0,pageLastPixel:this.bottomRowBounds?this.bottomRowBounds.rowTop+this.bottomRowBounds.rowHeight:0}},t.prototype.isRowPresent=function(e){return!!this.rowModel.isRowPresent(e)&&(e.rowIndex>=this.topDisplayedRowIndex&&e.rowIndex<=this.bottomDisplayedRowIndex)},t.prototype.isEmpty=function(){return this.rowModel.isEmpty()},t.prototype.isRowsToRender=function(){return this.rowModel.isRowsToRender()},t.prototype.forEachNode=function(e){return this.rowModel.forEachNode(e)},t.prototype.forEachNodeOnPage=function(e){for(var t=this.getPageFirstRow(),o=this.getPageLastRow(),n=t;n<=o;n++){var r=this.getRow(n);r&&e(r)}},t.prototype.getType=function(){return this.rowModel.getType()},t.prototype.getRowBounds=function(e){var t=this.rowModel.getRowBounds(e);return t.rowIndex=e,t},t.prototype.getPageFirstRow=function(){return this.topRowBounds?this.topRowBounds.rowIndex:-1},t.prototype.getPageLastRow=function(){return this.bottomRowBounds?this.bottomRowBounds.rowIndex:-1},t.prototype.getRowCount=function(){return this.rowModel.getRowCount()},t.prototype.getPageForIndex=function(e){return Math.floor(e/this.pageSize)},t.prototype.goToPageWithIndex=function(e){if(this.active){var t=this.getPageForIndex(e);this.goToPage(t)}},t.prototype.isRowInPage=function(e){return!this.active||this.getPageForIndex(e.rowIndex)===this.currentPage},t.prototype.isLastPageFound=function(){return this.rowModel.isLastRowIndexKnown()},t.prototype.getCurrentPage=function(){return this.currentPage},t.prototype.goToNextPage=function(){this.goToPage(this.currentPage+1)},t.prototype.goToPreviousPage=function(){this.goToPage(this.currentPage-1)},t.prototype.goToFirstPage=function(){this.goToPage(0)},t.prototype.goToLastPage=function(){var e=this.rowModel.getRowCount(),t=Math.floor(e/this.pageSize);this.goToPage(t)},t.prototype.getPageSize=function(){return this.pageSize},t.prototype.getTotalPages=function(){return this.totalPages},t.prototype.setPageSize=function(){this.pageSize=this.gridOptionsService.getNum("paginationPageSize"),(null==this.pageSize||this.pageSize<1)&&(this.pageSize=100)},t.prototype.calculatePages=function(){this.active?(this.setPageSize(),this.paginateChildRows?this.calculatePagesAllRows():this.calculatePagesMasterRowsOnly()):this.calculatedPagesNotActive(),this.topRowBounds=this.rowModel.getRowBounds(this.topDisplayedRowIndex),this.topRowBounds&&(this.topRowBounds.rowIndex=this.topDisplayedRowIndex),this.bottomRowBounds=this.rowModel.getRowBounds(this.bottomDisplayedRowIndex),this.bottomRowBounds&&(this.bottomRowBounds.rowIndex=this.bottomDisplayedRowIndex),this.setPixelOffset(r(this.topRowBounds)?this.topRowBounds.rowTop:0)},t.prototype.setPixelOffset=function(e){this.pixelOffset!==e&&(this.pixelOffset=e,this.eventService.dispatchEvent({type:$e.EVENT_PAGINATION_PIXEL_OFFSET_CHANGED}))},t.prototype.setZeroRows=function(){this.masterRowCount=0,this.topDisplayedRowIndex=0,this.bottomDisplayedRowIndex=-1,this.currentPage=0,this.totalPages=0},t.prototype.adjustCurrentPageIfInvalid=function(){this.currentPage>=this.totalPages&&(this.currentPage=this.totalPages-1),(!isFinite(this.currentPage)||isNaN(this.currentPage)||this.currentPage<0)&&(this.currentPage=0)},t.prototype.calculatePagesMasterRowsOnly=function(){if(this.masterRowCount=this.rowModel.getTopLevelRowCount(),this.masterRowCount<=0)this.setZeroRows();else{var e=this.masterRowCount-1;this.totalPages=Math.floor(e/this.pageSize)+1,this.adjustCurrentPageIfInvalid();var t=this.pageSize*this.currentPage,o=this.pageSize*(this.currentPage+1)-1;if(o>e&&(o=e),this.topDisplayedRowIndex=this.rowModel.getTopLevelRowDisplayedIndex(t),o===e)this.bottomDisplayedRowIndex=this.rowModel.getRowCount()-1;else{var n=this.rowModel.getTopLevelRowDisplayedIndex(o+1);this.bottomDisplayedRowIndex=n-1}}},t.prototype.getMasterRowCount=function(){return this.masterRowCount},t.prototype.calculatePagesAllRows=function(){if(this.masterRowCount=this.rowModel.getRowCount(),0!==this.masterRowCount){var e=this.masterRowCount-1;this.totalPages=Math.floor(e/this.pageSize)+1,this.adjustCurrentPageIfInvalid(),this.topDisplayedRowIndex=this.pageSize*this.currentPage,this.bottomDisplayedRowIndex=this.pageSize*(this.currentPage+1)-1,this.bottomDisplayedRowIndex>e&&(this.bottomDisplayedRowIndex=e)}else this.setZeroRows()},t.prototype.calculatedPagesNotActive=function(){this.pageSize=this.rowModel.getRowCount(),this.totalPages=1,this.currentPage=0,this.topDisplayedRowIndex=0,this.bottomDisplayedRowIndex=this.rowModel.getRowCount()-1},ip([q("rowModel")],t.prototype,"rowModel",void 0),ip([$],t.prototype,"postConstruct",null),t=ip([W("paginationProxy")],t)}(Fe),sp=function(){var e=function(t,o){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])},e(t,o)};return function(t,o){function n(){this.constructor=t}e(t,o),t.prototype=null===o?Object.create(o):(n.prototype=o.prototype,new n)}}(),lp=function(e,t,o,n){var r,i=arguments.length,a=i<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,o):n;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)a=Reflect.decorate(e,t,o,n);else for(var s=e.length-1;s>=0;s--)(r=e[s])&&(a=(i<3?r(a):i>3?r(t,o,a):r(t,o))||a);return i>3&&a&&Object.defineProperty(t,o,a),a},cp=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return sp(t,e),t.prototype.processAllCellClasses=function(e,t,o,n){this.processClassRules(e.cellClassRules,t,o,n),this.processStaticCellClasses(e,t,o)},t.prototype.processClassRules=function(e,t,o,n){if(null!=e){for(var r=Object.keys(e),i={},a={},s=function(o){var n,s=r[o],c=e[s];"string"===typeof c?n=l.expressionService.evaluate(c,t):"function"===typeof c&&(n=c(t)),s.split(" ").forEach((function(e){null!=e&&""!=e.trim()&&(n?i[e]=!0:a[e]=!0)}))},l=this,c=0;c<r.length;c++)s(c);n&&Object.keys(a).forEach(n),Object.keys(i).forEach(o)}},t.prototype.getStaticCellClasses=function(e,t){var o,n=e.cellClass;if(!n)return[];"function"===typeof n?o=n(t):o=n;return"string"===typeof o&&(o=[o]),o||[]},t.prototype.processStaticCellClasses=function(e,t,o){this.getStaticCellClasses(e,t).forEach((function(e){o(e)}))},lp([q("expressionService")],t.prototype,"expressionService",void 0),t=lp([W("stylingService")],t)}(Fe),dp=function(){var e=function(t,o){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])},e(t,o)};return function(t,o){function n(){this.constructor=t}e(t,o),t.prototype=null===o?Object.create(o):(n.prototype=o.prototype,new n)}}(),up=function(e){function t(t){return e.call(this,t,"ag-toggle-button")||this}return dp(t,e),t.prototype.setValue=function(t,o){return e.prototype.setValue.call(this,t,o),this.addOrRemoveCssClass("ag-selected",this.getValue()),this},t}(ti),pp=function(){var e=function(t,o){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])},e(t,o)};return function(t,o){function n(){this.constructor=t}e(t,o),t.prototype=null===o?Object.create(o):(n.prototype=o.prototype,new n)}}(),hp=function(e){function t(t){return e.call(this,t,"ag-text-area",null,"textarea")||this}return pp(t,e),t.prototype.setValue=function(t,o){var n=e.prototype.setValue.call(this,t,o);return this.eInput.value=t,n},t.prototype.setCols=function(e){return this.eInput.cols=e,this},t.prototype.setRows=function(e){return this.eInput.rows=e,this},t}(Zr),fp=function(){var e=function(t,o){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])},e(t,o)};return function(t,o){function n(){this.constructor=t}e(t,o),t.prototype=null===o?Object.create(o):(n.prototype=o.prototype,new n)}}(),gp=function(e){function t(t){return e.call(this,t,"ag-range-field","range")||this}return fp(t,e),t.prototype.postConstruct=function(){e.prototype.postConstruct.call(this);var t=this.config,o=t.min,n=t.max,r=t.step;null!=o&&this.setMinValue(o),null!=n&&this.setMaxValue(n),this.setStep(r||1)},t.prototype.addInputListeners=function(){var e=this;this.addManagedListener(this.eInput,"input",(function(t){var o=t.target.value;e.setValue(o)}))},t.prototype.setMinValue=function(e){return this.min=e,this.eInput.setAttribute("min",e.toString()),this},t.prototype.setMaxValue=function(e){return this.max=e,this.eInput.setAttribute("max",e.toString()),this},t.prototype.setStep=function(e){return this.eInput.setAttribute("step",e.toString()),this},t.prototype.setValue=function(t,o){null!=this.min&&(t=Math.max(parseFloat(t),this.min).toString()),null!=this.max&&(t=Math.min(parseFloat(t),this.max).toString());var n=e.prototype.setValue.call(this,t,o);return this.eInput.value=t,n},t}(Zr),mp=function(){var e=function(t,o){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])},e(t,o)};return function(t,o){function n(){this.constructor=t}e(t,o),t.prototype=null===o?Object.create(o):(n.prototype=o.prototype,new n)}}(),yp=function(e,t,o,n){var r,i=arguments.length,a=i<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,o):n;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)a=Reflect.decorate(e,t,o,n);else for(var s=e.length-1;s>=0;s--)(r=e[s])&&(a=(i<3?r(a):i>3?r(t,o,a):r(t,o))||a);return i>3&&a&&Object.defineProperty(t,o,a),a},vp=function(e){function t(o){var n=e.call(this,o,t.TEMPLATE)||this;return n.labelAlignment="top",n}return mp(t,e),t.prototype.init=function(){this.eSlider.addCssClass("ag-slider-field")},t.prototype.onValueChange=function(e){var t=this,o=Hr.EVENT_CHANGED;return this.addManagedListener(this.eText,o,(function(){var o=parseFloat(t.eText.getValue());t.eSlider.setValue(o.toString(),!0),e(o||0)})),this.addManagedListener(this.eSlider,o,(function(){var o=t.eSlider.getValue();t.eText.setValue(o,!0),e(parseFloat(o))})),this},t.prototype.setSliderWidth=function(e){return this.eSlider.setWidth(e),this},t.prototype.setTextFieldWidth=function(e){return this.eText.setWidth(e),this},t.prototype.setMinValue=function(e){return this.eSlider.setMinValue(e),this.eText.setMin(e),this},t.prototype.setMaxValue=function(e){return this.eSlider.setMaxValue(e),this.eText.setMax(e),this},t.prototype.getValue=function(){return this.eText.getValue()},t.prototype.setValue=function(e){return this.getValue()===e||(this.eText.setValue(e,!0),this.eSlider.setValue(e,!0),this.dispatchEvent({type:Hr.EVENT_CHANGED})),this},t.prototype.setStep=function(e){return this.eSlider.setStep(e),this.eText.setStep(e),this},t.TEMPLATE='<div class="ag-slider">\n            <label ref="eLabel"></label>\n            <div class="ag-wrapper ag-slider-wrapper">\n                <ag-input-range ref="eSlider"></ag-input-range>\n                <ag-input-number-field ref="eText"></ag-input-number-field>\n            </div>\n        </div>',yp([mr("eLabel")],t.prototype,"eLabel",void 0),yp([mr("eSlider")],t.prototype,"eSlider",void 0),yp([mr("eText")],t.prototype,"eText",void 0),yp([$],t.prototype,"init",null),t}(Gr),bp=function(){var e=function(t,o){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])},e(t,o)};return function(t,o){function n(){this.constructor=t}e(t,o),t.prototype=null===o?Object.create(o):(n.prototype=o.prototype,new n)}}(),xp=function(e,t,o,n){var r,i=arguments.length,a=i<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,o):n;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)a=Reflect.decorate(e,t,o,n);else for(var s=e.length-1;s>=0;s--)(r=e[s])&&(a=(i<3?r(a):i>3?r(t,o,a):r(t,o))||a);return i>3&&a&&Object.defineProperty(t,o,a),a},wp=function(e){function t(o){void 0===o&&(o={});var n=e.call(this,t.getTemplate(o))||this;n.suppressEnabledCheckbox=!0,n.suppressOpenCloseIcons=!1;var r=o.title,i=o.enabled,a=o.items,s=o.suppressEnabledCheckbox,l=o.suppressOpenCloseIcons;return n.title=r,n.cssIdentifier=o.cssIdentifier||"default",n.enabled=null==i||i,n.items=a||[],n.alignItems=o.alignItems||"center",null!=s&&(n.suppressEnabledCheckbox=s),null!=l&&(n.suppressOpenCloseIcons=l),n}return bp(t,e),t.getTemplate=function(e){var t=e.cssIdentifier||"default";return'<div class="ag-group ag-'+t+'-group" role="presentation">\n            <div class="ag-group-title-bar ag-'+t+'-group-title-bar ag-unselectable" ref="eTitleBar" role="button">\n                <span class="ag-group-title-bar-icon ag-'+t+'-group-title-bar-icon" ref="eGroupOpenedIcon" role="presentation"></span>\n                <span class="ag-group-title-bar-icon ag-'+t+'-group-title-bar-icon" ref="eGroupClosedIcon" role="presentation"></span>\n                <span ref="eTitle" class="ag-group-title ag-'+t+'-group-title"></span>\n            </div>\n            <div ref="eToolbar" class="ag-group-toolbar ag-'+t+'-group-toolbar">\n                <ag-checkbox ref="cbGroupEnabled"></ag-checkbox>\n            </div>\n            <div ref="eContainer" class="ag-group-container ag-group-container-'+(e.direction||"vertical")+" ag-"+t+'-group-container"></div>\n        </div>'},t.prototype.postConstruct=function(){if(this.items.length){var e=this.items;this.items=[],this.addItems(e)}var t=this.localeService.getLocaleTextFunc();this.cbGroupEnabled.setLabel(t("enabled","Enabled")),this.title&&this.setTitle(this.title),this.enabled&&this.setEnabled(this.enabled),this.setAlignItems(this.alignItems),this.hideEnabledCheckbox(this.suppressEnabledCheckbox),this.hideOpenCloseIcons(this.suppressOpenCloseIcons),this.setupExpandContract(),this.refreshAriaStatus(),this.refreshChildDisplay()},t.prototype.setupExpandContract=function(){var e=this;this.eGroupClosedIcon.appendChild(Fn("columnSelectClosed",this.gridOptionsService,null)),this.eGroupOpenedIcon.appendChild(Fn("columnSelectOpen",this.gridOptionsService,null)),this.addManagedListener(this.eTitleBar,"click",(function(){return e.toggleGroupExpand()})),this.addManagedListener(this.eTitleBar,"keydown",(function(t){switch(t.key){case Hn.ENTER:case Hn.SPACE:t.preventDefault(),e.toggleGroupExpand();break;case Hn.RIGHT:case Hn.LEFT:t.preventDefault(),e.toggleGroupExpand(t.key===Hn.RIGHT)}}))},t.prototype.refreshAriaStatus=function(){this.suppressOpenCloseIcons||to(this.eTitleBar,this.expanded)},t.prototype.refreshChildDisplay=function(){var e=!this.suppressOpenCloseIcons;on(this.eToolbar,this.expanded&&!this.suppressEnabledCheckbox),on(this.eGroupOpenedIcon,e&&this.expanded),on(this.eGroupClosedIcon,e&&!this.expanded)},t.prototype.isExpanded=function(){return this.expanded},t.prototype.setAlignItems=function(e){this.alignItems!==e&&this.removeCssClass("ag-group-item-alignment-"+this.alignItems),this.alignItems=e;var t="ag-group-item-alignment-"+this.alignItems;return this.addCssClass(t),this},t.prototype.toggleGroupExpand=function(e){return this.suppressOpenCloseIcons?(this.expanded=!0,this.refreshChildDisplay(),on(this.eContainer,!0),this):(e=null!=e?e:!this.expanded,this.expanded===e||(this.expanded=e,this.refreshAriaStatus(),this.refreshChildDisplay(),on(this.eContainer,e),this.dispatchEvent({type:this.expanded?t.EVENT_EXPANDED:t.EVENT_COLLAPSED})),this)},t.prototype.addItems=function(e){var t=this;e.forEach((function(e){return t.addItem(e)}))},t.prototype.addItem=function(e){var t=this.eContainer,o=e instanceof fr?e.getGui():e;o.classList.add("ag-group-item","ag-"+this.cssIdentifier+"-group-item"),t.appendChild(o),this.items.push(o)},t.prototype.hideItem=function(e,t){on(this.items[t],!e)},t.prototype.setTitle=function(e){return this.eTitle.innerText=e,this},t.prototype.addCssClassToTitleBar=function(e){this.eTitleBar.classList.add(e)},t.prototype.setEnabled=function(e,t){return this.enabled=e,this.refreshDisabledStyles(),this.toggleGroupExpand(e),t||this.cbGroupEnabled.setValue(e),this},t.prototype.isEnabled=function(){return this.enabled},t.prototype.onEnableChange=function(e){var t=this;return this.cbGroupEnabled.onValueChange((function(o){t.setEnabled(o,!0),e(o)})),this},t.prototype.hideEnabledCheckbox=function(e){return this.suppressEnabledCheckbox=e,this.refreshChildDisplay(),this.refreshDisabledStyles(),this},t.prototype.hideOpenCloseIcons=function(e){return this.suppressOpenCloseIcons=e,e&&this.toggleGroupExpand(!0),this},t.prototype.refreshDisabledStyles=function(){this.addOrRemoveCssClass("ag-disabled",!this.enabled),this.suppressEnabledCheckbox&&!this.enabled?(this.eTitleBar.classList.add("ag-disabled-group-title-bar"),this.eTitleBar.removeAttribute("tabindex")):(this.eTitleBar.classList.remove("ag-disabled-group-title-bar"),this.eTitleBar.setAttribute("tabindex","0")),this.eContainer.classList.toggle("ag-disabled-group-container",!this.enabled)},t.EVENT_EXPANDED="expanded",t.EVENT_COLLAPSED="collapsed",xp([mr("eTitleBar")],t.prototype,"eTitleBar",void 0),xp([mr("eGroupOpenedIcon")],t.prototype,"eGroupOpenedIcon",void 0),xp([mr("eGroupClosedIcon")],t.prototype,"eGroupClosedIcon",void 0),xp([mr("eToolbar")],t.prototype,"eToolbar",void 0),xp([mr("cbGroupEnabled")],t.prototype,"cbGroupEnabled",void 0),xp([mr("eTitle")],t.prototype,"eTitle",void 0),xp([mr("eContainer")],t.prototype,"eContainer",void 0),xp([$],t.prototype,"postConstruct",null),t}(fr),Cp=function(){var e=function(t,o){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])},e(t,o)};return function(t,o){function n(){this.constructor=t}e(t,o),t.prototype=null===o?Object.create(o):(n.prototype=o.prototype,new n)}}(),_p=function(e,t,o,n){var r,i=arguments.length,a=i<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,o):n;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)a=Reflect.decorate(e,t,o,n);else for(var s=e.length-1;s>=0;s--)(r=e[s])&&(a=(i<3?r(a):i>3?r(t,o,a):r(t,o))||a);return i>3&&a&&Object.defineProperty(t,o,a),a};!function(e){e.TAB_GUARD="ag-tab-guard",e.TAB_GUARD_TOP="ag-tab-guard-top",e.TAB_GUARD_BOTTOM="ag-tab-guard-bottom"}(Ju||(Ju={}));var Sp,Ep=function(e){function t(t){var o=e.call(this)||this;o.skipTabGuardFocus=!1;var n=t.comp,r=t.eTopGuard,i=t.eBottomGuard,a=t.focusInnerElement,s=t.onFocusIn,l=t.onFocusOut,c=t.shouldStopEventPropagation,d=t.onTabKeyDown,u=t.handleKeyDown,p=t.eFocusableElement;return o.comp=n,o.eTopGuard=r,o.eBottomGuard=i,o.providedFocusInnerElement=a,o.eFocusableElement=p,o.providedFocusIn=s,o.providedFocusOut=l,o.providedShouldStopEventPropagation=c,o.providedOnTabKeyDown=d,o.providedHandleKeyDown=u,o}return Cp(t,e),t.prototype.postConstruct=function(){var e=this;this.createManagedBean(new Ar(this.eFocusableElement,{shouldStopEventPropagation:function(){return e.shouldStopEventPropagation()},onTabKeyDown:function(t){return e.onTabKeyDown(t)},handleKeyDown:function(t){return e.handleKeyDown(t)},onFocusIn:function(t){return e.onFocusIn(t)},onFocusOut:function(t){return e.onFocusOut(t)}})),this.activateTabGuards(),[this.eTopGuard,this.eBottomGuard].forEach((function(t){return e.addManagedListener(t,"focus",e.onFocus.bind(e))}))},t.prototype.handleKeyDown=function(e){this.providedHandleKeyDown&&this.providedHandleKeyDown(e)},t.prototype.tabGuardsAreActive=function(){return!!this.eTopGuard&&this.eTopGuard.hasAttribute("tabIndex")},t.prototype.shouldStopEventPropagation=function(){return!!this.providedShouldStopEventPropagation&&this.providedShouldStopEventPropagation()},t.prototype.activateTabGuards=function(){this.comp.setTabIndex(this.getGridTabIndex())},t.prototype.deactivateTabGuards=function(){this.comp.setTabIndex()},t.prototype.onFocus=function(e){if(this.skipTabGuardFocus)this.skipTabGuardFocus=!1;else{var t=e.target===this.eBottomGuard;this.providedFocusInnerElement?this.providedFocusInnerElement(t):this.focusInnerElement(t)}},t.prototype.onFocusIn=function(e){this.providedFocusIn&&this.providedFocusIn(e)||this.deactivateTabGuards()},t.prototype.onFocusOut=function(e){this.providedFocusOut&&this.providedFocusOut(e)||this.eFocusableElement.contains(e.relatedTarget)||this.activateTabGuards()},t.prototype.onTabKeyDown=function(e){var t=this;if(this.providedOnTabKeyDown)this.providedOnTabKeyDown(e);else if(!e.defaultPrevented){var o=this.tabGuardsAreActive();o&&this.deactivateTabGuards();var n=this.getNextFocusableElement(e.shiftKey);o&&setTimeout((function(){return t.activateTabGuards()}),0),n&&(n.focus(),e.preventDefault())}},t.prototype.getGridTabIndex=function(){return(this.gridOptionsService.getNum("tabIndex")||0).toString()},t.prototype.focusInnerElement=function(e){void 0===e&&(e=!1);var t=this.focusService.findFocusableElements(this.eFocusableElement);this.tabGuardsAreActive()&&(t.splice(0,1),t.splice(t.length-1,1)),t.length&&t[e?t.length-1:0].focus({preventScroll:!0})},t.prototype.getNextFocusableElement=function(e){return this.focusService.findNextFocusableElement(this.eFocusableElement,!1,e)},t.prototype.forceFocusOutOfContainer=function(e){void 0===e&&(e=!1);var t=e?this.eTopGuard:this.eBottomGuard;this.activateTabGuards(),this.skipTabGuardFocus=!0,t.focus()},_p([q("focusService")],t.prototype,"focusService",void 0),_p([$],t.prototype,"postConstruct",null),t}(Fe),kp=function(){var e=function(t,o){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])},e(t,o)};return function(t,o){function n(){this.constructor=t}e(t,o),t.prototype=null===o?Object.create(o):(n.prototype=o.prototype,new n)}}(),jp=function(e,t){var o="function"===typeof Symbol&&e[Symbol.iterator];if(!o)return e;var n,r,i=o.call(e),a=[];try{for(;(void 0===t||t-- >0)&&!(n=i.next()).done;)a.push(n.value)}catch(s){r={error:s}}finally{try{n&&!n.done&&(o=i.return)&&o.call(i)}finally{if(r)throw r.error}}return a},Ap=function(){for(var e=[],t=0;t<arguments.length;t++)e=e.concat(jp(arguments[t]));return e},Rp=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return kp(t,e),t.prototype.initialiseTabGuard=function(e){this.eTopGuard=this.createTabGuard("top"),this.eBottomGuard=this.createTabGuard("bottom"),this.eFocusableElement=this.getFocusableElement();var t=[this.eTopGuard,this.eBottomGuard],o={setTabIndex:function(e){t.forEach((function(t){return null!=e?t.setAttribute("tabIndex",e):t.removeAttribute("tabIndex")}))}};this.addTabGuards(this.eTopGuard,this.eBottomGuard),this.tabGuardCtrl=this.createManagedBean(new Ep({comp:o,eTopGuard:this.eTopGuard,eBottomGuard:this.eBottomGuard,eFocusableElement:this.eFocusableElement,onFocusIn:e.onFocusIn,onFocusOut:e.onFocusOut,focusInnerElement:e.focusInnerElement,handleKeyDown:e.handleKeyDown,onTabKeyDown:e.onTabKeyDown,shouldStopEventPropagation:e.shouldStopEventPropagation}))},t.prototype.createTabGuard=function(e){var t=document.createElement("div"),o="top"===e?Ju.TAB_GUARD_TOP:Ju.TAB_GUARD_BOTTOM;return t.classList.add(Ju.TAB_GUARD,o),$t(t,"presentation"),t},t.prototype.addTabGuards=function(e,t){this.eFocusableElement.insertAdjacentElement("afterbegin",e),this.eFocusableElement.insertAdjacentElement("beforeend",t)},t.prototype.removeAllChildrenExceptTabGuards=function(){var e=[this.eTopGuard,this.eBottomGuard];gn(this.getFocusableElement()),this.addTabGuards.apply(this,Ap(e))},t.prototype.forceFocusOutOfContainer=function(e){void 0===e&&(e=!1),this.tabGuardCtrl.forceFocusOutOfContainer(e)},t.prototype.appendChild=function(t,o){Tn(t)||(t=t.getGui());var n=this.eBottomGuard;n?n.insertAdjacentElement("beforebegin",t):e.prototype.appendChild.call(this,t,o)},t}(fr),Op=function(){var e=function(t,o){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])},e(t,o)};return function(t,o){function n(){this.constructor=t}e(t,o),t.prototype=null===o?Object.create(o):(n.prototype=o.prototype,new n)}}(),Tp=function(){return Tp=Object.assign||function(e){for(var t,o=1,n=arguments.length;o<n;o++)for(var r in t=arguments[o])Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e},Tp.apply(this,arguments)},Dp=function(e,t,o,n){var r,i=arguments.length,a=i<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,o):n;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)a=Reflect.decorate(e,t,o,n);else for(var s=e.length-1;s>=0;s--)(r=e[s])&&(a=(i<3?r(a):i>3?r(t,o,a):r(t,o))||a);return i>3&&a&&Object.defineProperty(t,o,a),a},Pp=function(e){function t(t){void 0===t&&(t=1);var o=e.call(this,'<div class="ag-menu-list" role="tree"></div>')||this;return o.level=t,o.menuItems=[],o}return Op(t,e),t.prototype.postConstruct=function(){var e=this;this.initialiseTabGuard({onTabKeyDown:function(t){return e.onTabKeyDown(t)},handleKeyDown:function(t){return e.handleKeyDown(t)}})},t.prototype.onTabKeyDown=function(e){var t=this.getParentComponent(),o=t&&t.getGui();o&&o.classList.contains("ag-focus-managed")||e.preventDefault(),e.shiftKey&&this.closeIfIsChild(e)},t.prototype.handleKeyDown=function(e){switch(e.key){case Hn.UP:case Hn.RIGHT:case Hn.DOWN:case Hn.LEFT:e.preventDefault(),this.handleNavKey(e.key);break;case Hn.ESCAPE:var t=this.findTopMenu();t&&this.focusService.focusInto(t.getGui())}},t.prototype.clearActiveItem=function(){this.activeMenuItem&&(this.activeMenuItem.deactivate(),this.activeMenuItem=null)},t.prototype.addMenuItems=function(e){var t=this;null!=e&&e.forEach((function(e){"separator"===e?t.addSeparator():"string"===typeof e?console.warn("AG Grid: unrecognised menu item "+e):t.addItem(e)}))},t.prototype.addItem=function(e){var t=this,o=this.createManagedBean(new Gp(Tp(Tp({},e),{isAnotherSubMenuOpen:function(){return t.menuItems.some((function(e){return e.isSubMenuOpen()}))}})));o.setParentComponent(this),Qt(o.getGui(),this.level),this.menuItems.push(o),this.appendChild(o.getGui()),this.addManagedListener(o,Gp.EVENT_MENU_ITEM_SELECTED,(function(e){t.dispatchEvent(e)})),this.addManagedListener(o,Gp.EVENT_MENU_ITEM_ACTIVATED,(function(e){t.activeMenuItem&&t.activeMenuItem!==e.menuItem&&t.activeMenuItem.deactivate(),t.activeMenuItem=e.menuItem}))},t.prototype.activateFirstItem=function(){var e=this.menuItems.filter((function(e){return!e.isDisabled()}))[0];e&&e.activate()},t.prototype.addSeparator=function(){this.appendChild(vn('\n            <div class="ag-menu-separator" aria-hidden="true">\n                <div class="ag-menu-separator-part"></div>\n                <div class="ag-menu-separator-part"></div>\n                <div class="ag-menu-separator-part"></div>\n                <div class="ag-menu-separator-part"></div>\n            </div>'))},t.prototype.findTopMenu=function(){var e=this.getParentComponent();if(!e&&this instanceof t)return this;for(;;){var o=e&&e.getParentComponent&&e.getParentComponent();if(!o||!(o instanceof t||o instanceof Gp))break;e=o}return e instanceof t?e:void 0},t.prototype.handleNavKey=function(e){switch(e){case Hn.UP:case Hn.DOWN:var t=this.findNextItem(e===Hn.UP);return void(t&&t!==this.activeMenuItem&&t.activate())}e===(this.gridOptionsService.is("enableRtl")?Hn.RIGHT:Hn.LEFT)?this.closeIfIsChild():this.openChild()},t.prototype.closeIfIsChild=function(e){var t=this.getParentComponent();t&&t instanceof Gp&&(e&&e.preventDefault(),t.closeSubMenu(),t.getGui().focus())},t.prototype.openChild=function(){this.activeMenuItem&&this.activeMenuItem.openSubMenu(!0)},t.prototype.findNextItem=function(e){var t=this.menuItems.filter((function(e){return!e.isDisabled()}));if(t.length){if(!this.activeMenuItem)return e?fe(t):t[0];var o;e&&t.reverse();for(var n=!1,r=0;r<t.length;r++){var i=t[r];if(n){o=i;break}i===this.activeMenuItem&&(n=!0)}return o||this.activeMenuItem}},t.prototype.destroy=function(){this.clearActiveItem(),e.prototype.destroy.call(this)},Dp([q("focusService")],t.prototype,"focusService",void 0),Dp([$],t.prototype,"postConstruct",null),t}(Rp),Np=function(){var e=function(t,o){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])},e(t,o)};return function(t,o){function n(){this.constructor=t}e(t,o),t.prototype=null===o?Object.create(o):(n.prototype=o.prototype,new n)}}(),Ip=function(e,t,o,n){var r,i=arguments.length,a=i<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,o):n;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)a=Reflect.decorate(e,t,o,n);else for(var s=e.length-1;s>=0;s--)(r=e[s])&&(a=(i<3?r(a):i>3?r(t,o,a):r(t,o))||a);return i>3&&a&&Object.defineProperty(t,o,a),a},Mp=function(e){function t(t){var o=e.call(this)||this;return o.wrappedComponent=t,o.setTemplateFromElement(t.getGui()),o}return Np(t,e),t.prototype.postConstruct=function(){var e=this;this.initialiseTabGuard({onTabKeyDown:function(t){return e.onTabKeyDown(t)},handleKeyDown:function(t){return e.handleKeyDown(t)}})},t.prototype.handleKeyDown=function(e){e.key===Hn.ESCAPE&&this.closePanel()},t.prototype.onTabKeyDown=function(e){e.defaultPrevented||(this.closePanel(),e.preventDefault())},t.prototype.closePanel=function(){var e=this.parentComponent;e.closeSubMenu(),setTimeout((function(){return e.getGui().focus()}),0)},Ip([$],t.prototype,"postConstruct",null),t}(Rp),Lp=function(){var e=function(t,o){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])},e(t,o)};return function(t,o){function n(){this.constructor=t}e(t,o),t.prototype=null===o?Object.create(o):(n.prototype=o.prototype,new n)}}(),Fp=function(e,t,o,n){var r,i=arguments.length,a=i<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,o):n;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)a=Reflect.decorate(e,t,o,n);else for(var s=e.length-1;s>=0;s--)(r=e[s])&&(a=(i<3?r(a):i>3?r(t,o,a):r(t,o))||a);return i>3&&a&&Object.defineProperty(t,o,a),a},Gp=function(e){function t(t){var o=e.call(this)||this;return o.params=t,o.isActive=!1,o.subMenuIsOpen=!1,o.setTemplate('<div class="'+o.getClassName()+'" tabindex="-1" role="treeitem"></div>'),o}return Lp(t,e),t.prototype.init=function(){var e=this;this.addIcon(),this.addName(),this.addShortcut(),this.addSubMenu(),this.addTooltip();var t=this.getGui();this.params.disabled?(this.addCssClass(this.getClassName("disabled")),Zt(t,!0)):(this.addGuiEventListener("click",(function(t){return e.onItemSelected(t)})),this.addGuiEventListener("keydown",(function(t){t.key!==Hn.ENTER&&t.key!==Hn.SPACE||(t.preventDefault(),e.onItemSelected(t))})),this.addGuiEventListener("mousedown",(function(e){e.stopPropagation(),e.preventDefault()})),this.addGuiEventListener("mouseenter",(function(){return e.onMouseEnter()})),this.addGuiEventListener("mouseleave",(function(){return e.onMouseLeave()}))),this.params.cssClasses&&this.params.cssClasses.forEach((function(t){return e.addCssClass(t)}))},t.prototype.isDisabled=function(){return!!this.params.disabled},t.prototype.openSubMenu=function(e){var o=this;if(void 0===e&&(e=!1),this.closeSubMenu(),this.params.subMenu){var n,r=vn('<div class="ag-menu" role="presentation"></div>');if(this.params.subMenu instanceof Array){var i=Wt(this.getGui()),a=isNaN(i)?1:i+1,s=this.createBean(new Pp(a));s.setParentComponent(this),s.addMenuItems(this.params.subMenu),r.appendChild(s.getGui()),this.addManagedListener(s,t.EVENT_MENU_ITEM_SELECTED,(function(e){return o.dispatchEvent(e)})),s.addGuiEventListener("mouseenter",(function(){return o.cancelDeactivate()})),n=function(){return o.destroyBean(s)},e&&setTimeout((function(){return s.activateFirstItem()}),0)}else{var l=this.params.subMenu,c=this.createBean(new Mp(l));c.setParentComponent(this);var d=c.getGui(),u="mouseenter",p=function(){return o.cancelDeactivate()};d.addEventListener(u,p),n=function(){return d.removeEventListener(u,p)},r.appendChild(d),l.afterGuiAttached&&setTimeout((function(){return l.afterGuiAttached()}),0)}var h=this.getGui(),f=this.popupService.positionPopupForMenu.bind(this.popupService,{eventSource:h,ePopup:r}),g=this.localeService.getLocaleTextFunc(),m=this.popupService.addPopup({modal:!0,eChild:r,positionCallback:f,anchorToElement:h,ariaLabel:g("ariaLabelSubMenu","SubMenu")});this.subMenuIsOpen=!0,to(h,!0),this.hideSubMenu=function(){m&&m.hideFunc(),o.subMenuIsOpen=!1,to(h,!1),n()}}},t.prototype.closeSubMenu=function(){this.hideSubMenu&&(this.hideSubMenu(),this.hideSubMenu=null,to(this.getGui(),!1))},t.prototype.isSubMenuOpen=function(){return this.subMenuIsOpen},t.prototype.activate=function(e){var t=this;this.cancelActivate(),this.params.disabled||(this.isActive=!0,this.addCssClass(this.getClassName("active")),this.getGui().focus(),e&&this.params.subMenu&&window.setTimeout((function(){t.isAlive()&&t.isActive&&t.openSubMenu()}),300),this.onItemActivated())},t.prototype.deactivate=function(){this.cancelDeactivate(),this.removeCssClass(this.getClassName("active")),this.isActive=!1,this.subMenuIsOpen&&this.hideSubMenu()},t.prototype.addIcon=function(){if(this.params.checked||this.params.icon||!this.params.isCompact){var e=vn('<span ref="eIcon" class="'+this.getClassName("part")+" "+this.getClassName("icon")+'" role="presentation"></span>');this.params.checked?e.appendChild(Gn("check",this.gridOptionsService)):this.params.icon&&(Tn(this.params.icon)?e.appendChild(this.params.icon):"string"===typeof this.params.icon?e.innerHTML=this.params.icon:console.warn("AG Grid: menu item icon must be DOM node or string")),this.getGui().appendChild(e)}},t.prototype.addName=function(){if(this.params.name||!this.params.isCompact){var e=vn('<span ref="eName" class="'+this.getClassName("part")+" "+this.getClassName("text")+'">'+(this.params.name||"")+"</span>");this.getGui().appendChild(e)}},t.prototype.addTooltip=function(){this.params.tooltip&&(this.tooltip=this.params.tooltip,this.gridOptionsService.is("enableBrowserTooltips")?this.getGui().setAttribute("title",this.tooltip):this.createManagedBean(new cr(this)))},t.prototype.getTooltipParams=function(){return{location:"menu",value:this.tooltip}},t.prototype.addShortcut=function(){if(this.params.shortcut||!this.params.isCompact){var e=vn('<span ref="eShortcut" class="'+this.getClassName("part")+" "+this.getClassName("shortcut")+'">'+(this.params.shortcut||"")+"</span>");this.getGui().appendChild(e)}},t.prototype.addSubMenu=function(){if(this.params.subMenu||!this.params.isCompact){var e=vn('<span ref="ePopupPointer" class="'+this.getClassName("part")+" "+this.getClassName("popup-pointer")+'"></span>'),t=this.getGui();if(this.params.subMenu){var o=this.gridOptionsService.is("enableRtl")?"smallLeft":"smallRight";to(t,!1),e.appendChild(Gn(o,this.gridOptionsService))}t.appendChild(e)}},t.prototype.onItemSelected=function(e){if(this.params.action?this.params.action():this.openSubMenu(e&&"keydown"===e.type),!this.params.subMenu||this.params.action){var o={type:t.EVENT_MENU_ITEM_SELECTED,action:this.params.action,checked:this.params.checked,cssClasses:this.params.cssClasses,disabled:this.params.disabled,icon:this.params.icon,name:this.params.name,shortcut:this.params.shortcut,subMenu:this.params.subMenu,tooltip:this.params.tooltip,event:e};this.dispatchEvent(o)}},t.prototype.onItemActivated=function(){var e={type:t.EVENT_MENU_ITEM_ACTIVATED,menuItem:this};this.dispatchEvent(e)},t.prototype.cancelActivate=function(){this.activateTimeoutId&&(window.clearTimeout(this.activateTimeoutId),this.activateTimeoutId=0)},t.prototype.cancelDeactivate=function(){this.deactivateTimeoutId&&(window.clearTimeout(this.deactivateTimeoutId),this.deactivateTimeoutId=0)},t.prototype.onMouseEnter=function(){var e=this;this.cancelDeactivate(),this.params.isAnotherSubMenuOpen()?this.activateTimeoutId=window.setTimeout((function(){return e.activate(!0)}),t.ACTIVATION_DELAY):this.activate(!0)},t.prototype.onMouseLeave=function(){var e=this;this.cancelActivate(),this.isSubMenuOpen()?this.deactivateTimeoutId=window.setTimeout((function(){return e.deactivate()}),t.ACTIVATION_DELAY):this.deactivate()},t.prototype.getClassName=function(e){var t=this.params.isCompact?"ag-compact-menu-option":"ag-menu-option";return e?t+"-"+e:t},t.EVENT_MENU_ITEM_SELECTED="menuItemSelected",t.EVENT_MENU_ITEM_ACTIVATED="menuItemActivated",t.ACTIVATION_DELAY=80,Fp([q("popupService")],t.prototype,"popupService",void 0),Fp([$],t.prototype,"init",null),t}(fr),zp=function(){var e=function(t,o){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])},e(t,o)};return function(t,o){function n(){this.constructor=t}e(t,o),t.prototype=null===o?Object.create(o):(n.prototype=o.prototype,new n)}}(),Hp=function(e,t,o,n){var r,i=arguments.length,a=i<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,o):n;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)a=Reflect.decorate(e,t,o,n);else for(var s=e.length-1;s>=0;s--)(r=e[s])&&(a=(i<3?r(a):i>3?r(t,o,a):r(t,o))||a);return i>3&&a&&Object.defineProperty(t,o,a),a},Bp=function(e){function t(o){var n=e.call(this,t.getTemplate(o))||this;return n.closable=!0,n.config=o,n}return zp(t,e),t.getTemplate=function(e){var t=e&&e.cssIdentifier||"default";return'<div class="ag-panel ag-'+t+'-panel" tabindex="-1">\n            <div ref="eTitleBar" class="ag-panel-title-bar ag-'+t+'-panel-title-bar ag-unselectable">\n                <span ref="eTitle" class="ag-panel-title-bar-title ag-'+t+'-panel-title-bar-title"></span>\n                <div ref="eTitleBarButtons" class="ag-panel-title-bar-buttons ag-'+t+'-panel-title-bar-buttons"></div>\n            </div>\n            <div ref="eContentWrapper" class="ag-panel-content-wrapper ag-'+t+'-panel-content-wrapper"></div>\n        </div>'},t.prototype.postConstruct=function(){var e=this,t=this.config,o=t.component,n=t.closable,r=t.hideTitleBar,i=t.title,a=t.minWidth,s=void 0===a?250:a,l=t.width,c=t.minHeight,d=void 0===c?250:c,u=t.height,p=t.centered,h=t.popup,f=t.x,g=t.y;this.positionableFeature=new Pr(this.getGui(),{minWidth:s,width:l,minHeight:d,height:u,centered:p,x:f,y:g,popup:h,calculateTopBuffer:function(){return e.positionableFeature.getHeight()-e.getBodyHeight()}}),this.createManagedBean(this.positionableFeature);var m=this.getGui();o&&this.setBodyComponent(o),r?on(this.eTitleBar,!1):(i&&this.setTitle(i),this.setClosable(null!=n?n:this.closable)),this.addManagedListener(this.eTitleBar,"mousedown",(function(t){var o=e.gridOptionsService.getDocument();if(m.contains(t.relatedTarget)||m.contains(o.activeElement)||e.eTitleBarButtons.contains(t.target))t.preventDefault();else{var n=e.eContentWrapper.querySelector("button, [href], input, select, textarea, [tabindex]");n&&n.focus()}})),h&&this.positionableFeature.isPositioned()||(this.renderComponent&&this.renderComponent(),this.positionableFeature.initialisePosition(),this.eContentWrapper.style.height="0")},t.prototype.renderComponent=function(){var e=this,t=this.getGui();t.focus(),this.close=function(){t.parentElement.removeChild(t),e.destroy()}},t.prototype.getHeight=function(){return this.positionableFeature.getHeight()},t.prototype.setHeight=function(e){this.positionableFeature.setHeight(e)},t.prototype.getWidth=function(){return this.positionableFeature.getWidth()},t.prototype.setWidth=function(e){this.positionableFeature.setWidth(e)},t.prototype.setClosable=function(e){if(e!==this.closable&&(this.closable=e),e){var o=this.closeButtonComp=new fr(t.CLOSE_BTN_TEMPLATE);this.getContext().createBean(o);var n=o.getGui(),r=Gn("close",this.gridOptionsService);r.classList.add("ag-panel-title-bar-button-icon"),n.appendChild(r),this.addTitleBarButton(o),o.addManagedListener(n,"click",this.onBtClose.bind(this))}else if(this.closeButtonComp){(n=this.closeButtonComp.getGui()).parentElement.removeChild(n),this.closeButtonComp=this.destroyBean(this.closeButtonComp)}},t.prototype.setBodyComponent=function(e){e.setParentComponent(this),this.eContentWrapper.appendChild(e.getGui())},t.prototype.addTitleBarButton=function(e,t){var o=this.eTitleBarButtons,n=o.children,r=n.length;null==t&&(t=r),t=Math.max(0,Math.min(t,r)),e.addCssClass("ag-panel-title-bar-button");var i=e.getGui();0===t?o.insertAdjacentElement("afterbegin",i):t===r?o.insertAdjacentElement("beforeend",i):n[t-1].insertAdjacentElement("afterend",i),e.setParentComponent(this)},t.prototype.getBodyHeight=function(){return ln(this.eContentWrapper)},t.prototype.getBodyWidth=function(){return cn(this.eContentWrapper)},t.prototype.setTitle=function(e){this.eTitle.innerText=e},t.prototype.onBtClose=function(){this.close()},t.prototype.destroy=function(){this.closeButtonComp&&(this.closeButtonComp=this.destroyBean(this.closeButtonComp));var t=this.getGui();t&&t.offsetParent&&this.close(),e.prototype.destroy.call(this)},t.CLOSE_BTN_TEMPLATE='<div class="ag-button"></div>',Hp([mr("eContentWrapper")],t.prototype,"eContentWrapper",void 0),Hp([mr("eTitleBar")],t.prototype,"eTitleBar",void 0),Hp([mr("eTitleBarButtons")],t.prototype,"eTitleBarButtons",void 0),Hp([mr("eTitle")],t.prototype,"eTitle",void 0),Hp([$],t.prototype,"postConstruct",null),t}(fr),Vp=function(){var e=function(t,o){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])},e(t,o)};return function(t,o){function n(){this.constructor=t}e(t,o),t.prototype=null===o?Object.create(o):(n.prototype=o.prototype,new n)}}(),$p=function(){return $p=Object.assign||function(e){for(var t,o=1,n=arguments.length;o<n;o++)for(var r in t=arguments[o])Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e},$p.apply(this,arguments)},Up=function(e,t,o,n){var r,i=arguments.length,a=i<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,o):n;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)a=Reflect.decorate(e,t,o,n);else for(var s=e.length-1;s>=0;s--)(r=e[s])&&(a=(i<3?r(a):i>3?r(t,o,a):r(t,o))||a);return i>3&&a&&Object.defineProperty(t,o,a),a},Wp=function(e){function t(t){var o=e.call(this,$p($p({},t),{popup:!0}))||this;return o.isMaximizable=!1,o.isMaximized=!1,o.maximizeListeners=[],o.resizeListenerDestroy=null,o.lastPosition={x:0,y:0,width:0,height:0},o}return Vp(t,e),t.prototype.postConstruct=function(){var t=this,o=this.getGui(),n=this.config,r=n.movable,i=n.resizable,a=n.maximizable;this.addCssClass("ag-dialog"),e.prototype.postConstruct.call(this),this.addManagedListener(o,"focusin",(function(e){o.contains(e.relatedTarget)||t.popupService.bringPopupToFront(o)})),r&&this.setMovable(r),a&&this.setMaximizable(a),i&&this.setResizable(i)},t.prototype.renderComponent=function(){var e=this.getGui(),t=this.config,o=t.alwaysOnTop,n=t.modal,r=t.title,i=this.localeService.getLocaleTextFunc(),a=this.popupService.addPopup({modal:n,eChild:e,closeOnEsc:!0,closedCallback:this.destroy.bind(this),alwaysOnTop:o,ariaLabel:r||i("ariaLabelDialog","Dialog")});a&&(this.close=a.hideFunc)},t.prototype.toggleMaximize=function(){var e=this.positionableFeature.getPosition();if(this.isMaximized){var t=this.lastPosition,o=t.x,n=t.y,r=t.width,i=t.height;this.setWidth(r),this.setHeight(i),this.positionableFeature.offsetElement(o,n)}else this.lastPosition.width=this.getWidth(),this.lastPosition.height=this.getHeight(),this.lastPosition.x=e.x,this.lastPosition.y=e.y,this.positionableFeature.offsetElement(0,0),this.setHeight("100%"),this.setWidth("100%");this.isMaximized=!this.isMaximized,this.refreshMaximizeIcon()},t.prototype.refreshMaximizeIcon=function(){on(this.maximizeIcon,!this.isMaximized),on(this.minimizeIcon,this.isMaximized)},t.prototype.clearMaximizebleListeners=function(){this.maximizeListeners.length&&(this.maximizeListeners.forEach((function(e){return e()})),this.maximizeListeners.length=0),this.resizeListenerDestroy&&(this.resizeListenerDestroy(),this.resizeListenerDestroy=null)},t.prototype.destroy=function(){this.maximizeButtonComp=this.destroyBean(this.maximizeButtonComp),this.clearMaximizebleListeners(),e.prototype.destroy.call(this)},t.prototype.setResizable=function(e){this.positionableFeature.setResizable(e)},t.prototype.setMovable=function(e){this.positionableFeature.setMovable(e,this.eTitleBar)},t.prototype.setMaximizable=function(e){var t=this;if(!e)return this.clearMaximizebleListeners(),void(this.maximizeButtonComp&&(this.destroyBean(this.maximizeButtonComp),this.maximizeButtonComp=this.maximizeIcon=this.minimizeIcon=void 0));var o=this.eTitleBar;if(o&&e!==this.isMaximizable){var n=this.buildMaximizeAndMinimizeElements();this.refreshMaximizeIcon(),n.addManagedListener(n.getGui(),"click",this.toggleMaximize.bind(this)),this.addTitleBarButton(n,0),this.maximizeListeners.push(this.addManagedListener(o,"dblclick",this.toggleMaximize.bind(this))),this.resizeListenerDestroy=this.addManagedListener(this,"resize",(function(){t.isMaximized=!1,t.refreshMaximizeIcon()}))}},t.prototype.buildMaximizeAndMinimizeElements=function(){var e=this.maximizeButtonComp=this.createBean(new fr('<div class="ag-dialog-button"></span>')),t=e.getGui();return this.maximizeIcon=Gn("maximize",this.gridOptionsService),t.appendChild(this.maximizeIcon),this.maximizeIcon.classList.add("ag-panel-title-bar-button-icon"),this.minimizeIcon=Gn("minimize",this.gridOptionsService),t.appendChild(this.minimizeIcon),this.minimizeIcon.classList.add("ag-panel-title-bar-button-icon"),e},Up([q("popupService")],t.prototype,"popupService",void 0),t}(Bp),qp=function(){var e=function(t,o){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])},e(t,o)};return function(t,o){function n(){this.constructor=t}e(t,o),t.prototype=null===o?Object.create(o):(n.prototype=o.prototype,new n)}}(),Kp=function(){return Kp=Object.assign||function(e){for(var t,o=1,n=arguments.length;o<n;o++)for(var r in t=arguments[o])Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e},Kp.apply(this,arguments)},Yp=function(e,t,o,n){var r,i=arguments.length,a=i<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,o):n;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)a=Reflect.decorate(e,t,o,n);else for(var s=e.length-1;s>=0;s--)(r=e[s])&&(a=(i<3?r(a):i>3?r(t,o,a):r(t,o))||a);return i>3&&a&&Object.defineProperty(t,o,a),a},Jp=function(e,t){var o="function"===typeof Symbol&&e[Symbol.iterator];if(!o)return e;var n,r,i=o.call(e),a=[];try{for(;(void 0===t||t-- >0)&&!(n=i.next()).done;)a.push(n.value)}catch(s){r={error:s}}finally{try{n&&!n.done&&(o=i.return)&&o.call(i)}finally{if(r)throw r.error}}return a},Xp=function(){for(var e=[],t=0;t<arguments.length;t++)e=e.concat(Jp(arguments[t]));return e},Qp=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}var o;return qp(t,e),o=t,t.addKeyboardModeEvents=function(e,t){var n=o.instancesMonitored.get(e);n&&n.length>0?-1===n.indexOf(t)&&n.push(t):(o.instancesMonitored.set(e,[t]),e.addEventListener("keydown",o.toggleKeyboardMode),e.addEventListener("mousedown",o.toggleKeyboardMode))},t.removeKeyboardModeEvents=function(e,t){var n=o.instancesMonitored.get(e),r=[];n&&n.length&&(r=Xp(n).filter((function(e){return e!==t})),o.instancesMonitored.set(e,r)),0===r.length&&(e.removeEventListener("keydown",o.toggleKeyboardMode),e.removeEventListener("mousedown",o.toggleKeyboardMode))},t.toggleKeyboardMode=function(e){var t=o.keyboardModeActive,n="keydown"===e.type;if((!n||!(e.ctrlKey||e.metaKey||e.altKey))&&!(t&&n||!t&&!n)){o.keyboardModeActive=n;var r=e.target.ownerDocument;if(r){var i=o.instancesMonitored.get(r);i&&i.forEach((function(e){e.dispatchEvent({type:n?$e.EVENT_KEYBOARD_FOCUS:$e.EVENT_MOUSE_FOCUS})}))}}},t.prototype.init=function(){var e=this,t=this.clearFocusedCell.bind(this);this.addManagedListener(this.eventService,$e.EVENT_COLUMN_PIVOT_MODE_CHANGED,t),this.addManagedListener(this.eventService,$e.EVENT_NEW_COLUMNS_LOADED,this.onColumnEverythingChanged.bind(this)),this.addManagedListener(this.eventService,$e.EVENT_COLUMN_GROUP_OPENED,t),this.addManagedListener(this.eventService,$e.EVENT_COLUMN_ROW_GROUP_CHANGED,t),this.ctrlsService.whenReady((function(t){e.gridCtrl=t.gridCtrl;var n=e.gridOptionsService.getDocument();o.addKeyboardModeEvents(n,e.gridCtrl),e.addDestroyFunc((function(){return e.unregisterGridCompController(e.gridCtrl)}))}))},t.prototype.unregisterGridCompController=function(e){var t=this.gridOptionsService.getDocument();o.removeKeyboardModeEvents(t,e)},t.prototype.onColumnEverythingChanged=function(){if(this.focusedCellPosition){var e=this.focusedCellPosition.column,t=this.columnModel.getGridColumn(e.getId());e!==t&&this.clearFocusedCell()}},t.prototype.isKeyboardMode=function(){return o.keyboardModeActive},t.prototype.getFocusCellToUseAfterRefresh=function(){var e=this.gridOptionsService.getDocument();return this.gridOptionsService.is("suppressFocusAfterRefresh")||!this.focusedCellPosition||this.isDomDataMissingInHierarchy(e.activeElement,Bl.DOM_DATA_KEY_ROW_CTRL)?null:this.focusedCellPosition},t.prototype.getFocusHeaderToUseAfterRefresh=function(){var e=this.gridOptionsService.getDocument();return this.gridOptionsService.is("suppressFocusAfterRefresh")||!this.focusedHeaderPosition||this.isDomDataMissingInHierarchy(e.activeElement,md.DOM_DATA_KEY_HEADER_CTRL)?null:this.focusedHeaderPosition},t.prototype.isDomDataMissingInHierarchy=function(e,t){for(var o=e;o;){if(this.gridOptionsService.getDomData(o,t))return!1;o=o.parentNode}return!0},t.prototype.getFocusedCell=function(){return this.focusedCellPosition},t.prototype.getFocusEventParams=function(){var e=this.focusedCellPosition,t=e.rowIndex,o=e.rowPinned,n={rowIndex:t,rowPinned:o,column:e.column,isFullWidthCell:!1},r=this.rowRenderer.getRowByPosition({rowIndex:t,rowPinned:o});return r&&(n.isFullWidthCell=r.isFullWidth()),n},t.prototype.clearFocusedCell=function(){if(null!=this.focusedCellPosition){var e=Kp({type:$e.EVENT_CELL_FOCUS_CLEARED},this.getFocusEventParams());this.focusedCellPosition=null,this.eventService.dispatchEvent(e)}},t.prototype.setFocusedCell=function(e){var t=e.column,o=e.rowIndex,r=e.rowPinned,i=e.forceBrowserFocus,a=void 0!==i&&i,s=e.preventScrollOnBrowserFocus,l=void 0!==s&&s,c=this.columnModel.getGridColumn(t);if(c){this.focusedCellPosition=c?{rowIndex:o,rowPinned:n(r),column:c}:null;var d=Kp(Kp({type:$e.EVENT_CELL_FOCUSED},this.getFocusEventParams()),{forceBrowserFocus:a,preventScrollOnBrowserFocus:l,floating:null});this.eventService.dispatchEvent(d)}else this.focusedCellPosition=null},t.prototype.isCellFocused=function(e){return null!=this.focusedCellPosition&&(this.focusedCellPosition.column===e.column&&this.isRowFocused(e.rowIndex,e.rowPinned))},t.prototype.isRowNodeFocused=function(e){return this.isRowFocused(e.rowIndex,e.rowPinned)},t.prototype.isHeaderWrapperFocused=function(e){if(null==this.focusedHeaderPosition)return!1;var t=e.getColumnGroupChild(),o=e.getRowIndex(),n=e.getPinned(),r=this.focusedHeaderPosition,i=r.column,a=r.headerRowIndex;return t===i&&o===a&&n==i.getPinned()},t.prototype.clearFocusedHeader=function(){this.focusedHeaderPosition=null},t.prototype.getFocusedHeader=function(){return this.focusedHeaderPosition},t.prototype.setFocusedHeader=function(e,t){this.focusedHeaderPosition={headerRowIndex:e,column:t}},t.prototype.focusHeaderPosition=function(e){var t=e.direction,o=e.fromTab,n=e.allowUserOverride,r=e.event,i=e.headerPosition;if(n){var a,s=this.getFocusedHeader(),l=this.headerNavigationService.getHeaderRowCount();if(o){if(a=this.gridOptionsService.getCallback("tabToNextHeader"))i=a({backwards:"Before"===t,previousHeaderPosition:s,nextHeaderPosition:i,headerRowCount:l})}else if((a=this.gridOptionsService.getCallback("navigateToNextHeader"))&&r)i=a({key:r.key,previousHeaderPosition:s,nextHeaderPosition:i,headerRowCount:l,event:r})}return!!i&&(-1===i.headerRowIndex?this.focusGridView(i.column):(this.headerNavigationService.scrollToColumn(i.column,t),this.ctrlsService.getHeaderRowContainerCtrl(i.column.getPinned()).focusHeader(i.headerRowIndex,i.column,r)))},t.prototype.focusFirstHeader=function(){var e=this.columnModel.getAllDisplayedColumns()[0];return!!e&&(e.getParent()&&(e=this.columnModel.getColumnGroupAtLevel(e,0)),this.focusHeaderPosition({headerPosition:{headerRowIndex:0,column:e}}))},t.prototype.focusLastHeader=function(e){var t=this.headerNavigationService.getHeaderRowCount()-1,o=fe(this.columnModel.getAllDisplayedColumns());return this.focusHeaderPosition({headerPosition:{headerRowIndex:t,column:o},event:e})},t.prototype.isAnyCellFocused=function(){return!!this.focusedCellPosition},t.prototype.isRowFocused=function(e,t){return null!=this.focusedCellPosition&&(this.focusedCellPosition.rowIndex===e&&this.focusedCellPosition.rowPinned===n(t))},t.prototype.findFocusableElements=function(e,t,o){void 0===o&&(o=!1);var n=Zo,r=en;t&&(r+=", "+t),o&&(r+=', [tabindex="-1"]');var i=Array.prototype.slice.apply(e.querySelectorAll(n)),a=Array.prototype.slice.apply(e.querySelectorAll(r));if(!a.length)return i;var s;return s=a,i.filter((function(e){return-1===s.indexOf(e)}))},t.prototype.focusInto=function(e,t,o){void 0===t&&(t=!1),void 0===o&&(o=!1);var n=this.findFocusableElements(e,null,o),r=t?fe(n):n[0];return!!r&&(r.focus({preventScroll:!0}),!0)},t.prototype.findFocusableElementBeforeTabGuard=function(e,t){if(!t)return null;var o=this.findFocusableElements(e),n=o.indexOf(t);if(-1===n)return null;for(var r=-1,i=n-1;i>=0;i--)if(o[i].classList.contains(Ju.TAB_GUARD_TOP)){r=i;break}return r<=0?null:o[r-1]},t.prototype.findNextFocusableElement=function(e,t,o){void 0===e&&(e=this.eGridDiv);var n=this.findFocusableElements(e,t?':not([tabindex="-1"])':null),r=this.gridOptionsService.getDocument().activeElement,i=(t?n.findIndex((function(e){return e.contains(r)})):n.indexOf(r))+(o?-1:1);return i<0||i>=n.length?null:n[i]},t.prototype.isTargetUnderManagedComponent=function(e,t){if(!t)return!1;var o=e.querySelectorAll("."+Ar.FOCUS_MANAGED_CLASS);if(!o.length)return!1;for(var n=0;n<o.length;n++)if(o[n].contains(t))return!0;return!1},t.prototype.findTabbableParent=function(e,t){void 0===t&&(t=5);for(var o=0;e&&null===Do(e)&&++o<=t;)e=e.parentElement;return null===Do(e)?null:e},t.prototype.focusGridView=function(e,t){if(this.gridOptionsService.is("suppressCellFocus"))return t?this.focusLastHeader():this.focusNextGridCoreContainer(!1);var o=t?this.rowPositionUtils.getLastRow():this.rowPositionUtils.getFirstRow();if(!o)return!1;var r=o.rowIndex,i=o.rowPinned,a=this.getFocusedHeader();if(!e&&a&&(e=a.column),null==r||!e)return!1;if(this.navigationService.ensureCellVisible({rowIndex:r,column:e,rowPinned:i}),this.setFocusedCell({rowIndex:r,column:e,rowPinned:n(i),forceBrowserFocus:!0}),this.rangeService){var s={rowIndex:r,rowPinned:i,column:e};this.rangeService.setRangeToCell(s)}return!0},t.prototype.focusNextGridCoreContainer=function(e,t){return void 0===t&&(t=!1),!(t||!this.gridCtrl.focusNextInnerContainer(e))||((t||!e&&!this.gridCtrl.isDetailGrid())&&this.gridCtrl.forceFocusOutOfContainer(e),!1)},t.AG_KEYBOARD_FOCUS="ag-keyboard-focus",t.keyboardModeActive=!1,t.instancesMonitored=new Map,Yp([q("eGridDiv")],t.prototype,"eGridDiv",void 0),Yp([q("columnModel")],t.prototype,"columnModel",void 0),Yp([q("headerNavigationService")],t.prototype,"headerNavigationService",void 0),Yp([q("rowRenderer")],t.prototype,"rowRenderer",void 0),Yp([q("rowPositionUtils")],t.prototype,"rowPositionUtils",void 0),Yp([K("rangeService")],t.prototype,"rangeService",void 0),Yp([q("navigationService")],t.prototype,"navigationService",void 0),Yp([q("ctrlsService")],t.prototype,"ctrlsService",void 0),Yp([$],t.prototype,"init",null),t=o=Yp([W("focusService")],t)}(Fe),Zp=function(){var e=function(t,o){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])},e(t,o)};return function(t,o){function n(){this.constructor=t}e(t,o),t.prototype=null===o?Object.create(o):(n.prototype=o.prototype,new n)}}(),eh=function(e,t,o,n){var r,i=arguments.length,a=i<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,o):n;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)a=Reflect.decorate(e,t,o,n);else for(var s=e.length-1;s>=0;s--)(r=e[s])&&(a=(i<3?r(a):i>3?r(t,o,a):r(t,o))||a);return i>3&&a&&Object.defineProperty(t,o,a),a},th=function(e,t){var o="function"===typeof Symbol&&e[Symbol.iterator];if(!o)return e;var n,r,i=o.call(e),a=[];try{for(;(void 0===t||t-- >0)&&!(n=i.next()).done;)a.push(n.value)}catch(s){r={error:s}}finally{try{n&&!n.done&&(o=i.return)&&o.call(i)}finally{if(r)throw r.error}}return a},oh=function(){for(var e=[],t=0;t<arguments.length;t++)e=e.concat(th(arguments[t]));return e};!function(e){e[e.vertical=0]="vertical",e[e.horizontal=1]="horizontal"}(Sp||(Sp={}));var nh,rh=0,ih=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.popupList=[],t}var o;return Zp(t,e),o=t,t.prototype.postConstruct=function(){var e=this;this.ctrlsService.whenReady((function(t){e.gridCtrl=t.gridCtrl,e.addManagedListener(e.gridCtrl,$e.EVENT_KEYBOARD_FOCUS,(function(){e.popupList.forEach((function(e){return e.element.classList.add(Qp.AG_KEYBOARD_FOCUS)}))})),e.addManagedListener(e.gridCtrl,$e.EVENT_MOUSE_FOCUS,(function(){e.popupList.forEach((function(e){return e.element.classList.remove(Qp.AG_KEYBOARD_FOCUS)}))}))}))},t.prototype.getPopupParent=function(){var e=this.gridOptionsService.get("popupParent");return e||this.gridCtrl.getGui()},t.prototype.positionPopupForMenu=function(e){var t=e.eventSource.getBoundingClientRect(),o=this.getParentRect(),n=this.keepXYWithinBounds(e.ePopup,t.top-o.top,Sp.vertical),r=e.ePopup.clientWidth>0?e.ePopup.clientWidth:200;e.ePopup.style.minWidth=r+"px";var i,a=o.right-o.left-r;function s(){return t.right-o.left-2}function l(){return t.left-o.left-r}this.gridOptionsService.is("enableRtl")?((i=l())<0&&(i=s()),i>a&&(i=0)):((i=s())>a&&(i=l()),i<0&&(i=0)),e.ePopup.style.left=i+"px",e.ePopup.style.top=n+"px"},t.prototype.positionPopupUnderMouseEvent=function(e){var t=this,o=e.ePopup,n=e.nudgeX,r=e.nudgeY,i=e.skipObserver;this.positionPopup({ePopup:o,nudgeX:n,nudgeY:r,keepWithinBounds:!0,skipObserver:i,updatePosition:function(){return t.calculatePointerAlign(e.mouseEvent)},postProcessCallback:function(){return t.callPostProcessPopup(e.type,e.ePopup,null,e.mouseEvent,e.column,e.rowNode)}})},t.prototype.calculatePointerAlign=function(e){var t=this.getParentRect();return{x:e.clientX-t.left,y:e.clientY-t.top}},t.prototype.positionPopupByComponent=function(e){var t=this,o=e.eventSource.getBoundingClientRect(),n=e.alignSide||"left",r=e.position||"over",i=this.getParentRect();this.positionPopup({ePopup:e.ePopup,nudgeX:e.nudgeX,nudgeY:e.nudgeY,keepWithinBounds:e.keepWithinBounds,updatePosition:function(){var t=o.left-i.left;return"right"===n&&(t-=e.ePopup.offsetWidth-o.width),{x:t,y:"over"===r?o.top-i.top:o.top-i.top+o.height}},postProcessCallback:function(){return t.callPostProcessPopup(e.type,e.ePopup,e.eventSource,null,e.column,e.rowNode)}})},t.prototype.callPostProcessPopup=function(e,t,o,n,r,i){var a=this.gridOptionsService.getCallback("postProcessPopup");a&&a({column:r,rowNode:i,ePopup:t,type:e,eventSource:o,mouseEvent:n})},t.prototype.positionPopup=function(e){var t=this,n=e.ePopup,r=e.keepWithinBounds,i=e.nudgeX,a=e.nudgeY,s=e.skipObserver,l=e.updatePosition,c={width:0,height:0},d=function(o){void 0===o&&(o=!1);var s=l(),d=s.x,u=s.y;o&&n.clientWidth===c.width&&n.clientHeight===c.height||(c.width=n.clientWidth,c.height=n.clientHeight,i&&(d+=i),a&&(u+=a),r&&(d=t.keepXYWithinBounds(n,d,Sp.horizontal),u=t.keepXYWithinBounds(n,u,Sp.vertical)),n.style.left=d+"px",n.style.top=u+"px",e.postProcessCallback&&e.postProcessCallback())};if(d(),!s){var u=this.resizeObserverService.observeResize(n,(function(){return d(!0)}));setTimeout((function(){return u()}),o.WAIT_FOR_POPUP_CONTENT_RESIZE)}},t.prototype.getActivePopups=function(){return this.popupList.map((function(e){return e.element}))},t.prototype.getPopupList=function(){return this.popupList},t.prototype.getParentRect=function(){var e=this.gridOptionsService.getDocument(),t=this.getPopupParent();t===e.body?t=e.documentElement:"static"===getComputedStyle(t).position&&(t=t.offsetParent);var o=getComputedStyle(t),n=t.getBoundingClientRect();return{top:n.top+parseFloat(o.borderTopWidth)||0,left:n.left+parseFloat(o.borderLeftWidth)||0,right:n.right+parseFloat(o.borderRightWidth)||0,bottom:n.bottom+parseFloat(o.borderBottomWidth)||0}},t.prototype.keepXYWithinBounds=function(e,t,o){var n=o===Sp.vertical,r=n?"clientHeight":"clientWidth",i=n?"top":"left",a=n?"offsetHeight":"offsetWidth",s=n?"scrollTop":"scrollLeft",l=this.gridOptionsService.getDocument(),c=l.documentElement,d=this.getPopupParent(),u=d.getBoundingClientRect(),p=l.documentElement.getBoundingClientRect(),h=d===l.body,f=e[a],g=h?(n?dn:un)(c)+c[s]:d[r];h&&(g-=Math.abs(p[i]-u[i]));var m=g-f;return Math.min(Math.max(t,0),Math.abs(m))},t.prototype.keepPopupPositionedRelativeTo=function(e){var t=this,o=this.getPopupParent(),n=o.getBoundingClientRect(),r=e.element.getBoundingClientRect(),i=n.top-r.top,a=n.left-r.left,s=i,l=a,c=e.ePopup.style.top,d=parseInt(c.substring(0,c.length-1),10),u=e.ePopup.style.left,p=parseInt(u.substring(0,u.length-1),10);return new rr((function(n){t.getFrameworkOverrides().setInterval((function(){var n=o.getBoundingClientRect(),r=e.element.getBoundingClientRect();if(0==r.top&&0==r.left&&0==r.height&&0==r.width)e.hidePopup();else{var c=n.top-r.top;if(c!=s){var u=t.keepXYWithinBounds(e.ePopup,d+i-c,Sp.vertical);e.ePopup.style.top=u+"px"}s=c;var h=n.left-r.left;if(h!=l){var f=t.keepXYWithinBounds(e.ePopup,p+a-h,Sp.horizontal);e.ePopup.style.left=f+"px"}l=h}}),200).then((function(e){n((function(){null!=e&&window.clearInterval(e)}))}))}))},t.prototype.addPopup=function(e){var t,o=this,n=e.modal,r=e.eChild,i=e.closeOnEsc,a=e.closedCallback,s=e.click,l=e.alwaysOnTop,c=e.afterGuiAttached,d=e.positionCallback,u=e.anchorToElement,p=e.ariaLabel,h=this.gridOptionsService.getDocument(),f=new rr((function(e){return e((function(){}))}));if(!h)return console.warn("AG Grid: could not find the document, document is empty"),{hideFunc:function(){},stopAnchoringPromise:f};var g=this.popupList.findIndex((function(e){return e.element===r}));if(-1!==g){var m=this.popupList[g];return{hideFunc:m.hideFunc,stopAnchoringPromise:m.stopAnchoringPromise}}var y=this.getPopupParent();null==r.style.top&&(r.style.top="0px"),null==r.style.left&&(r.style.left="0px");var v=document.createElement("div"),b=this.environment.getTheme().allThemes;b.length&&(t=v.classList).add.apply(t,oh(b)),v.classList.add("ag-popup"),r.classList.add(this.gridOptionsService.is("enableRtl")?"ag-rtl":"ag-ltr","ag-popup-child"),r.hasAttribute("role")||$t(r,"dialog"),Kt(r,p),this.focusService.isKeyboardMode()&&r.classList.add(Qp.AG_KEYBOARD_FOCUS),v.appendChild(r),y.appendChild(v),l?this.setAlwaysOnTop(v,!0):this.bringPopupToFront(v);var x=!1,w=function(e){v.contains(h.activeElement)&&(e.key===Hn.ESCAPE&&S({keyboardEvent:e}))},C=function(e){return S({mouseEvent:e})},_=function(e){return S({touchEvent:e})},S=function(e){void 0===e&&(e={});var t=e.mouseEvent,n=e.touchEvent,i=e.keyboardEvent;o.isEventFromCurrentPopup({mouseEvent:t,touchEvent:n},r)||o.isEventSameChainAsOriginalEvent({originalMouseEvent:s,mouseEvent:t,touchEvent:n})||x||(x=!0,y.removeChild(v),h.removeEventListener("keydown",w),h.removeEventListener("mousedown",C),h.removeEventListener("touchstart",_),h.removeEventListener("contextmenu",C),o.eventService.removeEventListener($e.EVENT_DRAG_STARTED,C),a&&a(t||n||i),o.popupList=o.popupList.filter((function(e){return e.element!==r})),f&&f.then((function(e){return e&&e()})))};return c&&c({hidePopup:S}),window.setTimeout((function(){i&&h.addEventListener("keydown",w),n&&(h.addEventListener("mousedown",C),o.eventService.addEventListener($e.EVENT_DRAG_STARTED,C),h.addEventListener("touchstart",_),h.addEventListener("contextmenu",C))}),0),d&&d(),u&&(f=this.keepPopupPositionedRelativeTo({element:u,ePopup:r,hidePopup:S})),this.popupList.push({element:r,wrapper:v,hideFunc:S,stopAnchoringPromise:f,instanceId:rh++,isAnchored:!!u}),{hideFunc:S,stopAnchoringPromise:f}},t.prototype.hasAnchoredPopup=function(){return this.popupList.some((function(e){return e.isAnchored}))},t.prototype.isEventFromCurrentPopup=function(e,t){var o=e.mouseEvent,n=e.touchEvent,r=o||n;if(!r)return!1;var i=this.popupList.findIndex((function(e){return e.element===t}));if(-1===i)return!1;for(var a=i;a<this.popupList.length;a++){if(De(this.popupList[a].element,r))return!0}return this.isElementWithinCustomPopup(r.target)},t.prototype.isElementWithinCustomPopup=function(e){for(var t=this.gridOptionsService.getDocument();e&&e!==t.body;){if(e.classList.contains("ag-custom-component-popup")||null===e.parentElement)return!0;e=e.parentElement}return!1},t.prototype.isEventSameChainAsOriginalEvent=function(e){var t=e.originalMouseEvent,o=e.mouseEvent,n=e.touchEvent,r=null;if(o?r=o:n&&(r=n.touches[0]),r&&t){var i=o?o.screenX:0,a=o?o.screenY:0,s=Math.abs(t.screenX-i)<5,l=Math.abs(t.screenY-a)<5;if(s&&l)return!0}return!1},t.prototype.getWrapper=function(e){for(;!e.classList.contains("ag-popup")&&e.parentElement;)e=e.parentElement;return e.classList.contains("ag-popup")?e:null},t.prototype.setAlwaysOnTop=function(e,t){var o=this.getWrapper(e);o&&(o.classList.toggle("ag-always-on-top",!!t),t&&this.bringPopupToFront(o))},t.prototype.bringPopupToFront=function(e){var t=this.getPopupParent(),o=Array.prototype.slice.call(t.querySelectorAll(".ag-popup")),n=o.length,r=Array.prototype.slice.call(t.querySelectorAll(".ag-popup.ag-always-on-top")),i=r.length,a=this.getWrapper(e);if(a&&!(n<=1)&&t.contains(e)){var s=o.indexOf(a),l=a.querySelectorAll("div"),c=[];if(l.forEach((function(e){0!==e.scrollTop&&c.push([e,e.scrollTop])})),i)a.classList.contains("ag-always-on-top")?s!==n-1&&fe(r).insertAdjacentElement("afterend",a):s!==n-i-1&&r[0].insertAdjacentElement("beforebegin",a);else s!==n-1&&fe(o).insertAdjacentElement("afterend",a);for(;c.length;){var d=c.pop();d[0].scrollTop=d[1]}var u={type:"popupToFront",api:this.gridOptionsService.api,columnApi:this.gridOptionsService.columnApi,eWrapper:a};this.eventService.dispatchEvent(u)}},t.WAIT_FOR_POPUP_CONTENT_RESIZE=200,eh([q("focusService")],t.prototype,"focusService",void 0),eh([q("ctrlsService")],t.prototype,"ctrlsService",void 0),eh([q("resizeObserverService")],t.prototype,"resizeObserverService",void 0),eh([$],t.prototype,"postConstruct",null),t=o=eh([W("popupService")],t)}(Fe),ah=function(){var e=function(t,o){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])},e(t,o)};return function(t,o){function n(){this.constructor=t}e(t,o),t.prototype=null===o?Object.create(o):(n.prototype=o.prototype,new n)}}(),sh=function(e,t,o,n){var r,i=arguments.length,a=i<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,o):n;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)a=Reflect.decorate(e,t,o,n);else for(var s=e.length-1;s>=0;s--)(r=e[s])&&(a=(i<3?r(a):i>3?r(t,o,a):r(t,o))||a);return i>3&&a&&Object.defineProperty(t,o,a),a},lh=function(e){function t(o,n,r){void 0===o&&(o="default"),void 0===n&&(n="listbox");var i=e.call(this,t.getTemplate(o))||this;return i.cssIdentifier=o,i.ariaRole=n,i.listName=r,i.renderedRows=new Map,i.rowHeight=20,i}return ah(t,e),t.prototype.postConstruct=function(){var e=this;this.addScrollListener(),this.rowHeight=this.getItemHeight(),this.addResizeObserver(),this.initialiseTabGuard({onFocusIn:function(t){return e.onFocusIn(t)},onFocusOut:function(t){return e.onFocusOut(t)},focusInnerElement:function(t){return e.focusInnerElement(t)},onTabKeyDown:function(t){return e.onTabKeyDown(t)},handleKeyDown:function(t){return e.handleKeyDown(t)}}),this.setAriaProperties(),this.addManagedListener(this.eventService,$e.EVENT_GRID_STYLES_CHANGED,this.onGridStylesChanged.bind(this))},t.prototype.onGridStylesChanged=function(){this.rowHeight=this.getItemHeight(),this.refresh()},t.prototype.setAriaProperties=function(){var e=this.localeService.getLocaleTextFunc()("ariaDefaultListName",this.listName||"List"),t=this.eContainer;$t(t,this.ariaRole),Kt(t,e)},t.prototype.addResizeObserver=function(){var e=this,t=this.resizeObserverService.observeResize(this.getGui(),(function(){return e.drawVirtualRows()}));this.addDestroyFunc(t)},t.prototype.focusInnerElement=function(e){this.focusRow(e?this.model.getRowCount()-1:0)},t.prototype.onFocusIn=function(e){var t=e.target;return t.classList.contains("ag-virtual-list-item")&&(this.lastFocusedRowIndex=qt(t)-1),!1},t.prototype.onFocusOut=function(e){return this.getFocusableElement().contains(e.relatedTarget)||(this.lastFocusedRowIndex=null),!1},t.prototype.handleKeyDown=function(e){switch(e.key){case Hn.UP:case Hn.DOWN:this.navigate(e.key===Hn.UP)&&e.preventDefault()}},t.prototype.onTabKeyDown=function(e){this.navigate(e.shiftKey)?e.preventDefault():this.forceFocusOutOfContainer(e.shiftKey)},t.prototype.navigate=function(e){if(null==this.lastFocusedRowIndex)return!1;var t=this.lastFocusedRowIndex+(e?-1:1);return!(t<0||t>=this.model.getRowCount())&&(this.focusRow(t),!0)},t.prototype.getLastFocusedRow=function(){return this.lastFocusedRowIndex},t.prototype.focusRow=function(e){var t=this;this.ensureIndexVisible(e),window.setTimeout((function(){if(t.isAlive()){var o=t.renderedRows.get(e);o&&o.eDiv.focus()}}),10)},t.prototype.getComponentAt=function(e){var t=this.renderedRows.get(e);return t&&t.rowComponent},t.prototype.forEachRenderedRow=function(e){this.renderedRows.forEach((function(t,o){return e(t.rowComponent,o)}))},t.getTemplate=function(e){return'\n            <div class="ag-virtual-list-viewport ag-'+e+'-virtual-list-viewport" role="presentation">\n                <div class="ag-virtual-list-container ag-'+e+'-virtual-list-container" ref="eContainer"></div>\n            </div>'},t.prototype.getItemHeight=function(){return this.environment.getListItemHeight()},t.prototype.ensureIndexVisible=function(e){var t=this.model.getRowCount();if("number"!==typeof e||e<0||e>=t)console.warn("AG Grid: invalid row index for ensureIndexVisible: "+e);else{var o=e*this.rowHeight,n=o+this.rowHeight,r=this.getGui(),i=r.scrollTop,a=r.offsetHeight,s=i+a<n;if(i>o)r.scrollTop=o;else if(s){var l=n-a;r.scrollTop=l}}},t.prototype.setComponentCreator=function(e){this.componentCreator=e},t.prototype.setComponentUpdater=function(e){this.componentUpdater=e},t.prototype.getRowHeight=function(){return this.rowHeight},t.prototype.getScrollTop=function(){return this.getGui().scrollTop},t.prototype.setRowHeight=function(e){this.rowHeight=e,this.refresh()},t.prototype.refresh=function(e){var t=this;if(null!=this.model&&this.isAlive()){var o=this.model.getRowCount();this.eContainer.style.height=o*this.rowHeight+"px",L((function(){return t.eContainer.clientHeight>=o*t.rowHeight}),(function(){t.isAlive()&&(t.canSoftRefresh(e)?t.drawVirtualRows(!0):(t.clearVirtualRows(),t.drawVirtualRows()))}))}},t.prototype.canSoftRefresh=function(e){return!!(e&&this.renderedRows.size&&"function"===typeof this.model.areRowsEqual&&this.componentUpdater)},t.prototype.clearVirtualRows=function(){var e=this;this.renderedRows.forEach((function(t,o){return e.removeRow(o)}))},t.prototype.drawVirtualRows=function(e){if(this.isAlive()){var t=this.getGui(),o=t.scrollTop,n=o+t.offsetHeight,r=Math.floor(o/this.rowHeight),i=Math.floor(n/this.rowHeight);this.ensureRowsRendered(r,i,e)}},t.prototype.ensureRowsRendered=function(e,t,o){var n=this;this.renderedRows.forEach((function(o,r){(r<e||r>t)&&r!==n.lastFocusedRowIndex&&n.removeRow(r)})),o&&this.refreshRows();for(var r=e;r<=t;r++)this.renderedRows.has(r)||r<this.model.getRowCount()&&this.insertRow(r)},t.prototype.insertRow=function(e){var t=this,o=this.model.getRow(e),n=document.createElement("div");if(n.classList.add("ag-virtual-list-item","ag-"+this.cssIdentifier+"-virtual-list-item"),$t(n,"tree"===this.ariaRole?"treeitem":"option"),no(n,this.model.getRowCount()),ro(n,e+1),n.setAttribute("tabindex","-1"),"function"===typeof this.model.isRowSelected){var r=this.model.isRowSelected(e);fo(n,!!r),go(n,r)}n.style.height=this.rowHeight+"px",n.style.top=this.rowHeight*e+"px";var i=this.componentCreator(o,n);i.addGuiEventListener("focusin",(function(){return t.lastFocusedRowIndex=e})),n.appendChild(i.getGui()),this.renderedRows.has(e-1)?this.renderedRows.get(e-1).eDiv.insertAdjacentElement("afterend",n):this.renderedRows.has(e+1)?this.renderedRows.get(e+1).eDiv.insertAdjacentElement("beforebegin",n):this.eContainer.appendChild(n),this.renderedRows.set(e,{rowComponent:i,eDiv:n,value:o})},t.prototype.removeRow=function(e){var t=this.renderedRows.get(e);this.eContainer.removeChild(t.eDiv),this.destroyBean(t.rowComponent),this.renderedRows.delete(e)},t.prototype.refreshRows=function(){var e=this,t=this.model.getRowCount();this.renderedRows.forEach((function(o,n){var r,i;if(n>=t)e.removeRow(n);else{var a=e.model.getRow(n);(null===(i=(r=e.model).areRowsEqual)||void 0===i?void 0:i.call(r,o.value,a))?e.componentUpdater(a,o.rowComponent):e.removeRow(n)}}))},t.prototype.addScrollListener=function(){var e=this;this.addGuiEventListener("scroll",(function(){return e.drawVirtualRows()}),{passive:!0})},t.prototype.setModel=function(e){this.model=e},t.prototype.destroy=function(){this.isAlive()&&(this.clearVirtualRows(),e.prototype.destroy.call(this))},sh([q("resizeObserverService")],t.prototype,"resizeObserverService",void 0),sh([mr("eContainer")],t.prototype,"eContainer",void 0),sh([$],t.prototype,"postConstruct",null),t}(Rp),ch=["mouseover","mouseout","mouseenter","mouseleave"],dh=["touchstart","touchend","touchmove","touchcancel"],uh=function(){function e(){this.isOutsideAngular=function(e){return we(ch,e)}}return e.prototype.setTimeout=function(e,t){window.setTimeout(e,t)},e.prototype.setInterval=function(e,t){return new rr((function(o){o(window.setInterval(e,t))}))},e.prototype.addEventListener=function(e,t,o,n){var r=we(dh,t);e.addEventListener(t,o,{capture:!!n,passive:r})},e.prototype.dispatchEvent=function(e,t,o){t()},e.prototype.frameworkComponent=function(e){return null},e.prototype.isFrameworkComponent=function(e){return!1},e}(),ph=function(){var e=function(t,o){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])},e(t,o)};return function(t,o){function n(){this.constructor=t}e(t,o),t.prototype=null===o?Object.create(o):(n.prototype=o.prototype,new n)}}(),hh=function(e,t,o,n){var r,i=arguments.length,a=i<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,o):n;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)a=Reflect.decorate(e,t,o,n);else for(var s=e.length-1;s>=0;s--)(r=e[s])&&(a=(i<3?r(a):i>3?r(t,o,a):r(t,o))||a);return i>3&&a&&Object.defineProperty(t,o,a),a},fh=function(e,t){var o="function"===typeof Symbol&&e[Symbol.iterator];if(!o)return e;var n,r,i=o.call(e),a=[];try{for(;(void 0===t||t-- >0)&&!(n=i.next()).done;)a.push(n.value)}catch(s){r={error:s}}finally{try{n&&!n.done&&(o=i.return)&&o.call(i)}finally{if(r)throw r.error}}return a},gh=function(){for(var e=[],t=0;t<arguments.length;t++)e=e.concat(fh(arguments[t]));return e},mh=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return ph(t,e),t.prototype.getNextCellToFocus=function(e,t,o){return void 0===o&&(o=!1),o?this.getNextCellToFocusWithCtrlPressed(e,t):this.getNextCellToFocusWithoutCtrlPressed(e,t)},t.prototype.getNextCellToFocusWithCtrlPressed=function(e,t){var o,n,r=e===Hn.UP,i=e===Hn.DOWN,a=e===Hn.LEFT;if(r||i)n=r?this.paginationProxy.getPageFirstRow():this.paginationProxy.getPageLastRow(),o=t.column;else{var s=this.columnModel.getAllDisplayedColumns(),l=this.gridOptionsService.is("enableRtl");n=t.rowIndex,o=a!==l?s[0]:fe(s)}return{rowIndex:n,rowPinned:null,column:o}},t.prototype.getNextCellToFocusWithoutCtrlPressed=function(e,t){for(var o=t,n=!1;!n;){switch(e){case Hn.UP:o=this.getCellAbove(o);break;case Hn.DOWN:o=this.getCellBelow(o);break;case Hn.RIGHT:o=this.gridOptionsService.is("enableRtl")?this.getCellToLeft(o):this.getCellToRight(o);break;case Hn.LEFT:o=this.gridOptionsService.is("enableRtl")?this.getCellToRight(o):this.getCellToLeft(o);break;default:o=null,console.warn("AG Grid: unknown key for navigation "+e)}n=!o||this.isCellGoodToFocusOn(o)}return o},t.prototype.isCellGoodToFocusOn=function(e){var t,o=e.column;switch(e.rowPinned){case"top":t=this.pinnedRowModel.getPinnedTopRow(e.rowIndex);break;case"bottom":t=this.pinnedRowModel.getPinnedBottomRow(e.rowIndex);break;default:t=this.rowModel.getRow(e.rowIndex)}return!!t&&!o.isSuppressNavigable(t)},t.prototype.getCellToLeft=function(e){if(!e)return null;var t=this.columnModel.getDisplayedColBefore(e.column);return t?{rowIndex:e.rowIndex,column:t,rowPinned:e.rowPinned}:null},t.prototype.getCellToRight=function(e){if(!e)return null;var t=this.columnModel.getDisplayedColAfter(e.column);return t?{rowIndex:e.rowIndex,column:t,rowPinned:e.rowPinned}:null},t.prototype.getRowBelow=function(e){var t=e.rowIndex,o=e.rowPinned;if(this.isLastRowInContainer(e))switch(o){case"bottom":return null;case"top":return this.rowModel.isRowsToRender()?{rowIndex:this.paginationProxy.getPageFirstRow(),rowPinned:null}:this.pinnedRowModel.isRowsToRender("bottom")?{rowIndex:0,rowPinned:"bottom"}:null;default:return this.pinnedRowModel.isRowsToRender("bottom")?{rowIndex:0,rowPinned:"bottom"}:null}var n=this.rowModel.getRow(e.rowIndex),r=this.getNextStickyPosition(n);return r||{rowIndex:t+1,rowPinned:o}},t.prototype.getNextStickyPosition=function(e,t){if(this.gridOptionsService.is("groupRowsSticky")&&e&&e.sticky){var o=gh(this.rowRenderer.getStickyTopRowCtrls()).sort((function(e,t){return e.getRowNode().rowIndex-t.getRowNode().rowIndex})),n=t?-1:1,r=o.findIndex((function(t){return t.getRowNode().rowIndex===e.rowIndex})),i=o[r+n];return i?{rowIndex:i.getRowNode().rowIndex,rowPinned:null}:void 0}},t.prototype.getCellBelow=function(e){if(!e)return null;var t=this.getRowBelow(e);return t?{rowIndex:t.rowIndex,column:e.column,rowPinned:t.rowPinned}:null},t.prototype.isLastRowInContainer=function(e){var t=e.rowPinned,o=e.rowIndex;return"top"===t?this.pinnedRowModel.getPinnedTopRowData().length-1<=o:"bottom"===t?this.pinnedRowModel.getPinnedBottomRowData().length-1<=o:this.paginationProxy.getPageLastRow()<=o},t.prototype.getRowAbove=function(e){var t=e.rowIndex,o=e.rowPinned;if(o?0===t:t===this.paginationProxy.getPageFirstRow())return"top"===o?null:o&&this.rowModel.isRowsToRender()?this.getLastBodyCell():this.pinnedRowModel.isRowsToRender("top")?this.getLastFloatingTopRow():null;var n=this.rowModel.getRow(e.rowIndex),r=this.getNextStickyPosition(n,!0);return r||{rowIndex:t-1,rowPinned:o}},t.prototype.getCellAbove=function(e){if(!e)return null;var t=this.getRowAbove({rowIndex:e.rowIndex,rowPinned:e.rowPinned});return t?{rowIndex:t.rowIndex,column:e.column,rowPinned:t.rowPinned}:null},t.prototype.getLastBodyCell=function(){return{rowIndex:this.paginationProxy.getPageLastRow(),rowPinned:null}},t.prototype.getLastFloatingTopRow=function(){return{rowIndex:this.pinnedRowModel.getPinnedTopRowData().length-1,rowPinned:"top"}},t.prototype.getNextTabbedCell=function(e,t){return t?this.getNextTabbedCellBackwards(e):this.getNextTabbedCellForwards(e)},t.prototype.getNextTabbedCellForwards=function(e){var t=this.columnModel.getAllDisplayedColumns(),o=e.rowIndex,n=e.rowPinned,r=this.columnModel.getDisplayedColAfter(e.column);if(!r){r=t[0];var a=this.getRowBelow(e);if(i(a))return null;if(!a.rowPinned&&!this.paginationProxy.isRowInPage(a))return null;o=a?a.rowIndex:null,n=a?a.rowPinned:null}return{rowIndex:o,column:r,rowPinned:n}},t.prototype.getNextTabbedCellBackwards=function(e){var t=this.columnModel.getAllDisplayedColumns(),o=e.rowIndex,n=e.rowPinned,r=this.columnModel.getDisplayedColBefore(e.column);if(!r){r=fe(t);var a=this.getRowAbove({rowIndex:e.rowIndex,rowPinned:e.rowPinned});if(i(a))return null;if(!a.rowPinned&&!this.paginationProxy.isRowInPage(a))return null;o=a?a.rowIndex:null,n=a?a.rowPinned:null}return{rowIndex:o,column:r,rowPinned:n}},hh([q("columnModel")],t.prototype,"columnModel",void 0),hh([q("rowModel")],t.prototype,"rowModel",void 0),hh([q("rowRenderer")],t.prototype,"rowRenderer",void 0),hh([q("pinnedRowModel")],t.prototype,"pinnedRowModel",void 0),hh([q("paginationProxy")],t.prototype,"paginationProxy",void 0),t=hh([W("cellNavigationService")],t)}(Fe),yh=function(){var e=function(t,o){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])},e(t,o)};return function(t,o){function n(){this.constructor=t}e(t,o),t.prototype=null===o?Object.create(o):(n.prototype=o.prototype,new n)}}(),vh=function(e,t,o,n){var r,i=arguments.length,a=i<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,o):n;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)a=Reflect.decorate(e,t,o,n);else for(var s=e.length-1;s>=0;s--)(r=e[s])&&(a=(i<3?r(a):i>3?r(t,o,a):r(t,o))||a);return i>3&&a&&Object.defineProperty(t,o,a),a},bh=function(e,t){return function(o,n){t(o,n,e)}},xh=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.consuming=!1,t}return yh(t,e),t.prototype.setBeans=function(e){this.logger=e.create("AlignedGridsService")},t.prototype.init=function(){this.addManagedListener(this.eventService,$e.EVENT_COLUMN_MOVED,this.fireColumnEvent.bind(this)),this.addManagedListener(this.eventService,$e.EVENT_COLUMN_VISIBLE,this.fireColumnEvent.bind(this)),this.addManagedListener(this.eventService,$e.EVENT_COLUMN_PINNED,this.fireColumnEvent.bind(this)),this.addManagedListener(this.eventService,$e.EVENT_COLUMN_GROUP_OPENED,this.fireColumnEvent.bind(this)),this.addManagedListener(this.eventService,$e.EVENT_COLUMN_RESIZED,this.fireColumnEvent.bind(this)),this.addManagedListener(this.eventService,$e.EVENT_BODY_SCROLL,this.fireScrollEvent.bind(this))},t.prototype.fireEvent=function(e){if(!this.consuming){var t=this.gridOptionsService.get("alignedGrids");t&&t.forEach((function(t){if(t.api){var o=t.api.__getAlignedGridService();e(o)}}))}},t.prototype.onEvent=function(e){this.consuming=!0,e(),this.consuming=!1},t.prototype.fireColumnEvent=function(e){this.fireEvent((function(t){t.onColumnEvent(e)}))},t.prototype.fireScrollEvent=function(e){"horizontal"===e.direction&&this.fireEvent((function(t){t.onScrollEvent(e)}))},t.prototype.onScrollEvent=function(e){var t=this;this.onEvent((function(){t.ctrlsService.getGridBodyCtrl().getScrollFeature().setHorizontalScrollPosition(e.left)}))},t.prototype.getMasterColumns=function(e){var t=[];return e.columns?e.columns.forEach((function(e){t.push(e)})):e.column&&t.push(e.column),t},t.prototype.getColumnIds=function(e){var t=[];return e.columns?e.columns.forEach((function(e){t.push(e.getColId())})):e.column&&t.push(e.column.getColId()),t},t.prototype.onColumnEvent=function(e){var t=this;this.onEvent((function(){switch(e.type){case $e.EVENT_COLUMN_MOVED:case $e.EVENT_COLUMN_VISIBLE:case $e.EVENT_COLUMN_PINNED:case $e.EVENT_COLUMN_RESIZED:var o=e;t.processColumnEvent(o);break;case $e.EVENT_COLUMN_GROUP_OPENED:var n=e;t.processGroupOpenedEvent(n);break;case $e.EVENT_COLUMN_PIVOT_CHANGED:console.warn("AG Grid: pivoting is not supported with aligned grids. You can only use one of these features at a time in a grid.")}}))},t.prototype.processGroupOpenedEvent=function(e){var t=e.columnGroup,o=null;if(t){var n=t.getGroupId();o=this.columnModel.getProvidedColumnGroup(n)}t&&!o||(this.logger.log("onColumnEvent-> processing "+e+" expanded = "+t.isExpanded()),this.columnModel.setColumnGroupOpened(o,t.isExpanded(),"alignedGridChanged"))},t.prototype.processColumnEvent=function(e){var t,o=this,n=e.column,r=null;if(n&&(r=this.columnModel.getPrimaryColumn(n.getColId())),!n||r){var i=this.getMasterColumns(e);switch(e.type){case $e.EVENT_COLUMN_MOVED:var a=e,s=e.columnApi.getColumnState().map((function(e){return{colId:e.colId}}));this.columnModel.applyColumnState({state:s,applyOrder:!0},"alignedGridChanged"),this.logger.log("onColumnEvent-> processing "+e.type+" toIndex = "+a.toIndex);break;case $e.EVENT_COLUMN_VISIBLE:var l=e;s=e.columnApi.getColumnState().map((function(e){return{colId:e.colId,hide:e.hide}}));this.columnModel.applyColumnState({state:s},"alignedGridChanged"),this.logger.log("onColumnEvent-> processing "+e.type+" visible = "+l.visible);break;case $e.EVENT_COLUMN_PINNED:var c=e;s=e.columnApi.getColumnState().map((function(e){return{colId:e.colId,pinned:e.pinned}}));this.columnModel.applyColumnState({state:s},"alignedGridChanged"),this.logger.log("onColumnEvent-> processing "+e.type+" pinned = "+c.pinned);break;case $e.EVENT_COLUMN_RESIZED:var d=e,u={};i.forEach((function(t){o.logger.log("onColumnEvent-> processing "+e.type+" actualWidth = "+t.getActualWidth()),u[t.getId()]={key:t.getColId(),newWidth:t.getActualWidth()}})),null===(t=d.flexColumns)||void 0===t||t.forEach((function(e){u[e.getId()]&&delete u[e.getId()]})),this.columnModel.setColumnWidths(Object.values(u),!1,d.finished,"alignedGridChanged")}var p=this.ctrlsService.getGridBodyCtrl().isVerticalScrollShowing(),h=this.gridOptionsService.get("alignedGrids");h&&h.forEach((function(e){e.api&&e.api.setAlwaysShowVerticalScroll(p)}))}},vh([q("columnModel")],t.prototype,"columnModel",void 0),vh([q("ctrlsService")],t.prototype,"ctrlsService",void 0),vh([bh(0,J("loggerFactory"))],t.prototype,"setBeans",null),vh([$],t.prototype,"init",null),t=vh([W("alignedGridsService")],t)}(Fe),wh=function(){var e=function(t,o){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])},e(t,o)};return function(t,o){function n(){this.constructor=t}e(t,o),t.prototype=null===o?Object.create(o):(n.prototype=o.prototype,new n)}}(),Ch=function(){return Ch=Object.assign||function(e){for(var t,o=1,n=arguments.length;o<n;o++)for(var r in t=arguments[o])Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e},Ch.apply(this,arguments)},_h=function(e,t,o,n){var r,i=arguments.length,a=i<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,o):n;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)a=Reflect.decorate(e,t,o,n);else for(var s=e.length-1;s>=0;s--)(r=e[s])&&(a=(i<3?r(a):i>3?r(t,o,a):r(t,o))||a);return i>3&&a&&Object.defineProperty(t,o,a),a},Sh=function(e,t){return function(o,n){t(o,n,e)}},Eh=function(e,t){var o="function"===typeof Symbol&&e[Symbol.iterator];if(!o)return e;var n,r,i=o.call(e),a=[];try{for(;(void 0===t||t-- >0)&&!(n=i.next()).done;)a.push(n.value)}catch(s){r={error:s}}finally{try{n&&!n.done&&(o=i.return)&&o.call(i)}finally{if(r)throw r.error}}return a},kh=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return wh(t,e),t.prototype.setBeans=function(e){this.logger=e.create("selectionService"),this.reset()},t.prototype.init=function(){var e=this;this.groupSelectsChildren=this.gridOptionsService.is("groupSelectsChildren"),this.addManagedPropertyListener("groupSelectsChildren",(function(t){return e.groupSelectsChildren=t.currentValue})),this.rowSelection=this.gridOptionsService.get("rowSelection"),this.addManagedPropertyListener("rowSelection",(function(t){return e.rowSelection=t.currentValue})),this.addManagedListener(this.eventService,$e.EVENT_ROW_SELECTED,this.onRowSelected.bind(this))},t.prototype.isMultiselect=function(){return"multiple"===this.rowSelection},t.prototype.setNodeSelected=function(e){var t,o=e.newValue,n=e.clearSelection,r=e.suppressFinishActions,i=e.rangeSelect;e.event;var a=e.node,s=e.source,l=void 0===s?"api":s,c=this.groupSelectsChildren&&!0===e.groupSelectsFiltered;if(void 0===a.id)return console.warn("AG Grid: cannot select node until id for node is known"),0;if(a.rowPinned)return console.warn("AG Grid: cannot select pinned rows"),0;if(a.footer)return this.setNodeSelected(Ch(Ch({},e),{node:a.sibling}));var d=this.getLastSelectedNode();if(i&&d&&(d!==a&&this.isMultiselect())){var u=this.selectRange(a,d,e.newValue,l);return this.setLastSelectedNode(a),u}var p=0;c&&a.group||a.selectThisNode(o,e.event,l)&&p++;if(this.groupSelectsChildren&&(null===(t=a.childrenAfterGroup)||void 0===t?void 0:t.length)&&(p+=this.selectChildren(a,o,c,l)),!r){if(o&&(n||!this.isMultiselect())&&(p+=this.clearOtherNodes(a,l)),p>0){this.updateGroupsFromChildrenSelections(l);var h={type:$e.EVENT_SELECTION_CHANGED,source:l};this.eventService.dispatchEvent(h)}o&&this.setLastSelectedNode(a)}return p},t.prototype.selectRange=function(e,t,o,n){var r=this;void 0===o&&(o=!0);var i=this.rowModel.getNodesInRangeForSelection(e,t),a=0;i.forEach((function(t){t.group&&r.groupSelectsChildren||!1===o&&e===t||t.selectThisNode(o,void 0,n)&&a++})),this.updateGroupsFromChildrenSelections(n);var s={type:$e.EVENT_SELECTION_CHANGED,source:n};return this.eventService.dispatchEvent(s),a},t.prototype.selectChildren=function(e,t,o,n){var r=o?e.childrenAfterAggFilter:e.childrenAfterGroup;if(tr.missing(r))return 0;for(var i=0,a=0;a<r.length;a++)i+=r[a].setSelectedParams({newValue:t,clearSelection:!1,suppressFinishActions:!0,groupSelectsFiltered:o,source:n});return i},t.prototype.setLastSelectedNode=function(e){this.lastSelectedNode=e},t.prototype.getLastSelectedNode=function(){return this.lastSelectedNode},t.prototype.getSelectedNodes=function(){var e=[];return h(this.selectedNodes,(function(t,o){o&&e.push(o)})),e},t.prototype.getSelectedRows=function(){var e=[];return h(this.selectedNodes,(function(t,o){o&&o.data&&e.push(o.data)})),e},t.prototype.getSelectionCount=function(){return Object.values(this.selectedNodes).length},t.prototype.filterFromSelection=function(e){var t={};Object.entries(this.selectedNodes).forEach((function(o){var n=Eh(o,2),r=n[0],i=n[1];i&&e(i)&&(t[r]=i)})),this.selectedNodes=t},t.prototype.updateGroupsFromChildrenSelections=function(e,t){if(!this.groupSelectsChildren)return!1;if("clientSide"!==this.rowModel.getType())return!1;var o=this.rowModel.getRootNode();t||(t=new Xu(!0,o)).setInactive();var n=!1;return t.forEachChangedNodeDepthFirst((function(t){if(t!==o){var r=t.calculateSelectedFromChildren();n=t.selectThisNode(null!==r&&r,void 0,e)||n}})),n},t.prototype.clearOtherNodes=function(e,t){var o=this,n={},r=0;return h(this.selectedNodes,(function(i,a){if(a&&a.id!==e.id){var s=o.selectedNodes[a.id];r+=s.setSelectedParams({newValue:!1,clearSelection:!1,suppressFinishActions:!0,source:t}),o.groupSelectsChildren&&a.parent&&(n[a.parent.id]=a.parent)}})),h(n,(function(e,o){var n=o.calculateSelectedFromChildren();o.selectThisNode(null!==n&&n,void 0,t)})),r},t.prototype.onRowSelected=function(e){var t=e.node;this.groupSelectsChildren&&t.group||(t.isSelected()?this.selectedNodes[t.id]=t:delete this.selectedNodes[t.id])},t.prototype.syncInRowNode=function(e,t){this.syncInOldRowNode(e,t),this.syncInNewRowNode(e)},t.prototype.syncInOldRowNode=function(e,t){if(r(t)&&e.id!==t.id&&t){var o=t.id;this.selectedNodes[o]==e&&(this.selectedNodes[t.id]=t)}},t.prototype.syncInNewRowNode=function(e){r(this.selectedNodes[e.id])?(e.setSelectedInitialValue(!0),this.selectedNodes[e.id]=e):e.setSelectedInitialValue(!1)},t.prototype.reset=function(){this.logger.log("reset"),this.selectedNodes={},this.lastSelectedNode=null},t.prototype.getBestCostNodeSelection=function(){if("clientSide"===this.rowModel.getType()){var e=this.rowModel.getTopLevelNodes();if(null!==e){var t=[];return function e(o){for(var n=0,r=o.length;n<r;n++){var i=o[n];if(i.isSelected())t.push(i);else{var a=i;a.group&&a.children&&e(a.children)}}}(e),t}}},t.prototype.isEmpty=function(){var e=0;return h(this.selectedNodes,(function(t,o){o&&e++})),0===e},t.prototype.deselectAllRowNodes=function(e){var t=function(e){return e.selectThisNode(!1,void 0,n)},o="clientSide"===this.rowModel.getType(),n=e.source,r=e.justFiltered,i=e.justCurrentPage;if(i||r){if(!o)return void console.error("AG Grid: selecting just filtered only works when gridOptions.rowModelType='clientSide'");this.getNodesToSelect(r,i).forEach(t)}else h(this.selectedNodes,(function(e,o){o&&t(o)})),this.reset();o&&this.groupSelectsChildren&&this.updateGroupsFromChildrenSelections(n);var a={type:$e.EVENT_SELECTION_CHANGED,source:n};this.eventService.dispatchEvent(a)},t.prototype.getSelectAllState=function(e,t){var o=this,n=0,r=0;return this.getNodesToSelect(e,t).forEach((function(e){o.groupSelectsChildren&&e.group||(e.isSelected()?n++:e.selectable&&r++)})),(0!==n||0!==r)&&(n>0&&r>0?null:n>0)},t.prototype.getNodesToSelect=function(e,t){var o=this;if(void 0===e&&(e=!1),void 0===t&&(t=!1),"clientSide"!==this.rowModel.getType())throw new Error("selectAll only available when rowModelType='clientSide', ie not "+this.rowModel.getType());var n=[];if(t)return this.paginationProxy.forEachNodeOnPage((function(e){if(e.group)if(e.expanded)o.groupSelectsChildren||n.push(e);else{var t=function(e){var o;n.push(e),(null===(o=e.childrenAfterFilter)||void 0===o?void 0:o.length)&&e.childrenAfterFilter.forEach(t)};t(e)}else n.push(e)})),n;var r=this.rowModel;return e?(r.forEachNodeAfterFilter((function(e){n.push(e)})),n):(r.forEachNode((function(e){n.push(e)})),n)},t.prototype.selectAllRowNodes=function(e){if("clientSide"!==this.rowModel.getType())throw new Error("selectAll only available when rowModelType='clientSide', ie not "+this.rowModel.getType());var t=e.source,o=e.justFiltered,n=e.justCurrentPage;this.getNodesToSelect(o,n).forEach((function(e){return e.selectThisNode(!0,void 0,t)})),"clientSide"===this.rowModel.getType()&&this.groupSelectsChildren&&this.updateGroupsFromChildrenSelections(t);var r={type:$e.EVENT_SELECTION_CHANGED,source:t};this.eventService.dispatchEvent(r)},t.prototype.getServerSideSelectionState=function(){return null},t.prototype.setServerSideSelectionState=function(e){},_h([q("rowModel")],t.prototype,"rowModel",void 0),_h([q("paginationProxy")],t.prototype,"paginationProxy",void 0),_h([Sh(0,J("loggerFactory"))],t.prototype,"setBeans",null),_h([$],t.prototype,"init",null),t=_h([W("selectionService")],t)}(Fe),jh=function(e,t,o,n){var r,i=arguments.length,a=i<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,o):n;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)a=Reflect.decorate(e,t,o,n);else for(var s=e.length-1;s>=0;s--)(r=e[s])&&(a=(i<3?r(a):i>3?r(t,o,a):r(t,o))||a);return i>3&&a&&Object.defineProperty(t,o,a),a},Ah=function(){function e(){}return e.prototype.sizeColumnsToFit=function(e){"undefined"===typeof e&&console.error("AG Grid: missing parameter to columnApi.sizeColumnsToFit(gridWidth)"),this.columnModel.sizeColumnsToFit(e,"api")},e.prototype.setColumnGroupOpened=function(e,t){this.columnModel.setColumnGroupOpened(e,t,"api")},e.prototype.getColumnGroup=function(e,t){return this.columnModel.getColumnGroup(e,t)},e.prototype.getProvidedColumnGroup=function(e){return this.columnModel.getProvidedColumnGroup(e)},e.prototype.getDisplayNameForColumn=function(e,t){return this.columnModel.getDisplayNameForColumn(e,t)||""},e.prototype.getDisplayNameForColumnGroup=function(e,t){return this.columnModel.getDisplayNameForColumnGroup(e,t)||""},e.prototype.getColumn=function(e){return this.columnModel.getPrimaryColumn(e)},e.prototype.getColumns=function(){return this.columnModel.getAllPrimaryColumns()},e.prototype.applyColumnState=function(e){return this.columnModel.applyColumnState(e,"api")},e.prototype.getColumnState=function(){return this.columnModel.getColumnState()},e.prototype.resetColumnState=function(){this.columnModel.resetColumnState("api")},e.prototype.getColumnGroupState=function(){return this.columnModel.getColumnGroupState()},e.prototype.setColumnGroupState=function(e){this.columnModel.setColumnGroupState(e,"api")},e.prototype.resetColumnGroupState=function(){this.columnModel.resetColumnGroupState("api")},e.prototype.isPinning=function(){return this.columnModel.isPinningLeft()||this.columnModel.isPinningRight()},e.prototype.isPinningLeft=function(){return this.columnModel.isPinningLeft()},e.prototype.isPinningRight=function(){return this.columnModel.isPinningRight()},e.prototype.getDisplayedColAfter=function(e){return this.columnModel.getDisplayedColAfter(e)},e.prototype.getDisplayedColBefore=function(e){return this.columnModel.getDisplayedColBefore(e)},e.prototype.setColumnVisible=function(e,t){this.columnModel.setColumnVisible(e,t,"api")},e.prototype.setColumnsVisible=function(e,t){this.columnModel.setColumnsVisible(e,t,"api")},e.prototype.setColumnPinned=function(e,t){this.columnModel.setColumnPinned(e,t,"api")},e.prototype.setColumnsPinned=function(e,t){this.columnModel.setColumnsPinned(e,t,"api")},e.prototype.getAllGridColumns=function(){return this.columnModel.getAllGridColumns()},e.prototype.getDisplayedLeftColumns=function(){return this.columnModel.getDisplayedLeftColumns()},e.prototype.getDisplayedCenterColumns=function(){return this.columnModel.getDisplayedCenterColumns()},e.prototype.getDisplayedRightColumns=function(){return this.columnModel.getDisplayedRightColumns()},e.prototype.getAllDisplayedColumns=function(){return this.columnModel.getAllDisplayedColumns()},e.prototype.getAllDisplayedVirtualColumns=function(){return this.columnModel.getViewportColumns()},e.prototype.moveColumn=function(e,t){this.columnModel.moveColumn(e,t,"api")},e.prototype.moveColumnByIndex=function(e,t){this.columnModel.moveColumnByIndex(e,t,"api")},e.prototype.moveColumns=function(e,t){this.columnModel.moveColumns(e,t,"api")},e.prototype.moveRowGroupColumn=function(e,t){this.columnModel.moveRowGroupColumn(e,t)},e.prototype.setColumnAggFunc=function(e,t){this.columnModel.setColumnAggFunc(e,t)},e.prototype.setColumnWidth=function(e,t,o,n){void 0===o&&(o=!0),this.columnModel.setColumnWidths([{key:e,newWidth:t}],!1,o,n)},e.prototype.setColumnWidths=function(e,t,o){void 0===t&&(t=!0),this.columnModel.setColumnWidths(e,!1,t,o)},e.prototype.setPivotMode=function(e){this.columnModel.setPivotMode(e)},e.prototype.isPivotMode=function(){return this.columnModel.isPivotMode()},e.prototype.getPivotResultColumn=function(e,t){return this.columnModel.getSecondaryPivotColumn(e,t)},e.prototype.setValueColumns=function(e){this.columnModel.setValueColumns(e,"api")},e.prototype.getValueColumns=function(){return this.columnModel.getValueColumns()},e.prototype.removeValueColumn=function(e){this.columnModel.removeValueColumn(e,"api")},e.prototype.removeValueColumns=function(e){this.columnModel.removeValueColumns(e,"api")},e.prototype.addValueColumn=function(e){this.columnModel.addValueColumn(e,"api")},e.prototype.addValueColumns=function(e){this.columnModel.addValueColumns(e,"api")},e.prototype.setRowGroupColumns=function(e){this.columnModel.setRowGroupColumns(e,"api")},e.prototype.removeRowGroupColumn=function(e){this.columnModel.removeRowGroupColumn(e,"api")},e.prototype.removeRowGroupColumns=function(e){this.columnModel.removeRowGroupColumns(e,"api")},e.prototype.addRowGroupColumn=function(e){this.columnModel.addRowGroupColumn(e,"api")},e.prototype.addRowGroupColumns=function(e){this.columnModel.addRowGroupColumns(e,"api")},e.prototype.getRowGroupColumns=function(){return this.columnModel.getRowGroupColumns()},e.prototype.setPivotColumns=function(e){this.columnModel.setPivotColumns(e,"api")},e.prototype.removePivotColumn=function(e){this.columnModel.removePivotColumn(e,"api")},e.prototype.removePivotColumns=function(e){this.columnModel.removePivotColumns(e,"api")},e.prototype.addPivotColumn=function(e){this.columnModel.addPivotColumn(e,"api")},e.prototype.addPivotColumns=function(e){this.columnModel.addPivotColumns(e,"api")},e.prototype.getPivotColumns=function(){return this.columnModel.getPivotColumns()},e.prototype.getLeftDisplayedColumnGroups=function(){return this.columnModel.getDisplayedTreeLeft()},e.prototype.getCenterDisplayedColumnGroups=function(){return this.columnModel.getDisplayedTreeCentre()},e.prototype.getRightDisplayedColumnGroups=function(){return this.columnModel.getDisplayedTreeRight()},e.prototype.getAllDisplayedColumnGroups=function(){return this.columnModel.getAllDisplayedTrees()},e.prototype.autoSizeColumn=function(e,t){return this.columnModel.autoSizeColumn(e,t,"api")},e.prototype.autoSizeColumns=function(e,t){this.columnModel.autoSizeColumns({columns:e,skipHeader:t})},e.prototype.autoSizeAllColumns=function(e){this.columnModel.autoSizeAllColumns(e,"api")},e.prototype.setPivotResultColumns=function(e){this.columnModel.setSecondaryColumns(e,"api")},e.prototype.getPivotResultColumns=function(){return this.columnModel.getSecondaryColumns()},e.prototype.cleanDownReferencesToAvoidMemoryLeakInCaseApplicationIsKeepingReferenceToDestroyedGrid=function(){setTimeout(tr.removeAllReferences.bind(window,this,"Column API"),100)},e.prototype.getAllColumns=function(){return it("28.0","getAllColumns","getColumns"),this.getColumns()},e.prototype.getOriginalColumnGroup=function(e){return it("27.0","getOriginalColumnGroup","getProvidedColumnGroup"),this.columnModel.getProvidedColumnGroup(e)},e.prototype.getPrimaryColumns=function(){return it("28.0","getPrimaryColumns","getColumns"),this.getColumns()},e.prototype.getSecondaryColumns=function(){return it("28.0","getSecondaryColumns","getPivotResultColumns"),this.getPivotResultColumns()},e.prototype.setSecondaryColumns=function(e){it("28.0","setSecondaryColumns","setPivotResultColumns"),this.setPivotResultColumns(e)},e.prototype.getSecondaryPivotColumn=function(e,t){return it("28.0","getSecondaryPivotColumn","getPivotResultColumn"),this.getPivotResultColumn(e,t)},jh([q("columnModel")],e.prototype,"columnModel",void 0),jh([U],e.prototype,"cleanDownReferencesToAvoidMemoryLeakInCaseApplicationIsKeepingReferenceToDestroyedGrid",null),e=jh([W("columnApi")],e)}(),Rh=function(){var e=function(t,o){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])},e(t,o)};return function(t,o){function n(){this.constructor=t}e(t,o),t.prototype=null===o?Object.create(o):(n.prototype=o.prototype,new n)}}(),Oh=function(e,t,o,n){var r,i=arguments.length,a=i<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,o):n;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)a=Reflect.decorate(e,t,o,n);else for(var s=e.length-1;s>=0;s--)(r=e[s])&&(a=(i<3?r(a):i>3?r(t,o,a):r(t,o))||a);return i>3&&a&&Object.defineProperty(t,o,a),a},Th=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.initialised=!1,t}return Rh(t,e),t.prototype.init=function(){var e=this;this.cellExpressions=this.gridOptionsService.is("enableCellExpressions"),this.isTreeData=this.gridOptionsService.is("treeData"),this.initialised=!0,this.eventService.addEventListener($e.EVENT_CELL_VALUE_CHANGED,(function(t){return e.callColumnCellValueChangedHandler(t)}),this.gridOptionsService.useAsyncEvents()),this.addManagedPropertyListener("treeData",(function(t){return e.isTreeData=t.currentValue}))},t.prototype.getValue=function(e,t,o,n){if(void 0===o&&(o=!1),void 0===n&&(n=!1),this.initialised||this.init(),t){var r,i=e.getColDef(),a=i.field,s=e.getColId(),l=t.data,c=t.groupData&&void 0!==t.groupData[s],d=!n&&t.aggData&&void 0!==t.aggData[s];if(o&&i.filterValueGetter?r=this.executeFilterValueGetter(i.filterValueGetter,l,e,t):this.isTreeData&&d?r=t.aggData[s]:this.isTreeData&&i.valueGetter?r=this.executeValueGetter(i.valueGetter,l,e,t):this.isTreeData&&a&&l?r=C(l,a,e.isFieldContainsDots()):c?r=t.groupData[s]:d?r=t.aggData[s]:i.valueGetter?r=this.executeValueGetter(i.valueGetter,l,e,t):a&&l&&(r=C(l,a,e.isFieldContainsDots())),this.cellExpressions&&"string"===typeof r&&0===r.indexOf("=")){var u=r.substring(1);r=this.executeValueGetter(u,l,e,t)}if(null==r){var p=this.getOpenedGroup(t,e);if(null!=p)return p}return r}},t.prototype.getOpenedGroup=function(e,t){if(this.gridOptionsService.is("showOpenedGroup")&&t.getColDef().showRowGroup)for(var o=t.getColDef().showRowGroup,n=e.parent;null!=n;){if(n.rowGroupColumn&&(!0===o||o===n.rowGroupColumn.getColId()))return n.key;n=n.parent}},t.prototype.setValue=function(e,t,o,n){var a=this.columnModel.getPrimaryColumn(t);if(!e||!a)return!1;i(e.data)&&(e.data={});var s=a.getColDef(),l=s.field,c=s.valueSetter;if(i(l)&&i(c))return console.warn("AG Grid: you need either field or valueSetter set on colDef for editing to work"),!1;var d,u={node:e,data:e.data,oldValue:this.getValue(a,e),newValue:o,colDef:a.getColDef(),column:a,api:this.gridOptionsService.api,columnApi:this.gridOptionsService.columnApi,context:this.gridOptionsService.context};if(u.newValue=o,void 0===(d=r(c)?"function"===typeof c?c(u):this.expressionService.evaluate(c,u):this.setValueUsingField(e.data,l,o,a.isFieldContainsDots()))&&(d=!0),!d)return!1;e.resetQuickFilterAggregateText(),this.valueCache.onDataChanged(),u.newValue=this.getValue(a,e);var p={type:$e.EVENT_CELL_VALUE_CHANGED,event:null,rowIndex:e.rowIndex,rowPinned:e.rowPinned,column:u.column,api:u.api,columnApi:u.columnApi,colDef:u.colDef,context:u.context,data:e.data,node:e,oldValue:u.oldValue,newValue:u.newValue,value:u.newValue,source:n};return this.eventService.dispatchEvent(p),!0},t.prototype.callColumnCellValueChangedHandler=function(e){var t=e.colDef.onCellValueChanged;"function"===typeof t&&t({node:e.node,data:e.data,oldValue:e.oldValue,newValue:e.newValue,colDef:e.colDef,column:e.column,api:e.api,columnApi:e.columnApi,context:e.context})},t.prototype.setValueUsingField=function(e,t,o,n){if(!t)return!1;var r=!1;if(n)for(var i=t.split("."),a=e;i.length>0&&a;){var s=i.shift();0===i.length?(r=a[s]==o)||(a[s]=o):a=a[s]}else(r=e[t]==o)||(e[t]=o);return!r},t.prototype.executeFilterValueGetter=function(e,t,o,n){var r={data:t,node:n,column:o,colDef:o.getColDef(),api:this.gridOptionsService.api,columnApi:this.gridOptionsService.columnApi,context:this.gridOptionsService.context,getValue:this.getValueCallback.bind(this,n)};return"function"===typeof e?e(r):this.expressionService.evaluate(e,r)},t.prototype.executeValueGetter=function(e,t,o,n){var r=o.getColId(),i=this.valueCache.getValue(n,r);if(void 0!==i)return i;var a,s={data:t,node:n,column:o,colDef:o.getColDef(),api:this.gridOptionsService.api,columnApi:this.gridOptionsService.columnApi,context:this.gridOptionsService.context,getValue:this.getValueCallback.bind(this,n)};return a="function"===typeof e?e(s):this.expressionService.evaluate(e,s),this.valueCache.setValue(n,r,a),a},t.prototype.getValueCallback=function(e,t){var o=this.columnModel.getPrimaryColumn(t);return o?this.getValue(o,e):null},t.prototype.getKeyForNode=function(e,t){var o=this.getValue(e,t),n=e.getColDef().keyCreator,r=o;n&&(r=n({value:o,colDef:e.getColDef(),column:e,node:t,data:t.data,api:this.gridOptionsService.api,columnApi:this.gridOptionsService.columnApi,context:this.gridOptionsService.context}));return"string"===typeof r||null==r||"[object Object]"===(r=String(r))&&j((function(){console.warn("AG Grid: a column you are grouping or pivoting by has objects as values. If you want to group by complex objects then either a) use a colDef.keyCreator (se AG Grid docs) or b) to toString() on the object to return a key")}),"getKeyForNode - warn about [object,object]"),r},Oh([q("expressionService")],t.prototype,"expressionService",void 0),Oh([q("columnModel")],t.prototype,"columnModel",void 0),Oh([q("valueCache")],t.prototype,"valueCache",void 0),Oh([$],t.prototype,"init",null),t=Oh([W("valueService")],t)}(Fe),Dh=function(){var e=function(t,o){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])},e(t,o)};return function(t,o){function n(){this.constructor=t}e(t,o),t.prototype=null===o?Object.create(o):(n.prototype=o.prototype,new n)}}(),Ph=function(e,t,o,n){var r,i=arguments.length,a=i<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,o):n;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)a=Reflect.decorate(e,t,o,n);else for(var s=e.length-1;s>=0;s--)(r=e[s])&&(a=(i<3?r(a):i>3?r(t,o,a):r(t,o))||a);return i>3&&a&&Object.defineProperty(t,o,a),a},Nh=function(e,t){return function(o,n){t(o,n,e)}},Ih=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.expressionToFunctionCache={},t}return Dh(t,e),t.prototype.setBeans=function(e){this.logger=e.create("ExpressionService")},t.prototype.evaluate=function(e,t){if("string"===typeof e)return this.evaluateExpression(e,t);console.error("AG Grid: value should be either a string or a function",e)},t.prototype.evaluateExpression=function(e,t){try{return this.createExpressionFunction(e)(t.value,t.context,t.oldValue,t.newValue,t.value,t.node,t.data,t.colDef,t.rowIndex,t.api,t.columnApi,t.getValue,t.column,t.columnGroup)}catch(o){return console.log("Processing of the expression failed"),console.log("Expression = "+e),console.log("Params =",t),console.log("Exception = "+o),null}},t.prototype.createExpressionFunction=function(e){if(this.expressionToFunctionCache[e])return this.expressionToFunctionCache[e];var t=this.createFunctionBody(e),o=new Function("x, ctx, oldValue, newValue, value, node, data, colDef, rowIndex, api, columnApi, getValue, column, columnGroup",t);return this.expressionToFunctionCache[e]=o,o},t.prototype.createFunctionBody=function(e){return e.indexOf("return")>=0?e:"return "+e+";"},Ph([Nh(0,J("loggerFactory"))],t.prototype,"setBeans",null),t=Ph([W("expressionService")],t)}(Fe),Mh=function(){var e=function(t,o){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])},e(t,o)};return function(t,o){function n(){this.constructor=t}e(t,o),t.prototype=null===o?Object.create(o):(n.prototype=o.prototype,new n)}}(),Lh=function(e,t,o,n){var r,i=arguments.length,a=i<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,o):n;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)a=Reflect.decorate(e,t,o,n);else for(var s=e.length-1;s>=0;s--)(r=e[s])&&(a=(i<3?r(a):i>3?r(t,o,a):r(t,o))||a);return i>3&&a&&Object.defineProperty(t,o,a),a},Fh=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.templateCache={},t.waitingCallbacks={},t}return Mh(t,e),t.prototype.getTemplate=function(e,t){var o=this.templateCache[e];if(o)return o;var n=this.waitingCallbacks[e],r=this;if(!n){n=[],this.waitingCallbacks[e]=n;var i=new XMLHttpRequest;i.onload=function(){r.handleHttpResult(this,e)},i.open("GET",e),i.send()}return t&&n.push(t),null},t.prototype.handleHttpResult=function(e,t){if(200===e.status&&null!==e.response){this.templateCache[t]=e.response||e.responseText;for(var o=this.waitingCallbacks[t],n=0;n<o.length;n++){(0,o[n])()}}else console.warn("AG Grid: Unable to get template error "+e.status+" - "+t)},t=Lh([W("templateService")],t)}(Fe),Gh=function(){var e=function(t,o){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])},e(t,o)};return function(t,o){function n(){this.constructor=t}e(t,o),t.prototype=null===o?Object.create(o):(n.prototype=o.prototype,new n)}}(),zh=function(e,t,o,n){var r,i=arguments.length,a=i<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,o):n;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)a=Reflect.decorate(e,t,o,n);else for(var s=e.length-1;s>=0;s--)(r=e[s])&&(a=(i<3?r(a):i>3?r(t,o,a):r(t,o))||a);return i>3&&a&&Object.defineProperty(t,o,a),a},Hh=function(e,t){return function(o,n){t(o,n,e)}},Bh=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Gh(t,e),t.prototype.setBeans=function(e){this.logging=e.is("debug")},t.prototype.create=function(e){return new Vh(e,this.isLogging.bind(this))},t.prototype.isLogging=function(){return this.logging},zh([Hh(0,J("gridOptionsService"))],t.prototype,"setBeans",null),t=zh([W("loggerFactory")],t)}(Fe),Vh=function(){function e(e,t){this.name=e,this.isLoggingFunc=t}return e.prototype.isLogging=function(){return this.isLoggingFunc()},e.prototype.log=function(e){this.isLoggingFunc()&&console.log("AG Grid."+this.name+": "+e)},e}(),$h=function(){var e=function(t,o){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])},e(t,o)};return function(t,o){function n(){this.constructor=t}e(t,o),t.prototype=null===o?Object.create(o):(n.prototype=o.prototype,new n)}}(),Uh=function(e,t,o,n){var r,i=arguments.length,a=i<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,o):n;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)a=Reflect.decorate(e,t,o,n);else for(var s=e.length-1;s>=0;s--)(r=e[s])&&(a=(i<3?r(a):i>3?r(t,o,a):r(t,o))||a);return i>3&&a&&Object.defineProperty(t,o,a),a},Wh=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return $h(t,e),t.prototype.setComp=function(e,t,o){var n=this;this.view=e,this.eGridHostDiv=t,this.eGui=o,this.dragAndDropService.addDropTarget({getContainer:function(){return n.eGui},isInterestedIn:function(e){return e===Di.HeaderCell||e===Di.ToolPanel},getIconName:function(){return Da.ICON_NOT_ALLOWED}}),this.mouseEventService.stampTopLevelGridCompWithGridInstance(t),this.createManagedBean(new Ks(this.view)),this.addRtlSupport(),this.addManagedListener(this,$e.EVENT_KEYBOARD_FOCUS,(function(){n.view.addOrRemoveKeyboardFocusClass(!0)})),this.addManagedListener(this,$e.EVENT_MOUSE_FOCUS,(function(){n.view.addOrRemoveKeyboardFocusClass(!1)}));var r=this.resizeObserverService.observeResize(this.eGridHostDiv,this.onGridSizeChanged.bind(this));this.addDestroyFunc((function(){return r()})),this.ctrlsService.registerGridCtrl(this)},t.prototype.isDetailGrid=function(){var e,t=this.focusService.findTabbableParent(this.getGui());return(null===(e=null===t||void 0===t?void 0:t.getAttribute("row-id"))||void 0===e?void 0:e.startsWith("detail"))||!1},t.prototype.showDropZones=function(){return ne.isRegistered(Q.RowGroupingModule)},t.prototype.showSideBar=function(){return ne.isRegistered(Q.SideBarModule)},t.prototype.showStatusBar=function(){return ne.isRegistered(Q.StatusBarModule)},t.prototype.showWatermark=function(){return ne.isRegistered(Q.EnterpriseCoreModule)},t.prototype.onGridSizeChanged=function(){var e={type:$e.EVENT_GRID_SIZE_CHANGED,clientWidth:this.eGridHostDiv.clientWidth,clientHeight:this.eGridHostDiv.clientHeight};this.eventService.dispatchEvent(e)},t.prototype.addRtlSupport=function(){var e=this.gridOptionsService.is("enableRtl")?"ag-rtl":"ag-ltr";this.view.setRtlClass(e)},t.prototype.destroyGridUi=function(){this.view.destroyGridUi()},t.prototype.getGui=function(){return this.eGui},t.prototype.setResizeCursor=function(e){this.view.setCursor(e?"ew-resize":null)},t.prototype.disableUserSelect=function(e){this.view.setUserSelect(e?"none":null)},t.prototype.focusNextInnerContainer=function(e){var t=this.gridOptionsService.getDocument(),o=this.view.getFocusableContainers(),n=o.findIndex((function(e){return e.contains(t.activeElement)}))+(e?-1:1);return!(n<=0||n>=o.length)&&this.focusService.focusInto(o[n])},t.prototype.focusInnerElement=function(e){var t=this.view.getFocusableContainers(),o=this.columnModel.getAllDisplayedColumns();if(e){if(t.length>1)return this.focusService.focusInto(fe(t),!0);var n=fe(o);if(this.focusService.focusGridView(n,!0))return!0}return 0===this.gridOptionsService.getNum("headerHeight")?this.focusService.focusGridView(o[0]):this.focusService.focusFirstHeader()},t.prototype.forceFocusOutOfContainer=function(e){void 0===e&&(e=!1),this.view.forceFocusOutOfContainer(e)},Uh([q("focusService")],t.prototype,"focusService",void 0),Uh([q("resizeObserverService")],t.prototype,"resizeObserverService",void 0),Uh([q("columnModel")],t.prototype,"columnModel",void 0),Uh([q("ctrlsService")],t.prototype,"ctrlsService",void 0),Uh([q("mouseEventService")],t.prototype,"mouseEventService",void 0),Uh([q("dragAndDropService")],t.prototype,"dragAndDropService",void 0),t}(Fe),qh=function(){var e=function(t,o){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])},e(t,o)};return function(t,o){function n(){this.constructor=t}e(t,o),t.prototype=null===o?Object.create(o):(n.prototype=o.prototype,new n)}}(),Kh=function(e,t,o,n){var r,i=arguments.length,a=i<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,o):n;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)a=Reflect.decorate(e,t,o,n);else for(var s=e.length-1;s>=0;s--)(r=e[s])&&(a=(i<3?r(a):i>3?r(t,o,a):r(t,o))||a);return i>3&&a&&Object.defineProperty(t,o,a),a},Yh=function(e){function t(t){var o=e.call(this)||this;return o.eGridDiv=t,o}return qh(t,e),t.prototype.postConstruct=function(){var e=this;this.logger=this.loggerFactory.create("GridComp");var t={destroyGridUi:function(){return e.destroyBean(e)},setRtlClass:function(t){return e.addCssClass(t)},addOrRemoveKeyboardFocusClass:function(t){return e.addOrRemoveCssClass(Qp.AG_KEYBOARD_FOCUS,t)},forceFocusOutOfContainer:this.forceFocusOutOfContainer.bind(this),updateLayoutClasses:this.updateLayoutClasses.bind(this),getFocusableContainers:this.getFocusableContainers.bind(this),setUserSelect:function(t){e.getGui().style.userSelect=null!=t?t:"",e.getGui().style.webkitUserSelect=null!=t?t:""},setCursor:function(t){e.getGui().style.cursor=null!=t?t:""}};this.ctrl=this.createManagedBean(new Wh);var o=this.createTemplate();this.setTemplate(o),this.ctrl.setComp(t,this.eGridDiv,this.getGui()),this.insertGridIntoDom(),this.initialiseTabGuard({onTabKeyDown:function(){},focusInnerElement:function(t){return e.ctrl.focusInnerElement(t)}})},t.prototype.insertGridIntoDom=function(){var e=this,t=this.getGui();this.eGridDiv.appendChild(t),this.addDestroyFunc((function(){e.eGridDiv.removeChild(t),e.logger.log("Grid removed from DOM")}))},t.prototype.updateLayoutClasses=function(e,t){var o=this.eRootWrapperBody.classList;o.toggle(Ns.AUTO_HEIGHT,t.autoHeight),o.toggle(Ns.NORMAL,t.normal),o.toggle(Ns.PRINT,t.print),this.addOrRemoveCssClass(Ns.AUTO_HEIGHT,t.autoHeight),this.addOrRemoveCssClass(Ns.NORMAL,t.normal),this.addOrRemoveCssClass(Ns.PRINT,t.print)},t.prototype.createTemplate=function(){return'<div class="ag-root-wrapper" role="presentation">\n                '+(this.ctrl.showDropZones()?"<ag-grid-header-drop-zones></ag-grid-header-drop-zones>":"")+'\n                <div class="ag-root-wrapper-body" ref="rootWrapperBody" role="presentation">\n                    <ag-grid-body ref="gridBody"></ag-grid-body>\n                    '+(this.ctrl.showSideBar()?'<ag-side-bar ref="sideBar"></ag-side-bar>':"")+"\n                </div>\n                "+(this.ctrl.showStatusBar()?'<ag-status-bar ref="statusBar"></ag-status-bar>':"")+"\n                <ag-pagination></ag-pagination>\n                "+(this.ctrl.showWatermark()?"<ag-watermark></ag-watermark>":"")+"\n            </div>"},t.prototype.getFocusableElement=function(){return this.eRootWrapperBody},t.prototype.getFocusableContainers=function(){var e=[this.gridBodyComp.getGui()];return this.sideBarComp&&e.push(this.sideBarComp.getGui()),e.filter((function(e){return yn(e)}))},Kh([q("loggerFactory")],t.prototype,"loggerFactory",void 0),Kh([mr("gridBody")],t.prototype,"gridBodyComp",void 0),Kh([mr("sideBar")],t.prototype,"sideBarComp",void 0),Kh([mr("rootWrapperBody")],t.prototype,"eRootWrapperBody",void 0),Kh([$],t.prototype,"postConstruct",null),t}(Rp),Jh=function(){var e=function(t,o){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])},e(t,o)};return function(t,o){function n(){this.constructor=t}e(t,o),t.prototype=null===o?Object.create(o):(n.prototype=o.prototype,new n)}}(),Xh=function(e,t,o,n){var r,i=arguments.length,a=i<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,o):n;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)a=Reflect.decorate(e,t,o,n);else for(var s=e.length-1;s>=0;s--)(r=e[s])&&(a=(i<3?r(a):i>3?r(t,o,a):r(t,o))||a);return i>3&&a&&Object.defineProperty(t,o,a),a},Qh=function(e,t){var o="function"===typeof Symbol&&e[Symbol.iterator];if(!o)return e;var n,r,i=o.call(e),a=[];try{for(;(void 0===t||t-- >0)&&!(n=i.next()).done;)a.push(n.value)}catch(s){r={error:s}}finally{try{n&&!n.done&&(o=i.return)&&o.call(i)}finally{if(r)throw r.error}}return a},Zh=function(){for(var e=[],t=0;t<arguments.length;t++)e=e.concat(Qh(arguments[t]));return e},ef=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}var o;return Jh(t,e),o=t,t.prototype.progressSort=function(e,t,o){var n=this.getNextSortDirection(e);this.setSortForColumn(e,n,t,o)},t.prototype.setSortForColumn=function(e,t,o,n){"asc"!==t&&"desc"!==t&&(t=null);var r=[e];if(this.gridOptionsService.isColumnsSortingCoupledToGroup()&&e.getColDef().showRowGroup){e.getColDef().field||(r=[]);var i=this.columnModel.getSourceColumnsForGroupColumn(e),a=null===i||void 0===i?void 0:i.filter((function(e){return e.getColDef().sortable}));a&&(r=Zh(r,a))}r.forEach((function(e){return e.setSort(t,n)})),(o||this.gridOptionsService.is("alwaysMultiSort"))&&!this.gridOptionsService.is("suppressMultiSort")||this.clearSortBarTheseColumns(r,n),this.updateSortIndex(e),this.dispatchSortChangedEvents(n)},t.prototype.updateSortIndex=function(e){var t=this.gridOptionsService.isColumnsSortingCoupledToGroup(),o=this.columnModel.getGroupDisplayColumnForGroup(e.getId()),n=t&&o||e,r=this.getColumnsWithSortingOrdered(!0);this.columnModel.getPrimaryAndSecondaryAndAutoColumns().forEach((function(e){return e.setSortIndex(null)}));var i=r.filter((function(e){return e!==n}));(n.getSort()?Zh(i,[n]):i).forEach((function(e,t){return e.setSortIndex(t)}))},t.prototype.onSortChanged=function(e){this.dispatchSortChangedEvents(e)},t.prototype.isSortActive=function(){var e=this.columnModel.getPrimaryAndSecondaryAndAutoColumns().filter((function(e){return!!e.getSort()}));return e&&e.length>0},t.prototype.dispatchSortChangedEvents=function(e){var t={type:$e.EVENT_SORT_CHANGED,source:e};this.eventService.dispatchEvent(t)},t.prototype.clearSortBarTheseColumns=function(e,t){this.columnModel.getPrimaryAndSecondaryAndAutoColumns().forEach((function(o){e.includes(o)||o.setSort(void 0,t)}))},t.prototype.getNextSortDirection=function(e){var t;if(t=e.getColDef().sortingOrder?e.getColDef().sortingOrder:this.gridOptionsService.get("sortingOrder")?this.gridOptionsService.get("sortingOrder"):o.DEFAULT_SORTING_ORDER,!Array.isArray(t)||t.length<=0)return console.warn("AG Grid: sortingOrder must be an array with at least one element, currently it's "+t),null;var n=e.getColDef().field?e.getSort():this.getDisplaySortForColumn(e),r=t[0];if("mixed"!==n){var i=t.indexOf(n),a=i<0,s=i==t.length-1;r=a||s?t[0]:t[i+1]}return o.DEFAULT_SORTING_ORDER.indexOf(r)<0?(console.warn("AG Grid: invalid sort type "+r),null):r},t.prototype.getIndexedSortMap=function(e){var t=this;void 0===e&&(e=!1);var o=this.columnModel.getPrimaryAndSecondaryAndAutoColumns().filter((function(e){return!!e.getSort()}));!e&&this.columnModel.isPivotMode()&&(o=o.filter((function(e){return!!e.getAggFunc()||!e.isPrimary()||t.columnModel.getGroupDisplayColumnForGroup(e.getId())})));var n=this.columnModel.getRowGroupColumns().filter((function(e){return!!e.getSort()})),r=this.gridOptionsService.isColumnsSortingCoupledToGroup()&&!!n.length;r&&(o=Zh(new Set(o.map((function(e){var o;return null!==(o=t.columnModel.getGroupDisplayColumnForGroup(e.getId()))&&void 0!==o?o:e})))));var i={};o.forEach((function(e,t){return i[e.getId()]=t})),o.sort((function(e,t){var o=e.getSortIndex(),n=t.getSortIndex();return null!=o&&null!=n?o-n:null==o&&null==n?i[e.getId()]>i[t.getId()]?1:-1:null==n?-1:1}));var a=new Map;return o.forEach((function(e,t){return a.set(e,t)})),r&&n.forEach((function(e){var o=t.columnModel.getGroupDisplayColumnForGroup(e.getId());a.set(e,a.get(o))})),a},t.prototype.getColumnsWithSortingOrdered=function(e){return void 0===e&&(e=!1),Zh(this.getIndexedSortMap(e).entries()).sort((function(e,t){var o=Qh(e,2);o[0];var n=o[1],r=Qh(t,2);return r[0],n-r[1]})).map((function(e){return Qh(e,1)[0]}))},t.prototype.getSortModel=function(){return this.getColumnsWithSortingOrdered(!0).map((function(e){return{sort:e.getSort(),colId:e.getId()}}))},t.prototype.getSortOptions=function(){return this.getColumnsWithSortingOrdered().map((function(e){return{sort:e.getSort(),column:e}}))},t.prototype.canColumnDisplayMixedSort=function(e){var t=this.gridOptionsService.isColumnsSortingCoupledToGroup(),o=!!e.getColDef().showRowGroup;return t&&o},t.prototype.getDisplaySortForColumn=function(e){var t=this.columnModel.getSourceColumnsForGroupColumn(e);if(!this.canColumnDisplayMixedSort(e)||!(null===t||void 0===t?void 0:t.length))return e.getSort();var o=!!e.getColDef().field?Zh([e],t):t,n=o[0].getSort();return o.every((function(e){return e.getSort()==n}))?n:"mixed"},t.prototype.getDisplaySortIndexForColumn=function(e){return this.getIndexedSortMap().get(e)},t.DEFAULT_SORTING_ORDER=["asc","desc",null],Xh([q("columnModel")],t.prototype,"columnModel",void 0),t=o=Xh([W("sortController")],t)}(Fe),tf=function(){var e=function(t,o){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])},e(t,o)};return function(t,o){function n(){this.constructor=t}e(t,o),t.prototype=null===o?Object.create(o):(n.prototype=o.prototype,new n)}}(),of=function(e,t,o,n){var r,i=arguments.length,a=i<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,o):n;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)a=Reflect.decorate(e,t,o,n);else for(var s=e.length-1;s>=0;s--)(r=e[s])&&(a=(i<3?r(a):i>3?r(t,o,a):r(t,o))||a);return i>3&&a&&Object.defineProperty(t,o,a),a},nf=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return tf(t,e),t.prototype.setMouseOver=function(e){this.selectedColumns=e;var t={type:$e.EVENT_COLUMN_HOVER_CHANGED};this.eventService.dispatchEvent(t)},t.prototype.clearMouseOver=function(){this.selectedColumns=null;var e={type:$e.EVENT_COLUMN_HOVER_CHANGED};this.eventService.dispatchEvent(e)},t.prototype.isHovered=function(e){return!!this.selectedColumns&&this.selectedColumns.indexOf(e)>=0},t=of([W("columnHoverService")],t)}(Fe),rf=function(){var e=function(t,o){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])},e(t,o)};return function(t,o){function n(){this.constructor=t}e(t,o),t.prototype=null===o?Object.create(o):(n.prototype=o.prototype,new n)}}(),af=function(e,t,o,n){var r,i=arguments.length,a=i<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,o):n;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)a=Reflect.decorate(e,t,o,n);else for(var s=e.length-1;s>=0;s--)(r=e[s])&&(a=(i<3?r(a):i>3?r(t,o,a):r(t,o))||a);return i>3&&a&&Object.defineProperty(t,o,a),a},sf=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.executeNextFuncs=[],t.executeLaterFuncs=[],t.active=!1,t.animationThreadCount=0,t}return rf(t,e),t.prototype.postConstruct=function(){var e=this;this.ctrlsService.whenReady((function(t){return e.gridBodyCtrl=t.gridBodyCtrl}))},t.prototype.isActive=function(){return this.active},t.prototype.start=function(){this.active||this.gridOptionsService.is("suppressColumnMoveAnimation")||this.gridOptionsService.is("enableRtl")||(this.ensureAnimationCssClassPresent(),this.active=!0)},t.prototype.finish=function(){this.active&&(this.flush(),this.active=!1)},t.prototype.executeNextVMTurn=function(e){this.active?this.executeNextFuncs.push(e):e()},t.prototype.executeLaterVMTurn=function(e){this.active?this.executeLaterFuncs.push(e):e()},t.prototype.ensureAnimationCssClassPresent=function(){var e=this;this.animationThreadCount++;var t=this.animationThreadCount;this.gridBodyCtrl.setColumnMovingCss(!0),this.executeLaterFuncs.push((function(){e.animationThreadCount===t&&e.gridBodyCtrl.setColumnMovingCss(!1)}))},t.prototype.flush=function(){var e=this.executeNextFuncs;this.executeNextFuncs=[];var t=this.executeLaterFuncs;this.executeLaterFuncs=[],0===e.length&&0===t.length||(window.setTimeout((function(){return e.forEach((function(e){return e()}))}),0),window.setTimeout((function(){return t.forEach((function(e){return e()}))}),300))},af([q("ctrlsService")],t.prototype,"ctrlsService",void 0),af([$],t.prototype,"postConstruct",null),t=af([W("columnAnimationService")],t)}(Fe),lf=function(){var e=function(t,o){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])},e(t,o)};return function(t,o){function n(){this.constructor=t}e(t,o),t.prototype=null===o?Object.create(o):(n.prototype=o.prototype,new n)}}(),cf=function(e,t,o,n){var r,i=arguments.length,a=i<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,o):n;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)a=Reflect.decorate(e,t,o,n);else for(var s=e.length-1;s>=0;s--)(r=e[s])&&(a=(i<3?r(a):i>3?r(t,o,a):r(t,o))||a);return i>3&&a&&Object.defineProperty(t,o,a),a},df=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return lf(t,e),t.prototype.postConstruct=function(){var e=this;this.ctrlsService.whenReady((function(t){e.centerRowContainerCon=t.centerRowContainerCtrl,e.addManagedListener(e.eventService,$e.EVENT_BODY_HEIGHT_CHANGED,e.checkPageSize.bind(e)),e.addManagedListener(e.eventService,$e.EVENT_SCROLL_VISIBILITY_CHANGED,e.checkPageSize.bind(e)),e.checkPageSize()}))},t.prototype.notActive=function(){return!this.gridOptionsService.is("paginationAutoPageSize")||null==this.centerRowContainerCon},t.prototype.checkPageSize=function(){var e=this;if(!this.notActive()){var t=this.centerRowContainerCon.getViewportSizeFeature().getBodyHeight();if(t>0){var o=function(){var o=e.gridOptionsService.getRowHeightAsNumber(),n=Math.floor(t/o);e.gridOptionsService.set("paginationPageSize",n)};this.isBodyRendered?I((function(){return o()}),50)():(o(),this.isBodyRendered=!0)}else this.isBodyRendered=!1}},cf([q("ctrlsService")],t.prototype,"ctrlsService",void 0),cf([$],t.prototype,"postConstruct",null),t=cf([W("paginationAutoPageSizeService")],t)}(Fe),uf=function(){var e=function(t,o){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])},e(t,o)};return function(t,o){function n(){this.constructor=t}e(t,o),t.prototype=null===o?Object.create(o):(n.prototype=o.prototype,new n)}}(),pf=function(e,t,o,n){var r,i=arguments.length,a=i<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,o):n;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)a=Reflect.decorate(e,t,o,n);else for(var s=e.length-1;s>=0;s--)(r=e[s])&&(a=(i<3?r(a):i>3?r(t,o,a):r(t,o))||a);return i>3&&a&&Object.defineProperty(t,o,a),a},hf=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.cacheVersion=0,t}return uf(t,e),t.prototype.init=function(){this.active=this.gridOptionsService.is("valueCache"),this.neverExpires=this.gridOptionsService.is("valueCacheNeverExpires")},t.prototype.onDataChanged=function(){this.neverExpires||this.expire()},t.prototype.expire=function(){this.cacheVersion++},t.prototype.setValue=function(e,t,o){this.active&&(e.__cacheVersion!==this.cacheVersion&&(e.__cacheVersion=this.cacheVersion,e.__cacheData={}),e.__cacheData[t]=o)},t.prototype.getValue=function(e,t){if(this.active&&e.__cacheVersion===this.cacheVersion)return e.__cacheData[t]},pf([$],t.prototype,"init",null),t=pf([W("valueCache")],t)}(Fe),ff=function(){var e=function(t,o){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])},e(t,o)};return function(t,o){function n(){this.constructor=t}e(t,o),t.prototype=null===o?Object.create(o):(n.prototype=o.prototype,new n)}}(),gf=function(e,t,o,n){var r,i=arguments.length,a=i<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,o):n;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)a=Reflect.decorate(e,t,o,n);else for(var s=e.length-1;s>=0;s--)(r=e[s])&&(a=(i<3?r(a):i>3?r(t,o,a):r(t,o))||a);return i>3&&a&&Object.defineProperty(t,o,a),a},mf=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return ff(t,e),t.prototype.init=function(){"clientSide"===this.rowModel.getType()&&(this.clientSideRowModel=this.rowModel),this.addManagedListener(this.eventService,$e.EVENT_CELL_VALUE_CHANGED,this.onCellValueChanged.bind(this))},t.prototype.onCellValueChanged=function(e){"paste"!==e.source&&this.doChangeDetection(e.node,e.column)},t.prototype.doChangeDetection=function(e,t){if(!this.gridOptionsService.is("suppressChangeDetection")){if(this.clientSideRowModel&&!e.isRowPinned()){var o=this.gridOptionsService.is("aggregateOnlyChangedColumns"),n=new Xu(o,this.clientSideRowModel.getRootNode());n.addParentNode(e.parent,[t]),this.clientSideRowModel.doAggregate(n)}this.rowRenderer.refreshCells()}},gf([q("rowModel")],t.prototype,"rowModel",void 0),gf([q("rowRenderer")],t.prototype,"rowRenderer",void 0),gf([$],t.prototype,"init",null),t=gf([W("changeDetectionService")],t)}(Fe),yf=function(){var e=function(t,o){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])},e(t,o)};return function(t,o){function n(){this.constructor=t}e(t,o),t.prototype=null===o?Object.create(o):(n.prototype=o.prototype,new n)}}(),vf=function(e,t,o,n){var r,i=arguments.length,a=i<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,o):n;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)a=Reflect.decorate(e,t,o,n);else for(var s=e.length-1;s>=0;s--)(r=e[s])&&(a=(i<3?r(a):i>3?r(t,o,a):r(t,o))||a);return i>3&&a&&Object.defineProperty(t,o,a),a},bf=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return yf(t,e),t.prototype.adaptFunction=function(e,t){var o=this.componentMetadataProvider.retrieve(e);return o&&o.functionAdapter?o.functionAdapter(t):null},t.prototype.adaptCellRendererFunction=function(e){return function(){function t(){}return t.prototype.refresh=function(e){return!1},t.prototype.getGui=function(){return this.eGui},t.prototype.init=function(t){var o=e(t),n=typeof o;this.eGui="string"!==n&&"number"!==n&&"boolean"!==n?null!=o?o:vn("<span></span>"):vn("<span>"+o+"</span>")},t}()},t.prototype.doesImplementIComponent=function(e){return!!e&&(e.prototype&&"getGui"in e.prototype)},vf([q("componentMetadataProvider")],t.prototype,"componentMetadataProvider",void 0),t=vf([W("agComponentUtils")],t)}(Fe),xf=function(){var e=function(t,o){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])},e(t,o)};return function(t,o){function n(){this.constructor=t}e(t,o),t.prototype=null===o?Object.create(o):(n.prototype=o.prototype,new n)}}(),wf=function(e,t,o,n){var r,i=arguments.length,a=i<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,o):n;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)a=Reflect.decorate(e,t,o,n);else for(var s=e.length-1;s>=0;s--)(r=e[s])&&(a=(i<3?r(a):i>3?r(t,o,a):r(t,o))||a);return i>3&&a&&Object.defineProperty(t,o,a),a},Cf=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return xf(t,e),t.prototype.postConstruct=function(){this.componentMetaData={dateComponent:{mandatoryMethodList:["getDate","setDate"],optionalMethodList:["afterGuiAttached","setInputPlaceholder","setInputAriaLabel"]},detailCellRenderer:{mandatoryMethodList:[],optionalMethodList:["refresh"],functionAdapter:this.agComponentUtils.adaptCellRendererFunction.bind(this.agComponentUtils)},headerComponent:{mandatoryMethodList:[],optionalMethodList:["refresh"]},headerGroupComponent:{mandatoryMethodList:[],optionalMethodList:[]},loadingCellRenderer:{mandatoryMethodList:[],optionalMethodList:[]},loadingOverlayComponent:{mandatoryMethodList:[],optionalMethodList:[]},noRowsOverlayComponent:{mandatoryMethodList:[],optionalMethodList:[]},floatingFilterComponent:{mandatoryMethodList:["onParentModelChanged"],optionalMethodList:["afterGuiAttached"]},floatingFilterWrapperComponent:{mandatoryMethodList:[],optionalMethodList:[]},cellRenderer:{mandatoryMethodList:[],optionalMethodList:["refresh","afterGuiAttached"],functionAdapter:this.agComponentUtils.adaptCellRendererFunction.bind(this.agComponentUtils)},cellEditor:{mandatoryMethodList:["getValue"],optionalMethodList:["isPopup","isCancelBeforeStart","isCancelAfterEnd","getPopupPosition","focusIn","focusOut","afterGuiAttached"]},innerRenderer:{mandatoryMethodList:[],optionalMethodList:["afterGuiAttached"],functionAdapter:this.agComponentUtils.adaptCellRendererFunction.bind(this.agComponentUtils)},fullWidthCellRenderer:{mandatoryMethodList:[],optionalMethodList:["refresh","afterGuiAttached"],functionAdapter:this.agComponentUtils.adaptCellRendererFunction.bind(this.agComponentUtils)},groupRowRenderer:{mandatoryMethodList:[],optionalMethodList:["afterGuiAttached"],functionAdapter:this.agComponentUtils.adaptCellRendererFunction.bind(this.agComponentUtils)},filter:{mandatoryMethodList:["isFilterActive","doesFilterPass","getModel","setModel"],optionalMethodList:["afterGuiAttached","afterGuiDetached","onNewRowsLoaded","getModelAsString","onFloatingFilterChanged","onAnyFilterChanged"]},filterComponent:{mandatoryMethodList:["isFilterActive","doesFilterPass","getModel","setModel"],optionalMethodList:["afterGuiAttached","afterGuiDetached","onNewRowsLoaded","getModelAsString","onFloatingFilterChanged","onAnyFilterChanged"]},statusPanel:{mandatoryMethodList:[],optionalMethodList:["afterGuiAttached"]},toolPanel:{mandatoryMethodList:[],optionalMethodList:["refresh","afterGuiAttached"]},tooltipComponent:{mandatoryMethodList:[],optionalMethodList:[]}}},t.prototype.retrieve=function(e){return this.componentMetaData[e]},wf([q("agComponentUtils")],t.prototype,"agComponentUtils",void 0),wf([$],t.prototype,"postConstruct",null),t=wf([W("componentMetadataProvider")],t)}(Fe),_f=function(){var e=function(t,o){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])},e(t,o)};return function(t,o){function n(){this.constructor=t}e(t,o),t.prototype=null===o?Object.create(o):(n.prototype=o.prototype,new n)}}(),Sf=function(e,t,o,n){var r,i=arguments.length,a=i<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,o):n;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)a=Reflect.decorate(e,t,o,n);else for(var s=e.length-1;s>=0;s--)(r=e[s])&&(a=(i<3?r(a):i>3?r(t,o,a):r(t,o))||a);return i>3&&a&&Object.defineProperty(t,o,a),a},Ef=function(e,t){var o="function"===typeof Symbol&&e[Symbol.iterator];if(!o)return e;var n,r,i=o.call(e),a=[];try{for(;(void 0===t||t-- >0)&&!(n=i.next()).done;)a.push(n.value)}catch(s){r={error:s}}finally{try{n&&!n.done&&(o=i.return)&&o.call(i)}finally{if(r)throw r.error}}return a},kf=function(){for(var e=[],t=0;t<arguments.length;t++)e=e.concat(Ef(arguments[t]));return e},jf={"ag-theme-custom":{headerHeight:25,headerCellMinWidth:24,listItemHeight:20,rowHeight:25,chartMenuPanelWidth:220},"ag-theme-material":{headerHeight:56,headerCellMinWidth:48,listItemHeight:32,rowHeight:48,chartMenuPanelWidth:240},"ag-theme-balham":{headerHeight:32,headerCellMinWidth:24,listItemHeight:24,rowHeight:28,chartMenuPanelWidth:220},"ag-theme-alpine":{headerHeight:48,headerCellMinWidth:36,listItemHeight:24,rowHeight:42,chartMenuPanelWidth:240}},Af={headerHeight:["ag-header-row"],headerCellMinWidth:["ag-header-cell"],listItemHeight:["ag-virtual-list-item"],rowHeight:["ag-row"],chartMenuPanelWidth:["ag-chart-docked-container"]},Rf=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.calculatedSizes={},t}return _f(t,e),t.prototype.postConstruct=function(){var e,t=this,o=null!==(e=this.getTheme().el)&&void 0!==e?e:this.eGridDiv;this.mutationObserver=new MutationObserver((function(){t.calculatedSizes={},t.fireGridStylesChangedEvent()})),this.mutationObserver.observe(o||this.eGridDiv,{attributes:!0,attributeFilter:["class"]})},t.prototype.fireGridStylesChangedEvent=function(){var e={type:$e.EVENT_GRID_STYLES_CHANGED};this.eventService.dispatchEvent(e)},t.prototype.getSassVariable=function(e){var t=this.getTheme(),o=t.themeFamily,n=t.el;if(o&&0===o.indexOf("ag-theme")){this.calculatedSizes||(this.calculatedSizes={}),this.calculatedSizes[o]||(this.calculatedSizes[o]={});var r=this.calculatedSizes[o][e];return null!=r?r:(this.calculatedSizes[o][e]=this.calculateValueForSassProperty(e,o,n),this.calculatedSizes[o][e])}},t.prototype.calculateValueForSassProperty=function(e,t,o){var n,r="ag-theme-"+(t.match("material")?"material":t.match("balham")?"balham":t.match("alpine")?"alpine":"custom"),i=jf[r][e],a=this.gridOptionsService.getDocument();if(o||(o=this.eGridDiv),!Af[e])return i;var s=Af[e],l=a.createElement("div"),c=Array.from(o.classList);(n=l.classList).add.apply(n,kf([t],c)),l.style.position="absolute";var d=s.reduce((function(e,t){var o=a.createElement("div");return o.style.position="static",o.classList.add(t),e.appendChild(o),o}),l),u=0;if(a.body){a.body.appendChild(l);var p=-1!==e.toLowerCase().indexOf("height")?"height":"width";u=parseInt(window.getComputedStyle(d)[p],10),a.body.removeChild(l)}return u||i},t.prototype.isThemeDark=function(){var e=this.getTheme().theme;return!!e&&e.indexOf("dark")>=0},t.prototype.chartMenuPanelWidth=function(){return this.getSassVariable("chartMenuPanelWidth")},t.prototype.getTheme=function(){for(var e=/\bag-(material|(?:theme-([\w\-]*)))\b/g,t=this.eGridDiv,o=null,n=[];t;){if(o=e.exec(t.className)){var r=t.className.match(e);r&&(n=r);break}t=t.parentElement||void 0}if(!o)return{allThemes:n};var i=o[0];return{theme:i,el:t,themeFamily:i.replace(/-dark$/,""),allThemes:n}},t.prototype.getFromTheme=function(e,t){var o;return null!==(o=this.getSassVariable(t))&&void 0!==o?o:e},t.prototype.getDefaultRowHeight=function(){return this.getFromTheme(25,"rowHeight")},t.prototype.getListItemHeight=function(){return this.getFromTheme(20,"listItemHeight")},t.prototype.setRowHeightVariable=function(e){var t=e+"px";this.eGridDiv.style.getPropertyValue("--ag-line-height").trim()!=t&&this.eGridDiv.style.setProperty("--ag-line-height",t)},t.prototype.getMinColWidth=function(){var e=this.getFromTheme(null,"headerCellMinWidth");return r(e)?Math.max(e,10):10},t.prototype.destroy=function(){this.calculatedSizes=null,this.mutationObserver&&this.mutationObserver.disconnect(),e.prototype.destroy.call(this)},Sf([q("eGridDiv")],t.prototype,"eGridDiv",void 0),Sf([$],t.prototype,"postConstruct",null),t=Sf([W("environment")],t)}(Fe),Of=function(){var e=function(t,o){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])},e(t,o)};return function(t,o){function n(){this.constructor=t}e(t,o),t.prototype=null===o?Object.create(o):(n.prototype=o.prototype,new n)}}(),Tf=function(e,t,o,n){var r,i=arguments.length,a=i<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,o):n;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)a=Reflect.decorate(e,t,o,n);else for(var s=e.length-1;s>=0;s--)(r=e[s])&&(a=(i<3?r(a):i>3?r(t,o,a):r(t,o))||a);return i>3&&a&&Object.defineProperty(t,o,a),a},Df=function(e,t){return function(o,n){t(o,n,e)}},Pf=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.scrollY=0,t.uiBodyHeight=0,t}return Of(t,e),t.prototype.agWire=function(e){this.logger=e.create("RowContainerHeightService")},t.prototype.postConstruct=function(){this.addManagedListener(this.eventService,$e.EVENT_BODY_HEIGHT_CHANGED,this.updateOffset.bind(this)),this.maxDivHeight=Po(),this.logger.log("maxDivHeight = "+this.maxDivHeight)},t.prototype.isStretching=function(){return this.stretching},t.prototype.getDivStretchOffset=function(){return this.divStretchOffset},t.prototype.updateOffset=function(){if(this.stretching){var e=this.ctrlsService.getGridBodyCtrl().getScrollFeature().getVScrollPosition().top,t=this.getUiBodyHeight();(e!==this.scrollY||t!==this.uiBodyHeight)&&(this.scrollY=e,this.uiBodyHeight=t,this.calculateOffset())}},t.prototype.calculateOffset=function(){this.setUiContainerHeight(this.maxDivHeight),this.pixelsToShave=this.modelHeight-this.uiContainerHeight,this.maxScrollY=this.uiContainerHeight-this.uiBodyHeight;var e=this.scrollY/this.maxScrollY,t=e*this.pixelsToShave;this.logger.log("Div Stretch Offset = "+t+" ("+this.pixelsToShave+" * "+e+")"),this.setDivStretchOffset(t)},t.prototype.setUiContainerHeight=function(e){e!==this.uiContainerHeight&&(this.uiContainerHeight=e,this.eventService.dispatchEvent({type:$e.EVENT_ROW_CONTAINER_HEIGHT_CHANGED}))},t.prototype.clearOffset=function(){this.setUiContainerHeight(this.modelHeight),this.pixelsToShave=0,this.setDivStretchOffset(0)},t.prototype.setDivStretchOffset=function(e){var t="number"===typeof e?Math.floor(e):null;this.divStretchOffset!==t&&(this.divStretchOffset=t,this.eventService.dispatchEvent({type:$e.EVENT_HEIGHT_SCALE_CHANGED}))},t.prototype.setModelHeight=function(e){this.modelHeight=e,this.stretching=null!=e&&this.maxDivHeight>0&&e>this.maxDivHeight,this.stretching?this.calculateOffset():this.clearOffset()},t.prototype.getUiContainerHeight=function(){return this.uiContainerHeight},t.prototype.getRealPixelPosition=function(e){return e-this.divStretchOffset},t.prototype.getUiBodyHeight=function(){var e=this.ctrlsService.getGridBodyCtrl().getScrollFeature().getVScrollPosition();return e.bottom-e.top},t.prototype.getScrollPositionForPixel=function(e){if(this.pixelsToShave<=0)return e;var t=e/(this.modelHeight-this.getUiBodyHeight());return this.maxScrollY*t},Tf([q("ctrlsService")],t.prototype,"ctrlsService",void 0),Tf([Df(0,J("loggerFactory"))],t.prototype,"agWire",null),Tf([$],t.prototype,"postConstruct",null),t=Tf([W("rowContainerHeightService")],t)}(Fe),Nf=function(){var e=function(t,o){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])},e(t,o)};return function(t,o){function n(){this.constructor=t}e(t,o),t.prototype=null===o?Object.create(o):(n.prototype=o.prototype,new n)}}(),If=function(e,t,o,n){var r,i=arguments.length,a=i<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,o):n;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)a=Reflect.decorate(e,t,o,n);else for(var s=e.length-1;s>=0;s--)(r=e[s])&&(a=(i<3?r(a):i>3?r(t,o,a):r(t,o))||a);return i>3&&a&&Object.defineProperty(t,o,a),a},Mf=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Nf(t,e),t.prototype.init=function(){this.groupSelectsChildren=this.gridOptionsService.is("groupSelectsChildren"),this.isRowSelectableFunc=this.gridOptionsService.get("isRowSelectable")},t.prototype.updateSelectableAfterGrouping=function(e){if(this.isRowSelectableFunc){this.recurseDown(e.childrenAfterGroup,(function(e){return e.childrenAfterGroup}))}},t.prototype.recurseDown=function(e,t){var o=this;e&&e.forEach((function(e){if(e.group){var n;if(e.hasChildren()&&o.recurseDown(t(e),t),o.groupSelectsChildren)n=r((t(e)||[]).find((function(e){return!0===e.selectable})));else n=!!o.isRowSelectableFunc&&o.isRowSelectableFunc(e);e.setRowSelectable(n)}}))},If([$],t.prototype,"init",null),t=If([W("selectableService")],t)}(Fe),Lf=function(){var e=function(t,o){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])},e(t,o)};return function(t,o){function n(){this.constructor=t}e(t,o),t.prototype=null===o?Object.create(o):(n.prototype=o.prototype,new n)}}(),Ff=function(e,t,o,n){var r,i=arguments.length,a=i<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,o):n;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)a=Reflect.decorate(e,t,o,n);else for(var s=e.length-1;s>=0;s--)(r=e[s])&&(a=(i<3?r(a):i>3?r(t,o,a):r(t,o))||a);return i>3&&a&&Object.defineProperty(t,o,a),a},Gf=function(e){function t(){var t=e.call(this)||this;return t.previousAndFirstButtonsDisabled=!1,t.nextButtonDisabled=!1,t.lastButtonDisabled=!1,t.areListenersSetup=!1,t}return Lf(t,e),t.prototype.postConstruct=function(){var e=this.gridOptionsService.is("enableRtl");this.setTemplate(this.getTemplate()),this.btFirst.insertAdjacentElement("afterbegin",Gn(e?"last":"first",this.gridOptionsService)),this.btPrevious.insertAdjacentElement("afterbegin",Gn(e?"next":"previous",this.gridOptionsService)),this.btNext.insertAdjacentElement("afterbegin",Gn(e?"previous":"next",this.gridOptionsService)),this.btLast.insertAdjacentElement("afterbegin",Gn(e?"first":"last",this.gridOptionsService)),this.addManagedPropertyListener("pagination",this.onPaginationChanged.bind(this)),this.addManagedPropertyListener("suppressPaginationPanel",this.onPaginationChanged.bind(this)),this.onPaginationChanged()},t.prototype.onPaginationChanged=function(){var e=this.gridOptionsService.is("pagination")&&!this.gridOptionsService.is("suppressPaginationPanel");this.setDisplayed(e),e&&(this.setupListeners(),this.enableOrDisableButtons(),this.updateRowLabels(),this.setCurrentPageLabel(),this.setTotalLabels())},t.prototype.setupListeners=function(){var e=this;this.areListenersSetup||(this.addManagedListener(this.eventService,$e.EVENT_PAGINATION_CHANGED,this.onPaginationChanged.bind(this)),[{el:this.btFirst,fn:this.onBtFirst.bind(this)},{el:this.btPrevious,fn:this.onBtPrevious.bind(this)},{el:this.btNext,fn:this.onBtNext.bind(this)},{el:this.btLast,fn:this.onBtLast.bind(this)}].forEach((function(t){var o=t.el,n=t.fn;e.addManagedListener(o,"click",n),e.addManagedListener(o,"keydown",(function(e){e.key!==Hn.ENTER&&e.key!==Hn.SPACE||(e.preventDefault(),n())}))})),this.areListenersSetup=!0)},t.prototype.onBtFirst=function(){this.previousAndFirstButtonsDisabled||this.paginationProxy.goToFirstPage()},t.prototype.setCurrentPageLabel=function(){var e=this.paginationProxy.getTotalPages()>0,t=this.paginationProxy.getCurrentPage(),o=e?t+1:0;this.lbCurrent.innerHTML=this.formatNumber(o)},t.prototype.formatNumber=function(e){var t=this.gridOptionsService.getCallback("paginationNumberFormatter");if(t)return t({value:e});var o=this.localeService.getLocaleTextFunc();return Bo(e,o("thousandSeparator",","),o("decimalSeparator","."))},t.prototype.getTemplate=function(){var e=this.localeService.getLocaleTextFunc(),t=e("page","Page"),o=e("to","to"),n=e("of","of"),r=e("firstPage","First Page"),i=e("previousPage","Previous Page"),a=e("nextPage","Next Page"),s=e("lastPage","Last Page"),l=this.getCompId();return'<div class="ag-paging-panel ag-unselectable" id="ag-'+l+'">\n                <span class="ag-paging-row-summary-panel" role="status">\n                    <span id="ag-'+l+'-first-row" ref="lbFirstRowOnPage" class="ag-paging-row-summary-panel-number"></span>\n                    <span id="ag-'+l+'-to">'+o+'</span>\n                    <span id="ag-'+l+'-last-row" ref="lbLastRowOnPage" class="ag-paging-row-summary-panel-number"></span>\n                    <span id="ag-'+l+'-of">'+n+'</span>\n                    <span id="ag-'+l+'-row-count" ref="lbRecordCount" class="ag-paging-row-summary-panel-number"></span>\n                </span>\n                <span class="ag-paging-page-summary-panel" role="presentation">\n                    <div ref="btFirst" class="ag-paging-button" role="button" aria-label="'+r+'"></div>\n                    <div ref="btPrevious" class="ag-paging-button" role="button" aria-label="'+i+'"></div>\n                    <span class="ag-paging-description" role="status">\n                        <span id="ag-'+l+'-start-page">'+t+'</span>\n                        <span id="ag-'+l+'-start-page-number" ref="lbCurrent" class="ag-paging-number"></span>\n                        <span id="ag-'+l+'-of-page">'+n+'</span>\n                        <span id="ag-'+l+'-of-page-number" ref="lbTotal" class="ag-paging-number"></span>\n                    </span>\n                    <div ref="btNext" class="ag-paging-button" role="button" aria-label="'+a+'"></div>\n                    <div ref="btLast" class="ag-paging-button" role="button" aria-label="'+s+'"></div>\n                </span>\n            </div>'},t.prototype.onBtNext=function(){this.nextButtonDisabled||this.paginationProxy.goToNextPage()},t.prototype.onBtPrevious=function(){this.previousAndFirstButtonsDisabled||this.paginationProxy.goToPreviousPage()},t.prototype.onBtLast=function(){this.lastButtonDisabled||this.paginationProxy.goToLastPage()},t.prototype.enableOrDisableButtons=function(){var e=this.paginationProxy.getCurrentPage(),t=this.paginationProxy.isLastPageFound(),o=this.paginationProxy.getTotalPages();this.previousAndFirstButtonsDisabled=0===e,this.toggleButtonDisabled(this.btFirst,this.previousAndFirstButtonsDisabled),this.toggleButtonDisabled(this.btPrevious,this.previousAndFirstButtonsDisabled);var n=this.isZeroPagesToDisplay(),r=t&&e===o-1;this.nextButtonDisabled=r||n,this.lastButtonDisabled=!t||n||e===o-1,this.toggleButtonDisabled(this.btNext,this.nextButtonDisabled),this.toggleButtonDisabled(this.btLast,this.lastButtonDisabled)},t.prototype.toggleButtonDisabled=function(e,t){Zt(e,t),e.classList.toggle("ag-disabled",t),t?e.removeAttribute("tabindex"):e.setAttribute("tabindex","0")},t.prototype.updateRowLabels=function(){var e,t,o=this.paginationProxy.getCurrentPage(),n=this.paginationProxy.getPageSize(),r=this.paginationProxy.isLastPageFound(),i=this.paginationProxy.isLastPageFound()?this.paginationProxy.getMasterRowCount():null;if(this.isZeroPagesToDisplay()?e=t=0:(t=(e=n*o+1)+n-1,r&&t>i&&(t=i)),this.lbFirstRowOnPage.innerHTML=this.formatNumber(e),this.rowNodeBlockLoader.isLoading()){var a=this.localeService.getLocaleTextFunc();this.lbLastRowOnPage.innerHTML=a("pageLastRowUnknown","?")}else this.lbLastRowOnPage.innerHTML=this.formatNumber(t)},t.prototype.isZeroPagesToDisplay=function(){var e=this.paginationProxy.isLastPageFound(),t=this.paginationProxy.getTotalPages();return e&&0===t},t.prototype.setTotalLabels=function(){var e=this.paginationProxy.isLastPageFound(),t=this.paginationProxy.getTotalPages(),o=e?this.paginationProxy.getMasterRowCount():null;if(1===o){var n=this.paginationProxy.getRow(0);if(n&&n.group&&!(n.groupData||n.aggData))return void this.setTotalLabelsToZero()}if(e)this.lbTotal.innerHTML=this.formatNumber(t),this.lbRecordCount.innerHTML=this.formatNumber(o);else{var r=this.localeService.getLocaleTextFunc()("more","more");this.lbTotal.innerHTML=r,this.lbRecordCount.innerHTML=r}},t.prototype.setTotalLabelsToZero=function(){this.lbFirstRowOnPage.innerHTML=this.formatNumber(0),this.lbCurrent.innerHTML=this.formatNumber(0),this.lbLastRowOnPage.innerHTML=this.formatNumber(0),this.lbTotal.innerHTML=this.formatNumber(0),this.lbRecordCount.innerHTML=this.formatNumber(0)},Ff([q("paginationProxy")],t.prototype,"paginationProxy",void 0),Ff([q("rowNodeBlockLoader")],t.prototype,"rowNodeBlockLoader",void 0),Ff([mr("btFirst")],t.prototype,"btFirst",void 0),Ff([mr("btPrevious")],t.prototype,"btPrevious",void 0),Ff([mr("btNext")],t.prototype,"btNext",void 0),Ff([mr("btLast")],t.prototype,"btLast",void 0),Ff([mr("lbRecordCount")],t.prototype,"lbRecordCount",void 0),Ff([mr("lbFirstRowOnPage")],t.prototype,"lbFirstRowOnPage",void 0),Ff([mr("lbLastRowOnPage")],t.prototype,"lbLastRowOnPage",void 0),Ff([mr("lbCurrent")],t.prototype,"lbCurrent",void 0),Ff([mr("lbTotal")],t.prototype,"lbTotal",void 0),Ff([$],t.prototype,"postConstruct",null),t}(fr),zf=function(){var e=function(t,o){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])},e(t,o)};return function(t,o){function n(){this.constructor=t}e(t,o),t.prototype=null===o?Object.create(o):(n.prototype=o.prototype,new n)}}(),Hf=function(e,t,o,n){var r,i=arguments.length,a=i<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,o):n;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)a=Reflect.decorate(e,t,o,n);else for(var s=e.length-1;s>=0;s--)(r=e[s])&&(a=(i<3?r(a):i>3?r(t,o,a):r(t,o))||a);return i>3&&a&&Object.defineProperty(t,o,a),a};!function(e){e[e.Loading=0]="Loading",e[e.NoRows=1]="NoRows"}(nh||(nh={}));var Bf=function(e){function t(){var o=e.call(this,t.TEMPLATE)||this;return o.inProgress=!1,o.destroyRequested=!1,o.manuallyDisplayed=!1,o}return zf(t,e),t.prototype.updateLayoutClasses=function(e,t){var o=this.eOverlayWrapper.classList;o.toggle(Ns.AUTO_HEIGHT,t.autoHeight),o.toggle(Ns.NORMAL,t.normal),o.toggle(Ns.PRINT,t.print)},t.prototype.postConstruct=function(){this.createManagedBean(new Ks(this)),this.setDisplayed(!1,{skipAriaHidden:!0}),this.addManagedListener(this.eventService,$e.EVENT_ROW_DATA_UPDATED,this.onRowDataUpdated.bind(this)),this.addManagedListener(this.eventService,$e.EVENT_NEW_COLUMNS_LOADED,this.onNewColumnsLoaded.bind(this)),this.gridOptionsService.isRowModelType("clientSide")&&!this.gridOptionsService.get("rowData")&&this.showLoadingOverlay(),this.gridApi.registerOverlayWrapperComp(this)},t.prototype.setWrapperTypeClass=function(e){var t=this.eOverlayWrapper.classList;t.toggle("ag-overlay-loading-wrapper",e===nh.Loading),t.toggle("ag-overlay-no-rows-wrapper",e===nh.NoRows)},t.prototype.showLoadingOverlay=function(){if(!this.gridOptionsService.is("suppressLoadingOverlay")){var e=this.userComponentFactory.getLoadingOverlayCompDetails({}).newAgStackInstance();this.showOverlay(e,nh.Loading)}},t.prototype.showNoRowsOverlay=function(){if(!this.gridOptionsService.is("suppressNoRowsOverlay")){var e=this.userComponentFactory.getNoRowsOverlayCompDetails({}).newAgStackInstance();this.showOverlay(e,nh.NoRows)}},t.prototype.showOverlay=function(e,t){var o=this;this.inProgress||(this.setWrapperTypeClass(t),this.destroyActiveOverlay(),this.inProgress=!0,e&&e.then((function(e){o.inProgress=!1,o.eOverlayWrapper.appendChild(e.getGui()),o.activeOverlay=e,o.destroyRequested&&(o.destroyRequested=!1,o.destroyActiveOverlay())})),this.manuallyDisplayed=this.columnModel.isReady()&&!this.paginationProxy.isEmpty(),this.setDisplayed(!0,{skipAriaHidden:!0}))},t.prototype.destroyActiveOverlay=function(){this.inProgress?this.destroyRequested=!0:this.activeOverlay&&(this.activeOverlay=this.getContext().destroyBean(this.activeOverlay),gn(this.eOverlayWrapper))},t.prototype.hideOverlay=function(){this.manuallyDisplayed=!1,this.destroyActiveOverlay(),this.setDisplayed(!1,{skipAriaHidden:!0})},t.prototype.destroy=function(){this.destroyActiveOverlay(),e.prototype.destroy.call(this)},t.prototype.showOrHideOverlay=function(){var e=this.paginationProxy.isEmpty(),t=this.gridOptionsService.is("suppressNoRowsOverlay");e&&!t?this.showNoRowsOverlay():this.hideOverlay()},t.prototype.onRowDataUpdated=function(){this.showOrHideOverlay()},t.prototype.onNewColumnsLoaded=function(){!this.columnModel.isReady()||this.paginationProxy.isEmpty()||this.manuallyDisplayed||this.hideOverlay()},t.TEMPLATE='\n        <div class="ag-overlay" aria-hidden="true">\n            <div class="ag-overlay-panel">\n                <div class="ag-overlay-wrapper" ref="eOverlayWrapper"></div>\n            </div>\n        </div>',Hf([q("userComponentFactory")],t.prototype,"userComponentFactory",void 0),Hf([q("paginationProxy")],t.prototype,"paginationProxy",void 0),Hf([q("gridApi")],t.prototype,"gridApi",void 0),Hf([q("columnModel")],t.prototype,"columnModel",void 0),Hf([mr("eOverlayWrapper")],t.prototype,"eOverlayWrapper",void 0),Hf([$],t.prototype,"postConstruct",null),t}(fr),Vf=function(){var e=function(t,o){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])},e(t,o)};return function(t,o){function n(){this.constructor=t}e(t,o),t.prototype=null===o?Object.create(o):(n.prototype=o.prototype,new n)}}(),$f=function(e,t,o,n){var r,i=arguments.length,a=i<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,o):n;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)a=Reflect.decorate(e,t,o,n);else for(var s=e.length-1;s>=0;s--)(r=e[s])&&(a=(i<3?r(a):i>3?r(t,o,a):r(t,o))||a);return i>3&&a&&Object.defineProperty(t,o,a),a},Uf=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Vf(t,e),t.prototype.getFirstRow=function(){var e,t=0;return this.pinnedRowModel.getPinnedTopRowCount()?e="top":this.rowModel.getRowCount()?(e=null,t=this.paginationProxy.getPageFirstRow()):this.pinnedRowModel.getPinnedBottomRowCount()&&(e="bottom"),void 0===e?null:{rowIndex:t,rowPinned:e}},t.prototype.getLastRow=function(){var e,t=null,o=this.pinnedRowModel.getPinnedBottomRowCount(),n=this.pinnedRowModel.getPinnedTopRowCount();return o?(t="bottom",e=o-1):this.rowModel.getRowCount()?(t=null,e=this.paginationProxy.getPageLastRow()):n&&(t="top",e=n-1),void 0===e?null:{rowIndex:e,rowPinned:t}},t.prototype.getRowNode=function(e){switch(e.rowPinned){case"top":return this.pinnedRowModel.getPinnedTopRowData()[e.rowIndex];case"bottom":return this.pinnedRowModel.getPinnedBottomRowData()[e.rowIndex];default:return this.rowModel.getRow(e.rowIndex)}},t.prototype.sameRow=function(e,t){return!e&&!t||!(e&&!t||!e&&t)&&(e.rowIndex===t.rowIndex&&e.rowPinned==t.rowPinned)},t.prototype.before=function(e,t){switch(e.rowPinned){case"top":if("top"!==t.rowPinned)return!0;break;case"bottom":if("bottom"!==t.rowPinned)return!1;break;default:if(r(t.rowPinned))return"top"!==t.rowPinned}return e.rowIndex<t.rowIndex},t.prototype.rowMax=function(e){var t,o=this;return e.forEach((function(e){(void 0===t||o.before(t,e))&&(t=e)})),t},t.prototype.rowMin=function(e){var t,o=this;return e.forEach((function(e){(void 0===t||o.before(e,t))&&(t=e)})),t},$f([q("rowModel")],t.prototype,"rowModel",void 0),$f([q("pinnedRowModel")],t.prototype,"pinnedRowModel",void 0),$f([q("paginationProxy")],t.prototype,"paginationProxy",void 0),t=$f([W("rowPositionUtils")],t)}(Fe),Wf=function(){var e=function(t,o){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])},e(t,o)};return function(t,o){function n(){this.constructor=t}e(t,o),t.prototype=null===o?Object.create(o):(n.prototype=o.prototype,new n)}}(),qf=function(e,t,o,n){var r,i=arguments.length,a=i<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,o):n;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)a=Reflect.decorate(e,t,o,n);else for(var s=e.length-1;s>=0;s--)(r=e[s])&&(a=(i<3?r(a):i>3?r(t,o,a):r(t,o))||a);return i>3&&a&&Object.defineProperty(t,o,a),a},Kf=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Wf(t,e),t.prototype.createId=function(e){var t=e.rowIndex,o=e.rowPinned,n=e.column;return this.createIdFromValues({rowIndex:t,column:n,rowPinned:o})},t.prototype.createIdFromValues=function(e){var t=e.rowIndex,o=e.rowPinned;return t+"."+(null==o?"null":o)+"."+e.column.getId()},t.prototype.equals=function(e,t){var o=e.column===t.column,n=e.rowPinned===t.rowPinned,r=e.rowIndex===t.rowIndex;return o&&n&&r},t=qf([W("cellPositionUtils")],t)}(Fe),Yf=function(){var e=function(t,o){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])},e(t,o)};return function(t,o){function n(){this.constructor=t}e(t,o),t.prototype=null===o?Object.create(o):(n.prototype=o.prototype,new n)}}(),Jf=function(e){this.cellValueChanges=e},Xf=function(e){function t(t,o,n,r){var i=e.call(this,t)||this;return i.initialRange=o,i.finalRange=n,i.ranges=r,i}return Yf(t,e),t}(Jf),Qf=function(){function e(t){this.actionStack=[],this.maxStackSize=t||e.DEFAULT_STACK_SIZE,this.actionStack=new Array(this.maxStackSize)}return e.prototype.pop=function(){return this.actionStack.pop()},e.prototype.push=function(e){e.cellValueChanges&&e.cellValueChanges.length>0&&(this.actionStack.length===this.maxStackSize&&this.actionStack.shift(),this.actionStack.push(e))},e.prototype.clear=function(){this.actionStack=[]},e.prototype.getCurrentStackSize=function(){return this.actionStack.length},e.DEFAULT_STACK_SIZE=10,e}(),Zf=function(){var e=function(t,o){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])},e(t,o)};return function(t,o){function n(){this.constructor=t}e(t,o),t.prototype=null===o?Object.create(o):(n.prototype=o.prototype,new n)}}(),eg=function(){return eg=Object.assign||function(e){for(var t,o=1,n=arguments.length;o<n;o++)for(var r in t=arguments[o])Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e},eg.apply(this,arguments)},tg=function(e,t,o,n){var r,i=arguments.length,a=i<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,o):n;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)a=Reflect.decorate(e,t,o,n);else for(var s=e.length-1;s>=0;s--)(r=e[s])&&(a=(i<3?r(a):i>3?r(t,o,a):r(t,o))||a);return i>3&&a&&Object.defineProperty(t,o,a),a},og=function(e,t){var o="function"===typeof Symbol&&e[Symbol.iterator];if(!o)return e;var n,r,i=o.call(e),a=[];try{for(;(void 0===t||t-- >0)&&!(n=i.next()).done;)a.push(n.value)}catch(s){r={error:s}}finally{try{n&&!n.done&&(o=i.return)&&o.call(i)}finally{if(r)throw r.error}}return a},ng=function(){for(var e=[],t=0;t<arguments.length;t++)e=e.concat(og(arguments[t]));return e},rg=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.cellValueChanges=[],t.activeCellEdit=null,t.activeRowEdit=null,t.isPasting=!1,t.isRangeInAction=!1,t.onCellValueChanged=function(e){var o={column:e.column,rowIndex:e.rowIndex,rowPinned:e.rowPinned},n=null!==t.activeCellEdit&&t.cellPositionUtils.equals(t.activeCellEdit,o),r=null!==t.activeRowEdit&&t.rowPositionUtils.sameRow(t.activeRowEdit,o);if(n||r||t.isPasting||t.isRangeInAction){var i=e.rowPinned,a=e.rowIndex,s=e.column,l=e.oldValue,c=e.value,d={rowPinned:i,rowIndex:a,columnId:s.getColId(),newValue:c,oldValue:l};t.cellValueChanges.push(d)}},t.clearStacks=function(){t.undoStack.clear(),t.redoStack.clear()},t}return Zf(t,e),t.prototype.init=function(){var e=this;if(this.gridOptionsService.is("undoRedoCellEditing")){var t=this.gridOptionsService.getNum("undoRedoCellEditingLimit");t<=0||(this.undoStack=new Qf(t),this.redoStack=new Qf(t),this.addRowEditingListeners(),this.addCellEditingListeners(),this.addPasteListeners(),this.addFillListeners(),this.addCellKeyListeners(),this.addManagedListener(this.eventService,$e.EVENT_CELL_VALUE_CHANGED,this.onCellValueChanged),this.addManagedListener(this.eventService,$e.EVENT_MODEL_UPDATED,(function(t){t.keepUndoRedoStack||e.clearStacks()})),this.addManagedListener(this.eventService,$e.EVENT_COLUMN_PIVOT_MODE_CHANGED,this.clearStacks),this.addManagedListener(this.eventService,$e.EVENT_NEW_COLUMNS_LOADED,this.clearStacks),this.addManagedListener(this.eventService,$e.EVENT_COLUMN_GROUP_OPENED,this.clearStacks),this.addManagedListener(this.eventService,$e.EVENT_COLUMN_ROW_GROUP_CHANGED,this.clearStacks),this.addManagedListener(this.eventService,$e.EVENT_COLUMN_MOVED,this.clearStacks),this.addManagedListener(this.eventService,$e.EVENT_COLUMN_PINNED,this.clearStacks),this.addManagedListener(this.eventService,$e.EVENT_COLUMN_VISIBLE,this.clearStacks),this.addManagedListener(this.eventService,$e.EVENT_ROW_DRAG_END,this.clearStacks),this.ctrlsService.whenReady((function(){e.gridBodyCtrl=e.ctrlsService.getGridBodyCtrl()})))}},t.prototype.getCurrentUndoStackSize=function(){return this.undoStack?this.undoStack.getCurrentStackSize():0},t.prototype.getCurrentRedoStackSize=function(){return this.redoStack?this.redoStack.getCurrentStackSize():0},t.prototype.undo=function(e){var t={type:$e.EVENT_UNDO_STARTED,source:e};this.eventService.dispatchEvent(t);var o=this.undoRedo(this.undoStack,this.redoStack,"initialRange","oldValue","undo"),n={type:$e.EVENT_UNDO_ENDED,source:e,operationPerformed:o};this.eventService.dispatchEvent(n)},t.prototype.redo=function(e){var t={type:$e.EVENT_REDO_STARTED,source:e};this.eventService.dispatchEvent(t);var o=this.undoRedo(this.redoStack,this.undoStack,"finalRange","newValue","redo"),n={type:$e.EVENT_REDO_ENDED,source:e,operationPerformed:o};this.eventService.dispatchEvent(n)},t.prototype.undoRedo=function(e,t,o,n,r){if(!e)return!1;var i=e.pop();return!(!i||!i.cellValueChanges)&&(this.processAction(i,(function(e){return e[n]}),r),i instanceof Xf?this.processRange(i.ranges||[i[o]]):this.processCell(i.cellValueChanges),t.push(i),!0)},t.prototype.processAction=function(e,t,o){var n=this;e.cellValueChanges.forEach((function(e){var r=e.rowIndex,i=e.rowPinned,a=e.columnId,s={rowIndex:r,rowPinned:i},l=n.getRowNode(s);l.displayed&&l.setDataValue(a,t(e),o)}))},t.prototype.processRange=function(e){var t,o=this;this.rangeService.removeAllCellRanges(!0),e.forEach((function(n,r){if(n){var i=n.startRow,a=n.endRow;r===e.length-1&&(t={rowPinned:i.rowPinned,rowIndex:i.rowIndex,columnId:n.startColumn.getColId()},o.setLastFocusedCell(t));var s={rowStartIndex:i.rowIndex,rowStartPinned:i.rowPinned,rowEndIndex:a.rowIndex,rowEndPinned:a.rowPinned,columnStart:n.startColumn,columns:n.columns};o.rangeService.addCellRange(s)}}))},t.prototype.processCell=function(e){var t=e[0],o={rowIndex:t.rowIndex,rowPinned:t.rowPinned},n=this.getRowNode(o),r={rowPinned:t.rowPinned,rowIndex:n.rowIndex,columnId:t.columnId};this.setLastFocusedCell(r,!!this.rangeService)},t.prototype.setLastFocusedCell=function(e,t){var o=e.rowIndex,n=e.columnId,r=e.rowPinned,i=this.gridBodyCtrl.getScrollFeature(),a=this.columnModel.getGridColumn(n);if(a){i.ensureIndexVisible(o),i.ensureColumnVisible(a);var s={rowIndex:o,column:a,rowPinned:r};this.focusService.setFocusedCell(eg(eg({},s),{forceBrowserFocus:!0})),t&&this.rangeService.setRangeToCell(s)}},t.prototype.addRowEditingListeners=function(){var e=this;this.addManagedListener(this.eventService,$e.EVENT_ROW_EDITING_STARTED,(function(t){e.activeRowEdit={rowIndex:t.rowIndex,rowPinned:t.rowPinned}})),this.addManagedListener(this.eventService,$e.EVENT_ROW_EDITING_STOPPED,(function(){var t=new Jf(e.cellValueChanges);e.pushActionsToUndoStack(t),e.activeRowEdit=null}))},t.prototype.addCellEditingListeners=function(){var e=this;this.addManagedListener(this.eventService,$e.EVENT_CELL_EDITING_STARTED,(function(t){e.activeCellEdit={column:t.column,rowIndex:t.rowIndex,rowPinned:t.rowPinned}})),this.addManagedListener(this.eventService,$e.EVENT_CELL_EDITING_STOPPED,(function(t){if(e.activeCellEdit=null,t.valueChanged&&!e.activeRowEdit&&!e.isPasting&&!e.isRangeInAction){var o=new Jf(e.cellValueChanges);e.pushActionsToUndoStack(o)}}))},t.prototype.addPasteListeners=function(){var e=this;this.addManagedListener(this.eventService,$e.EVENT_PASTE_START,(function(){e.isPasting=!0})),this.addManagedListener(this.eventService,$e.EVENT_PASTE_END,(function(){var t=new Jf(e.cellValueChanges);e.pushActionsToUndoStack(t),e.isPasting=!1}))},t.prototype.addFillListeners=function(){var e=this;this.addManagedListener(this.eventService,$e.EVENT_FILL_START,(function(){e.isRangeInAction=!0})),this.addManagedListener(this.eventService,$e.EVENT_FILL_END,(function(t){var o=new Xf(e.cellValueChanges,t.initialRange,t.finalRange);e.pushActionsToUndoStack(o),e.isRangeInAction=!1}))},t.prototype.addCellKeyListeners=function(){var e=this;this.addManagedListener(this.eventService,$e.EVENT_KEY_SHORTCUT_CHANGED_CELL_START,(function(){e.isRangeInAction=!0})),this.addManagedListener(this.eventService,$e.EVENT_KEY_SHORTCUT_CHANGED_CELL_END,(function(){var t;t=e.rangeService&&e.gridOptionsService.isEnableRangeSelection()?new Xf(e.cellValueChanges,void 0,void 0,ng(e.rangeService.getCellRanges())):new Jf(e.cellValueChanges),e.pushActionsToUndoStack(t),e.isRangeInAction=!1}))},t.prototype.pushActionsToUndoStack=function(e){this.undoStack.push(e),this.cellValueChanges=[],this.redoStack.clear()},t.prototype.getRowNode=function(e){switch(e.rowPinned){case"top":return this.pinnedRowModel.getPinnedTopRowData()[e.rowIndex];case"bottom":return this.pinnedRowModel.getPinnedBottomRowData()[e.rowIndex];default:return this.rowModel.getRow(e.rowIndex)}},tg([q("focusService")],t.prototype,"focusService",void 0),tg([q("ctrlsService")],t.prototype,"ctrlsService",void 0),tg([q("rowModel")],t.prototype,"rowModel",void 0),tg([q("pinnedRowModel")],t.prototype,"pinnedRowModel",void 0),tg([q("cellPositionUtils")],t.prototype,"cellPositionUtils",void 0),tg([q("rowPositionUtils")],t.prototype,"rowPositionUtils",void 0),tg([q("columnModel")],t.prototype,"columnModel",void 0),tg([K("rangeService")],t.prototype,"rangeService",void 0),tg([$],t.prototype,"init",null),t=tg([W("undoRedoService")],t)}(Fe),ig=function(){var e=function(t,o){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])},e(t,o)};return function(t,o){function n(){this.constructor=t}e(t,o),t.prototype=null===o?Object.create(o):(n.prototype=o.prototype,new n)}}(),ag=function(e,t,o,n){var r,i=arguments.length,a=i<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,o):n;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)a=Reflect.decorate(e,t,o,n);else for(var s=e.length-1;s>=0;s--)(r=e[s])&&(a=(i<3?r(a):i>3?r(t,o,a):r(t,o))||a);return i>3&&a&&Object.defineProperty(t,o,a),a},sg=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return ig(t,e),t.prototype.findHeader=function(e,t){var o,n,r;if(e.column instanceof ct?(n="getDisplayedGroup"+t,o=this.columnModel[n](e.column)):(r="getDisplayedCol"+t,o=this.columnModel[r](e.column)),o){var i=e.headerRowIndex;if(this.getHeaderRowType(i)===$c.COLUMN_GROUP){var a=o;if(a.isPadding()&&this.isAnyChildSpanningHeaderHeight(a)){var s=this.getColumnVisibleChild(a,i,t),l=s.nextFocusColumn,c=s.nextRow;l&&(o=l,i=c)}}return{column:o,headerRowIndex:i}}},t.prototype.isAnyChildSpanningHeaderHeight=function(e){return!!e&&e.getLeafColumns().some((function(e){return e.isSpanHeaderHeight()}))},t.prototype.getColumnVisibleParent=function(e,t){var o=this.getHeaderRowType(t),n=o===$c.FLOATING_FILTER,r=o===$c.COLUMN,i=n?e:e.getParent(),a=t-1;if(r&&this.isAnyChildSpanningHeaderHeight(e.getParent())){for(;i&&i.isPadding();)i=i.getParent(),a--;a<0&&(i=e,a=t)}return{nextFocusColumn:i,nextRow:a}},t.prototype.getColumnVisibleChild=function(e,t,o){void 0===o&&(o="After");var n=e,r=t+1;if(this.getHeaderRowType(t)===$c.COLUMN_GROUP){var i=e.getLeafColumns(),a="After"===o?i[0]:fe(i);if(this.isAnyChildSpanningHeaderHeight(a.getParent())){n=a;for(var s=a.getParent();s&&s!==e;)s=s.getParent(),r++}else n=e.getDisplayedChildren()[0]}return{nextFocusColumn:n,nextRow:r}},t.prototype.getHeaderRowType=function(e){var t=this.ctrlsService.getHeaderRowContainerCtrl();if(t)return t.getRowType(e)},t.prototype.findColAtEdgeForHeaderRow=function(e,t){var o=this.columnModel.getAllDisplayedColumns(),n=o["start"===t?0:o.length-1];if(n){var r=this.ctrlsService.getHeaderRowContainerCtrl(n.getPinned()).getRowType(e);return r==$c.COLUMN_GROUP?{headerRowIndex:e,column:this.columnModel.getColumnGroupAtLevel(n,e)}:{headerRowIndex:null==r?-1:e,column:n}}},ag([q("columnModel")],t.prototype,"columnModel",void 0),ag([q("ctrlsService")],t.prototype,"ctrlsService",void 0),t=ag([W("headerPositionUtils")],t)}(Fe),lg=function(e,t,o,n){var r,i=arguments.length,a=i<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,o):n;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)a=Reflect.decorate(e,t,o,n);else for(var s=e.length-1;s>=0;s--)(r=e[s])&&(a=(i<3?r(a):i>3?r(t,o,a):r(t,o))||a);return i>3&&a&&Object.defineProperty(t,o,a),a},cg=function(){function e(){}return e.prototype.buildColumnDefs=function(e,t,o){var n=this,r=[],i={};return e.forEach((function(e){for(var a=!0,s=n.createDefFromColumn(e,t,o),l=e.getOriginalParent();l;){var c=null;if(l.isPadding())l=l.getOriginalParent();else{var d=i[l.getGroupId()];if(d){d.children.push(s),a=!1;break}(c=n.createDefFromGroup(l))&&(c.children=[s],i[c.groupId]=c,s=c,l=l.getOriginalParent())}}a&&r.push(s)})),r},e.prototype.createDefFromGroup=function(e){var t=g(e.getColGroupDef(),["children"]);return t&&(t.groupId=e.getGroupId()),t},e.prototype.createDefFromColumn=function(e,t,o){var n=g(e.getColDef());return n.colId=e.getColId(),n.width=e.getActualWidth(),n.rowGroup=e.isRowGroupActive(),n.rowGroupIndex=e.isRowGroupActive()?t.indexOf(e):null,n.pivot=e.isPivotActive(),n.pivotIndex=e.isPivotActive()?o.indexOf(e):null,n.aggFunc=e.isValueActive()?e.getAggFunc():null,n.hide=!e.isVisible()||void 0,n.pinned=e.isPinned()?e.getPinned():null,n.sort=e.getSort()?e.getSort():null,n.sortIndex=null!=e.getSortIndex()?e.getSortIndex():null,n},e=lg([W("columnDefFactory")],e)}(),dg=function(e,t,o,n){var r,i=arguments.length,a=i<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,o):n;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)a=Reflect.decorate(e,t,o,n);else for(var s=e.length-1;s>=0;s--)(r=e[s])&&(a=(i<3?r(a):i>3?r(t,o,a):r(t,o))||a);return i>3&&a&&Object.defineProperty(t,o,a),a},ug=function(){function e(){}return e.prototype.getInitialRowClasses=function(e){var t=[];return r(e.extraCssClass)&&t.push(e.extraCssClass),t.push("ag-row"),t.push(e.rowFocused?"ag-row-focus":"ag-row-no-focus"),e.fadeRowIn&&t.push("ag-opacity-zero"),t.push(e.rowIsEven?"ag-row-even":"ag-row-odd"),e.rowNode.isRowPinned()&&t.push("ag-row-pinned"),e.rowNode.isSelected()&&t.push("ag-row-selected"),e.rowNode.footer&&t.push("ag-row-footer"),t.push("ag-row-level-"+e.rowLevel),e.rowNode.stub&&t.push("ag-row-loading"),e.fullWidthRow&&t.push("ag-full-width-row"),e.expandable&&(t.push("ag-row-group"),t.push(e.rowNode.expanded?"ag-row-group-expanded":"ag-row-group-contracted")),e.rowNode.dragging&&t.push("ag-row-dragging"),_e(t,this.processClassesFromGridOptions(e.rowNode)),_e(t,this.preProcessRowClassRules(e.rowNode)),t.push(e.printLayout?"ag-row-position-relative":"ag-row-position-absolute"),e.firstRowOnPage&&t.push("ag-row-first"),e.lastRowOnPage&&t.push("ag-row-last"),e.fullWidthRow&&("left"===e.pinned&&t.push("ag-cell-last-left-pinned"),"right"===e.pinned&&t.push("ag-cell-first-right-pinned")),t},e.prototype.processClassesFromGridOptions=function(e){var t=[],o=function(e){"string"===typeof e?t.push(e):Array.isArray(e)&&e.forEach((function(e){return t.push(e)}))},n=this.gridOptionsService.get("rowClass");if(n){if("function"===typeof n)return console.warn("AG Grid: rowClass should not be a function, please use getRowClass instead"),[];o(n)}var r=this.gridOptionsService.getCallback("getRowClass");r&&o(r({data:e.data,node:e,rowIndex:e.rowIndex}));return t},e.prototype.preProcessRowClassRules=function(e){var t=[];return this.processRowClassRules(e,(function(e){t.push(e)}),(function(e){})),t},e.prototype.processRowClassRules=function(e,t,o){var n={data:e.data,node:e,rowIndex:e.rowIndex,api:this.gridOptionsService.api,columnApi:this.gridOptionsService.columnApi,context:this.gridOptionsService.context};this.stylingService.processClassRules(this.gridOptionsService.get("rowClassRules"),n,t,o)},e.prototype.calculateRowLevel=function(e){return e.group?e.level:e.parent?e.parent.level+1:0},dg([q("stylingService")],e.prototype,"stylingService",void 0),dg([q("gridOptionsService")],e.prototype,"gridOptionsService",void 0),e=dg([W("rowCssClassCalculator")],e)}(),pg=function(){var e=function(t,o){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])},e(t,o)};return function(t,o){function n(){this.constructor=t}e(t,o),t.prototype=null===o?Object.create(o):(n.prototype=o.prototype,new n)}}(),hg=function(e,t,o,n){var r,i=arguments.length,a=i<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,o):n;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)a=Reflect.decorate(e,t,o,n);else for(var s=e.length-1;s>=0;s--)(r=e[s])&&(a=(i<3?r(a):i>3?r(t,o,a):r(t,o))||a);return i>3&&a&&Object.defineProperty(t,o,a),a},fg=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return pg(t,e),t.prototype.init=function(){var e=this;this.isAccentedSort=this.gridOptionsService.is("accentedSort"),this.primaryColumnsSortGroups=this.gridOptionsService.isColumnsSortingCoupledToGroup(),this.addManagedPropertyListener("accentedSort",(function(t){return e.isAccentedSort=t.currentValue})),this.addManagedPropertyListener("autoGroupColumnDef",(function(){return e.primaryColumnsSortGroups=e.gridOptionsService.isColumnsSortingCoupledToGroup()}))},t.prototype.doFullSort=function(e,t){var o=e.map((function(e,t){return{currentPos:t,rowNode:e}}));return o.sort(this.compareRowNodes.bind(this,t)),o.map((function(e){return e.rowNode}))},t.prototype.compareRowNodes=function(e,t,o){for(var n=t.rowNode,r=o.rowNode,i=0,a=e.length;i<a;i++){var s=e[i],l="desc"===s.sort,c=this.getValue(n,s.column),d=this.getValue(r,s.column),u=void 0,p=this.getComparator(s,n);if(u=p?p(c,d,n,r,l):tr.defaultComparator(c,d,this.isAccentedSort),!isNaN(u)&&0!==u)return"asc"===s.sort?u:-1*u}return t.currentPos-o.currentPos},t.prototype.getComparator=function(e,t){var o=e.column,n=o.getColDef().comparator;if(null!=n)return n;if(o.getColDef().showRowGroup){var r=!t.group&&o.getColDef().field;if(r){var i=this.columnModel.getPrimaryColumn(r);if(i)return i.getColDef().comparator}}},t.prototype.getValue=function(e,t){var o,n;if(!this.primaryColumnsSortGroups)return this.valueService.getValue(t,e,!1,!1);if(e.rowGroupColumn===t){if(this.gridOptionsService.isGroupUseEntireRow(this.columnModel.isPivotActive())){if(t.getColDef().keyCreator)return e.key;var r=null===(o=e.allLeafChildren)||void 0===o?void 0:o[0];return r?this.valueService.getValue(t,r,!1,!1):void 0}var i=this.columnModel.getGroupDisplayColumnForGroup(t.getId());if(!i)return;return null===(n=e.groupData)||void 0===n?void 0:n[i.getId()]}return e.group&&t.getColDef().showRowGroup?void 0:this.valueService.getValue(t,e,!1,!1)},hg([q("valueService")],t.prototype,"valueService",void 0),hg([q("columnModel")],t.prototype,"columnModel",void 0),hg([$],t.prototype,"init",null),t=hg([W("rowNodeSorter")],t)}(Fe),gg=function(){var e=function(t,o){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])},e(t,o)};return function(t,o){function n(){this.constructor=t}e(t,o),t.prototype=null===o?Object.create(o):(n.prototype=o.prototype,new n)}}(),mg=function(e,t,o,n){var r,i=arguments.length,a=i<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,o):n;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)a=Reflect.decorate(e,t,o,n);else for(var s=e.length-1;s>=0;s--)(r=e[s])&&(a=(i<3?r(a):i>3?r(t,o,a):r(t,o))||a);return i>3&&a&&Object.defineProperty(t,o,a),a},yg=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.ready=!1,t.readyCallbacks=[],t}var o;return gg(t,e),o=t,t.prototype.checkReady=function(){if(this.ready=null!=this.gridCtrl&&null!=this.gridBodyCtrl&&null!=this.centerRowContainerCtrl&&null!=this.leftRowContainerCtrl&&null!=this.rightRowContainerCtrl&&null!=this.bottomCenterRowContainerCtrl&&null!=this.bottomLeftRowContainerCtrl&&null!=this.bottomRightRowContainerCtrl&&null!=this.topCenterRowContainerCtrl&&null!=this.topLeftRowContainerCtrl&&null!=this.topRightRowContainerCtrl&&null!=this.stickyTopCenterRowContainerCtrl&&null!=this.stickyTopLeftRowContainerCtrl&&null!=this.stickyTopRightRowContainerCtrl&&null!=this.centerHeaderRowContainerCtrl&&null!=this.leftHeaderRowContainerCtrl&&null!=this.rightHeaderRowContainerCtrl&&null!=this.fakeHScrollComp&&null!=this.fakeVScrollComp&&null!=this.gridHeaderCtrl,this.ready){var e=this.createReadyParams();this.readyCallbacks.forEach((function(t){return t(e)})),this.readyCallbacks.length=0}},t.prototype.whenReady=function(e){this.ready?e(this.createReadyParams()):this.readyCallbacks.push(e)},t.prototype.createReadyParams=function(){return{centerRowContainerCtrl:this.centerRowContainerCtrl,leftRowContainerCtrl:this.leftRowContainerCtrl,rightRowContainerCtrl:this.rightRowContainerCtrl,bottomCenterRowContainerCtrl:this.bottomCenterRowContainerCtrl,bottomLeftRowContainerCtrl:this.bottomLeftRowContainerCtrl,bottomRightRowContainerCtrl:this.bottomRightRowContainerCtrl,topCenterRowContainerCtrl:this.topCenterRowContainerCtrl,topLeftRowContainerCtrl:this.topLeftRowContainerCtrl,topRightRowContainerCtrl:this.topRightRowContainerCtrl,stickyTopCenterRowContainerCtrl:this.stickyTopCenterRowContainerCtrl,stickyTopLeftRowContainerCtrl:this.stickyTopLeftRowContainerCtrl,stickyTopRightRowContainerCtrl:this.stickyTopRightRowContainerCtrl,centerHeaderRowContainerCtrl:this.centerHeaderRowContainerCtrl,leftHeaderRowContainerCtrl:this.leftHeaderRowContainerCtrl,rightHeaderRowContainerCtrl:this.rightHeaderRowContainerCtrl,fakeHScrollComp:this.fakeHScrollComp,fakeVScrollComp:this.fakeVScrollComp,gridBodyCtrl:this.gridBodyCtrl,gridCtrl:this.gridCtrl,gridHeaderCtrl:this.gridHeaderCtrl}},t.prototype.registerFakeHScrollComp=function(e){this.fakeHScrollComp=e,this.checkReady()},t.prototype.registerFakeVScrollComp=function(e){this.fakeVScrollComp=e,this.checkReady()},t.prototype.registerGridHeaderCtrl=function(e){this.gridHeaderCtrl=e,this.checkReady()},t.prototype.registerCenterRowContainerCtrl=function(e){this.centerRowContainerCtrl=e,this.checkReady()},t.prototype.registerLeftRowContainerCtrl=function(e){this.leftRowContainerCtrl=e,this.checkReady()},t.prototype.registerRightRowContainerCtrl=function(e){this.rightRowContainerCtrl=e,this.checkReady()},t.prototype.registerTopCenterRowContainerCtrl=function(e){this.topCenterRowContainerCtrl=e,this.checkReady()},t.prototype.registerTopLeftRowContainerCon=function(e){this.topLeftRowContainerCtrl=e,this.checkReady()},t.prototype.registerTopRightRowContainerCtrl=function(e){this.topRightRowContainerCtrl=e,this.checkReady()},t.prototype.registerStickyTopCenterRowContainerCtrl=function(e){this.stickyTopCenterRowContainerCtrl=e,this.checkReady()},t.prototype.registerStickyTopLeftRowContainerCon=function(e){this.stickyTopLeftRowContainerCtrl=e,this.checkReady()},t.prototype.registerStickyTopRightRowContainerCtrl=function(e){this.stickyTopRightRowContainerCtrl=e,this.checkReady()},t.prototype.registerBottomCenterRowContainerCtrl=function(e){this.bottomCenterRowContainerCtrl=e,this.checkReady()},t.prototype.registerBottomLeftRowContainerCtrl=function(e){this.bottomLeftRowContainerCtrl=e,this.checkReady()},t.prototype.registerBottomRightRowContainerCtrl=function(e){this.bottomRightRowContainerCtrl=e,this.checkReady()},t.prototype.registerHeaderContainer=function(e,t){switch(t){case"left":this.leftHeaderRowContainerCtrl=e;break;case"right":this.rightHeaderRowContainerCtrl=e;break;default:this.centerHeaderRowContainerCtrl=e}this.checkReady()},t.prototype.registerGridBodyCtrl=function(e){this.gridBodyCtrl=e,this.checkReady()},t.prototype.registerGridCtrl=function(e){this.gridCtrl=e,this.checkReady()},t.prototype.getFakeHScrollComp=function(){return this.fakeHScrollComp},t.prototype.getFakeVScrollComp=function(){return this.fakeVScrollComp},t.prototype.getGridHeaderCtrl=function(){return this.gridHeaderCtrl},t.prototype.getGridCtrl=function(){return this.gridCtrl},t.prototype.getCenterRowContainerCtrl=function(){return this.centerRowContainerCtrl},t.prototype.getTopCenterRowContainerCtrl=function(){return this.topCenterRowContainerCtrl},t.prototype.getBottomCenterRowContainerCtrl=function(){return this.bottomCenterRowContainerCtrl},t.prototype.getStickyTopCenterRowContainerCtrl=function(){return this.stickyTopCenterRowContainerCtrl},t.prototype.getGridBodyCtrl=function(){return this.gridBodyCtrl},t.prototype.getHeaderRowContainerCtrls=function(){return[this.leftHeaderRowContainerCtrl,this.rightHeaderRowContainerCtrl,this.centerHeaderRowContainerCtrl]},t.prototype.getHeaderRowContainerCtrl=function(e){switch(e){case"left":return this.leftHeaderRowContainerCtrl;case"right":return this.rightHeaderRowContainerCtrl;default:return this.centerHeaderRowContainerCtrl}},t.NAME="ctrlsService",t=o=mg([W(o.NAME)],t)}(Fe),vg=function(){var e=function(t,o){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])},e(t,o)};return function(t,o){function n(){this.constructor=t}e(t,o),t.prototype=null===o?Object.create(o):(n.prototype=o.prototype,new n)}}(),bg=function(e,t,o,n){var r,i=arguments.length,a=i<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,o):n;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)a=Reflect.decorate(e,t,o,n);else for(var s=e.length-1;s>=0;s--)(r=e[s])&&(a=(i<3?r(a):i>3?r(t,o,a):r(t,o))||a);return i>3&&a&&Object.defineProperty(t,o,a),a},xg=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.registry={},t}return vg(t,e),t.prototype.register=function(e){this.registry[e.controllerName]=e.controllerClass},t.prototype.getInstance=function(e){var t=this.registry[e];if(null!=t)return new t},t=bg([W("ctrlsFactory")],t)}(Fe),wg=function(){var e=function(t,o){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])},e(t,o)};return function(t,o){function n(){this.constructor=t}e(t,o),t.prototype=null===o?Object.create(o):(n.prototype=o.prototype,new n)}}(),Cg=function(e,t,o,n){var r,i=arguments.length,a=i<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,o):n;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)a=Reflect.decorate(e,t,o,n);else for(var s=e.length-1;s>=0;s--)(r=e[s])&&(a=(i<3?r(a):i>3?r(t,o,a):r(t,o))||a);return i>3&&a&&Object.defineProperty(t,o,a),a},_g=function(e){function t(t,o){var n=e.call(this,t)||this;return n.direction=o,n.hideTimeout=null,n}return wg(t,e),t.prototype.postConstruct=function(){this.addManagedListener(this.eventService,$e.EVENT_SCROLL_VISIBILITY_CHANGED,this.onScrollVisibilityChanged.bind(this)),this.onScrollVisibilityChanged(),this.addOrRemoveCssClass("ag-apple-scrollbar",Ro()||Oo())},t.prototype.initialiseInvisibleScrollbar=function(){void 0===this.invisibleScrollbar&&(this.invisibleScrollbar=Fo(),this.invisibleScrollbar&&(this.hideAndShowInvisibleScrollAsNeeded(),this.addActiveListenerToggles()))},t.prototype.addActiveListenerToggles=function(){var e=this,t=this.getGui();["mouseenter","mousedown","touchstart"].forEach((function(o){return e.addManagedListener(t,o,(function(){return e.addOrRemoveCssClass("ag-scrollbar-active",!0)}))})),["mouseleave","touchend"].forEach((function(o){return e.addManagedListener(t,o,(function(){return e.addOrRemoveCssClass("ag-scrollbar-active",!1)}))}))},t.prototype.onScrollVisibilityChanged=function(){void 0===this.invisibleScrollbar&&this.initialiseInvisibleScrollbar(),this.setScrollVisible()},t.prototype.hideAndShowInvisibleScrollAsNeeded=function(){var e=this;this.addManagedListener(this.eventService,$e.EVENT_BODY_SCROLL,(function(t){t.direction===e.direction&&(null!==e.hideTimeout&&(window.clearTimeout(e.hideTimeout),e.hideTimeout=null),e.addOrRemoveCssClass("ag-scrollbar-scrolling",!0))})),this.addManagedListener(this.eventService,$e.EVENT_BODY_SCROLL_END,(function(){e.hideTimeout=window.setTimeout((function(){e.addOrRemoveCssClass("ag-scrollbar-scrolling",!1),e.hideTimeout=null}),400)}))},t.prototype.getViewport=function(){return this.eViewport},t.prototype.getContainer=function(){return this.eContainer},Cg([mr("eViewport")],t.prototype,"eViewport",void 0),Cg([mr("eContainer")],t.prototype,"eContainer",void 0),Cg([q("scrollVisibleService")],t.prototype,"scrollVisibleService",void 0),Cg([q("ctrlsService")],t.prototype,"ctrlsService",void 0),t}(fr),Sg=function(){var e=function(t,o){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])},e(t,o)};return function(t,o){function n(){this.constructor=t}e(t,o),t.prototype=null===o?Object.create(o):(n.prototype=o.prototype,new n)}}(),Eg=function(e,t,o,n){var r,i=arguments.length,a=i<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,o):n;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)a=Reflect.decorate(e,t,o,n);else for(var s=e.length-1;s>=0;s--)(r=e[s])&&(a=(i<3?r(a):i>3?r(t,o,a):r(t,o))||a);return i>3&&a&&Object.defineProperty(t,o,a),a},kg=function(e){function t(){return e.call(this,t.TEMPLATE,"horizontal")||this}return Sg(t,e),t.prototype.postConstruct=function(){var t=this;e.prototype.postConstruct.call(this);var o=this.setFakeHScrollSpacerWidths.bind(this);this.addManagedListener(this.eventService,$e.EVENT_DISPLAYED_COLUMNS_CHANGED,o),this.addManagedListener(this.eventService,$e.EVENT_DISPLAYED_COLUMNS_WIDTH_CHANGED,o),this.addManagedListener(this.eventService,$e.EVENT_PINNED_ROW_DATA_CHANGED,this.onPinnedRowDataChanged.bind(this)),this.addManagedPropertyListener("domLayout",o),this.ctrlsService.registerFakeHScrollComp(this),this.createManagedBean(new dc((function(e){return t.eContainer.style.width=e+"px"})))},t.prototype.initialiseInvisibleScrollbar=function(){void 0===this.invisibleScrollbar&&(this.enableRtl=this.gridOptionsService.is("enableRtl"),e.prototype.initialiseInvisibleScrollbar.call(this),this.invisibleScrollbar&&this.refreshCompBottom())},t.prototype.onPinnedRowDataChanged=function(){this.refreshCompBottom()},t.prototype.refreshCompBottom=function(){if(this.invisibleScrollbar){var e=this.pinnedRowModel.getPinnedBottomTotalHeight();this.getGui().style.bottom=e+"px"}},t.prototype.onScrollVisibilityChanged=function(){e.prototype.onScrollVisibilityChanged.call(this),this.setFakeHScrollSpacerWidths()},t.prototype.setFakeHScrollSpacerWidths=function(){var e=this.scrollVisibleService.isVerticalScrollShowing(),t=this.columnModel.getDisplayedColumnsRightWidth(),o=!this.enableRtl&&e,n=this.gridOptionsService.getScrollbarWidth();o&&(t+=n),An(this.eRightSpacer,t),this.eRightSpacer.classList.toggle("ag-scroller-corner",t<=n);var r=this.columnModel.getDisplayedColumnsLeftWidth();this.enableRtl&&e&&(r+=n),An(this.eLeftSpacer,r),this.eLeftSpacer.classList.toggle("ag-scroller-corner",r<=n)},t.prototype.setScrollVisible=function(){var e=this.scrollVisibleService.isHorizontalScrollShowing(),t=this.invisibleScrollbar,o=this.gridOptionsService.is("suppressHorizontalScroll"),n=e&&this.gridOptionsService.getScrollbarWidth()||0,r=o?0:0===n&&t?16:n;this.addOrRemoveCssClass("ag-scrollbar-invisible",t),Rn(this.getGui(),r),Rn(this.eViewport,r),Rn(this.eContainer,r),this.setDisplayed(e,{skipAriaHidden:!0})},t.TEMPLATE='<div class="ag-body-horizontal-scroll" aria-hidden="true">\n            <div class="ag-horizontal-left-spacer" ref="eLeftSpacer"></div>\n            <div class="ag-body-horizontal-scroll-viewport" ref="eViewport">\n                <div class="ag-body-horizontal-scroll-container" ref="eContainer"></div>\n            </div>\n            <div class="ag-horizontal-right-spacer" ref="eRightSpacer"></div>\n        </div>',Eg([mr("eLeftSpacer")],t.prototype,"eLeftSpacer",void 0),Eg([mr("eRightSpacer")],t.prototype,"eRightSpacer",void 0),Eg([q("columnModel")],t.prototype,"columnModel",void 0),Eg([q("pinnedRowModel")],t.prototype,"pinnedRowModel",void 0),Eg([$],t.prototype,"postConstruct",null),t}(_g),jg=function(){var e=function(t,o){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])},e(t,o)};return function(t,o){function n(){this.constructor=t}e(t,o),t.prototype=null===o?Object.create(o):(n.prototype=o.prototype,new n)}}(),Ag=function(e,t,o,n){var r,i=arguments.length,a=i<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,o):n;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)a=Reflect.decorate(e,t,o,n);else for(var s=e.length-1;s>=0;s--)(r=e[s])&&(a=(i<3?r(a):i>3?r(t,o,a):r(t,o))||a);return i>3&&a&&Object.defineProperty(t,o,a),a},Rg=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return jg(t,e),t.prototype.postConstruct=function(){var e=this.checkContainerWidths.bind(this);this.addManagedListener(this.eventService,$e.EVENT_DISPLAYED_COLUMNS_CHANGED,e),this.addManagedListener(this.eventService,$e.EVENT_DISPLAYED_COLUMNS_WIDTH_CHANGED,e),this.addManagedPropertyListener("domLayout",e)},t.prototype.checkContainerWidths=function(){var e=this.gridOptionsService.isDomLayout("print"),t=e?0:this.columnModel.getDisplayedColumnsLeftWidth(),o=e?0:this.columnModel.getDisplayedColumnsRightWidth();t!=this.leftWidth&&(this.leftWidth=t,this.eventService.dispatchEvent({type:$e.EVENT_LEFT_PINNED_WIDTH_CHANGED})),o!=this.rightWidth&&(this.rightWidth=o,this.eventService.dispatchEvent({type:$e.EVENT_RIGHT_PINNED_WIDTH_CHANGED}))},t.prototype.getPinnedRightWidth=function(){return this.rightWidth},t.prototype.getPinnedLeftWidth=function(){return this.leftWidth},Ag([q("columnModel")],t.prototype,"columnModel",void 0),Ag([$],t.prototype,"postConstruct",null),t=Ag([W("pinnedWidthService")],t)}(Fe),Og=function(){var e=function(t,o){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])},e(t,o)};return function(t,o){function n(){this.constructor=t}e(t,o),t.prototype=null===o?Object.create(o):(n.prototype=o.prototype,new n)}}(),Tg=function(e,t,o,n){var r,i=arguments.length,a=i<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,o):n;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)a=Reflect.decorate(e,t,o,n);else for(var s=e.length-1;s>=0;s--)(r=e[s])&&(a=(i<3?r(a):i>3?r(t,o,a):r(t,o))||a);return i>3&&a&&Object.defineProperty(t,o,a),a},Dg=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.events=[],t}return Og(t,e),t.prototype.postConstruct=function(){"clientSide"==this.rowModel.getType()&&(this.clientSideRowModel=this.rowModel)},t.prototype.dispatchExpanded=function(e){var t=this;if(null!=this.clientSideRowModel){this.events.push(e);null==this.dispatchExpandedDebounced&&(this.dispatchExpandedDebounced=this.animationFrameService.debounce((function(){t.clientSideRowModel&&t.clientSideRowModel.onRowGroupOpened(),t.events.forEach((function(e){return t.eventService.dispatchEvent(e)})),t.events=[]}))),this.dispatchExpandedDebounced()}else this.eventService.dispatchEvent(e)},Tg([q("animationFrameService")],t.prototype,"animationFrameService",void 0),Tg([q("rowModel")],t.prototype,"rowModel",void 0),Tg([$],t.prototype,"postConstruct",null),t=Tg([W("rowNodeEventThrottle")],t)}(Fe),Pg=function(){return Pg=Object.assign||function(e){for(var t,o=1,n=arguments.length;o<n;o++)for(var r in t=arguments[o])Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e},Pg.apply(this,arguments)},Ng=function(e,t,o,n){var r,i=arguments.length,a=i<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,o):n;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)a=Reflect.decorate(e,t,o,n);else for(var s=e.length-1;s>=0;s--)(r=e[s])&&(a=(i<3?r(a):i>3?r(t,o,a):r(t,o))||a);return i>3&&a&&Object.defineProperty(t,o,a),a},Ig=function(e,t){return function(o,n){t(o,n,e)}},Mg=function(e,t){var o="function"===typeof Symbol&&e[Symbol.iterator];if(!o)return e;var n,r,i=o.call(e),a=[];try{for(;(void 0===t||t-- >0)&&!(n=i.next()).done;)a.push(n.value)}catch(s){r={error:s}}finally{try{n&&!n.done&&(o=i.return)&&o.call(i)}finally{if(r)throw r.error}}return a},Lg=function(){for(var e=[],t=0;t<arguments.length;t++)e=e.concat(Mg(arguments[t]));return e};function Fg(e){return!0===e||"true"===e}var Gg,zg=function(){function e(){this.destroyed=!1,this.domDataKey="__AG_"+Math.random().toString(),this.propertyEventService=new te}return Object.defineProperty(e.prototype,"context",{get:function(){return this.gridOptions.context},enumerable:!1,configurable:!0}),e.prototype.agWire=function(e,t){this.gridOptions.api=e,this.gridOptions.columnApi=t,this.api=e,this.columnApi=t},e.prototype.init=function(){this.gridOptionLookup=new Set(Lg(Xe.ALL_PROPERTIES,Xe.EVENT_CALLBACKS));var e=!this.is("suppressAsyncEvents");this.eventService.addGlobalListener(this.globalEventHandler.bind(this),e),this.getScrollbarWidth()},e.prototype.destroy=function(){this.gridOptions.api=null,this.gridOptions.columnApi=null,this.destroyed=!0},e.prototype.is=function(e){return Fg(this.gridOptions[e])},e.prototype.get=function(e){return this.gridOptions[e]},e.prototype.getNum=function(e){return"number"==typeof(t=this.gridOptions[e])?t:"string"==typeof t?parseInt(t,10):void 0;var t},e.prototype.getCallback=function(e){return this.mergeGridCommonParams(this.gridOptions[e])},e.prototype.exists=function(e){return r(this.gridOptions[e])},e.prototype.mergeGridCommonParams=function(e){var t=this;if(e){return function(o){var n=o;return n.api=t.api,n.columnApi=t.columnApi,n.context=t.context,e(n)}}return e},e.prototype.set=function(e,t,o,n){if(void 0===o&&(o=!1),void 0===n&&(n={}),this.gridOptionLookup.has(e)){var r=this.gridOptions[e];if(o||r!==t){this.gridOptions[e]=t;var i=Pg({type:e,currentValue:t,previousValue:r},n);this.propertyEventService.dispatchEvent(i)}}},e.prototype.addEventListener=function(e,t){this.propertyEventService.addEventListener(e,t)},e.prototype.removeEventListener=function(e,t){this.propertyEventService.removeEventListener(e,t)},e.prototype.globalEventHandler=function(e,t){if(!this.destroyed){var o=Xe.getCallbackForEvent(e);"function"===typeof this.gridOptions[o]&&this.gridOptions[o](t)}},e.prototype.getScrollbarWidth=function(){if(null==this.scrollbarWidth){var e="number"===typeof this.gridOptions.scrollbarWidth&&this.gridOptions.scrollbarWidth>=0?this.gridOptions.scrollbarWidth:Mo();null!=e&&(this.scrollbarWidth=e,this.eventService.dispatchEvent({type:$e.EVENT_SCROLLBAR_WIDTH_CHANGED}))}return this.scrollbarWidth},e.prototype.isRowModelType=function(e){return this.gridOptions.rowModelType===e||"clientSide"===e&&i(this.gridOptions.rowModelType)},e.prototype.isDomLayout=function(e){var t;return(null!==(t=this.gridOptions.domLayout)&&void 0!==t?t:"normal")===e},e.prototype.isRowSelection=function(){return"single"===this.gridOptions.rowSelection||"multiple"===this.gridOptions.rowSelection},e.prototype.useAsyncEvents=function(){return!this.is("suppressAsyncEvents")},e.prototype.isGetRowHeightFunction=function(){return"function"===typeof this.gridOptions.getRowHeight},e.prototype.getRowHeightForNode=function(e,t,o){if(void 0===t&&(t=!1),null==o&&(o=this.environment.getDefaultRowHeight()),this.isGetRowHeightFunction()){if(t)return{height:o,estimated:!0};var n={node:e,data:e.data},r=this.getCallback("getRowHeight")(n);if(this.isNumeric(r))return 0===r&&j((function(){return console.warn("AG Grid: The return of `getRowHeight` cannot be zero. If the intention is to hide rows, use a filter instead.")}),"invalidRowHeight"),{height:Math.max(1,r),estimated:!1}}return e.detail&&this.is("masterDetail")?this.getMasterDetailRowHeight():{height:this.gridOptions.rowHeight&&this.isNumeric(this.gridOptions.rowHeight)?this.gridOptions.rowHeight:o,estimated:!1}},e.prototype.getMasterDetailRowHeight=function(){return this.is("detailRowAutoHeight")?{height:1,estimated:!1}:this.isNumeric(this.gridOptions.detailRowHeight)?{height:this.gridOptions.detailRowHeight,estimated:!1}:{height:300,estimated:!1}},e.prototype.getRowHeightAsNumber=function(){if(!this.gridOptions.rowHeight||i(this.gridOptions.rowHeight))return this.environment.getDefaultRowHeight();var e=this.gridOptions.rowHeight;return e&&this.isNumeric(e)?(this.environment.setRowHeightVariable(e),e):(console.warn("AG Grid row height must be a number if not using standard row model"),this.environment.getDefaultRowHeight())},e.prototype.isNumeric=function(e){return!isNaN(e)&&"number"===typeof e&&isFinite(e)},e.prototype.getDomDataKey=function(){return this.domDataKey},e.prototype.getDomData=function(e,t){var o=e[this.getDomDataKey()];return o?o[t]:void 0},e.prototype.setDomData=function(e,t,o){var n=this.getDomDataKey(),r=e[n];i(r)&&(r={},e[n]=r),r[t]=o},e.prototype.getDocument=function(){var e=null;return this.gridOptions.getDocument&&r(this.gridOptions.getDocument)?e=this.gridOptions.getDocument():this.eGridDiv&&(e=this.eGridDiv.ownerDocument),e&&r(e)?e:document},e.prototype.getRootNode=function(){return this.eGridDiv.getRootNode()},e.prototype.getRowIdFunc=function(){var e=this.getCallback("getRowId");if(e)return e;var t=this.gridOptions.getRowNodeId;return t?function(e){return t(e.data)}:void 0},e.prototype.getAsyncTransactionWaitMillis=function(){return r(this.gridOptions.asyncTransactionWaitMillis)?this.gridOptions.asyncTransactionWaitMillis:50},e.prototype.isAnimateRows=function(){return!this.is("ensureDomOrder")&&this.is("animateRows")},e.prototype.isTreeData=function(){return this.is("treeData")&&ne.assertRegistered(Q.RowGroupingModule,"Tree Data")},e.prototype.isMasterDetail=function(){return this.is("masterDetail")&&ne.assertRegistered(Q.MasterDetailModule,"masterDetail")},e.prototype.isEnableRangeSelection=function(){return this.is("enableRangeSelection")&&ne.isRegistered(Q.RangeSelectionModule)},e.prototype.isColumnsSortingCoupledToGroup=function(){var e=this.gridOptions.autoGroupColumnDef;return this.isRowModelType("clientSide")&&!(null===e||void 0===e?void 0:e.comparator)&&!this.isTreeData()},e.prototype.getGroupAggFiltering=function(){var e=this.gridOptions.groupAggFiltering;return"function"===typeof e?this.getCallback("groupAggFiltering"):Fg(e)?function(){return!0}:void 0},e.prototype.isGroupMultiAutoColumn=function(){return this.gridOptions.groupDisplayType?st("multipleColumns",this.gridOptions.groupDisplayType):this.is("groupHideOpenParents")},e.prototype.isGroupUseEntireRow=function(e){return!e&&(!!this.gridOptions.groupDisplayType&&st("groupRows",this.gridOptions.groupDisplayType))},Ng([q("gridOptions")],e.prototype,"gridOptions",void 0),Ng([q("eventService")],e.prototype,"eventService",void 0),Ng([q("environment")],e.prototype,"environment",void 0),Ng([q("eGridDiv")],e.prototype,"eGridDiv",void 0),Ng([Ig(0,J("gridApi")),Ig(1,J("columnApi"))],e.prototype,"agWire",null),Ng([$],e.prototype,"init",null),Ng([U],e.prototype,"destroy",null),e=Ng([W("gridOptionsService")],e)}(),Hg=function(){var e=function(t,o){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])},e(t,o)};return function(t,o){function n(){this.constructor=t}e(t,o),t.prototype=null===o?Object.create(o):(n.prototype=o.prototype,new n)}}(),Bg=function(e,t,o,n){var r,i=arguments.length,a=i<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,o):n;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)a=Reflect.decorate(e,t,o,n);else for(var s=e.length-1;s>=0;s--)(r=e[s])&&(a=(i<3?r(a):i>3?r(t,o,a):r(t,o))||a);return i>3&&a&&Object.defineProperty(t,o,a),a},Vg=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Hg(t,e),t.prototype.getLocaleTextFunc=function(){var e=this.gridOptionsService.getCallback("getLocaleText");if(e)return function(t,o,n){return e({key:t,defaultValue:o,variableValues:n})};var t=this.gridOptionsService.get("localeTextFunc");if(t)return t;var o=this.gridOptionsService.get("localeText");return function(e,t,n){var r=o&&o[e];if(r&&n&&n.length)for(var i=0;!(i>=n.length);){if(-1===r.indexOf("${variable}"))break;r=r.replace("${variable}",n[i++])}return null!==r&&void 0!==r?r:t}},t=Bg([W("localeService")],t)}(Fe),$g=function(){var e=function(t,o){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])},e(t,o)};return function(t,o){function n(){this.constructor=t}e(t,o),t.prototype=null===o?Object.create(o):(n.prototype=o.prototype,new n)}}(),Ug=function(e,t,o,n){var r,i=arguments.length,a=i<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,o):n;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)a=Reflect.decorate(e,t,o,n);else for(var s=e.length-1;s>=0;s--)(r=e[s])&&(a=(i<3?r(a):i>3?r(t,o,a):r(t,o))||a);return i>3&&a&&Object.defineProperty(t,o,a),a},Wg=function(e){function t(){return e.call(this,t.TEMPLATE,"vertical")||this}return $g(t,e),t.prototype.postConstruct=function(){e.prototype.postConstruct.call(this),this.createManagedBean(new rc(this.eContainer)),this.ctrlsService.registerFakeVScrollComp(this)},t.prototype.setScrollVisible=function(){var e=this.scrollVisibleService.isVerticalScrollShowing(),t=this.invisibleScrollbar,o=e&&this.gridOptionsService.getScrollbarWidth()||0,n=0===o&&t?16:o;this.addOrRemoveCssClass("ag-scrollbar-invisible",t),An(this.getGui(),n),An(this.eViewport,n),An(this.eContainer,n),this.setDisplayed(e,{skipAriaHidden:!0})},t.TEMPLATE='<div class="ag-body-vertical-scroll" aria-hidden="true">\n            <div class="ag-body-vertical-scroll-viewport" ref="eViewport">\n                <div class="ag-body-vertical-scroll-container" ref="eContainer"></div>\n            </div>\n        </div>',Ug([$],t.prototype,"postConstruct",null),t}(_g),qg=function(e,t){var o="function"===typeof Symbol&&e[Symbol.iterator];if(!o)return e;var n,r,i=o.call(e),a=[];try{for(;(void 0===t||t-- >0)&&!(n=i.next()).done;)a.push(n.value)}catch(s){r={error:s}}finally{try{n&&!n.done&&(o=i.return)&&o.call(i)}finally{if(r)throw r.error}}return a},Kg=function(){for(var e=[],t=0;t<arguments.length;t++)e=e.concat(qg(arguments[t]));return e},Yg=function(){function e(e,t,o){t?(this.gridOptions=t,(new Jg).create(e,t,(function(t){var o=new Yh(e);t.createBean(o)}),void 0,o)):console.error("AG Grid: no gridOptions provided to the grid")}return e.prototype.destroy=function(){this.gridOptions&&this.gridOptions.api&&this.gridOptions.api.destroy()},e}(),Jg=function(){function e(){}return e.prototype.create=function(e,t,o,n,r){var i=this,a=!!t.debug,s=this.getRegisteredModules(r),l=this.createBeansList(t.rowModelType,s),c=this.createProvidedBeans(e,t,r);if(l){var d={providedBeanInstances:c,beanClasses:l,debug:a},u=new Vh("AG Grid",(function(){return t.debug})),p=new Vh("Context",(function(){return d.debug})),h=new B(d,p),f=h.getBean("beans");this.registerModuleUserComponents(f,s),this.registerStackComponents(f,s),this.registerControllers(f,s),o(h),f.ctrlsService.whenReady((function(){i.setColumnsAndData(f),i.dispatchGridReadyEvent(f);var e=ne.isRegistered(Q.EnterpriseCoreModule);u.log("initialised successfully, enterprise = "+e)})),n&&n(h)}},e.prototype.registerControllers=function(e,t){t.forEach((function(t){t.controllers&&t.controllers.forEach((function(t){return e.ctrlsFactory.register(t)}))}))},e.prototype.registerStackComponents=function(e,t){var o=this.createAgStackComponentsList(t);e.agStackComponentsRegistry.setupComponents(o)},e.prototype.getRegisteredModules=function(e){var t=e?e.modules:null,o=ne.getRegisteredModules(),n=[],r={};function i(e,t){var o;r[(o=t).moduleName]||(r[o.moduleName]=!0,n.push(o),ne.register(o,e)),t.dependantModules&&t.dependantModules.forEach(i.bind(null,e))}return t&&t.forEach(i.bind(null,!0)),o&&o.forEach(i.bind(null,!ne.isPackageBased())),n},e.prototype.registerModuleUserComponents=function(e,t){this.extractModuleEntity(t,(function(e){return e.userComponents?e.userComponents:[]})).forEach((function(t){e.userComponentRegistry.registerDefaultComponent(t.componentName,t.componentClass)}))},e.prototype.createProvidedBeans=function(e,t,o){var n=o?o.frameworkOverrides:null;i(n)&&(n=new uh);var r={gridOptions:t,eGridDiv:e,globalEventListener:o?o.globalEventListener:null,frameworkOverrides:n};return o&&o.providedBeanInstances&&Object.assign(r,o.providedBeanInstances),r},e.prototype.createAgStackComponentsList=function(e){var t=[{componentName:"AgCheckbox",componentClass:ti},{componentName:"AgRadioButton",componentClass:ni},{componentName:"AgToggleButton",componentClass:up},{componentName:"AgInputTextField",componentClass:ki},{componentName:"AgInputTextArea",componentClass:hp},{componentName:"AgInputNumberField",componentClass:Ai},{componentName:"AgInputRange",componentClass:gp},{componentName:"AgSelect",componentClass:Jr},{componentName:"AgSlider",componentClass:vp},{componentName:"AgGridBody",componentClass:_c},{componentName:"AgHeaderRoot",componentClass:du},{componentName:"AgSortIndicator",componentClass:Qi},{componentName:"AgPagination",componentClass:Gf},{componentName:"AgOverlayWrapper",componentClass:Bf},{componentName:"AgGroupComponent",componentClass:wp},{componentName:"AgPanel",componentClass:Bp},{componentName:"AgDialog",componentClass:Wp},{componentName:"AgRowContainer",componentClass:Uc},{componentName:"AgFakeHorizontalScroll",componentClass:kg},{componentName:"AgFakeVerticalScroll",componentClass:Wg}],o=this.extractModuleEntity(e,(function(e){return e.agStackComponents?e.agStackComponents:[]}));return t=t.concat(o)},e.prototype.createBeansList=function(e,t){void 0===e&&(e="clientSide");var o=t.filter((function(t){return!t.rowModel||t.rowModel===e})),n={clientSide:Q.ClientSideRowModelModule,infinite:Q.InfiniteRowModelModule,serverSide:Q.ServerSideRowModelModule,viewport:Q.ViewportRowModelModule};if(n[e]){if(ne.assertRegistered(n[e],"rowModelType = '"+e+"'")){var r=[_l,Uf,Kf,sg,df,Is,is,bf,Cf,Su,ks,Pf,hu,Vg,at,Yu,Ts,Mt,te,zg,ih,kh,Gs,Ot,ru,ap,Bu,Ih,Be,Fh,xh,Pc,hf,Th,Bh,Pt,Ou,mu,Da,Ah,Qp,Rc,Rf,mh,Wu,cp,kc,ef,nf,sf,Mf,ft,mf,ju,rg,Gt,cg,ug,np,fg,yg,Rg,Dg,xg],i=this.extractModuleEntity(o,(function(e){return e.beans?e.beans:[]}));r.push.apply(r,Kg(i));var a=[];return r.forEach((function(e){a.indexOf(e)<0&&a.push(e)})),a}}else console.error("AG Grid: could not find row model for rowModelType = "+e)},e.prototype.extractModuleEntity=function(e,t){return[].concat.apply([],Kg(e.map(t)))},e.prototype.setColumnsAndData=function(e){var t=e.gridOptionsService.get("columnDefs");e.columnModel.setColumnDefs(t||[],"gridInitializing"),e.rowModel.start()},e.prototype.dispatchGridReadyEvent=function(e){var t={type:$e.EVENT_GRID_READY};e.eventService.dispatchEvent(t)},e}(),Xg=function(){function e(){}return e.prototype.wrap=function(e,t,o,n){var r=this;void 0===o&&(o=[]);var i=this.createWrapper(e,n);return t.forEach((function(e){r.createMethod(i,e,!0)})),o.forEach((function(e){r.createMethod(i,e,!1)})),i},e.prototype.unwrap=function(e){return e},e.prototype.createMethod=function(e,t,o){e.addMethod(t,this.createMethodProxy(e,t,o))},e.prototype.createMethodProxy=function(e,t,o){return function(){return e.hasMethod(t)?e.callMethod(t,arguments):(o&&console.warn("AG Grid: Framework component is missing the method "+t+"()"),null)}},e}(),Qg={columnGroup:["column","stackedColumn","normalizedColumn"],barGroup:["bar","stackedBar","normalizedBar"],pieGroup:["pie","doughnut"],lineGroup:["line"],scatterGroup:["scatter","bubble"],areaGroup:["area","stackedArea","normalizedArea"],histogramGroup:["histogram"],combinationGroup:["columnLineCombo","areaColumnCombo","customCombo"]},Zg=["chartSettings","chartData","chartFormat"],em=["chartUnlink","chartLink","chartDownload"],tm={settings:"chartSettings",data:"chartData",format:"chartFormat"},om=0;!function(e){e.InsideBase="insideBase",e.InsideEnd="insideEnd",e.Center="center",e.OutsideEnd="outsideEnd"}(Gg||(Gg={}));var nm="undefined"===typeof o.g?{}:o.g;nm.HTMLElement="undefined"===typeof HTMLElement?{}:HTMLElement,nm.HTMLButtonElement="undefined"===typeof HTMLButtonElement?{}:HTMLButtonElement,nm.HTMLSelectElement="undefined"===typeof HTMLSelectElement?{}:HTMLSelectElement,nm.HTMLInputElement="undefined"===typeof HTMLInputElement?{}:HTMLInputElement,nm.Node="undefined"===typeof Node?{}:Node,nm.MouseEvent="undefined"===typeof MouseEvent?{}:MouseEvent;var rm,im=function(e,t){var o="function"===typeof Symbol&&e[Symbol.iterator];if(!o)return e;var n,r,i=o.call(e),a=[];try{for(;(void 0===t||t-- >0)&&!(n=i.next()).done;)a.push(n.value)}catch(s){r={error:s}}finally{try{n&&!n.done&&(o=i.return)&&o.call(i)}finally{if(r)throw r.error}}return a},am=function(){for(var e=[],t=0;t<arguments.length;t++)e=e.concat(im(arguments[t]));return e},sm=function(){function e(t,o,n,r,i,a){this.nextId=0,this.allNodesMap={},this.rootNode=t,this.gridOptionsService=o,this.eventService=n,this.columnModel=r,this.beans=a,this.selectionService=i,this.rootNode.group=!0,this.rootNode.level=-1,this.rootNode.id=e.ROOT_NODE_ID,this.rootNode.allLeafChildren=[],this.rootNode.childrenAfterGroup=[],this.rootNode.childrenAfterSort=[],this.rootNode.childrenAfterAggFilter=[],this.rootNode.childrenAfterFilter=[],this.postConstruct()}return e.prototype.postConstruct=function(){this.suppressParentsInRowNodes=this.gridOptionsService.is("suppressParentsInRowNodes"),this.isRowMasterFunc=this.gridOptionsService.get("isRowMaster"),this.doingTreeData=this.gridOptionsService.isTreeData(),this.doingMasterDetail=this.gridOptionsService.isMasterDetail()},e.prototype.getCopyOfNodesMap=function(){return tr.cloneObject(this.allNodesMap)},e.prototype.getRowNode=function(e){return this.allNodesMap[e]},e.prototype.setRowData=function(t){var o=this;if("string"!==typeof t){var n=this.rootNode,r=this.rootNode.sibling;n.childrenAfterFilter=null,n.childrenAfterGroup=null,n.childrenAfterAggFilter=null,n.childrenAfterSort=null,n.childrenMapped=null,n.updateHasChildren(),this.nextId=0,this.allNodesMap={},t?n.allLeafChildren=t.map((function(t){return o.createNode(t,o.rootNode,e.TOP_LEVEL)})):(n.allLeafChildren=[],n.childrenAfterGroup=[]),r&&(r.childrenAfterFilter=n.childrenAfterFilter,r.childrenAfterGroup=n.childrenAfterGroup,r.childrenAfterAggFilter=n.childrenAfterAggFilter,r.childrenAfterSort=n.childrenAfterSort,r.childrenMapped=n.childrenMapped,r.allLeafChildren=n.allLeafChildren)}else console.warn("AG Grid: rowData must be an array, however you passed in a string. If you are loading JSON, make sure you convert the JSON string to JavaScript objects first")},e.prototype.updateRowData=function(e,t){var o={remove:[],update:[],add:[]},n=[];return this.executeRemove(e,o,n),this.executeUpdate(e,o,n),this.executeAdd(e,o),this.updateSelection(n,"rowDataChanged"),t&&tr.sortRowNodesByOrder(this.rootNode.allLeafChildren,t),o},e.prototype.updateSelection=function(e,t){var o=e.length>0;if(o&&e.forEach((function(e){e.setSelected(!1,!1,!0,t)})),this.selectionService.updateGroupsFromChildrenSelections(t),o){var n={type:$e.EVENT_SELECTION_CHANGED,source:t};this.eventService.dispatchEvent(n)}},e.prototype.executeAdd=function(t,o){var n,r=this,i=t.add,a=t.addIndex;if(!tr.missingOrEmpty(i)){var s=i.map((function(t){return r.createNode(t,r.rootNode,e.TOP_LEVEL)}));if("number"===typeof a&&a>=0){var l=this.rootNode.allLeafChildren,c=l.length,d=a;if(this.doingTreeData&&a>0&&c>0)for(var u=0;u<c;u++)if((null===(n=l[u])||void 0===n?void 0:n.rowIndex)==a-1){d=u+1;break}var p=l.slice(0,d),h=l.slice(d,l.length);this.rootNode.allLeafChildren=am(p,s,h)}else this.rootNode.allLeafChildren=am(this.rootNode.allLeafChildren,s);this.rootNode.sibling&&(this.rootNode.sibling.allLeafChildren=this.rootNode.allLeafChildren),o.add=s}},e.prototype.executeRemove=function(e,t,o){var n=this,r=e.remove;if(!tr.missingOrEmpty(r)){var i={};r.forEach((function(e){var r=n.lookupRowNode(e);r&&(r.isSelected()&&o.push(r),r.clearRowTopAndRowIndex(),i[r.id]=!0,delete n.allNodesMap[r.id],t.remove.push(r))})),this.rootNode.allLeafChildren=this.rootNode.allLeafChildren.filter((function(e){return!i[e.id]})),this.rootNode.sibling&&(this.rootNode.sibling.allLeafChildren=this.rootNode.allLeafChildren)}},e.prototype.executeUpdate=function(t,o,n){var r=this,i=t.update;tr.missingOrEmpty(i)||i.forEach((function(t){var i=r.lookupRowNode(t);i&&(i.updateData(t),!i.selectable&&i.isSelected()&&n.push(i),r.setMasterForRow(i,t,e.TOP_LEVEL,!1),o.update.push(i))}))},e.prototype.lookupRowNode=function(e){var t,o=this.gridOptionsService.getRowIdFunc();if(o){var n=o({data:e,level:0});if(!(t=this.allNodesMap[n]))return console.error("AG Grid: could not find row id="+n+", data item was not found for this id"),null}else if(!(t=this.rootNode.allLeafChildren.find((function(t){return t.data===e}))))return console.error("AG Grid: could not find data item as object was not found",e),console.error("Consider using getRowId to help the Grid find matching row data"),null;return t||null},e.prototype.createNode=function(e,t,o){var n=new _a(this.beans);return n.group=!1,this.setMasterForRow(n,e,o,!0),t&&!this.suppressParentsInRowNodes&&(n.parent=t),n.level=o,n.setDataAndId(e,this.nextId.toString()),this.allNodesMap[n.id]&&console.warn("AG Grid: duplicate node id '"+n.id+"' detected from getRowId callback, this could cause issues in your grid."),this.allNodesMap[n.id]=n,this.nextId++,n},e.prototype.setMasterForRow=function(e,t,o,n){if(this.doingTreeData)e.setMaster(!1),n&&(e.expanded=!1);else if(this.doingMasterDetail?this.isRowMasterFunc?e.setMaster(this.isRowMasterFunc(t)):e.setMaster(!0):e.setMaster(!1),n){var r=this.columnModel.getRowGroupColumns(),i=o+(r?r.length:0);e.expanded=!!e.master&&this.isExpanded(i)}},e.prototype.isExpanded=function(e){var t=this.gridOptionsService.getNum("groupDefaultExpanded");return-1===t||e<t},e.TOP_LEVEL=0,e.ROOT_NODE_ID="ROOT_NODE_ID",e}(),lm=function(){var e=function(t,o){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])},e(t,o)};return function(t,o){function n(){this.constructor=t}e(t,o),t.prototype=null===o?Object.create(o):(n.prototype=o.prototype,new n)}}(),cm=function(e,t,o,n){var r,i=arguments.length,a=i<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,o):n;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)a=Reflect.decorate(e,t,o,n);else for(var s=e.length-1;s>=0;s--)(r=e[s])&&(a=(i<3?r(a):i>3?r(t,o,a):r(t,o))||a);return i>3&&a&&Object.defineProperty(t,o,a),a},dm=function(e,t){var o="function"===typeof Symbol&&e[Symbol.iterator];if(!o)return e;var n,r,i=o.call(e),a=[];try{for(;(void 0===t||t-- >0)&&!(n=i.next()).done;)a.push(n.value)}catch(s){r={error:s}}finally{try{n&&!n.done&&(o=i.return)&&o.call(i)}finally{if(r)throw r.error}}return a},um=function(){for(var e=[],t=0;t<arguments.length;t++)e=e.concat(dm(arguments[t]));return e};!function(e){e[e.Normal=0]="Normal",e[e.AfterFilter=1]="AfterFilter",e[e.AfterFilterAndSort=2]="AfterFilterAndSort",e[e.PivotNodes=3]="PivotNodes"}(rm||(rm={}));var pm,hm=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.onRowHeightChanged_debounced=tr.debounce(t.onRowHeightChanged.bind(t),100),t.rowsToDisplay=[],t}return lm(t,e),t.prototype.init=function(){var e=this.refreshModel.bind(this,{step:As.EVERYTHING}),t=!this.gridOptionsService.is("suppressAnimationFrame"),o=this.refreshModel.bind(this,{step:As.EVERYTHING,afterColumnsChanged:!0,keepRenderedRows:!0,animate:t});this.addManagedListener(this.eventService,$e.EVENT_NEW_COLUMNS_LOADED,o),this.addManagedListener(this.eventService,$e.EVENT_COLUMN_ROW_GROUP_CHANGED,e),this.addManagedListener(this.eventService,$e.EVENT_COLUMN_VALUE_CHANGED,this.onValueChanged.bind(this)),this.addManagedListener(this.eventService,$e.EVENT_COLUMN_PIVOT_CHANGED,this.refreshModel.bind(this,{step:As.PIVOT})),this.addManagedListener(this.eventService,$e.EVENT_FILTER_CHANGED,this.onFilterChanged.bind(this)),this.addManagedListener(this.eventService,$e.EVENT_SORT_CHANGED,this.onSortChanged.bind(this)),this.addManagedListener(this.eventService,$e.EVENT_COLUMN_PIVOT_MODE_CHANGED,e),this.addManagedListener(this.eventService,$e.EVENT_GRID_STYLES_CHANGED,this.onGridStylesChanges.bind(this));var n=this.refreshModel.bind(this,{step:As.MAP,keepRenderedRows:!0,animate:t});this.addManagedPropertyListener("groupRemoveSingleChildren",n),this.addManagedPropertyListener("groupRemoveLowestSingleChildren",n),this.rootNode=new _a(this.beans),this.nodeManager=new sm(this.rootNode,this.gridOptionsService,this.eventService,this.columnModel,this.selectionService,this.beans)},t.prototype.start=function(){var e=this.gridOptionsService.get("rowData");e&&this.setRowData(e)},t.prototype.ensureRowHeightsValid=function(e,t,o,n){var r,i=!1;do{r=!1;for(var a=this.getRowIndexAtPixel(e),s=this.getRowIndexAtPixel(t),l=Math.max(a,o),c=Math.min(s,n),d=l;d<=c;d++){var u=this.getRow(d);if(u.rowHeightEstimated){var p=this.gridOptionsService.getRowHeightForNode(u);u.setRowHeight(p.height),r=!0,i=!0}}r&&this.setRowTopAndRowIndex()}while(r);return i},t.prototype.setRowTopAndRowIndex=function(){for(var e=this.environment.getDefaultRowHeight(),t=0,o=new Set,n=this.gridOptionsService.isDomLayout("normal"),r=0;r<this.rowsToDisplay.length;r++){var i=this.rowsToDisplay[r];if(null!=i.id&&o.add(i.id),null==i.rowHeight){var a=this.gridOptionsService.getRowHeightForNode(i,n,e);i.setRowHeight(a.height,a.estimated)}i.setRowTop(t),i.setRowIndex(r),t+=i.rowHeight}return o},t.prototype.clearRowTopAndRowIndex=function(e,t){var o=e.isActive(),n=function(e){e&&null!=e.id&&!t.has(e.id)&&e.clearRowTopAndRowIndex()},r=function(e){if(n(e),n(e.detailNode),n(e.sibling),e.hasChildren()&&e.childrenAfterGroup){var t=-1==e.level;o&&!t&&!e.expanded||e.childrenAfterGroup.forEach(r)}};r(this.rootNode)},t.prototype.ensureRowsAtPixel=function(e,t,o){var n=this;void 0===o&&(o=0);var r=this.getRowIndexAtPixel(t),i=this.getRow(r),a=!this.gridOptionsService.is("suppressAnimationFrame");return i!==e[0]&&(e.forEach((function(e){tr.removeFromArray(n.rootNode.allLeafChildren,e)})),e.forEach((function(e,t){tr.insertIntoArray(n.rootNode.allLeafChildren,e,Math.max(r+o,0)+t)})),this.refreshModel({step:As.EVERYTHING,keepRenderedRows:!0,keepEditingRows:!0,animate:a}),!0)},t.prototype.highlightRowAtPixel=function(e,t){var o=null!=t?this.getRowIndexAtPixel(t):null,n=null!=o?this.getRow(o):null;if(n&&e&&n!==e&&null!=t){var r=this.getHighlightPosition(t,n);this.lastHighlightedRow&&this.lastHighlightedRow!==n&&(this.lastHighlightedRow.setHighlighted(null),this.lastHighlightedRow=null),n.setHighlighted(r),this.lastHighlightedRow=n}else this.lastHighlightedRow&&(this.lastHighlightedRow.setHighlighted(null),this.lastHighlightedRow=null)},t.prototype.getHighlightPosition=function(e,t){if(!t){var o=this.getRowIndexAtPixel(e);if(!(t=this.getRow(o||0)))return js.Below}return e-t.rowTop<t.rowHeight/2?js.Above:js.Below},t.prototype.getLastHighlightedRowNode=function(){return this.lastHighlightedRow},t.prototype.isLastRowIndexKnown=function(){return!0},t.prototype.getRowCount=function(){return this.rowsToDisplay?this.rowsToDisplay.length:0},t.prototype.getTopLevelRowCount=function(){if(this.rowsToDisplay&&this.rowsToDisplay[0]===this.rootNode)return 1;var e=this.rootNode.childrenAfterAggFilter;return e?e.length:0},t.prototype.getTopLevelRowDisplayedIndex=function(e){if(this.rowsToDisplay&&this.rowsToDisplay[0]===this.rootNode)return e;var t=this.rootNode.childrenAfterSort[e];if(this.gridOptionsService.is("groupHideOpenParents"))for(;t.expanded&&t.childrenAfterSort&&t.childrenAfterSort.length>0;)t=t.childrenAfterSort[0];return t.rowIndex},t.prototype.getRowBounds=function(e){if(tr.missing(this.rowsToDisplay))return null;var t=this.rowsToDisplay[e];return t?{rowTop:t.rowTop,rowHeight:t.rowHeight}:null},t.prototype.onRowGroupOpened=function(){var e=this.gridOptionsService.isAnimateRows();this.refreshModel({step:As.MAP,keepRenderedRows:!0,animate:e})},t.prototype.onFilterChanged=function(e){if(!e.afterDataChange){var t=this.gridOptionsService.isAnimateRows(),o=0===e.columns.length||e.columns.some((function(e){return e.isPrimary()}))?As.FILTER:As.FILTER_AGGREGATES;this.refreshModel({step:o,keepRenderedRows:!0,animate:t})}},t.prototype.onSortChanged=function(){var e=this.gridOptionsService.isAnimateRows();this.refreshModel({step:As.SORT,keepRenderedRows:!0,animate:e,keepEditingRows:!0})},t.prototype.getType=function(){return"clientSide"},t.prototype.onValueChanged=function(){this.columnModel.isPivotActive()?this.refreshModel({step:As.PIVOT}):this.refreshModel({step:As.AGGREGATE})},t.prototype.createChangePath=function(e){var t=tr.missingOrEmpty(e),o=new Xu(!1,this.rootNode);return(t||this.gridOptionsService.isTreeData())&&o.setInactive(),o},t.prototype.isSuppressModelUpdateAfterUpdateTransaction=function(e){if(!this.gridOptionsService.is("suppressModelUpdateAfterUpdateTransaction"))return!1;if(null==e.rowNodeTransactions)return!1;var t=e.rowNodeTransactions.filter((function(e){return null!=e.add&&e.add.length>0||null!=e.remove&&e.remove.length>0}));return null==t||0==t.length},t.prototype.buildRefreshModelParams=function(e){var t=As.EVERYTHING,o={everything:As.EVERYTHING,group:As.EVERYTHING,filter:As.FILTER,map:As.MAP,aggregate:As.AGGREGATE,sort:As.SORT,pivot:As.PIVOT};if(tr.exists(e)&&(t=o[e]),!tr.missing(t))return{step:t,keepRenderedRows:!0,keepEditingRows:!0,animate:!this.gridOptionsService.is("suppressAnimationFrame")};console.error("AG Grid: invalid step "+e+", available steps are "+Object.keys(o).join(", "))},t.prototype.refreshModel=function(e){var t="object"===typeof e&&"step"in e?e:this.buildRefreshModelParams(e);if(t&&!this.isSuppressModelUpdateAfterUpdateTransaction(t)){var o=this.createChangePath(t.rowNodeTransactions);switch(t.step){case As.EVERYTHING:this.doRowGrouping(t.groupState,t.rowNodeTransactions,t.rowNodeOrder,o,!!t.afterColumnsChanged);case As.FILTER:this.doFilter(o);case As.PIVOT:this.doPivot(o);case As.AGGREGATE:this.doAggregate(o);case As.FILTER_AGGREGATES:this.doFilterAggregates(o);case As.SORT:this.doSort(t.rowNodeTransactions,o);case As.MAP:this.doRowsToDisplay()}var n=this.setRowTopAndRowIndex();this.clearRowTopAndRowIndex(o,n);var r={type:$e.EVENT_MODEL_UPDATED,animate:t.animate,keepRenderedRows:t.keepRenderedRows,newData:t.newData,newPage:!1,keepUndoRedoStack:t.keepUndoRedoStack};this.eventService.dispatchEvent(r)}},t.prototype.isEmpty=function(){var e=tr.missing(this.rootNode.allLeafChildren)||0===this.rootNode.allLeafChildren.length;return tr.missing(this.rootNode)||e||!this.columnModel.isReady()},t.prototype.isRowsToRender=function(){return tr.exists(this.rowsToDisplay)&&this.rowsToDisplay.length>0},t.prototype.getNodesInRangeForSelection=function(e,t){var o,n=!t,r=!1,i=[],a=this.gridOptionsService.is("groupSelectsChildren");return this.forEachNodeAfterFilterAndSort((function(s){var l=n&&!r;if(n||s!==t&&s!==e||(n=!0),!(s.group&&a)){var c=n&&!r,d=s.isParentOfNode(o);(c||d)&&i.push(s)}l&&(s!==t&&s!==e||(r=!0,o=s===t?t:e))})),i},t.prototype.setDatasource=function(e){console.error("AG Grid: should never call setDatasource on clientSideRowController")},t.prototype.getTopLevelNodes=function(){return this.rootNode?this.rootNode.childrenAfterGroup:null},t.prototype.getRootNode=function(){return this.rootNode},t.prototype.getRow=function(e){return this.rowsToDisplay[e]},t.prototype.isRowPresent=function(e){return this.rowsToDisplay.indexOf(e)>=0},t.prototype.getRowIndexAtPixel=function(e){if(this.isEmpty()||0===this.rowsToDisplay.length)return-1;var t=0,o=this.rowsToDisplay.length-1;if(e<=0)return 0;if(tr.last(this.rowsToDisplay).rowTop<=e)return this.rowsToDisplay.length-1;for(var n=-1,r=-1;;){var i=Math.floor((t+o)/2),a=this.rowsToDisplay[i];if(this.isRowInPixel(a,e))return i;if(a.rowTop<e?t=i+1:a.rowTop>e&&(o=i-1),n===t&&r===o)return i;n=t,r=o}},t.prototype.isRowInPixel=function(e,t){var o=e.rowTop,n=e.rowTop+e.rowHeight;return o<=t&&n>t},t.prototype.forEachLeafNode=function(e){this.rootNode.allLeafChildren&&this.rootNode.allLeafChildren.forEach((function(t,o){return e(t,o)}))},t.prototype.forEachNode=function(e,t){void 0===t&&(t=!1),this.recursivelyWalkNodesAndCallback({nodes:um(this.rootNode.childrenAfterGroup||[]),callback:e,recursionType:rm.Normal,index:0,includeFooterNodes:t})},t.prototype.forEachNodeAfterFilter=function(e,t){void 0===t&&(t=!1),this.recursivelyWalkNodesAndCallback({nodes:um(this.rootNode.childrenAfterAggFilter||[]),callback:e,recursionType:rm.AfterFilter,index:0,includeFooterNodes:t})},t.prototype.forEachNodeAfterFilterAndSort=function(e,t){void 0===t&&(t=!1),this.recursivelyWalkNodesAndCallback({nodes:um(this.rootNode.childrenAfterSort||[]),callback:e,recursionType:rm.AfterFilterAndSort,index:0,includeFooterNodes:t})},t.prototype.forEachPivotNode=function(e,t){void 0===t&&(t=!1),this.recursivelyWalkNodesAndCallback({nodes:[this.rootNode],callback:e,recursionType:rm.PivotNodes,index:0,includeFooterNodes:t})},t.prototype.recursivelyWalkNodesAndCallback=function(e){var t,o=e.nodes,n=e.callback,r=e.recursionType,i=e.includeFooterNodes,a=e.index,s=o[0];i&&(null===(t=null===s||void 0===s?void 0:s.parent)||void 0===t?void 0:t.sibling)&&o.push(s.parent.sibling);for(var l=0;l<o.length;l++){var c=o[l];if(n(c,a++),c.hasChildren()&&!c.footer){var d=null;switch(r){case rm.Normal:d=c.childrenAfterGroup;break;case rm.AfterFilter:d=c.childrenAfterAggFilter;break;case rm.AfterFilterAndSort:d=c.childrenAfterSort;break;case rm.PivotNodes:d=c.leafGroup?null:c.childrenAfterSort}d&&(a=this.recursivelyWalkNodesAndCallback({nodes:um(d),callback:n,recursionType:r,index:a,includeFooterNodes:i}))}}return a},t.prototype.doAggregate=function(e){this.aggregationStage&&this.aggregationStage.execute({rowNode:this.rootNode,changedPath:e})},t.prototype.doFilterAggregates=function(e){this.filterAggregatesStage?this.filterAggregatesStage.execute({rowNode:this.rootNode,changedPath:e}):this.rootNode.childrenAfterAggFilter=this.rootNode.childrenAfterFilter},t.prototype.expandOrCollapseAll=function(e){var t=this.gridOptionsService.isTreeData(),o=this.columnModel.isPivotActive(),n=function(r){r&&r.forEach((function(r){var i=function(){r.expanded=e,n(r.childrenAfterGroup)};t?tr.exists(r.childrenAfterGroup)&&i():o?!r.leafGroup&&i():r.group&&i()}))};this.rootNode&&n(this.rootNode.childrenAfterGroup),this.refreshModel({step:As.MAP});var r=e?"expandAll":"collapseAll",i={type:$e.EVENT_EXPAND_COLLAPSE_ALL,source:r};this.eventService.dispatchEvent(i)},t.prototype.doSort=function(e,t){this.sortStage.execute({rowNode:this.rootNode,rowNodeTransactions:e,changedPath:t})},t.prototype.doRowGrouping=function(e,t,o,n,r){if(this.groupStage){if(t?this.groupStage.execute({rowNode:this.rootNode,rowNodeTransactions:t,rowNodeOrder:o,changedPath:n}):(this.groupStage.execute({rowNode:this.rootNode,changedPath:n,afterColumnsChanged:r}),this.restoreGroupState(e)),this.gridOptionsService.is("groupSelectsChildren")&&this.selectionService.updateGroupsFromChildrenSelections("rowGroupChanged",n)){var i={type:$e.EVENT_SELECTION_CHANGED,source:"rowGroupChanged"};this.eventService.dispatchEvent(i)}}else this.rootNode.childrenAfterGroup=this.rootNode.allLeafChildren,this.rootNode.sibling&&(this.rootNode.sibling.childrenAfterGroup=this.rootNode.childrenAfterGroup),this.rootNode.updateHasChildren()},t.prototype.restoreGroupState=function(e){e&&tr.traverseNodesWithKey(this.rootNode.childrenAfterGroup,(function(t,o){"boolean"===typeof e[o]&&(t.expanded=e[o])}))},t.prototype.doFilter=function(e){this.filterStage.execute({rowNode:this.rootNode,changedPath:e})},t.prototype.doPivot=function(e){this.pivotStage&&this.pivotStage.execute({rowNode:this.rootNode,changedPath:e})},t.prototype.getGroupState=function(){if(!this.rootNode.childrenAfterGroup||!this.gridOptionsService.is("rememberGroupStateWhenNewData"))return null;var e={};return tr.traverseNodesWithKey(this.rootNode.childrenAfterGroup,(function(t,o){return e[o]=t.expanded})),e},t.prototype.getCopyOfNodesMap=function(){return this.nodeManager.getCopyOfNodesMap()},t.prototype.getRowNode=function(e){if("string"==typeof e&&0==e.indexOf(_a.ID_PREFIX_ROW_GROUP)){var t=void 0;return this.forEachNode((function(o){o.id===e&&(t=o)})),t}return this.nodeManager.getRowNode(e)},t.prototype.setRowData=function(e){var t=this.getGroupState();this.nodeManager.setRowData(e),this.selectionService.reset(),this.filterManager.onNewRowsLoaded("rowDataUpdated");var o={type:$e.EVENT_ROW_DATA_UPDATED};this.eventService.dispatchEvent(o),this.refreshModel({step:As.EVERYTHING,groupState:t,newData:!0})},t.prototype.batchUpdateRowData=function(e,t){var o=this;if(null==this.applyAsyncTransactionsTimeout){this.rowDataTransactionBatch=[];var n=this.gridOptionsService.getAsyncTransactionWaitMillis();this.applyAsyncTransactionsTimeout=window.setTimeout((function(){o.executeBatchUpdateRowData()}),n)}this.rowDataTransactionBatch.push({rowDataTransaction:e,callback:t})},t.prototype.flushAsyncTransactions=function(){null!=this.applyAsyncTransactionsTimeout&&(clearTimeout(this.applyAsyncTransactionsTimeout),this.executeBatchUpdateRowData())},t.prototype.executeBatchUpdateRowData=function(){var e=this;this.valueCache.onDataChanged();var t=[],o=[],n=!1;if(this.rowDataTransactionBatch&&this.rowDataTransactionBatch.forEach((function(r){var i=e.nodeManager.updateRowData(r.rowDataTransaction,void 0);o.push(i),r.callback&&t.push(r.callback.bind(null,i)),"number"===typeof r.rowDataTransaction.addIndex&&(n=!0)})),this.commonUpdateRowData(o,void 0,n),t.length>0&&window.setTimeout((function(){t.forEach((function(e){return e()}))}),0),o.length>0){var r={type:$e.EVENT_ASYNC_TRANSACTIONS_FLUSHED,results:o};this.eventService.dispatchEvent(r)}this.rowDataTransactionBatch=null,this.applyAsyncTransactionsTimeout=void 0},t.prototype.updateRowData=function(e,t){this.valueCache.onDataChanged();var o=this.nodeManager.updateRowData(e,t),n="number"===typeof e.addIndex;return this.commonUpdateRowData([o],t,n),o},t.prototype.createRowNodeOrder=function(){if(!this.gridOptionsService.is("suppressMaintainUnsortedOrder")){var e={};if(this.rootNode&&this.rootNode.allLeafChildren)for(var t=0;t<this.rootNode.allLeafChildren.length;t++){e[this.rootNode.allLeafChildren[t].id]=t}return e}},t.prototype.commonUpdateRowData=function(e,t,o){var n=!this.gridOptionsService.is("suppressAnimationFrame");o&&(t=this.createRowNodeOrder()),this.refreshModel({step:As.EVERYTHING,rowNodeTransactions:e,rowNodeOrder:t,keepRenderedRows:!0,keepEditingRows:!0,animate:n}),this.filterManager.onNewRowsLoaded("rowDataUpdated");var r={type:$e.EVENT_ROW_DATA_UPDATED};this.eventService.dispatchEvent(r)},t.prototype.doRowsToDisplay=function(){this.rowsToDisplay=this.flattenStage.execute({rowNode:this.rootNode})},t.prototype.onRowHeightChanged=function(){this.refreshModel({step:As.MAP,keepRenderedRows:!0,keepEditingRows:!0,keepUndoRedoStack:!0})},t.prototype.onRowHeightChangedDebounced=function(){this.onRowHeightChanged_debounced()},t.prototype.resetRowHeights=function(){var e=this.resetRowHeightsForAllRowNodes();this.rootNode.setRowHeight(this.rootNode.rowHeight,!0),e&&this.onRowHeightChanged()},t.prototype.resetRowHeightsForAllRowNodes=function(){var e=!1;return this.forEachNode((function(t){t.setRowHeight(t.rowHeight,!0);var o=t.detailNode;o&&o.setRowHeight(o.rowHeight,!0),e=!0})),e},t.prototype.onGridStylesChanges=function(){this.columnModel.isAutoRowHeightActive()||this.resetRowHeights()},cm([q("columnModel")],t.prototype,"columnModel",void 0),cm([q("selectionService")],t.prototype,"selectionService",void 0),cm([q("filterManager")],t.prototype,"filterManager",void 0),cm([q("valueCache")],t.prototype,"valueCache",void 0),cm([q("beans")],t.prototype,"beans",void 0),cm([q("filterStage")],t.prototype,"filterStage",void 0),cm([q("sortStage")],t.prototype,"sortStage",void 0),cm([q("flattenStage")],t.prototype,"flattenStage",void 0),cm([K("groupStage")],t.prototype,"groupStage",void 0),cm([K("aggregationStage")],t.prototype,"aggregationStage",void 0),cm([K("pivotStage")],t.prototype,"pivotStage",void 0),cm([K("filterAggregatesStage")],t.prototype,"filterAggregatesStage",void 0),cm([$],t.prototype,"init",null),t=cm([W("rowModel")],t)}(Fe),fm=function(){var e=function(t,o){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])},e(t,o)};return function(t,o){function n(){this.constructor=t}e(t,o),t.prototype=null===o?Object.create(o):(n.prototype=o.prototype,new n)}}(),gm=function(e,t,o,n){var r,i=arguments.length,a=i<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,o):n;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)a=Reflect.decorate(e,t,o,n);else for(var s=e.length-1;s>=0;s--)(r=e[s])&&(a=(i<3?r(a):i>3?r(t,o,a):r(t,o))||a);return i>3&&a&&Object.defineProperty(t,o,a),a},mm=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return fm(t,e),t.prototype.execute=function(e){var t=e.changedPath;this.filterService.filter(t)},gm([q("filterService")],t.prototype,"filterService",void 0),t=gm([W("filterStage")],t)}(Fe),ym=function(){var e=function(t,o){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])},e(t,o)};return function(t,o){function n(){this.constructor=t}e(t,o),t.prototype=null===o?Object.create(o):(n.prototype=o.prototype,new n)}}(),vm=function(e,t,o,n){var r,i=arguments.length,a=i<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,o):n;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)a=Reflect.decorate(e,t,o,n);else for(var s=e.length-1;s>=0;s--)(r=e[s])&&(a=(i<3?r(a):i>3?r(t,o,a):r(t,o))||a);return i>3&&a&&Object.defineProperty(t,o,a),a},bm=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return ym(t,e),t.prototype.execute=function(e){var t=this,o=this.sortController.getSortOptions(),n=tr.exists(o)&&o.length>0,r=n&&tr.exists(e.rowNodeTransactions)&&this.gridOptionsService.is("deltaSort"),i=o.some((function(e){return!!t.columnModel.getGroupDisplayColumnForGroup(e.column.getId())}));this.sortService.sort(o,n,r,e.rowNodeTransactions,e.changedPath,i)},vm([q("sortService")],t.prototype,"sortService",void 0),vm([q("sortController")],t.prototype,"sortController",void 0),vm([q("columnModel")],t.prototype,"columnModel",void 0),t=vm([W("sortStage")],t)}(Fe),xm=function(){var e=function(t,o){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])},e(t,o)};return function(t,o){function n(){this.constructor=t}e(t,o),t.prototype=null===o?Object.create(o):(n.prototype=o.prototype,new n)}}(),wm=function(e,t,o,n){var r,i=arguments.length,a=i<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,o):n;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)a=Reflect.decorate(e,t,o,n);else for(var s=e.length-1;s>=0;s--)(r=e[s])&&(a=(i<3?r(a):i>3?r(t,o,a):r(t,o))||a);return i>3&&a&&Object.defineProperty(t,o,a),a},Cm=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return xm(t,e),t.prototype.execute=function(e){var t=e.rowNode,o=[],n={value:0},r=this.columnModel.isPivotMode(),i=r&&t.leafGroup,a=i?[t]:t.childrenAfterSort;return this.recursivelyAddToRowsToDisplay(a,o,n,r,0),!i&&o.length>0&&this.gridOptionsService.is("groupIncludeTotalFooter")&&(t.createFooter(),this.addRowNodeToRowsToDisplay(t.sibling,o,n,0)),o},t.prototype.recursivelyAddToRowsToDisplay=function(e,t,o,n,r){if(!tr.missingOrEmpty(e))for(var i=this.gridOptionsService.is("groupHideOpenParents"),a=this.gridOptionsService.is("groupRemoveSingleChildren"),s=!a&&this.gridOptionsService.is("groupRemoveLowestSingleChildren"),l=0;l<e.length;l++){var c=e[l],d=c.hasChildren(),u=n&&!d,p=a&&d&&1===c.childrenAfterGroup.length,h=s&&d&&c.leafGroup&&1===c.childrenAfterGroup.length,f=n&&c.leafGroup,g=i&&c.expanded&&!c.master&&!f;if(!u&&!g&&!p&&!h&&this.addRowNodeToRowsToDisplay(c,t,o,r),!n||!c.leafGroup)if(d){var m=p||h;if(c.expanded||m){var y=m?r:r+1;this.recursivelyAddToRowsToDisplay(c.childrenAfterSort,t,o,n,y),this.gridOptionsService.is("groupIncludeFooter")&&this.addRowNodeToRowsToDisplay(c.sibling,t,o,r)}}else if(c.master&&c.expanded){var v=this.createDetailNode(c);this.addRowNodeToRowsToDisplay(v,t,o,r)}}},t.prototype.addRowNodeToRowsToDisplay=function(e,t,o,n){var r=this.gridOptionsService.isGroupMultiAutoColumn();t.push(e),e.setUiLevel(r?0:n)},t.prototype.createDetailNode=function(e){if(tr.exists(e.detailNode))return e.detailNode;var t=new _a(this.beans);return t.detail=!0,t.selectable=!1,t.parent=e,tr.exists(e.id)&&(t.id="detail_"+e.id),t.data=e.data,t.level=e.level+1,e.detailNode=t,t},wm([q("columnModel")],t.prototype,"columnModel",void 0),wm([q("beans")],t.prototype,"beans",void 0),t=wm([W("flattenStage")],t)}(Fe),_m=function(){var e=function(t,o){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])},e(t,o)};return function(t,o){function n(){this.constructor=t}e(t,o),t.prototype=null===o?Object.create(o):(n.prototype=o.prototype,new n)}}(),Sm=function(e,t,o,n){var r,i=arguments.length,a=i<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,o):n;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)a=Reflect.decorate(e,t,o,n);else for(var s=e.length-1;s>=0;s--)(r=e[s])&&(a=(i<3?r(a):i>3?r(t,o,a):r(t,o))||a);return i>3&&a&&Object.defineProperty(t,o,a),a},Em=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return _m(t,e),t.prototype.init=function(){this.postSortFunc=this.getPostSortFunc()},t.prototype.sort=function(e,t,o,n,r,i){var a=this,s=this.gridOptionsService.is("groupMaintainOrder"),l=this.columnModel.getAllGridColumns().some((function(e){return e.isRowGroupActive()})),c={};o&&n&&(c=this.calculateDirtyNodes(n));var d=this.columnModel.isPivotMode();r&&r.forEachChangedNodeDepthFirst((function(n){a.pullDownGroupDataForHideOpenParents(n.childrenAfterAggFilter,!0);var u=d&&n.leafGroup;if(s&&l&&!n.leafGroup&&!i){var p=n.childrenAfterAggFilter.slice(0);if(n.childrenAfterSort){var h={};n.childrenAfterSort.forEach((function(e,t){h[e.id]=t})),p.sort((function(e,t){var o,n;return(null!==(o=h[e.id])&&void 0!==o?o:0)-(null!==(n=h[t.id])&&void 0!==n?n:0)}))}n.childrenAfterSort=p}else n.childrenAfterSort=!t||u?n.childrenAfterAggFilter.slice(0):o?a.doDeltaSort(n,c,r,e):a.rowNodeSorter.doFullSort(n.childrenAfterAggFilter,e);if(n.sibling&&(n.sibling.childrenAfterSort=n.childrenAfterSort),a.updateChildIndexes(n),a.postSortFunc){var f={nodes:n.childrenAfterSort};a.postSortFunc(f)}})),this.updateGroupDataForHideOpenParents(r)},t.prototype.getPostSortFunc=function(){var e=this.gridOptionsService.getCallback("postSortRows");if(e)return e;var t=this.gridOptionsService.get("postSort");return t?function(e){return t(e.nodes)}:void 0},t.prototype.calculateDirtyNodes=function(e){var t={},o=function(e){e&&e.forEach((function(e){return t[e.id]=!0}))};return e&&e.forEach((function(e){o(e.add),o(e.update),o(e.remove)})),t},t.prototype.doDeltaSort=function(e,t,o,n){var r=this,i=e.childrenAfterAggFilter,a=e.childrenAfterSort;if(!a)return this.rowNodeSorter.doFullSort(i,n);var s={},l=[];i.forEach((function(e){t[e.id]||!o.canSkip(e)?l.push(e):s[e.id]=!0}));var c=a.filter((function(e){return s[e.id]})),d=function(e,t){return{currentPos:t,rowNode:e}},u=l.map(d).sort((function(e,t){return r.rowNodeSorter.compareRowNodes(n,e,t)}));return this.mergeSortedArrays(n,u,c.map(d)).map((function(e){return e.rowNode}))},t.prototype.mergeSortedArrays=function(e,t,o){for(var n=[],r=0,i=0;r<t.length&&i<o.length;){this.rowNodeSorter.compareRowNodes(e,t[r],o[i])<0?n.push(t[r++]):n.push(o[i++])}for(;r<t.length;)n.push(t[r++]);for(;i<o.length;)n.push(o[i++]);return n},t.prototype.updateChildIndexes=function(e){if(!tr.missing(e.childrenAfterSort))for(var t=e.childrenAfterSort,o=0;o<t.length;o++){var n=t[o],r=0===o,i=o===e.childrenAfterSort.length-1;n.setFirstChild(r),n.setLastChild(i),n.setChildIndex(o)}},t.prototype.updateGroupDataForHideOpenParents=function(e){var t=this;if(this.gridOptionsService.is("groupHideOpenParents")){if(this.gridOptionsService.isTreeData()){return tr.doOnce((function(){return console.warn("AG Grid: The property hideOpenParents dose not work with Tree Data. This is because Tree Data has values at the group level, it doesn't make sense to hide them (as opposed to Row Grouping, which only has Aggregated Values at the group level).")}),"sortService.hideOpenParentsWithTreeData"),!1}var o=function(e){t.pullDownGroupDataForHideOpenParents(e.childrenAfterSort,!1),e.childrenAfterSort.forEach((function(e){e.hasChildren()&&o(e)}))};e&&e.executeFromRootNode((function(e){return o(e)}))}},t.prototype.pullDownGroupDataForHideOpenParents=function(e,t){var o=this;this.gridOptionsService.is("groupHideOpenParents")&&!tr.missing(e)&&e.forEach((function(e){o.columnModel.getGroupDisplayColumns().forEach((function(n){var r=n.getColDef().showRowGroup;if("string"===typeof r){var i=r,a=o.columnModel.getPrimaryColumn(i);if(!(a===e.rowGroupColumn))if(t)e.setGroupValue(n.getId(),void 0);else{var s=e.getFirstChildOfFirstChild(a);s&&e.setGroupValue(n.getId(),s.key)}}else console.error("AG Grid: groupHideOpenParents only works when specifying specific columns for colDef.showRowGroup")}))}))},Sm([q("columnModel")],t.prototype,"columnModel",void 0),Sm([q("rowNodeSorter")],t.prototype,"rowNodeSorter",void 0),Sm([$],t.prototype,"init",null),t=Sm([W("sortService")],t)}(Fe),km=function(){var e=function(t,o){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])},e(t,o)};return function(t,o){function n(){this.constructor=t}e(t,o),t.prototype=null===o?Object.create(o):(n.prototype=o.prototype,new n)}}(),jm=function(e,t,o,n){var r,i=arguments.length,a=i<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,o):n;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)a=Reflect.decorate(e,t,o,n);else for(var s=e.length-1;s>=0;s--)(r=e[s])&&(a=(i<3?r(a):i>3?r(t,o,a):r(t,o))||a);return i>3&&a&&Object.defineProperty(t,o,a),a},Am=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return km(t,e),t.prototype.filter=function(e){var t=this.filterManager.isColumnFilterPresent()||this.filterManager.isQuickFilterPresent()||this.filterManager.isExternalFilterPresent();this.filterNodes(t,e)},t.prototype.filterNodes=function(e,t){var o=this,n=function(t,n){t.hasChildren()?t.childrenAfterFilter=e&&!n?t.childrenAfterGroup.filter((function(e){var t=e.childrenAfterFilter&&e.childrenAfterFilter.length>0,n=e.data&&o.filterManager.doesRowPassFilter({rowNode:e});return t||n})):t.childrenAfterGroup:t.childrenAfterFilter=t.childrenAfterGroup,t.sibling&&(t.sibling.childrenAfterFilter=t.childrenAfterFilter)};if(this.doingTreeDataFiltering()){var r=function(e,t){if(e.childrenAfterGroup)for(var i=0;i<e.childrenAfterGroup.length;i++){var a=e.childrenAfterGroup[i],s=t||o.filterManager.doesRowPassFilter({rowNode:a});a.childrenAfterGroup?r(e.childrenAfterGroup[i],s):n(a,s)}n(e,t)};t.executeFromRootNode((function(e){return r(e,!1)}))}else{t.forEachChangedNodeDepthFirst((function(e){return n(e,!1)}),!0)}},t.prototype.doingTreeDataFiltering=function(){return this.gridOptionsService.isTreeData()&&!this.gridOptionsService.is("excludeChildrenWhenTreeDataFiltering")},jm([q("filterManager")],t.prototype,"filterManager",void 0),t=jm([W("filterService")],t)}(Fe),Rm=function(){var e=function(t,o){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])},e(t,o)};return function(t,o){function n(){this.constructor=t}e(t,o),t.prototype=null===o?Object.create(o):(n.prototype=o.prototype,new n)}}(),Om=function(e,t,o,n){var r,i=arguments.length,a=i<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,o):n;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)a=Reflect.decorate(e,t,o,n);else for(var s=e.length-1;s>=0;s--)(r=e[s])&&(a=(i<3?r(a):i>3?r(t,o,a):r(t,o))||a);return i>3&&a&&Object.defineProperty(t,o,a),a},Tm=function(e,t){var o="function"===typeof Symbol&&e[Symbol.iterator];if(!o)return e;var n,r,i=o.call(e),a=[];try{for(;(void 0===t||t-- >0)&&!(n=i.next()).done;)a.push(n.value)}catch(s){r={error:s}}finally{try{n&&!n.done&&(o=i.return)&&o.call(i)}finally{if(r)throw r.error}}return a},Dm=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Rm(t,e),t.prototype.postConstruct=function(){"clientSide"===this.rowModel.getType()&&(this.clientSideRowModel=this.rowModel)},t.prototype.isActive=function(){var e=this.gridOptionsService.exists("getRowId"),t=this.gridOptionsService.is("immutableData");return!this.gridOptionsService.is("resetRowDataOnUpdate")&&(e||t)},t.prototype.setRowData=function(e){var t=this.createTransactionForRowData(e);if(t){var o=Tm(t,2),n=o[0],r=o[1];this.clientSideRowModel.updateRowData(n,r)}},t.prototype.createTransactionForRowData=function(e){if(tr.missing(this.clientSideRowModel))console.error("AG Grid: ImmutableService only works with ClientSideRowModel");else{var t=this.gridOptionsService.getRowIdFunc();if(null!=t){var o={remove:[],update:[],add:[]},n=this.clientSideRowModel.getCopyOfNodesMap(),r=this.gridOptionsService.is("suppressMaintainUnsortedOrder")?void 0:{};return tr.exists(e)&&e.forEach((function(e,i){var a=t({data:e,level:0}),s=n[a];(r&&(r[a]=i),s)?(s.data!==e&&o.update.push(e),n[a]=void 0):o.add.push(e)})),tr.iterateObject(n,(function(e,t){t&&o.remove.push(t.data)})),[o,r]}console.error("AG Grid: ImmutableService requires getRowId() callback to be implemented, your row data needs IDs!")}},Om([q("rowModel")],t.prototype,"rowModel",void 0),Om([q("rowRenderer")],t.prototype,"rowRenderer",void 0),Om([$],t.prototype,"postConstruct",null),t=Om([W("immutableService")],t)}(Fe),Pm={version:"29.3.5",moduleName:Q.ClientSideRowModelModule,rowModel:"clientSide",beans:[hm,mm,bm,Cm,Em,Am,Dm]},Nm=function(){var e=function(t,o){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])},e(t,o)};return function(t,o){function n(){this.constructor=t}e(t,o),t.prototype=null===o?Object.create(o):(n.prototype=o.prototype,new n)}}(),Im=function(e,t,o,n){var r,i=arguments.length,a=i<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,o):n;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)a=Reflect.decorate(e,t,o,n);else for(var s=e.length-1;s>=0;s--)(r=e[s])&&(a=(i<3?r(a):i>3?r(t,o,a):r(t,o))||a);return i>3&&a&&Object.defineProperty(t,o,a),a},Mm=function(e){function t(t,o,n){var r=e.call(this,t)||this;return r.parentCache=o,r.params=n,r.startRow=t*n.blockSize,r.endRow=r.startRow+n.blockSize,r}return Nm(t,e),t.prototype.postConstruct=function(){this.createRowNodes()},t.prototype.getBlockStateJson=function(){return{id:""+this.getId(),state:{blockNumber:this.getId(),startRow:this.getStartRow(),endRow:this.getEndRow(),pageStatus:this.getState()}}},t.prototype.setDataAndId=function(e,t,o){!e.id&&e.alreadyRendered&&(e.alreadyRendered=!1),tr.exists(t)?e.setDataAndId(t,o.toString()):e.setDataAndId(void 0,void 0)},t.prototype.loadFromDatasource=function(){var e=this,t=this.createLoadParams();tr.missing(this.params.datasource.getRows)?console.warn("AG Grid: datasource is missing getRows method"):window.setTimeout((function(){e.params.datasource.getRows(t)}),0)},t.prototype.processServerFail=function(){},t.prototype.createLoadParams=function(){return{startRow:this.getStartRow(),endRow:this.getEndRow(),successCallback:this.pageLoaded.bind(this,this.getVersion()),failCallback:this.pageLoadFailed.bind(this,this.getVersion()),sortModel:this.params.sortModel,filterModel:this.params.filterModel,context:this.gridOptionsService.context}},t.prototype.forEachNode=function(e,t,o){var n=this;this.rowNodes.forEach((function(r,i){n.startRow+i<o&&e(r,t.next())}))},t.prototype.getLastAccessed=function(){return this.lastAccessed},t.prototype.getRow=function(e,t){void 0===t&&(t=!1),t||(this.lastAccessed=this.params.lastAccessedSequence.next());var o=e-this.startRow;return this.rowNodes[o]},t.prototype.getStartRow=function(){return this.startRow},t.prototype.getEndRow=function(){return this.endRow},t.prototype.createRowNodes=function(){this.rowNodes=[];for(var e=0;e<this.params.blockSize;e++){var t=this.startRow+e,o=new _a(this.beans);o.setRowHeight(this.params.rowHeight),o.uiLevel=0,o.setRowIndex(t),o.setRowTop(this.params.rowHeight*t),this.rowNodes.push(o)}},t.prototype.processServerResult=function(e){var t=this;this.rowNodes.forEach((function(o,n){var r=e.rowData?e.rowData[n]:void 0;t.setDataAndId(o,r,t.startRow+n)}));var o=null!=e.rowCount&&e.rowCount>=0?e.rowCount:void 0;this.parentCache.pageLoaded(this,o)},t.prototype.destroyRowNodes=function(){this.rowNodes.forEach((function(e){e.clearRowTopAndRowIndex()}))},Im([q("beans")],t.prototype,"beans",void 0),Im([$],t.prototype,"postConstruct",null),Im([U],t.prototype,"destroyRowNodes",null),t}(Zu),Lm=function(){var e=function(t,o){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])},e(t,o)};return function(t,o){function n(){this.constructor=t}e(t,o),t.prototype=null===o?Object.create(o):(n.prototype=o.prototype,new n)}}(),Fm=function(e,t,o,n){var r,i=arguments.length,a=i<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,o):n;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)a=Reflect.decorate(e,t,o,n);else for(var s=e.length-1;s>=0;s--)(r=e[s])&&(a=(i<3?r(a):i>3?r(t,o,a):r(t,o))||a);return i>3&&a&&Object.defineProperty(t,o,a),a},Gm=function(e,t){return function(o,n){t(o,n,e)}},zm=function(e){function t(t){var o=e.call(this)||this;return o.lastRowIndexKnown=!1,o.blocks={},o.blockCount=0,o.rowCount=t.initialRowCount,o.params=t,o}return Lm(t,e),t.prototype.setBeans=function(e){this.logger=e.create("InfiniteCache")},t.prototype.getRow=function(e,t){void 0===t&&(t=!1);var o=Math.floor(e/this.params.blockSize),n=this.blocks[o];if(!n){if(t)return;n=this.createBlock(o)}return n.getRow(e)},t.prototype.createBlock=function(e){var t=this.createBean(new Mm(e,this,this.params));return this.blocks[t.getId()]=t,this.blockCount++,this.purgeBlocksIfNeeded(t),this.params.rowNodeBlockLoader.addBlock(t),t},t.prototype.refreshCache=function(){0==this.blockCount?this.purgeCache():(this.getBlocksInOrder().forEach((function(e){return e.setStateWaitingToLoad()})),this.params.rowNodeBlockLoader.checkBlockToLoad())},t.prototype.destroyAllBlocks=function(){var e=this;this.getBlocksInOrder().forEach((function(t){return e.destroyBlock(t)}))},t.prototype.getRowCount=function(){return this.rowCount},t.prototype.isLastRowIndexKnown=function(){return this.lastRowIndexKnown},t.prototype.pageLoaded=function(e,t){this.isAlive()&&(this.logger.log("onPageLoaded: page = "+e.getId()+", lastRow = "+t),this.checkRowCount(e,t),this.onCacheUpdated())},t.prototype.purgeBlocksIfNeeded=function(e){var o=this,n=this.getBlocksInOrder().filter((function(t){return t!=e}));n.sort((function(e,t){return t.getLastAccessed()-e.getLastAccessed()}));var r=this.params.maxBlocksInCache>0,i=r?this.params.maxBlocksInCache-1:null,a=t.MAX_EMPTY_BLOCKS_TO_KEEP-1;n.forEach((function(e,t){if(e.getState()===Mm.STATE_WAITING_TO_LOAD&&t>=a||!!r&&t>=i){if(o.isBlockCurrentlyDisplayed(e))return;if(o.isBlockFocused(e))return;o.removeBlockFromCache(e)}}))},t.prototype.isBlockFocused=function(e){var t=this.focusService.getFocusCellToUseAfterRefresh();if(!t)return!1;if(null!=t.rowPinned)return!1;var o=e.getStartRow(),n=e.getEndRow();return t.rowIndex>=o&&t.rowIndex<n},t.prototype.isBlockCurrentlyDisplayed=function(e){var t=e.getStartRow(),o=e.getEndRow()-1;return this.rowRenderer.isRangeInRenderedViewport(t,o)},t.prototype.removeBlockFromCache=function(e){e&&this.destroyBlock(e)},t.prototype.checkRowCount=function(e,t){if("number"===typeof t&&t>=0)this.rowCount=t,this.lastRowIndexKnown=!0;else if(!this.lastRowIndexKnown){var o=(e.getId()+1)*this.params.blockSize+this.params.overflowSize;this.rowCount<o&&(this.rowCount=o)}},t.prototype.setRowCount=function(e,t){this.rowCount=e,tr.exists(t)&&(this.lastRowIndexKnown=t),this.lastRowIndexKnown||this.rowCount%this.params.blockSize===0&&this.rowCount++,this.onCacheUpdated()},t.prototype.forEachNodeDeep=function(e){var t=this,o=new or;this.getBlocksInOrder().forEach((function(n){return n.forEachNode(e,o,t.rowCount)}))},t.prototype.getBlocksInOrder=function(){return tr.getAllValuesInObject(this.blocks).sort((function(e,t){return e.getId()-t.getId()}))},t.prototype.destroyBlock=function(e){delete this.blocks[e.getId()],this.destroyBean(e),this.blockCount--,this.params.rowNodeBlockLoader.removeBlock(e)},t.prototype.onCacheUpdated=function(){if(this.isAlive()){this.destroyAllBlocksPastVirtualRowCount();var e={type:$e.EVENT_STORE_UPDATED};this.eventService.dispatchEvent(e)}},t.prototype.destroyAllBlocksPastVirtualRowCount=function(){var e=this,t=[];this.getBlocksInOrder().forEach((function(o){o.getId()*e.params.blockSize>=e.rowCount&&t.push(o)})),t.length>0&&t.forEach((function(t){return e.destroyBlock(t)}))},t.prototype.purgeCache=function(){var e=this;this.getBlocksInOrder().forEach((function(t){return e.removeBlockFromCache(t)})),this.lastRowIndexKnown=!1,0===this.rowCount&&(this.rowCount=this.params.initialRowCount),this.onCacheUpdated()},t.prototype.getRowNodesInRange=function(e,t){var o=this,n=[],r=-1,i=!1,a=new or;tr.missing(e)&&(i=!0);var s=!1;return this.getBlocksInOrder().forEach((function(l){s||(i&&r+1!==l.getId()?s=!0:(r=l.getId(),l.forEachNode((function(o){var r=o===e||o===t;(i||r)&&n.push(o),r&&(i=!i)}),a,o.rowCount)))})),s||i?[]:n},t.MAX_EMPTY_BLOCKS_TO_KEEP=2,Fm([q("rowRenderer")],t.prototype,"rowRenderer",void 0),Fm([q("focusService")],t.prototype,"focusService",void 0),Fm([Gm(0,J("loggerFactory"))],t.prototype,"setBeans",null),Fm([U],t.prototype,"destroyAllBlocks",null),t}(Fe),Hm=function(){var e=function(t,o){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])},e(t,o)};return function(t,o){function n(){this.constructor=t}e(t,o),t.prototype=null===o?Object.create(o):(n.prototype=o.prototype,new n)}}(),Bm=function(e,t,o,n){var r,i=arguments.length,a=i<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,o):n;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)a=Reflect.decorate(e,t,o,n);else for(var s=e.length-1;s>=0;s--)(r=e[s])&&(a=(i<3?r(a):i>3?r(t,o,a):r(t,o))||a);return i>3&&a&&Object.defineProperty(t,o,a),a},Vm=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Hm(t,e),t.prototype.getRowBounds=function(e){return{rowHeight:this.rowHeight,rowTop:this.rowHeight*e}},t.prototype.ensureRowHeightsValid=function(e,t,o,n){return!1},t.prototype.init=function(){var e=this;this.gridOptionsService.isRowModelType("infinite")&&(this.rowHeight=this.gridOptionsService.getRowHeightAsNumber(),this.addEventListeners(),this.addDestroyFunc((function(){return e.destroyCache()})),this.verifyProps())},t.prototype.verifyProps=function(){if(this.gridOptionsService.exists("initialGroupOrderComparator")||this.gridOptionsService.exists("defaultGroupOrderComparator")){tr.doOnce((function(){return console.warn("AG Grid: initialGroupOrderComparator cannot be used with Infinite Row Model. If using Infinite Row Model, then sorting is done on the server side, nothing to do with the client.")}),"IRM.InitialGroupOrderComparator")}},t.prototype.start=function(){this.setDatasource(this.gridOptionsService.get("datasource"))},t.prototype.destroyDatasource=function(){this.datasource&&(this.getContext().destroyBean(this.datasource),this.rowRenderer.datasourceChanged(),this.datasource=null)},t.prototype.addEventListeners=function(){this.addManagedListener(this.eventService,$e.EVENT_FILTER_CHANGED,this.onFilterChanged.bind(this)),this.addManagedListener(this.eventService,$e.EVENT_SORT_CHANGED,this.onSortChanged.bind(this)),this.addManagedListener(this.eventService,$e.EVENT_NEW_COLUMNS_LOADED,this.onColumnEverything.bind(this)),this.addManagedListener(this.eventService,$e.EVENT_STORE_UPDATED,this.onCacheUpdated.bind(this))},t.prototype.onFilterChanged=function(){this.reset()},t.prototype.onSortChanged=function(){this.reset()},t.prototype.onColumnEverything=function(){(!this.cacheParams||this.isSortModelDifferent())&&this.reset()},t.prototype.isSortModelDifferent=function(){return!tr.jsonEquals(this.cacheParams.sortModel,this.sortController.getSortModel())},t.prototype.getType=function(){return"infinite"},t.prototype.setDatasource=function(e){this.destroyDatasource(),this.datasource=e,e&&this.reset()},t.prototype.isEmpty=function(){return!this.infiniteCache},t.prototype.isRowsToRender=function(){return!!this.infiniteCache},t.prototype.getNodesInRangeForSelection=function(e,t){return this.infiniteCache?this.infiniteCache.getRowNodesInRange(e,t):[]},t.prototype.reset=function(){if(this.datasource){null!=this.gridOptionsService.getRowIdFunc()||this.selectionService.reset(),this.resetCache();var e=this.createModelUpdatedEvent();this.eventService.dispatchEvent(e)}},t.prototype.createModelUpdatedEvent=function(){return{type:$e.EVENT_MODEL_UPDATED,newPage:!1,newData:!1,keepRenderedRows:!0,animate:!1}},t.prototype.resetCache=function(){this.destroyCache(),this.cacheParams={datasource:this.datasource,filterModel:this.filterManager.getFilterModel(),sortModel:this.sortController.getSortModel(),rowNodeBlockLoader:this.rowNodeBlockLoader,initialRowCount:this.defaultIfInvalid(this.gridOptionsService.getNum("infiniteInitialRowCount"),1),maxBlocksInCache:this.gridOptionsService.getNum("maxBlocksInCache"),rowHeight:this.gridOptionsService.getRowHeightAsNumber(),overflowSize:this.defaultIfInvalid(this.gridOptionsService.getNum("cacheOverflowSize"),1),blockSize:this.defaultIfInvalid(this.gridOptionsService.getNum("cacheBlockSize"),100),lastAccessedSequence:new or},this.infiniteCache=this.createBean(new zm(this.cacheParams))},t.prototype.defaultIfInvalid=function(e,t){return e>0?e:t},t.prototype.destroyCache=function(){this.infiniteCache&&(this.infiniteCache=this.destroyBean(this.infiniteCache))},t.prototype.onCacheUpdated=function(){var e=this.createModelUpdatedEvent();this.eventService.dispatchEvent(e)},t.prototype.getRow=function(e){if(this.infiniteCache&&!(e>=this.infiniteCache.getRowCount()))return this.infiniteCache.getRow(e)},t.prototype.getRowNode=function(e){var t;return this.forEachNode((function(o){o.id===e&&(t=o)})),t},t.prototype.forEachNode=function(e){this.infiniteCache&&this.infiniteCache.forEachNodeDeep(e)},t.prototype.getTopLevelRowCount=function(){return this.getRowCount()},t.prototype.getTopLevelRowDisplayedIndex=function(e){return e},t.prototype.getRowIndexAtPixel=function(e){if(0!==this.rowHeight){var t=Math.floor(e/this.rowHeight),o=this.getRowCount()-1;return t>o?o:t}return 0},t.prototype.getRowCount=function(){return this.infiniteCache?this.infiniteCache.getRowCount():0},t.prototype.isRowPresent=function(e){return!!this.getRowNode(e.id)},t.prototype.refreshCache=function(){this.infiniteCache&&this.infiniteCache.refreshCache()},t.prototype.purgeCache=function(){this.infiniteCache&&this.infiniteCache.purgeCache()},t.prototype.isLastRowIndexKnown=function(){return!!this.infiniteCache&&this.infiniteCache.isLastRowIndexKnown()},t.prototype.setRowCount=function(e,t){this.infiniteCache&&this.infiniteCache.setRowCount(e,t)},Bm([q("filterManager")],t.prototype,"filterManager",void 0),Bm([q("sortController")],t.prototype,"sortController",void 0),Bm([q("selectionService")],t.prototype,"selectionService",void 0),Bm([q("rowRenderer")],t.prototype,"rowRenderer",void 0),Bm([q("rowNodeBlockLoader")],t.prototype,"rowNodeBlockLoader",void 0),Bm([$],t.prototype,"init",null),Bm([U],t.prototype,"destroyDatasource",null),t=Bm([W("rowModel")],t)}(Fe),$m={version:"29.3.5",moduleName:Q.InfiniteRowModelModule,rowModel:"infinite",beans:[Vm]},Um=function(){function e(){}return e.prototype.setBeans=function(e){this.beans=e},e.prototype.getFileName=function(e){var t=this.getDefaultFileExtension();return null!=e&&e.length||(e=this.getDefaultFileName()),-1===e.indexOf(".")?e+"."+t:e},e.prototype.getData=function(e){var t=this.createSerializingSession(e);return this.beans.gridSerializer.serialize(t,e)},e}(),Wm=function(){function e(e){this.groupColumns=[];var t=e.columnModel,o=e.valueService,n=e.gridOptionsService,r=e.processCellCallback,i=e.processHeaderCallback,a=e.processGroupHeaderCallback,s=e.processRowGroupCallback;this.columnModel=t,this.valueService=o,this.gridOptionsService=n,this.processCellCallback=r,this.processHeaderCallback=i,this.processGroupHeaderCallback=a,this.processRowGroupCallback=s}return e.prototype.prepare=function(e){this.groupColumns=e.filter((function(e){return!!e.getColDef().showRowGroup}))},e.prototype.extractHeaderValue=function(e){var t=this.getHeaderName(this.processHeaderCallback,e);return null!=t?t:""},e.prototype.extractRowCellValue=function(e,t,o,n,r){var i=this.gridOptionsService.is("groupHideOpenParents")&&!r.footer||!this.shouldRenderGroupSummaryCell(r,e,t)?this.valueService.getValue(e,r):this.createValueForGroupNode(r),a=this.processCell({accumulatedRowIndex:o,rowNode:r,column:e,value:i,processCellCallback:this.processCellCallback,type:n});return null!=a?a:""},e.prototype.shouldRenderGroupSummaryCell=function(e,t,o){var n;if(!(e&&e.group))return!1;if(-1!==this.groupColumns.indexOf(t)){if(null===(n=e.groupData)||void 0===n?void 0:n[t.getId()])return!0;if(e.footer&&-1===e.level){var r=t.getColDef();return null==r||!0===r.showRowGroup||r.showRowGroup===this.columnModel.getRowGroupColumns()[0].getId()}}var i=this.gridOptionsService.isGroupUseEntireRow(this.columnModel.isPivotMode());return 0===o&&i},e.prototype.getHeaderName=function(e,t){return e?e({column:t,api:this.gridOptionsService.api,columnApi:this.gridOptionsService.columnApi,context:this.gridOptionsService.context}):this.columnModel.getDisplayNameForColumn(t,"csv",!0)},e.prototype.createValueForGroupNode=function(e){if(this.processRowGroupCallback)return this.processRowGroupCallback({node:e,api:this.gridOptionsService.api,columnApi:this.gridOptionsService.columnApi,context:this.gridOptionsService.context});var t=e.footer,o=[e.key];if(!this.gridOptionsService.isGroupMultiAutoColumn())for(;e.parent;)e=e.parent,o.push(e.key);var n=o.reverse().join(" -> ");return t?"Total "+n:n},e.prototype.processCell=function(e){var t=e.accumulatedRowIndex,o=e.rowNode,n=e.column,r=e.value,i=e.processCellCallback,a=e.type;return i?i({accumulatedRowIndex:t,column:n,node:o,value:r,api:this.gridOptionsService.api,columnApi:this.gridOptionsService.columnApi,context:this.gridOptionsService.context,type:a}):null!=r?r:""},e}(),qm=function(){function e(){}return e.download=function(e,t){var o=document.defaultView||window;if(o){var n=document.createElement("a"),r=o.URL.createObjectURL(t);n.setAttribute("href",r),n.setAttribute("download",e),n.style.display="none",document.body.appendChild(n),n.dispatchEvent(new MouseEvent("click",{bubbles:!1,cancelable:!0,view:o})),document.body.removeChild(n),o.setTimeout((function(){o.URL.revokeObjectURL(r)}),0)}else console.warn("AG Grid: There is no `window` associated with the current `document`")},e}(),Km=function(){var e=function(t,o){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])},e(t,o)};return function(t,o){function n(){this.constructor=t}e(t,o),t.prototype=null===o?Object.create(o):(n.prototype=o.prototype,new n)}}(),Ym=function(e){function t(t){var o=e.call(this,t)||this;o.isFirstLine=!0,o.result="";var n=t.suppressQuotes,r=t.columnSeparator;return o.suppressQuotes=n,o.columnSeparator=r,o}return Km(t,e),t.prototype.addCustomContent=function(e){var t=this;e&&("string"===typeof e?(/^\s*\n/.test(e)||this.beginNewLine(),e=e.replace(/\r?\n/g,"\r\n"),this.result+=e):e.forEach((function(e){t.beginNewLine(),e.forEach((function(e,o){0!==o&&(t.result+=t.columnSeparator),t.result+=t.putInQuotes(e.data.value||""),e.mergeAcross&&t.appendEmptyCells(e.mergeAcross)}))})))},t.prototype.onNewHeaderGroupingRow=function(){return this.beginNewLine(),{onColumn:this.onNewHeaderGroupingRowColumn.bind(this)}},t.prototype.onNewHeaderGroupingRowColumn=function(e,t,o,n){0!=o&&(this.result+=this.columnSeparator),this.result+=this.putInQuotes(t),this.appendEmptyCells(n)},t.prototype.appendEmptyCells=function(e){for(var t=1;t<=e;t++)this.result+=this.columnSeparator+this.putInQuotes("")},t.prototype.onNewHeaderRow=function(){return this.beginNewLine(),{onColumn:this.onNewHeaderRowColumn.bind(this)}},t.prototype.onNewHeaderRowColumn=function(e,t){0!=t&&(this.result+=this.columnSeparator),this.result+=this.putInQuotes(this.extractHeaderValue(e))},t.prototype.onNewBodyRow=function(){return this.beginNewLine(),{onColumn:this.onNewBodyRowColumn.bind(this)}},t.prototype.onNewBodyRowColumn=function(e,t,o){0!=t&&(this.result+=this.columnSeparator),this.result+=this.putInQuotes(this.extractRowCellValue(e,t,t,"csv",o))},t.prototype.putInQuotes=function(e){return this.suppressQuotes?e:null===e||void 0===e?'""':("string"===typeof e?t=e:"function"===typeof e.toString?t=e.toString():(console.warn("AG Grid: unknown value type during csv conversion"),t=""),'"'+t.replace(/"/g,'""')+'"');var t},t.prototype.parse=function(){return this.result},t.prototype.beginNewLine=function(){this.isFirstLine||(this.result+="\r\n"),this.isFirstLine=!1},t}(Wm),Jm=function(){var e=function(t,o){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])},e(t,o)};return function(t,o){function n(){this.constructor=t}e(t,o),t.prototype=null===o?Object.create(o):(n.prototype=o.prototype,new n)}}(),Xm=function(e,t,o,n){var r,i=arguments.length,a=i<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,o):n;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)a=Reflect.decorate(e,t,o,n);else for(var s=e.length-1;s>=0;s--)(r=e[s])&&(a=(i<3?r(a):i>3?r(t,o,a):r(t,o))||a);return i>3&&a&&Object.defineProperty(t,o,a),a},Qm=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Jm(t,e),t.prototype.postConstruct=function(){this.setBeans({gridSerializer:this.gridSerializer,gridOptionsService:this.gridOptionsService})},t.prototype.getMergedParams=function(e){var t=this.gridOptionsService.get("defaultCsvExportParams");return Object.assign({},t,e)},t.prototype.export=function(e){if(this.isExportSuppressed())return console.warn("AG Grid: Export cancelled. Export is not allowed as per your configuration."),"";var t=this.getMergedParams(e),o=this.getData(t),n=new Blob(["\ufeff",o],{type:"text/plain"});return qm.download(this.getFileName(t.fileName),n),o},t.prototype.exportDataAsCsv=function(e){return this.export(e)},t.prototype.getDataAsCsv=function(e,t){void 0===t&&(t=!1);var o=t?Object.assign({},e):this.getMergedParams(e);return this.getData(o)},t.prototype.getDefaultFileName=function(){return"export.csv"},t.prototype.getDefaultFileExtension=function(){return"csv"},t.prototype.createSerializingSession=function(e){var t=this,o=t.columnModel,n=t.valueService,r=t.gridOptionsService,i=e,a=i.processCellCallback,s=i.processHeaderCallback,l=i.processGroupHeaderCallback,c=i.processRowGroupCallback,d=i.suppressQuotes,u=i.columnSeparator;return new Ym({columnModel:o,valueService:n,gridOptionsService:r,processCellCallback:a||void 0,processHeaderCallback:s||void 0,processGroupHeaderCallback:l||void 0,processRowGroupCallback:c||void 0,suppressQuotes:d||!1,columnSeparator:u||","})},t.prototype.isExportSuppressed=function(){return this.gridOptionsService.is("suppressCsvExport")},Xm([q("columnModel")],t.prototype,"columnModel",void 0),Xm([q("valueService")],t.prototype,"valueService",void 0),Xm([q("gridSerializer")],t.prototype,"gridSerializer",void 0),Xm([q("gridOptionsService")],t.prototype,"gridOptionsService",void 0),Xm([$],t.prototype,"postConstruct",null),t=Xm([W("csvCreator")],t)}(Um),Zm=function(){var e=function(t,o){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])},e(t,o)};return function(t,o){function n(){this.constructor=t}e(t,o),t.prototype=null===o?Object.create(o):(n.prototype=o.prototype,new n)}}(),ey=function(e,t,o,n){var r,i=arguments.length,a=i<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,o):n;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)a=Reflect.decorate(e,t,o,n);else for(var s=e.length-1;s>=0;s--)(r=e[s])&&(a=(i<3?r(a):i>3?r(t,o,a):r(t,o))||a);return i>3&&a&&Object.defineProperty(t,o,a),a};!function(e){e[e.HEADER_GROUPING=0]="HEADER_GROUPING",e[e.HEADER=1]="HEADER",e[e.BODY=2]="BODY"}(pm||(pm={}));var ty=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Zm(t,e),t.prototype.serialize=function(e,t){void 0===t&&(t={});var o=this.getColumnsToExport(t.allColumns,t.columnKeys);return tr.compose(this.prepareSession(o),this.prependContent(t),this.exportColumnGroups(t,o),this.exportHeaders(t,o),this.processPinnedTopRows(t,o),this.processRows(t,o),this.processPinnedBottomRows(t,o),this.appendContent(t))(e).parse()},t.prototype.processRow=function(e,t,o,n){var r=t.shouldRowBeSkipped||function(){return!1},i=this.gridOptionsService.context,a=this.gridOptionsService.api,s=this.gridOptionsService.columnApi,l=this.gridOptionsService.is("groupRemoveSingleChildren"),c=this.gridOptionsService.is("groupRemoveLowestSingleChildren"),d=null!=t.rowPositions||!!t.onlySelected,u=this.gridOptionsService.is("groupHideOpenParents")&&!d,p=this.columnModel.isPivotMode()?n.leafGroup:!n.group,h=!!n.footer,f=t.skipGroups||t.skipRowGroups,g=c&&n.leafGroup,m=1===n.allChildrenCount&&(l||g);if((f&&t.skipGroups&&tr.doOnce((function(){return console.warn("AG Grid: Since v25.2 `skipGroups` has been renamed to `skipRowGroups`.")}),"gridSerializer-skipGroups"),!(!p&&!h&&(t.skipRowGroups||m||u)||t.onlySelected&&!n.isSelected()||t.skipPinnedTop&&"top"===n.rowPinned||t.skipPinnedBottom&&"bottom"===n.rowPinned))&&((!(-1===n.level)||p||h)&&!r({node:n,api:a,columnApi:s,context:i}))){var y=e.onNewBodyRow();if(o.forEach((function(e,t){y.onColumn(e,t,n)})),t.getCustomContentBelowRow){var v=t.getCustomContentBelowRow({node:n,api:a,columnApi:s,context:i});v&&e.addCustomContent(v)}}},t.prototype.appendContent=function(e){return function(t){var o=e.customFooter||e.appendContent;return o&&(e.customFooter&&tr.doOnce((function(){return console.warn("AG Grid: Since version 25.2.0 the `customFooter` param has been deprecated. Use `appendContent` instead.")}),"gridSerializer-customFooter"),t.addCustomContent(o)),t}},t.prototype.prependContent=function(e){return function(t){var o=e.customHeader||e.prependContent;return o&&(e.customHeader&&tr.doOnce((function(){return console.warn("AG Grid: Since version 25.2.0 the `customHeader` param has been deprecated. Use `prependContent` instead.")}),"gridSerializer-customHeader"),t.addCustomContent(o)),t}},t.prototype.prepareSession=function(e){return function(t){return t.prepare(e),t}},t.prototype.exportColumnGroups=function(e,t){var o=this;return function(n){if(e.skipColumnGroupHeaders)e.columnGroups&&tr.doOnce((function(){return console.warn("AG Grid: Since v25.2 the `columnGroups` param has deprecated, and groups are exported by default.")}),"gridSerializer-columnGroups");else{var r=new dt,i=o.displayedGroupCreator.createDisplayedGroups(t,o.columnModel.getGridBalancedTree(),r,null);o.recursivelyAddHeaderGroups(i,n,e.processGroupHeaderCallback)}return n}},t.prototype.exportHeaders=function(e,t){return function(o){if(e.skipHeader||e.skipColumnHeaders)e.skipHeader&&tr.doOnce((function(){return console.warn("AG Grid: Since v25.2 the `skipHeader` param has been renamed to `skipColumnHeaders`.")}),"gridSerializer-skipHeader");else{var n=o.onNewHeaderRow();t.forEach((function(e,t){n.onColumn(e,t,void 0)}))}return o}},t.prototype.processPinnedTopRows=function(e,t){var o=this;return function(n){var r=o.processRow.bind(o,n,e,t);return e.rowPositions?e.rowPositions.filter((function(e){return"top"===e.rowPinned})).sort((function(e,t){return e.rowIndex-t.rowIndex})).map((function(e){return o.pinnedRowModel.getPinnedTopRow(e.rowIndex)})).forEach(r):o.pinnedRowModel.forEachPinnedTopRow(r),n}},t.prototype.processRows=function(e,t){var o=this;return function(n){var r=o.rowModel,i=r.getType(),a="clientSide"===i,s="serverSide"===i,l=!a&&e.onlySelected,c=o.processRow.bind(o,n,e,t),d=e.exportedRows,u=void 0===d?"filteredAndSorted":d;if(e.rowPositions)e.rowPositions.filter((function(e){return null==e.rowPinned})).sort((function(e,t){return e.rowIndex-t.rowIndex})).map((function(e){return r.getRow(e.rowIndex)})).forEach(c);else if(o.columnModel.isPivotMode())a?r.forEachPivotNode(c,!0):r.forEachNode(c);else if(e.onlySelectedAllPages||l){var p=o.selectionService.getSelectedNodes();o.replicateSortedOrder(p),p.forEach(c)}else"all"===u?r.forEachNode(c):a?r.forEachNodeAfterFilterAndSort(c,!0):s?r.forEachNodeAfterFilterAndSort(c):r.forEachNode(c);return n}},t.prototype.replicateSortedOrder=function(e){var t=this,o=this.sortController.getSortOptions(),n=function(e,r){var i,a,s,l;return null!=e.rowIndex&&null!=r.rowIndex?e.rowIndex-r.rowIndex:e.level===r.level?(null===(i=e.parent)||void 0===i?void 0:i.id)===(null===(a=r.parent)||void 0===a?void 0:a.id)?t.rowNodeSorter.compareRowNodes(o,{rowNode:e,currentPos:null!==(s=e.rowIndex)&&void 0!==s?s:-1},{rowNode:r,currentPos:null!==(l=r.rowIndex)&&void 0!==l?l:-1}):n(e.parent,r.parent):e.level>r.level?n(e.parent,r):n(e,r.parent)};e.sort(n)},t.prototype.processPinnedBottomRows=function(e,t){var o=this;return function(n){var r=o.processRow.bind(o,n,e,t);return e.rowPositions?e.rowPositions.filter((function(e){return"bottom"===e.rowPinned})).sort((function(e,t){return e.rowIndex-t.rowIndex})).map((function(e){return o.pinnedRowModel.getPinnedBottomRow(e.rowIndex)})).forEach(r):o.pinnedRowModel.forEachPinnedBottomRow(r),n}},t.prototype.getColumnsToExport=function(e,t){void 0===e&&(e=!1);var o=this.columnModel.isPivotMode();return t&&t.length?this.columnModel.getGridColumns(t):e&&!o?(this.gridOptionsService.isTreeData()?this.columnModel.getGridColumns([ht]):[]).concat(this.columnModel.getAllPrimaryColumns()||[]):this.columnModel.getAllDisplayedColumns()},t.prototype.recursivelyAddHeaderGroups=function(e,t,o){var n=[];e.forEach((function(e){var t=e;t.getChildren&&t.getChildren().forEach((function(e){return n.push(e)}))})),e.length>0&&e[0]instanceof ct&&this.doAddHeaderHeader(t,e,o),n&&n.length>0&&this.recursivelyAddHeaderGroups(n,t,o)},t.prototype.doAddHeaderHeader=function(e,t,o){var n=this,r=e.onNewHeaderGroupingRow(),i=0;t.forEach((function(e){var t,a=e;t=o?o({columnGroup:a,api:n.gridOptionsService.api,columnApi:n.gridOptionsService.columnApi,context:n.gridOptionsService.context}):n.columnModel.getDisplayNameForColumnGroup(a,"header");var s=a.getLeafColumns().reduce((function(e,t,o,n){var r=tr.last(e);return"open"===t.getColumnGroupShow()?r&&null==r[1]||(r=[o],e.push(r)):r&&null==r[1]&&(r[1]=o-1),o===n.length-1&&r&&null==r[1]&&(r[1]=o),e}),[]);r.onColumn(a,t||"",i++,a.getLeafColumns().length-1,s)}))},ey([q("displayedGroupCreator")],t.prototype,"displayedGroupCreator",void 0),ey([q("columnModel")],t.prototype,"columnModel",void 0),ey([q("rowModel")],t.prototype,"rowModel",void 0),ey([q("pinnedRowModel")],t.prototype,"pinnedRowModel",void 0),ey([q("selectionService")],t.prototype,"selectionService",void 0),ey([q("rowNodeSorter")],t.prototype,"rowNodeSorter",void 0),ey([q("sortController")],t.prototype,"sortController",void 0),t=ey([W("gridSerializer")],t)}(Fe),oy={version:"29.3.5",moduleName:Q.CsvExportModule,beans:[Qm,ty]},ny="\r\n",ry=function(){function e(){}return e.createHeader=function(e){void 0===e&&(e={});var t=["version"];return e.version||(e.version="1.0"),e.encoding&&t.push("encoding"),e.standalone&&t.push("standalone"),"<?xml "+t.map((function(t){return t+'="'+e[t]+'"'})).join(" ")+" ?>"},e.createXml=function(e,t){var o=this,n="";e.properties&&(e.properties.prefixedAttributes&&e.properties.prefixedAttributes.forEach((function(e){Object.keys(e.map).forEach((function(r){n+=o.returnAttributeIfPopulated(e.prefix+r,e.map[r],t)}))})),e.properties.rawMap&&Object.keys(e.properties.rawMap).forEach((function(r){n+=o.returnAttributeIfPopulated(r,e.properties.rawMap[r],t)})));var r="<"+e.name+n;return e.children||null!=e.textNode?null!=e.textNode?r+">"+e.textNode+"</"+e.name+">"+ny:(r+=">\r\n",e.children&&e.children.forEach((function(e){r+=o.createXml(e,t)})),r+"</"+e.name+">"+ny):r+"/>"+ny},e.returnAttributeIfPopulated=function(e,t,o){if(!t&&""!==t&&0!==t)return"";var n=t;return"boolean"===typeof t&&o&&(n=o(t))," "+e+'="'+n+'"'},e}(),iy=function(e){var t="function"===typeof Symbol&&Symbol.iterator,o=t&&e[t],n=0;if(o)return o.call(e);if(e&&"number"===typeof e.length)return{next:function(){return e&&n>=e.length&&(e=void 0),{value:e&&e[n++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")},ay=new Uint32Array([0,1996959894,3993919788,2567524794,124634137,1886057615,3915621685,2657392035,249268274,2044508324,3772115230,2547177864,162941995,2125561021,3887607047,2428444049,498536548,1789927666,4089016648,2227061214,450548861,1843258603,4107580753,2211677639,325883990,1684777152,4251122042,2321926636,335633487,1661365465,4195302755,2366115317,997073096,1281953886,3579855332,2724688242,1006888145,1258607687,3524101629,2768942443,901097722,1119000684,3686517206,2898065728,853044451,1172266101,3705015759,2882616665,651767980,1373503546,3369554304,3218104598,565507253,1454621731,3485111705,3099436303,671266974,1594198024,3322730930,2970347812,795835527,1483230225,3244367275,3060149565,1994146192,31158534,2563907772,4023717930,1907459465,112637215,2680153253,3904427059,2013776290,251722036,2517215374,3775830040,2137656763,141376813,2439277719,3865271297,1802195444,476864866,2238001368,4066508878,1812370925,453092731,2181625025,4111451223,1706088902,314042704,2344532202,4240017532,1658658271,366619977,2362670323,4224994405,1303535960,984961486,2747007092,3569037538,1256170817,1037604311,2765210733,3554079995,1131014506,879679996,2909243462,3663771856,1141124467,855842277,2852801631,3708648649,1342533948,654459306,3188396048,3373015174,1466479909,544179635,3110523913,3462522015,1591671054,702138776,2966460450,3352799412,1504918807,783551873,3082640443,3233442989,3988292384,2596254646,62317068,1957810842,3939845945,2647816111,81470997,1943803523,3814918930,2489596804,225274430,2053790376,3826175755,2466906013,167816743,2097651377,4027552580,2265490386,503444072,1762050814,4150417245,2154129355,426522225,1852507879,4275313526,2312317920,282753626,1742555852,4189708143,2394877945,397917763,1622183637,3604390888,2714866558,953729732,1340076626,3518719985,2797360999,1068828381,1219638859,3624741850,2936675148,906185462,1090812512,3747672003,2825379669,829329135,1181335161,3412177804,3160834842,628085408,1382605366,3423369109,3138078467,570562233,1426400815,3317316542,2998733608,733239954,1555261956,3268935591,3050360625,752459403,1541320221,2607071920,3965973030,1969922972,40735498,2617837225,3943577151,1913087877,83908371,2512341634,3803740692,2075208622,213261112,2463272603,3855990285,2094854071,198958881,2262029012,4057260610,1759359992,534414190,2176718541,4139329115,1873836001,414664567,2282248934,4279200368,1711684554,285281116,2405801727,4167216745,1634467795,376229701,2685067896,3608007406,1308918612,956543938,2808555105,3495958263,1231636301,1047427035,2932959818,3654703836,1088359270,936918e3,2847714899,3736837829,1202900863,817233897,3183342108,3401237130,1404277552,615818150,3134207493,3453421203,1423857449,601450431,3009837614,3294710456,1567103746,711928724,3020668471,3272380065,1510334235,755167117]),sy=function(){function e(){}return e.addFolders=function(e){e.forEach(this.addFolder.bind(this))},e.addFolder=function(e){this.folders.push({path:e,created:new Date,isBase64:!1})},e.addFile=function(e,t,o){void 0===o&&(o=!1),this.files.push({path:e,created:new Date,content:t,isBase64:o})},e.getContent=function(e){void 0===e&&(e="application/zip");var t=this.buildFileStream(),o=this.buildUint8Array(t);return this.clearStream(),new Blob([o],{type:e})},e.clearStream=function(){this.folders=[],this.files=[]},e.buildFileStream=function(e){var t,o;void 0===e&&(e="");var n=this.folders.concat(this.files),r=n.length,i="",a=0,s=0;try{for(var l=iy(n),c=l.next();!c.done;c=l.next()){var d=c.value,u=this.getHeader(d,a),p=u.fileHeader,h=u.folderHeader,f=u.content;a+=p.length+f.length,s+=h.length,e+=p+f,i+=h}}catch(g){t={error:g}}finally{try{c&&!c.done&&(o=l.return)&&o.call(l)}finally{if(t)throw t.error}}return e+i+this.buildFolderEnd(r,s,a)},e.getHeader=function(e,t){var o=e.content,n=e.path,r=e.created,i=e.isBase64,a=tr.utf8_encode,s=tr.decToHex,l=a(n),c=l!==n,d=this.convertTime(r),u=this.convertDate(r),p="";if(c){var h=s(1,1)+s(this.getFromCrc32Table(l),4)+l;p="up"+s(h.length,2)+h}var f=o?this.getConvertedContent(o,i):{size:0,content:""},g=f.size,m=f.content,y="\n\0"+(c?"\0\b":"\0\0")+"\0\0"+s(d,2)+s(u,2)+s(g?this.getFromCrc32Table(m):0,4)+s(g,4)+s(g,4)+s(l.length,2)+s(p.length,2);return{fileHeader:"PK\x03\x04"+y+l+p,folderHeader:"PK\x01\x02\x14\0"+y+"\0\0\0\0\0\0"+(o?"\0\0\0\0":"\x10\0\0\0")+s(t,4)+l+p,content:m||""}},e.getConvertedContent=function(e,t){return void 0===t&&(t=!1),t&&(e=e.split(";base64,")[1]),{size:(e=t?atob(e):e).length,content:e}},e.buildFolderEnd=function(e,t,o){var n=tr.decToHex;return"PK\x05\x06\0\0\0\0"+n(e,2)+n(e,2)+n(t,4)+n(o,4)+"\0\0"},e.buildUint8Array=function(e){for(var t=new Uint8Array(e.length),o=0;o<t.length;o++)t[o]=e.charCodeAt(o);return t},e.getFromCrc32Table=function(e){if(!e.length)return 0;for(var t=e.length,o=new Uint8Array(t),n=0;n<t;n++)o[n]=e.charCodeAt(n);var r=~0,i=0;for(n=0;n<t;n++)i=o[n],r=r>>>8^ay[255&(r^i)];return~r},e.convertTime=function(e){var t=e.getHours();return t<<=6,t|=e.getMinutes(),t<<=5,t|=e.getSeconds()/2},e.convertDate=function(e){var t=e.getFullYear()-1980;return t<<=4,t|=e.getMonth()+1,t<<=5,t|=e.getDate()},e.folders=[],e.files=[],e}(),ly=[Pm,$m,oy];ne.registerModules(ly)},7149:(e,t,o)=>{"use strict";o.d(t,{Tfw:()=>r});var n=o(6688);function r(e){return(0,n.k5)({tag:"svg",attr:{viewBox:"0 0 24 24"},child:[{tag:"path",attr:{fill:"none",d:"M0 0h24v24H0z"}},{tag:"path",attr:{d:"M19 6.41L17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"}}]})(e)}},7234:(e,t)=>{"use strict";function o(e,t){var o=e.length;e.push(t);e:for(;0<o;){var n=o-1>>>1,r=e[n];if(!(0<i(r,t)))break e;e[n]=t,e[o]=r,o=n}}function n(e){return 0===e.length?null:e[0]}function r(e){if(0===e.length)return null;var t=e[0],o=e.pop();if(o!==t){e[0]=o;e:for(var n=0,r=e.length,a=r>>>1;n<a;){var s=2*(n+1)-1,l=e[s],c=s+1,d=e[c];if(0>i(l,o))c<r&&0>i(d,l)?(e[n]=d,e[c]=o,n=c):(e[n]=l,e[s]=o,n=s);else{if(!(c<r&&0>i(d,o)))break e;e[n]=d,e[c]=o,n=c}}}return t}function i(e,t){var o=e.sortIndex-t.sortIndex;return 0!==o?o:e.id-t.id}if("object"===typeof performance&&"function"===typeof performance.now){var a=performance;t.unstable_now=function(){return a.now()}}else{var s=Date,l=s.now();t.unstable_now=function(){return s.now()-l}}var c=[],d=[],u=1,p=null,h=3,f=!1,g=!1,m=!1,y="function"===typeof setTimeout?setTimeout:null,v="function"===typeof clearTimeout?clearTimeout:null,b="undefined"!==typeof setImmediate?setImmediate:null;function x(e){for(var t=n(d);null!==t;){if(null===t.callback)r(d);else{if(!(t.startTime<=e))break;r(d),t.sortIndex=t.expirationTime,o(c,t)}t=n(d)}}function w(e){if(m=!1,x(e),!g)if(null!==n(c))g=!0,P(C);else{var t=n(d);null!==t&&N(w,t.startTime-e)}}function C(e,o){g=!1,m&&(m=!1,v(k),k=-1),f=!0;var i=h;try{for(x(o),p=n(c);null!==p&&(!(p.expirationTime>o)||e&&!R());){var a=p.callback;if("function"===typeof a){p.callback=null,h=p.priorityLevel;var s=a(p.expirationTime<=o);o=t.unstable_now(),"function"===typeof s?p.callback=s:p===n(c)&&r(c),x(o)}else r(c);p=n(c)}if(null!==p)var l=!0;else{var u=n(d);null!==u&&N(w,u.startTime-o),l=!1}return l}finally{p=null,h=i,f=!1}}"undefined"!==typeof navigator&&void 0!==navigator.scheduling&&void 0!==navigator.scheduling.isInputPending&&navigator.scheduling.isInputPending.bind(navigator.scheduling);var _,S=!1,E=null,k=-1,j=5,A=-1;function R(){return!(t.unstable_now()-A<j)}function O(){if(null!==E){var e=t.unstable_now();A=e;var o=!0;try{o=E(!0,e)}finally{o?_():(S=!1,E=null)}}else S=!1}if("function"===typeof b)_=function(){b(O)};else if("undefined"!==typeof MessageChannel){var T=new MessageChannel,D=T.port2;T.port1.onmessage=O,_=function(){D.postMessage(null)}}else _=function(){y(O,0)};function P(e){E=e,S||(S=!0,_())}function N(e,o){k=y((function(){e(t.unstable_now())}),o)}t.unstable_IdlePriority=5,t.unstable_ImmediatePriority=1,t.unstable_LowPriority=4,t.unstable_NormalPriority=3,t.unstable_Profiling=null,t.unstable_UserBlockingPriority=2,t.unstable_cancelCallback=function(e){e.callback=null},t.unstable_continueExecution=function(){g||f||(g=!0,P(C))},t.unstable_forceFrameRate=function(e){0>e||125<e?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):j=0<e?Math.floor(1e3/e):5},t.unstable_getCurrentPriorityLevel=function(){return h},t.unstable_getFirstCallbackNode=function(){return n(c)},t.unstable_next=function(e){switch(h){case 1:case 2:case 3:var t=3;break;default:t=h}var o=h;h=t;try{return e()}finally{h=o}},t.unstable_pauseExecution=function(){},t.unstable_requestPaint=function(){},t.unstable_runWithPriority=function(e,t){switch(e){case 1:case 2:case 3:case 4:case 5:break;default:e=3}var o=h;h=e;try{return t()}finally{h=o}},t.unstable_scheduleCallback=function(e,r,i){var a=t.unstable_now();switch("object"===typeof i&&null!==i?i="number"===typeof(i=i.delay)&&0<i?a+i:a:i=a,e){case 1:var s=-1;break;case 2:s=250;break;case 5:s=1073741823;break;case 4:s=1e4;break;default:s=5e3}return e={id:u++,callback:r,priorityLevel:e,startTime:i,expirationTime:s=i+s,sortIndex:-1},i>a?(e.sortIndex=i,o(d,e),null===n(c)&&e===n(d)&&(m?(v(k),k=-1):m=!0,N(w,i-a))):(e.sortIndex=s,o(c,e),g||f||(g=!0,P(C))),e},t.unstable_shouldYield=R,t.unstable_wrapCallback=function(e){var t=h;return function(){var o=h;h=t;try{return e.apply(this,arguments)}finally{h=o}}}},7301:function(e,t){"use strict";var o=this&&this.__extends||function(){var e=function(t,o){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])},e(t,o)};return function(t,o){function n(){this.constructor=t}e(t,o),t.prototype=null===o?Object.create(o):(n.prototype=o.prototype,new n)}}();Object.defineProperty(t,"__esModule",{value:!0}),t.ReactComponent=void 0;var n=function(e){function t(t,o,n){var r=e.call(this)||this;return r.portal=null,r.reactComponent=t,r.portalManager=o,r.componentType=n,r.statelessComponent=r.isStateless(r.reactComponent),r}return o(t,e),t.prototype.getGui=function(){return this.eParentElement},t.prototype.destroy=function(){return this.componentInstance&&"function"==typeof this.componentInstance.destroy&&this.componentInstance.destroy(),this.portalManager.destroyPortal(this.portal)},t.prototype.createParentElement=function(e){var t=this.portalManager.getComponentWrappingElement(),o=document.createElement(t||"div");return o.classList.add("ag-react-container"),e.reactContainer=o,o},t.prototype.addParentContainerStyleAndClasses=function(){var e=this;this.componentInstance&&(this.componentInstance.getReactContainerStyle&&this.componentInstance.getReactContainerStyle()&&Object.assign(this.eParentElement.style,this.componentInstance.getReactContainerStyle()),this.componentInstance.getReactContainerClasses&&this.componentInstance.getReactContainerClasses()&&this.componentInstance.getReactContainerClasses().forEach((function(t){return e.eParentElement.classList.add(t)})))},t.prototype.statelessComponentRendered=function(){return this.eParentElement.childElementCount>0||this.eParentElement.childNodes.length>0},t.prototype.getFrameworkComponentInstance=function(){return this.componentInstance},t.prototype.isStatelessComponent=function(){return this.statelessComponent},t.prototype.getReactComponentName=function(){return this.reactComponent.name},t.prototype.getMemoType=function(){return this.hasSymbol()?Symbol.for("react.memo"):60115},t.prototype.hasSymbol=function(){return"function"===typeof Symbol&&Symbol.for},t.prototype.isStateless=function(e){return"function"===typeof e&&!(e.prototype&&e.prototype.isReactComponent)||"object"===typeof e&&e.$$typeof===this.getMemoType()},t.prototype.hasMethod=function(e){var t=this.getFrameworkComponentInstance();return!!t&&null!==t[e]||this.fallbackMethodAvailable(e)},t.prototype.callMethod=function(e,t){var o=this,n=this.getFrameworkComponentInstance();if(this.isStatelessComponent())return this.fallbackMethod(e,t&&t[0]?t[0]:{});if(n){var r=n[e];return r?r.apply(n,t):this.fallbackMethodAvailable(e)?this.fallbackMethod(e,t&&t[0]?t[0]:{}):void 0}setTimeout((function(){return o.callMethod(e,t)}))},t.prototype.addMethod=function(e,t){this[e]=t},t}((function(){}));t.ReactComponent=n},7309:(e,t,o)=>{"use strict";o.r(t),o.d(t,{default:()=>we});var n=o(5043),r=o(7950),i=o(3216),a=o(1529),s=o(5315),l=o(8136),c=o(1009),d=o(2963),u=o.n(d),p=o(3768),h=o(2509),f=o(579);const g=(e,t)=>{if(e===t)return 1;if(!e||!t)return 0;const o=e.length,n=t.length;if(0===o)return 0;if(0===n)return 0;if(o<3||n<3)return e.includes(t)||t.includes(e)?.9:0;const r=[];for(let i=0;i<=o;i++)r[i]=[i];for(let i=0;i<=n;i++)r[0][i]=i;for(let i=1;i<=o;i++)for(let o=1;o<=n;o++){const n=e.charAt(i-1)===t.charAt(o-1)?0:1;r[i][o]=Math.min(r[i-1][o]+1,r[i][o-1]+1,r[i-1][o-1]+n)}return 1-r[o][n]/Math.max(o,n)},m=a.Ay.div`
  display: flex;
  justify-content: space-between;
  align-items: center;
  padding-bottom: 15px;
  margin-bottom: 20px;
  border-bottom: 1px solid #333;

  h2 {
    color: #00ff00;
    margin: 0;
    font-size: 1.2rem;
    font-family: 'Courier New', monospace;
  }
`,y=a.Ay.button`
  background: none;
  border: none;
  color: #ff5555;
  font-size: 1.2rem;
  cursor: pointer;
  display: flex;
  align-items: center;
  justify-content: center;
  
  &:hover {
    color: #ff0000;
  }
`,v=a.Ay.div`
  display: flex;
  margin-bottom: 20px;
  border-radius: 8px;
  overflow: hidden;
  background-color: #1a1a1a;
  height: 6px;
`,b=a.Ay.div`
  flex: 1;
  height: 100%;
  background-color: ${e=>e.active?"#00ff00":e.completed?"#00aa00":"#333"};
  transition: background-color 0.3s ease;
`,x=a.Ay.div`
  display: flex;
  margin-bottom: 25px;
  justify-content: space-between;
`,w=a.Ay.div`
  display: flex;
  flex-direction: column;
  align-items: center;
  flex: 1;
  
  .step-number {
    width: 24px;
    height: 24px;
    border-radius: 50%;
    background-color: ${e=>e.active?"#00ff00":e.completed?"#00aa00":"#333"};
    color: #000;
    display: flex;
    align-items: center;
    justify-content: center;
    font-weight: bold;
    margin-bottom: 6px;
    transition: background-color 0.3s ease;
  }
  
  .step-label {
    font-size: 0.8rem;
    color: ${e=>e.active?"#00ff00":e.completed?"#00aa00":"#999"};
    transition: color 0.3s ease;
  }
`,C=a.Ay.div`
  margin-bottom: 30px;
`,_=a.Ay.h3`
  color: #00ff00;
  margin: 0 0 15px 0;
  display: flex;
  align-items: center;
  gap: 8px;
  font-size: 1.1rem;
`,S=a.Ay.h4`
  color: #00ff00;
  margin: 0 0 15px 0;
  font-size: 1rem;
  display: flex;
  align-items: center;
  gap: 8px;
  padding-bottom: 6px;
  border-bottom: 1px solid #333;
`,E=a.Ay.div`
  background-color: #1a1a1a;
  border-radius: 8px;
  border: 1px solid #333;
  padding: 20px;
  margin-bottom: 15px;
`,k=a.Ay.div`
  border-bottom: 1px solid #333;
  padding: 15px 10px;
  margin-bottom: 10px;
  
  &:last-child {
    border-bottom: none;
  }
`,j=a.Ay.div`
  display: flex;
  justify-content: space-between;
  margin-bottom: 8px;
  
  .interaction-type {
    font-weight: bold;
    color: #00ff00;
  }
  
  .interaction-date {
    color: #999;
    font-size: 0.85rem;
  }
`,A=a.Ay.div`
  padding: 12px;
  color: #eee;
  background-color: #222;
  border-radius: 4px;
  white-space: pre-wrap;
  max-height: 250px;
  overflow: auto;
  font-size: 0.95rem;
  line-height: 1.4;
`,R=a.Ay.div`
  max-height: 400px;
  overflow-y: auto;
  margin-top: 15px;
`,O=a.Ay.div`
  border: 1px solid ${e=>e.selected?"#00ff00":"#333"};
  border-radius: 8px;
  padding: 15px;
  background-color: ${e=>e.selected?"rgba(0, 255, 0, 0.1)":"#222"};
  margin-bottom: 10px;
  cursor: pointer;
  transition: all 0.2s;
  
  &:hover {
    background-color: ${e=>e.selected?"rgba(0, 255, 0, 0.15)":"#333"};
  }
`,T=a.Ay.h4`
  margin: 0 0 8px 0;
  color: #00ff00;
  font-size: 1rem;
`,D=a.Ay.div`
  font-size: 0.9rem;
  color: #ccc;
  display: flex;
  flex-wrap: wrap;
  gap: 10px;
`,P=a.Ay.div`
  display: grid;
  grid-template-columns: 1fr 1fr;
  gap: 16px;
  
  @media (max-width: 768px) {
    grid-template-columns: 1fr;
  }
`,N=a.Ay.div`
  margin-bottom: 15px;
  
  &:last-child {
    margin-bottom: 0;
  }
`,I=(a.Ay.div`
  margin-bottom: 20px;
`,a.Ay.label`
  color: #999;
  display: block;
  margin-bottom: 5px;
  font-size: 0.8rem;
`,a.Ay.input`
  background-color: #222;
  border: 1px solid #444;
  border-radius: 4px;
  color: #eee;
  padding: 8px 10px;
  width: 100%;
  font-size: 0.9rem;
  
  &:focus {
    outline: none;
    border-color: #00ff00;
  }
`),M=a.Ay.select`
  background-color: #222;
  border: 1px solid #444;
  border-radius: 4px;
  color: #eee;
  padding: 8px 10px;
  width: 100%;
  font-size: 0.9rem;
  
  &:focus {
    outline: none;
    border-color: #00ff00;
  }
`,L=a.Ay.textarea`
  background-color: #222;
  border: 1px solid #444;
  border-radius: 4px;
  color: #eee;
  padding: 8px 10px;
  width: 100%;
  min-height: 100px;
  font-size: 0.9rem;
  resize: vertical;
  
  &:focus {
    outline: none;
    border-color: #00ff00;
  }
`,F=a.Ay.div`
  margin-top: 8px;
  padding: 8px;
  background-color: #222;
  border-radius: 4px;
  border-left: 3px solid ${e=>e.color||"#666"};
  font-size: 0.85rem;
  color: #ccc;
  
  .source-label {
    font-size: 0.7rem;
    color: ${e=>e.color||"#999"};
    text-transform: uppercase;
    margin-bottom: 3px;
  }
  
  .source-value {
    word-break: break-word;
  }
`,G=(a.Ay.button`
  background: none;
  border: none;
  color: #999;
  font-size: 0.8rem;
  padding: 0;
  margin-top: 5px;
  text-decoration: underline;
  cursor: pointer;
  
  &:hover {
    color: #00ff00;
  }
`,a.Ay.div`
  display: flex;
  flex-wrap: wrap;
  gap: 8px;
  margin-top: 8px;
`),z=a.Ay.div`
  background-color: #222;
  color: #00ff00;
  border: 1px solid #00ff00;
  border-radius: 4px;
  padding: 4px 8px;
  font-size: 0.8rem;
  display: flex;
  align-items: center;
  gap: 5px;
  
  .remove {
    cursor: pointer;
    &:hover {
      color: #ff5555;
    }
  }
`,H=a.Ay.div`
  text-align: center;
  padding: 30px;
  color: #999;
  font-style: italic;
`,B=a.Ay.div`
  display: flex;
  justify-content: space-between;
  margin-top: 30px;
`,V=a.Ay.button`
  padding: 10px 20px;
  border-radius: 4px;
  font-weight: bold;
  cursor: pointer;
  display: flex;
  align-items: center;
  gap: 8px;
  
  &:disabled {
    opacity: 0.5;
    cursor: not-allowed;
  }
`,$=(0,a.Ay)(V)`
  background-color: #00ff00;
  color: #000;
  border: none;
  
  &:hover:not(:disabled) {
    background-color: #00cc00;
  }
`,U=(0,a.Ay)(V)`
  background-color: #ff5555;
  color: white;
  border: none;
  
  &:hover:not(:disabled) {
    background-color: #ff3333;
  }
`,W=(0,a.Ay)(V)`
  background-color: transparent;
  color: #ccc;
  border: 1px solid #555;
  
  &:hover:not(:disabled) {
    background-color: #333;
  }
`,q=(0,a.Ay)(V)`
  background-color: #ff9900;
  color: #000;
  border: none;
  
  &:hover:not(:disabled) {
    background-color: #ff8800;
  }
`,K=a.Ay.div`
  display: flex;
  flex-direction: column;
  align-items: center;
  justify-content: center;
  padding: 40px;
`,Y=a.Ay.span`
  display: inline-block;
  background-color: ${e=>e.bg||"#222"};
  color: ${e=>e.color||"#00ff00"};
  border: 1px solid ${e=>e.borderColor||"#00ff00"};
  padding: 2px 6px;
  margin-right: 3px;
  border-radius: 4px;
  font-size: 11px;
`,J=a.Ay.div`
  display: flex;
  gap: 10px;
  margin-bottom: 15px;
`,X=a.Ay.button`
  background-color: ${e=>e.active?"rgba(0, 255, 0, 0.2)":"#222"};
  border: 1px solid ${e=>e.active?"#00ff00":"#444"};
  color: ${e=>e.active?"#00ff00":"#999"};
  padding: 5px 10px;
  border-radius: 4px;
  font-size: 0.8rem;
  cursor: pointer;
  
  &:hover {
    background-color: ${e=>e.active?"rgba(0, 255, 0, 0.3)":"#333"};
  }
`,Q=e=>{var t,o,r,i;let{isOpen:a,onClose:l,contact:d,onComplete:Q}=e;const[Z,ee]=(0,n.useState)(1),[te,oe]=(0,n.useState)(!1),[ne,re]=(0,n.useState)(null),[ie,ae]=(0,n.useState)([]),[se,le]=(0,n.useState)([]),[ce,de]=(0,n.useState)(null),[ue,pe]=(0,n.useState)(!1),[he,fe]=(0,n.useState)({keepInTouch:null,category:null,notes:"",city:null,tags:[],mobile:"",email:"",linkedIn:"",company:null,dealInfo:""}),[ge,me]=(0,n.useState)({hubspot:{email:"",mobile:"",company:null,tags:[],notes:""},supabase:{email:"",mobile:"",company:null,tags:[],notes:""},airtable:{email:"",mobile:"",company:null,tags:[],notes:""}}),[ye,ve]=(0,n.useState)({hubspot:!1,supabase:!1,airtable:!1});(0,n.useEffect)((()=>{d&&a&&be()}),[d,a]);const be=async()=>{if(d){oe(!0),re(null),ee(1),de(null);try{fe({keepInTouch:null,category:null,notes:"",city:d.cities&&d.cities.length>0?d.cities[0]:null,tags:d.tags||[],mobile:d.mobile||"",email:d.email||"",linkedIn:"",company:d.companies&&d.companies.length>0?d.companies[0]:null,dealInfo:""});const{data:e,error:t}=await s.supabase.from("interactions").select("interaction_id, interaction_type, direction, interaction_date, summary").eq("contact_id",d.contact_id).order("interaction_date",{ascending:!1}).limit(5);if(t)throw t;ae(e||[]),me({hubspot:{email:d.email||"example@hubspot.com",mobile:d.mobile||"+1234567890",company:d.companies&&d.companies.length>0?d.companies[0]:null,tags:["HubSpot Tag 1","HubSpot Tag 2"],notes:"Notes from HubSpot: This contact was last active 3 months ago."},supabase:{email:d.email||"example@oldsupabase.com",mobile:d.mobile||"+1987654321",company:null,tags:["Supabase Tag 1"],notes:"Notes from old Supabase: Contact has been in database since 2021."},airtable:{email:"",mobile:d.mobile||"+1234509876",company:null,tags:["Airtable Tag 1","Airtable Tag 2","Airtable Tag 3"],notes:"Notes from Airtable: Contact requested follow-up."}})}catch(e){console.error("Error initializing workflow data:",e),re("Failed to load contact data. Please try again.")}finally{oe(!1)}}},xe=()=>{1===Z?(ee(2),we()):2===Z?ee(3):3===Z?ee(4):4===Z&&Se()},we=async()=>{if(d){oe(!0);try{let e=[];if(d.email){const{data:t,error:o}=await s.supabase.from("contact_emails").select("contact_id").eq("email",d.email).neq("contact_id",d.contact_id);!o&&t&&t.length>0&&(e=t.map((e=>e.contact_id)))}let t=[];if(d.mobile){const{data:e,error:o}=await s.supabase.from("contact_mobiles").select("contact_id").eq("mobile",d.mobile).neq("contact_id",d.contact_id);!o&&e&&e.length>0&&(t=e.map((e=>e.contact_id)))}const o=(d.first_name||"").toLowerCase(),n=(d.last_name||"").toLowerCase();let r=[];if(o||n){const{data:e,error:t}=await s.supabase.from("contacts").select("contact_id").filter("first_name","not.is",null).filter("last_name","not.is",null).neq("contact_id",d.contact_id);!t&&e&&(r=e.filter((e=>{const t=(e.first_name||"").toLowerCase(),r=(e.last_name||"").toLowerCase();return o&&t.includes(o)||n&&r.includes(n)||o&&t&&g(o,t)>.8||n&&r&&g(n,r)>.8})).map((e=>e.contact_id)))}const i=[...new Set([...e,...t,...r])];let a=[];if(i.length>0){const{data:e,error:t}=await s.supabase.from("contacts").select("contact_id, first_name, last_name, email, mobile, category, last_interaction_at").in("contact_id",i).limit(5);t||(a=e||[])}let l=[];if(d.email){const{data:e,error:t}=await s.supabase.from("contact_emails").select("contact_id, email").eq("email",d.email).neq("contact_id",d.contact_id);if(!t&&e&&e.length>0){const t=e.map((e=>e.contact_id)),{data:o,error:n}=await s.supabase.from("contacts").select("contact_id, first_name, last_name, email, mobile, category, last_interaction_at").in("contact_id",t);n||(l=o||[])}}let c=[];if(d.mobile){const{data:e,error:t}=await s.supabase.from("contact_mobiles").select("contact_id, mobile").eq("mobile",d.mobile).neq("contact_id",d.contact_id);if(!t&&e&&e.length>0){const t=e.map((e=>e.contact_id)),{data:o,error:n}=await s.supabase.from("contacts").select("contact_id, first_name, last_name, email, mobile, category, last_interaction_at").in("contact_id",t);n||(c=o||[])}}const u=[...a||[],...l||[],...c||[]],p=[],h=new Set;u.forEach((e=>{h.has(e.contact_id)||(h.add(e.contact_id),p.push(e))})),le(p)}catch(e){console.error("Error searching for duplicates:",e),re("Failed to search for duplicates. Please try again.")}finally{oe(!1)}}},Ce=async e=>{if(d){oe(!0);try{const{error:o}=await s.supabase.from("contacts").update({category:e}).eq("contact_id",d.contact_id);if(o)throw o;if("Spam"===e&&d.email)try{await s.supabase.from("emails_spam").insert([{email:d.email,counter:1}])}catch(t){console.error("Error adding to spam list:",t)}Q(e.toLowerCase(),d.contact_id),Ee(),p.Ay.success(`Contact marked as ${e}`)}catch(o){console.error(`Error marking contact as ${e}:`,o),re(`Failed to mark contact as ${e}: ${o.message||"Unknown error"}`),oe(!1)}}},_e=(e,t)=>{fe((o=>({...o,[e]:t})))},Se=async()=>{if(d){oe(!0);try{const{error:e}=await s.supabase.from("contacts").update({category:he.category||null,linkedin_url:he.linkedIn||null,notes:he.notes||null,keep_in_touch_frequency:he.keepInTouch||null}).eq("contact_id",d.contact_id);if(e)throw e;if(he.mobile&&he.mobile!==d.mobile){const{data:e}=await s.supabase.from("contact_mobiles").select("mobile_id").eq("contact_id",d.contact_id).eq("is_primary",!0);e&&e.length>0?await s.supabase.from("contact_mobiles").update({mobile:he.mobile}).eq("mobile_id",e[0].mobile_id):await s.supabase.from("contact_mobiles").insert([{contact_id:d.contact_id,mobile:he.mobile,is_primary:!0}])}if(he.email&&he.email!==d.email){const{data:e}=await s.supabase.from("contact_emails").select("email_id").eq("contact_id",d.contact_id).eq("is_primary",!0);e&&e.length>0?await s.supabase.from("contact_emails").update({email:he.email}).eq("email_id",e[0].email_id):await s.supabase.from("contact_emails").insert([{contact_id:d.contact_id,email:he.email,is_primary:!0}])}if(he.city&&(!d.cities||!d.cities.some((e=>e.id===he.city.id)))){const{data:e}=await s.supabase.from("contact_cities").select("entry_id").eq("contact_id",d.contact_id).eq("city_id",he.city.id);e&&0!==e.length||await s.supabase.from("contact_cities").insert([{contact_id:d.contact_id,city_id:he.city.id}])}if(he.tags&&he.tags.length>0){const{data:e}=await s.supabase.from("contact_tags").select("entry_id, tag_id").eq("contact_id",d.contact_id),t=(e||[]).map((e=>e.tag_id)),o=he.tags.filter((e=>!t.includes(e.id))).map((e=>({contact_id:d.contact_id,tag_id:e.id})));o.length>0&&await s.supabase.from("contact_tags").insert(o)}if(he.company){const{data:e}=await s.supabase.from("contact_companies").select("contact_companies_id").eq("contact_id",d.contact_id).eq("company_id",he.company.id);e&&0!==e.length||await s.supabase.from("contact_companies").insert([{contact_id:d.contact_id,company_id:he.company.id}])}if(he.notes&&""!==he.notes.trim()){const{data:e,error:t}=await s.supabase.from("notes").insert([{note_text:he.notes,created_at:(new Date).toISOString()}]).select("note_id");if(t)throw t;e&&e.length>0&&await s.supabase.from("notes_contacts").insert([{note_id:e[0].note_id,contact_id:d.contact_id}])}const{error:t}=await s.supabase.from("contacts").update({category:null}).eq("contact_id",d.contact_id);if(t)throw t;Q("added",d.contact_id),Ee(),p.Ay.success("Contact successfully added to CRM")}catch(e){console.error("Error saving contact to CRM:",e),re(`Failed to save contact to CRM: ${e.message||"Unknown error"}`),oe(!1)}}},Ee=()=>{ee(1),ae([]),le([]),de(null),re(null),oe(!1),l()},ke=e=>{ve((t=>({...t,[e]:!t[e]})))};return(0,f.jsxs)(f.Fragment,{children:[(0,f.jsx)(h.A,{isOpen:ue,onClose:()=>pe(!1),primaryContactId:null===ce||void 0===ce?void 0:ce.contact_id,duplicateContactId:null===d||void 0===d?void 0:d.contact_id,onComplete:(e,t)=>{pe(!1),"merged"===e&&(Q("merged",t),Ee())}}),(0,f.jsxs)(u(),{isOpen:a,onRequestClose:te?null:Ee,shouldCloseOnOverlayClick:!te,style:{content:{top:"50%",left:"50%",right:"auto",bottom:"auto",marginRight:"-50%",transform:"translate(-50%, -50%)",padding:"25px",maxWidth:"800px",width:"90%",maxHeight:"90vh",overflow:"auto",backgroundColor:"#121212",border:"1px solid #333",borderRadius:"8px",boxShadow:"0 4px 20px rgba(0, 0, 0, 0.6)",color:"#e0e0e0",zIndex:1001},overlay:{backgroundColor:"rgba(0, 0, 0, 0.75)",zIndex:1e3}},contentLabel:"Add to CRM Workflow",children:[(0,f.jsxs)(m,{children:[(0,f.jsx)("h2",{children:"Add Contact to CRM"}),(0,f.jsx)(y,{onClick:Ee,disabled:te,children:(0,f.jsx)(c.yGN,{})})]}),(0,f.jsxs)(x,{children:[(0,f.jsxs)(w,{active:1===Z,completed:Z>1,children:[(0,f.jsx)("div",{className:"step-number",children:"1"}),(0,f.jsx)("div",{className:"step-label",children:"Relevance"})]}),(0,f.jsxs)(w,{active:2===Z,completed:Z>2,children:[(0,f.jsx)("div",{className:"step-number",children:"2"}),(0,f.jsx)("div",{className:"step-label",children:"Duplicates"})]}),(0,f.jsxs)(w,{active:3===Z,completed:Z>3,children:[(0,f.jsx)("div",{className:"step-number",children:"3"}),(0,f.jsx)("div",{className:"step-label",children:"Enrichment"})]}),(0,f.jsxs)(w,{active:4===Z,completed:Z>4,children:[(0,f.jsx)("div",{className:"step-number",children:"4"}),(0,f.jsx)("div",{className:"step-label",children:"Professional"})]})]}),(0,f.jsxs)(v,{children:[(0,f.jsx)(b,{active:1===Z,completed:Z>1}),(0,f.jsx)(b,{active:2===Z,completed:Z>2}),(0,f.jsx)(b,{active:3===Z,completed:Z>3}),(0,f.jsx)(b,{active:4===Z,completed:Z>4})]}),ne&&(0,f.jsxs)("div",{style:{backgroundColor:"rgba(255, 70, 70, 0.2)",color:"#ff9999",padding:"10px 15px",borderRadius:"4px",marginBottom:"15px",display:"flex",alignItems:"center",gap:"10px"},children:[(0,f.jsx)(c.eHT,{}),(0,f.jsx)("div",{children:ne})]}),te?(0,f.jsx)(K,{children:(0,f.jsx)("div",{style:{color:"#00ff00",marginBottom:"10px"},children:"Loading..."})}):(0,f.jsxs)(f.Fragment,{children:[1===Z&&(0,f.jsxs)(C,{children:[(0,f.jsxs)(_,{children:[(0,f.jsx)(c.mEP,{})," Confirm Contact Relevance"]}),d&&(0,f.jsx)(E,{children:(0,f.jsxs)("div",{style:{marginBottom:"20px"},children:[(0,f.jsxs)("div",{style:{fontSize:"1.2rem",fontWeight:"bold",marginBottom:"8px"},children:[d.first_name," ",d.last_name]}),(0,f.jsxs)("div",{style:{display:"flex",flexWrap:"wrap",gap:"10px",fontSize:"0.9rem",color:"#ccc"},children:[d.email&&(0,f.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:"5px"},children:[(0,f.jsx)(c.pHD,{size:14}),d.email]}),d.mobile&&(0,f.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:"5px"},children:[(0,f.jsx)(c.QFc,{size:14}),d.mobile]})]})]})}),(0,f.jsxs)(E,{children:[(0,f.jsxs)(S,{children:[(0,f.jsx)(c.mEP,{})," Recent Interactions"]}),0===ie.length?(0,f.jsx)(H,{children:"No recent interactions found for this contact"}):(0,f.jsx)(f.Fragment,{children:ie.map((e=>(0,f.jsxs)(k,{children:[(0,f.jsxs)(j,{children:[(0,f.jsxs)("div",{className:"interaction-type",children:[e.interaction_type," (",e.direction,")"]}),(0,f.jsx)("div",{className:"interaction-date",children:new Date(e.interaction_date).toLocaleString()})]}),(0,f.jsx)(A,{children:e.summary||"No summary available"})]},e.interaction_id)))})]}),(0,f.jsxs)(B,{children:[(0,f.jsxs)("div",{children:[(0,f.jsxs)(U,{onClick:()=>Ce("Spam"),disabled:te,children:[(0,f.jsx)(c.IXo,{})," Spam"]}),(0,f.jsxs)(q,{onClick:()=>Ce("Skip"),disabled:te,style:{marginLeft:"10px"},children:[(0,f.jsx)(c.yGN,{})," Skip"]})]}),(0,f.jsxs)($,{onClick:xe,disabled:te,children:["Next ",(0,f.jsx)(c.dyV,{})]})]})]}),2===Z&&(0,f.jsxs)(C,{children:[(0,f.jsxs)(_,{children:[(0,f.jsx)(c.EPw,{})," Check for Duplicates"]}),(0,f.jsx)(E,{children:0===se.length?(0,f.jsx)(H,{children:"No potential duplicates found for this contact"}):(0,f.jsxs)(f.Fragment,{children:[(0,f.jsxs)("div",{style:{marginBottom:"15px"},children:["We found ",se.length," potential duplicate contacts. Select a duplicate to merge with, or continue with this as a new contact."]}),(0,f.jsx)(R,{children:se.map((e=>(0,f.jsxs)(O,{selected:(null===ce||void 0===ce?void 0:ce.contact_id)===e.contact_id,onClick:()=>(e=>{de((null===ce||void 0===ce?void 0:ce.contact_id)===e.contact_id?null:e)})(e),children:[(0,f.jsxs)(T,{children:[e.first_name," ",e.last_name]}),(0,f.jsxs)(D,{children:[e.email&&(0,f.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:"5px"},children:[(0,f.jsx)(c.pHD,{size:14}),e.email]}),e.mobile&&(0,f.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:"5px"},children:[(0,f.jsx)(c.QFc,{size:14}),e.mobile]}),e.category&&(0,f.jsx)(Y,{children:e.category}),e.last_interaction_at&&(0,f.jsxs)("div",{children:["Last interaction: ",new Date(e.last_interaction_at).toLocaleDateString()]})]})]},e.contact_id)))})]})}),(0,f.jsxs)(B,{children:[(0,f.jsx)("div",{children:(0,f.jsx)(W,{onClick:()=>ee(1),disabled:te,children:"Back"})}),(0,f.jsxs)("div",{children:[ce&&(0,f.jsxs)(V,{style:{backgroundColor:"#ff9900",color:"black",border:"none",marginRight:"10px"},onClick:()=>pe(!0),disabled:te,children:[(0,f.jsx)(c.EPw,{})," Process Duplicate"]}),(0,f.jsxs)($,{onClick:xe,disabled:te,children:["Continue as New ",(0,f.jsx)(c.dyV,{})]})]})]})]}),3===Z&&(0,f.jsxs)(C,{children:[(0,f.jsxs)(_,{children:[(0,f.jsx)(c.S8s,{})," Contact Enrichment"]}),(0,f.jsxs)(J,{children:[(0,f.jsx)(X,{active:ye.hubspot,onClick:()=>ke("hubspot"),children:"HubSpot"}),(0,f.jsx)(X,{active:ye.supabase,onClick:()=>ke("supabase"),children:"Old Supabase"}),(0,f.jsx)(X,{active:ye.airtable,onClick:()=>ke("airtable"),children:"Airtable"})]}),(0,f.jsxs)(P,{children:[(0,f.jsxs)("div",{children:[(0,f.jsxs)(E,{children:[(0,f.jsxs)(S,{children:[(0,f.jsx)(c.wIk,{})," Keep in Touch Frequency"]}),(0,f.jsxs)(N,{children:[(0,f.jsxs)(M,{value:he.keepInTouch||"",onChange:e=>_e("keepInTouch",""===e.target.value?null:e.target.value),children:[(0,f.jsx)("option",{value:"",children:"None"}),(0,f.jsx)("option",{value:"daily",children:"Daily"}),(0,f.jsx)("option",{value:"weekly",children:"Weekly"}),(0,f.jsx)("option",{value:"biweekly",children:"Bi-Weekly"}),(0,f.jsx)("option",{value:"monthly",children:"Monthly"}),(0,f.jsx)("option",{value:"quarterly",children:"Quarterly"}),(0,f.jsx)("option",{value:"biannually",children:"Bi-Annually"}),(0,f.jsx)("option",{value:"annually",children:"Annually"})]}),ye.hubspot&&ge.hubspot.keepInTouch&&(0,f.jsxs)(F,{color:"#ff7a59",children:[(0,f.jsx)("div",{className:"source-label",children:"HubSpot"}),(0,f.jsx)("div",{className:"source-value",children:ge.hubspot.keepInTouch})]}),ye.airtable&&ge.airtable.keepInTouch&&(0,f.jsxs)(F,{color:"#2d7ff9",children:[(0,f.jsx)("div",{className:"source-label",children:"Airtable"}),(0,f.jsx)("div",{className:"source-value",children:ge.airtable.keepInTouch})]})]})]}),(0,f.jsxs)(E,{children:[(0,f.jsxs)(S,{children:[(0,f.jsx)(c.cnX,{})," Category"]}),(0,f.jsxs)(N,{children:[(0,f.jsxs)(M,{value:he.category||"",onChange:e=>_e("category",""===e.target.value?null:e.target.value),children:[(0,f.jsx)("option",{value:"",children:"None"}),(0,f.jsx)("option",{value:"Friend",children:"Friend"}),(0,f.jsx)("option",{value:"Family",children:"Family"}),(0,f.jsx)("option",{value:"Work",children:"Work"}),(0,f.jsx)("option",{value:"Business",children:"Business"}),(0,f.jsx)("option",{value:"Client",children:"Client"}),(0,f.jsx)("option",{value:"Founder",children:"Founder"}),(0,f.jsx)("option",{value:"Investor",children:"Investor"}),(0,f.jsx)("option",{value:"Portfolio",children:"Portfolio"})]}),ye.hubspot&&ge.hubspot.category&&(0,f.jsxs)(F,{color:"#ff7a59",children:[(0,f.jsx)("div",{className:"source-label",children:"HubSpot"}),(0,f.jsx)("div",{className:"source-value",children:ge.hubspot.category})]})]})]}),(0,f.jsxs)(E,{children:[(0,f.jsxs)(S,{children:[(0,f.jsx)(c.QFc,{})," Mobile Number"]}),(0,f.jsxs)(N,{children:[(0,f.jsx)(I,{type:"text",value:he.mobile||"",onChange:e=>_e("mobile",e.target.value),placeholder:"Enter mobile number"}),ye.hubspot&&ge.hubspot.mobile&&(0,f.jsxs)(F,{color:"#ff7a59",children:[(0,f.jsx)("div",{className:"source-label",children:"HubSpot"}),(0,f.jsx)("div",{className:"source-value",children:ge.hubspot.mobile})]}),ye.supabase&&ge.supabase.mobile&&(0,f.jsxs)(F,{color:"#3ecf8e",children:[(0,f.jsx)("div",{className:"source-label",children:"Old Supabase"}),(0,f.jsx)("div",{className:"source-value",children:ge.supabase.mobile})]}),ye.airtable&&ge.airtable.mobile&&(0,f.jsxs)(F,{color:"#2d7ff9",children:[(0,f.jsx)("div",{className:"source-label",children:"Airtable"}),(0,f.jsx)("div",{className:"source-value",children:ge.airtable.mobile})]})]})]}),(0,f.jsxs)(E,{children:[(0,f.jsxs)(S,{children:[(0,f.jsx)(c.pHD,{})," Email Address"]}),(0,f.jsxs)(N,{children:[(0,f.jsx)(I,{type:"email",value:he.email||"",onChange:e=>_e("email",e.target.value),placeholder:"Enter email address"}),ye.hubspot&&ge.hubspot.email&&(0,f.jsxs)(F,{color:"#ff7a59",children:[(0,f.jsx)("div",{className:"source-label",children:"HubSpot"}),(0,f.jsx)("div",{className:"source-value",children:ge.hubspot.email})]}),ye.supabase&&ge.supabase.email&&(0,f.jsxs)(F,{color:"#3ecf8e",children:[(0,f.jsx)("div",{className:"source-label",children:"Old Supabase"}),(0,f.jsx)("div",{className:"source-value",children:ge.supabase.email})]})]})]})]}),(0,f.jsxs)("div",{children:[(0,f.jsxs)(E,{children:[(0,f.jsxs)(S,{children:[(0,f.jsx)(c.HzC,{})," City"]}),(0,f.jsx)(N,{children:(0,f.jsxs)(M,{value:(null===(t=he.city)||void 0===t?void 0:t.id)||"",onChange:e=>{const t=e.target.value;_e("city",t?{id:t,name:e.target.options[e.target.selectedIndex].text}:null)},children:[(0,f.jsx)("option",{value:"",children:"Select a city"}),(0,f.jsx)("option",{value:"1",children:"New York"}),(0,f.jsx)("option",{value:"2",children:"San Francisco"}),(0,f.jsx)("option",{value:"3",children:"London"}),(0,f.jsx)("option",{value:"4",children:"Berlin"}),(0,f.jsx)("option",{value:"5",children:"Paris"}),(0,f.jsx)("option",{value:"6",children:"Tokyo"})]})})]}),(0,f.jsxs)(E,{children:[(0,f.jsxs)(S,{children:[(0,f.jsx)(c.cnX,{})," Tags"]}),(0,f.jsxs)(N,{children:[(0,f.jsx)(I,{type:"text",placeholder:"Type a tag and press Enter",onKeyDown:e=>{if("Enter"===e.key&&e.target.value.trim()){const t={id:Date.now().toString(),name:e.target.value.trim()};_e("tags",[...he.tags,t]),e.target.value=""}}}),(0,f.jsx)(G,{children:he.tags.map((e=>(0,f.jsxs)(z,{children:[e.name,(0,f.jsx)(c.yGN,{className:"remove",size:14,onClick:()=>_e("tags",he.tags.filter((t=>t.id!==e.id)))})]},e.id)))}),ye.hubspot&&(null===(o=ge.hubspot.tags)||void 0===o?void 0:o.length)>0&&(0,f.jsxs)(F,{color:"#ff7a59",children:[(0,f.jsx)("div",{className:"source-label",children:"HubSpot Tags"}),(0,f.jsx)("div",{className:"source-value",children:ge.hubspot.tags.join(", ")})]}),ye.airtable&&(null===(r=ge.airtable.tags)||void 0===r?void 0:r.length)>0&&(0,f.jsxs)(F,{color:"#2d7ff9",children:[(0,f.jsx)("div",{className:"source-label",children:"Airtable Tags"}),(0,f.jsx)("div",{className:"source-value",children:ge.airtable.tags.join(", ")})]})]})]}),(0,f.jsxs)(E,{children:[(0,f.jsxs)(S,{children:[(0,f.jsx)(c.mEP,{})," Notes"]}),(0,f.jsxs)(N,{children:[(0,f.jsx)(L,{value:he.notes||"",onChange:e=>_e("notes",e.target.value),placeholder:"Enter notes about this contact"}),ye.hubspot&&ge.hubspot.notes&&(0,f.jsxs)(F,{color:"#ff7a59",children:[(0,f.jsx)("div",{className:"source-label",children:"HubSpot"}),(0,f.jsx)("div",{className:"source-value",children:ge.hubspot.notes})]}),ye.supabase&&ge.supabase.notes&&(0,f.jsxs)(F,{color:"#3ecf8e",children:[(0,f.jsx)("div",{className:"source-label",children:"Old Supabase"}),(0,f.jsx)("div",{className:"source-value",children:ge.supabase.notes})]}),ye.airtable&&ge.airtable.notes&&(0,f.jsxs)(F,{color:"#2d7ff9",children:[(0,f.jsx)("div",{className:"source-label",children:"Airtable"}),(0,f.jsx)("div",{className:"source-value",children:ge.airtable.notes})]})]})]})]})]}),(0,f.jsxs)(B,{children:[(0,f.jsx)(W,{onClick:()=>ee(2),disabled:te,children:"Back"}),(0,f.jsxs)($,{onClick:xe,disabled:te,children:["Next ",(0,f.jsx)(c.dyV,{})]})]})]}),4===Z&&(0,f.jsxs)(C,{children:[(0,f.jsxs)(_,{children:[(0,f.jsx)(c.qYx,{})," Professional Information"]}),(0,f.jsxs)(E,{children:[(0,f.jsxs)(S,{children:[(0,f.jsx)(c.ayE,{})," LinkedIn Profile"]}),(0,f.jsxs)(N,{children:[(0,f.jsx)(I,{type:"text",value:he.linkedIn||"",onChange:e=>_e("linkedIn",e.target.value),placeholder:"Enter LinkedIn URL"}),ye.hubspot&&ge.hubspot.linkedIn&&(0,f.jsxs)(F,{color:"#ff7a59",children:[(0,f.jsx)("div",{className:"source-label",children:"HubSpot"}),(0,f.jsx)("div",{className:"source-value",children:ge.hubspot.linkedIn})]})]})]}),(0,f.jsxs)(E,{children:[(0,f.jsxs)(S,{children:[(0,f.jsx)(c.qYx,{})," Company Association"]}),(0,f.jsxs)(N,{children:[(0,f.jsxs)(M,{value:(null===(i=he.company)||void 0===i?void 0:i.id)||"",onChange:e=>{const t=e.target.value;_e("company",t?{id:t,name:e.target.options[e.target.selectedIndex].text}:null)},children:[(0,f.jsx)("option",{value:"",children:"Select a company"}),(0,f.jsx)("option",{value:"1",children:"Acme Corp"}),(0,f.jsx)("option",{value:"2",children:"Stark Industries"}),(0,f.jsx)("option",{value:"3",children:"Wayne Enterprises"}),(0,f.jsx)("option",{value:"4",children:"Hooli"}),(0,f.jsx)("option",{value:"5",children:"Pied Piper"})]}),ye.hubspot&&ge.hubspot.company&&(0,f.jsxs)(F,{color:"#ff7a59",children:[(0,f.jsx)("div",{className:"source-label",children:"HubSpot"}),(0,f.jsx)("div",{className:"source-value",children:ge.hubspot.company.name})]})]})]}),(0,f.jsxs)(E,{children:[(0,f.jsxs)(S,{children:[(0,f.jsx)(c.qYx,{})," Deal Information"]}),(0,f.jsx)(N,{children:(0,f.jsx)(L,{value:he.dealInfo||"",onChange:e=>_e("dealInfo",e.target.value),placeholder:"Enter any deal-related information"})})]}),(0,f.jsxs)(B,{children:[(0,f.jsx)(W,{onClick:()=>ee(3),disabled:te,children:"Back"}),(0,f.jsxs)($,{onClick:Se,disabled:te,children:[(0,f.jsx)(c.YrT,{})," Add to CRM"]})]})]})]})]})]})},Z=a.Ay.div`
  padding: 10px 0 0 0; /* Add just a bit of top padding */
  min-height: 100vh; /* Full viewport height */
  height: auto;
  display: flex;
  flex-direction: column;
  width: 100%;
  
  .clickable-cell {
    cursor: default;
  }
  
  .name-cell-clickable {
    cursor: pointer;
  }
  
  .ag-row {
    cursor: default;
  }
  
  .action-cell-no-click {
    z-index: 5;
    overflow: visible !important;
  }
  
  .ag-cell {
    overflow: visible;
  }
  
  .frequency-dropdown-container {
    position: relative;
    z-index: 1000;
  }
  
  .frequency-dropdown-menu {
    z-index: 9999;
  }
`,ee=(a.Ay.h1`
  color: #00ff00;
  margin-bottom: 20px;
  font-family: 'Courier New', monospace;
`,a.Ay.div`
  color: #ff3333;
  background-color: #330000;
  padding: 15px;
  border-radius: 4px;
  margin-bottom: 20px;
`),te=a.Ay.div`
  color: #00ff00;
  text-align: center;
  padding: 40px;
  font-family: monospace;
  display: flex;
  flex-direction: column;
  align-items: center;
  justify-content: center;
  height: 400px;
`,oe=a.Ay.div`
  width: 300px;
  height: 8px;
  background-color: #111;
  margin: 20px 0;
  border-radius: 4px;
  overflow: hidden;
  position: relative;
  box-shadow: 0 0 10px rgba(0, 255, 0, 0.2);
  
  &:before {
    content: "";
    position: absolute;
    top: 0;
    left: 0;
    height: 100%;
    width: 30%;
    background-color: #00ff00;
    animation: pulse 1.5s ease-in-out infinite;
    box-shadow: 0 0 20px #00ff00;
    border-radius: 4px;
  }
  
  @keyframes pulse {
    0% {
      left: -30%;
      opacity: 0.8;
    }
    100% {
      left: 100%;
      opacity: 0.2;
    }
  }
`,ne=a.Ay.div`
  margin-top: 15px;
  color: #00ff00;
  text-shadow: 0 0 5px rgba(0, 255, 0, 0.5);
  letter-spacing: 1px;
  font-size: 16px;
  opacity: 0.9;
  animation: blink 1.5s ease-in-out infinite alternate;
  
  @keyframes blink {
    from { opacity: 0.6; }
    to { opacity: 1; }
  }
`,re=a.Ay.div`
  font-family: 'Courier New', monospace;
  font-size: 14px;
  color: #00ff00;
  text-align: center;
  margin-top: 30px;
  height: 100px;
  width: 300px;
  overflow: hidden;
  position: relative;
  
  &:after {
    content: "01001100 01101111 01100001 01100100 01101001 01101110 01100111 00100000 01000011 01101111 01101110 01110100 01100001 01100011 01110100 01110011 00101110 00101110 00101110";
    position: absolute;
    top: 0;
    left: 0;
    height: 100%;
    width: 100%;
    background: linear-gradient(to bottom, transparent, #000 80%);
    display: flex;
    flex-wrap: wrap;
    justify-content: center;
    opacity: 0.7;
    text-shadow: 0 0 5px #00ff00;
    animation: matrix 5s linear infinite;
  }
  
  @keyframes matrix {
    0% { transform: translateY(-60px); }
    100% { transform: translateY(60px); }
  }
`,ie=(a.Ay.span`
  display: inline-block;
  background-color: ${e=>e.bg||"#222"};
  color: ${e=>e.color||"#00ff00"};
  border: 1px solid ${e=>e.borderColor||"#00ff00"};
  padding: 2px 6px;
  margin-right: 3px;
  border-radius: 4px;
  font-size: 11px;
`,a.Ay.button`
  background-color: ${e=>e.bg||"#222"};
  color: ${e=>e.color||"#00ff00"};
  border: 1px solid ${e=>e.borderColor||"#00ff00"};
  padding: 6px 10px;
  margin: 0 4px;
  border-radius: 4px;
  font-size: 0.75rem;
  display: inline-flex;
  align-items: center;
  gap: 4px;
  cursor: pointer;
  transition: all 0.2s;
  
  &:hover {
    opacity: 0.8;
    background-color: ${e=>e.hoverBg||"#333"};
  }
`,a.Ay.div`
  display: flex;
  justify-content: space-between;
  align-items: center;
  padding-bottom: 15px;
  margin-bottom: 20px;
  border-bottom: 1px solid #333;

  h2 {
    color: #00ff00;
    margin: 0;
    font-size: 1.2rem;
    font-family: 'Courier New', monospace;
  }
`),ae=a.Ay.button`
  background: none;
  border: none;
  color: #ff5555;
  font-size: 1.2rem;
  cursor: pointer;
  display: flex;
  align-items: center;
  justify-content: center;
  
  &:hover {
    color: #ff0000;
  }
`,se=a.Ay.div`
  margin-bottom: 20px;
  color: #cccccc;
  font-size: 0.9rem;
`,le=(a.Ay.div`
  background-color: #1a1a1a;
  padding: 10px 15px;
  border-radius: 4px;
  margin-bottom: 20px;
  border: 1px solid #333;
`,a.Ay.div`
  font-size: 0.85rem;
  color: #00ff00;
  margin-bottom: 10px;
  font-weight: bold;
  display: flex;
  align-items: center;
  gap: 6px;
  
  svg {
    font-size: 16px;
  }
`,a.Ay.div`
  margin-bottom: 25px;
`),ce=a.Ay.div`
  display: grid;
  grid-template-columns: repeat(3, 1fr);
  gap: 10px;
  margin-top: 10px;
  
  @media (max-width: 768px) {
    grid-template-columns: repeat(2, 1fr);
  }
  
  @media (max-width: 480px) {
    grid-template-columns: 1fr;
  }
`,de=a.Ay.div`
  display: flex;
  align-items: center;
  color: #cccccc;
`,ue=a.Ay.input`
  margin-right: 8px;
  cursor: pointer;
  width: 16px;
  height: 16px;
  appearance: none;
  border: 1px solid #00ff00;
  background: #222;
  border-radius: 3px;
  position: relative;
  
  &:checked {
    background: #00ff00;
    
    &:after {
      content: '';
      position: absolute;
      left: 5px;
      top: 2px;
      width: 4px;
      height: 8px;
      border: solid #000;
      border-width: 0 2px 2px 0;
      transform: rotate(45deg);
    }
  }
`,pe=a.Ay.div`
  background-color: #1a1a1a;
  padding: 15px;
  border-radius: 4px;
  margin-bottom: 20px;
  border: 1px solid #333;
`,he=a.Ay.div`
  margin-bottom: 10px;
  
  &:last-child {
    margin-bottom: 0;
  }
`,fe=a.Ay.span`
  color: #999;
  margin-right: 10px;
  font-size: 0.8rem;
`,ge=a.Ay.span`
  color: #cccccc;
  font-weight: normal;
`,me=(a.Ay.div`
  display: flex;
  align-items: center;
  gap: 10px;
  background-color: rgba(255, 85, 85, 0.2);
  border: 1px solid #ff5555;
  color: #ff9999;
  padding: 10px 15px;
  border-radius: 4px;
  margin-bottom: 20px;
  
  svg {
    color: #ff5555;
    font-size: 1.2rem;
    flex-shrink: 0;
  }
`,a.Ay.div`
  display: flex;
  justify-content: flex-end;
  gap: 15px;
  margin-top: 30px;
`),ye=a.Ay.button`
  background-color: #ff5555;
  color: white;
  border: none;
  padding: 10px 20px;
  border-radius: 4px;
  font-weight: bold;
  cursor: pointer;
  display: flex;
  align-items: center;
  gap: 8px;
  
  &:hover {
    background-color: #ff3333;
  }
  
  &:disabled {
    background-color: #772727;
    cursor: not-allowed;
    opacity: 0.7;
  }
`,ve=a.Ay.button`
  background-color: transparent;
  color: #cccccc;
  border: 1px solid #555;
  padding: 10px 20px;
  border-radius: 4px;
  cursor: pointer;
  display: flex;
  align-items: center;
  gap: 8px;
  
  &:hover {
    background-color: #333;
  }
`,be=e=>{let{isOpen:t,position:o,options:i,onSelect:a,onClose:s}=e;if(n.useEffect((()=>{if(!t)return;const e=e=>{setTimeout((()=>{s()}),100)};return document.addEventListener("mouseup",e),()=>{document.removeEventListener("mouseup",e)}}),[t,s]),!t)return null;const l={position:"fixed",top:`${o.top}px`,left:`${o.left}px`,backgroundColor:"#222",border:"1px solid #00ff00",borderRadius:"4px",width:"180px",zIndex:99999,boxShadow:"0 2px 8px rgba(0, 0, 0, 0.5)",maxHeight:"300px",overflowY:"auto"};return r.createPortal((0,f.jsx)("div",{className:"frequency-dropdown-menu",style:l,onMouseDown:e=>(e.stopPropagation(),e.preventDefault(),e.nativeEvent.stopImmediatePropagation(),!1),onClick:e=>(e.stopPropagation(),e.preventDefault(),e.nativeEvent.stopImmediatePropagation(),!1),children:i.map((e=>(0,f.jsx)("div",{onMouseDown:t=>{t.stopPropagation(),t.preventDefault(),setTimeout((()=>{a(e)}),50)},style:{padding:"8px 12px",cursor:"pointer",borderBottom:"1px solid #333",transition:"background-color 0.2s",color:"#e0e0e0",fontSize:"0.8rem",textAlign:"left"},onMouseOver:e=>e.currentTarget.style.backgroundColor="#333",onMouseOut:e=>e.currentTarget.style.backgroundColor="#222",children:e},e)))}),document.body)},xe=e=>{const[t,o]=(0,n.useState)(!1),[r,i]=(0,n.useState)({top:0,left:0}),[a,s]=(0,n.useState)(null),[l,c]=(0,n.useState)(!1),d=n.useRef(null);return(0,f.jsxs)(f.Fragment,{children:[(0,f.jsx)("div",{className:"frequency-dropdown-container",style:{display:"flex",justifyContent:"center",alignItems:"center",height:"100%",width:"100%",padding:"8px 0 0 0",margin:0,boxSizing:"border-box"},onClick:e=>{e.stopPropagation(),e.preventDefault()},children:(0,f.jsx)("div",{ref:d,onClick:e=>{if(e.stopPropagation(),e.preventDefault(),e.nativeEvent.stopImmediatePropagation(),!l){if(d.current){const e=d.current.getBoundingClientRect();i({top:e.bottom+window.scrollY,left:e.left+window.scrollX})}o(!t)}},style:{backgroundColor:"#222",color:"#00ff00",border:"1px solid #00ff00",padding:"4px 8px",borderRadius:"4px",fontSize:"0.75rem",display:"inline-flex",alignItems:"center",justifyContent:"center",gap:"4px",cursor:l?"wait":"pointer",transition:"all 0.2s",width:"auto",whiteSpace:"nowrap",height:"24px",lineHeight:"1",boxSizing:"border-box",opacity:l?.7:1},children:l?(0,f.jsx)(f.Fragment,{children:"Setting..."}):a?(0,f.jsx)(f.Fragment,{children:a}):(0,f.jsxs)(f.Fragment,{children:["SET KEEP IN TOUCH ",t?"\u25b2":"\u25bc"]})})}),(0,f.jsx)(be,{isOpen:t,position:r,options:["Weekly","Monthly","Quarterly","Twice per Year","Once per Year","Do not keep in touch","Not Set"],onSelect:async t=>{try{c(!0),s(t),o(!1),e.onSetFrequency&&await e.onSetFrequency(e.data,t),c(!1)}catch(n){console.error("Error setting frequency:",n),c(!1)}},onClose:()=>o(!1)})]})};u().setAppElement("#root");const we=()=>{const[e,t]=(0,n.useState)([]),[o,r]=(0,n.useState)(!0),[a,d]=(0,n.useState)(null),[p,h]=(0,n.useState)(null),[g,m]=(0,n.useState)(!1),[y,v]=(0,n.useState)(!1),[b,x]=(0,n.useState)(!1),[w,C]=(0,n.useState)(null),[_,S]=(0,n.useState)(!1),[E,k]=(0,n.useState)(null),[j,A]=(0,n.useState)({chatCount:0,contactChatsCount:0,interactionsCount:0,emailsCount:0,emailParticipantsCount:0,emailThreadsCount:0,tagsCount:0,citiesCount:0,companiesCount:0,notesCount:0,attachmentsCount:0,contactEmailsCount:0,contactMobilesCount:0,dealsCount:0,meetingsCount:0,investmentsCount:0,kitCount:0,lastInteraction:null}),[R,O]=(0,n.useState)({deleteChat:!0,deleteContactChats:!0,deleteInteractions:!0,deleteEmails:!0,deleteEmailParticipants:!0,deleteEmailThreads:!0,deleteTags:!0,deleteCities:!0,deleteCompanies:!0,deleteNotes:!0,deleteAttachments:!0,deleteContactEmails:!0,deleteContactMobiles:!0,deleteDeals:!0,deleteMeetings:!0,deleteInvestments:!0,deleteKit:!0,addToSpam:!0}),[T,D]=(0,n.useState)(!1),P=((0,i.Zp)(),e=>{const{name:t,checked:o}=e.target;O((e=>({...e,[t]:o})))}),N=async(e,o)=>{try{console.log(`Setting frequency to ${o} for contact ${e.contact_id}`);const{error:n}=await s.supabase.from("contacts").update({keep_in_touch_frequency:o}).eq("contact_id",e.contact_id);if(n)throw n;t((t=>t.filter((t=>t.contact_id!==e.contact_id)))),console.log(`Successfully set frequency to ${o} for contact ${e.contact_id}`)}catch(n){console.error("Error setting frequency:",n),d(`Failed to set frequency: ${n.message||"Unknown error"}`)}},I=e=>{if(!e.data)return"";return`${e.data.first_name||""} ${e.data.last_name||""}`.trim()||"(No name)"},M=e=>{const t=(0,i.Zp)(),o=e.valueFormatted||e.value||"";return(0,f.jsx)("div",{className:"name-link",style:{color:"#00ff00",cursor:"pointer",textDecoration:"underline"},onClick:o=>{o.stopPropagation(),e.data&&e.data.contact_id&&t(`/contacts/workflow/${e.data.contact_id}`)},children:o})},L=(0,n.useMemo)((()=>[{headerName:"Name",field:"name",valueGetter:I,minWidth:170,width:170,filter:"agTextColumnFilter",floatingFilter:!1,sortable:!0,pinned:"left",cellClass:"name-cell-clickable",cellRenderer:M},{headerName:"Company",field:"company",valueGetter:e=>{var t;if(null===(t=e.data)||void 0===t||!t.companies||0===e.data.companies.length)return"-";const o=e.data.companies.find((e=>e.is_primary))||e.data.companies[0];return(null===o||void 0===o?void 0:o.name)||"-"},minWidth:170,width:170,filter:"agTextColumnFilter",floatingFilter:!1,sortable:!0,cellRenderer:e=>{const t=e.value||"-";return"-"===t?t:(0,f.jsx)("span",{style:{color:"#ffffff"},children:t})}},{headerName:"Job Title",field:"job_role",valueGetter:e=>e.data&&e.data.job_role||"-",minWidth:170,width:170,filter:"agTextColumnFilter",floatingFilter:!1,sortable:!0,cellRenderer:e=>{const t=e.value||"-";return"-"===t?t:(0,f.jsx)("span",{style:{color:"#cccccc"},children:t})}},{headerName:"Category",field:"category",valueGetter:e=>e.data?e.data.category||e.data.contact_category||"-":"",minWidth:120,width:120,filter:"agTextColumnFilter",floatingFilter:!1,sortable:!0},{headerName:"Rating",field:"score",valueGetter:e=>e.data&&null!==e.data.score&&void 0!==e.data.score?e.data.score:"-",minWidth:140,width:140,filter:"agNumberColumnFilter",floatingFilter:!1,sortable:!0,cellRenderer:e=>{const t=e.value;if("-"===t)return t;const o=parseInt(t),n=Math.min(Math.max(o,0),5);let r="#cccccc";return o>=4?r="#55ff55":o>=3?r="#ffff55":o>0&&(r="#ff5555"),(0,f.jsx)("div",{style:{display:"flex",justifyContent:"center"},children:[...Array(5)].map(((e,t)=>(0,f.jsx)("span",{style:{color:t<n?r:"#333333",marginRight:"4px",fontSize:"18px"},children:"\u2605"},t)))})}},{headerName:"Actions",width:200,minWidth:200,field:"actions",cellRenderer:e=>(0,f.jsx)("div",{style:{display:"flex",justifyContent:"center",alignItems:"center"},children:(0,f.jsx)(xe,{...e,onSetFrequency:N})}),sortable:!1,filter:!1,suppressSizeToFit:!0,cellClass:"action-cell-no-click",cellStyle:{overflow:"visible"}}]),[N]),F=(0,n.useMemo)((()=>({resizable:!0,cellClass:"clickable-cell"})),[]),G=n.useCallback((e=>{console.log("Grid is ready"),h(e.api),setTimeout((()=>{e.api.sizeColumnsToFit()}),0)}),[]),z=n.useCallback((e=>{e.data&&e.data.contact_id&&console.log("Row clicked, but no action taken",e.data)}),[]),H=async()=>{try{r(!0),d(null);const o=async function(e){let t,o=arguments.length>1&&void 0!==arguments[1]?arguments[1]:3,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1e3;for(let i=0;i<o;i++)try{return await e()}catch(r){console.log(`Attempt ${i+1} failed, retrying in ${n}ms...`,r),t=r,await new Promise((e=>setTimeout(e,n))),n*=1.5}throw t},n=["Professional Investor","Team","Advisor","Supplier","Founder","Manager","Institution","Media","Friend and Family"],{count:i,error:a}=await o((async()=>s.supabase.from("contacts").select("*",{count:"exact",head:!0}).in("category",n).or("keep_in_touch_frequency.is.null,keep_in_touch_frequency.eq.Not Set")));if(a)throw a;console.log(`Total contacts to set keep in touch frequency: ${i}`);const l=async(e,t)=>(console.log(`Fetching batch from ${e} to ${t}`),o((async()=>s.supabase.from("contacts").select("\n              contact_id, \n              first_name, \n              last_name, \n              category,\n              keep_in_touch_frequency,\n              score, \n              job_role,\n              last_interaction_at,\n              created_at\n            ").in("category",n).or("keep_in_touch_frequency.is.null,keep_in_touch_frequency.eq.Not Set").not("last_interaction_at","is",null).order("last_interaction_at",{ascending:!1}).range(e,t))));let c=[];const u=500;let p=0,h=0;const f=Math.min(i,4e3);for(let t=0;t<f;t+=u)try{r(`Loading contacts... ${Math.min(t+u,i)}/${i}`);const{data:e,error:o}=await l(t,t+u-1);if(o){if(console.error(`Error fetching contacts batch from ${t} to ${t+u-1}:`,o),h++,h>3)throw new Error(`Too many failed batches (${h}). Last error: ${o.message}`);continue}e&&e.length>0&&(c=[...c,...e],p+=e.length)}catch(e){if(console.error(`Error in batch fetch loop at index ${t}:`,e),0===p)throw e;break}console.log(`Successfully fetched ${p} contacts in ${Math.ceil(p/u)} batches with ${h} failed batches`);const g=c;if(!g||0===g.length)return t([]),r(!1),m(!0),void v(!0);const y=g.map((e=>e.contact_id)).filter(Boolean);if(0===y.length)return t(g),r(!1),m(!0),void v(!0);r("Loading related data (companies, tags, cities)...");const b=async function(t,o,n){let i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:100;console.log(`Fetching ${t} data for ${n.length} contacts in batches of ${i}`);let a=[];for(let s=0;s<n.length;s+=i){const l=n.slice(s,s+i);try{const{data:e,error:c}=await o.in("contact_id",l);if(c)throw c;a=[...a,...e||[]],r(`Loading ${t} data... ${Math.min(s+i,n.length)}/${n.length}`)}catch(e){console.error(`Error fetching batch of ${t} data:`,e)}}return{data:a}},x=async function(t,o,n,i,a){let l=arguments.length>5&&void 0!==arguments[5]?arguments[5]:100;console.log(`Fetching ${t} details for ${i.length} entities in batches of ${l}`);let c=[];for(let d=0;d<i.length;d+=l){const u=i.slice(d,d+l);try{const{data:e,error:p}=await s.supabase.from(o).select(a).in(n,u);if(p)throw p;c=[...c,...e||[]],r(`Loading ${t} details... ${Math.min(d+l,i.length)}/${i.length}`)}catch(e){console.error(`Error fetching batch of ${t} details:`,e)}}return{data:c}};try{const[e,o,n,i,a]=await Promise.all([b("companies",s.supabase.from("contact_companies").select("contact_id, company_id, is_primary"),y),b("tags",s.supabase.from("contact_tags").select("contact_id, tag_id"),y),b("cities",s.supabase.from("contact_cities").select("contact_id, city_id"),y),b("emails",s.supabase.from("contact_emails").select("contact_id, email, is_primary"),y),b("mobiles",s.supabase.from("contact_mobiles").select("contact_id, mobile, is_primary"),y)]),l=[...new Set((e.data||[]).map((e=>e.company_id)).filter(Boolean))],c=[...new Set((o.data||[]).map((e=>e.tag_id)).filter(Boolean))],d=[...new Set((n.data||[]).map((e=>e.city_id)).filter(Boolean))];r("Loading details for related data...");const[u,p,h]=await Promise.all([l.length>0?x("companies","companies","company_id",l,"company_id, name, website"):{data:[]},c.length>0?x("tags","tags","tag_id",c,"tag_id, name"):{data:[]},d.length>0?x("cities","cities","city_id",d,"city_id, name"):{data:[]}]);r("Processing data and preparing contacts...");const f=g.map(((t,s)=>{var l,c;if(!t||!t.contact_id)return console.warn("Skipping invalid contact:",t),null;s>0&&s%1e3===0&&r(`Processing contacts... ${s}/${g.length}`);const d=(e.data||[]).filter((e=>(null===e||void 0===e?void 0:e.contact_id)===t.contact_id)),f=(o.data||[]).filter((e=>(null===e||void 0===e?void 0:e.contact_id)===t.contact_id)),m=(n.data||[]).filter((e=>(null===e||void 0===e?void 0:e.contact_id)===t.contact_id)),y=(i.data||[]).filter((e=>(null===e||void 0===e?void 0:e.contact_id)===t.contact_id)),v=(a.data||[]).filter((e=>(null===e||void 0===e?void 0:e.contact_id)===t.contact_id)),b=y.find((e=>null===e||void 0===e?void 0:e.is_primary)),x=(null===b||void 0===b?void 0:b.email)||(y.length>0?null===(l=y[0])||void 0===l?void 0:l.email:null),w=v.find((e=>null===e||void 0===e?void 0:e.is_primary)),C=(null===w||void 0===w?void 0:w.mobile)||(v.length>0?null===(c=v[0])||void 0===c?void 0:c.mobile:null),_=d.map((e=>{var t;if(null===e||void 0===e||!e.company_id)return null;const o=null===(t=u.data)||void 0===t?void 0:t.find((t=>(null===t||void 0===t?void 0:t.company_id)===e.company_id));return o?{id:o.company_id,name:o.name||"Unknown",website:o.website,is_primary:e.is_primary}:null})).filter(Boolean),S=f.map((e=>{var t;if(null===e||void 0===e||!e.tag_id)return null;const o=null===(t=p.data)||void 0===t?void 0:t.find((t=>(null===t||void 0===t?void 0:t.tag_id)===e.tag_id));return o?{id:o.tag_id,name:o.name||"Unknown Tag"}:null})).filter(Boolean),E=m.map((e=>{var t;if(null===e||void 0===e||!e.city_id)return null;const o=null===(t=h.data)||void 0===t?void 0:t.find((t=>(null===t||void 0===t?void 0:t.city_id)===e.city_id));return o?{id:o.city_id,name:o.name||"Unknown Location"}:null})).filter(Boolean);return{...t,id:t.contact_id,email:x||null,mobile:C||null,companies:_||[],tags:S||[],cities:E||[]}})).filter(Boolean);console.log(`Successfully processed ${f.length} contacts out of ${g.length} total`),t(f),r(!1),m(!0),setTimeout((()=>{v(!0)}),800)}catch(e){console.error("Error loading related data:",e);const o=g.map((e=>({...e,id:e.contact_id,companies:[],tags:[],cities:[]})));t(o),r(!1),m(!0),setTimeout((()=>{v(!0)}),800)}}catch(e){console.error("Error fetching contacts:",e),d(e.message),r(!1)}};return(0,n.useEffect)((()=>{g||(console.log("Initiating data fetch"),H())}),[g]),(0,n.useEffect)((()=>{if(!p)return;const e=()=>{p.sizeColumnsToFit()};return window.addEventListener("resize",e,{passive:!0}),()=>{window.removeEventListener("resize",e,{passive:!0})}}),[p]),(0,f.jsxs)(Z,{children:[a&&(0,f.jsxs)(ee,{children:["Error: ",a]}),!1!==o?(0,f.jsxs)(te,{children:[(0,f.jsx)(ne,{children:"string"===typeof o?o.replace(/Loading .+ \d+\/\d+/,"Initializing Matrix"):"Accessing Contact Database..."}),(0,f.jsx)(oe,{}),(0,f.jsx)(re,{})]}):y||a?0!==e.length||a?(0,f.jsx)("div",{className:"ag-theme-alpine",style:{height:"calc(100vh - 120px)",width:"calc(100% - 30px)",overflow:"auto",margin:"15px 15px 0 15px",marginTop:"30px",opacity:y?1:0,transition:"opacity 0.5s ease-in-out","--ag-background-color":"#121212","--ag-odd-row-background-color":"#1a1a1a","--ag-header-background-color":"#222222","--ag-header-foreground-color":"#00ff00","--ag-foreground-color":"#e0e0e0","--ag-row-hover-color":"#2a2a2a","--ag-border-color":"#333333"},children:(0,f.jsx)(l.W,{rowData:e,columnDefs:L,defaultColDef:F,onGridReady:G,onRowClicked:z,rowSelection:"single",animateRows:!0,pagination:!0,paginationPageSize:100,suppressCellFocus:!0,enableCellTextSelection:!0,rowHeight:42,domLayout:"autoHeight",paginationAutoPageSize:!0,sortingOrder:["asc","desc",null],sortModel:[{colId:"last_interaction_at",sort:"asc"}]})}):(0,f.jsxs)("div",{style:{padding:"40px",textAlign:"center",color:"#00ff00",background:"#121212",borderRadius:"8px",fontSize:"24px",fontWeight:"bold",display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",height:"300px"},children:[(0,f.jsx)("div",{style:{marginBottom:"15px"},children:"All records processed \ud83d\ude0a"}),(0,f.jsx)("div",{style:{fontSize:"48px",marginBottom:"20px"},children:"\u2713"})]}):(0,f.jsxs)(te,{children:[(0,f.jsx)(ne,{children:"Preparing interface..."}),(0,f.jsx)(oe,{}),(0,f.jsx)(re,{})]}),(0,f.jsx)(Q,{isOpen:_,onClose:()=>S(!1),contact:E,onComplete:(e,t)=>{H(),S(!1),k(null)}}),(0,f.jsxs)(u(),{isOpen:b,onRequestClose:()=>x(!1),shouldCloseOnOverlayClick:!1,style:{content:{top:"50%",left:"50%",right:"auto",bottom:"auto",marginRight:"-50%",transform:"translate(-50%, -50%)",padding:"25px",maxWidth:"600px",width:"90%",backgroundColor:"#121212",border:"1px solid #333",borderRadius:"8px",boxShadow:"0 4px 20px rgba(0, 0, 0, 0.6)",color:"#e0e0e0",zIndex:1001},overlay:{backgroundColor:"rgba(0, 0, 0, 0.75)",zIndex:1e3}},children:[(0,f.jsxs)(ie,{children:[(0,f.jsx)("h2",{children:"Delete Contact and Associated Data"}),(0,f.jsx)(ae,{onClick:()=>x(!1),disabled:T,children:(0,f.jsx)(c.yGN,{})})]}),w&&(0,f.jsxs)(f.Fragment,{children:[(0,f.jsx)(pe,{children:(0,f.jsx)(he,{children:(0,f.jsxs)(ge,{children:[w.first_name," ",w.last_name,w.email?` (${w.email})`:w.mobile?` (${w.mobile})`:""]})})}),(0,f.jsxs)(he,{style:{marginTop:"15px",marginBottom:"15px"},children:[(0,f.jsx)(fe,{children:"Last Interaction:"}),(0,f.jsx)(ge,{children:j.lastInteraction?j.lastInteraction.summary:"None"})]}),(0,f.jsx)(se,{children:"Select which items to delete:"}),(0,f.jsx)(le,{children:(0,f.jsxs)(ce,{children:[j.interactionsCount>0&&(0,f.jsxs)(de,{children:[(0,f.jsx)(ue,{type:"checkbox",id:"deleteInteractions",name:"deleteInteractions",checked:R.deleteInteractions,onChange:P,disabled:T}),(0,f.jsxs)("label",{htmlFor:"deleteInteractions",children:["Interactions (",j.interactionsCount,")"]})]}),j.emailsCount>0&&(0,f.jsxs)(de,{children:[(0,f.jsx)(ue,{type:"checkbox",id:"deleteEmails",name:"deleteEmails",checked:R.deleteEmails,onChange:P,disabled:T}),(0,f.jsxs)("label",{htmlFor:"deleteEmails",children:["Emails (",j.emailsCount,")"]})]}),j.emailParticipantsCount>0&&(0,f.jsxs)(de,{children:[(0,f.jsx)(ue,{type:"checkbox",id:"deleteEmailParticipants",name:"deleteEmailParticipants",checked:R.deleteEmailParticipants,onChange:P,disabled:T}),(0,f.jsxs)("label",{htmlFor:"deleteEmailParticipants",children:["Email Participants (",j.emailParticipantsCount,")"]})]}),j.emailThreadsCount>0&&(0,f.jsxs)(de,{children:[(0,f.jsx)(ue,{type:"checkbox",id:"deleteEmailThreads",name:"deleteEmailThreads",checked:R.deleteEmailThreads,onChange:P,disabled:T}),(0,f.jsxs)("label",{htmlFor:"deleteEmailThreads",children:["Email Threads (",j.emailThreadsCount,")"]})]}),j.contactEmailsCount>0&&(0,f.jsxs)(de,{children:[(0,f.jsx)(ue,{type:"checkbox",id:"deleteContactEmails",name:"deleteContactEmails",checked:R.deleteContactEmails,onChange:P,disabled:T}),(0,f.jsxs)("label",{htmlFor:"deleteContactEmails",children:["Email Addresses (",j.contactEmailsCount,")"]})]}),j.contactMobilesCount>0&&(0,f.jsxs)(de,{children:[(0,f.jsx)(ue,{type:"checkbox",id:"deleteContactMobiles",name:"deleteContactMobiles",checked:R.deleteContactMobiles,onChange:P,disabled:T}),(0,f.jsxs)("label",{htmlFor:"deleteContactMobiles",children:["Mobile Numbers (",j.contactMobilesCount,")"]})]}),j.chatCount>0&&(0,f.jsxs)(de,{children:[(0,f.jsx)(ue,{type:"checkbox",id:"deleteChat",name:"deleteChat",checked:R.deleteChat,onChange:P,disabled:T}),(0,f.jsxs)("label",{htmlFor:"deleteChat",children:["Chat messages (",j.chatCount,")"]})]}),j.contactChatsCount>0&&(0,f.jsxs)(de,{children:[(0,f.jsx)(ue,{type:"checkbox",id:"deleteContactChats",name:"deleteContactChats",checked:R.deleteContactChats,onChange:P,disabled:T}),(0,f.jsxs)("label",{htmlFor:"deleteContactChats",children:["Chat Links (",j.contactChatsCount,")"]})]}),j.notesCount>0&&(0,f.jsxs)(de,{children:[(0,f.jsx)(ue,{type:"checkbox",id:"deleteNotes",name:"deleteNotes",checked:R.deleteNotes,onChange:P,disabled:T}),(0,f.jsxs)("label",{htmlFor:"deleteNotes",children:["Notes (",j.notesCount,")"]})]}),j.attachmentsCount>0&&(0,f.jsxs)(de,{children:[(0,f.jsx)(ue,{type:"checkbox",id:"deleteAttachments",name:"deleteAttachments",checked:R.deleteAttachments,onChange:P,disabled:T}),(0,f.jsxs)("label",{htmlFor:"deleteAttachments",children:["Attachments (",j.attachmentsCount,")"]})]}),j.tagsCount>0&&(0,f.jsxs)(de,{children:[(0,f.jsx)(ue,{type:"checkbox",id:"deleteTags",name:"deleteTags",checked:R.deleteTags,onChange:P,disabled:T}),(0,f.jsxs)("label",{htmlFor:"deleteTags",children:["Tags (",j.tagsCount,")"]})]}),j.citiesCount>0&&(0,f.jsxs)(de,{children:[(0,f.jsx)(ue,{type:"checkbox",id:"deleteCities",name:"deleteCities",checked:R.deleteCities,onChange:P,disabled:T}),(0,f.jsxs)("label",{htmlFor:"deleteCities",children:["Cities (",j.citiesCount,")"]})]}),j.companiesCount>0&&(0,f.jsxs)(de,{children:[(0,f.jsx)(ue,{type:"checkbox",id:"deleteCompanies",name:"deleteCompanies",checked:R.deleteCompanies,onChange:P,disabled:T}),(0,f.jsxs)("label",{htmlFor:"deleteCompanies",children:["Companies (",j.companiesCount,")"]})]}),j.dealsCount>0&&(0,f.jsxs)(de,{children:[(0,f.jsx)(ue,{type:"checkbox",id:"deleteDeals",name:"deleteDeals",checked:R.deleteDeals,onChange:P,disabled:T}),(0,f.jsxs)("label",{htmlFor:"deleteDeals",children:["Deals (",j.dealsCount,")"]})]}),j.meetingsCount>0&&(0,f.jsxs)(de,{children:[(0,f.jsx)(ue,{type:"checkbox",id:"deleteMeetings",name:"deleteMeetings",checked:R.deleteMeetings,onChange:P,disabled:T}),(0,f.jsxs)("label",{htmlFor:"deleteMeetings",children:["Meetings (",j.meetingsCount,")"]})]}),j.investmentsCount>0&&(0,f.jsxs)(de,{children:[(0,f.jsx)(ue,{type:"checkbox",id:"deleteInvestments",name:"deleteInvestments",checked:R.deleteInvestments,onChange:P,disabled:T}),(0,f.jsxs)("label",{htmlFor:"deleteInvestments",children:["Investments (",j.investmentsCount,")"]})]}),j.kitCount>0&&(0,f.jsxs)(de,{children:[(0,f.jsx)(ue,{type:"checkbox",id:"deleteKit",name:"deleteKit",checked:R.deleteKit,onChange:P,disabled:T}),(0,f.jsxs)("label",{htmlFor:"deleteKit",children:["Keep In Touch (",j.kitCount,")"]})]}),w.mobile&&j.whatsappCount>0&&(0,f.jsxs)(de,{children:[(0,f.jsx)(ue,{type:"checkbox",id:"deleteWhatsapp",name:"deleteWhatsapp",checked:R.deleteWhatsapp,onChange:P,disabled:T}),(0,f.jsxs)("label",{htmlFor:"deleteWhatsapp",children:["WhatsApp Data (",j.whatsappCount,")"]})]}),w.email&&(0,f.jsxs)(de,{children:[(0,f.jsx)(ue,{type:"checkbox",id:"addToSpam",name:"addToSpam",checked:R.addToSpam,onChange:P,disabled:T}),(0,f.jsx)("label",{htmlFor:"addToSpam",children:"Add email to spam list"})]})]})}),(0,f.jsxs)(me,{children:[(0,f.jsxs)(ve,{onClick:()=>x(!1),disabled:T,children:[(0,f.jsx)(c.yGN,{})," Cancel"]}),(0,f.jsx)(ye,{onClick:async()=>{if(w)try{if(D(!0),R.addToSpam&&w.email){const{error:e}=await s.supabase.from("emails_spam").insert([{email:w.email,counter:1}]);e&&console.error("Error adding to spam list:",e)}const e=[];if(R.deleteChat&&j.chatCount>0&&e.push(s.supabase.from("chat").delete().eq("contact_id",w.contact_id)),R.deleteInteractions&&j.interactionsCount>0&&e.push(s.supabase.from("interactions").delete().eq("contact_id",w.contact_id)),R.deleteEmails&&j.emailsCount>0){const{data:t}=await s.supabase.from("emails").select("email_id").eq("sender_contact_id",w.contact_id);if(t&&t.length>0){const o=t.map((e=>e.email_id));e.push(s.supabase.from("email_participants").delete().in("email_id",o)),e.push(s.supabase.from("emails").delete().eq("sender_contact_id",w.contact_id))}}R.deleteEmailThreads&&j.emailThreadsCount>0&&e.push(s.supabase.from("contact_email_threads").delete().eq("contact_id",w.contact_id)),R.deleteContactEmails&&j.contactEmailsCount>0&&e.push(s.supabase.from("contact_emails").delete().eq("contact_id",w.contact_id)),R.deleteContactMobiles&&j.contactMobilesCount>0&&e.push(s.supabase.from("contact_mobiles").delete().eq("contact_id",w.contact_id)),R.deleteNotes&&j.notesCount>0&&e.push(s.supabase.from("notes_contacts").delete().eq("contact_id",w.contact_id)),R.deleteAttachments&&j.attachmentsCount>0&&e.push(s.supabase.from("attachments").delete().eq("contact_id",w.contact_id)),R.deleteTags&&j.tagsCount>0&&e.push(s.supabase.from("contact_tags").delete().eq("contact_id",w.contact_id)),R.deleteCities&&j.citiesCount>0&&e.push(s.supabase.from("contact_cities").delete().eq("contact_id",w.contact_id)),R.deleteCompanies&&j.companiesCount>0&&e.push(s.supabase.from("contact_companies").delete().eq("contact_id",w.contact_id)),R.deleteContactChats&&j.contactChatsCount>0&&e.push(s.supabase.from("contact_chats").delete().eq("contact_id",w.contact_id)),R.deleteWhatsapp&&w.mobile&&j.whatsappCount>0&&e.push(s.supabase.from("whatsapp_inbox").delete().eq("contact_number",w.mobile)),R.deleteDeals&&j.dealsCount>0&&e.push(s.supabase.from("deals_contacts").delete().eq("contact_id",w.contact_id)),R.deleteMeetings&&j.meetingsCount>0&&e.push(s.supabase.from("meeting_contacts").delete().eq("contact_id",w.contact_id)),R.deleteInvestments&&j.investmentsCount>0&&e.push(s.supabase.from("investments_contacts").delete().eq("contact_id",w.contact_id)),R.deleteKit&&j.kitCount>0&&e.push(s.supabase.from("keep_in_touch").delete().eq("contact_id",w.contact_id)),await Promise.all(e);const{error:o}=await s.supabase.from("contacts").delete().eq("contact_id",w.contact_id);if(o)throw o;t((e=>e.filter((e=>e.contact_id!==w.contact_id)))),x(!1),C(null),D(!1)}catch(e){console.error("Error deleting contact:",e),d(`Failed to delete contact: ${e.message||"Unknown error"}`),D(!1)}},disabled:T,children:T?"Deleting...":(0,f.jsxs)(f.Fragment,{children:[(0,f.jsx)(c.IXo,{})," Delete Contact"]})})]})]})]})]})}},7324:e=>{e.exports=function(e,t,o,n){var r=o?o.call(n,e,t):void 0;if(void 0!==r)return!!r;if(e===t)return!0;if("object"!==typeof e||!e||"object"!==typeof t||!t)return!1;var i=Object.keys(e),a=Object.keys(t);if(i.length!==a.length)return!1;for(var s=Object.prototype.hasOwnProperty.bind(t),l=0;l<i.length;l++){var c=i[l];if(!s(c))return!1;var d=e[c],u=t[c];if(!1===(r=o?o.call(n,d,u,c):void 0)||void 0===r&&d!==u)return!1}return!0}},7355:(e,t,o)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=o(9724);t.default=function(e,t){n.useEffectOnce((function(){var o=t.current,n=o.parentElement;if(n){var r=document.createComment(e);return n.insertBefore(r,o),function(){n.removeChild(r)}}}))}},7374:function(e,t,o){"use strict";var n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const r=n(o(9286));class i extends r.default{select(e){let t=!1;const o=(null!==e&&void 0!==e?e:"*").split("").map((e=>/\s/.test(e)&&!t?"":('"'===e&&(t=!t),e))).join("");return this.url.searchParams.set("select",o),this.headers.Prefer&&(this.headers.Prefer+=","),this.headers.Prefer+="return=representation",this}order(e){let{ascending:t=!0,nullsFirst:o,foreignTable:n,referencedTable:r=n}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const i=r?`${r}.order`:"order",a=this.url.searchParams.get(i);return this.url.searchParams.set(i,`${a?`${a},`:""}${e}.${t?"asc":"desc"}${void 0===o?"":o?".nullsfirst":".nullslast"}`),this}limit(e){let{foreignTable:t,referencedTable:o=t}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const n="undefined"===typeof o?"limit":`${o}.limit`;return this.url.searchParams.set(n,`${e}`),this}range(e,t){let{foreignTable:o,referencedTable:n=o}=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};const r="undefined"===typeof n?"offset":`${n}.offset`,i="undefined"===typeof n?"limit":`${n}.limit`;return this.url.searchParams.set(r,`${e}`),this.url.searchParams.set(i,""+(t-e+1)),this}abortSignal(e){return this.signal=e,this}single(){return this.headers.Accept="application/vnd.pgrst.object+json",this}maybeSingle(){return"GET"===this.method?this.headers.Accept="application/json":this.headers.Accept="application/vnd.pgrst.object+json",this.isMaybeSingle=!0,this}csv(){return this.headers.Accept="text/csv",this}geojson(){return this.headers.Accept="application/geo+json",this}explain(){let{analyze:e=!1,verbose:t=!1,settings:o=!1,buffers:n=!1,wal:r=!1,format:i="text"}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};var a;const s=[e?"analyze":null,t?"verbose":null,o?"settings":null,n?"buffers":null,r?"wal":null].filter(Boolean).join("|"),l=null!==(a=this.headers.Accept)&&void 0!==a?a:"application/json";return this.headers.Accept=`application/vnd.pgrst.plan+${i}; for="${l}"; options=${s};`,this}rollback(){var e;return(null!==(e=this.headers.Prefer)&&void 0!==e?e:"").trim().length>0?this.headers.Prefer+=",tx=rollback":this.headers.Prefer="tx=rollback",this}returns(){return this}}t.default=i},7396:(e,t,o)=>{var n;!function(){"use strict";var r=!("undefined"===typeof window||!window.document||!window.document.createElement),i={canUseDOM:r,canUseWorkers:"undefined"!==typeof Worker,canUseEventListeners:r&&!(!window.addEventListener&&!window.attachEvent),canUseViewport:r&&!!window.screen};void 0===(n=function(){return i}.call(t,o,t,e))||(e.exports=n)}()},7467:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=0;t.default=function(){return"agPortalKey_"+ ++o}},7694:(e,t,o)=>{"use strict";o.d(t,{A:()=>ce});var n=o(5043),r=o(3216),i=o(1529),a=o(5315),s=o(8136),l=o(1009),c=o(5369),d=o(7149),u=o(2115),p=(o(2342),o(478)),h=o(1292),f=o(2233),g=o(3594),m=(o(3915),o(5546)),y=o(5962),v=o(2963),b=o.n(v),x=o(3768),w=o(579);b().setAppElement("#root");const C=i.Ay.div`
  display: flex;
  justify-content: space-between;
  align-items: center;
  padding-bottom: 15px;
  margin-bottom: 20px;
  border-bottom: 1px solid #333;

  h2 {
    color: #00ff00;
    margin: 0;
    font-size: 1.2rem;
    font-family: 'Courier New', monospace;
  }
`,_=i.Ay.div`
  display: flex;
  border-bottom: 1px solid #333;
  margin-bottom: 20px;
  min-height: 42px;
`,S=i.Ay.div`
  padding: 10px 20px;
  cursor: pointer;
  color: ${e=>e.$isActive?"#00ff00":"#ccc"};
  border-bottom: 2px solid ${e=>e.$isActive?"#00ff00":"transparent"};
  font-weight: ${e=>e.$isActive?"bold":"normal"};
  
  &:hover {
    color: #00ff00;
    background-color: rgba(0, 255, 0, 0.05);
  }
`,E=i.Ay.button`
  background: none;
  border: none;
  color: #ff5555;
  font-size: 1.2rem;
  cursor: pointer;
  display: flex;
  align-items: center;
  justify-content: center;
  
  &:hover {
    color: #ff0000;
  }
`,k=i.Ay.div`
  margin-bottom: 20px;
  color: #cccccc;
  font-size: 0.9rem;
`,j=i.Ay.div`
  background-color: #1a1a1a;
  padding: 15px;
  border-radius: 4px;
  margin-bottom: 20px;
  border: 1px solid #333;
`,A=i.Ay.div`
  margin-bottom: 10px;
  
  &:last-child {
    margin-bottom: 0;
  }
`,R=i.Ay.span`
  color: #999;
  margin-right: 10px;
  font-size: 0.8rem;
`,O=i.Ay.span`
  color: #cccccc;
  font-weight: normal;
`,T=i.Ay.div`
  display: flex;
  justify-content: flex-end;
  gap: 15px;
  position: absolute;
  bottom: 25px;
  right: 25px;
  width: calc(100% - 50px);
`,D=i.Ay.button`
  background-color: ${e=>e.bgColor||"#ff5555"};
  color: white;
  border: none;
  padding: 10px 20px;
  border-radius: 4px;
  font-weight: bold;
  cursor: pointer;
  display: flex;
  align-items: center;
  gap: 8px;
  
  &:hover {
    opacity: 0.9;
  }
  
  &:disabled {
    opacity: 0.5;
    cursor: not-allowed;
  }
`,P=i.Ay.button`
  background-color: transparent;
  color: #cccccc;
  border: 1px solid #555;
  padding: 10px 20px;
  border-radius: 4px;
  cursor: pointer;
  display: flex;
  align-items: center;
  gap: 8px;
  
  &:hover {
    background-color: #333;
  }
`,N=i.Ay.div`
  margin-bottom: 25px;
`,I=i.Ay.div`
  display: grid;
  grid-template-columns: repeat(3, 1fr);
  gap: 10px;
  margin-top: 10px;
  
  @media (max-width: 768px) {
    grid-template-columns: repeat(2, 1fr);
  }
  
  @media (max-width: 480px) {
    grid-template-columns: 1fr;
  }
`,M=i.Ay.div`
  display: flex;
  align-items: center;
  color: #cccccc;
`,L=i.Ay.input`
  margin-right: 8px;
  cursor: pointer;
  width: 16px;
  height: 16px;
  appearance: none;
  border: 1px solid #00ff00;
  background: #222;
  border-radius: 3px;
  position: relative;
  
  &:checked {
    background: #00ff00;
    
    &:after {
      content: '';
      position: absolute;
      left: 5px;
      top: 2px;
      width: 4px;
      height: 8px;
      border: solid #000;
      border-width: 0 2px 2px 0;
      transform: rotate(45deg);
    }
  }
`,F=i.Ay.div`
  display: flex;
  align-items: center;
  gap: 10px;
  background-color: rgba(255, 85, 85, 0.2);
  border: 1px solid #ff5555;
  color: #ff9999;
  padding: 10px 15px;
  border-radius: 4px;
  margin-bottom: 70px;
  
  svg {
    color: #ff5555;
    font-size: 1.2rem;
    flex-shrink: 0;
  }
`,G=i.Ay.div`
  color: #00ff00;
  text-align: center;
  margin: 20px 0;
`,z=e=>{let{isOpen:t,onClose:o,contactData:r,onDeleteComplete:i,onSkipComplete:s}=e;const[c,d]=(0,n.useState)("delete"),[u,p]=(0,n.useState)(!1),[h,f]=(0,n.useState)({chatCount:0,contactChatsCount:0,interactionsCount:0,emailsCount:0,emailParticipantsCount:0,emailThreadsCount:0,tagsCount:0,citiesCount:0,companiesCount:0,notesCount:0,attachmentsCount:0,contactEmailsCount:0,contactMobilesCount:0,dealsCount:0,meetingsCount:0,investmentsCount:0,kitCount:0,lastInteraction:null}),[g,m]=(0,n.useState)({deleteChat:!0,deleteContactChats:!0,deleteInteractions:!0,deleteEmails:!0,deleteEmailParticipants:!0,deleteEmailThreads:!0,deleteTags:!0,deleteCities:!0,deleteCompanies:!0,deleteNotes:!0,deleteAttachments:!0,deleteContactEmails:!0,deleteContactMobiles:!0,deleteDeals:!0,deleteMeetings:!0,deleteInvestments:!0,deleteKit:!0,addToSpam:!0,addMobileToSpam:!0});(0,n.useEffect)((()=>{"delete"===c&&r&&t&&v()}),[r,t,c]),(0,n.useEffect)((()=>{t&&d("delete")}),[t]);const y=e=>{const{name:t,checked:o}=e.target;m((e=>({...e,[t]:o})))},v=async()=>{if(r)try{const[e,t,o,n,i,s,l,c,d,u,p,h,g,m,y,v,b,x]=await Promise.all([a.supabase.from("chat").select("id",{count:"exact",head:!0}).eq("contact_id",r.contact_id),a.supabase.from("contact_chats").select("id",{count:"exact",head:!0}).eq("contact_id",r.contact_id),a.supabase.from("interactions").select("interaction_id",{count:"exact",head:!0}).eq("contact_id",r.contact_id),a.supabase.from("emails").select("email_id",{count:"exact",head:!0}).eq("sender_contact_id",r.contact_id),a.supabase.from("email_participants").select("participant_id",{count:"exact",head:!0}).eq("contact_id",r.contact_id),a.supabase.from("contact_email_threads").select("email_thread_id",{count:"exact",head:!0}).eq("contact_id",r.contact_id),a.supabase.from("contact_tags").select("entry_id",{count:"exact",head:!0}).eq("contact_id",r.contact_id),a.supabase.from("contact_cities").select("entry_id",{count:"exact",head:!0}).eq("contact_id",r.contact_id),a.supabase.from("contact_companies").select("contact_companies_id",{count:"exact",head:!0}).eq("contact_id",r.contact_id),a.supabase.from("notes_contacts").select("note_contact_id",{count:"exact",head:!0}).eq("contact_id",r.contact_id),a.supabase.from("attachments").select("attachment_id",{count:"exact",head:!0}).eq("contact_id",r.contact_id),a.supabase.from("contact_emails").select("email_id",{count:"exact",head:!0}).eq("contact_id",r.contact_id),a.supabase.from("contact_mobiles").select("mobile_id",{count:"exact",head:!0}).eq("contact_id",r.contact_id),a.supabase.from("deals_contacts").select("deals_contacts_id",{count:"exact",head:!0}).eq("contact_id",r.contact_id),a.supabase.from("meeting_contacts").select("meeting_contact_id",{count:"exact",head:!0}).eq("contact_id",r.contact_id),a.supabase.from("investments_contacts").select("investments_contacts_id",{count:"exact",head:!0}).eq("contact_id",r.contact_id),a.supabase.from("keep_in_touch").select("id",{count:"exact",head:!0}).eq("contact_id",r.contact_id),a.supabase.from("interactions").select("interaction_id, interaction_type, direction, interaction_date, summary").eq("contact_id",r.contact_id).order("interaction_date",{ascending:!1}).limit(1)]);f({chatCount:e.count||0,contactChatsCount:t.count||0,interactionsCount:o.count||0,emailsCount:n.count||0,emailParticipantsCount:i.count||0,emailThreadsCount:s.count||0,tagsCount:l.count||0,citiesCount:c.count||0,companiesCount:d.count||0,notesCount:u.count||0,attachmentsCount:p.count||0,contactEmailsCount:h.count||0,contactMobilesCount:g.count||0,dealsCount:m.count||0,meetingsCount:y.count||0,investmentsCount:v.count||0,kitCount:b.count||0,lastInteraction:x.data&&x.data.length>0?x.data[0]:null})}catch(e){console.error("Error fetching associated data counts:",e),x.Ay.error(`Failed to get related record counts: ${e.message||"Unknown error"}`)}},z=async()=>{if(r)try{if(p(!0),g.addToSpam&&r.email){const{error:e}=await a.supabase.from("emails_spam").insert([{email:r.email,counter:1}]);e&&console.error("Error adding to spam list:",e)}if(g.addMobileToSpam&&r.mobile){const{error:e}=await a.supabase.from("whatsapp_spam").insert([{mobile_number:r.mobile,counter:1,created_at:(new Date).toISOString(),last_modified_at:(new Date).toISOString()}]);e&&console.error("Error adding to WhatsApp spam list:",e)}const e=[];if(g.deleteChat&&h.chatCount>0&&e.push(a.supabase.from("chat").delete().eq("contact_id",r.contact_id)),g.deleteInteractions&&h.interactionsCount>0&&e.push(a.supabase.from("interactions").delete().eq("contact_id",r.contact_id)),g.deleteEmails&&h.emailsCount>0){const{data:t}=await a.supabase.from("emails").select("email_id").eq("sender_contact_id",r.contact_id);if(t&&t.length>0){const o=t.map((e=>e.email_id));e.push(a.supabase.from("email_participants").delete().in("email_id",o)),e.push(a.supabase.from("emails").delete().eq("sender_contact_id",r.contact_id))}}g.deleteEmailThreads&&h.emailThreadsCount>0&&e.push(a.supabase.from("contact_email_threads").delete().eq("contact_id",r.contact_id)),g.deleteContactEmails&&h.contactEmailsCount>0&&e.push(a.supabase.from("contact_emails").delete().eq("contact_id",r.contact_id)),g.deleteContactMobiles&&h.contactMobilesCount>0&&e.push(a.supabase.from("contact_mobiles").delete().eq("contact_id",r.contact_id)),g.deleteNotes&&h.notesCount>0&&e.push(a.supabase.from("notes_contacts").delete().eq("contact_id",r.contact_id)),g.deleteAttachments&&h.attachmentsCount>0&&e.push(a.supabase.from("attachments").delete().eq("contact_id",r.contact_id)),g.deleteTags&&h.tagsCount>0&&e.push(a.supabase.from("contact_tags").delete().eq("contact_id",r.contact_id)),g.deleteCities&&h.citiesCount>0&&e.push(a.supabase.from("contact_cities").delete().eq("contact_id",r.contact_id)),g.deleteCompanies&&h.companiesCount>0&&e.push(a.supabase.from("contact_companies").delete().eq("contact_id",r.contact_id)),g.deleteContactChats&&h.contactChatsCount>0&&e.push(a.supabase.from("contact_chats").delete().eq("contact_id",r.contact_id)),g.deleteWhatsapp&&r.mobile&&h.whatsappCount>0&&e.push(a.supabase.from("whatsapp_inbox").delete().eq("contact_number",r.mobile)),g.deleteDeals&&h.dealsCount>0&&e.push(a.supabase.from("deals_contacts").delete().eq("contact_id",r.contact_id)),g.deleteMeetings&&h.meetingsCount>0&&e.push(a.supabase.from("meeting_contacts").delete().eq("contact_id",r.contact_id)),g.deleteInvestments&&h.investmentsCount>0&&e.push(a.supabase.from("investments_contacts").delete().eq("contact_id",r.contact_id)),g.deleteKit&&h.kitCount>0&&e.push(a.supabase.from("keep_in_touch").delete().eq("contact_id",r.contact_id)),await Promise.all(e);const{error:t}=await a.supabase.from("contacts").delete().eq("contact_id",r.contact_id);if(t)throw t;p(!1),o(),i&&i(r.contact_id)}catch(e){console.error("Error deleting contact:",e),x.Ay.error(`Failed to delete contact: ${e.message||"Unknown error"}`),p(!1)}},H=async()=>{if(r)try{p(!0);const{error:e}=await a.supabase.from("contacts").update({category:"Skip"}).eq("contact_id",r.contact_id);if(e)throw e;p(!1),o(),s&&s(r.contact_id)}catch(e){console.error("Error marking contact as Skip:",e),x.Ay.error(`Failed to mark contact as Skip: ${e.message||"Unknown error"}`),p(!1)}};return(0,w.jsxs)(b(),{isOpen:t,onRequestClose:o,shouldCloseOnOverlayClick:!u,style:{content:{top:"50%",left:"50%",right:"auto",bottom:"auto",marginRight:"-50%",transform:"translate(-50%, -50%)",padding:"25px",maxWidth:"600px",width:"90%",height:"600px",maxHeight:"80vh",overflowY:"auto",backgroundColor:"#121212",border:"1px solid #333",borderRadius:"8px",boxShadow:"0 4px 20px rgba(0, 0, 0, 0.6)",color:"#e0e0e0",zIndex:1001,position:"relative",paddingBottom:"80px"},overlay:{backgroundColor:"rgba(0, 0, 0, 0.75)",zIndex:1e3}},children:[(0,w.jsxs)(C,{children:[(0,w.jsx)("h2",{children:"delete"===c?"Delete Contact":"Skip Contact"}),(0,w.jsx)(E,{onClick:o,disabled:u,children:(0,w.jsx)(l.yGN,{})})]}),(0,w.jsxs)(_,{children:[(0,w.jsx)(S,{$isActive:"delete"===c,onClick:()=>!u&&d("delete"),children:"Delete (Spam)"}),(0,w.jsx)(S,{$isActive:"skip"===c,onClick:()=>!u&&d("skip"),children:"Skip"})]}),u&&(0,w.jsx)(G,{children:"Processing... Please wait"}),"delete"===c&&(0,w.jsx)(w.Fragment,{children:r&&(0,w.jsxs)(w.Fragment,{children:[(0,w.jsx)(j,{children:(0,w.jsx)(A,{children:(0,w.jsxs)(O,{children:[r.first_name," ",r.last_name,r.email?` (${r.email})`:r.mobile?` (${r.mobile})`:""]})})}),(0,w.jsxs)(A,{style:{marginTop:"15px",marginBottom:"15px"},children:[(0,w.jsx)(R,{children:"Last Interaction:"}),(0,w.jsx)(O,{children:h.lastInteraction?h.lastInteraction.summary:"None"})]}),(0,w.jsx)(k,{children:"Select which items to delete:"}),(0,w.jsx)(N,{children:(0,w.jsxs)(I,{children:[h.interactionsCount>0&&(0,w.jsxs)(M,{children:[(0,w.jsx)(L,{type:"checkbox",id:"deleteInteractions",name:"deleteInteractions",checked:g.deleteInteractions,onChange:y,disabled:u}),(0,w.jsxs)("label",{htmlFor:"deleteInteractions",children:["Interactions (",h.interactionsCount,")"]})]}),h.emailsCount>0&&(0,w.jsxs)(M,{children:[(0,w.jsx)(L,{type:"checkbox",id:"deleteEmails",name:"deleteEmails",checked:g.deleteEmails,onChange:y,disabled:u}),(0,w.jsxs)("label",{htmlFor:"deleteEmails",children:["Emails (",h.emailsCount,")"]})]}),h.emailParticipantsCount>0&&(0,w.jsxs)(M,{children:[(0,w.jsx)(L,{type:"checkbox",id:"deleteEmailParticipants",name:"deleteEmailParticipants",checked:g.deleteEmailParticipants,onChange:y,disabled:u}),(0,w.jsxs)("label",{htmlFor:"deleteEmailParticipants",children:["Email Participants (",h.emailParticipantsCount,")"]})]}),h.emailThreadsCount>0&&(0,w.jsxs)(M,{children:[(0,w.jsx)(L,{type:"checkbox",id:"deleteEmailThreads",name:"deleteEmailThreads",checked:g.deleteEmailThreads,onChange:y,disabled:u}),(0,w.jsxs)("label",{htmlFor:"deleteEmailThreads",children:["Email Threads (",h.emailThreadsCount,")"]})]}),h.contactEmailsCount>0&&(0,w.jsxs)(M,{children:[(0,w.jsx)(L,{type:"checkbox",id:"deleteContactEmails",name:"deleteContactEmails",checked:g.deleteContactEmails,onChange:y,disabled:u}),(0,w.jsxs)("label",{htmlFor:"deleteContactEmails",children:["Email Addresses (",h.contactEmailsCount,")"]})]}),h.contactMobilesCount>0&&(0,w.jsxs)(M,{children:[(0,w.jsx)(L,{type:"checkbox",id:"deleteContactMobiles",name:"deleteContactMobiles",checked:g.deleteContactMobiles,onChange:y,disabled:u}),(0,w.jsxs)("label",{htmlFor:"deleteContactMobiles",children:["Mobile Numbers (",h.contactMobilesCount,")"]})]}),h.chatCount>0&&(0,w.jsxs)(M,{children:[(0,w.jsx)(L,{type:"checkbox",id:"deleteChat",name:"deleteChat",checked:g.deleteChat,onChange:y,disabled:u}),(0,w.jsxs)("label",{htmlFor:"deleteChat",children:["Chat messages (",h.chatCount,")"]})]}),h.contactChatsCount>0&&(0,w.jsxs)(M,{children:[(0,w.jsx)(L,{type:"checkbox",id:"deleteContactChats",name:"deleteContactChats",checked:g.deleteContactChats,onChange:y,disabled:u}),(0,w.jsxs)("label",{htmlFor:"deleteContactChats",children:["Chat Links (",h.contactChatsCount,")"]})]}),h.notesCount>0&&(0,w.jsxs)(M,{children:[(0,w.jsx)(L,{type:"checkbox",id:"deleteNotes",name:"deleteNotes",checked:g.deleteNotes,onChange:y,disabled:u}),(0,w.jsxs)("label",{htmlFor:"deleteNotes",children:["Notes (",h.notesCount,")"]})]}),h.attachmentsCount>0&&(0,w.jsxs)(M,{children:[(0,w.jsx)(L,{type:"checkbox",id:"deleteAttachments",name:"deleteAttachments",checked:g.deleteAttachments,onChange:y,disabled:u}),(0,w.jsxs)("label",{htmlFor:"deleteAttachments",children:["Attachments (",h.attachmentsCount,")"]})]}),h.tagsCount>0&&(0,w.jsxs)(M,{children:[(0,w.jsx)(L,{type:"checkbox",id:"deleteTags",name:"deleteTags",checked:g.deleteTags,onChange:y,disabled:u}),(0,w.jsxs)("label",{htmlFor:"deleteTags",children:["Tags (",h.tagsCount,")"]})]}),h.citiesCount>0&&(0,w.jsxs)(M,{children:[(0,w.jsx)(L,{type:"checkbox",id:"deleteCities",name:"deleteCities",checked:g.deleteCities,onChange:y,disabled:u}),(0,w.jsxs)("label",{htmlFor:"deleteCities",children:["Cities (",h.citiesCount,")"]})]}),h.companiesCount>0&&(0,w.jsxs)(M,{children:[(0,w.jsx)(L,{type:"checkbox",id:"deleteCompanies",name:"deleteCompanies",checked:g.deleteCompanies,onChange:y,disabled:u}),(0,w.jsxs)("label",{htmlFor:"deleteCompanies",children:["Companies (",h.companiesCount,")"]})]}),h.dealsCount>0&&(0,w.jsxs)(M,{children:[(0,w.jsx)(L,{type:"checkbox",id:"deleteDeals",name:"deleteDeals",checked:g.deleteDeals,onChange:y,disabled:u}),(0,w.jsxs)("label",{htmlFor:"deleteDeals",children:["Deals (",h.dealsCount,")"]})]}),h.meetingsCount>0&&(0,w.jsxs)(M,{children:[(0,w.jsx)(L,{type:"checkbox",id:"deleteMeetings",name:"deleteMeetings",checked:g.deleteMeetings,onChange:y,disabled:u}),(0,w.jsxs)("label",{htmlFor:"deleteMeetings",children:["Meetings (",h.meetingsCount,")"]})]}),h.investmentsCount>0&&(0,w.jsxs)(M,{children:[(0,w.jsx)(L,{type:"checkbox",id:"deleteInvestments",name:"deleteInvestments",checked:g.deleteInvestments,onChange:y,disabled:u}),(0,w.jsxs)("label",{htmlFor:"deleteInvestments",children:["Investments (",h.investmentsCount,")"]})]}),h.kitCount>0&&(0,w.jsxs)(M,{children:[(0,w.jsx)(L,{type:"checkbox",id:"deleteKit",name:"deleteKit",checked:g.deleteKit,onChange:y,disabled:u}),(0,w.jsxs)("label",{htmlFor:"deleteKit",children:["Keep In Touch (",h.kitCount,")"]})]}),r.mobile&&h.whatsappCount>0&&(0,w.jsxs)(M,{children:[(0,w.jsx)(L,{type:"checkbox",id:"deleteWhatsapp",name:"deleteWhatsapp",checked:g.deleteWhatsapp,onChange:y,disabled:u}),(0,w.jsxs)("label",{htmlFor:"deleteWhatsapp",children:["WhatsApp Data (",h.whatsappCount,")"]})]}),r.email&&(0,w.jsxs)(M,{children:[(0,w.jsx)(L,{type:"checkbox",id:"addToSpam",name:"addToSpam",checked:g.addToSpam,onChange:y,disabled:u}),(0,w.jsx)("label",{htmlFor:"addToSpam",children:"Add email to spam list"})]}),r.mobile&&(0,w.jsxs)(M,{children:[(0,w.jsx)(L,{type:"checkbox",id:"addMobileToSpam",name:"addMobileToSpam",checked:g.addMobileToSpam,onChange:y,disabled:u}),(0,w.jsx)("label",{htmlFor:"addMobileToSpam",children:"Add mobile to WhatsApp spam list"})]})]})}),(0,w.jsxs)(F,{children:[(0,w.jsx)(l.eHT,{}),(0,w.jsx)("div",{children:"Warning: This action will permanently delete the contact and all selected associated data."})]}),(0,w.jsxs)(T,{children:[(0,w.jsxs)(P,{onClick:o,disabled:u,children:[(0,w.jsx)(l.yGN,{})," Cancel"]}),(0,w.jsx)(D,{onClick:z,disabled:u,bgColor:"#ff5555",children:u?"Deleting...":(0,w.jsxs)(w.Fragment,{children:[(0,w.jsx)(l.IXo,{})," Delete Contact"]})})]})]})}),"skip"===c&&(0,w.jsx)(w.Fragment,{children:r&&(0,w.jsxs)(w.Fragment,{children:[(0,w.jsx)(j,{children:(0,w.jsx)(A,{children:(0,w.jsxs)(O,{children:[r.first_name," ",r.last_name,r.email?` (${r.email})`:r.mobile?` (${r.mobile})`:""]})})}),(0,w.jsxs)(k,{children:[(0,w.jsx)("p",{style:{marginBottom:"20px"},children:'Are you sure you want to mark this contact as "Skip"?'}),(0,w.jsx)("p",{style:{marginBottom:"70px"},children:'This will move the contact to the "Skip" category, and it will no longer appear in the main inbox.'})]}),(0,w.jsxs)(T,{children:[(0,w.jsxs)(P,{onClick:o,disabled:u,children:[(0,w.jsx)(l.yGN,{})," Cancel"]}),(0,w.jsx)(D,{onClick:H,disabled:u,bgColor:"#ff9900",children:u?"Processing...":(0,w.jsxs)(w.Fragment,{children:[(0,w.jsx)(l.A3x,{})," Mark as Skip"]})})]})]})})]})};var H=o(9430),B=o(4762),V=o(3237);const $=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:50;const o=[];for(let n=0;n<e.length;n+=t)o.push(e.slice(n,n+t));return o},U=i.DU`
  .Toastify__toast {
    background-color: #121212;
    color: #00ff00;
    border: 1px solid #00ff00;
    box-shadow: 0 0 10px rgba(0, 255, 0, 0.3);
  }
  
  .Toastify__toast-body {
    font-family: 'Courier New', monospace;
    font-size: 14px;
  }

  .Toastify__progress-bar {
    background: #00ff00;
  }

  .Toastify__close-button {
    color: #00ff00;
  }
  
  .Toastify__toast--success {
    background-color: #121212;
    border: 1px solid #00ff00;
  }
  
  .Toastify__toast--error {
    background-color: #121212;
    border: 1px solid #ff3333;
    color: #ff3333;
  }
  
  /* AG Grid hover and selection overrides */
  .ag-theme-alpine .ag-row:hover {
    background-color: inherit !important;
  }
  .ag-theme-alpine .ag-row-odd:hover {
    background-color: #1a1a1a !important;
  }
  .ag-theme-alpine .ag-row-even:hover {
    background-color: #121212 !important;
  }
  .ag-theme-alpine .ag-row-selected {
    background-color: inherit !important;
  }
  .ag-theme-alpine .ag-row-odd.ag-row-selected {
    background-color: #1a1a1a !important;
  }
  .ag-theme-alpine .ag-row-even.ag-row-selected {
    background-color: #121212 !important;
  }
`,W=i.Ay.div`
  height: calc(100vh - 60px);
  width: 100%;
  padding: 0 5px 0 0;
  overflow: hidden;
  box-sizing: border-box;
  max-width: 100%;
  position: relative;
`,q=i.Ay.div`
  color: #ff3333;
  background-color: #330000;
  padding: 15px;
  border-radius: 4px;
  margin-bottom: 20px;
`,K=i.Ay.div`
  color: #00ff00;
  text-align: center;
  padding: 40px;
  font-family: monospace;
  display: flex;
  flex-direction: column;
  align-items: center;
  justify-content: center;
  height: 400px;
`,Y=i.Ay.div`
  width: 300px;
  height: 8px;
  background-color: #111;
  margin: 20px 0;
  border-radius: 4px;
  overflow: hidden;
  position: relative;
  box-shadow: 0 0 10px rgba(0, 255, 0, 0.2);
  
  &:before {
    content: "";
    position: absolute;
    top: 0;
    left: 0;
    height: 100%;
    width: 30%;
    background-color: #00ff00;
    animation: pulse 1.5s ease-in-out infinite;
    box-shadow: 0 0 20px #00ff00;
    border-radius: 4px;
  }
  
  @keyframes pulse {
    0% {
      left: -30%;
      opacity: 0.8;
    }
    100% {
      left: 100%;
      opacity: 0.2;
    }
  }
`,J=i.Ay.div`
  margin-top: 15px;
  color: #00ff00;
  text-shadow: 0 0 5px rgba(0, 255, 0, 0.5);
  letter-spacing: 1px;
  font-size: 16px;
  opacity: 0.9;
  animation: blink 1.5s ease-in-out infinite alternate;
  
  @keyframes blink {
    from { opacity: 0.6; }
    to { opacity: 1; }
  }
`,X=i.Ay.div`
  display: flex;
  gap: 10px;
  justify-content: center;
  align-items: center;
  padding: 0 8px;
  width: 100%;
  height: 100%;
  background-color: #111;
`,Q=i.Ay.button`
  background: transparent;
  border: none;
  color: #00ff00;
  cursor: pointer;
  display: flex;
  align-items: center;
  justify-content: center;
  width: 20px;
  height: 20px;
  border-radius: 3px;
  transition: all 0.2s;
  padding: 0;
  margin: 0 1px;
  
  &:hover {
    transform: scale(1.1);
  }

  &.linkedin {
    color: #00ff00;
  }
  
  &.email {
    color: #00ff00;
  }
  
  &.whatsapp {
    color: #00ff00;
  }
`,Z=i.Ay.div`
  display: flex;
  gap: 1px;
  align-items: center;
  padding-top: 4px;
  padding-bottom: 1px;
  height: 100%;
`,ee=i.Ay.div`
  display: flex;
  align-items: center;
  justify-content: center;
  background-color: #1a1a1a;
  color: #00ff00;
  padding: 0px 6px;
  border-radius: 4px;
  font-size: 11px;
  border: 1px solid #00ff00;
  box-shadow: 0 0 4px rgba(0, 255, 0, 0.4);
  white-space: nowrap;
  overflow: visible;
  line-height: 16px;
  max-width: fit-content;
  height: 18px;
  
  button {
    background: none;
    border: none;
    color: #00ff00;
    cursor: pointer;
    padding: 0;
    margin-left: 4px;
    font-size: 10px;
    display: flex;
    align-items: center;
    justify-content: center;
    
    &:hover {
      color: #33ff33;
      transform: scale(1.2);
    }
  }
`,te=i.Ay.div`
  display: flex;
  align-items: center;
  justify-content: center;
  background-color: #1a1a1a;
  color: #cccccc;
  padding: 0px 6px;
  border-radius: 4px;
  font-size: 11px;
  border: none;
  white-space: nowrap;
  overflow: visible;
  line-height: 16px;
  max-width: fit-content;
  height: 18px;
  
  button {
    background: none;
    border: none;
    color: #cccccc;
    cursor: pointer;
    padding: 0;
    margin-left: 4px;
    font-size: 10px;
    display: flex;
    align-items: center;
    justify-content: center;
    
    &:hover {
      color: #ffffff;
      transform: scale(1.2);
    }
  }
`,oe=i.Ay.button`
  background: none;
  border: none;
  color: #00ff00;
  border-radius: 3px;
  width: 16px;
  height: 16px;
  padding: 0;
  display: flex;
  align-items: center;
  justify-content: center;
  cursor: pointer;
  font-size: 12px;
  
  &:hover {
    background-color: rgba(0, 255, 0, 0.1);
  }
`,ne=e=>{const[t,o]=n.useState(!1),r=e.value||[],i=e.data;if(!r.length&&!i)return"";const s=r.slice(0,2),c=r.length-2,h=0===r.length,f=e=>{e.stopPropagation(),o(!0)};return(0,w.jsx)("div",{style:{height:"100%",display:"flex",alignItems:"center",justifyContent:"center"},children:(0,w.jsxs)(Z,{onClick:e=>{e.stopPropagation()},style:{whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis",paddingRight:"0",width:"100%",height:"100%",display:"flex",alignItems:"center",gap:"6px"},children:[s.map((t=>(0,w.jsxs)(ee,{title:t.name,children:[t.name,(0,w.jsx)("button",{onClick:o=>(async(t,o)=>{t.stopPropagation();try{const t=r.find((e=>e.id===o)),{error:n}=await a.supabase.from("contact_tags").delete().eq("contact_id",i.contact_id).eq("tag_id",o);if(n)throw n;const s=r.filter((e=>e.id!==o));e.setValue(s),e.api&&e.api.refreshCells({force:!0,rowNodes:[e.node],columns:["tags"]}),u.oR.success(`Tag "${(null===t||void 0===t?void 0:t.name)||"Unknown"}" removed from ${i.first_name} ${i.last_name}`,{position:"top-right",autoClose:3e3,hideProgressBar:!1,closeOnClick:!0,pauseOnHover:!0,draggable:!0})}catch(n){console.error("Error removing tag:",n),u.oR.error(`Error removing tag: ${n.message}`,{position:"top-right",autoClose:5e3,hideProgressBar:!1,closeOnClick:!0,pauseOnHover:!0,draggable:!0})}})(o,t.id),title:"Remove tag",style:{display:"flex",alignItems:"center",justifyContent:"center",marginLeft:"5px",padding:"0",background:"none",border:"none",cursor:"pointer"},children:(0,w.jsx)(d.Tfw,{style:{color:"#00ff00"},size:14})})]},t.id))),c>0&&(0,w.jsxs)("div",{style:{display:"inline-flex",alignItems:"center",justifyContent:"center",padding:"0px 3px",borderRadius:"3px",fontSize:"9px",color:"#999999",cursor:"pointer",height:"16px",lineHeight:"16px",backgroundColor:"#333333",marginRight:"1px"},onClick:f,children:["+",c]}),h?(0,w.jsx)("div",{onClick:f,style:{color:"#00ff00",fontSize:"11px",cursor:"pointer",display:"flex",alignItems:"center",justifyContent:"center",gap:"4px",width:"100%",height:"100%"},title:"Add or edit tags",children:"Add tags"}):(0,w.jsx)(oe,{onClick:f,title:"Add or edit tags",children:(0,w.jsx)(l.GGD,{size:10})}),t&&(0,w.jsx)(p.A,{isOpen:t,onRequestClose:()=>{o(!1),e.api&&(e.api.refreshCells({force:!0,rowNodes:[e.node],columns:["tags"]}),setTimeout((()=>{e.context&&e.context.refreshData&&e.context.refreshData()}),100))},contact:i,onTagAdded:t=>{e.api&&e.api.refreshCells({force:!0,rowNodes:[e.node],columns:["tags"]})},onTagRemoved:t=>{e.api&&e.api.refreshCells({force:!0,rowNodes:[e.node],columns:["tags"]})}})]})})},re=e=>{var t;const[o,r]=(0,n.useState)(!1),[i,s]=(0,n.useState)(!1),[c,p]=(0,n.useState)(null),[h,f]=(0,n.useState)(0),g=e.value||[],v=null===(t=e.data)||void 0===t?void 0:t.contact_id,b=g.length>1,x=e=>{null===e||void 0===e||e.stopPropagation(),r(!0)},C=t=>{r(!1),e.context&&e.context.refreshData&&setTimeout((()=>{e.context.refreshData()}),100)},_=e=>{e.stopPropagation()};if(!g.length)return(0,w.jsxs)("div",{style:{display:"flex",alignItems:"center",height:"100%"},onClick:_,children:[(0,w.jsx)("div",{onClick:x,style:{color:"#ffffff",fontSize:"11px",cursor:"pointer",display:"flex",alignItems:"center",gap:"4px"},title:"Associate Company",children:"Add company"}),o&&(0,w.jsx)(m.A,{isOpen:o,onRequestClose:()=>r(!1),contactId:v,onCompanyAssociated:C})]});const S=g[h];return(0,w.jsxs)("div",{style:{display:"flex",alignItems:"center",height:"36px",minHeight:"36px",width:"100%",position:"relative"},onClick:_,children:[(0,w.jsxs)("div",{style:{display:"flex",alignItems:"center",justifyContent:"space-between",width:"100%",gap:"4px"},children:[(0,w.jsxs)("div",{style:{display:"flex",alignItems:"center",backgroundColor:"#1a1a1a",color:"#ffffff",padding:"0px 6px",borderRadius:"4px",fontSize:"11px",border:"1px solid #ffffff",boxShadow:"0 0 4px rgba(255, 255, 255, 0.2)",whiteSpace:"nowrap",overflow:"hidden",lineHeight:"16px",width:"100%",maxWidth:b?"170px":"190px",height:"18px",position:"relative"},children:[(0,w.jsx)("span",{style:{cursor:"pointer",maxWidth:b?"120px":"160px",overflow:"hidden",textOverflow:"ellipsis",display:"inline-block"},onClick:e=>((e,t)=>{null===t||void 0===t||t.stopPropagation();const o={...e,company_id:e.id};p(o),s(!0)})(S,e),title:S.name,children:S.name}),b&&(0,w.jsxs)("div",{style:{fontSize:"9px",color:"#cccccc",marginLeft:"4px",padding:"0 2px",borderRadius:"3px",backgroundColor:"#333333"},children:[h+1,"/",g.length]}),(0,w.jsx)("button",{onClick:t=>(async(t,o)=>{if(null===o||void 0===o||o.stopPropagation(),v&&t)try{const{error:o}=await a.supabase.from("contact_companies").delete().eq("contact_id",v).eq("company_id",t);if(o)throw o;u.oR.success("Company association removed"),e.api&&e.api.refreshCells({force:!0}),setTimeout((()=>{e.context&&e.context.refreshData&&e.context.refreshData()}),100)}catch(n){console.error("Error removing company association:",n),u.oR.error("Failed to remove company association")}})(S.id,t),style:{background:"none",border:"none",color:"#ffffff",cursor:"pointer",padding:"0",marginLeft:"4px",fontSize:"10px",display:"flex",alignItems:"center",justifyContent:"center"},title:"Remove Company Association",children:(0,w.jsx)(d.Tfw,{size:14})})]}),b&&(0,w.jsx)("button",{onClick:e=>{null===e||void 0===e||e.stopPropagation(),f((e=>(e+1)%g.length))},style:{background:"none",border:"none",color:"#ffffff",cursor:"pointer",padding:"0",display:"flex",alignItems:"center",justifyContent:"center",width:"14px",height:"14px",fontSize:"10px",opacity:"0.8",marginLeft:"2px"},title:"Next company",children:"\u25b6"}),(0,w.jsx)("button",{onClick:x,style:{background:"none",border:"none",color:"#ffffff",borderRadius:"4px",width:"20px",height:"20px",padding:"0",display:"flex",alignItems:"center",justifyContent:"center",cursor:"pointer",fontSize:"14px"},title:"Associate Company",children:(0,w.jsx)(l.GGD,{size:14})})]}),o&&(0,w.jsx)(m.A,{isOpen:o,onRequestClose:()=>r(!1),contactId:v,onCompanyAssociated:C}),i&&c&&(0,w.jsx)(y.A,{isOpen:i,onRequestClose:()=>s(!1),company:c,contactId:v,onCompanyUpdated:()=>{s(!1),e.context&&e.context.refreshData&&setTimeout((()=>{e.context.refreshData()}),100)}})]})},ie=e=>{const[t,o]=n.useState(!1),r=e.value||[],i=e.data;if(!r.length&&!i)return"";const s=r.slice(0,1),c=r.length-1,p=0===r.length,f=e=>{e.stopPropagation(),o(!0)};return(0,w.jsx)("div",{style:{height:"100%",display:"flex",alignItems:"center",justifyContent:"center"},children:(0,w.jsxs)(Z,{onClick:e=>{e.stopPropagation()},style:{whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis",paddingRight:"0",width:"100%",height:"100%",display:"flex",alignItems:"center",gap:"2px"},children:[s.map((t=>(0,w.jsxs)(te,{title:t.name,children:[t.name,(0,w.jsx)("button",{onClick:o=>(async(t,o)=>{t.stopPropagation();try{const t=r.find((e=>e.id===o)),{error:n}=await a.supabase.from("contact_cities").delete().eq("contact_id",i.contact_id).eq("city_id",o);if(n)throw n;const s=r.filter((e=>e.id!==o));e.setValue(s),e.api&&e.api.refreshCells({force:!0,rowNodes:[e.node],columns:["cities"]}),u.oR.success(`City "${(null===t||void 0===t?void 0:t.name)||"Unknown"}" removed from ${i.first_name} ${i.last_name}`,{position:"top-right",autoClose:3e3,hideProgressBar:!1,closeOnClick:!0,pauseOnHover:!0,draggable:!0})}catch(n){console.error("Error removing city:",n),u.oR.error(`Error removing city: ${n.message}`,{position:"top-right",autoClose:5e3,hideProgressBar:!1,closeOnClick:!0,pauseOnHover:!0,draggable:!0})}})(o,t.id),title:"Remove city",style:{display:"flex",alignItems:"center",justifyContent:"center",marginLeft:"5px",padding:"0",background:"none",border:"none",cursor:"pointer"},children:(0,w.jsx)(d.Tfw,{style:{color:"#00ff00"},size:14})})]},t.id))),c>0&&(0,w.jsxs)("div",{style:{display:"inline-flex",alignItems:"center",justifyContent:"center",padding:"0px 3px",borderRadius:"3px",fontSize:"9px",color:"#999999",cursor:"pointer",height:"16px",lineHeight:"16px",backgroundColor:"#333333",marginRight:"1px"},onClick:()=>o(!0),title:`Show all ${r.length} cities`,children:["+",c]}),p?(0,w.jsx)(te,{onClick:f,style:{color:"#cccccc",fontSize:"11px",cursor:"pointer",border:"none",boxShadow:"none",backgroundColor:"transparent",display:"flex",justifyContent:"center"},title:"Add or edit city",children:"Add city"}):(0,w.jsx)(oe,{onClick:f,title:"Add or edit cities",children:(0,w.jsx)(l.GGD,{size:10})}),t&&(0,w.jsx)(h.A,{isOpen:t,onRequestClose:()=>{o(!1),e.api&&(e.api.refreshCells({force:!0,rowNodes:[e.node],columns:["cities"]}),setTimeout((()=>{e.context&&e.context.refreshData&&e.context.refreshData()}),100))},contact:i,onCityAdded:t=>{e.api&&e.api.refreshCells({force:!0,rowNodes:[e.node],columns:["cities"]})},onCityRemoved:t=>{e.api&&e.api.refreshCells({force:!0,rowNodes:[e.node],columns:["cities"]})}})]})})},ae=e=>{const t=e.value,[o,r]=(0,n.useState)(!1),[i,s]=(0,n.useState)(t);(0,n.useEffect)((()=>{s(t)}),[t]);const l=e=>5===e?"#00ff00":"#aaaaaa";return(0,w.jsx)("div",{style:{display:"flex",justifyContent:"center",width:"100%",padding:"0",margin:"0"},onClick:e=>{e.stopPropagation(),r(!0)},children:o?(0,w.jsx)("select",{value:i||0,onChange:async o=>{o.stopPropagation();const n=parseInt(o.target.value,10);s(n);try{const{error:t}=await a.supabase.from("contacts").update({score:n}).eq("contact_id",e.data.contact_id);if(t)throw t;e.api&&e.api.refreshCells({force:!0,rowNodes:[e.node],columns:["score"]}),u.oR.success(`Rating updated for ${e.data.first_name} ${e.data.last_name}`)}catch(r){console.error("Error updating score:",r),u.oR.error(`Error updating rating: ${r.message}`),s(t)}},onBlur:()=>{r(!1)},onClick:e=>{e.stopPropagation()},autoFocus:!0,style:{backgroundColor:"#222",color:l(i||0),border:`1px solid ${l(i||0)}`,borderRadius:"4px",padding:"2px",fontSize:"14px",width:"40px",textAlign:"center",fontWeight:"bold",cursor:"pointer"},children:[0,1,2,3,4,5].map((e=>(0,w.jsx)("option",{value:e,children:e},e)))}):(0,w.jsx)("span",{style:{color:l(i||0),fontWeight:"bold",fontSize:"14px",textAlign:"center",cursor:"pointer"},children:null!==i&&void 0!==i?i:"-"})})},se=e=>{const[t,o]=(0,n.useState)(!1);if(!e.value)return"";const r=new Date(e.value),i=`${(r.getMonth()+1).toString().padStart(2,"0")}/${r.getFullYear().toString().slice(-2)}`;return(0,w.jsxs)(w.Fragment,{children:[(0,w.jsx)("div",{onClick:e=>{e.stopPropagation(),o(!0)},style:{whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis",paddingRight:"0",width:"100%",fontSize:"12px",textAlign:"center",cursor:"pointer",color:"#aaaaaa"},children:i}),t&&(0,w.jsx)(H.A,{isOpen:t,onRequestClose:()=>o(!1),contact:e.data})]})},le=e=>{const t=e.data,[o,r]=(0,n.useState)(!1),[i,s]=(0,n.useState)(!1),[d,p]=(0,n.useState)(!1),[h,m]=(0,n.useState)(!1),[y,v]=(0,n.useState)(!1),b=t.email||"",x=(t.mobile,()=>{r(!1),s(!1),p(!1),m(!1),v(!1)}),C=async o=>{try{const n={job_role:o.jobRole,linkedin:t.linkedin,last_modified_at:(new Date).toISOString(),last_modified_by:"User"},{error:r}=await a.supabase.from("contacts").update(n).eq("contact_id",t.contact_id);if(r)throw r;if(o.company){const{data:e,error:n}=await a.supabase.from("companies").select("company_id, name").ilike("name",o.company);if(n)throw n;let r;if(e&&e.length>0){r=e[0].company_id;const{error:t}=await a.supabase.from("companies").update({website:o.companyWebsite||null,description:o.companyDescription||null,last_modified_at:(new Date).toISOString(),last_modified_by:"User"}).eq("company_id",r);if(t)throw t}else{const{data:e,error:t}=await a.supabase.from("companies").insert({name:o.company,website:o.companyWebsite||null,description:o.companyDescription||null,created_at:(new Date).toISOString(),created_by:"User",last_modified_at:(new Date).toISOString(),last_modified_by:"User"}).select();if(t)throw t;e&&e.length>0&&(r=e[0].company_id)}if(r){const{data:e,error:o}=await a.supabase.from("contact_companies").select("contact_id, company_id").eq("contact_id",t.contact_id).eq("company_id",r);if(o)throw o;if(!e||0===e.length){const{error:e}=await a.supabase.from("contact_companies").insert({contact_id:t.contact_id,company_id:r});if(e)throw e}}}if(o.city){const{data:e,error:n}=await a.supabase.from("cities").select("city_id, name").ilike("name",o.city);if(n)throw n;let r;if(e&&e.length>0)r=e[0].city_id;else{const{data:e,error:t}=await a.supabase.from("cities").insert({name:o.city}).select();if(t)throw t;e&&e.length>0&&(r=e[0].city_id)}if(r){const{data:e,error:o}=await a.supabase.from("contact_cities").select("contact_id, city_id").eq("contact_id",t.contact_id).eq("city_id",r);if(o)throw o;if(!e||0===e.length){const{error:e}=await a.supabase.from("contact_cities").insert({contact_id:t.contact_id,city_id:r});if(e)throw e}}}u.oR.success(`Profile information updated for ${t.first_name} ${t.last_name}`,{position:"top-right",autoClose:3e3,hideProgressBar:!1,closeOnClick:!0,pauseOnHover:!0,draggable:!0}),e.context&&e.context.refreshData&&setTimeout((()=>{e.context.refreshData()}),500)}catch(n){console.error("Error saving LinkedIn data:",n),u.oR.error(`Error saving profile data: ${n.message}`,{position:"top-right",autoClose:5e3,hideProgressBar:!1,closeOnClick:!0,pauseOnHover:!0,draggable:!0})}r(!1)};return(0,w.jsxs)("div",{style:{height:"100%",display:"flex",alignItems:"center",justifyContent:"center",backgroundColor:"#111",width:"100%",paddingRight:"10px"},children:[(0,w.jsxs)(X,{children:[(0,w.jsx)(Q,{className:"linkedin",onClick:e=>{e.stopPropagation(),console.log("Opening LinkedIn search & enrich modal"),s(!0)},title:t.linkedin?"Open LinkedIn":"No LinkedIn profile",style:{color:t.linkedin?"#00ff00":"#888888"},children:(0,w.jsx)(l.Wjy,{size:14})}),(0,w.jsx)(Q,{className:"delete-contact",onClick:e=>{e.stopPropagation(),p(!0)},title:"Delete or Skip Contact",style:{color:"#00ff00"},children:(0,w.jsx)(l.IXo,{size:14})}),(0,w.jsx)(Q,{className:"opportunities",onClick:e=>{e.stopPropagation(),m(!0)},title:"Opportunities",style:{width:"24px",height:"24px"},onMouseEnter:e=>e.currentTarget.style.transform="scale(1.1)",onMouseLeave:e=>e.currentTarget.style.transform="scale(1)",children:(0,w.jsx)(l.z8N,{size:16})}),(0,w.jsx)(Q,{className:"intros",onClick:e=>{e.stopPropagation(),v(!0)},title:"Introductions",children:(0,w.jsx)(c.DDN,{size:14})})]}),o&&(0,w.jsx)(f.A,{isOpen:o,onClose:x,linkedInUrl:t.linkedin||"",contactName:`${t.first_name||""} ${t.last_name||""}`.trim(),firstName:t.first_name||"",lastName:t.last_name||"",email:b,jobRole:t.job_role||"",onSaveData:C}),i&&(0,w.jsx)(g.A,{isOpen:i,onClose:x,linkedInUrl:t.linkedin||"",contactName:`${t.first_name||""} ${t.last_name||""}`.trim(),firstName:t.first_name||"",lastName:t.last_name||"",email:b,jobRole:t.job_role||"",contactId:t.contact_id,context:e.context,onSaveData:C}),d&&(0,w.jsx)(z,{isOpen:d,onClose:()=>p(!1),contactData:t,onDeleteComplete:()=>{e.context&&e.context.refreshData&&e.context.refreshData()},onSkipComplete:()=>{e.context&&e.context.refreshData&&e.context.refreshData()}}),h&&(0,w.jsx)(B.A,{isOpen:h,onClose:()=>m(!1),contactData:t}),y&&(0,w.jsx)(V.A,{isOpen:y,onRequestClose:()=>{v(!1),e.context&&e.context.refreshData&&setTimeout((()=>{e.context.refreshData()}),500)},preSelectedContact:t})]})},ce=e=>{let{category:t}=e;const[o,i]=(0,n.useState)([]),[c,d]=(0,n.useState)(!0),[p,h]=(0,n.useState)(null),[f,g]=(0,n.useState)(null),m=(0,r.Zp)(),y=e=>{const t=null===e.value?"Not Set":e.value,[o,r]=(0,n.useState)(!1),[i,s]=(0,n.useState)(t);(0,n.useEffect)((()=>{s(null===e.value?"Not Set":e.value)}),[e.value]);const l=e=>"Quarterly"===e||"Monthly"===e?"#00ff00":"#aaaaaa";return(0,w.jsx)("div",{style:{whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis",paddingRight:"0",width:"100%",color:l(i),cursor:"pointer",height:"100%",display:"flex",alignItems:"center"},onClick:e=>{e.stopPropagation(),r(!0)},"data-frequency":i,children:o?(0,w.jsx)("select",{value:i,onChange:async o=>{o.stopPropagation();const n=o.target.value;s(n);const i="Not Set"===n?null:n;try{const{error:t}=await a.supabase.from("contacts").update({keep_in_touch_frequency:i}).eq("contact_id",e.data.contact_id);if(t)throw t;e.api&&(e.api.refreshCells({force:!0,rowNodes:[e.node],columns:["keep_in_touch_frequency"]}),e.context&&e.context.refreshData&&setTimeout((()=>{e.context.refreshData()}),100)),u.oR.success(`Keep in touch updated for ${e.data.first_name} ${e.data.last_name}`)}catch(l){console.error("Error updating frequency:",l),u.oR.error(`Error updating keep in touch: ${l.message}`),s(t)}r(!1)},onBlur:()=>{r(!1)},onClick:e=>{e.stopPropagation()},autoFocus:!0,style:{backgroundColor:"#222",color:l(i),border:`1px solid ${l(i)}`,borderRadius:"4px",padding:"2px",fontSize:"14px",width:"100%",cursor:"pointer"},children:["Not Set","Do not keep in touch","Weekly","Monthly","Quarterly","Twice per Year","Once per Year"].map((e=>(0,w.jsx)("option",{value:e,children:"Do not keep in touch"===e?"Skip":e},e)))}):(0,w.jsx)("span",{children:"Do not keep in touch"===i?"Skip":i})})},v=(0,n.useCallback)((e=>{e.api.sizeColumnsToFit()}),[]),b=(0,n.useMemo)((()=>[{headerName:"Name",field:"name",valueGetter:e=>{if(!e.data)return"";return`${e.data.first_name||""} ${e.data.last_name||""}`.trim()||"(No name)"},cellRenderer:e=>{if(!e.value)return"-";return(0,w.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:"8px",width:"100%",height:"100%"},children:[(0,w.jsx)("div",{style:{whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis",cursor:"pointer",flex:1},onClick:()=>{e.data&&e.data.contact_id&&e.context.navigate(`/contacts/${e.data.contact_id}`)},children:e.value}),(0,w.jsx)("button",{onClick:t=>{t.stopPropagation(),e.data&&e.data.contact_id&&e.context.navigate(`/contacts/workflow/${e.data.contact_id}?step=2`)},style:{background:"none",border:"none",color:"#ffffff",cursor:"pointer",padding:"2px",display:"flex",alignItems:"center",justifyContent:"center",opacity:"0.6",transition:"opacity 0.2s"},onMouseEnter:e=>e.currentTarget.style.opacity="1",onMouseLeave:e=>e.currentTarget.style.opacity="0.6",title:"Edit Contact",children:(0,w.jsx)(l.WXf,{size:12})})]})},minWidth:150,flex:2,filter:"agTextColumnFilter",floatingFilter:!0,sortable:!0,pinned:"left"},{headerName:"Company",field:"companies",cellRenderer:re,minWidth:180,flex:2.5,filter:!0,filterValueGetter:e=>e.data&&e.data.companies&&e.data.companies.length?e.data.companies.map((e=>e.name.toLowerCase())).join(" "):"",floatingFilter:!0,sortable:!0,cellStyle:{display:"flex",alignItems:"center"}},{headerName:"Tags",field:"tags",cellRenderer:ne,minWidth:160,flex:2.3,filter:!0,filterValueGetter:e=>e.data&&e.data.tags&&e.data.tags.length?e.data.tags.map((e=>e.name.toLowerCase())).join(" "):"",floatingFilter:!0,cellStyle:{display:"flex",alignItems:"center"}},{headerName:"Rating",field:"score",cellRenderer:ae,minWidth:70,flex:.6,filter:"agNumberColumnFilter",floatingFilter:!0,sortable:!0,editable:!1},{headerName:"Keep in Touch",field:"keep_in_touch_frequency",cellRenderer:y,minWidth:110,flex:1.5,filter:!0,filterValueGetter:e=>{if(!e.data)return"";let t=e.data.keep_in_touch_frequency;return null===t||void 0===t?"not set":"Do not keep in touch"===t?t.toLowerCase()+" skip":t.toLowerCase()},floatingFilter:!0,sortable:!0,valueFormatter:e=>null===e.value||void 0===e.value?"Not Set":"Do not keep in touch"===e.value?"Skip":e.value},{headerName:"City",field:"cities",cellRenderer:ie,minWidth:110,flex:1.3,filter:!0,filterValueGetter:e=>e.data&&e.data.cities&&e.data.cities.length?e.data.cities.map((e=>e.name.toLowerCase())).join(" "):"",floatingFilter:!0,cellStyle:{display:"flex",alignItems:"center"}},{headerName:"Last",field:"last_interaction_at",cellRenderer:se,minWidth:65,flex:.8,filter:"agDateColumnFilter",floatingFilter:!0,sortable:!0,sort:"desc",initialSort:!0},{headerName:"Actions",field:"actions",cellRenderer:le,minWidth:110,flex:1,sortable:!1,filter:!1,pinned:"right",cellStyle:{display:"flex",alignItems:"center",justifyContent:"center",padding:"0 12px 0 0",backgroundColor:"#111",margin:"0",borderRight:"none"},width:140,maxWidth:140,minWidth:140}]),[]),x=(0,n.useMemo)((()=>({resizable:!0})),[]),C=(0,n.useCallback)((e=>36),[]),_=(0,n.useCallback)((e=>({background:e.node.rowIndex%2===0?"#121212":"#1a1a1a",borderRight:"none","&:hover":{background:e.node.rowIndex%2===0?"#121212":"#1a1a1a"},"&.ag-row-selected":{background:e.node.rowIndex%2===0?"#121212":"#1a1a1a"}})),[]),S=async()=>{try{d(!0),h(null);let e=a.supabase.from("contacts").select("\n            contact_id, \n            first_name, \n            last_name, \n            score,\n            last_interaction_at,\n            created_at,\n            keep_in_touch_frequency,\n            linkedin,\n            job_role,\n            category\n          ").order("first_name",{ascending:!0}).limit(1e3);if("all-except-skip"===t)e=e.neq("category","Skip");else if("rockstars-score-5"===t)e=e.eq("score",5);else if("Inbox"===t)e=e.eq("category","Inbox").not("last_interaction_at","is",null);else if("recent-30-days"===t){const t=new Date;t.setDate(t.getDate()-30),e=a.supabase.from("contacts").select("\n              contact_id, \n              first_name, \n              last_name, \n              score,\n              last_interaction_at,\n              created_at,\n              keep_in_touch_frequency,\n              linkedin,\n              job_role,\n              category\n            ").gte("last_interaction_at",t.toISOString()).not("last_interaction_at","is",null).neq("category","Skip").order("last_interaction_at",{ascending:!1}).limit(1e3)}else if("recent-created"===t){const t=new Date;t.setDate(t.getDate()-10),e=a.supabase.from("contacts").select("\n              contact_id, \n              first_name, \n              last_name, \n              score,\n              last_interaction_at,\n              created_at,\n              keep_in_touch_frequency,\n              linkedin,\n              job_role,\n              category\n            ").gte("created_at",t.toISOString()).neq("category","Skip").order("created_at",{ascending:!1}).limit(1e3)}else if("recent-edited"===t){const t=new Date;t.setDate(t.getDate()-10),e=a.supabase.from("contacts").select("\n              contact_id, \n              first_name, \n              last_name, \n              score,\n              last_interaction_at,\n              created_at,\n              last_modified_at,\n              keep_in_touch_frequency,\n              linkedin,\n              job_role,\n              category\n            ").gte("last_modified_at",t.toISOString()).neq("category","Skip").order("last_modified_at",{ascending:!1}).limit(1e3)}else t&&(e=e.eq("category",t));const{data:o,error:n}=await e;if(n)throw n;if(!o||0===o.length)return i([]),void d(!1);const r=o.map((e=>e.contact_id)),s=$(r,30),l={data:[]},c={data:[]},u={data:[]},p={data:[]},f={data:[]};for(const t of s){const[e,o,n,r,i]=await Promise.all([a.supabase.from("contact_companies").select("contact_id, company_id").in("contact_id",t),a.supabase.from("contact_tags").select("contact_id, tag_id").in("contact_id",t),a.supabase.from("contact_cities").select("contact_id, city_id").in("contact_id",t),a.supabase.from("contact_emails").select("contact_id, email, is_primary").in("contact_id",t),a.supabase.from("contact_mobiles").select("contact_id, mobile, is_primary").in("contact_id",t)]);if(e.error)throw e.error;if(o.error)throw o.error;if(n.error)throw n.error;if(r.error)throw r.error;if(i.error)throw i.error;l.data.push(...e.data||[]),c.data.push(...o.data||[]),u.data.push(...n.data||[]),p.data.push(...r.data||[]),f.data.push(...i.data||[])}const g=[...new Set(l.data.map((e=>e.company_id)))],m=[...new Set(c.data.map((e=>e.tag_id)))],y=[...new Set(u.data.map((e=>e.city_id)))],v=$(g,30),b=$(m,30),x=$(y,30),w={data:[]},C={data:[]},_={data:[]};if(g.length>0)for(const t of v){const{data:e,error:o}=await a.supabase.from("companies").select("company_id, name, website").in("company_id",t);if(o)throw o;w.data.push(...e||[])}if(m.length>0)for(const t of b){const{data:e,error:o}=await a.supabase.from("tags").select("tag_id, name").in("tag_id",t);if(o)throw o;C.data.push(...e||[])}if(y.length>0)for(const t of x){const{data:e,error:o}=await a.supabase.from("cities").select("city_id, name").in("city_id",t);if(o)throw o;_.data.push(...e||[])}const S=o.map((e=>{const t=l.data.filter((t=>t.contact_id===e.contact_id)),o=c.data.filter((t=>t.contact_id===e.contact_id)),n=u.data.filter((t=>t.contact_id===e.contact_id)),r=p.data.filter((t=>t.contact_id===e.contact_id)),i=r.find((e=>e.is_primary)),a=(null===i||void 0===i?void 0:i.email)||(r.length>0?r[0].email:null),s=f.data.filter((t=>t.contact_id===e.contact_id)),d=s.find((e=>e.is_primary)),h=(null===d||void 0===d?void 0:d.mobile)||(s.length>0?s[0].mobile:null),g=t.map((e=>{const t=w.data.find((t=>t.company_id===e.company_id));return t?{id:t.company_id,name:t.name||"Unknown",website:t.website}:null})).filter(Boolean),m=o.map((e=>{const t=C.data.find((t=>t.tag_id===e.tag_id));return t?{id:t.tag_id,name:t.name||"Unknown Tag"}:null})).filter(Boolean),y=n.map((e=>{const t=_.data.find((t=>t.city_id===e.city_id));return t?{id:t.city_id,name:t.name||"Unknown Location"}:null})).filter(Boolean);return{...e,email:a,mobile:h,companies:g,tags:m,cities:y}}));i(S),d(!1)}catch(e){console.error("Error fetching contacts:",e),h(e.message),d(!1)}};return(0,n.useEffect)((()=>{S()}),[t]),(0,n.useEffect)((()=>{if(!f)return;let e,t;const o=()=>{clearTimeout(e),cancelAnimationFrame(t),e=setTimeout((()=>{t=requestAnimationFrame((()=>{try{f.sizeColumnsToFit()}catch(e){console.warn("Error resizing grid:",e)}}))}),500)};return window.addEventListener("resize",o,{passive:!0}),()=>{window.removeEventListener("resize",o,{passive:!0}),clearTimeout(e),cancelAnimationFrame(t)}}),[f]),(0,w.jsxs)(W,{children:[(0,w.jsx)(U,{}),p&&(0,w.jsxs)(q,{children:["Error: ",p]}),c?(0,w.jsxs)(K,{children:[(0,w.jsx)(J,{children:"Loading contacts..."}),(0,w.jsx)(Y,{})]}):0===o.length?(0,w.jsx)("div",{style:{padding:"40px",textAlign:"center",color:"#00ff00",background:"#121212",borderRadius:"8px"},children:"No contacts found for this category."}):(0,w.jsx)("div",{className:"ag-theme-alpine",style:{height:"calc(100% - 5px)",width:"100%",overflowX:"hidden",boxSizing:"border-box",marginRight:"5px","--ag-background-color":"#121212","--ag-odd-row-background-color":"#1a1a1a","--ag-header-background-color":"#222222","--ag-header-foreground-color":"#00ff00","--ag-foreground-color":"#e0e0e0","--ag-row-hover-color":"transparent","--ag-border-color":"#333333","--ag-cell-horizontal-padding":"8px","--ag-borders":"none","--ag-header-height":"32px","--ag-header-column-separator-display":"none","--ag-font-size":"12px","--ag-paging-panel-height":"42px","--ag-row-height":"36px"},children:(0,w.jsx)(s.W,{rowData:o,columnDefs:b,defaultColDef:x,onGridReady:e=>{g(e.api),requestAnimationFrame((()=>{setTimeout((()=>{try{e.api.sizeColumnsToFit(),setTimeout((()=>{try{e.api.applyColumnState?e.api.applyColumnState({state:[{colId:"last_interaction_at",sort:"desc"}],defaultState:{sort:null}}):e.api.setColumnState&&e.api.setColumnState([{colId:"last_interaction_at",sort:"desc"}])}catch(t){console.warn("Error setting column state:",t)}}),300)}catch(t){console.warn("Error sizing columns:",t)}}),200)}))},context:{navigate:m,refreshData:()=>{c||S()}},rowSelection:"none",animateRows:!1,pagination:!0,paginationPageSize:100,suppressCellFocus:!0,enableCellTextSelection:!0,getRowHeight:C,getRowStyle:_,onFirstDataRendered:v,suppressHorizontalScroll:!0,paginationNumberFormatter:e=>`${e.value}`,alwaysShowHorizontalScroll:!1,alwaysShowVerticalScroll:!1,overlayNoRowsTemplate:'<span style="padding: 10px; border: 1px solid #00ff00; background: #121212; color: #00ff00;">No contacts found</span>'})})]})}},7849:function(e,t,o){"use strict";var n=this&&this.__extends||function(){var e=function(t,o){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])},e(t,o)};return function(t,o){function n(){this.constructor=t}e(t,o),t.prototype=null===o?Object.create(o):(n.prototype=o.prototype,new n)}}(),r=this&&this.__assign||function(){return r=Object.assign||function(e){for(var t,o=1,n=arguments.length;o<n;o++)for(var r in t=arguments[o])Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e},r.apply(this,arguments)},i=this&&this.__createBinding||(Object.create?function(e,t,o,n){void 0===n&&(n=o),Object.defineProperty(e,n,{enumerable:!0,get:function(){return t[o]}})}:function(e,t,o,n){void 0===n&&(n=o),e[n]=t[o]}),a=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),s=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var o in e)"default"!==o&&Object.prototype.hasOwnProperty.call(e,o)&&i(t,e,o);return a(t,e),t},l=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.AgGridReactLegacy=void 0;var c=o(7079),d=l(o(5173)),u=s(o(5043)),p=o(5268),h=o(4923),f=o(2678),g=o(9385),m=function(e){function t(t){var o=e.call(this,t)||this;return o.props=t,o.api=null,o.destroyed=!1,o.SYNCHRONOUS_CHANGE_PROPERTIES=["context"],o.portalManager=new f.PortalManager(o,t.componentWrappingElement,t.maxComponentCreationTimeMs),o}return n(t,e),t.prototype.render=function(){var e=this;return u.default.createElement("div",{style:this.createStyleForDiv(),className:this.props.className,ref:function(t){e.eGridDiv=t}},this.portalManager.getPortals())},t.prototype.createStyleForDiv=function(){return r({height:"100%"},this.props.containerStyle||{})},t.prototype.componentDidMount=function(){var e=this.props.modules||[],t={providedBeanInstances:{agGridReact:this,frameworkComponentWrapper:new v(this,this.portalManager)},modules:e,frameworkOverrides:new g.ReactFrameworkOverrides(!1)},o=this.props.gridOptions||{};this.gridOptions=c.ComponentUtil.copyAttributesToGridOptions(o,this.props),this.checkForDeprecations(this.props),new c.Grid(this.eGridDiv,this.gridOptions,t),this.api=this.gridOptions.api,this.columnApi=this.gridOptions.columnApi,this.props.setGridApi(this.api,this.columnApi)},t.prototype.checkForDeprecations=function(e){e.rowDataChangeDetectionStrategy&&c._.doOnce((function(){return console.warn("AG Grid: Since v29 rowDataChangeDetectionStrategy has been deprecated. Row data property changes will be compared by reference via triple equals ===. See https://ag-grid.com/react-data-grid/react-hooks/")}),"rowDataChangeDetectionStrategy_Deprecation")},t.prototype.shouldComponentUpdate=function(e){return this.processPropsChanges(this.props,e),!1},t.prototype.componentDidUpdate=function(e){this.processPropsChanges(e,this.props)},t.prototype.processPropsChanges=function(e,t){var o={};this.extractGridPropertyChanges(e,t,o),this.processSynchronousChanges(o),this.processAsynchronousChanges(o)},t.prototype.extractGridPropertyChanges=function(e,t,o){var n=!!t.debug;Object.keys(t).forEach((function(r){c.ComponentUtil.ALL_PROPERTIES_SET.has(r)&&e[r]!==t[r]&&(n&&console.log("agGridReact: ["+r+"] property changed"),o[r]={previousValue:e[r],currentValue:t[r]})})),c.ComponentUtil.EVENT_CALLBACKS.forEach((function(r){e[r]!==t[r]&&(n&&console.log("agGridReact: ["+r+"] event callback changed"),o[r]={previousValue:e[r],currentValue:t[r]})}))},t.prototype.componentWillUnmount=function(){this.api&&(this.api.destroy(),this.api=null),this.destroyed=!0,this.portalManager.destroy()},t.prototype.isDisableStaticMarkup=function(){return!0===this.props.disableStaticMarkup},t.prototype.isLegacyComponentRendering=function(){return!0===this.props.legacyComponentRendering},t.prototype.processSynchronousChanges=function(e){var t=r({},e);if(Object.keys(t).length>0){var o={};this.SYNCHRONOUS_CHANGE_PROPERTIES.forEach((function(e){t[e]&&(o[e]=t[e],delete t[e])})),Object.keys(o).length>0&&this.api&&c.ComponentUtil.processOnChange(o,this.api)}return t},t.prototype.processAsynchronousChanges=function(e){var t=this;Object.keys(e).length>0&&window.setTimeout((function(){t.api&&c.ComponentUtil.processOnChange(e,t.api)}))},t.MAX_COMPONENT_CREATION_TIME_IN_MS=1e3,t.defaultProps={legacyComponentRendering:!1,disableStaticMarkup:!1,maxComponentCreationTimeMs:t.MAX_COMPONENT_CREATION_TIME_IN_MS},t}(u.Component);function y(e,t){e.forEach((function(e){m[e]=t}))}t.AgGridReactLegacy=m,m.propTypes={gridOptions:d.default.object},y(c.ComponentUtil.EVENT_CALLBACKS,d.default.func),y(c.ComponentUtil.BOOLEAN_PROPERTIES,d.default.bool),y(c.ComponentUtil.STRING_PROPERTIES,d.default.string),y(c.ComponentUtil.OBJECT_PROPERTIES,d.default.object),y(c.ComponentUtil.ARRAY_PROPERTIES,d.default.array),y(c.ComponentUtil.NUMBER_PROPERTIES,d.default.number),y(c.ComponentUtil.FUNCTION_PROPERTIES,d.default.func);var v=function(e){function t(t,o){var n=e.call(this)||this;return n.agGridReact=t,n.portalManager=o,n}return n(t,e),t.prototype.createWrapper=function(e,t){return this.agGridReact.isLegacyComponentRendering()?new p.LegacyReactComponent(e,this.agGridReact,this.portalManager,t):new h.NewReactComponent(e,this.portalManager,t)},t}(c.BaseComponentWrapper)},7950:(e,t,o)=>{"use strict";!function e(){if("undefined"!==typeof __REACT_DEVTOOLS_GLOBAL_HOOK__&&"function"===typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE)try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(e)}catch(t){console.error(t)}}(),e.exports=o(2730)},7980:function(e,t,o){"use strict";var n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.PostgrestError=t.PostgrestBuilder=t.PostgrestTransformBuilder=t.PostgrestFilterBuilder=t.PostgrestQueryBuilder=t.PostgrestClient=void 0;const r=n(o(1210));t.PostgrestClient=r.default;const i=n(o(8829));t.PostgrestQueryBuilder=i.default;const a=n(o(5736));t.PostgrestFilterBuilder=a.default;const s=n(o(7374));t.PostgrestTransformBuilder=s.default;const l=n(o(9286));t.PostgrestBuilder=l.default;const c=n(o(2611));t.PostgrestError=c.default,t.default={PostgrestClient:r.default,PostgrestQueryBuilder:i.default,PostgrestFilterBuilder:a.default,PostgrestTransformBuilder:s.default,PostgrestBuilder:l.default,PostgrestError:c.default}},8136:(e,t,o)=>{"use strict";o.d(t,{W:()=>n.AgGridReact});var n=o(5056)},8242:function(e,t,o){"use strict";var n=this&&this.__assign||function(){return n=Object.assign||function(e){for(var t,o=1,n=arguments.length;o<n;o++)for(var r in t=arguments[o])Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e},n.apply(this,arguments)},r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.agFlushSync=t.isComponentStateless=t.CssClasses=t.classesList=void 0;var i=r(o(7950));t.classesList=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return e.filter((function(e){return null!=e&&""!==e})).join(" ")};var a=function(){function e(){for(var e=this,t=[],o=0;o<arguments.length;o++)t[o]=arguments[o];this.classesMap={},t.forEach((function(t){e.classesMap[t]=!0}))}return e.prototype.setClass=function(t,o){if(!!this.classesMap[t]==o)return this;var r=new e;return r.classesMap=n({},this.classesMap),r.classesMap[t]=o,r},e.prototype.toString=function(){var e=this;return Object.keys(this.classesMap).filter((function(t){return e.classesMap[t]})).join(" ")},e}();t.CssClasses=a,t.isComponentStateless=function(e){return"function"===typeof e&&!(e.prototype&&e.prototype.isReactComponent)||"object"===typeof e&&e.$$typeof===("function"===typeof Symbol&&Symbol.for?Symbol.for("react.memo"):60115)};var s=null!=i.default.createRoot&&null!=i.default.flushSync;t.agFlushSync=function(e,t){s&&e?i.default.flushSync(t):t()}},8278:function(e,t,o){"use strict";var n=this&&this.__extends||function(){var e=function(t,o){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])},e(t,o)};return function(t,o){function n(){this.constructor=t}e(t,o),t.prototype=null===o?Object.create(o):(n.prototype=o.prototype,new n)}}(),r=this&&this.__assign||function(){return r=Object.assign||function(e){for(var t,o=1,n=arguments.length;o<n;o++)for(var r in t=arguments[o])Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e},r.apply(this,arguments)},i=this&&this.__createBinding||(Object.create?function(e,t,o,n){void 0===n&&(n=o),Object.defineProperty(e,n,{enumerable:!0,get:function(){return t[o]}})}:function(e,t,o,n){void 0===n&&(n=o),e[n]=t[o]}),a=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),s=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var o in e)"default"!==o&&Object.prototype.hasOwnProperty.call(e,o)&&i(t,e,o);return a(t,e),t};Object.defineProperty(t,"__esModule",{value:!0}),t.AgGridReact=void 0;var l=s(o(5043)),c=o(7849),d=o(2430),u=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.setGridApi=function(e,o){t.api=e,t.columnApi=o},t}return n(t,e),t.prototype.render=function(){return this.props.suppressReactUi?l.default.createElement(c.AgGridReactLegacy,r({},this.props,{setGridApi:this.setGridApi})):l.default.createElement(d.AgGridReactUi,r({},this.props,{setGridApi:this.setGridApi}))},t}(l.Component);t.AgGridReact=u},8293:function(e,t,o){"use strict";var n=this&&this.__assign||function(){return n=Object.assign||function(e){for(var t,o=1,n=arguments.length;o<n;o++)for(var r in t=arguments[o])Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e},n.apply(this,arguments)},r=this&&this.__createBinding||(Object.create?function(e,t,o,n){void 0===n&&(n=o),Object.defineProperty(e,n,{enumerable:!0,get:function(){return t[o]}})}:function(e,t,o,n){void 0===n&&(n=o),e[n]=t[o]}),i=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),a=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var o in e)"default"!==o&&Object.prototype.hasOwnProperty.call(e,o)&&r(t,e,o);return i(t,e),t};Object.defineProperty(t,"__esModule",{value:!0});var s=a(o(5043)),l=o(9201),c=o(7079),d=o(8242),u=o(3183),p=o(9724);t.default=s.memo((function(e){var t=s.useContext(l.BeansContext).context,o=s.useState(new d.CssClasses("ag-header-cell","ag-floating-filter")),r=o[0],i=o[1],a=s.useState(new d.CssClasses),h=a[0],f=a[1],g=s.useState(new d.CssClasses("ag-floating-filter-button","ag-hidden")),m=g[0],y=g[1],v=s.useState("false"),b=v[0],x=v[1],w=s.useState(),C=w[0],_=w[1],S=s.useRef(null),E=s.useRef(null),k=s.useRef(null),j=s.useRef(null),A=s.useRef(!1),R=s.useRef(),O=s.useRef();p.useLayoutEffectOnce((function(){O.current=new c.AgPromise((function(e){R.current=e}))}));var T=function(e){A.current||null!=e&&(R.current&&R.current(e),A.current=!0)},D=e.ctrl;p.useLayoutEffectOnce((function(){var e={addOrRemoveCssClass:function(e,t){return i((function(o){return o.setClass(e,t)}))},addOrRemoveBodyCssClass:function(e,t){return f((function(o){return o.setClass(e,t)}))},setButtonWrapperDisplayed:function(e){y((function(t){return t.setClass("ag-hidden",!e)})),x(e?"false":"true")},setWidth:function(e){return S.current.style.width=e},setCompDetails:function(e){return _(e)},getFloatingFilterComp:function(){return O.current?O.current:null},setMenuIcon:function(e){return j.current.appendChild(e)}};D.setComp(e,S.current,j.current,E.current)})),s.useLayoutEffect((function(){return u.showJsComp(C,t,E.current,T)}),[C]);var P=s.useMemo((function(){return r.toString()}),[r]),N=s.useMemo((function(){return h.toString()}),[h]),I=s.useMemo((function(){return m.toString()}),[m]),M=s.useMemo((function(){return!!(C&&C.componentFromFramework&&d.isComponentStateless(C.componentClass))}),[C]),L=C&&C.componentFromFramework,F=C&&C.componentClass;return s.default.createElement("div",{ref:S,className:P,role:"gridcell",tabIndex:-1},s.default.createElement("div",{ref:E,className:N,role:"presentation"},L&&M&&s.default.createElement(F,n({},C.params)),L&&!M&&s.default.createElement(F,n({},C.params,{ref:T}))),s.default.createElement("div",{ref:k,"aria-hidden":b,className:I,role:"presentation"},s.default.createElement("button",{ref:j,type:"button","aria-label":"Open Filter Menu",className:"ag-floating-filter-button-button",tabIndex:-1})))}))},8355:(e,t,o)=>{"use strict";function n(e){if(null===e||!0===e||!1===e)return NaN;var t=Number(e);return isNaN(t)?t:t<0?Math.ceil(t):Math.floor(t)}o.d(t,{A:()=>n})},8556:(e,t,o)=>{"use strict";var n=o(5043);function r(e){for(var t="https://reactjs.org/docs/error-decoder.html?invariant="+e,o=1;o<arguments.length;o++)t+="&args[]="+encodeURIComponent(arguments[o]);return"Minified React error #"+e+"; visit "+t+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var i=null,a=0;function s(e,t){if(0!==t.length)if(512<t.length)0<a&&(e.enqueue(new Uint8Array(i.buffer,0,a)),i=new Uint8Array(512),a=0),e.enqueue(t);else{var o=i.length-a;o<t.length&&(0===o?e.enqueue(i):(i.set(t.subarray(0,o),a),e.enqueue(i),t=t.subarray(o)),i=new Uint8Array(512),a=0),i.set(t,a),a+=t.length}}function l(e,t){return s(e,t),!0}function c(e){i&&0<a&&(e.enqueue(new Uint8Array(i.buffer,0,a)),i=null,a=0)}var d=new TextEncoder;function u(e){return d.encode(e)}function p(e){return d.encode(e)}function h(e,t){"function"===typeof e.error?e.error(t):e.close()}var f=Object.prototype.hasOwnProperty,g=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,m={},y={};function v(e){return!!f.call(y,e)||!f.call(m,e)&&(g.test(e)?y[e]=!0:(m[e]=!0,!1))}function b(e,t,o,n,r,i,a){this.acceptsBooleans=2===t||3===t||4===t,this.attributeName=n,this.attributeNamespace=r,this.mustUseProperty=o,this.propertyName=e,this.type=t,this.sanitizeURL=i,this.removeEmptyString=a}var x={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach((function(e){x[e]=new b(e,0,!1,e,null,!1,!1)})),[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach((function(e){var t=e[0];x[t]=new b(t,1,!1,e[1],null,!1,!1)})),["contentEditable","draggable","spellCheck","value"].forEach((function(e){x[e]=new b(e,2,!1,e.toLowerCase(),null,!1,!1)})),["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach((function(e){x[e]=new b(e,2,!1,e,null,!1,!1)})),"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach((function(e){x[e]=new b(e,3,!1,e.toLowerCase(),null,!1,!1)})),["checked","multiple","muted","selected"].forEach((function(e){x[e]=new b(e,3,!0,e,null,!1,!1)})),["capture","download"].forEach((function(e){x[e]=new b(e,4,!1,e,null,!1,!1)})),["cols","rows","size","span"].forEach((function(e){x[e]=new b(e,6,!1,e,null,!1,!1)})),["rowSpan","start"].forEach((function(e){x[e]=new b(e,5,!1,e.toLowerCase(),null,!1,!1)}));var w=/[\-:]([a-z])/g;function C(e){return e[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach((function(e){var t=e.replace(w,C);x[t]=new b(t,1,!1,e,null,!1,!1)})),"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach((function(e){var t=e.replace(w,C);x[t]=new b(t,1,!1,e,"http://www.w3.org/1999/xlink",!1,!1)})),["xml:base","xml:lang","xml:space"].forEach((function(e){var t=e.replace(w,C);x[t]=new b(t,1,!1,e,"http://www.w3.org/XML/1998/namespace",!1,!1)})),["tabIndex","crossOrigin"].forEach((function(e){x[e]=new b(e,1,!1,e.toLowerCase(),null,!1,!1)})),x.xlinkHref=new b("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1),["src","href","action","formAction"].forEach((function(e){x[e]=new b(e,1,!1,e.toLowerCase(),null,!0,!0)}));var _={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},S=["Webkit","ms","Moz","O"];Object.keys(_).forEach((function(e){S.forEach((function(t){t=t+e.charAt(0).toUpperCase()+e.substring(1),_[t]=_[e]}))}));var E=/["'&<>]/;function k(e){if("boolean"===typeof e||"number"===typeof e)return""+e;e=""+e;var t=E.exec(e);if(t){var o,n="",r=0;for(o=t.index;o<e.length;o++){switch(e.charCodeAt(o)){case 34:t="&quot;";break;case 38:t="&amp;";break;case 39:t="&#x27;";break;case 60:t="&lt;";break;case 62:t="&gt;";break;default:continue}r!==o&&(n+=e.substring(r,o)),r=o+1,n+=t}e=r!==o?n+e.substring(r,o):n}return e}var j=/([A-Z])/g,A=/^ms-/,R=Array.isArray,O=p("<script>"),T=p("<\/script>"),D=p('<script src="'),P=p('<script type="module" src="'),N=p('" async=""><\/script>'),I=/(<\/|<)(s)(cript)/gi;function M(e,t,o,n){return t+("s"===o?"\\u0073":"\\u0053")+n}function L(e,t){return{insertionMode:e,selectedValue:t}}var F=p("\x3c!-- --\x3e");function G(e,t,o,n){return""===t?n:(n&&e.push(F),e.push(u(k(t))),!0)}var z=new Map,H=p(' style="'),B=p(":"),V=p(";");function $(e,t,o){if("object"!==typeof o)throw Error(r(62));for(var n in t=!0,o)if(f.call(o,n)){var i=o[n];if(null!=i&&"boolean"!==typeof i&&""!==i){if(0===n.indexOf("--")){var a=u(k(n));i=u(k((""+i).trim()))}else{a=n;var s=z.get(a);void 0!==s||(s=p(k(a.replace(j,"-$1").toLowerCase().replace(A,"-ms-"))),z.set(a,s)),a=s,i="number"===typeof i?0===i||f.call(_,n)?u(""+i):u(i+"px"):u(k((""+i).trim()))}t?(t=!1,e.push(H,a,B,i)):e.push(V,a,B,i)}}t||e.push(q)}var U=p(" "),W=p('="'),q=p('"'),K=p('=""');function Y(e,t,o,n){switch(o){case"style":return void $(e,t,n);case"defaultValue":case"defaultChecked":case"innerHTML":case"suppressContentEditableWarning":case"suppressHydrationWarning":return}if(!(2<o.length)||"o"!==o[0]&&"O"!==o[0]||"n"!==o[1]&&"N"!==o[1])if(null!==(t=x.hasOwnProperty(o)?x[o]:null)){switch(typeof n){case"function":case"symbol":return;case"boolean":if(!t.acceptsBooleans)return}switch(o=u(t.attributeName),t.type){case 3:n&&e.push(U,o,K);break;case 4:!0===n?e.push(U,o,K):!1!==n&&e.push(U,o,W,u(k(n)),q);break;case 5:isNaN(n)||e.push(U,o,W,u(k(n)),q);break;case 6:!isNaN(n)&&1<=n&&e.push(U,o,W,u(k(n)),q);break;default:t.sanitizeURL&&(n=""+n),e.push(U,o,W,u(k(n)),q)}}else if(v(o)){switch(typeof n){case"function":case"symbol":return;case"boolean":if("data-"!==(t=o.toLowerCase().slice(0,5))&&"aria-"!==t)return}e.push(U,u(o),W,u(k(n)),q)}}var J=p(">"),X=p("/>");function Q(e,t,o){if(null!=t){if(null!=o)throw Error(r(60));if("object"!==typeof t||!("__html"in t))throw Error(r(61));null!==(t=t.__html)&&void 0!==t&&e.push(u(""+t))}}var Z=p(' selected=""');function ee(e,t,o,n){e.push(re(o));var r,i=o=null;for(r in t)if(f.call(t,r)){var a=t[r];if(null!=a)switch(r){case"children":o=a;break;case"dangerouslySetInnerHTML":i=a;break;default:Y(e,n,r,a)}}return e.push(J),Q(e,i,o),"string"===typeof o?(e.push(u(k(o))),null):o}var te=p("\n"),oe=/^[a-zA-Z][a-zA-Z:_\.\-\d]*$/,ne=new Map;function re(e){var t=ne.get(e);if(void 0===t){if(!oe.test(e))throw Error(r(65,e));t=p("<"+e),ne.set(e,t)}return t}var ie=p("<!DOCTYPE html>");function ae(e,t,o,i,a){switch(t){case"select":e.push(re("select"));var s=null,l=null;for(h in o)if(f.call(o,h)){var c=o[h];if(null!=c)switch(h){case"children":s=c;break;case"dangerouslySetInnerHTML":l=c;break;case"defaultValue":case"value":break;default:Y(e,i,h,c)}}return e.push(J),Q(e,l,s),s;case"option":l=a.selectedValue,e.push(re("option"));var d=c=null,p=null,h=null;for(s in o)if(f.call(o,s)){var g=o[s];if(null!=g)switch(s){case"children":c=g;break;case"selected":p=g;break;case"dangerouslySetInnerHTML":h=g;break;case"value":d=g;default:Y(e,i,s,g)}}if(null!=l)if(o=null!==d?""+d:function(e){var t="";return n.Children.forEach(e,(function(e){null!=e&&(t+=e)})),t}(c),R(l)){for(i=0;i<l.length;i++)if(""+l[i]===o){e.push(Z);break}}else""+l===o&&e.push(Z);else p&&e.push(Z);return e.push(J),Q(e,h,c),c;case"textarea":for(c in e.push(re("textarea")),h=l=s=null,o)if(f.call(o,c)&&null!=(d=o[c]))switch(c){case"children":h=d;break;case"value":s=d;break;case"defaultValue":l=d;break;case"dangerouslySetInnerHTML":throw Error(r(91));default:Y(e,i,c,d)}if(null===s&&null!==l&&(s=l),e.push(J),null!=h){if(null!=s)throw Error(r(92));if(R(h)&&1<h.length)throw Error(r(93));s=""+h}return"string"===typeof s&&"\n"===s[0]&&e.push(te),null!==s&&e.push(u(k(""+s))),null;case"input":for(l in e.push(re("input")),d=h=c=s=null,o)if(f.call(o,l)&&null!=(p=o[l]))switch(l){case"children":case"dangerouslySetInnerHTML":throw Error(r(399,"input"));case"defaultChecked":d=p;break;case"defaultValue":c=p;break;case"checked":h=p;break;case"value":s=p;break;default:Y(e,i,l,p)}return null!==h?Y(e,i,"checked",h):null!==d&&Y(e,i,"checked",d),null!==s?Y(e,i,"value",s):null!==c&&Y(e,i,"value",c),e.push(X),null;case"menuitem":for(var m in e.push(re("menuitem")),o)if(f.call(o,m)&&null!=(s=o[m]))switch(m){case"children":case"dangerouslySetInnerHTML":throw Error(r(400));default:Y(e,i,m,s)}return e.push(J),null;case"title":for(g in e.push(re("title")),s=null,o)if(f.call(o,g)&&null!=(l=o[g]))switch(g){case"children":s=l;break;case"dangerouslySetInnerHTML":throw Error(r(434));default:Y(e,i,g,l)}return e.push(J),s;case"listing":case"pre":for(d in e.push(re(t)),l=s=null,o)if(f.call(o,d)&&null!=(c=o[d]))switch(d){case"children":s=c;break;case"dangerouslySetInnerHTML":l=c;break;default:Y(e,i,d,c)}if(e.push(J),null!=l){if(null!=s)throw Error(r(60));if("object"!==typeof l||!("__html"in l))throw Error(r(61));null!==(o=l.__html)&&void 0!==o&&("string"===typeof o&&0<o.length&&"\n"===o[0]?e.push(te,u(o)):e.push(u(""+o)))}return"string"===typeof s&&"\n"===s[0]&&e.push(te),s;case"area":case"base":case"br":case"col":case"embed":case"hr":case"img":case"keygen":case"link":case"meta":case"param":case"source":case"track":case"wbr":for(var y in e.push(re(t)),o)if(f.call(o,y)&&null!=(s=o[y]))switch(y){case"children":case"dangerouslySetInnerHTML":throw Error(r(399,t));default:Y(e,i,y,s)}return e.push(X),null;case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return ee(e,o,t,i);case"html":return 0===a.insertionMode&&e.push(ie),ee(e,o,t,i);default:if(-1===t.indexOf("-")&&"string"!==typeof o.is)return ee(e,o,t,i);for(p in e.push(re(t)),l=s=null,o)if(f.call(o,p)&&null!=(c=o[p]))switch(p){case"children":s=c;break;case"dangerouslySetInnerHTML":l=c;break;case"style":$(e,i,c);break;case"suppressContentEditableWarning":case"suppressHydrationWarning":break;default:v(p)&&"function"!==typeof c&&"symbol"!==typeof c&&e.push(U,u(p),W,u(k(c)),q)}return e.push(J),Q(e,l,s),s}}var se=p("</"),le=p(">"),ce=p('<template id="'),de=p('"></template>'),ue=p("\x3c!--$--\x3e"),pe=p('\x3c!--$?--\x3e<template id="'),he=p('"></template>'),fe=p("\x3c!--$!--\x3e"),ge=p("\x3c!--/$--\x3e"),me=p("<template"),ye=p('"'),ve=p(' data-dgst="');p(' data-msg="'),p(' data-stck="');var be=p("></template>");function xe(e,t,o){if(s(e,pe),null===o)throw Error(r(395));return s(e,o),l(e,he)}var we=p('<div hidden id="'),Ce=p('">'),_e=p("</div>"),Se=p('<svg aria-hidden="true" style="display:none" id="'),Ee=p('">'),ke=p("</svg>"),je=p('<math aria-hidden="true" style="display:none" id="'),Ae=p('">'),Re=p("</math>"),Oe=p('<table hidden id="'),Te=p('">'),De=p("</table>"),Pe=p('<table hidden><tbody id="'),Ne=p('">'),Ie=p("</tbody></table>"),Me=p('<table hidden><tr id="'),Le=p('">'),Fe=p("</tr></table>"),Ge=p('<table hidden><colgroup id="'),ze=p('">'),He=p("</colgroup></table>");var Be=p('function $RS(a,b){a=document.getElementById(a);b=document.getElementById(b);for(a.parentNode.removeChild(a);a.firstChild;)b.parentNode.insertBefore(a.firstChild,b);b.parentNode.removeChild(b)};$RS("'),Ve=p('$RS("'),$e=p('","'),Ue=p('")<\/script>'),We=p('function $RC(a,b){a=document.getElementById(a);b=document.getElementById(b);b.parentNode.removeChild(b);if(a){a=a.previousSibling;var f=a.parentNode,c=a.nextSibling,e=0;do{if(c&&8===c.nodeType){var d=c.data;if("/$"===d)if(0===e)break;else e--;else"$"!==d&&"$?"!==d&&"$!"!==d||e++}d=c.nextSibling;f.removeChild(c);c=d}while(c);for(;b.firstChild;)f.insertBefore(b.firstChild,c);a.data="$";a._reactRetry&&a._reactRetry()}};$RC("'),qe=p('$RC("'),Ke=p('","'),Ye=p('")<\/script>'),Je=p('function $RX(b,c,d,e){var a=document.getElementById(b);a&&(b=a.previousSibling,b.data="$!",a=a.dataset,c&&(a.dgst=c),d&&(a.msg=d),e&&(a.stck=e),b._reactRetry&&b._reactRetry())};$RX("'),Xe=p('$RX("'),Qe=p('"'),Ze=p(")<\/script>"),et=p(","),tt=/[<\u2028\u2029]/g;function ot(e){return JSON.stringify(e).replace(tt,(function(e){switch(e){case"<":return"\\u003c";case"\u2028":return"\\u2028";case"\u2029":return"\\u2029";default:throw Error("escapeJSStringsForInstructionScripts encountered a match it does not know how to replace. this means the match regex and the replacement characters are no longer in sync. This is a bug in React")}}))}var nt=Object.assign,rt=Symbol.for("react.element"),it=Symbol.for("react.portal"),at=Symbol.for("react.fragment"),st=Symbol.for("react.strict_mode"),lt=Symbol.for("react.profiler"),ct=Symbol.for("react.provider"),dt=Symbol.for("react.context"),ut=Symbol.for("react.forward_ref"),pt=Symbol.for("react.suspense"),ht=Symbol.for("react.suspense_list"),ft=Symbol.for("react.memo"),gt=Symbol.for("react.lazy"),mt=Symbol.for("react.scope"),yt=Symbol.for("react.debug_trace_mode"),vt=Symbol.for("react.legacy_hidden"),bt=Symbol.for("react.default_value"),xt=Symbol.iterator;function wt(e){if(null==e)return null;if("function"===typeof e)return e.displayName||e.name||null;if("string"===typeof e)return e;switch(e){case at:return"Fragment";case it:return"Portal";case lt:return"Profiler";case st:return"StrictMode";case pt:return"Suspense";case ht:return"SuspenseList"}if("object"===typeof e)switch(e.$$typeof){case dt:return(e.displayName||"Context")+".Consumer";case ct:return(e._context.displayName||"Context")+".Provider";case ut:var t=e.render;return(e=e.displayName)||(e=""!==(e=t.displayName||t.name||"")?"ForwardRef("+e+")":"ForwardRef"),e;case ft:return null!==(t=e.displayName||null)?t:wt(e.type)||"Memo";case gt:t=e._payload,e=e._init;try{return wt(e(t))}catch(o){}}return null}var Ct={};function _t(e,t){if(!(e=e.contextTypes))return Ct;var o,n={};for(o in e)n[o]=t[o];return n}var St=null;function Et(e,t){if(e!==t){e.context._currentValue=e.parentValue,e=e.parent;var o=t.parent;if(null===e){if(null!==o)throw Error(r(401))}else{if(null===o)throw Error(r(401));Et(e,o)}t.context._currentValue=t.value}}function kt(e){e.context._currentValue=e.parentValue,null!==(e=e.parent)&&kt(e)}function jt(e){var t=e.parent;null!==t&&jt(t),e.context._currentValue=e.value}function At(e,t){if(e.context._currentValue=e.parentValue,null===(e=e.parent))throw Error(r(402));e.depth===t.depth?Et(e,t):At(e,t)}function Rt(e,t){var o=t.parent;if(null===o)throw Error(r(402));e.depth===o.depth?Et(e,o):Rt(e,o),t.context._currentValue=t.value}function Ot(e){var t=St;t!==e&&(null===t?jt(e):null===e?kt(t):t.depth===e.depth?Et(t,e):t.depth>e.depth?At(t,e):Rt(t,e),St=e)}var Tt={isMounted:function(){return!1},enqueueSetState:function(e,t){null!==(e=e._reactInternals).queue&&e.queue.push(t)},enqueueReplaceState:function(e,t){(e=e._reactInternals).replace=!0,e.queue=[t]},enqueueForceUpdate:function(){}};function Dt(e,t,o,n){var r=void 0!==e.state?e.state:null;e.updater=Tt,e.props=o,e.state=r;var i={queue:[],replace:!1};e._reactInternals=i;var a=t.contextType;if(e.context="object"===typeof a&&null!==a?a._currentValue:n,"function"===typeof(a=t.getDerivedStateFromProps)&&(r=null===(a=a(o,r))||void 0===a?r:nt({},r,a),e.state=r),"function"!==typeof t.getDerivedStateFromProps&&"function"!==typeof e.getSnapshotBeforeUpdate&&("function"===typeof e.UNSAFE_componentWillMount||"function"===typeof e.componentWillMount))if(t=e.state,"function"===typeof e.componentWillMount&&e.componentWillMount(),"function"===typeof e.UNSAFE_componentWillMount&&e.UNSAFE_componentWillMount(),t!==e.state&&Tt.enqueueReplaceState(e,e.state,null),null!==i.queue&&0<i.queue.length)if(t=i.queue,a=i.replace,i.queue=null,i.replace=!1,a&&1===t.length)e.state=t[0];else{for(i=a?t[0]:e.state,r=!0,a=a?1:0;a<t.length;a++){var s=t[a];null!=(s="function"===typeof s?s.call(e,i,o,n):s)&&(r?(r=!1,i=nt({},i,s)):nt(i,s))}e.state=i}else i.queue=null}var Pt={id:1,overflow:""};function Nt(e,t,o){var n=e.id;e=e.overflow;var r=32-It(n)-1;n&=~(1<<r),o+=1;var i=32-It(t)+r;if(30<i){var a=r-r%5;return i=(n&(1<<a)-1).toString(32),n>>=a,r-=a,{id:1<<32-It(t)+r|o<<r|n,overflow:i+e}}return{id:1<<i|o<<r|n,overflow:e}}var It=Math.clz32?Math.clz32:function(e){return 0===(e>>>=0)?32:31-(Mt(e)/Lt|0)|0},Mt=Math.log,Lt=Math.LN2;var Ft="function"===typeof Object.is?Object.is:function(e,t){return e===t&&(0!==e||1/e===1/t)||e!==e&&t!==t},Gt=null,zt=null,Ht=null,Bt=null,Vt=!1,$t=!1,Ut=0,Wt=null,qt=0;function Kt(){if(null===Gt)throw Error(r(321));return Gt}function Yt(){if(0<qt)throw Error(r(312));return{memoizedState:null,queue:null,next:null}}function Jt(){return null===Bt?null===Ht?(Vt=!1,Ht=Bt=Yt()):(Vt=!0,Bt=Ht):null===Bt.next?(Vt=!1,Bt=Bt.next=Yt()):(Vt=!0,Bt=Bt.next),Bt}function Xt(){zt=Gt=null,$t=!1,Ht=null,qt=0,Bt=Wt=null}function Qt(e,t){return"function"===typeof t?t(e):t}function Zt(e,t,o){if(Gt=Kt(),Bt=Jt(),Vt){var n=Bt.queue;if(t=n.dispatch,null!==Wt&&void 0!==(o=Wt.get(n))){Wt.delete(n),n=Bt.memoizedState;do{n=e(n,o.action),o=o.next}while(null!==o);return Bt.memoizedState=n,[n,t]}return[Bt.memoizedState,t]}return e=e===Qt?"function"===typeof t?t():t:void 0!==o?o(t):t,Bt.memoizedState=e,e=(e=Bt.queue={last:null,dispatch:null}).dispatch=to.bind(null,Gt,e),[Bt.memoizedState,e]}function eo(e,t){if(Gt=Kt(),t=void 0===t?null:t,null!==(Bt=Jt())){var o=Bt.memoizedState;if(null!==o&&null!==t){var n=o[1];e:if(null===n)n=!1;else{for(var r=0;r<n.length&&r<t.length;r++)if(!Ft(t[r],n[r])){n=!1;break e}n=!0}if(n)return o[0]}}return e=e(),Bt.memoizedState=[e,t],e}function to(e,t,o){if(25<=qt)throw Error(r(301));if(e===Gt)if($t=!0,e={action:o,next:null},null===Wt&&(Wt=new Map),void 0===(o=Wt.get(t)))Wt.set(t,e);else{for(t=o;null!==t.next;)t=t.next;t.next=e}}function oo(){throw Error(r(394))}function no(){}var ro={readContext:function(e){return e._currentValue},useContext:function(e){return Kt(),e._currentValue},useMemo:eo,useReducer:Zt,useRef:function(e){Gt=Kt();var t=(Bt=Jt()).memoizedState;return null===t?(e={current:e},Bt.memoizedState=e):t},useState:function(e){return Zt(Qt,e)},useInsertionEffect:no,useLayoutEffect:function(){},useCallback:function(e,t){return eo((function(){return e}),t)},useImperativeHandle:no,useEffect:no,useDebugValue:no,useDeferredValue:function(e){return Kt(),e},useTransition:function(){return Kt(),[!1,oo]},useId:function(){var e=zt.treeContext,t=e.overflow;e=((e=e.id)&~(1<<32-It(e)-1)).toString(32)+t;var o=io;if(null===o)throw Error(r(404));return t=Ut++,e=":"+o.idPrefix+"R"+e,0<t&&(e+="H"+t.toString(32)),e+":"},useMutableSource:function(e,t){return Kt(),t(e._source)},useSyncExternalStore:function(e,t,o){if(void 0===o)throw Error(r(407));return o()}},io=null,ao=n.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentDispatcher;function so(e){return console.error(e),null}function lo(){}function co(e,t,o,n,r,i,a,s){e.allPendingTasks++,null===o?e.pendingRootTasks++:o.pendingTasks++;var l={node:t,ping:function(){var t=e.pingedTasks;t.push(l),1===t.length&&Eo(e)},blockedBoundary:o,blockedSegment:n,abortSet:r,legacyContext:i,context:a,treeContext:s};return r.add(l),l}function uo(e,t,o,n,r,i){return{status:0,id:-1,index:t,parentFlushed:!1,chunks:[],children:[],formatContext:n,boundary:o,lastPushedText:r,textEmbedded:i}}function po(e,t){if(null!=(e=e.onError(t))&&"string"!==typeof e)throw Error('onError returned something with a type other than "string". onError should return a string and may return null or undefined but must not return anything else. It received something of type "'+typeof e+'" instead');return e}function ho(e,t){var o=e.onShellError;o(t),(o=e.onFatalError)(t),null!==e.destination?(e.status=2,h(e.destination,t)):(e.status=1,e.fatalError=t)}function fo(e,t,o,n,r){for(Gt={},zt=t,Ut=0,e=o(n,r);$t;)$t=!1,Ut=0,qt+=1,Bt=null,e=o(n,r);return Xt(),e}function go(e,t,o,n){var i=o.render(),a=n.childContextTypes;if(null!==a&&void 0!==a){var s=t.legacyContext;if("function"!==typeof o.getChildContext)n=s;else{for(var l in o=o.getChildContext())if(!(l in a))throw Error(r(108,wt(n)||"Unknown",l));n=nt({},s,o)}t.legacyContext=n,vo(e,t,i),t.legacyContext=s}else vo(e,t,i)}function mo(e,t){if(e&&e.defaultProps){for(var o in t=nt({},t),e=e.defaultProps)void 0===t[o]&&(t[o]=e[o]);return t}return t}function yo(e,t,o,n,i){if("function"===typeof o)if(o.prototype&&o.prototype.isReactComponent){i=_t(o,t.legacyContext);var a=o.contextType;Dt(a=new o(n,"object"===typeof a&&null!==a?a._currentValue:i),o,n,i),go(e,t,a,o)}else{i=fo(e,t,o,n,a=_t(o,t.legacyContext));var s=0!==Ut;if("object"===typeof i&&null!==i&&"function"===typeof i.render&&void 0===i.$$typeof)Dt(i,o,n,a),go(e,t,i,o);else if(s){n=t.treeContext,t.treeContext=Nt(n,1,0);try{vo(e,t,i)}finally{t.treeContext=n}}else vo(e,t,i)}else{if("string"!==typeof o){switch(o){case vt:case yt:case st:case lt:case at:case ht:return void vo(e,t,n.children);case mt:throw Error(r(343));case pt:e:{o=t.blockedBoundary,i=t.blockedSegment,a=n.fallback,n=n.children;var l={id:null,rootSegmentID:-1,parentFlushed:!1,pendingTasks:0,forceClientRender:!1,completedSegments:[],byteSize:0,fallbackAbortableTasks:s=new Set,errorDigest:null},c=uo(0,i.chunks.length,l,i.formatContext,!1,!1);i.children.push(c),i.lastPushedText=!1;var d=uo(0,0,null,i.formatContext,!1,!1);d.parentFlushed=!0,t.blockedBoundary=l,t.blockedSegment=d;try{if(xo(e,t,n),d.lastPushedText&&d.textEmbedded&&d.chunks.push(F),d.status=1,_o(l,d),0===l.pendingTasks)break e}catch(p){d.status=4,l.forceClientRender=!0,l.errorDigest=po(e,p)}finally{t.blockedBoundary=o,t.blockedSegment=i}t=co(e,a,o,c,s,t.legacyContext,t.context,t.treeContext),e.pingedTasks.push(t)}return}if("object"===typeof o&&null!==o)switch(o.$$typeof){case ut:if(n=fo(e,t,o.render,n,i),0!==Ut){o=t.treeContext,t.treeContext=Nt(o,1,0);try{vo(e,t,n)}finally{t.treeContext=o}}else vo(e,t,n);return;case ft:return void yo(e,t,o=o.type,n=mo(o,n),i);case ct:if(i=n.children,o=o._context,n=n.value,a=o._currentValue,o._currentValue=n,St=n={parent:s=St,depth:null===s?0:s.depth+1,context:o,parentValue:a,value:n},t.context=n,vo(e,t,i),null===(e=St))throw Error(r(403));return n=e.parentValue,e.context._currentValue=n===bt?e.context._defaultValue:n,e=St=e.parent,void(t.context=e);case dt:return void vo(e,t,n=(n=n.children)(o._currentValue));case gt:return void yo(e,t,o=(i=o._init)(o._payload),n=mo(o,n),void 0)}throw Error(r(130,null==o?o:typeof o,""))}switch(a=ae((i=t.blockedSegment).chunks,o,n,e.responseState,i.formatContext),i.lastPushedText=!1,s=i.formatContext,i.formatContext=function(e,t,o){switch(t){case"select":return L(1,null!=o.value?o.value:o.defaultValue);case"svg":return L(2,null);case"math":return L(3,null);case"foreignObject":return L(1,null);case"table":return L(4,null);case"thead":case"tbody":case"tfoot":return L(5,null);case"colgroup":return L(7,null);case"tr":return L(6,null)}return 4<=e.insertionMode||0===e.insertionMode?L(1,null):e}(s,o,n),xo(e,t,a),i.formatContext=s,o){case"area":case"base":case"br":case"col":case"embed":case"hr":case"img":case"input":case"keygen":case"link":case"meta":case"param":case"source":case"track":case"wbr":break;default:i.chunks.push(se,u(o),le)}i.lastPushedText=!1}}function vo(e,t,o){if(t.node=o,"object"===typeof o&&null!==o){switch(o.$$typeof){case rt:return void yo(e,t,o.type,o.props,o.ref);case it:throw Error(r(257));case gt:var n=o._init;return void vo(e,t,o=n(o._payload))}if(R(o))return void bo(e,t,o);if(null===o||"object"!==typeof o?n=null:n="function"===typeof(n=xt&&o[xt]||o["@@iterator"])?n:null,n&&(n=n.call(o))){if(!(o=n.next()).done){var i=[];do{i.push(o.value),o=n.next()}while(!o.done);bo(e,t,i)}return}throw e=Object.prototype.toString.call(o),Error(r(31,"[object Object]"===e?"object with keys {"+Object.keys(o).join(", ")+"}":e))}"string"===typeof o?(n=t.blockedSegment).lastPushedText=G(t.blockedSegment.chunks,o,e.responseState,n.lastPushedText):"number"===typeof o&&((n=t.blockedSegment).lastPushedText=G(t.blockedSegment.chunks,""+o,e.responseState,n.lastPushedText))}function bo(e,t,o){for(var n=o.length,r=0;r<n;r++){var i=t.treeContext;t.treeContext=Nt(i,n,r);try{xo(e,t,o[r])}finally{t.treeContext=i}}}function xo(e,t,o){var n=t.blockedSegment.formatContext,r=t.legacyContext,i=t.context;try{return vo(e,t,o)}catch(l){if(Xt(),"object"!==typeof l||null===l||"function"!==typeof l.then)throw t.blockedSegment.formatContext=n,t.legacyContext=r,t.context=i,Ot(i),l;o=l;var a=t.blockedSegment,s=uo(0,a.chunks.length,null,a.formatContext,a.lastPushedText,!0);a.children.push(s),a.lastPushedText=!1,e=co(e,t.node,t.blockedBoundary,s,t.abortSet,t.legacyContext,t.context,t.treeContext).ping,o.then(e,e),t.blockedSegment.formatContext=n,t.legacyContext=r,t.context=i,Ot(i)}}function wo(e){var t=e.blockedBoundary;(e=e.blockedSegment).status=3,So(this,t,e)}function Co(e,t,o){var n=e.blockedBoundary;e.blockedSegment.status=3,null===n?(t.allPendingTasks--,2!==t.status&&(t.status=2,null!==t.destination&&t.destination.close())):(n.pendingTasks--,n.forceClientRender||(n.forceClientRender=!0,e=void 0===o?Error(r(432)):o,n.errorDigest=t.onError(e),n.parentFlushed&&t.clientRenderedBoundaries.push(n)),n.fallbackAbortableTasks.forEach((function(e){return Co(e,t,o)})),n.fallbackAbortableTasks.clear(),t.allPendingTasks--,0===t.allPendingTasks&&(n=t.onAllReady)())}function _o(e,t){if(0===t.chunks.length&&1===t.children.length&&null===t.children[0].boundary){var o=t.children[0];o.id=t.id,o.parentFlushed=!0,1===o.status&&_o(e,o)}else e.completedSegments.push(t)}function So(e,t,o){if(null===t){if(o.parentFlushed){if(null!==e.completedRootSegment)throw Error(r(389));e.completedRootSegment=o}e.pendingRootTasks--,0===e.pendingRootTasks&&(e.onShellError=lo,(t=e.onShellReady)())}else t.pendingTasks--,t.forceClientRender||(0===t.pendingTasks?(o.parentFlushed&&1===o.status&&_o(t,o),t.parentFlushed&&e.completedBoundaries.push(t),t.fallbackAbortableTasks.forEach(wo,e),t.fallbackAbortableTasks.clear()):o.parentFlushed&&1===o.status&&(_o(t,o),1===t.completedSegments.length&&t.parentFlushed&&e.partialBoundaries.push(t)));e.allPendingTasks--,0===e.allPendingTasks&&(e=e.onAllReady)()}function Eo(e){if(2!==e.status){var t=St,o=ao.current;ao.current=ro;var n=io;io=e.responseState;try{var r,i=e.pingedTasks;for(r=0;r<i.length;r++){var a=i[r],s=e,l=a.blockedSegment;if(0===l.status){Ot(a.context);try{vo(s,a,a.node),l.lastPushedText&&l.textEmbedded&&l.chunks.push(F),a.abortSet.delete(a),l.status=1,So(s,a.blockedBoundary,l)}catch(h){if(Xt(),"object"===typeof h&&null!==h&&"function"===typeof h.then){var c=a.ping;h.then(c,c)}else{a.abortSet.delete(a),l.status=4;var d=a.blockedBoundary,u=h,p=po(s,u);if(null===d?ho(s,u):(d.pendingTasks--,d.forceClientRender||(d.forceClientRender=!0,d.errorDigest=p,d.parentFlushed&&s.clientRenderedBoundaries.push(d))),s.allPendingTasks--,0===s.allPendingTasks)(0,s.onAllReady)()}}}}i.splice(0,r),null!==e.destination&&To(e,e.destination)}catch(h){po(e,h),ho(e,h)}finally{io=n,ao.current=o,o===ro&&Ot(t)}}}function ko(e,t,o){switch(o.parentFlushed=!0,o.status){case 0:var n=o.id=e.nextSegmentId++;return o.lastPushedText=!1,o.textEmbedded=!1,e=e.responseState,s(t,ce),s(t,e.placeholderPrefix),s(t,e=u(n.toString(16))),l(t,de);case 1:o.status=2;var i=!0;n=o.chunks;var a=0;o=o.children;for(var c=0;c<o.length;c++){for(i=o[c];a<i.index;a++)s(t,n[a]);i=jo(e,t,i)}for(;a<n.length-1;a++)s(t,n[a]);return a<n.length&&(i=l(t,n[a])),i;default:throw Error(r(390))}}function jo(e,t,o){var n=o.boundary;if(null===n)return ko(e,t,o);if(n.parentFlushed=!0,n.forceClientRender)n=n.errorDigest,l(t,fe),s(t,me),n&&(s(t,ve),s(t,u(k(n))),s(t,ye)),l(t,be),ko(e,t,o);else if(0<n.pendingTasks){n.rootSegmentID=e.nextSegmentId++,0<n.completedSegments.length&&e.partialBoundaries.push(n);var i=e.responseState,a=i.nextSuspenseID++;i=p(i.boundaryPrefix+a.toString(16)),n=n.id=i,xe(t,e.responseState,n),ko(e,t,o)}else if(n.byteSize>e.progressiveChunkSize)n.rootSegmentID=e.nextSegmentId++,e.completedBoundaries.push(n),xe(t,e.responseState,n.id),ko(e,t,o);else{if(l(t,ue),1!==(o=n.completedSegments).length)throw Error(r(391));jo(e,t,o[0])}return l(t,ge)}function Ao(e,t,o){return function(e,t,o,n){switch(o.insertionMode){case 0:case 1:return s(e,we),s(e,t.segmentPrefix),s(e,u(n.toString(16))),l(e,Ce);case 2:return s(e,Se),s(e,t.segmentPrefix),s(e,u(n.toString(16))),l(e,Ee);case 3:return s(e,je),s(e,t.segmentPrefix),s(e,u(n.toString(16))),l(e,Ae);case 4:return s(e,Oe),s(e,t.segmentPrefix),s(e,u(n.toString(16))),l(e,Te);case 5:return s(e,Pe),s(e,t.segmentPrefix),s(e,u(n.toString(16))),l(e,Ne);case 6:return s(e,Me),s(e,t.segmentPrefix),s(e,u(n.toString(16))),l(e,Le);case 7:return s(e,Ge),s(e,t.segmentPrefix),s(e,u(n.toString(16))),l(e,ze);default:throw Error(r(397))}}(t,e.responseState,o.formatContext,o.id),jo(e,t,o),function(e,t){switch(t.insertionMode){case 0:case 1:return l(e,_e);case 2:return l(e,ke);case 3:return l(e,Re);case 4:return l(e,De);case 5:return l(e,Ie);case 6:return l(e,Fe);case 7:return l(e,He);default:throw Error(r(397))}}(t,o.formatContext)}function Ro(e,t,o){for(var n=o.completedSegments,i=0;i<n.length;i++)Oo(e,t,o,n[i]);if(n.length=0,e=e.responseState,n=o.id,o=o.rootSegmentID,s(t,e.startInlineScript),e.sentCompleteBoundaryFunction?s(t,qe):(e.sentCompleteBoundaryFunction=!0,s(t,We)),null===n)throw Error(r(395));return o=u(o.toString(16)),s(t,n),s(t,Ke),s(t,e.segmentPrefix),s(t,o),l(t,Ye)}function Oo(e,t,o,n){if(2===n.status)return!0;var i=n.id;if(-1===i){if(-1===(n.id=o.rootSegmentID))throw Error(r(392));return Ao(e,t,n)}return Ao(e,t,n),s(t,(e=e.responseState).startInlineScript),e.sentCompleteSegmentFunction?s(t,Ve):(e.sentCompleteSegmentFunction=!0,s(t,Be)),s(t,e.segmentPrefix),s(t,i=u(i.toString(16))),s(t,$e),s(t,e.placeholderPrefix),s(t,i),l(t,Ue)}function To(e,t){i=new Uint8Array(512),a=0;try{var o=e.completedRootSegment;if(null!==o&&0===e.pendingRootTasks){jo(e,t,o),e.completedRootSegment=null;var n=e.responseState.bootstrapChunks;for(o=0;o<n.length-1;o++)s(t,n[o]);o<n.length&&l(t,n[o])}var d,p=e.clientRenderedBoundaries;for(d=0;d<p.length;d++){var h=p[d];n=t;var f=e.responseState,g=h.id,m=h.errorDigest,y=h.errorMessage,v=h.errorComponentStack;if(s(n,f.startInlineScript),f.sentClientRenderFunction?s(n,Xe):(f.sentClientRenderFunction=!0,s(n,Je)),null===g)throw Error(r(395));if(s(n,g),s(n,Qe),(m||y||v)&&(s(n,et),s(n,u(ot(m||"")))),(y||v)&&(s(n,et),s(n,u(ot(y||"")))),v&&(s(n,et),s(n,u(ot(v)))),!l(n,Ze))return e.destination=null,d++,void p.splice(0,d)}p.splice(0,d);var b=e.completedBoundaries;for(d=0;d<b.length;d++)if(!Ro(e,t,b[d]))return e.destination=null,d++,void b.splice(0,d);b.splice(0,d),c(t),i=new Uint8Array(512),a=0;var x=e.partialBoundaries;for(d=0;d<x.length;d++){var w=x[d];e:{p=e,h=t;var C=w.completedSegments;for(f=0;f<C.length;f++)if(!Oo(p,h,w,C[f])){f++,C.splice(0,f);var _=!1;break e}C.splice(0,f),_=!0}if(!_)return e.destination=null,d++,void x.splice(0,d)}x.splice(0,d);var S=e.completedBoundaries;for(d=0;d<S.length;d++)if(!Ro(e,t,S[d]))return e.destination=null,d++,void S.splice(0,d);S.splice(0,d)}finally{c(t),0===e.allPendingTasks&&0===e.pingedTasks.length&&0===e.clientRenderedBoundaries.length&&0===e.completedBoundaries.length&&t.close()}}function Do(e,t){try{var o=e.abortableTasks;o.forEach((function(o){return Co(o,e,t)})),o.clear(),null!==e.destination&&To(e,e.destination)}catch(n){po(e,n),ho(e,n)}}t.renderToReadableStream=function(e,t){return new Promise((function(o,n){var r,i,a=new Promise((function(e,t){i=e,r=t})),s=function(e,t,o,n,r,i,a,s,l){var c=[],d=new Set;return(o=uo(t={destination:null,responseState:t,progressiveChunkSize:void 0===n?12800:n,status:0,fatalError:null,nextSegmentId:0,allPendingTasks:0,pendingRootTasks:0,completedRootSegment:null,abortableTasks:d,pingedTasks:c,clientRenderedBoundaries:[],completedBoundaries:[],partialBoundaries:[],onError:void 0===r?so:r,onAllReady:void 0===i?lo:i,onShellReady:void 0===a?lo:a,onShellError:void 0===s?lo:s,onFatalError:void 0===l?lo:l},0,null,o,!1,!1)).parentFlushed=!0,e=co(t,e,null,o,d,Ct,null,Pt),c.push(e),t}(e,function(e,t,o,n,r){e=void 0===e?"":e,t=void 0===t?O:p('<script nonce="'+k(t)+'">');var i=[];if(void 0!==o&&i.push(t,u((""+o).replace(I,M)),T),void 0!==n)for(o=0;o<n.length;o++)i.push(D,u(k(n[o])),N);if(void 0!==r)for(n=0;n<r.length;n++)i.push(P,u(k(r[n])),N);return{bootstrapChunks:i,startInlineScript:t,placeholderPrefix:p(e+"P:"),segmentPrefix:p(e+"S:"),boundaryPrefix:e+"B:",idPrefix:e,nextSuspenseID:0,sentCompleteSegmentFunction:!1,sentCompleteBoundaryFunction:!1,sentClientRenderFunction:!1}}(t?t.identifierPrefix:void 0,t?t.nonce:void 0,t?t.bootstrapScriptContent:void 0,t?t.bootstrapScripts:void 0,t?t.bootstrapModules:void 0),function(e){return L("http://www.w3.org/2000/svg"===e?2:"http://www.w3.org/1998/Math/MathML"===e?3:0,null)}(t?t.namespaceURI:void 0),t?t.progressiveChunkSize:void 0,t?t.onError:void 0,i,(function(){var e=new ReadableStream({type:"bytes",pull:function(e){if(1===s.status)s.status=2,h(e,s.fatalError);else if(2!==s.status&&null===s.destination){s.destination=e;try{To(s,e)}catch(t){po(s,t),ho(s,t)}}},cancel:function(){Do(s)}},{highWaterMark:0});e.allReady=a,o(e)}),(function(e){a.catch((function(){})),n(e)}),r);if(t&&t.signal){var l=t.signal,c=function(){Do(s,l.reason),l.removeEventListener("abort",c)};l.addEventListener("abort",c)}Eo(s)}))},t.version="18.3.1"},8725:(e,t,o)=>{"use strict";o.d(t,{A:()=>J});var n=o(5837),r=o(8355),i=o(6260),a=o(3666);function s(e,t){return(0,a.A)(2,arguments),function(e,t){(0,a.A)(2,arguments);var o=(0,i.A)(e).getTime(),n=(0,r.A)(t);return new Date(o+n)}(e,-(0,r.A)(t))}function l(e){(0,a.A)(1,arguments);var t=(0,i.A)(e),o=t.getUTCDay(),n=(o<1?7:0)+o-1;return t.setUTCDate(t.getUTCDate()-n),t.setUTCHours(0,0,0,0),t}function c(e){(0,a.A)(1,arguments);var t=(0,i.A)(e),o=t.getUTCFullYear(),n=new Date(0);n.setUTCFullYear(o+1,0,4),n.setUTCHours(0,0,0,0);var r=l(n),s=new Date(0);s.setUTCFullYear(o,0,4),s.setUTCHours(0,0,0,0);var c=l(s);return t.getTime()>=r.getTime()?o+1:t.getTime()>=c.getTime()?o:o-1}function d(e){(0,a.A)(1,arguments);var t=(0,i.A)(e),o=l(t).getTime()-function(e){(0,a.A)(1,arguments);var t=c(e),o=new Date(0);return o.setUTCFullYear(t,0,4),o.setUTCHours(0,0,0,0),l(o)}(t).getTime();return Math.round(o/6048e5)+1}var u=o(2239);function p(e,t){var o,n,s,l,c,d,p,h;(0,a.A)(1,arguments);var f=(0,u.q)(),g=(0,r.A)(null!==(o=null!==(n=null!==(s=null!==(l=null===t||void 0===t?void 0:t.weekStartsOn)&&void 0!==l?l:null===t||void 0===t||null===(c=t.locale)||void 0===c||null===(d=c.options)||void 0===d?void 0:d.weekStartsOn)&&void 0!==s?s:f.weekStartsOn)&&void 0!==n?n:null===(p=f.locale)||void 0===p||null===(h=p.options)||void 0===h?void 0:h.weekStartsOn)&&void 0!==o?o:0);if(!(g>=0&&g<=6))throw new RangeError("weekStartsOn must be between 0 and 6 inclusively");var m=(0,i.A)(e),y=m.getUTCDay(),v=(y<g?7:0)+y-g;return m.setUTCDate(m.getUTCDate()-v),m.setUTCHours(0,0,0,0),m}function h(e,t){var o,n,s,l,c,d,h,f;(0,a.A)(1,arguments);var g=(0,i.A)(e),m=g.getUTCFullYear(),y=(0,u.q)(),v=(0,r.A)(null!==(o=null!==(n=null!==(s=null!==(l=null===t||void 0===t?void 0:t.firstWeekContainsDate)&&void 0!==l?l:null===t||void 0===t||null===(c=t.locale)||void 0===c||null===(d=c.options)||void 0===d?void 0:d.firstWeekContainsDate)&&void 0!==s?s:y.firstWeekContainsDate)&&void 0!==n?n:null===(h=y.locale)||void 0===h||null===(f=h.options)||void 0===f?void 0:f.firstWeekContainsDate)&&void 0!==o?o:1);if(!(v>=1&&v<=7))throw new RangeError("firstWeekContainsDate must be between 1 and 7 inclusively");var b=new Date(0);b.setUTCFullYear(m+1,0,v),b.setUTCHours(0,0,0,0);var x=p(b,t),w=new Date(0);w.setUTCFullYear(m,0,v),w.setUTCHours(0,0,0,0);var C=p(w,t);return g.getTime()>=x.getTime()?m+1:g.getTime()>=C.getTime()?m:m-1}function f(e,t){(0,a.A)(1,arguments);var o=(0,i.A)(e),n=p(o,t).getTime()-function(e,t){var o,n,i,s,l,c,d,f;(0,a.A)(1,arguments);var g=(0,u.q)(),m=(0,r.A)(null!==(o=null!==(n=null!==(i=null!==(s=null===t||void 0===t?void 0:t.firstWeekContainsDate)&&void 0!==s?s:null===t||void 0===t||null===(l=t.locale)||void 0===l||null===(c=l.options)||void 0===c?void 0:c.firstWeekContainsDate)&&void 0!==i?i:g.firstWeekContainsDate)&&void 0!==n?n:null===(d=g.locale)||void 0===d||null===(f=d.options)||void 0===f?void 0:f.firstWeekContainsDate)&&void 0!==o?o:1),y=h(e,t),v=new Date(0);return v.setUTCFullYear(y,0,m),v.setUTCHours(0,0,0,0),p(v,t)}(o,t).getTime();return Math.round(n/6048e5)+1}function g(e,t){for(var o=e<0?"-":"",n=Math.abs(e).toString();n.length<t;)n="0"+n;return o+n}const m={y:function(e,t){var o=e.getUTCFullYear(),n=o>0?o:1-o;return g("yy"===t?n%100:n,t.length)},M:function(e,t){var o=e.getUTCMonth();return"M"===t?String(o+1):g(o+1,2)},d:function(e,t){return g(e.getUTCDate(),t.length)},a:function(e,t){var o=e.getUTCHours()/12>=1?"pm":"am";switch(t){case"a":case"aa":return o.toUpperCase();case"aaa":return o;case"aaaaa":return o[0];default:return"am"===o?"a.m.":"p.m."}},h:function(e,t){return g(e.getUTCHours()%12||12,t.length)},H:function(e,t){return g(e.getUTCHours(),t.length)},m:function(e,t){return g(e.getUTCMinutes(),t.length)},s:function(e,t){return g(e.getUTCSeconds(),t.length)},S:function(e,t){var o=t.length,n=e.getUTCMilliseconds();return g(Math.floor(n*Math.pow(10,o-3)),t.length)}};var y="midnight",v="noon",b="morning",x="afternoon",w="evening",C="night",_={G:function(e,t,o){var n=e.getUTCFullYear()>0?1:0;switch(t){case"G":case"GG":case"GGG":return o.era(n,{width:"abbreviated"});case"GGGGG":return o.era(n,{width:"narrow"});default:return o.era(n,{width:"wide"})}},y:function(e,t,o){if("yo"===t){var n=e.getUTCFullYear(),r=n>0?n:1-n;return o.ordinalNumber(r,{unit:"year"})}return m.y(e,t)},Y:function(e,t,o,n){var r=h(e,n),i=r>0?r:1-r;return"YY"===t?g(i%100,2):"Yo"===t?o.ordinalNumber(i,{unit:"year"}):g(i,t.length)},R:function(e,t){return g(c(e),t.length)},u:function(e,t){return g(e.getUTCFullYear(),t.length)},Q:function(e,t,o){var n=Math.ceil((e.getUTCMonth()+1)/3);switch(t){case"Q":return String(n);case"QQ":return g(n,2);case"Qo":return o.ordinalNumber(n,{unit:"quarter"});case"QQQ":return o.quarter(n,{width:"abbreviated",context:"formatting"});case"QQQQQ":return o.quarter(n,{width:"narrow",context:"formatting"});default:return o.quarter(n,{width:"wide",context:"formatting"})}},q:function(e,t,o){var n=Math.ceil((e.getUTCMonth()+1)/3);switch(t){case"q":return String(n);case"qq":return g(n,2);case"qo":return o.ordinalNumber(n,{unit:"quarter"});case"qqq":return o.quarter(n,{width:"abbreviated",context:"standalone"});case"qqqqq":return o.quarter(n,{width:"narrow",context:"standalone"});default:return o.quarter(n,{width:"wide",context:"standalone"})}},M:function(e,t,o){var n=e.getUTCMonth();switch(t){case"M":case"MM":return m.M(e,t);case"Mo":return o.ordinalNumber(n+1,{unit:"month"});case"MMM":return o.month(n,{width:"abbreviated",context:"formatting"});case"MMMMM":return o.month(n,{width:"narrow",context:"formatting"});default:return o.month(n,{width:"wide",context:"formatting"})}},L:function(e,t,o){var n=e.getUTCMonth();switch(t){case"L":return String(n+1);case"LL":return g(n+1,2);case"Lo":return o.ordinalNumber(n+1,{unit:"month"});case"LLL":return o.month(n,{width:"abbreviated",context:"standalone"});case"LLLLL":return o.month(n,{width:"narrow",context:"standalone"});default:return o.month(n,{width:"wide",context:"standalone"})}},w:function(e,t,o,n){var r=f(e,n);return"wo"===t?o.ordinalNumber(r,{unit:"week"}):g(r,t.length)},I:function(e,t,o){var n=d(e);return"Io"===t?o.ordinalNumber(n,{unit:"week"}):g(n,t.length)},d:function(e,t,o){return"do"===t?o.ordinalNumber(e.getUTCDate(),{unit:"date"}):m.d(e,t)},D:function(e,t,o){var n=function(e){(0,a.A)(1,arguments);var t=(0,i.A)(e),o=t.getTime();t.setUTCMonth(0,1),t.setUTCHours(0,0,0,0);var n=o-t.getTime();return Math.floor(n/864e5)+1}(e);return"Do"===t?o.ordinalNumber(n,{unit:"dayOfYear"}):g(n,t.length)},E:function(e,t,o){var n=e.getUTCDay();switch(t){case"E":case"EE":case"EEE":return o.day(n,{width:"abbreviated",context:"formatting"});case"EEEEE":return o.day(n,{width:"narrow",context:"formatting"});case"EEEEEE":return o.day(n,{width:"short",context:"formatting"});default:return o.day(n,{width:"wide",context:"formatting"})}},e:function(e,t,o,n){var r=e.getUTCDay(),i=(r-n.weekStartsOn+8)%7||7;switch(t){case"e":return String(i);case"ee":return g(i,2);case"eo":return o.ordinalNumber(i,{unit:"day"});case"eee":return o.day(r,{width:"abbreviated",context:"formatting"});case"eeeee":return o.day(r,{width:"narrow",context:"formatting"});case"eeeeee":return o.day(r,{width:"short",context:"formatting"});default:return o.day(r,{width:"wide",context:"formatting"})}},c:function(e,t,o,n){var r=e.getUTCDay(),i=(r-n.weekStartsOn+8)%7||7;switch(t){case"c":return String(i);case"cc":return g(i,t.length);case"co":return o.ordinalNumber(i,{unit:"day"});case"ccc":return o.day(r,{width:"abbreviated",context:"standalone"});case"ccccc":return o.day(r,{width:"narrow",context:"standalone"});case"cccccc":return o.day(r,{width:"short",context:"standalone"});default:return o.day(r,{width:"wide",context:"standalone"})}},i:function(e,t,o){var n=e.getUTCDay(),r=0===n?7:n;switch(t){case"i":return String(r);case"ii":return g(r,t.length);case"io":return o.ordinalNumber(r,{unit:"day"});case"iii":return o.day(n,{width:"abbreviated",context:"formatting"});case"iiiii":return o.day(n,{width:"narrow",context:"formatting"});case"iiiiii":return o.day(n,{width:"short",context:"formatting"});default:return o.day(n,{width:"wide",context:"formatting"})}},a:function(e,t,o){var n=e.getUTCHours()/12>=1?"pm":"am";switch(t){case"a":case"aa":return o.dayPeriod(n,{width:"abbreviated",context:"formatting"});case"aaa":return o.dayPeriod(n,{width:"abbreviated",context:"formatting"}).toLowerCase();case"aaaaa":return o.dayPeriod(n,{width:"narrow",context:"formatting"});default:return o.dayPeriod(n,{width:"wide",context:"formatting"})}},b:function(e,t,o){var n,r=e.getUTCHours();switch(n=12===r?v:0===r?y:r/12>=1?"pm":"am",t){case"b":case"bb":return o.dayPeriod(n,{width:"abbreviated",context:"formatting"});case"bbb":return o.dayPeriod(n,{width:"abbreviated",context:"formatting"}).toLowerCase();case"bbbbb":return o.dayPeriod(n,{width:"narrow",context:"formatting"});default:return o.dayPeriod(n,{width:"wide",context:"formatting"})}},B:function(e,t,o){var n,r=e.getUTCHours();switch(n=r>=17?w:r>=12?x:r>=4?b:C,t){case"B":case"BB":case"BBB":return o.dayPeriod(n,{width:"abbreviated",context:"formatting"});case"BBBBB":return o.dayPeriod(n,{width:"narrow",context:"formatting"});default:return o.dayPeriod(n,{width:"wide",context:"formatting"})}},h:function(e,t,o){if("ho"===t){var n=e.getUTCHours()%12;return 0===n&&(n=12),o.ordinalNumber(n,{unit:"hour"})}return m.h(e,t)},H:function(e,t,o){return"Ho"===t?o.ordinalNumber(e.getUTCHours(),{unit:"hour"}):m.H(e,t)},K:function(e,t,o){var n=e.getUTCHours()%12;return"Ko"===t?o.ordinalNumber(n,{unit:"hour"}):g(n,t.length)},k:function(e,t,o){var n=e.getUTCHours();return 0===n&&(n=24),"ko"===t?o.ordinalNumber(n,{unit:"hour"}):g(n,t.length)},m:function(e,t,o){return"mo"===t?o.ordinalNumber(e.getUTCMinutes(),{unit:"minute"}):m.m(e,t)},s:function(e,t,o){return"so"===t?o.ordinalNumber(e.getUTCSeconds(),{unit:"second"}):m.s(e,t)},S:function(e,t){return m.S(e,t)},X:function(e,t,o,n){var r=(n._originalDate||e).getTimezoneOffset();if(0===r)return"Z";switch(t){case"X":return E(r);case"XXXX":case"XX":return k(r);default:return k(r,":")}},x:function(e,t,o,n){var r=(n._originalDate||e).getTimezoneOffset();switch(t){case"x":return E(r);case"xxxx":case"xx":return k(r);default:return k(r,":")}},O:function(e,t,o,n){var r=(n._originalDate||e).getTimezoneOffset();switch(t){case"O":case"OO":case"OOO":return"GMT"+S(r,":");default:return"GMT"+k(r,":")}},z:function(e,t,o,n){var r=(n._originalDate||e).getTimezoneOffset();switch(t){case"z":case"zz":case"zzz":return"GMT"+S(r,":");default:return"GMT"+k(r,":")}},t:function(e,t,o,n){var r=n._originalDate||e;return g(Math.floor(r.getTime()/1e3),t.length)},T:function(e,t,o,n){return g((n._originalDate||e).getTime(),t.length)}};function S(e,t){var o=e>0?"-":"+",n=Math.abs(e),r=Math.floor(n/60),i=n%60;if(0===i)return o+String(r);var a=t||"";return o+String(r)+a+g(i,2)}function E(e,t){return e%60===0?(e>0?"-":"+")+g(Math.abs(e)/60,2):k(e,t)}function k(e,t){var o=t||"",n=e>0?"-":"+",r=Math.abs(e);return n+g(Math.floor(r/60),2)+o+g(r%60,2)}const j=_;var A=function(e,t){switch(e){case"P":return t.date({width:"short"});case"PP":return t.date({width:"medium"});case"PPP":return t.date({width:"long"});default:return t.date({width:"full"})}},R=function(e,t){switch(e){case"p":return t.time({width:"short"});case"pp":return t.time({width:"medium"});case"ppp":return t.time({width:"long"});default:return t.time({width:"full"})}},O={p:R,P:function(e,t){var o,n=e.match(/(P+)(p+)?/)||[],r=n[1],i=n[2];if(!i)return A(e,t);switch(r){case"P":o=t.dateTime({width:"short"});break;case"PP":o=t.dateTime({width:"medium"});break;case"PPP":o=t.dateTime({width:"long"});break;default:o=t.dateTime({width:"full"})}return o.replace("{{date}}",A(r,t)).replace("{{time}}",R(i,t))}};const T=O;var D=o(4967),P=["D","DD"],N=["YY","YYYY"];function I(e,t,o){if("YYYY"===e)throw new RangeError("Use `yyyy` instead of `YYYY` (in `".concat(t,"`) for formatting years to the input `").concat(o,"`; see: https://github.com/date-fns/date-fns/blob/master/docs/unicodeTokens.md"));if("YY"===e)throw new RangeError("Use `yy` instead of `YY` (in `".concat(t,"`) for formatting years to the input `").concat(o,"`; see: https://github.com/date-fns/date-fns/blob/master/docs/unicodeTokens.md"));if("D"===e)throw new RangeError("Use `d` instead of `D` (in `".concat(t,"`) for formatting days of the month to the input `").concat(o,"`; see: https://github.com/date-fns/date-fns/blob/master/docs/unicodeTokens.md"));if("DD"===e)throw new RangeError("Use `dd` instead of `DD` (in `".concat(t,"`) for formatting days of the month to the input `").concat(o,"`; see: https://github.com/date-fns/date-fns/blob/master/docs/unicodeTokens.md"))}var M={lessThanXSeconds:{one:"less than a second",other:"less than {{count}} seconds"},xSeconds:{one:"1 second",other:"{{count}} seconds"},halfAMinute:"half a minute",lessThanXMinutes:{one:"less than a minute",other:"less than {{count}} minutes"},xMinutes:{one:"1 minute",other:"{{count}} minutes"},aboutXHours:{one:"about 1 hour",other:"about {{count}} hours"},xHours:{one:"1 hour",other:"{{count}} hours"},xDays:{one:"1 day",other:"{{count}} days"},aboutXWeeks:{one:"about 1 week",other:"about {{count}} weeks"},xWeeks:{one:"1 week",other:"{{count}} weeks"},aboutXMonths:{one:"about 1 month",other:"about {{count}} months"},xMonths:{one:"1 month",other:"{{count}} months"},aboutXYears:{one:"about 1 year",other:"about {{count}} years"},xYears:{one:"1 year",other:"{{count}} years"},overXYears:{one:"over 1 year",other:"over {{count}} years"},almostXYears:{one:"almost 1 year",other:"almost {{count}} years"}};const L=function(e,t,o){var n,r=M[e];return n="string"===typeof r?r:1===t?r.one:r.other.replace("{{count}}",t.toString()),null!==o&&void 0!==o&&o.addSuffix?o.comparison&&o.comparison>0?"in "+n:n+" ago":n};function F(e){return function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},o=t.width?String(t.width):e.defaultWidth;return e.formats[o]||e.formats[e.defaultWidth]}}var G={date:F({formats:{full:"EEEE, MMMM do, y",long:"MMMM do, y",medium:"MMM d, y",short:"MM/dd/yyyy"},defaultWidth:"full"}),time:F({formats:{full:"h:mm:ss a zzzz",long:"h:mm:ss a z",medium:"h:mm:ss a",short:"h:mm a"},defaultWidth:"full"}),dateTime:F({formats:{full:"{{date}} 'at' {{time}}",long:"{{date}} 'at' {{time}}",medium:"{{date}}, {{time}}",short:"{{date}}, {{time}}"},defaultWidth:"full"})};var z={lastWeek:"'last' eeee 'at' p",yesterday:"'yesterday at' p",today:"'today at' p",tomorrow:"'tomorrow at' p",nextWeek:"eeee 'at' p",other:"P"};function H(e){return function(t,o){var n;if("formatting"===(null!==o&&void 0!==o&&o.context?String(o.context):"standalone")&&e.formattingValues){var r=e.defaultFormattingWidth||e.defaultWidth,i=null!==o&&void 0!==o&&o.width?String(o.width):r;n=e.formattingValues[i]||e.formattingValues[r]}else{var a=e.defaultWidth,s=null!==o&&void 0!==o&&o.width?String(o.width):e.defaultWidth;n=e.values[s]||e.values[a]}return n[e.argumentCallback?e.argumentCallback(t):t]}}function B(e){return function(t){var o=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=o.width,r=n&&e.matchPatterns[n]||e.matchPatterns[e.defaultMatchWidth],i=t.match(r);if(!i)return null;var a,s=i[0],l=n&&e.parsePatterns[n]||e.parsePatterns[e.defaultParseWidth],c=Array.isArray(l)?function(e,t){for(var o=0;o<e.length;o++)if(t(e[o]))return o;return}(l,(function(e){return e.test(s)})):function(e,t){for(var o in e)if(e.hasOwnProperty(o)&&t(e[o]))return o;return}(l,(function(e){return e.test(s)}));return a=e.valueCallback?e.valueCallback(c):c,{value:a=o.valueCallback?o.valueCallback(a):a,rest:t.slice(s.length)}}}var V;const $={code:"en-US",formatDistance:L,formatLong:G,formatRelative:function(e,t,o,n){return z[e]},localize:{ordinalNumber:function(e,t){var o=Number(e),n=o%100;if(n>20||n<10)switch(n%10){case 1:return o+"st";case 2:return o+"nd";case 3:return o+"rd"}return o+"th"},era:H({values:{narrow:["B","A"],abbreviated:["BC","AD"],wide:["Before Christ","Anno Domini"]},defaultWidth:"wide"}),quarter:H({values:{narrow:["1","2","3","4"],abbreviated:["Q1","Q2","Q3","Q4"],wide:["1st quarter","2nd quarter","3rd quarter","4th quarter"]},defaultWidth:"wide",argumentCallback:function(e){return e-1}}),month:H({values:{narrow:["J","F","M","A","M","J","J","A","S","O","N","D"],abbreviated:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],wide:["January","February","March","April","May","June","July","August","September","October","November","December"]},defaultWidth:"wide"}),day:H({values:{narrow:["S","M","T","W","T","F","S"],short:["Su","Mo","Tu","We","Th","Fr","Sa"],abbreviated:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],wide:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"]},defaultWidth:"wide"}),dayPeriod:H({values:{narrow:{am:"a",pm:"p",midnight:"mi",noon:"n",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},abbreviated:{am:"AM",pm:"PM",midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},wide:{am:"a.m.",pm:"p.m.",midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"}},defaultWidth:"wide",formattingValues:{narrow:{am:"a",pm:"p",midnight:"mi",noon:"n",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"},abbreviated:{am:"AM",pm:"PM",midnight:"midnight",noon:"noon",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"},wide:{am:"a.m.",pm:"p.m.",midnight:"midnight",noon:"noon",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"}},defaultFormattingWidth:"wide"})},match:{ordinalNumber:(V={matchPattern:/^(\d+)(th|st|nd|rd)?/i,parsePattern:/\d+/i,valueCallback:function(e){return parseInt(e,10)}},function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},o=e.match(V.matchPattern);if(!o)return null;var n=o[0],r=e.match(V.parsePattern);if(!r)return null;var i=V.valueCallback?V.valueCallback(r[0]):r[0];return{value:i=t.valueCallback?t.valueCallback(i):i,rest:e.slice(n.length)}}),era:B({matchPatterns:{narrow:/^(b|a)/i,abbreviated:/^(b\.?\s?c\.?|b\.?\s?c\.?\s?e\.?|a\.?\s?d\.?|c\.?\s?e\.?)/i,wide:/^(before christ|before common era|anno domini|common era)/i},defaultMatchWidth:"wide",parsePatterns:{any:[/^b/i,/^(a|c)/i]},defaultParseWidth:"any"}),quarter:B({matchPatterns:{narrow:/^[1234]/i,abbreviated:/^q[1234]/i,wide:/^[1234](th|st|nd|rd)? quarter/i},defaultMatchWidth:"wide",parsePatterns:{any:[/1/i,/2/i,/3/i,/4/i]},defaultParseWidth:"any",valueCallback:function(e){return e+1}}),month:B({matchPatterns:{narrow:/^[jfmasond]/i,abbreviated:/^(jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec)/i,wide:/^(january|february|march|april|may|june|july|august|september|october|november|december)/i},defaultMatchWidth:"wide",parsePatterns:{narrow:[/^j/i,/^f/i,/^m/i,/^a/i,/^m/i,/^j/i,/^j/i,/^a/i,/^s/i,/^o/i,/^n/i,/^d/i],any:[/^ja/i,/^f/i,/^mar/i,/^ap/i,/^may/i,/^jun/i,/^jul/i,/^au/i,/^s/i,/^o/i,/^n/i,/^d/i]},defaultParseWidth:"any"}),day:B({matchPatterns:{narrow:/^[smtwf]/i,short:/^(su|mo|tu|we|th|fr|sa)/i,abbreviated:/^(sun|mon|tue|wed|thu|fri|sat)/i,wide:/^(sunday|monday|tuesday|wednesday|thursday|friday|saturday)/i},defaultMatchWidth:"wide",parsePatterns:{narrow:[/^s/i,/^m/i,/^t/i,/^w/i,/^t/i,/^f/i,/^s/i],any:[/^su/i,/^m/i,/^tu/i,/^w/i,/^th/i,/^f/i,/^sa/i]},defaultParseWidth:"any"}),dayPeriod:B({matchPatterns:{narrow:/^(a|p|mi|n|(in the|at) (morning|afternoon|evening|night))/i,any:/^([ap]\.?\s?m\.?|midnight|noon|(in the|at) (morning|afternoon|evening|night))/i},defaultMatchWidth:"any",parsePatterns:{any:{am:/^a/i,pm:/^p/i,midnight:/^mi/i,noon:/^no/i,morning:/morning/i,afternoon:/afternoon/i,evening:/evening/i,night:/night/i}},defaultParseWidth:"any"})},options:{weekStartsOn:0,firstWeekContainsDate:1}};var U=/[yYQqMLwIdDecihHKkms]o|(\w)\1*|''|'(''|[^'])+('|$)|./g,W=/P+p+|P+|p+|''|'(''|[^'])+('|$)|./g,q=/^'([^]*?)'?$/,K=/''/g,Y=/[a-zA-Z]/;function J(e,t,o){var l,c,d,p,h,f,g,m,y,v,b,x,w,C,_,S,E,k;(0,a.A)(2,arguments);var A=String(t),R=(0,u.q)(),O=null!==(l=null!==(c=null===o||void 0===o?void 0:o.locale)&&void 0!==c?c:R.locale)&&void 0!==l?l:$,M=(0,r.A)(null!==(d=null!==(p=null!==(h=null!==(f=null===o||void 0===o?void 0:o.firstWeekContainsDate)&&void 0!==f?f:null===o||void 0===o||null===(g=o.locale)||void 0===g||null===(m=g.options)||void 0===m?void 0:m.firstWeekContainsDate)&&void 0!==h?h:R.firstWeekContainsDate)&&void 0!==p?p:null===(y=R.locale)||void 0===y||null===(v=y.options)||void 0===v?void 0:v.firstWeekContainsDate)&&void 0!==d?d:1);if(!(M>=1&&M<=7))throw new RangeError("firstWeekContainsDate must be between 1 and 7 inclusively");var L=(0,r.A)(null!==(b=null!==(x=null!==(w=null!==(C=null===o||void 0===o?void 0:o.weekStartsOn)&&void 0!==C?C:null===o||void 0===o||null===(_=o.locale)||void 0===_||null===(S=_.options)||void 0===S?void 0:S.weekStartsOn)&&void 0!==w?w:R.weekStartsOn)&&void 0!==x?x:null===(E=R.locale)||void 0===E||null===(k=E.options)||void 0===k?void 0:k.weekStartsOn)&&void 0!==b?b:0);if(!(L>=0&&L<=6))throw new RangeError("weekStartsOn must be between 0 and 6 inclusively");if(!O.localize)throw new RangeError("locale must contain localize property");if(!O.formatLong)throw new RangeError("locale must contain formatLong property");var F=(0,i.A)(e);if(!(0,n.A)(F))throw new RangeError("Invalid time value");var G=s(F,(0,D.A)(F)),z={firstWeekContainsDate:M,weekStartsOn:L,locale:O,_originalDate:F};return A.match(W).map((function(e){var t=e[0];return"p"===t||"P"===t?(0,T[t])(e,O.formatLong):e})).join("").match(U).map((function(n){if("''"===n)return"'";var r=n[0];if("'"===r)return function(e){var t=e.match(q);if(!t)return e;return t[1].replace(K,"'")}(n);var i,a=j[r];if(a)return null!==o&&void 0!==o&&o.useAdditionalWeekYearTokens||(i=n,-1===N.indexOf(i))||I(n,t,String(e)),null!==o&&void 0!==o&&o.useAdditionalDayOfYearTokens||!function(e){return-1!==P.indexOf(e)}(n)||I(n,t,String(e)),a(G,n,O.localize,z);if(r.match(Y))throw new RangeError("Format string contains an unescaped latin alphabet character `"+r+"`");return n})).join("")}},8821:(e,t,o)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.canUseDOM=t.SafeNodeList=t.SafeHTMLCollection=void 0;var n,r=o(7396);var i=((n=r)&&n.__esModule?n:{default:n}).default,a=i.canUseDOM?window.HTMLElement:{};t.SafeHTMLCollection=i.canUseDOM?window.HTMLCollection:{},t.SafeNodeList=i.canUseDOM?window.NodeList:{},t.canUseDOM=i.canUseDOM;t.default=a},8829:function(e,t,o){"use strict";var n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const r=n(o(5736));t.default=class{constructor(e,t){let{headers:o={},schema:n,fetch:r}=t;this.url=e,this.headers=o,this.schema=n,this.fetch=r}select(e){let{head:t=!1,count:o}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const n=t?"HEAD":"GET";let i=!1;const a=(null!==e&&void 0!==e?e:"*").split("").map((e=>/\s/.test(e)&&!i?"":('"'===e&&(i=!i),e))).join("");return this.url.searchParams.set("select",a),o&&(this.headers.Prefer=`count=${o}`),new r.default({method:n,url:this.url,headers:this.headers,schema:this.schema,fetch:this.fetch,allowEmpty:!1})}insert(e){let{count:t,defaultToNull:o=!0}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const n=[];if(this.headers.Prefer&&n.push(this.headers.Prefer),t&&n.push(`count=${t}`),o||n.push("missing=default"),this.headers.Prefer=n.join(","),Array.isArray(e)){const t=e.reduce(((e,t)=>e.concat(Object.keys(t))),[]);if(t.length>0){const e=[...new Set(t)].map((e=>`"${e}"`));this.url.searchParams.set("columns",e.join(","))}}return new r.default({method:"POST",url:this.url,headers:this.headers,schema:this.schema,body:e,fetch:this.fetch,allowEmpty:!1})}upsert(e){let{onConflict:t,ignoreDuplicates:o=!1,count:n,defaultToNull:i=!0}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const a=[`resolution=${o?"ignore":"merge"}-duplicates`];if(void 0!==t&&this.url.searchParams.set("on_conflict",t),this.headers.Prefer&&a.push(this.headers.Prefer),n&&a.push(`count=${n}`),i||a.push("missing=default"),this.headers.Prefer=a.join(","),Array.isArray(e)){const t=e.reduce(((e,t)=>e.concat(Object.keys(t))),[]);if(t.length>0){const e=[...new Set(t)].map((e=>`"${e}"`));this.url.searchParams.set("columns",e.join(","))}}return new r.default({method:"POST",url:this.url,headers:this.headers,schema:this.schema,body:e,fetch:this.fetch,allowEmpty:!1})}update(e){let{count:t}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const o=[];return this.headers.Prefer&&o.push(this.headers.Prefer),t&&o.push(`count=${t}`),this.headers.Prefer=o.join(","),new r.default({method:"PATCH",url:this.url,headers:this.headers,schema:this.schema,body:e,fetch:this.fetch,allowEmpty:!1})}delete(){let{count:e}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const t=[];return e&&t.push(`count=${e}`),this.headers.Prefer&&t.unshift(this.headers.Prefer),this.headers.Prefer=t.join(","),new r.default({method:"DELETE",url:this.url,headers:this.headers,schema:this.schema,fetch:this.fetch,allowEmpty:!1})}}},8853:(e,t,o)=>{"use strict";e.exports=o(7234)},9139:function(e,t,o){"use strict";var n=this&&this.__assign||function(){return n=Object.assign||function(e){for(var t,o=1,n=arguments.length;o<n;o++)for(var r in t=arguments[o])Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e},n.apply(this,arguments)},r=this&&this.__createBinding||(Object.create?function(e,t,o,n){void 0===n&&(n=o),Object.defineProperty(e,n,{enumerable:!0,get:function(){return t[o]}})}:function(e,t,o,n){void 0===n&&(n=o),e[n]=t[o]}),i=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),a=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var o in e)"default"!==o&&Object.prototype.hasOwnProperty.call(e,o)&&r(t,e,o);return i(t,e),t};Object.defineProperty(t,"__esModule",{value:!0});var s=a(o(5043)),l=o(9201),c=o(7079),d=o(8242),u=o(3183),p=o(9724);t.default=s.memo((function(e){var t=s.useContext(l.BeansContext).context,o=s.useState(),r=o[0],i=o[1],a=s.useState(),h=a[0],f=a[1],g=s.useState(),m=g[0],y=g[1],v=s.useState(),b=v[0],x=v[1],w=s.useState(),C=w[0],_=w[1],S=s.useRef(null),E=s.useRef(null),k=s.useRef(null),j=s.useRef(),A=e.ctrl,R=s.useMemo((function(){return new c.CssClassManager((function(){return S.current}))}),[]);p.useLayoutEffectOnce((function(){var e={setWidth:function(e){return S.current.style.width=e},addOrRemoveCssClass:function(e,t){return R.addOrRemoveCssClass(e,t)},setColId:function(e){return f(e)},setTitle:function(e){return i(e)},setAriaDescription:function(e){return x(e)},setAriaSort:function(e){return y(e)},setUserCompDetails:function(e){return _(e)},getUserCompInstance:function(){return j.current||void 0}};A.setComp(e,S.current,E.current,k.current);var t=A.getSelectAllGui();E.current.insertAdjacentElement("afterend",t)})),s.useLayoutEffect((function(){return u.showJsComp(C,t,k.current,j)}),[C]),s.useEffect((function(){A.setDragSource(S.current)}),[C]);var O=s.useMemo((function(){return!!((null===C||void 0===C?void 0:C.componentFromFramework)&&d.isComponentStateless(C.componentClass))}),[C]),T=C&&C.componentFromFramework,D=C&&C.componentClass;return s.default.createElement("div",{ref:S,className:"ag-header-cell",title:r,"col-id":h,"aria-sort":m,role:"columnheader",tabIndex:-1,"aria-description":b},s.default.createElement("div",{ref:E,className:"ag-header-cell-resize",role:"presentation"}),s.default.createElement("div",{ref:k,className:"ag-header-cell-comp-wrapper",role:"presentation"},T&&O&&s.default.createElement(D,n({},C.params)),T&&!O&&s.default.createElement(D,n({},C.params,{ref:j}))))}))},9201:function(e,t,o){"use strict";var n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.BeansContext=void 0;var r=n(o(5043));t.BeansContext=r.default.createContext({})},9262:function(e,t,o){"use strict";var n=this&&this.__assign||function(){return n=Object.assign||function(e){for(var t,o=1,n=arguments.length;o<n;o++)for(var r in t=arguments[o])Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e},n.apply(this,arguments)},r=this&&this.__createBinding||(Object.create?function(e,t,o,n){void 0===n&&(n=o),Object.defineProperty(e,n,{enumerable:!0,get:function(){return t[o]}})}:function(e,t,o,n){void 0===n&&(n=o),e[n]=t[o]}),i=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),a=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var o in e)"default"!==o&&Object.prototype.hasOwnProperty.call(e,o)&&r(t,e,o);return i(t,e),t},s=this&&this.__spreadArrays||function(){for(var e=0,t=0,o=arguments.length;t<o;t++)e+=arguments[t].length;var n=Array(e),r=0;for(t=0;t<o;t++)for(var i=arguments[t],a=0,s=i.length;a<s;a++,r++)n[r]=i[a];return n},l=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var c=a(o(5043)),d=o(7079),u=o(3183),p=o(8242),h=o(9201),f=l(o(162)),g=o(9724);t.default=c.memo((function(e){var t=c.useContext(h.BeansContext).context,o=e.rowCtrl,r=e.containerType,i=c.useState(),a=i[0],l=i[1],m=c.useState(),y=m[0],v=m[1],b=c.useState(),x=b[0],w=b[1],C=c.useState(),_=C[0],S=C[1],E=c.useState(),k=E[0],j=E[1],A=c.useState(),R=A[0],O=A[1],T=c.useState({list:[],instanceIdMap:new Map}),D=T[0],P=T[1],N=c.useState(),I=N[0],M=N[1],L=c.useState(!1),F=L[0],G=L[1],z=c.useState(o.getInitialRowTop(r)),H=z[0],B=z[1],V=c.useState(o.getInitialTransform(r)),$=V[0],U=V[1],W=c.useRef(null),q=c.useRef(),K=c.useRef(!1),Y=c.useState(0),J=Y[0],X=Y[1];c.useEffect((function(){var e;if(!K.current&&I&&!(J>10)){var t=null===(e=W.current)||void 0===e?void 0:e.firstChild;t?(o.setupDetailRowAutoHeight(t),K.current=!0):X((function(e){return e+1}))}}),[I,J]);var Q=c.useMemo((function(){return new d.CssClassManager((function(){return W.current}))}),[]);g.useLayoutEffectOnce((function(){if(o.isAlive()){var e={setTop:function(e){return B(e)},setTransform:function(e){return U(e)},addOrRemoveCssClass:function(e,t){return Q.addOrRemoveCssClass(e,t)},setDomOrder:function(e){return G(e)},setRowIndex:function(e){return l(e)},setRowId:function(e){return v(e)},setRowBusinessKey:function(e){return S(e)},setTabIndex:function(e){return j(e)},setUserStyles:function(e){return O(e)},setRole:function(e){return w(e)},setCellCtrls:function(e,t){p.agFlushSync(t,(function(){P((function(t){return function(e,t,o){if(o){var n={list:t,instanceIdMap:new Map};return t.forEach((function(e){return n.instanceIdMap.set(e.getInstanceId(),e)})),n}var r=[],i=[],a=new Map,l=new Map;return t.forEach((function(e){return l.set(e.getInstanceId(),e)})),e.list.forEach((function(e){var t=e.getInstanceId();l.has(t)&&(r.push(e),a.set(t,e))})),t.forEach((function(t){var o=t.getInstanceId();e.instanceIdMap.has(o)||(i.push(t),a.set(o,t))})),{list:s(r,i),instanceIdMap:a}}(t,e,F)}))}))},showFullWidth:function(e){return M(e)},getFullWidthCellRenderer:function(){return q.current}};return o.setComp(e,W.current,r),function(){o.unsetComp(r)}}})),c.useLayoutEffect((function(){return u.showJsComp(I,t,W.current,q)}),[I]);var Z=c.useMemo((function(){var e={top:H,transform:$};return Object.assign(e,R),e}),[H,$,R]),ee=I&&I.componentFromFramework,te=null!=D,oe=c.useMemo((function(){return!!((null===I||void 0===I?void 0:I.componentFromFramework)&&p.isComponentStateless(I.componentClass))}),[I]);return c.default.createElement("div",{ref:W,role:x,style:Z,"row-index":a,"row-id":y,"row-business-key":_,tabIndex:k},te&&D.list.map((function(e){return c.default.createElement(f.default,{cellCtrl:e,editingRow:o.isEditing(),printLayout:o.isPrintLayout(),key:e.getInstanceId()})})),ee&&function(){var e=I.componentClass;return c.default.createElement(c.default.Fragment,null,oe&&c.default.createElement(e,n({},I.params)),!oe&&c.default.createElement(e,n({},I.params,{ref:q})))}())}))},9286:function(e,t,o){"use strict";var n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const r=n(o(4630)),i=n(o(2611));t.default=class{constructor(e){this.shouldThrowOnError=!1,this.method=e.method,this.url=e.url,this.headers=e.headers,this.schema=e.schema,this.body=e.body,this.shouldThrowOnError=e.shouldThrowOnError,this.signal=e.signal,this.isMaybeSingle=e.isMaybeSingle,e.fetch?this.fetch=e.fetch:"undefined"===typeof fetch?this.fetch=r.default:this.fetch=fetch}throwOnError(){return this.shouldThrowOnError=!0,this}setHeader(e,t){return this.headers=Object.assign({},this.headers),this.headers[e]=t,this}then(e,t){void 0===this.schema||(["GET","HEAD"].includes(this.method)?this.headers["Accept-Profile"]=this.schema:this.headers["Content-Profile"]=this.schema),"GET"!==this.method&&"HEAD"!==this.method&&(this.headers["Content-Type"]="application/json");let o=(0,this.fetch)(this.url.toString(),{method:this.method,headers:this.headers,body:JSON.stringify(this.body),signal:this.signal}).then((async e=>{var t,o,n;let r=null,a=null,s=null,l=e.status,c=e.statusText;if(e.ok){if("HEAD"!==this.method){const t=await e.text();""===t||(a="text/csv"===this.headers.Accept||this.headers.Accept&&this.headers.Accept.includes("application/vnd.pgrst.plan+text")?t:JSON.parse(t))}const n=null===(t=this.headers.Prefer)||void 0===t?void 0:t.match(/count=(exact|planned|estimated)/),i=null===(o=e.headers.get("content-range"))||void 0===o?void 0:o.split("/");n&&i&&i.length>1&&(s=parseInt(i[1])),this.isMaybeSingle&&"GET"===this.method&&Array.isArray(a)&&(a.length>1?(r={code:"PGRST116",details:`Results contain ${a.length} rows, application/vnd.pgrst.object+json requires 1 row`,hint:null,message:"JSON object requested, multiple (or no) rows returned"},a=null,s=null,l=406,c="Not Acceptable"):a=1===a.length?a[0]:null)}else{const t=await e.text();try{r=JSON.parse(t),Array.isArray(r)&&404===e.status&&(a=[],r=null,l=200,c="OK")}catch(d){404===e.status&&""===t?(l=204,c="No Content"):r={message:t}}if(r&&this.isMaybeSingle&&(null===(n=null===r||void 0===r?void 0:r.details)||void 0===n?void 0:n.includes("0 rows"))&&(r=null,l=200,c="OK"),r&&this.shouldThrowOnError)throw new i.default(r)}return{error:r,data:a,count:s,status:l,statusText:c}}));return this.shouldThrowOnError||(o=o.catch((e=>{var t,o,n;return{error:{message:`${null!==(t=null===e||void 0===e?void 0:e.name)&&void 0!==t?t:"FetchError"}: ${null===e||void 0===e?void 0:e.message}`,details:`${null!==(o=null===e||void 0===e?void 0:e.stack)&&void 0!==o?o:""}`,hint:"",code:`${null!==(n=null===e||void 0===e?void 0:e.code)&&void 0!==n?n:""}`},data:null,count:null,status:0,statusText:""}}))),o.then(e,t)}returns(){return this}overrideTypes(){return this}}},9352:function(e,t,o){"use strict";var n=this&&this.__createBinding||(Object.create?function(e,t,o,n){void 0===n&&(n=o),Object.defineProperty(e,n,{enumerable:!0,get:function(){return t[o]}})}:function(e,t,o,n){void 0===n&&(n=o),e[n]=t[o]}),r=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),i=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var o in e)"default"!==o&&Object.prototype.hasOwnProperty.call(e,o)&&n(t,e,o);return r(t,e),t},a=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var s=i(o(5043)),l=o(9201),c=o(7079),d=o(8242),u=a(o(6825)),p=o(9724);t.default=s.memo((function(e){var t=s.useState(new d.CssClasses),o=t[0],n=t[1],r=s.useState(!1),i=r[0],a=r[1],h=s.useState([]),f=h[0],g=h[1],m=s.useContext(l.BeansContext).context,y=s.useRef(null),v=s.useRef(null),b="left"===e.pinned,x="right"===e.pinned,w=!b&&!x;p.useLayoutEffectOnce((function(){var t={setDisplayed:function(e){n((function(t){return t.setClass("ag-hidden",!e)})),a(!e)},setCtrls:function(e){return g(e)},setCenterWidth:function(e){v.current&&(v.current.style.width=e)},setViewportScrollLeft:function(e){y.current&&(y.current.scrollLeft=e)},setPinnedContainerWidth:function(e){y.current.style.width=e,y.current.style.minWidth=e,y.current.style.maxWidth=e}},o=m.createBean(new c.HeaderRowContainerCtrl(e.pinned));return o.setComp(t,y.current),function(){m.destroyBean(o)}}));var C=s.useMemo((function(){return o.toString()}),[o]),_=function(){return f.map((function(e){return s.default.createElement(u.default,{ctrl:e,key:e.getInstanceId()})}))};return s.default.createElement(s.default.Fragment,null,b&&s.default.createElement("div",{ref:y,className:"ag-pinned-left-header "+C,"aria-hidden":i,role:"presentation"},_()),x&&s.default.createElement("div",{ref:y,className:"ag-pinned-right-header "+C,"aria-hidden":i,role:"presentation"},_()),w&&s.default.createElement("div",{ref:y,className:"ag-header-viewport "+C,role:"presentation"},s.default.createElement("div",{ref:v,className:"ag-header-container",role:"rowgroup"},_())))}))},9385:function(e,t,o){"use strict";var n=this&&this.__extends||function(){var e=function(t,o){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])},e(t,o)};return function(t,o){function n(){this.constructor=t}e(t,o),t.prototype=null===o?Object.create(o):(n.prototype=o.prototype,new n)}}(),r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.ReactFrameworkOverrides=void 0;var i=o(7079),a=r(o(9460)),s=r(o(1525)),l=function(e){function t(t){var o=e.call(this)||this;return o.frameworkComponents={agGroupCellRenderer:a.default,agGroupRowRenderer:a.default,agDetailCellRenderer:s.default},o.reactUi=t,o}return n(t,e),t.prototype.frameworkComponent=function(e){if(this.reactUi)return this.frameworkComponents[e]},t.prototype.isFrameworkComponent=function(e){if(!e)return!1;var t=e.prototype;return!(t&&"getGui"in t)},t}(i.VanillaFrameworkOverrides);t.ReactFrameworkOverrides=l},9426:function(e,t,o){"use strict";var n=this&&this.__assign||function(){return n=Object.assign||function(e){for(var t,o=1,n=arguments.length;o<n;o++)for(var r in t=arguments[o])Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e},n.apply(this,arguments)},r=this&&this.__createBinding||(Object.create?function(e,t,o,n){void 0===n&&(n=o),Object.defineProperty(e,n,{enumerable:!0,get:function(){return t[o]}})}:function(e,t,o,n){void 0===n&&(n=o),e[n]=t[o]}),i=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),a=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var o in e)"default"!==o&&Object.prototype.hasOwnProperty.call(e,o)&&r(t,e,o);return i(t,e),t};Object.defineProperty(t,"__esModule",{value:!0});var s=a(o(5043)),l=o(9201),c=o(3183),d=o(9724),u=o(8242);t.default=s.memo((function(e){var t=s.useContext(l.BeansContext).context,o=s.useState(new u.CssClasses),r=o[0],i=o[1],a=s.useState(new u.CssClasses),p=a[0],h=a[1],f=s.useState("false"),g=f[0],m=f[1],y=s.useState(),v=y[0],b=y[1],x=s.useState(),w=x[0],C=x[1],_=s.useState(),S=_[0],E=_[1],k=s.useState(),j=k[0],A=k[1],R=s.useRef(null),O=s.useRef(null),T=e.ctrl;d.useLayoutEffectOnce((function(){var e={setWidth:function(e){return R.current.style.width=e},addOrRemoveCssClass:function(e,t){return i((function(o){return o.setClass(e,t)}))},setColId:function(e){return C(e)},setTitle:function(e){return b(e)},setUserCompDetails:function(e){return A(e)},setResizableDisplayed:function(e){h((function(t){return t.setClass("ag-hidden",!e)})),m(e?"false":"true")},setAriaExpanded:function(e){return E(e)}};T.setComp(e,R.current,O.current)})),s.useLayoutEffect((function(){return c.showJsComp(j,t,R.current)}),[j]),s.useEffect((function(){var e=void 0;R.current.childNodes.forEach((function(t){null!=t&&t!==O.current&&(e=t)})),e&&T.setDragSource(e)}),[j]);var D=s.useMemo((function(){return"ag-header-group-cell "+r.toString()}),[r]),P=s.useMemo((function(){return"ag-header-cell-resize "+p.toString()}),[p]),N=j&&j.componentFromFramework,I=j&&j.componentClass;return s.default.createElement("div",{ref:R,className:D,title:v,"col-id":w,role:"columnheader",tabIndex:-1,"aria-expanded":S},N&&s.default.createElement(I,n({},j.params)),s.default.createElement("div",{ref:O,"aria-hidden":g,className:P}))}))},9430:(e,t,o)=>{"use strict";o.d(t,{A:()=>q});var n=o(5043),r=o(2963),i=o.n(r),a=o(1009),s=o(2285),l=o(5315),c=o(1529),d=o(8725),u=o(579);const p=c.Ay.div`
  display: flex;
  justify-content: space-between;
  align-items: center;
  margin-bottom: 10px;
  padding-bottom: 10px;
  border-bottom: 1px solid #333;

  h2 {
    margin: 0;
    font-size: 1.25rem;
    color: #00ff00;
    font-weight: 600;
  }

  button {
    background: none;
    border: none;
    cursor: pointer;
    color: #ffffff;
    padding: 4px;
    border-radius: 4px;
    
    &:hover {
      color: #ff5555;
    }
  }
`,h=c.Ay.h3`
  font-size: 16px;
  font-weight: bold;
  color: #00ff00;
  margin-bottom: 10px;
  margin-top: 0;
  display: flex;
  align-items: center;
  gap: 8px;
`,f=c.Ay.div`
  background-color: transparent;
  padding: 0;
  margin: 0;
  display: flex;
  flex-direction: column;
  overflow: hidden;
`,g=c.Ay.div`
  display: flex;
  height: 575px;
  border: 1px solid #333;
  border-radius: 6px;
  overflow: hidden;
  background-color: #1a1a1a;
`,m=c.Ay.div`
  flex: 0 0 180px;
  border-right: 1px solid #333;
  background-color: #111;
  overflow-y: auto;
`,y=(c.Ay.div`
  padding: 12px 15px;
  cursor: pointer;
  border-bottom: 1px solid #222;
  transition: all 0.2s;
  display: flex;
  align-items: center;
  gap: 8px;
  background-color: ${e=>e.active?"#222":"transparent"};
  
  .channel-name {
    font-weight: ${e=>e.active?"bold":"normal"};
    color: ${e=>{if(!e.active)return"#aaa";switch(e.channel){case"Email":return"#4a9eff";case"Meeting":return"#ff9900";case"Phone":return"#00ff00";case"Slack":return"#9000ff";case"WhatsApp":return"#25d366";default:return"#ccc"}}};
  }
  
  .channel-count {
    background-color: ${e=>e.active?"#333":"#222"};
    color: ${e=>e.active?"#fff":"#888"};
    padding: 1px 6px;
    border-radius: 10px;
    font-size: 0.7rem;
    margin-left: auto;
  }
  
  &:hover {
    background-color: #1e1e1e;
  }
`,c.Ay.div`
  flex: 1;
  padding: 0;
  overflow-y: auto;
  background-color: #181818;
`),v=(c.Ay.div`
  padding: 15px;
  border-bottom: 1px solid #333;
  
  &:last-child {
    border-bottom: none;
  }
`,c.Ay.div`
  display: flex;
  justify-content: space-between;
  margin-bottom: 10px;
  align-items: center;
  
  .interaction-direction {
    font-size: 0.75rem;
    background-color: ${e=>"Outbound"===e.direction?"#2d562d":"#333"};
    color: ${e=>"Outbound"===e.direction?"#8aff8a":"#ccc"};
    padding: 2px 6px;
    border-radius: 4px;
  }
  
  .interaction-date {
    color: #888;
    font-size: 0.8rem;
    display: flex;
    flex-direction: column;
    align-items: flex-end;
    
    .date {
      color: #999;
    }
    
    .time {
      color: #777;
      font-size: 0.7rem;
    }
  }
`,c.Ay.div`
  color: #ddd;
  font-size: 0.9rem;
  line-height: 1.5;
  white-space: pre-wrap;
`,c.Ay.div`
  display: flex;
  justify-content: center;
  align-items: center;
  height: 100%;
  color: #aaa;
  font-style: italic;
`),b=c.Ay.div`
  display: flex;
  justify-content: center;
  align-items: center;
  height: 100%;
  color: #aaa;
  font-style: italic;
`,x=c.Ay.div`
  display: flex;
  align-items: center;
  gap: 10px;
  padding: 10px 15px;
  background-color: rgba(255, 0, 0, 0.1);
  border: 1px solid rgba(255, 0, 0, 0.3);
  border-radius: 4px;
  margin-bottom: 15px;
  color: #ff6b6b;
`,w=c.Ay.div`
  display: flex;
  flex-direction: column;
  height: 100%;
  background-color: #0b1a1a; /* Dark WhatsApp background */
  position: relative;
  border-radius: 4px;
  overflow: hidden;
`,C=c.Ay.div`
  background-color: #075e54; /* WhatsApp green */
  color: white;
  padding: 12px 16px;
  display: flex;
  align-items: center;
  gap: 12px;
  border-bottom: 1px solid #054d44;
`,_=c.Ay.div`
  width: 40px;
  height: 40px;
  border-radius: 50%;
  background-color: #25d366;
  color: #000;
  display: flex;
  align-items: center;
  justify-content: center;
  font-weight: bold;
  font-size: 18px;
  margin-right: 12px;
`,S=c.Ay.div`
  flex: 1;
`,E=c.Ay.div`
  font-weight: bold;
  color: #eee;
  margin-bottom: 2px;
`,k=c.Ay.div`
  font-size: 0.75rem;
  color: #888;
`,j=(c.Ay.div`
  flex: 1;
  padding: 15px;
  overflow-y: auto;
  display: flex;
  flex-direction: column;
  width: 100%;
  background-color: #0b1a1a; /* Dark WhatsApp background */
`,c.Ay.div`
  flex: 1;
  overflow-y: auto;
  padding: 16px;
  box-sizing: border-box;
  display: flex;
  flex-direction: column;
  max-height: calc(100vh - 255px);
  background-color: #0b1a1a;
  width: 100%;
`,c.Ay.div`
  max-width: 70%;
  padding: 10px 14px;
  border-radius: 12px;
  position: relative;
  word-wrap: break-word;
  line-height: 1.4;
  font-size: 0.95rem;
  box-shadow: 0 1px 1px rgba(0, 0, 0, 0.1);
  margin-bottom: 8px;
  align-self: ${e=>"outbound"===e.$direction?"flex-end":"flex-start"};
  background-color: ${e=>"outbound"===e.$direction?"#055e54":"#202c33"};
  color: ${e=>(e.$direction,"#e9e9e9")};
  
  &:before {
    content: '';
    position: absolute;
    top: 0;
    ${e=>"outbound"===e.$direction?"right: -8px;":"left: -8px;"}
    width: 0;
    height: 0;
    border-top: 8px solid ${e=>"outbound"===e.$direction?"#055e54":"#202c33"};
    border-right: ${e=>"outbound"===e.$direction?"8px solid transparent":"none"};
    border-left: ${e=>"outbound"!==e.$direction?"8px solid transparent":"none"};
  }
  
  .message-time {
    font-size: 0.65rem;
    color: ${e=>"outbound"===e.$direction?"rgba(255, 255, 255, 0.7)":"#999"};
    text-align: right;
    margin-top: 4px;
  }
`,c.Ay.div`
  display: flex;
  flex-direction: column;
  height: 100%;
  background-color: #1e1e1e;
  position: relative;
  border-radius: 4px;
  overflow: hidden;
`),A=c.Ay.div`
  background-color: #2a2a2a;
  color: white;
  padding: 16px;
  border-bottom: 1px solid #444;
`,R=c.Ay.div`
  font-size: 1.2rem;
  font-weight: bold;
  margin-bottom: 8px;
  color: #e0e0e0;
`,O=c.Ay.div`
  font-size: 0.8rem;
  color: #aaa;
`,T=c.Ay.div`
  flex: 1;
  overflow-y: auto;
  max-height: calc(100vh - 280px);
`,D=c.Ay.div`
  border-bottom: 1px solid #333;
  padding: 6px 64px 16px 0px;
  background-color: #1a1a1a;
  transition: background-color 0.2s;

  &:hover {
    background-color: #222;
  }
  
  ${e=>e.$expanded&&"\n    background-color: #222;\n  "}
`,P=c.Ay.div`
  padding: 16px;
  cursor: pointer;
`,N=c.Ay.div`
  display: flex;
  justify-content: space-between;
  margin-bottom: 8px;
`,I=c.Ay.div`
  font-weight: bold;
  color: #e0e0e0;
`,M=c.Ay.div`
  color: #999;
  font-size: 0.8rem;
`,L=c.Ay.div`
  color: #aaa;
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
  font-size: 0.9rem;
`,F=c.Ay.div`
  padding: 0 0 16px 16px;
  color: #e0e0e0;
  font-size: 0.9rem;
  line-height: 1.5;
  
  p {
    margin-bottom: 8px;
  }
  
  a {
    color: #4a9eff;
    text-decoration: none;
    
    &:hover {
      text-decoration: underline;
    }
  }
`,G=(c.Ay.div`
  margin-top: 12px;
  padding-top: 12px;
  border-top: 1px solid #333;
`,c.Ay.div`
  display: flex;
  align-items: center;
  padding: 8px;
  background-color: #252525;
  border-radius: 4px;
  margin-top: 8px;
  
  svg {
    margin-right: 8px;
    color: #999;
  }
`,c.Ay.div`
  display: flex;
  flex-direction: column;
  height: 100%;
  overflow: hidden;
`),z=c.Ay.div`
  padding: 12px 15px;
  border-bottom: 1px solid #272727;
  background-color: #171717;
`,H=c.Ay.div`
  font-weight: bold;
  color: #eee;
  margin-bottom: 8px;
  font-size: 16px;
`,B=c.Ay.div`
  display: flex;
  align-items: center;
  gap: 8px;
  font-size: 0.85rem;
  color: #ff9900;
  margin-bottom: 10px;
`,V=c.Ay.div`
  display: flex;
  flex-wrap: wrap;
  gap: 5px;
  margin-top: 10px;
`,$=c.Ay.div`
  background-color: #333;
  color: #ccc;
  padding: 4px 8px;
  border-radius: 4px;
  font-size: 0.75rem;
`,U=c.Ay.div`
  flex: 1;
  padding: 15px;
  overflow-y: auto;
`,W=c.Ay.div`
  color: #ddd;
  white-space: pre-wrap;
  line-height: 1.6;
`,q=e=>{let{isOpen:t,onRequestClose:o,contact:r,showWhatsApp:c=!0,showEmail:q=!0,showMeetings:K=!0,inline:Y=!1}=e;const[J,X]=(0,n.useState)(!1),[Q,Z]=(0,n.useState)(null),[ee,te]=(0,n.useState)(null),[oe,ne]=(0,n.useState)([]),[re,ie]=(0,n.useState)([]),[ae,se]=(0,n.useState)([]),[le,ce]=(0,n.useState)(null),[de,ue]=(0,n.useState)([]),[pe,he]=(0,n.useState)(!1),[fe,ge]=(0,n.useState)(null),[me,ye]=(0,n.useState)([]),[ve,be]=(0,n.useState)(!1),[xe,we]=(0,n.useState)({}),[Ce,_e]=(0,n.useState)(null),[Se,Ee]=(0,n.useState)(null),[ke,je]=(0,n.useState)(!1);(0,n.useEffect)((()=>{t&&r?Re():Ae()}),[t,r]);const Ae=()=>{ce(null),ge(null),_e(null),ue([]),ye([]),Ee(null)},Re=async()=>{if(r&&r.contact_id){X(!0),Z(null);try{await Promise.all([Oe(r.contact_id),Te(r.contact_id),Pe(r.contact_id)])}catch(e){console.error("Error loading interactions:",e),Z("Failed to load interaction data. Please try again.")}finally{X(!1)}}},Oe=async e=>{try{console.log("Loading WhatsApp chats for contact ID:",e);const{data:t,error:o}=await l.supabase.from("interactions").select("\n          interaction_id,\n          chat_id,\n          interaction_date\n        ").eq("contact_id",e).eq("interaction_type","whatsapp").order("interaction_date",{ascending:!1});if(o)return void console.error("Error loading WhatsApp interactions:",o);if(console.log("Found WhatsApp interactions:",t),!t||0===t.length)return;const n=[...new Set(t.map((e=>e.chat_id)))].filter(Boolean);if(0===n.length)return;const{data:r,error:i}=await l.supabase.from("chats").select("\n          id,\n          chat_name,\n          is_group_chat,\n          external_chat_id\n        ").in("id",n);if(i)return void console.error("Error loading chats:",i);if(console.log("Found chats:",r),r&&r.length>0){const e=r.map((e=>({chat_id:e.id,chat_name:e.chat_name||"Unnamed Chat",is_group_chat:e.is_group_chat||!1,external_chat_id:e.external_chat_id,unread_count:0})));console.log("Setting WhatsApp chats:",e),ne(e),e.length>0&&!ee&&c&&(te("whatsapp"),ce(e[0].chat_id),Ne(e[0].chat_id))}}catch(t){console.error("Error loading WhatsApp chats:",t)}},Te=async e=>{try{console.log("Loading email threads for contact ID:",e);const{data:t,error:o}=await l.supabase.from("contact_email_threads").select("\n          email_thread_id,\n          email_threads:email_thread_id (\n            email_thread_id, \n            subject,\n            thread_id,\n            last_message_timestamp,\n            updated_at\n          )\n        ").eq("contact_id",e).order("created_at",{ascending:!1});if(o)return void console.error("Error loading email threads:",o);if(!t||0===t.length)return console.log("No email threads found for contact ID:",e),void ie([]);console.log("Found email threads:",t);const n=t.filter((e=>e.email_threads)).map((e=>({thread_id:e.email_thread_id,title:e.email_threads.subject||"No Subject",date:e.email_threads.last_message_timestamp,updated_at:e.email_threads.updated_at,gmail_thread_id:e.email_threads.thread_id}))).sort(((e,t)=>new Date(t.date||t.updated_at)-new Date(e.date||e.updated_at)));console.log("Setting email threads:",n),ie(n),n.length>0&&!ee&&q&&(!c||0===oe.length)&&(te("email"),ge(n[0].thread_id),Ie(n[0].thread_id)),0===n.length&&await De(e)}catch(t){console.error("Error loading email threads:",t)}},De=async e=>{try{console.log("Trying alternate method to find email threads...");const{data:t,error:o}=await l.supabase.from("interactions").select("\n          interaction_id,\n          email_thread_id,\n          summary\n        ").eq("contact_id",e).eq("interaction_type","email").order("interaction_date",{ascending:!1});if(o)return void console.error("Error loading email interactions:",o);if(!t||0===t.length)return void console.log("No email interactions found for contact ID:",e);console.log("Found email interactions:",t);const n=[...new Set(t.map((e=>e.email_thread_id)))].filter(Boolean);if(0===n.length)return void console.log("No valid thread IDs found in interactions");const{data:r,error:i}=await l.supabase.from("email_threads").select("\n          email_thread_id,\n          subject,\n          thread_id,\n          last_message_timestamp,\n          updated_at\n        ").in("email_thread_id",n);if(i)return void console.error("Error loading thread details:",i);if(!r||0===r.length)return void console.log("No thread details found for the thread IDs");console.log("Found email thread details:",r);const a=r.map((e=>({thread_id:e.email_thread_id,title:e.subject||"No Subject",date:e.last_message_timestamp,updated_at:e.updated_at,gmail_thread_id:e.thread_id}))).sort(((e,t)=>new Date(t.date||t.updated_at)-new Date(e.date||e.updated_at)));console.log("Setting email threads from interactions:",a),ie(a),a.length>0&&!ee&&q&&(!c||0===oe.length)&&(te("email"),ge(a[0].thread_id),Ie(a[0].thread_id))}catch(t){console.error("Error loading email threads from interactions:",t)}},Pe=async e=>{try{console.log("Loading meetings for contact ID:",e);const{data:t,error:o}=await l.supabase.from("interactions").select("\n          interaction_id,\n          interaction_date,\n          summary\n        ").eq("contact_id",e).eq("interaction_type","meeting").order("interaction_date",{ascending:!1});if(o)return void console.error("Error loading meeting interactions:",o);if(console.log("Found meeting interactions:",t),!t||0===t.length)return;if(t&&t.length>0){const e=t.map((e=>({id:e.interaction_id,title:e.summary||"Untitled Meeting",start_time:e.interaction_date,end_time:e.interaction_date,notes:e.summary||"",created_at:e.interaction_date}))).sort(((e,t)=>new Date(t.start_time||t.created_at)-new Date(e.start_time||e.created_at)));console.log("Setting meetings from interactions:",e),se(e),e.length>0&&!ee&&0===oe.length&&0===re.length&&(te("meetings"),_e(e[0].id),Me(e[0].id))}}catch(t){console.error("Error loading meetings:",t)}},Ne=async e=>{if(e){he(!0);try{console.log("Loading messages for chat ID:",e);const{data:t,error:o}=await l.supabase.from("interactions").select("\n          interaction_id,\n          summary,\n          interaction_date,\n          direction\n        ").eq("chat_id",e).eq("interaction_type","whatsapp").order("interaction_date",{ascending:!0});if(o)return console.error("Error loading chat interactions:",o),void ue([]);if(t&&t.length>0){const e=t.map((e=>{const t=e.interaction_id%2===0?"outbound":"inbound";return{id:e.interaction_id,content:e.summary||"No content available",sent:"outbound"===e.direction||"outbound"===t,direction:e.direction||t,timestamp:e.interaction_date,isOutbound:"outbound"===e.direction||"outbound"===t}}));console.log("Setting chat messages from interactions:",e),ue(e)}else{const e=[{id:"placeholder-1",content:"This is an inbound test message (should be on the left with dark background)",sent:!1,direction:"inbound",isOutbound:!1,timestamp:new Date(Date.now()-6e5).toISOString()},{id:"placeholder-2",content:"This is an outbound test message (should be on the right with green background)",sent:!0,direction:"outbound",isOutbound:!0,timestamp:new Date(Date.now()-3e5).toISOString()},{id:"placeholder-3",content:"Another inbound message (left, dark)",sent:!1,direction:"inbound",isOutbound:!1,timestamp:(new Date).toISOString()}];ue(e)}}catch(t){console.error("Error loading chat messages:",t),ue([])}finally{he(!1)}}},Ie=async e=>{if(e){be(!0);try{console.log("Loading emails for thread ID:",e);const{data:t,error:o}=await l.supabase.from("emails").select("\n          email_id,\n          subject,\n          body_plain,\n          body_html,\n          message_timestamp,\n          direction,\n          sender_contact_id,\n          has_attachments,\n          attachment_count\n        ").eq("email_thread_id",e).order("message_timestamp",{ascending:!1});if(o)return console.error("Error loading email messages:",o),void ye([]);if(console.log("Found email messages:",t),t&&t.length>0){const e=await Promise.all(t.map((async e=>{const{data:t,error:o}=await l.supabase.from("email_participants").select("\n              participant_id,\n              participant_type,\n              contact_id\n            ").eq("email_id",e.email_id);if(o)return console.error(`Error loading participants for email ${e.email_id}:`,o),{...e,participants:[]};let n=null;if(e.sender_contact_id){const{data:t,error:o}=await l.supabase.from("contacts").select("\n                contact_id,\n                first_name,\n                last_name\n              ").eq("contact_id",e.sender_contact_id).single();if(o?console.error(`Error loading sender for email ${e.email_id}:`,o):n=t,n){const{data:t,error:o}=await l.supabase.from("contact_emails").select("email").eq("contact_id",e.sender_contact_id).limit(1);!o&&t&&t.length>0&&(n.email=t[0].email)}}const r=await Promise.all((t||[]).map((async e=>{if(e.contact_id){const{data:t,error:o}=await l.supabase.from("contacts").select("\n                  first_name,\n                  last_name\n                ").eq("contact_id",e.contact_id).single();if(o)return console.error("Error loading contact for participant:",o),e;const{data:n,error:r}=await l.supabase.from("contact_emails").select("email").eq("contact_id",e.contact_id).limit(1);return{...e,contact_name:t?`${t.first_name||""} ${t.last_name||""}`.trim():"",contact_email:n&&n.length>0?n[0].email:""}}return e})));return{...e,participants:r||[],sender:n}}))),o=e.map((e=>{let t="Unknown Sender",o="";e.sender&&(t=`${e.sender.first_name||""} ${e.sender.last_name||""}`.trim()||"Unknown Sender",o=e.sender.email||"");const n=[],r=[],i=[];return e.participants&&e.participants.length>0&&e.participants.forEach((e=>{const t={name:e.contact_name||""||"Unknown Recipient",email:e.contact_email||""};"to"===e.participant_type?n.push(t):"cc"===e.participant_type?r.push(t):"bcc"===e.participant_type&&i.push(t)})),{id:e.email_id,subject:e.subject||"No Subject",body:e.body_plain||"",html:e.body_html||"",timestamp:e.message_timestamp,direction:e.direction||"inbound",sender:{name:t,email:o},recipients:n,ccRecipients:r,bccRecipients:i,hasAttachments:e.has_attachments||!1,attachmentCount:e.attachment_count||0}}));console.log("Setting formatted email messages:",o),ye(o)}else ye([])}catch(t){console.error("Error loading email messages:",t),ye([])}finally{be(!1)}}},Me=async e=>{if(e){je(!0);try{console.log("Loading details for meeting ID:",e);const t=ae.find((t=>t.id===e));if(!t)return console.log("No meeting found with ID:",e),void Ee(null);const o={...t,attendees:[]};console.log("Setting meeting details from interaction:",o),Ee(o)}catch(t){console.error("Error loading meeting details:",t),Ee(null)}finally{je(!1)}}},Le=e=>{ce(e),ge(null),_e(null),te("whatsapp"),Ne(e)},Fe=e=>{ge(e),ce(null),_e(null),te("email"),Ie(e)},Ge=e=>{_e(e),ce(null),ge(null),te("meetings"),Me(e)},ze=e=>{try{if(!e)return{date:"Unknown",time:""};const t=new Date(e);return isNaN(t.getTime())?{date:"Unknown",time:""}:{date:(0,d.A)(t,"MMM d, yyyy"),time:(0,d.A)(t,"h:mm a")}}catch(t){return console.error("Error formatting date:",t),{date:"Unknown",time:""}}},He=e=>{we((t=>({...t,[e]:!t[e]})))},Be=e=>{if(console.log("Rendering WhatsApp chat ID:",e),console.log("Chat messages:",de),pe)return(0,u.jsx)("div",{style:{display:"flex",justifyContent:"center",alignItems:"center",height:"100%",color:"#aaa",fontStyle:"italic"},children:"Loading messages..."});if(!de||0===de.length)return(0,u.jsx)("div",{style:{display:"flex",justifyContent:"center",alignItems:"center",height:"100%",color:"#aaa",fontStyle:"italic"},children:"No messages available"});const t=oe.find((t=>t.chat_id===e)),o=(null===t||void 0===t?void 0:t.chat_name)||"Chat",n=null!==t&&void 0!==t&&t.is_group_chat?"Group Chat":"Direct Message";return(0,u.jsxs)(w,{children:[(0,u.jsxs)(C,{children:[(0,u.jsx)(_,{children:o.charAt(0).toUpperCase()}),(0,u.jsxs)(S,{children:[(0,u.jsx)(E,{children:o}),(0,u.jsxs)(k,{children:[n," \u2022 ",de.length," messages"]})]})]}),(0,u.jsx)("div",{style:{flex:1,overflowY:"auto",padding:"16px",boxSizing:"border-box",backgroundColor:"#0b1a1a",maxHeight:"calc(100vh - 280px)",width:"100%"},children:de.map((e=>{console.log("======================================="),console.log("Message being rendered:",JSON.stringify(e,null,2)),console.log("Raw direction property:",e.direction),console.log("Raw isOutbound property:",e.isOutbound),console.log("Raw sent property:",e.sent);const t="outbound"===e.direction||"sent"===e.direction,o=Boolean(e.isOutbound),n=Boolean(e.sent);console.log("Direction conditions:",{fromDirection:t,fromIsOutbound:o,fromSent:n});const r=e.direction||(e.isOutbound||e.sent?"outbound":"inbound"),i="outbound"===r||"sent"===r;console.log("FINAL DIRECTION DECISION:",{direction:r,isOutbound:i});const a=ze(e.timestamp).time;return(0,u.jsxs)("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",width:"100%",marginBottom:"10px"},children:[!i&&(0,u.jsx)("div",{style:{gridColumn:1,paddingRight:"15%"},children:(0,u.jsxs)("div",{style:{padding:"10px 14px",borderRadius:"12px",borderTopLeftRadius:"3px",position:"relative",wordWrap:"break-word",lineHeight:1.4,fontSize:"0.95rem",boxShadow:"0 1px 1px rgba(0, 0, 0, 0.1)",backgroundColor:"#202c33",color:"#e9e9e9"},children:[e.content,(0,u.jsx)("div",{style:{fontSize:"0.65rem",color:"#999",textAlign:"right",marginTop:"4px"},children:a}),(0,u.jsx)("div",{style:{position:"absolute",top:0,left:-6,width:0,height:0,borderTop:"8px solid #202c33",borderLeft:"8px solid transparent"}})]})}),i&&(0,u.jsx)("div",{style:{gridColumn:2,paddingLeft:"15%"},children:(0,u.jsxs)("div",{style:{padding:"10px 14px",borderRadius:"12px",borderTopRightRadius:"3px",position:"relative",wordWrap:"break-word",lineHeight:1.4,fontSize:"0.95rem",boxShadow:"0 1px 1px rgba(0, 0, 0, 0.1)",backgroundColor:"#055e54",color:"#e9e9e9"},children:[e.content,(0,u.jsx)("div",{style:{fontSize:"0.65rem",color:"rgba(255, 255, 255, 0.7)",textAlign:"right",marginTop:"4px"},children:a}),(0,u.jsx)("div",{style:{position:"absolute",top:0,right:-6,width:0,height:0,borderTop:"8px solid #055e54",borderRight:"8px solid transparent"}})]})})]},e.id)}))})]})},Ve=e=>{var t;if(ve)return(0,u.jsx)(v,{children:"Loading emails..."});if(!me||0===me.length)return(0,u.jsx)(b,{children:"No emails available"});const o=(null===(t=me[0])||void 0===t?void 0:t.subject)||"No Subject";return(0,u.jsxs)(j,{children:[(0,u.jsxs)(A,{children:[(0,u.jsx)(R,{children:o}),(0,u.jsxs)(O,{children:[me.length," emails in this thread"]})]}),(0,u.jsx)(T,{children:me.map((e=>{const t=xe[e.id]||!1,o=ze(e.timestamp);return(0,u.jsxs)(D,{$expanded:t,children:[(0,u.jsxs)(P,{onClick:()=>He(e.id),children:[(0,u.jsxs)(N,{children:[(0,u.jsxs)(I,{children:[e.sender.name,(0,u.jsx)("span",{style:{fontWeight:"normal",fontSize:"0.85rem",marginLeft:"8px",color:"#aaa"},children:e.sender.email?`<${e.sender.email}>`:""})]}),(0,u.jsxs)(M,{children:[o.date,", ",o.time]})]}),(0,u.jsxs)("div",{style:{display:"flex",alignItems:"center",marginBottom:"8px"},children:[(0,u.jsx)("div",{style:{fontSize:"0.75rem",backgroundColor:"outbound"===e.direction?"#2d562d":"#333",color:"outbound"===e.direction?"#8aff8a":"#ccc",padding:"2px 6px",borderRadius:"4px",marginRight:"8px"},children:"outbound"===e.direction?"Outbound":"Inbound"}),(0,u.jsxs)("div",{style:{fontSize:"0.9rem",color:"#ddd"},children:[(0,u.jsx)("strong",{children:"Subject:"})," ",e.subject]})]}),!t&&(0,u.jsx)(L,{children:e.body.length>100?`${e.body.substring(0,100).replace(/\n/g," ")}...`:e.body.replace(/\n/g," ")})]}),t&&(0,u.jsxs)(u.Fragment,{children:[(0,u.jsxs)("div",{style:{padding:"0 16px 16px"},children:[e.recipients&&e.recipients.length>0&&(0,u.jsxs)("div",{style:{fontSize:"0.85rem",color:"#ccc",marginBottom:"6px",display:"flex"},children:[(0,u.jsx)("div",{style:{minWidth:"45px",fontWeight:"bold",color:"#999"},children:"To:"}),(0,u.jsx)("div",{children:e.recipients.map((e=>"Unknown Recipient"!==e.name?`${e.name}${e.email?` <${e.email}>`:""}`:e.email||"Unknown")).join(", ")})]}),e.ccRecipients&&e.ccRecipients.length>0&&(0,u.jsxs)("div",{style:{fontSize:"0.85rem",color:"#ccc",marginBottom:"6px",display:"flex"},children:[(0,u.jsx)("div",{style:{minWidth:"45px",fontWeight:"bold",color:"#999"},children:"CC:"}),(0,u.jsx)("div",{children:e.ccRecipients.map((e=>"Unknown Recipient"!==e.name?`${e.name}${e.email?` <${e.email}>`:""}`:e.email||"Unknown")).join(", ")})]}),e.bccRecipients&&e.bccRecipients.length>0&&(0,u.jsxs)("div",{style:{fontSize:"0.85rem",color:"#ccc",marginBottom:"6px",display:"flex"},children:[(0,u.jsx)("div",{style:{minWidth:"45px",fontWeight:"bold",color:"#999"},children:"BCC:"}),(0,u.jsx)("div",{children:e.bccRecipients.map((e=>"Unknown Recipient"!==e.name?`${e.name}${e.email?` <${e.email}>`:""}`:e.email||"Unknown")).join(", ")})]}),e.hasAttachments&&e.attachmentCount>0&&(0,u.jsx)("div",{style:{fontSize:"0.85rem",color:"#4a9eff",marginTop:"8px",borderTop:"1px solid #333",paddingTop:"8px"},children:(0,u.jsxs)("div",{style:{fontWeight:"bold"},children:[e.attachmentCount," Attachment",1!==e.attachmentCount?"s":""]})})]}),(0,u.jsx)(F,{children:e.html?(0,u.jsx)("div",{dangerouslySetInnerHTML:{__html:e.html}}):(0,u.jsx)("div",{style:{whiteSpace:"pre-wrap"},children:e.body})})]}),e.body.length>100&&(0,u.jsx)("div",{style:{textAlign:"center",padding:"8px 0",cursor:"pointer",color:"#4a9eff",fontSize:"0.8rem"},onClick:()=>He(e.id),children:t?"\u25b2 Show less":"\u25bc Show more"})]},e.id)}))})]})},$e=e=>{if(ke)return(0,u.jsx)(v,{children:"Loading meeting details..."});if(!Se)return(0,u.jsx)(b,{children:"Meeting details not available"});const t=ze(Se.start_time),o=ze(Se.end_time);return(0,u.jsxs)(G,{children:[(0,u.jsxs)(z,{children:[(0,u.jsx)(H,{children:Se.title}),(0,u.jsxs)(B,{children:[(0,u.jsx)(a.wIk,{}),(0,u.jsxs)("span",{children:[t.date,", ",t.time," - ",o.time]})]}),(0,u.jsxs)(V,{children:[Se.attendees.map(((e,t)=>(0,u.jsx)($,{children:e},t))),0===Se.attendees.length&&(0,u.jsx)("span",{style:{color:"#6c757d",fontStyle:"italic",padding:"4px"},children:"No attendees listed"})]})]}),(0,u.jsxs)(U,{children:[(0,u.jsx)(h,{children:"Notes"}),(0,u.jsx)(W,{children:Se.notes||"No notes available for this meeting."})]})]})};return Y?(0,u.jsxs)("div",{style:{padding:"20px",width:"100%",height:"580px",maxHeight:"80vh",overflowY:"auto",backgroundColor:"#121212",border:"1px solid #333",borderRadius:"8px",color:"#e0e0e0",position:"relative"},children:[(0,u.jsxs)(p,{children:[(0,u.jsxs)("h2",{children:["Recent Interactions",r?` - ${r.first_name} ${r.last_name}`:""]}),(0,u.jsxs)("div",{style:{display:"flex",gap:"10px",alignItems:"center"},children:[(0,u.jsx)("button",{onClick:()=>(null===r||void 0===r?void 0:r.mobile)&&window.open(`https://wa.me/${r.mobile.replace(/\D/g,"")}`,"_blank"),"aria-label":"WhatsApp",title:"Open WhatsApp",style:{color:"#25D366"},children:(0,u.jsx)(s.faC,{size:24})}),(0,u.jsx)("button",{onClick:()=>{null!==r&&void 0!==r&&r.contact_id&&(r.email?window.open(`https://mail.superhuman.com/search/${encodeURIComponent(r.email)}`,"_blank"):(async()=>{try{const{data:e,error:t}=await l.supabase.from("contact_emails").select("email").eq("contact_id",r.contact_id).eq("is_primary",!0).limit(1);if(t)throw t;if(e&&e.length>0)window.open(`https://mail.superhuman.com/search/${encodeURIComponent(e[0].email)}`,"_blank");else{const{data:e,error:t}=await l.supabase.from("contact_emails").select("email").eq("contact_id",r.contact_id).limit(1);if(t)throw t;e&&e.length>0&&window.open(`https://mail.superhuman.com/search/${encodeURIComponent(e[0].email)}`,"_blank")}}catch(e){console.error("Error fetching contact email for Superhuman link:",e)}})())},"aria-label":"Email in Superhuman",title:"Open in Superhuman",style:{color:"#4a9eff"},children:(0,u.jsx)(a.pHD,{size:24})}),o&&(0,u.jsx)("button",{onClick:o,"aria-label":"Close",children:(0,u.jsx)(a.yGN,{size:20})})]})]}),Q&&(0,u.jsxs)(x,{children:[(0,u.jsx)(a.eHT,{size:20}),(0,u.jsx)("div",{children:Q})]}),(0,u.jsx)(f,{children:J?(0,u.jsx)(v,{style:{minHeight:"200px"},children:"Loading interactions..."}):(0,u.jsxs)(g,{children:[(0,u.jsxs)(m,{children:[c&&oe.length>0&&(0,u.jsxs)(u.Fragment,{children:[(0,u.jsx)("div",{style:{padding:"10px 15px",color:"#aaa",fontSize:"0.8rem",borderBottom:"1px solid #272727",fontWeight:"bold"},children:"WHATSAPP"}),oe.map(((e,t)=>(0,u.jsxs)("div",{style:{padding:"10px 15px",cursor:"pointer",borderBottom:"1px solid #191919",display:"flex",alignItems:"center",gap:"8px",backgroundColor:le===e.chat_id?"#1e1e1e":"transparent"},onClick:()=>Le(e.chat_id),children:[e.is_group_chat?(0,u.jsx)(a.cfS,{size:16,color:"#25d366"}):(0,u.jsx)(a.mEP,{size:16,color:"#25d366"}),(0,u.jsx)("span",{style:{color:"#25d366"},children:e.chat_name}),e.unread_count>0&&(0,u.jsx)("span",{style:{backgroundColor:"#222",color:"#888",padding:"1px 6px",borderRadius:"10px",fontSize:"0.7rem",marginLeft:"auto"},children:e.unread_count})]},e.chat_id||t)))]}),q&&re.length>0&&(0,u.jsxs)(u.Fragment,{children:[(0,u.jsx)("div",{style:{padding:"10px 15px",color:"#aaa",fontSize:"0.8rem",borderBottom:"1px solid #272727",fontWeight:"bold"},children:"EMAIL"}),re.map((e=>(0,u.jsxs)("div",{style:{padding:"10px 15px",cursor:"pointer",borderBottom:"1px solid #191919",display:"flex",alignItems:"center",gap:"8px",backgroundColor:fe===e.thread_id?"#1e1e1e":"transparent"},onClick:()=>Fe(e.thread_id),children:[(0,u.jsx)(a.pHD,{size:16,color:"#4a9eff"}),(0,u.jsx)("span",{style:{color:"#4a9eff",overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"},children:e.title})]},e.thread_id)))]}),K&&ae.length>0&&(0,u.jsxs)(u.Fragment,{children:[(0,u.jsx)("div",{style:{padding:"10px 15px",color:"#aaa",fontSize:"0.8rem",borderBottom:"1px solid #272727",fontWeight:"bold"},children:"MEETINGS"}),ae.map((e=>(0,u.jsxs)("div",{style:{padding:"10px 15px",cursor:"pointer",borderBottom:"1px solid #191919",display:"flex",alignItems:"center",gap:"8px",backgroundColor:Ce===e.id?"#1e1e1e":"transparent"},onClick:()=>Ge(e.id),children:[(0,u.jsx)(a.wIk,{size:16,color:"#ff9900"}),(0,u.jsx)("span",{style:{color:"#ff9900",overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"},children:e.title})]},e.id)))]}),(!c||0===oe.length)&&(!q||0===re.length)&&(!K||0===ae.length)&&(0,u.jsx)(b,{children:"No interactions found"})]}),(0,u.jsxs)(y,{children:[le&&"whatsapp"===ee&&Be(le),fe&&"email"===ee&&Ve(),Ce&&"meetings"===ee&&$e(),!ee&&(0,u.jsx)(b,{children:"Select an interaction to view details"})]})]})})]}):(0,u.jsxs)(i(),{isOpen:t,onRequestClose:o,style:{content:{top:"50%",left:"50%",right:"auto",bottom:"auto",marginRight:"-50%",transform:"translate(-50%, -50%)",padding:"25px",maxWidth:"920px",width:"95%",backgroundColor:"#121212",border:"1px solid #333",borderRadius:"8px",boxShadow:"0 4px 20px rgba(0, 0, 0, 0.6)",color:"#e0e0e0",maxHeight:"92vh",overflow:"auto"},overlay:{backgroundColor:"rgba(0, 0, 0, 0.75)",zIndex:1e3}},children:[(0,u.jsxs)(p,{children:[(0,u.jsxs)("h2",{children:["Recent Interactions",r?` - ${r.first_name} ${r.last_name}`:""]}),(0,u.jsxs)("div",{style:{display:"flex",gap:"10px",alignItems:"center"},children:[(0,u.jsx)("button",{onClick:()=>(null===r||void 0===r?void 0:r.mobile)&&window.open(`https://wa.me/${r.mobile.replace(/\D/g,"")}`,"_blank"),"aria-label":"WhatsApp",title:"Open WhatsApp",style:{color:"#25D366"},children:(0,u.jsx)(s.faC,{size:24})}),(0,u.jsx)("button",{onClick:()=>{null!==r&&void 0!==r&&r.contact_id&&(r.email?window.open(`https://mail.superhuman.com/search/${encodeURIComponent(r.email)}`,"_blank"):(async()=>{try{const{data:e,error:t}=await l.supabase.from("contact_emails").select("email").eq("contact_id",r.contact_id).eq("is_primary",!0).limit(1);if(t)throw t;if(e&&e.length>0)window.open(`https://mail.superhuman.com/search/${encodeURIComponent(e[0].email)}`,"_blank");else{const{data:e,error:t}=await l.supabase.from("contact_emails").select("email").eq("contact_id",r.contact_id).limit(1);if(t)throw t;e&&e.length>0&&window.open(`https://mail.superhuman.com/search/${encodeURIComponent(e[0].email)}`,"_blank")}}catch(e){console.error("Error fetching contact email for Superhuman link:",e)}})())},"aria-label":"Email in Superhuman",title:"Open in Superhuman",style:{color:"#4a9eff"},children:(0,u.jsx)(a.pHD,{size:24})}),(0,u.jsx)("button",{onClick:o,"aria-label":"Close modal",children:(0,u.jsx)(a.yGN,{size:20})})]})]}),Q&&(0,u.jsxs)(x,{children:[(0,u.jsx)(a.eHT,{size:20}),(0,u.jsx)("div",{children:Q})]}),(0,u.jsx)(f,{children:J?(0,u.jsx)(v,{style:{minHeight:"200px"},children:"Loading interactions..."}):(0,u.jsxs)(g,{children:[(0,u.jsxs)(m,{children:[c&&oe.length>0&&(0,u.jsxs)(u.Fragment,{children:[(0,u.jsx)("div",{style:{padding:"10px 15px",color:"#aaa",fontSize:"0.8rem",borderBottom:"1px solid #272727",fontWeight:"bold"},children:"WHATSAPP"}),oe.map(((e,t)=>(0,u.jsxs)("div",{style:{padding:"10px 15px",cursor:"pointer",borderBottom:"1px solid #191919",display:"flex",alignItems:"center",gap:"8px",backgroundColor:le===e.chat_id?"#1e1e1e":"transparent"},onClick:()=>Le(e.chat_id),children:[e.is_group_chat?(0,u.jsx)(a.cfS,{size:16,color:"#25d366"}):(0,u.jsx)(a.mEP,{size:16,color:"#25d366"}),(0,u.jsx)("span",{style:{color:"#25d366"},children:e.chat_name}),e.unread_count>0&&(0,u.jsx)("span",{style:{backgroundColor:"#222",color:"#888",padding:"1px 6px",borderRadius:"10px",fontSize:"0.7rem",marginLeft:"auto"},children:e.unread_count})]},e.chat_id||t)))]}),q&&re.length>0&&(0,u.jsxs)(u.Fragment,{children:[(0,u.jsx)("div",{style:{padding:"10px 15px",color:"#aaa",fontSize:"0.8rem",borderBottom:"1px solid #272727",fontWeight:"bold"},children:"EMAIL"}),re.map((e=>(0,u.jsxs)("div",{style:{padding:"10px 15px",cursor:"pointer",borderBottom:"1px solid #191919",display:"flex",alignItems:"center",gap:"8px",backgroundColor:fe===e.thread_id?"#1e1e1e":"transparent"},onClick:()=>Fe(e.thread_id),children:[(0,u.jsx)(a.pHD,{size:16,color:"#4a9eff"}),(0,u.jsx)("span",{style:{color:"#4a9eff",overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"},children:e.title})]},e.thread_id)))]}),K&&ae.length>0&&(0,u.jsxs)(u.Fragment,{children:[(0,u.jsx)("div",{style:{padding:"10px 15px",color:"#aaa",fontSize:"0.8rem",borderBottom:"1px solid #272727",fontWeight:"bold"},children:"MEETINGS"}),ae.map((e=>(0,u.jsxs)("div",{style:{padding:"10px 15px",cursor:"pointer",borderBottom:"1px solid #191919",display:"flex",alignItems:"center",gap:"8px",backgroundColor:Ce===e.id?"#1e1e1e":"transparent"},onClick:()=>Ge(e.id),children:[(0,u.jsx)(a.wIk,{size:16,color:"#ff9900"}),(0,u.jsx)("span",{style:{color:"#ff9900",overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"},children:e.title})]},e.id)))]}),(!c||0===oe.length)&&(!q||0===re.length)&&(!K||0===ae.length)&&(0,u.jsx)(b,{children:"No interactions found"})]}),(0,u.jsxs)(y,{children:[le&&"whatsapp"===ee&&Be(le),fe&&"email"===ee&&Ve(),Ce&&"meetings"===ee&&$e(),!ee&&(0,u.jsx)(b,{children:"Select an interaction to view details"})]})]})})]})}},9460:function(e,t,o){"use strict";var n=this&&this.__assign||function(){return n=Object.assign||function(e){for(var t,o=1,n=arguments.length;o<n;o++)for(var r in t=arguments[o])Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e},n.apply(this,arguments)},r=this&&this.__createBinding||(Object.create?function(e,t,o,n){void 0===n&&(n=o),Object.defineProperty(e,n,{enumerable:!0,get:function(){return t[o]}})}:function(e,t,o,n){void 0===n&&(n=o),e[n]=t[o]}),i=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),a=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var o in e)"default"!==o&&Object.prototype.hasOwnProperty.call(e,o)&&r(t,e,o);return i(t,e),t};Object.defineProperty(t,"__esModule",{value:!0});var s=o(7079),l=a(o(5043)),c=o(9201),d=o(3183),u=o(9724),p=o(8242),h=l.forwardRef((function(e,t){var o=l.useContext(c.BeansContext).context,r=l.useRef(null),i=l.useRef(null),a=l.useRef(null),f=l.useRef(null),g=l.useRef(null),m=l.useState(),y=m[0],v=m[1],b=l.useState(),x=b[0],w=b[1],C=l.useState(),_=C[0],S=C[1],E=l.useState(new p.CssClasses),k=E[0],j=E[1],A=l.useState(new p.CssClasses("ag-hidden")),R=A[0],O=A[1],T=l.useState(new p.CssClasses("ag-hidden")),D=T[0],P=T[1],N=l.useState(new p.CssClasses("ag-invisible")),I=N[0],M=N[1];l.useImperativeHandle(t,(function(){return{refresh:function(){return!1}}})),l.useLayoutEffect((function(){return d.showJsComp(y,o,i.current)}),[y]),u.useLayoutEffectOnce((function(){var t={setInnerRenderer:function(e,t){v(e),S(t)},setChildCount:function(e){return w(e)},addOrRemoveCssClass:function(e,t){return j((function(o){return o.setClass(e,t)}))},setContractedDisplayed:function(e){return P((function(t){return t.setClass("ag-hidden",!e)}))},setExpandedDisplayed:function(e){return O((function(t){return t.setClass("ag-hidden",!e)}))},setCheckboxVisible:function(e){return M((function(t){return t.setClass("ag-invisible",!e)}))}},n=o.createBean(new s.GroupCellRendererCtrl);return n.init(t,r.current,a.current,f.current,g.current,h,e),function(){o.destroyBean(n)}}));var L=l.useMemo((function(){return"ag-cell-wrapper "+k.toString()}),[k]),F=l.useMemo((function(){return"ag-group-expanded "+R.toString()}),[R]),G=l.useMemo((function(){return"ag-group-contracted "+D.toString()}),[D]),z=l.useMemo((function(){return"ag-group-checkbox "+I.toString()}),[I]),H=y&&y.componentFromFramework,B=H?y.componentClass:void 0,V=null==y&&null!=_,$=s._.escapeString(_,!0);return l.default.createElement("span",n({className:L,ref:r},e.colDef?{}:{role:"gridcell"}),l.default.createElement("span",{className:F,ref:f}),l.default.createElement("span",{className:G,ref:g}),l.default.createElement("span",{className:z,ref:a}),l.default.createElement("span",{className:"ag-group-value",ref:i},V&&l.default.createElement(l.default.Fragment,null,$),H&&l.default.createElement(B,n({},y.params))),l.default.createElement("span",{className:"ag-group-child-count"},x))}));t.default=h},9724:(e,t,o)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.useLayoutEffectOnce=t.useEffectOnce=void 0;var n=o(5043);t.useEffectOnce=function(e){var t=n.useRef(e),o=n.useRef(),r=n.useRef(!1),i=n.useRef(!1),a=n.useState(0)[1];r.current&&(i.current=!0),n.useEffect((function(){return r.current||(o.current=t.current(),r.current=!0),a((function(e){return e+1})),function(){i.current&&o.current&&o.current()}}),[])},t.useLayoutEffectOnce=function(e){var t=n.useRef(e),o=n.useRef(),r=n.useRef(!1),i=n.useRef(!1),a=n.useState(0)[1];r.current&&(i.current=!0),n.useLayoutEffect((function(){return r.current||(o.current=t.current(),r.current=!0),a((function(e){return e+1})),function(){i.current&&o.current&&o.current()}}),[])}}},t={};function o(n){var r=t[n];if(void 0!==r)return r.exports;var i=t[n]={exports:{}};return e[n].call(i.exports,i,i.exports,o),i.exports}o.m=e,o.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return o.d(t,{a:t}),t},(()=>{var e,t=Object.getPrototypeOf?e=>Object.getPrototypeOf(e):e=>e.__proto__;o.t=function(n,r){if(1&r&&(n=this(n)),8&r)return n;if("object"===typeof n&&n){if(4&r&&n.__esModule)return n;if(16&r&&"function"===typeof n.then)return n}var i=Object.create(null);o.r(i);var a={};e=e||[null,t({}),t([]),t(t)];for(var s=2&r&&n;"object"==typeof s&&!~e.indexOf(s);s=t(s))Object.getOwnPropertyNames(s).forEach((e=>a[e]=()=>n[e]));return a.default=()=>n,o.d(i,a),i}})(),o.d=(e,t)=>{for(var n in t)o.o(t,n)&&!o.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:t[n]})},o.f={},o.e=e=>Promise.all(Object.keys(o.f).reduce(((t,n)=>(o.f[n](e,t),t)),[])),o.u=e=>"static/js/"+e+"."+{198:"4f9cec97",647:"251841e5",748:"e99d6b10",936:"3e84004f",972:"fad09b34"}[e]+".chunk.js",o.miniCssF=e=>{},o.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"===typeof window)return window}}(),o.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),(()=>{var e={},t="contact-dashboard:";o.l=(n,r,i,a)=>{if(e[n])e[n].push(r);else{var s,l;if(void 0!==i)for(var c=document.getElementsByTagName("script"),d=0;d<c.length;d++){var u=c[d];if(u.getAttribute("src")==n||u.getAttribute("data-webpack")==t+i){s=u;break}}s||(l=!0,(s=document.createElement("script")).charset="utf-8",s.timeout=120,o.nc&&s.setAttribute("nonce",o.nc),s.setAttribute("data-webpack",t+i),s.src=n),e[n]=[r];var p=(t,o)=>{s.onerror=s.onload=null,clearTimeout(h);var r=e[n];if(delete e[n],s.parentNode&&s.parentNode.removeChild(s),r&&r.forEach((e=>e(o))),t)return t(o)},h=setTimeout(p.bind(null,void 0,{type:"timeout",target:s}),12e4);s.onerror=p.bind(null,s.onerror),s.onload=p.bind(null,s.onload),l&&document.head.appendChild(s)}}})(),o.r=e=>{"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},o.p="/",(()=>{var e={792:0};o.f.j=(t,n)=>{var r=o.o(e,t)?e[t]:void 0;if(0!==r)if(r)n.push(r[2]);else{var i=new Promise(((o,n)=>r=e[t]=[o,n]));n.push(r[2]=i);var a=o.p+o.u(t),s=new Error;o.l(a,(n=>{if(o.o(e,t)&&(0!==(r=e[t])&&(e[t]=void 0),r)){var i=n&&("load"===n.type?"missing":n.type),a=n&&n.target&&n.target.src;s.message="Loading chunk "+t+" failed.\n("+i+": "+a+")",s.name="ChunkLoadError",s.type=i,s.request=a,r[1](s)}}),"chunk-"+t,t)}};var t=(t,n)=>{var r,i,a=n[0],s=n[1],l=n[2],c=0;if(a.some((t=>0!==e[t]))){for(r in s)o.o(s,r)&&(o.m[r]=s[r]);if(l)l(o)}for(t&&t(n);c<a.length;c++)i=a[c],o.o(e,i)&&e[i]&&e[i][0](),e[i]=0},n=self.webpackChunkcontact_dashboard=self.webpackChunkcontact_dashboard||[];n.forEach(t.bind(null,0)),n.push=t.bind(null,n.push.bind(n))})(),o.nc=void 0,(()=>{"use strict";var e={};o.r(e),o.d(e,{hasBrowserEnv:()=>oI,hasStandardBrowserEnv:()=>rI,hasStandardBrowserWebWorkerEnv:()=>iI,navigator:()=>nI,origin:()=>aI});var t=o(5043),n=o.t(t,2),r=o(4391),i=o(3216),a=o(7950),s=o.t(a,2),l=o(1387);function c(){return c=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var o=arguments[t];for(var n in o)Object.prototype.hasOwnProperty.call(o,n)&&(e[n]=o[n])}return e},c.apply(this,arguments)}function d(e,t){if(null==e)return{};var o,n,r={},i=Object.keys(e);for(n=0;n<i.length;n++)o=i[n],t.indexOf(o)>=0||(r[o]=e[o]);return r}function u(e){return void 0===e&&(e=""),new URLSearchParams("string"===typeof e||Array.isArray(e)||e instanceof URLSearchParams?e:Object.keys(e).reduce(((t,o)=>{let n=e[o];return t.concat(Array.isArray(n)?n.map((e=>[o,e])):[[o,n]])}),[]))}new Set(["application/x-www-form-urlencoded","multipart/form-data","text/plain"]);const p=["onClick","relative","reloadDocument","replace","state","target","to","preventScrollReset","viewTransition"];try{window.__reactRouterVersion="6"}catch(SM){}function h(){var e;let t=null==(e=window)?void 0:e.__staticRouterHydrationData;return t&&t.errors&&(t=c({},t,{errors:f(t.errors)})),t}function f(e){if(!e)return null;let t=Object.entries(e),o={};for(let[n,r]of t)if(r&&"RouteErrorResponse"===r.__type)o[n]=new l.VV(r.status,r.statusText,r.data,!0===r.internal);else if(r&&"Error"===r.__type){if(r.__subType){let e=window[r.__subType];if("function"===typeof e)try{let t=new e(r.message);t.stack="",o[n]=t}catch(SM){}}if(null==o[n]){let e=new Error(r.message);e.stack="",o[n]=e}}else o[n]=r;return o}const g=t.createContext({isTransitioning:!1});const m=t.createContext(new Map);const y=n.startTransition,v=s.flushSync;n.useId;function b(e){v?v(e):e()}class x{constructor(){this.status="pending",this.promise=new Promise(((e,t)=>{this.resolve=t=>{"pending"===this.status&&(this.status="resolved",e(t))},this.reject=e=>{"pending"===this.status&&(this.status="rejected",t(e))}}))}}function w(e){let{fallbackElement:o,router:n,future:r}=e,[a,s]=t.useState(n.state),[l,c]=t.useState(),[d,u]=t.useState({isTransitioning:!1}),[p,h]=t.useState(),[f,v]=t.useState(),[w,_]=t.useState(),S=t.useRef(new Map),{v7_startTransition:E}=r||{},k=t.useCallback((e=>{E?function(e){y?y(e):e()}(e):e()}),[E]),j=t.useCallback(((e,t)=>{let{deletedFetchers:o,flushSync:r,viewTransitionOpts:i}=t;e.fetchers.forEach(((e,t)=>{void 0!==e.data&&S.current.set(t,e.data)})),o.forEach((e=>S.current.delete(e)));let a=null==n.window||null==n.window.document||"function"!==typeof n.window.document.startViewTransition;if(i&&!a){if(r){b((()=>{f&&(p&&p.resolve(),f.skipTransition()),u({isTransitioning:!0,flushSync:!0,currentLocation:i.currentLocation,nextLocation:i.nextLocation})}));let t=n.window.document.startViewTransition((()=>{b((()=>s(e)))}));return t.finished.finally((()=>{b((()=>{h(void 0),v(void 0),c(void 0),u({isTransitioning:!1})}))})),void b((()=>v(t)))}f?(p&&p.resolve(),f.skipTransition(),_({state:e,currentLocation:i.currentLocation,nextLocation:i.nextLocation})):(c(e),u({isTransitioning:!0,flushSync:!1,currentLocation:i.currentLocation,nextLocation:i.nextLocation}))}else r?b((()=>s(e))):k((()=>s(e)))}),[n.window,f,p,S,k]);t.useLayoutEffect((()=>n.subscribe(j)),[n,j]),t.useEffect((()=>{d.isTransitioning&&!d.flushSync&&h(new x)}),[d]),t.useEffect((()=>{if(p&&l&&n.window){let e=l,t=p.promise,o=n.window.document.startViewTransition((async()=>{k((()=>s(e))),await t}));o.finished.finally((()=>{h(void 0),v(void 0),c(void 0),u({isTransitioning:!1})})),v(o)}}),[k,l,p,n.window]),t.useEffect((()=>{p&&l&&a.location.key===l.location.key&&p.resolve()}),[p,f,a.location,l]),t.useEffect((()=>{!d.isTransitioning&&w&&(c(w.state),u({isTransitioning:!0,flushSync:!1,currentLocation:w.currentLocation,nextLocation:w.nextLocation}),_(void 0))}),[d.isTransitioning,w]),t.useEffect((()=>{}),[]);let A=t.useMemo((()=>({createHref:n.createHref,encodeLocation:n.encodeLocation,go:e=>n.navigate(e),push:(e,t,o)=>n.navigate(e,{state:t,preventScrollReset:null==o?void 0:o.preventScrollReset}),replace:(e,t,o)=>n.navigate(e,{replace:!0,state:t,preventScrollReset:null==o?void 0:o.preventScrollReset})})),[n]),R=n.basename||"/",O=t.useMemo((()=>({router:n,navigator:A,static:!1,basename:R})),[n,A,R]),T=t.useMemo((()=>({v7_relativeSplatPath:n.future.v7_relativeSplatPath})),[n.future.v7_relativeSplatPath]);return t.useEffect((()=>(0,i.V8)(r,n.future)),[r,n.future]),t.createElement(t.Fragment,null,t.createElement(i.sp.Provider,{value:O},t.createElement(i.Rq.Provider,{value:a},t.createElement(m.Provider,{value:S.current},t.createElement(g.Provider,{value:d},t.createElement(i.Ix,{basename:R,location:a.location,navigationType:a.historyAction,navigator:A,future:T},a.initialized||n.future.v7_partialHydration?t.createElement(C,{routes:n.routes,future:n.future,state:a}):o))))),null)}const C=t.memo(_);function _(e){let{routes:t,future:o,state:n}=e;return(0,i.ph)(t,void 0,n,o)}const S="undefined"!==typeof window&&"undefined"!==typeof window.document&&"undefined"!==typeof window.document.createElement,E=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,k=t.forwardRef((function(e,o){let n,{onClick:r,relative:a,reloadDocument:s,replace:u,state:h,target:f,to:g,preventScrollReset:m,viewTransition:y}=e,v=d(e,p),{basename:b}=t.useContext(i.jb),x=!1;if("string"===typeof g&&E.test(g)&&(n=g,S))try{let e=new URL(window.location.href),t=g.startsWith("//")?new URL(e.protocol+g):new URL(g),o=(0,l.pb)(t.pathname,b);t.origin===e.origin&&null!=o?g=o+t.search+t.hash:x=!0}catch(SM){}let w=(0,i.$P)(g,{relative:a}),C=function(e,o){let{target:n,replace:r,state:a,preventScrollReset:s,relative:c,viewTransition:d}=void 0===o?{}:o,u=(0,i.Zp)(),p=(0,i.zy)(),h=(0,i.x$)(e,{relative:c});return t.useCallback((t=>{if(function(e,t){return 0===e.button&&(!t||"_self"===t)&&!function(e){return!!(e.metaKey||e.altKey||e.ctrlKey||e.shiftKey)}(e)}(t,n)){t.preventDefault();let o=void 0!==r?r:(0,l.AO)(p)===(0,l.AO)(h);u(e,{replace:o,state:a,preventScrollReset:s,relative:c,viewTransition:d})}}),[p,u,h,r,a,n,e,s,c,d])}(g,{replace:u,state:h,target:f,preventScrollReset:m,relative:a,viewTransition:y});return t.createElement("a",c({},v,{href:n||w,onClick:x||s?r:function(e){r&&r(e),e.defaultPrevented||C(e)},ref:o,target:f}))}));var j,A,R,O;function T(e){let o=t.useRef(u(e)),n=t.useRef(!1),r=(0,i.zy)(),a=t.useMemo((()=>function(e,t){let o=u(e);return t&&t.forEach(((e,n)=>{o.has(n)||t.getAll(n).forEach((e=>{o.append(n,e)}))})),o}(r.search,n.current?null:o.current)),[r.search]),s=(0,i.Zp)(),l=t.useCallback(((e,t)=>{const o=u("function"===typeof e?e(a):e);n.current=!0,s("?"+o,t)}),[s,a]);return[a,l]}(A=j||(j={})).UseScrollRestoration="useScrollRestoration",A.UseSubmit="useSubmit",A.UseSubmitFetcher="useSubmitFetcher",A.UseFetcher="useFetcher",A.useViewTransitionState="useViewTransitionState",(O=R||(R={})).UseFetcher="useFetcher",O.UseFetchers="useFetchers",O.UseScrollRestoration="useScrollRestoration";var D=o(5315),P=o(1529),N=o(579);const I=P.Ay.div`
  max-width: 400px;
  margin: 100px auto;
  padding: 2rem;
  background: white;
  border-radius: 8px;
  box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
`,M=P.Ay.form`
  display: flex;
  flex-direction: column;
  gap: 1rem;
`,L=P.Ay.input`
  padding: 0.75rem;
  border: 1px solid #ddd;
  border-radius: 4px;
`,F=P.Ay.button`
  padding: 0.75rem;
  background-color: #0070f3;
  color: white;
  border: none;
  border-radius: 4px;
  cursor: pointer;
  
  &:hover {
    background-color: #0060df;
  }
`,G=P.Ay.div`
  color: red;
  margin-top: 1rem;
`,z=()=>{const[e,o]=(0,t.useState)(""),[n,r]=(0,t.useState)(""),[i,a]=(0,t.useState)(null),[s,l]=(0,t.useState)(!1);return(0,N.jsxs)(I,{children:[(0,N.jsx)("h1",{children:"Login"}),(0,N.jsxs)(M,{onSubmit:async t=>{t.preventDefault(),l(!0),a(null);try{const{error:t}=await D.supabase.auth.signInWithPassword({email:e,password:n});if(t)throw t}catch(i){a(i.message)}finally{l(!1)}},children:[(0,N.jsx)(L,{type:"email",placeholder:"Email",value:e,onChange:e=>o(e.target.value),required:!0}),(0,N.jsx)(L,{type:"password",placeholder:"Password",value:n,onChange:e=>r(e.target.value),required:!0}),(0,N.jsx)(F,{type:"submit",disabled:s,children:s?"Loading...":"Login"})]}),i&&(0,N.jsx)(G,{children:i})]})},H=e=>{let{size:t=24,className:o=""}=e;return(0,N.jsxs)("svg",{width:t,height:t,viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",className:o,children:[(0,N.jsx)("circle",{cx:"9",cy:"7",r:"4",fill:"#00cc00"}),(0,N.jsx)("path",{d:"M2 21c0-4.418 3.582-8 8-8s8 3.582 8 8",stroke:"#00cc00",strokeWidth:"2",fill:"#00cc00",opacity:"0.8"}),(0,N.jsx)("circle",{cx:"16",cy:"6",r:"3.5",fill:"#66ff66",opacity:"0.9"}),(0,N.jsx)("path",{d:"M10 20c0-3.5 2.5-6.5 6-6.5s6 3 6 6.5",stroke:"#66ff66",strokeWidth:"1.8",fill:"#66ff66",opacity:"0.7"})]})};var B=o(1009);const V=e=>{let{size:t=24,className:o=""}=e;return(0,N.jsx)(B.z8N,{size:t,className:o,style:{color:"#66ff66"}})},$=P.Ay.div`
  display: flex;
  min-height: 100vh;
  background-color: #000000;
`,U=P.Ay.aside`
  width: ${e=>e.$isOpen?"260px":"60px"};
  background-color: #000000;
  color: #ffffff;
  display: flex;
  flex-direction: column;
  transition: all 0.3s ease;
  position: fixed;
  height: 100vh;
  z-index: 50;
  overflow: hidden;
  
  @media (max-width: 768px) {
    width: ${e=>e.$isOpen?"260px":"0"};
    transform: ${e=>e.$isOpen?"translateX(0)":"translateX(-100%)"};
  }
`,W=P.Ay.div`
  padding: 1.25rem;
  border-bottom: 1px solid #333333;
  display: flex;
  justify-content: ${e=>(e.$isOpen,"center")};
  align-items: center;
  position: relative;
`,q=P.Ay.button`
  position: absolute;
  right: 8px;
  background: none;
  border: none;
  color: #ffffff;
  font-size: 1.2rem;
  cursor: pointer;
  padding: 8px;
  border-radius: 4px;
  transition: all 0.2s ease;
  
  &:hover {
    background-color: #333333;
    color: #00ff00;
  }
  
  @media (max-width: 768px) {
    display: none;
  }
`,K=P.Ay.div`
  img {
    max-width: ${e=>e.$isOpen?"180px":"40px"};
    height: auto;
    transition: all 0.3s ease;
  }
`,Y=P.Ay.div`
  padding: 1rem 0;
  flex: 1;
  overflow-y: auto;
  
  /* Custom scrollbar for dark background */
  &::-webkit-scrollbar {
    width: 6px;
  }
  
  &::-webkit-scrollbar-track {
    background: #333333;
  }
  
  &::-webkit-scrollbar-thumb {
    background-color: #555555;
    border-radius: 3px;
  }
`,J=P.Ay.div`
  margin-bottom: 4px;
`,X=P.Ay.div`
  display: flex;
  align-items: center;
  justify-content: ${e=>e.$isOpen?"space-between":"flex-start"};
  padding: ${e=>e.$isOpen?"0.75rem 1.5rem 0.75rem 2.25rem":"0.75rem 0.5rem"};
  color: ${e=>e.$active?"#00ff00":"#ffffff"};
  background-color: ${e=>e.$active?"#333333":"transparent"};
  border-left: 3px solid ${e=>e.$active?"#444444":"transparent"};
  text-decoration: none;
  transition: all 0.3s ease;
  cursor: pointer;
  font-family: 'Courier New', Courier, monospace;
  letter-spacing: 0.5px;
  position: relative;
  white-space: nowrap;
  overflow: hidden;
  
  &:hover {
    background-color: ${e=>e.$active?"#333333":"#222222"};
    color: #00ff00;
  }
`,Q=(0,P.Ay)(k)`
  display: flex;
  align-items: center;
  justify-content: ${e=>e.$isOpen?"flex-start":"center"};
  color: inherit;
  text-decoration: none;
  flex: 1;
  font-family: 'Courier New', Courier, monospace;
  letter-spacing: 0.5px;
  white-space: nowrap;
  overflow: hidden;
  transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1);
  width: 100%;
`,Z=P.Ay.span`
  opacity: ${e=>e.$isOpen?"1":"0"};
  width: ${e=>e.$isOpen?"auto":"0"};
  transition: all 0.3s ease;
  overflow: hidden;
  white-space: nowrap;
`,ee=P.Ay.span`
  font-size: 1.2rem;
  margin-right: ${e=>e.$isOpen?"0.5rem":"0"};
  transition: all 0.3s ease;
`,te=P.Ay.div`
  max-height: ${e=>e.$isOpen?"500px":"0"};
  overflow: hidden;
  transition: max-height 0.3s ease;
  background-color: #111111;
  border-left: 1px solid #444444;
  margin-left: 24px;
  position: relative;
  
  &:before {
    content: "";
    position: absolute;
    top: 0;
    left: 0;
    right: 0;
    height: 100%;
    background: repeating-linear-gradient(
      0deg,
      transparent,
      transparent 2px,
      rgba(0, 0, 0, 0.03) 2px,
      rgba(0, 0, 0, 0.03) 4px
    );
    pointer-events: none;
    opacity: 0.2;
  }
`,oe=(0,P.Ay)(k)`
  display: flex;
  align-items: center;
  padding: 0.625rem 1.5rem 0.625rem 2.5rem;
  color: ${e=>e.$active?"#00ff00":"#86c786"};
  background-color: ${e=>e.$active?"#222222":"transparent"};
  border-left: 3px solid ${e=>e.$active?"#444444":"transparent"};
  font-size: 0.875rem;
  font-family: 'Courier New', Courier, monospace;
  letter-spacing: 0.5px;
  text-decoration: none;
  transition: all 0.2s;
  position: relative;
  
  &:hover {
    background-color: #222222;
    color: #00ff00;
    text-shadow: 0 0 2px rgba(0, 255, 0, 0.4);
  }
`,ne=P.Ay.div`
  padding: 1rem ${e=>e.$isOpen?"1.5rem":"0.5rem"};
  border-top: 1px solid #333333;
  background-color: #111111;
  transition: all 0.3s ease;
`,re=P.Ay.div`
  display: flex;
  align-items: center;
  justify-content: ${e=>e.$isOpen?"flex-start":"center"};
`,ie=P.Ay.div`
  width: 2.5rem;
  height: 2.5rem;
  border-radius: 50%;
  background-color: #555555;
  display: flex;
  align-items: center;
  justify-content: center;
  margin-right: ${e=>e.$isOpen?"0.75rem":"0"};
  font-weight: bold;
  color: #ffffff;
  transition: all 0.3s ease;
`,ae=P.Ay.div`
  flex: 1;
  opacity: ${e=>e.$isOpen?"1":"0"};
  width: ${e=>e.$isOpen?"auto":"0"};
  overflow: hidden;
  transition: all 0.3s ease;
`,se=P.Ay.div`
  font-weight: 600;
  color: #ffffff;
`,le=P.Ay.div`
  font-size: 0.75rem;
  color: #cccccc;
`,ce=P.Ay.main`
  flex: 1;
  margin-left: ${e=>e.$sidebarOpen?"260px":"60px"};
  transition: all 0.3s ease;
  width: ${e=>e.$sidebarOpen?"calc(100% - 260px)":"calc(100% - 60px)"};
  padding-left: 0;
  
  @media (max-width: 768px) {
    margin-left: 0;
    width: 100%;
  }
`,de=(P.Ay.header`
  background-color: black;
  border-bottom: none;
  padding: 0.75rem 1.5rem;
  display: flex;
  align-items: center;
  justify-content: space-between;
  position: sticky;
  top: 0;
  z-index: 40;
`,P.Ay.h1`
  font-size: 1.25rem;
  font-weight: 600;
  color: white;
  margin: 0;
`,P.Ay.div`
  display: flex;
  align-items: center;
  gap: 1rem;
`,P.Ay.button`
  background-color: transparent;
  border: none;
  color: #6b7280;
  font-size: 1.25rem;
  cursor: pointer;
  padding: 0.5rem;
  border-radius: 0.375rem;
  display: flex;
  align-items: center;
  justify-content: center;
  transition: all 0.2s;
  
  &:hover {
    background-color: #f3f4f6;
    color: #111827;
  }
`),ue=((0,P.Ay)(de)`
  display: none;
  
  @media (max-width: 768px) {
    display: flex;
  }
`,P.Ay.button`
  background: none;
  border: none;
  color: #86c786;
  cursor: pointer;
  padding: 0.5rem 0;
  font-family: 'Courier New', Courier, monospace;
  letter-spacing: 0.5px;
  transition: all 0.2s ease;
  opacity: ${e=>e.$isOpen?"1":"0"};
  width: ${e=>e.$isOpen?"auto":"0"};
  overflow: hidden;
  
  &:hover {
    color: #00ff00;
  }
`),pe=P.Ay.div`
  padding: 0;
  max-width: 1600px;
  margin: 0;
  background-color: #000000;
  color: white;
`,he=P.Ay.div`
  color: #666666;
  transition: all 0.2s ease;
  font-size: 0.9rem;
  opacity: 0.7;
  
  &:hover {
    color: #00ff00;
    opacity: 1;
  }
`,fe=e=>{let{children:o}=e;const[n,r]=(0,t.useState)(!0),a=(0,i.zy)(),[s,l]=(0,t.useState)({v1:!0}),c=e=>{l((t=>({...t,[e]:!t[e]})))},d=e=>a.pathname===e||a.pathname.startsWith(`${e}/`);return(0,N.jsxs)($,{children:[(0,N.jsxs)(U,{$isOpen:n,children:[(0,N.jsxs)(W,{$isOpen:n,children:[(0,N.jsx)(q,{onClick:()=>{r(!n)},children:n?(0,N.jsx)(B.yGN,{}):(0,N.jsx)(B.ND1,{})}),(0,N.jsx)(K,{$isOpen:n,children:(0,N.jsx)("img",{src:"https://assets.softr-files.com/applications/4612f2ab-9299-411a-b90c-78cfdc9b1a1b/assets/9f11c75a-a815-4686-9092-c9f8af95a4e1.jpeg",alt:"CRM Dashboard Logo"})})]}),(0,N.jsxs)(Y,{children:[(0,N.jsxs)(J,{children:[(0,N.jsxs)(X,{$active:d("/"),$isOpen:n,onClick:()=>n&&c("v1"),children:[(0,N.jsxs)(Q,{to:"/",$isOpen:n,children:[(0,N.jsx)(ee,{$isOpen:n,children:(0,N.jsx)(H,{size:20})}),(0,N.jsx)(Z,{$isOpen:n,children:"Contacts"})]}),n&&(0,N.jsx)(he,{children:s.v1?(0,N.jsx)(B.fK4,{size:16}):(0,N.jsx)(B.fOo,{size:16})})]}),n&&(0,N.jsxs)(te,{$isOpen:s.v1,children:[(0,N.jsx)(oe,{to:"/contacts/interactions",$active:d("/contacts/interactions"),children:"Interactions"}),(0,N.jsx)(oe,{to:"/contacts/lists",$active:d("/contacts/lists"),children:"Lists"}),(0,N.jsx)(oe,{to:"/inbox",$active:d("/inbox"),children:"Processing"})]})]}),(0,N.jsxs)(J,{children:[(0,N.jsxs)(X,{$active:d("/opportunities"),$isOpen:n,onClick:()=>n&&c("opportunities"),children:[(0,N.jsxs)(Q,{to:"/opportunities",$isOpen:n,children:[(0,N.jsx)(ee,{$isOpen:n,children:(0,N.jsx)(V,{size:20})}),(0,N.jsx)(Z,{$isOpen:n,children:"Opportunities"})]}),n&&(0,N.jsx)(he,{children:s.opportunities?(0,N.jsx)(B.fK4,{size:16}):(0,N.jsx)(B.fOo,{size:16})})]}),n&&(0,N.jsxs)(te,{$isOpen:s.opportunities,children:[(0,N.jsx)(oe,{to:"/companies/deals",$active:d("/companies/deals"),children:"Deals"}),(0,N.jsx)(oe,{to:"/companies",$active:d("/companies")&&!d("/companies/deals"),children:"Companies"})]})]})]}),(0,N.jsxs)(ne,{$isOpen:n,children:[(0,N.jsxs)(re,{$isOpen:n,children:[(0,N.jsx)(ie,{$isOpen:n,children:"SC"}),(0,N.jsxs)(ae,{$isOpen:n,children:[(0,N.jsx)(se,{children:"Simone Cimminelli"}),(0,N.jsx)(le,{children:"Administrator"})]})]}),(0,N.jsx)(ue,{$isOpen:n,onClick:async()=>{try{const{error:e}=await D.supabase.auth.signOut();if(e)throw e}catch(e){console.error("Error signing out:",e.message)}},children:"exit"})]})]}),(0,N.jsx)(ce,{$sidebarOpen:n,children:(0,N.jsx)(pe,{children:o})})]})};var ge=o(8725);const me=P.Ay.div`
  background: white;
  border-radius: 16px;
  box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
  padding: 1.5rem;
`,ye=P.Ay.div`
  display: flex;
  justify-content: space-between;
  align-items: center;
  margin-bottom: 1.5rem;
`,ve=P.Ay.div`
  border: 1px solid #eee;
  border-radius: 8px;
  padding: 1rem;
  margin-bottom: 1rem;
  display: flex;
  justify-content: space-between;
  align-items: center;
  background: ${e=>e.new?"#f0f7ff":"white"};
`,be=P.Ay.div`
  flex: 1;
`,xe=P.Ay.div`
  display: flex;
  gap: 0.5rem;
`,we=P.Ay.button`
  padding: 0.5rem 0.75rem;
  border: none;
  border-radius: 4px;
  cursor: pointer;
`,Ce=(0,P.Ay)(we)`
  background-color: black;
  color: white;
  
  &:hover {
    background-color: #333333;
  }
`,_e=(0,P.Ay)(we)`
  background-color: #28a745;
  color: white;
  
  &:hover {
    background-color: #218838;
  }
`,Se=P.Ay.span`
  background-color: #6c757d;
  color: white;
  padding: 0.25rem 0.5rem;
  border-radius: 999px;
  font-size: 0.75rem;
  margin-right: 0.5rem;
`,Ee=P.Ay.span`
  color: #6c757d;
  font-size: 0.85rem;
`,ke=P.Ay.p`
  text-align: center;
  color: #6c757d;
  padding: 2rem 0;
`,je=()=>{const[e,o]=(0,t.useState)([]),[n,r]=(0,t.useState)(!0);async function i(){r(!0);const{data:e,error:t}=await D.supabase.from("contact_tags").select("\n        *,\n        contacts:contact_id (\n          id, \n          first_name, \n          last_name, \n          email, \n          email2,\n          email3\n        )\n      ").eq("reviewed",!1).order("created_at",{ascending:!1});t?console.error("Error fetching notifications:",t):o(e||[]),r(!1)}return(0,t.useEffect)((()=>{i();const e=D.supabase.channel("public:contact_tags").on("INSERT",(e=>{i()})).subscribe();return()=>{D.supabase.removeChannel(e)}}),[]),(0,N.jsxs)(me,{children:[(0,N.jsx)(ye,{children:(0,N.jsxs)("h2",{children:["New Contacts (",e.length,")"]})}),n?(0,N.jsx)("p",{children:"Loading notifications..."}):0===e.length?(0,N.jsx)(ke,{children:"No new contacts to review."}):(0,N.jsx)("div",{children:e.map((e=>{var t,o,n;return(0,N.jsxs)(ve,{new:!e.reviewed,children:[(0,N.jsxs)(be,{children:[(0,N.jsxs)("h3",{children:[(null===(t=e.contacts)||void 0===t?void 0:t.first_name)||""," ",(null===(o=e.contacts)||void 0===o?void 0:o.last_name)||""]}),(0,N.jsx)("p",{children:(null===(n=e.contacts)||void 0===n?void 0:n.email)||"No email"}),(0,N.jsxs)("div",{children:[(0,N.jsx)(Se,{children:e.source||"Unknown"}),(0,N.jsx)(Ee,{children:(0,ge.A)(new Date(e.created_at),"PPp")})]})]}),(0,N.jsxs)(xe,{children:[(0,N.jsx)(k,{to:`/contacts/edit/${e.contact_id}`,children:(0,N.jsx)(Ce,{children:"Review"})}),(0,N.jsx)(_e,{onClick:()=>async function(e){const{error:t}=await D.supabase.from("contact_tags").update({reviewed:!0,reviewed_at:(new Date).toISOString()}).eq("id",e);t?console.error("Error marking as reviewed:",t):i()}(e.id),children:"Mark as Reviewed"})]})]},e.id)}))})]})};var Ae=o(5369),Re=(Math.pow(10,8),6e4),Oe=36e5,Te=o(3666),De=o(8355);function Pe(e,t){var o;(0,Te.A)(1,arguments);var n=(0,De.A)(null!==(o=null===t||void 0===t?void 0:t.additionalDigits)&&void 0!==o?o:2);if(2!==n&&1!==n&&0!==n)throw new RangeError("additionalDigits must be 0, 1 or 2");if("string"!==typeof e&&"[object String]"!==Object.prototype.toString.call(e))return new Date(NaN);var r,i=function(e){var t,o={},n=e.split(Ne.dateTimeDelimiter);if(n.length>2)return o;/:/.test(n[0])?t=n[0]:(o.date=n[0],t=n[1],Ne.timeZoneDelimiter.test(o.date)&&(o.date=e.split(Ne.timeZoneDelimiter)[0],t=e.substr(o.date.length,e.length)));if(t){var r=Ne.timezone.exec(t);r?(o.time=t.replace(r[1],""),o.timezone=r[1]):o.time=t}return o}(e);if(i.date){var a=function(e,t){var o=new RegExp("^(?:(\\d{4}|[+-]\\d{"+(4+t)+"})|(\\d{2}|[+-]\\d{"+(2+t)+"})$)"),n=e.match(o);if(!n)return{year:NaN,restDateString:""};var r=n[1]?parseInt(n[1]):null,i=n[2]?parseInt(n[2]):null;return{year:null===i?r:100*i,restDateString:e.slice((n[1]||n[2]).length)}}(i.date,n);r=function(e,t){if(null===t)return new Date(NaN);var o=e.match(Ie);if(!o)return new Date(NaN);var n=!!o[4],r=Fe(o[1]),i=Fe(o[2])-1,a=Fe(o[3]),s=Fe(o[4]),l=Fe(o[5])-1;if(n)return function(e,t,o){return t>=1&&t<=53&&o>=0&&o<=6}(0,s,l)?function(e,t,o){var n=new Date(0);n.setUTCFullYear(e,0,4);var r=n.getUTCDay()||7,i=7*(t-1)+o+1-r;return n.setUTCDate(n.getUTCDate()+i),n}(t,s,l):new Date(NaN);var c=new Date(0);return function(e,t,o){return t>=0&&t<=11&&o>=1&&o<=(ze[t]||(He(e)?29:28))}(t,i,a)&&function(e,t){return t>=1&&t<=(He(e)?366:365)}(t,r)?(c.setUTCFullYear(t,i,Math.max(r,a)),c):new Date(NaN)}(a.restDateString,a.year)}if(!r||isNaN(r.getTime()))return new Date(NaN);var s,l=r.getTime(),c=0;if(i.time&&(c=function(e){var t=e.match(Me);if(!t)return NaN;var o=Ge(t[1]),n=Ge(t[2]),r=Ge(t[3]);if(!function(e,t,o){if(24===e)return 0===t&&0===o;return o>=0&&o<60&&t>=0&&t<60&&e>=0&&e<25}(o,n,r))return NaN;return o*Oe+n*Re+1e3*r}(i.time),isNaN(c)))return new Date(NaN);if(!i.timezone){var d=new Date(l+c),u=new Date(0);return u.setFullYear(d.getUTCFullYear(),d.getUTCMonth(),d.getUTCDate()),u.setHours(d.getUTCHours(),d.getUTCMinutes(),d.getUTCSeconds(),d.getUTCMilliseconds()),u}return s=function(e){if("Z"===e)return 0;var t=e.match(Le);if(!t)return 0;var o="+"===t[1]?-1:1,n=parseInt(t[2]),r=t[3]&&parseInt(t[3])||0;if(!function(e,t){return t>=0&&t<=59}(0,r))return NaN;return o*(n*Oe+r*Re)}(i.timezone),isNaN(s)?new Date(NaN):new Date(l+c+s)}var Ne={dateTimeDelimiter:/[T ]/,timeZoneDelimiter:/[Z ]/i,timezone:/([Z+-].*)$/},Ie=/^-?(?:(\d{3})|(\d{2})(?:-?(\d{2}))?|W(\d{2})(?:-?(\d{1}))?|)$/,Me=/^(\d{2}(?:[.,]\d*)?)(?::?(\d{2}(?:[.,]\d*)?))?(?::?(\d{2}(?:[.,]\d*)?))?$/,Le=/^([+-])(\d{2})(?::?(\d{2}))?$/;function Fe(e){return e?parseInt(e):1}function Ge(e){return e&&parseFloat(e.replace(",","."))||0}var ze=[31,null,31,30,31,30,31,31,30,31,30,31];function He(e){return e%400===0||e%4===0&&e%100!==0}var Be=o(5837),Ve=o(6260),$e=o(4967);function Ue(e){(0,Te.A)(1,arguments);var t=(0,Ve.A)(e);return t.setHours(0,0,0,0),t}function We(e,t){var o=e.getFullYear()-t.getFullYear()||e.getMonth()-t.getMonth()||e.getDate()-t.getDate()||e.getHours()-t.getHours()||e.getMinutes()-t.getMinutes()||e.getSeconds()-t.getSeconds()||e.getMilliseconds()-t.getMilliseconds();return o<0?-1:o>0?1:o}function qe(e,t){(0,Te.A)(2,arguments);var o=(0,Ve.A)(e),n=(0,Ve.A)(t),r=We(o,n),i=Math.abs(function(e,t){(0,Te.A)(2,arguments);var o=Ue(e),n=Ue(t),r=o.getTime()-(0,$e.A)(o),i=n.getTime()-(0,$e.A)(n);return Math.round((r-i)/864e5)}(o,n));o.setDate(o.getDate()-r*i);var a=r*(i-Number(We(o,n)===-r));return 0===a?0:a}function Ke(e,t){(0,Te.A)(2,arguments);var o=(0,Ve.A)(e),n=(0,Ve.A)(t),r=o.getTime()-n.getTime();return r<0?-1:r>0?1:r}function Ye(e){(0,Te.A)(1,arguments);var t=(0,Ve.A)(e),o=t.getMonth();return t.setFullYear(t.getFullYear(),o+1,0),t.setHours(23,59,59,999),t}function Je(e){(0,Te.A)(1,arguments);var t=(0,Ve.A)(e);return function(e){(0,Te.A)(1,arguments);var t=(0,Ve.A)(e);return t.setHours(23,59,59,999),t}(t).getTime()===Ye(t).getTime()}function Xe(e,t){(0,Te.A)(2,arguments);var o,n=(0,Ve.A)(e),r=(0,Ve.A)(t),i=Ke(n,r),a=Math.abs(function(e,t){(0,Te.A)(2,arguments);var o=(0,Ve.A)(e),n=(0,Ve.A)(t);return 12*(o.getFullYear()-n.getFullYear())+(o.getMonth()-n.getMonth())}(n,r));if(a<1)o=0;else{1===n.getMonth()&&n.getDate()>27&&n.setDate(30),n.setMonth(n.getMonth()-i*a);var s=Ke(n,r)===-i;Je((0,Ve.A)(e))&&1===a&&1===Ke(e,r)&&(s=!1),o=i*(a-Number(s))}return 0===o?0:o}function Qe(e,t){(0,Te.A)(2,arguments);var o=(0,Ve.A)(e),n=(0,Ve.A)(t),r=Ke(o,n),i=Math.abs(function(e,t){(0,Te.A)(2,arguments);var o=(0,Ve.A)(e),n=(0,Ve.A)(t);return o.getFullYear()-n.getFullYear()}(o,n));o.setFullYear(1584),n.setFullYear(1584);var a=Ke(o,n)===-r,s=r*(i-Number(a));return 0===s?0:s}function Ze(e,t){(0,Te.A)(2,arguments);var o=Ue(e),n=Ue(t);return o.getTime()===n.getTime()}function et(e,t){(0,Te.A)(2,arguments);var o=(0,Ve.A)(e),n=(0,De.A)(t);return isNaN(n)?new Date(NaN):n?(o.setDate(o.getDate()+n),o):o}var tt=o(2963),ot=o.n(tt),nt=o(3768);const rt=P.Ay.div`
  padding: 1.5rem;
`,it=P.Ay.h2`
  font-size: 1.25rem;
  font-weight: 600;
  color: #1f2937;
  margin-bottom: 1.5rem;
`,at=P.Ay.div`
  margin-bottom: 1rem;
`,st=P.Ay.label`
  display: block;
  font-size: 0.875rem;
  font-weight: 500;
  color: #4b5563;
  margin-bottom: 0.5rem;
`,lt=P.Ay.input`
  width: 100%;
  padding: 0.5rem;
  border: 1px solid #d1d5db;
  border-radius: 0.375rem;
  font-size: 0.875rem;
  
  &:focus {
    outline: none;
    border-color: #3b82f6;
    box-shadow: 0 0 0 2px rgba(59, 130, 246, 0.25);
  }
`,ct=P.Ay.div`
  display: flex;
  justify-content: flex-end;
  gap: 0.75rem;
  margin-top: 1.5rem;
`,dt=P.Ay.button`
  padding: 0.5rem 1rem;
  border-radius: 0.375rem;
  font-size: 0.875rem;
  font-weight: 500;
  cursor: pointer;
  transition: all 0.2s;
  
  &.primary {
    background-color: #3b82f6;
    color: white;
    border: none;
    
    &:hover {
      background-color: #2563eb;
    }
  }
  
  &.secondary {
    background-color: white;
    color: #4b5563;
    border: 1px solid #d1d5db;
    
    &:hover {
      background-color: #f9fafb;
    }
  }
`,ut=e=>{let{contact:o,onSave:n,onClose:r}=e;const[i,a]=(0,t.useState)({first_name:o.first_name||"",last_name:o.last_name||""}),s=e=>{const{name:t,value:o}=e.target;a((e=>({...e,[t]:o})))};return(0,N.jsxs)(rt,{children:[(0,N.jsx)(it,{children:"Edit Contact Name"}),(0,N.jsxs)("form",{onSubmit:e=>{e.preventDefault(),n({...o,...i}),r()},children:[(0,N.jsxs)(at,{children:[(0,N.jsx)(st,{htmlFor:"first_name",children:"First Name"}),(0,N.jsx)(lt,{type:"text",id:"first_name",name:"first_name",value:i.first_name,onChange:s,placeholder:"Enter first name"})]}),(0,N.jsxs)(at,{children:[(0,N.jsx)(st,{htmlFor:"last_name",children:"Last Name"}),(0,N.jsx)(lt,{type:"text",id:"last_name",name:"last_name",value:i.last_name,onChange:s,placeholder:"Enter last name"})]}),(0,N.jsxs)(ct,{children:[(0,N.jsx)(dt,{type:"button",className:"secondary",onClick:r,children:"Cancel"}),(0,N.jsx)(dt,{type:"submit",className:"primary",children:"Save Changes"})]})]})]})};P.Ay.div`
  padding: 1.5rem;
`,P.Ay.h2`
  font-size: 1.25rem;
  font-weight: 600;
  color: #1f2937;
  margin-bottom: 1.5rem;
`,P.Ay.div`
  margin-bottom: 1rem;
`,P.Ay.label`
  display: block;
  font-size: 0.875rem;
  font-weight: 500;
  color: #4b5563;
  margin-bottom: 0.5rem;
`,P.Ay.select`
  width: 100%;
  padding: 0.5rem;
  border: 1px solid #d1d5db;
  border-radius: 0.375rem;
  font-size: 0.875rem;
  background-color: white;
  
  &:focus {
    outline: none;
    border-color: #3b82f6;
    box-shadow: 0 0 0 2px rgba(59, 130, 246, 0.25);
  }
`,P.Ay.div`
  display: flex;
  justify-content: flex-end;
  gap: 0.75rem;
  margin-top: 1.5rem;
`,P.Ay.button`
  padding: 0.5rem 1rem;
  border-radius: 0.375rem;
  font-size: 0.875rem;
  font-weight: 500;
  cursor: pointer;
  transition: all 0.2s;
  
  &.primary {
    background-color: #3b82f6;
    color: white;
    border: none;
    
    &:hover {
      background-color: #2563eb;
    }
  }
  
  &.secondary {
    background-color: white;
    color: #4b5563;
    border: 1px solid #d1d5db;
    
    &:hover {
      background-color: #f9fafb;
    }
  }
`;var pt=o(478);const ht=P.Ay.div`
  display: flex;
  justify-content: space-between;
  align-items: center;
  margin-bottom: 15px;
  padding-bottom: 15px;
  border-bottom: 1px solid #e5e7eb;

  h2 {
    margin: 0;
    font-size: 1.25rem;
    color: #111827;
    font-weight: 600;
  }
`,ft=P.Ay.div`
  display: flex;
  gap: 2px;
  margin-bottom: 24px;
  border-bottom: 1px solid #e5e7eb;
`,gt=P.Ay.button`
  padding: 12px 20px;
  background: none;
  border: none;
  border-bottom: 2px solid ${e=>e.active?"#000000":"transparent"};
  color: ${e=>e.active?"#000000":"#6b7280"};
  font-weight: ${e=>e.active?"600":"500"};
  font-size: 0.938rem;
  cursor: pointer;
  transition: all 0.2s;
  
  &:hover {
    color: ${e=>e.active?"#000000":"#1f2937"};
  }
`,mt=P.Ay.div`
  margin-bottom: 15px;
`,yt=P.Ay.label`
  display: block;
  margin-bottom: 5px;
  font-size: 0.875rem;
  font-weight: 500;
  color: #4b5563;
`,vt=P.Ay.div`
  background-color: #f3f4f6;
  padding: 8px;
  border-radius: 4px;
  font-size: 0.875rem;
  margin-bottom: 8px;
`,bt=P.Ay.select`
  width: 100%;
  height: 40px;
  box-sizing: border-box;
  padding: 8px 12px;
  border: 1px solid #d1d5db;
  border-radius: 4px;
  font-size: 0.875rem;
  color: #111827;
  background-color: #fff;
  transition: border-color 0.2s, box-shadow 0.2s;
  cursor: pointer;
  line-height: 24px;
  
  &:focus {
    outline: none;
    border-color: #000000;
    box-shadow: 0 0 0 2px rgba(0, 0, 0, 0.15);
  }
`,xt=P.Ay.input`
  width: 100%;
  height: 40px;
  padding: 8px 12px;
  border: 1px solid #d1d5db;
  border-radius: 4px;
  font-size: 0.875rem;
  color: #111827;
  background-color: #fff;
  transition: border-color 0.2s, box-shadow 0.2s;
  
  &:focus {
    outline: none;
    border-color: #000000;
    box-shadow: 0 0 0 2px rgba(0, 0, 0, 0.15);
  }
`,wt=P.Ay.div`
  display: flex;
  justify-content: flex-end;
  gap: 10px;
  margin-top: 20px;
`,Ct=P.Ay.button`
  padding: 8px 16px;
  border-radius: 4px;
  font-size: 0.875rem;
  font-weight: 500;
  cursor: pointer;
  transition: all 0.2s;
  background-color: #000000;
  color: white;
  border: none;
  
  &:hover {
    background-color: #333333;
  }
  
  &:disabled {
    opacity: 0.5;
    cursor: not-allowed;
  }
`,_t=P.Ay.p`
  color: #ef4444;
  font-size: 0.875rem;
  margin-top: 8px;
`,St=P.Ay.p`
  font-size: 0.75rem;
  color: #6b7280;
`,Et=e=>{let{isOpen:o,onRequestClose:n,contact:r}=e;const[i,a]=(0,t.useState)("Frequency"),[s,l]=(0,t.useState)(r.keep_in_touch_frequency||""),[c,d]=(0,t.useState)(r.birthday_date||""),[u,p]=(0,t.useState)(r.birthday_wishes||"No wishes"),[h,f]=(0,t.useState)(r.christmas_wishes||"No wishes"),[g,m]=(0,t.useState)(r.easter_wishes||"No wishes"),[y,v]=(0,t.useState)(!1),[b,x]=(0,t.useState)(""),[w,C]=(0,t.useState)("N/A");(0,t.useEffect)((()=>{l(r.keep_in_touch_frequency||""),d(r.birthday_date||""),p(r.birthday_wishes||"No wishes"),f(r.christmas_wishes||"No wishes"),m(r.easter_wishes||"No wishes"),_(r.keep_in_touch_frequency)}),[r]);const _=e=>{const t=new Date;let o="N/A";switch(e){case"Weekly":o=new Date(t.setDate(t.getDate()+7));break;case"Monthly":o=new Date(t.setMonth(t.getMonth()+1));break;case"Quarterly":o=new Date(t.setMonth(t.getMonth()+3));break;case"Twice per Year":o=new Date(t.setMonth(t.getMonth()+6));break;case"Once per Year":o=new Date(t.setFullYear(t.getFullYear()+1));break;default:o="N/A"}C("N/A"!==o?o.toLocaleDateString():"N/A")};return(0,N.jsx)(ot(),{isOpen:o,onRequestClose:n,style:{content:{top:"50%",left:"50%",right:"auto",bottom:"auto",marginRight:"-50%",transform:"translate(-50%, -50%)",padding:"20px",border:"none",borderRadius:"0.5rem",boxShadow:"0 4px 6px rgba(0, 0, 0, 0.1)",maxWidth:"500px",width:"90%",minHeight:"490px"},overlay:{backgroundColor:"rgba(0, 0, 0, 0.5)",zIndex:1e3}},children:(0,N.jsxs)("div",{style:{padding:"1rem"},children:[(0,N.jsxs)(ht,{children:[(0,N.jsx)("h2",{children:"Keep In Touch Settings"}),(0,N.jsx)("button",{onClick:n,"aria-label":"Close modal",children:(0,N.jsx)(B.yGN,{size:20})})]}),(0,N.jsxs)(ft,{children:[(0,N.jsx)(gt,{active:"Frequency"===i,onClick:()=>a("Frequency"),children:"Frequency"}),(0,N.jsx)(gt,{active:"Wishes"===i,onClick:()=>a("Wishes"),children:"Wishes"})]}),(0,N.jsxs)("div",{style:{height:"340px"},children:[" ","Frequency"===i&&(0,N.jsxs)("div",{style:{height:"340px"},children:[(0,N.jsxs)(mt,{children:[(0,N.jsx)(yt,{children:"Current Keep in Touch Frequency"}),(0,N.jsx)(vt,{children:r.keep_in_touch_frequency||"Not set"})]}),(0,N.jsxs)(mt,{children:[(0,N.jsx)(yt,{children:"Select New Keep in Touch Frequency"}),(0,N.jsxs)(bt,{"aria-label":"Keep in Touch frequency dropdown",value:s,onChange:e=>{l(e.target.value),x(""),_(e.target.value)},children:[(0,N.jsx)("option",{value:"",children:"Choose a frequency"}),(0,N.jsx)("option",{value:"Do not keep in touch",children:"Do not keep in touch"}),(0,N.jsx)("option",{value:"Weekly",children:"Weekly"}),(0,N.jsx)("option",{value:"Monthly",children:"Monthly"}),(0,N.jsx)("option",{value:"Quarterly",children:"Quarterly"}),(0,N.jsx)("option",{value:"Twice per Year",children:"Twice per Year"}),(0,N.jsx)("option",{value:"Once per Year",children:"Once per Year"})]})]}),(0,N.jsxs)(St,{children:["Next follow-up: ",w]})]}),"Wishes"===i&&(0,N.jsxs)("div",{style:{height:"340px",overflowY:"auto"},children:[(0,N.jsxs)(mt,{children:[(0,N.jsxs)(yt,{children:["Birthday date: ",r.birthday||"-",r.birthday&&(0,N.jsx)("button",{onClick:async()=>{v(!0);const{error:e}=await D.supabase.from("contacts").update({birthday:null}).eq("id",r.id);if(e)x("Error resetting birthday date");else{const{data:e,error:t}=await D.supabase.from("contacts").select("birthday").eq("id",r.id).single();t?x("Error fetching updated birthday"):(d(e.birthday),nt.Ay.success("Birthday date reset successfully"))}v(!1)},style:{marginLeft:"10px",backgroundColor:"#dc3545",color:"#fff",padding:"5px 10px",borderRadius:"4px",border:"none",cursor:"pointer"},children:"Reset Birthday"})]}),(0,N.jsx)(xt,{type:"text","aria-label":"Birthday date input",value:c||"",onChange:e=>d(e.target.value),placeholder:"YYYY-MM-DD",style:{height:"30px",width:"95%"}})]}),(0,N.jsxs)(mt,{children:[(0,N.jsx)(yt,{children:(0,N.jsxs)("span",{style:{display:"flex",alignItems:"center",gap:"5px"},children:[(0,N.jsx)("span",{role:"img","aria-label":"cake",children:"\ud83c\udf82"})," Birthday Wishes"]})}),(0,N.jsxs)(bt,{"aria-label":"Birthday wishes dropdown",value:u,onChange:e=>p(e.target.value),children:[(0,N.jsx)("option",{value:"No wishes",children:"No wishes"}),(0,N.jsx)("option",{value:"LinkedIn message",children:"LinkedIn message"}),(0,N.jsx)("option",{value:"Email message",children:"Email message"}),(0,N.jsx)("option",{value:"WhatsApp message",children:"WhatsApp message"}),(0,N.jsx)("option",{value:"Call",children:"Call"}),(0,N.jsx)("option",{value:"Send a present/card",children:"Send a present/card"})]})]}),(0,N.jsxs)(mt,{children:[(0,N.jsx)(yt,{children:(0,N.jsxs)("span",{style:{display:"flex",alignItems:"center",gap:"5px"},children:[(0,N.jsx)("span",{role:"img","aria-label":"santa",children:"\ud83c\udf85"})," Christmas Wishes"]})}),(0,N.jsxs)(bt,{"aria-label":"Christmas wishes dropdown",value:h,onChange:e=>f(e.target.value),children:[(0,N.jsx)("option",{value:"No wishes",children:"No wishes"}),(0,N.jsx)("option",{value:"LinkedIn message",children:"LinkedIn message"}),(0,N.jsx)("option",{value:"Email message",children:"Email message"}),(0,N.jsx)("option",{value:"WhatsApp message",children:"WhatsApp message"}),(0,N.jsx)("option",{value:"Call",children:"Call"}),(0,N.jsx)("option",{value:"Send a present/card",children:"Send a present/card"})]})]}),(0,N.jsxs)(mt,{children:[(0,N.jsx)(yt,{children:(0,N.jsxs)("span",{style:{display:"flex",alignItems:"center",gap:"5px"},children:[(0,N.jsx)("span",{role:"img","aria-label":"chick",children:"\ud83d\udc23"})," Easter Wishes"]})}),(0,N.jsxs)(bt,{"aria-label":"Easter wishes dropdown",value:g,onChange:e=>m(e.target.value),children:[(0,N.jsx)("option",{value:"No wishes",children:"No wishes"}),(0,N.jsx)("option",{value:"LinkedIn message",children:"LinkedIn message"}),(0,N.jsx)("option",{value:"Email message",children:"Email message"}),(0,N.jsx)("option",{value:"WhatsApp message",children:"WhatsApp message"}),(0,N.jsx)("option",{value:"Call",children:"Call"}),(0,N.jsx)("option",{value:"Send a present/card",children:"Send a present/card"})]})]})]})]})," ",b&&(0,N.jsx)(_t,{children:b}),(0,N.jsx)(wt,{children:(0,N.jsx)(Ct,{onClick:async()=>{if(s||"No wishes"!==h||"No wishes"!==g||"No wishes"!==u&&u)if("No wishes"===u||c){v(!0);try{const e={keep_in_touch_frequency:s,birthday_wishes:u,christmas_wishes:h,easter_wishes:g};"No wishes"!==u&&c&&(e.birthday=c);const{error:t}=await D.supabase.from("contacts").update(e).eq("id",r.id);if(t)throw t;nt.Ay.success("Keep in touch settings updated!"),setTimeout((()=>{n()}),800)}catch(e){console.error("Supabase update error:",e),x("Error updating data"),nt.Ay.error("Failed to update settings")}finally{v(!1)}}else x("Please enter a birthday date if you select birthday wishes");else x("Please enter at least one wish or frequency")},disabled:y,children:"Save"})}),y&&(0,N.jsx)("div",{style:{textAlign:"center",marginTop:"10px"},children:(0,N.jsx)("div",{className:"spinner",style:{width:"20px",height:"20px",border:"3px solid #f3f3f3",borderTop:"3px solid #000000",borderRadius:"50%",animation:"spin 1s linear infinite"}})})]})})},kt=document.createElement("style");kt.innerHTML="\n  @keyframes spin {\n    0% { transform: rotate(0deg); }\n    100% { transform: rotate(360deg); }\n  }\n",document.head.appendChild(kt);const jt=P.Ay.div`
  display: flex;
  justify-content: space-between;
  align-items: center;
  margin-bottom: 15px;
  padding-bottom: 15px;
  border-bottom: 1px solid #e5e7eb;

  h2 {
    margin: 0;
    font-size: 1.25rem;
    color: #111827;
    font-weight: 600;
  }

  button {
    background: none;
    border: none;
    cursor: pointer;
    color: #6b7280;
    padding: 4px;
    border-radius: 4px;
    
    &:hover {
      color: #1f2937;
      background-color: #f3f4f6;
    }
  }
`,At=(P.Ay.div`
  display: flex;
  gap: 2px;
  margin-bottom: 24px;
  border-bottom: 1px solid #e5e7eb;
`,P.Ay.div`
  margin-bottom: 15px;
`),Rt=P.Ay.label`
  display: block;
  margin-bottom: 5px;
  font-size: 0.875rem;
  font-weight: 500;
  color: #4b5563;
`,Ot=P.Ay.div`
  background-color: #f3f4f6;
  padding: 8px;
  border-radius: 4px;
  font-size: 0.875rem;
  margin-bottom: 8px;
`,Tt=P.Ay.select`
  width: 100%;
  height: 40px;
  box-sizing: border-box;
  padding: 8px 12px;
  border: 1px solid #d1d5db;
  border-radius: 4px;
  font-size: 0.875rem;
  color: #111827;
  background-color: #fff;
  transition: border-color 0.2s, box-shadow 0.2s;
  cursor: pointer;
  line-height: 24px;
  
  &:focus {
    outline: none;
    border-color: #000000;
    box-shadow: 0 0 0 2px rgba(0, 0, 0, 0.15);
  }
`,Dt=(P.Ay.div`
  display: flex;
  align-items: center;
  gap: 8px;
`,P.Ay.div`
  display: flex;
  justify-content: flex-end;
  gap: 10px;
  margin-top: 20px;
`),Pt=P.Ay.button`
  padding: 8px 16px;
  border-radius: 4px;
  font-size: 0.875rem;
  font-weight: 500;
  cursor: pointer;
  transition: all 0.2s;
  background-color: #000000;
  color: white;
  border: none;
  
  &:hover {
    background-color: #333333;
  }
  
  &:disabled {
    opacity: 0.5;
    cursor: not-allowed;
  }
`,Nt=P.Ay.button`
  padding: 8px 16px;
  border-radius: 4px;
  font-size: 0.875rem;
  font-weight: 500;
  cursor: pointer;
  transition: all 0.2s;
  background-color: #ef4444;
  color: white;
  border: none;
  
  &:hover {
    background-color: #dc2626;
  }
  
  &:disabled {
    opacity: 0.5;
    cursor: not-allowed;
  }
`,It=P.Ay.p`
  color: #ef4444;
  font-size: 0.875rem;
  margin-top: 8px;
`,Mt=(P.Ay.p`
  color: #10b981;
  font-size: 0.875rem;
  margin-top: 8px;
`,e=>{switch(e){case"Professional Investor":return"\ud83d\udcb0 Investor";case"Friend and Family":return"\u2764\ufe0f Loved one";case"Client":return"\ud83e\udd1d Client";case"Colleague":return"\ud83d\udc65 Colleague";case"Prospect":return"\ud83c\udfaf Prospect";case"Advisor":return"\ud83e\udde0 Advisor";case"Team":return"\u26bd Team";case"Manager":return"\ud83d\udcbc Manager";case"Founder":return"\ud83d\udcbb Founder";case"Supplier":return"\ud83d\udce6 Supplier";case"Skip":return"\u274c Skip";case"Inbox":return"\ud83d\udcec Inbox";case"Other":return"\ud83d\udccc Other";case"Institution":return"\ud83c\udfdb\ufe0f Institution";case"Media":return"\ud83d\udcf0 Media";case"Student":return"\ud83c\udf93 Student";case"WhatsApp Group Contact":return"\ud83e\udd76 WhatsApp Group Contact";default:return`\u26aa ${e}`}}),Lt=e=>{let{isOpen:o,onRequestClose:n,contact:r}=e;const[i,a]=(0,t.useState)((null===r||void 0===r?void 0:r.contact_category)||""),[s,l]=(0,t.useState)(!1),[c,d]=(0,t.useState)({type:"",text:""});(0,t.useEffect)((()=>{a((null===r||void 0===r?void 0:r.contact_category)||"")}),[r]);return(0,N.jsx)(ot(),{isOpen:o,onRequestClose:n,style:{content:{top:"50%",left:"50%",right:"auto",bottom:"auto",marginRight:"-50%",transform:"translate(-50%, -50%)",padding:"20px",border:"none",borderRadius:"0.5rem",boxShadow:"0 4px 6px rgba(0, 0, 0, 0.1)",maxWidth:"500px",width:"90%",minHeight:"450px"},overlay:{backgroundColor:"rgba(0, 0, 0, 0.5)",zIndex:1e3}},children:(0,N.jsxs)("div",{style:{padding:"1rem"},children:[(0,N.jsxs)(jt,{children:[(0,N.jsx)("h2",{children:"Contact Category"}),(0,N.jsx)("button",{onClick:n,"aria-label":"Close modal",children:(0,N.jsx)(B.yGN,{size:20})})]}),(0,N.jsxs)(At,{children:[(0,N.jsx)(Rt,{children:"Current Category"}),(0,N.jsx)(Ot,{children:null!==r&&void 0!==r&&r.contact_category?Mt(r.contact_category):"Not set"})]}),(0,N.jsxs)(At,{children:[(0,N.jsx)(Rt,{htmlFor:"category",children:"Select New Category"}),(0,N.jsxs)(Tt,{id:"category",value:i,onChange:e=>{a(e.target.value),d({type:"",text:""})},children:[(0,N.jsx)("option",{value:"",children:"Select a category..."}),(0,N.jsx)("option",{value:"Founder",children:"\ud83d\udcbb Founder"}),(0,N.jsx)("option",{value:"Professional Investor",children:"\ud83d\udcb0 Investor"}),(0,N.jsx)("option",{value:"Advisor",children:"\ud83e\udde0 Advisor"}),(0,N.jsx)("option",{value:"Team",children:"\u26bd Team"}),(0,N.jsx)("option",{value:"Friend and Family",children:"\u2764\ufe0f Loved one"}),(0,N.jsx)("option",{value:"Manager",children:"\ud83d\udcbc Manager"}),(0,N.jsx)("option",{value:"Institution",children:"\ud83c\udfdb\ufe0f Institution"}),(0,N.jsx)("option",{value:"Media",children:"\ud83d\udcf0 Media"}),(0,N.jsx)("option",{value:"Student",children:"\ud83c\udf93 Student"}),(0,N.jsx)("option",{value:"Supplier",children:"\ud83d\udce6 Supplier"}),(0,N.jsx)("option",{value:"Inbox",children:"\ud83d\udcec Inbox"}),(0,N.jsx)("option",{value:"WhatsApp Group Contact",children:"\ud83e\udd76 WhatsApp Group Contact"})]})]}),(0,N.jsxs)(Dt,{children:[(0,N.jsx)(Nt,{onClick:async()=>{l(!0);try{const{error:e}=await D.supabase.from("contacts").update({contact_category:"Skip"}).eq("id",r.id);if(e)throw e;nt.Ay.success("Contact marked as Skip!"),setTimeout((()=>{n()}),1e3)}catch(e){console.error("Error marking contact as Skip:",e),nt.Ay.error("Failed to mark contact as Skip"),d({type:"error",text:"Failed to mark contact as Skip"})}finally{l(!1)}},disabled:s,children:"Skip"}),(0,N.jsx)(Pt,{onClick:async()=>{if(i){l(!0);try{const{error:e}=await D.supabase.from("contacts").update({contact_category:i}).eq("id",r.id);if(e)throw e;nt.Ay.success("Category updated successfully!"),setTimeout((()=>{n()}),1e3)}catch(e){console.error("Error updating category:",e),nt.Ay.error("Failed to update category"),d({type:"error",text:"Failed to update category"})}finally{l(!1)}}else d({type:"error",text:"Please select a category"})},disabled:s,children:"Save Changes"})]}),c.text&&"error"===c.type&&(0,N.jsx)(It,{children:c.text}),s&&(0,N.jsx)("div",{style:{textAlign:"center",marginTop:"10px"},children:(0,N.jsx)("div",{className:"spinner",style:{width:"20px",height:"20px",border:"3px solid #f3f3f3",borderTop:"3px solid #000000",borderRadius:"50%",animation:"spin 1s linear infinite"}})})]})})},Ft=document.createElement("style");Ft.innerHTML="\n  @keyframes spin {\n    0% { transform: rotate(0deg); }\n    100% { transform: rotate(360deg); }\n  }\n",document.head.appendChild(Ft);var Gt=o(2285);const zt=P.Ay.div`
  display: flex;
  flex-direction: column;
  height: 100%;
  overflow: hidden;
`,Ht=P.Ay.div`
  display: flex;
  justify-content: space-between;
  align-items: flex-start;
  margin-bottom: 24px;
  padding-bottom: 16px;
  border-bottom: 1px solid #e5e7eb;

  .header-left {
    h2 {
      margin: 0;
      font-size: 1.25rem;
      color: #000000;
      font-weight: 600;
    }
  }

  .header-right {
    display: flex;
    align-items: center;
    gap: 10px;
    
    button {
      background: none;
      border: none;
      cursor: pointer;
      color: #4b5563;
      padding: 8px;
      border-radius: 4px;
      display: flex;
      align-items: center;
      justify-content: center;
      
      &:hover {
        color: #000000;
        background-color: #f3f4f6;
      }
    }
  }
`,Bt=P.Ay.div`
  display: flex;
  gap: 2px;
  margin-bottom: 24px;
`,Vt=P.Ay.button`
  background-color: transparent;
  color: ${e=>e.active?"#000000":"#6b7280"};
  padding: 12px 20px;
  border: none;
  border-bottom: 2px solid ${e=>e.active?"#000000":"transparent"};
  cursor: pointer;
  font-weight: ${e=>e.active?"600":"500"};
  transition: all 0.2s ease;

  &:hover {
    color: #000000;
    border-bottom-color: ${e=>e.active?"#000000":"#d1d5db"};
  }
`,$t=P.Ay.div`
  margin-bottom: 24px;
`,Ut=(P.Ay.div`
  display: flex;
  flex-direction: column;
  gap: 20px;
  padding: 24px;
  background-color: #f9fafb;
  border-radius: 8px;
  border: 1px solid #e5e7eb;
`,P.Ay.h3`
  margin: 0 0 16px 0;
  font-size: 1.1rem;
  color: #111827;
  font-weight: 600;
`,P.Ay.div`
  display: grid;
  grid-template-columns: repeat(3, 1fr);
  gap: 16px;
`,P.Ay.button`
  padding: 16px;
  background-color: white;
  border: 1px solid #e5e7eb;
  border-radius: 8px;
  cursor: pointer;
  display: flex;
  flex-direction: column;
  align-items: center;
  justify-content: center;
  transition: all 0.2s;
  
  &:hover {
    border-color: #000000;
    background-color: #f3f4f6;
  }
  
  .button-icon {
    font-size: 24px;
    margin-bottom: 8px;
    color: #4b5563;
  }
  
  .button-text {
    font-size: 1rem;
    font-weight: 500;
    color: #111827;
  }
  
  .button-subtext {
    font-size: 0.75rem;
    color: #6b7280;
    margin-top: 4px;
  }
`,P.Ay.div`
  flex: 1;
  overflow: hidden;
  display: flex;
  flex-direction: column;
  max-height: calc(100% - 110px); // Accounting for header and tabs
`),Wt=P.Ay.div`
  background-color: #f9fafb;
  padding: 16px;
  border-radius: 8px;
  margin-bottom: 24px;
  height: 400px;
  overflow-y: auto;
  border: 1px solid #e5e7eb;
  
  &::-webkit-scrollbar {
    width: 6px;
  }
  
  &::-webkit-scrollbar-track {
    background: #f1f1f1;
  }
  
  &::-webkit-scrollbar-thumb {
    background: #888;
    border-radius: 3px;
  }
  
  &::-webkit-scrollbar-thumb:hover {
    background: #555;
  }
`,qt=P.Ay.div`
  background-color: #ffffff;
  padding: 16px;
  border-radius: 8px;
  margin-bottom: 12px;
  border: 1px solid #e5e7eb;
  box-shadow: 0 1px 2px rgba(0, 0, 0, 0.05);

  &:last-child {
    margin-bottom: 0;
  }

  .date {
    font-size: 0.875rem;
    color: #6b7280;
    margin-bottom: 8px;
  }

  .content {
    color: #111827;
    font-size: 0.9375rem;
  }

  .type {
    font-size: 0.75rem;
    color: #ffffff;
    background-color: #000000;
    padding: 3px 8px;
    border-radius: 12px;
    display: inline-block;
    margin-bottom: 8px;
    font-weight: 500;
  }
`,Kt=P.Ay.div`
  text-align: center;
  padding: 32px;
  color: #6b7280;
  font-style: italic;
  height: 400px;
  display: flex;
  flex-direction: column;
  justify-content: center;
  align-items: center;
  background-color: #f9fafb;
  border-radius: 8px;
  border: 1px solid #e5e7eb;
`,Yt=P.Ay.table`
  width: 100%;
  border-collapse: separate;
  border-spacing: 0;
  background-color: #ffffff;
  border-radius: 8px;
  overflow: hidden;
  border: 1px solid #e5e7eb;
  box-shadow: 0 1px 3px rgba(0, 0, 0, 0.05);
`,Jt=P.Ay.thead`
  background-color: #f9fafb;
  
  th {
    padding: 14px 16px;
    text-align: left;
    font-weight: 600;
    font-size: 0.875rem;
    color: #111827;
    border-bottom: 1px solid #e5e7eb;
    
    &.centered {
      text-align: center;
    }
  }
`,Xt=P.Ay.tbody`
  tr {
    &:hover {
      background-color: #f3f4f6;
    }
    
    &:not(:last-child) {
      border-bottom: 1px solid #e5e7eb;
    }
  }
  
  td {
    padding: 14px 16px;
    font-size: 0.875rem;
    color: #1f2937;
    vertical-align: middle;
    
    &.centered {
      text-align: center;
    }

    &.tag-cell {
      text-align: center;
      > div {
        display: inline-flex;
        margin: 0 auto;
      }
    }
  }
`,Qt=P.Ay.div`
  display: flex;
  justify-content: space-between;
  align-items: center;
  margin-top: 16px;
  padding: 12px 0;
`,Zt=P.Ay.span`
  font-size: 0.875rem;
  color: #6b7280;
`,eo=P.Ay.button`
  padding: 8px 16px;
  border: 1px solid #e5e7eb;
  border-radius: 6px;
  background-color: #ffffff;
  font-size: 0.875rem;
  color: #111827;
  cursor: pointer;
  transition: all 0.2s ease;
  
  &:hover:not(:disabled) {
    background-color: #f3f4f6;
    border-color: #d1d5db;
  }
  
  &:disabled {
    cursor: not-allowed;
    opacity: 0.5;
    color: #9ca3af;
  }
  
  margin: 0 4px;
`,to=P.Ay.div`
  display: inline-flex;
  align-items: center;
  padding: 4px 10px;
  background-color: ${e=>e.color||"#f3f4f6"};
  color: ${e=>e.textColor||"#111827"};
  border-radius: 16px;
  font-size: 0.75rem;
  font-weight: 500;
  gap: 6px;
  max-width: 200px;

  span {
    white-space: nowrap;
    overflow: hidden;
    text-overflow: ellipsis;
    max-width: 150px;
  }
`,oo=(0,P.Ay)(to)`
  background-color: ${e=>"Received"===e.direction?"#f3f4f6":"#4b5563"};
  color: ${e=>"Received"===e.direction?"#111827":"#ffffff"};
`,no=P.Ay.button`
  font-size: 0.8125rem;
  padding: 8px 12px;
  background: #000000;
  color: #ffffff;
  border: none;
  border-radius: 6px;
  cursor: pointer;
  display: inline-flex;
  align-items: center;
  justify-content: center;
  gap: 6px;
  font-weight: 500;
  transition: all 0.2s ease;
  
  &:hover {
    background: #1f2937;
  }
  
  /* Header button styles */
  .header-right & {
    width: 36px;
    height: 36px;
    padding: 0;
    border-radius: 6px;
  }
`,ro=P.Ay.div`
  font-size: 0.875rem;
  color: #6b7280;
  margin-bottom: 8px;
  text-align: right;
  padding-right: 8px;
`,io=e=>{let{isOpen:o,onRequestClose:n,contact:r}=e;const[i,a]=(0,t.useState)("Whatsapp"),[s,l]=(0,t.useState)([]),[c,d]=(0,t.useState)(!1),[u,p]=(0,t.useState)(1),[h,f]=(0,t.useState)(1),[g,m]=(0,t.useState)(0),[y,v]=(0,t.useState)(0),[b,x]=(0,t.useState)({}),[w,C]=(0,t.useState)([]),[_,S]=(0,t.useState)([]),E=15,k="whatsapp",j="emails",A="meetings",[R,O]=(0,t.useState)(!1),[T,I]=(0,t.useState)("original"),[M,L]=(0,t.useState)([]),[F,G]=(0,t.useState)(!1),z=e=>e?e.replace(/\D/g,""):null,H=async e=>{if(!e)return[];console.log("DEBUG: Analyzing mobile",e);const t=[e,e.replace(/\D/g,""),e.startsWith("+")?e.substring(1):e,e.startsWith("+")?e.substring(1):`+${e}`,e.startsWith("+")?e:`+${e}`,e.replace(/\D/g,"").slice(-10),e.replace(/\D/g,"").slice(-8)];console.log("DEBUG: Testing variations:",t);const o=[];for(const n of t){if(!n)continue;const{data:e}=await D.supabase.from(k).select("id, contact_mobile, message").eq("contact_mobile",n).limit(3);e&&e.length>0&&o.push({variant:n,type:"exact-match",count:e.length,examples:e.map((e=>e.contact_mobile))});const{data:t}=await D.supabase.from(k).select("id, contact_mobile, message").ilike("contact_mobile",`%${n.slice(-8)}%`).limit(3);t&&t.length>0&&o.push({variant:n,type:"contains-last-8",count:t.length,examples:t.map((e=>e.contact_mobile))})}return console.log("DEBUG: Mobile format matches:",o),o};(0,t.useEffect)((()=>{r&&(r.mobile||r.mobile2?a("Whatsapp"):r.email||r.email2||r.email3?a("Email"):a("Meeting"))}),[r]),(0,t.useEffect)((()=>{o&&r&&r.id&&"Meeting"===i&&X()}),[o,null===r||void 0===r?void 0:r.id,i]),(0,t.useEffect)((()=>{o&&r&&(console.log("Modal opened or data changed - fetching data"),r.lastFetchedId&&r.lastFetchedId===r.id||p(1),U())}),[o,r]),(0,t.useEffect)((()=>{o&&r&&u>0&&(console.log(`[PAGE-CHANGE] Changing to page ${u}`),d(!0),"Meeting"===i?X():(l([]),$(u)))}),[u]),(0,t.useEffect)((()=>{o&&r&&(console.log("Tab changed to",i,"- fetching new data"),p(1),"Meeting"===i?X():"WhatsappChat"===i?V():U())}),[i]);const V=async()=>{d(!0),console.log("FETCH WHATSAPP GROUP CHATS STARTED");try{if(!r||!r.id)return console.error("No contact data available"),d(!1),void L([]);console.log(`Fetching WhatsApp group chats for contact ID: ${r.id}`);const{data:e,error:t}=await D.supabase.from("contact_chats").select("chat_id").eq("contact_id",r.id);if(t)return console.error("Error fetching contact_chats:",t),d(!1),void L([]);if(!e||0===e.length)return console.log("No chats found for this contact"),d(!1),void L([]);const o=e.map((e=>e.chat_id));console.log(`Found ${o.length} chat IDs for this contact`);const{data:n,error:i}=await D.supabase.from("chats").select("*").in("id",o).eq("chat_type","group").order("last_message_at",{ascending:!1});if(i)return console.error("Error fetching group chats data:",i),d(!1),void L([]);console.log(`Fetched ${(null===n||void 0===n?void 0:n.length)||0} group chats`);const a=await Promise.all((n||[]).map((async e=>{const{data:t,error:o}=await D.supabase.from(k).select("*").eq("chat_id",e.id).order("created_at",{ascending:!1}).limit(20);return o?(console.error(`Error fetching messages for chat ${e.id}:`,o),{...e,messages:[]}):{...e,messages:t||[]}})));console.log(`Processed ${a.length} group chats with messages`),L(a),m(a.length),f(Math.max(Math.ceil(a.length/E),1))}catch(e){console.error("Error in fetchWhatsAppChats:",e),L([])}finally{d(!1),console.log("FETCH WHATSAPP GROUP CHATS COMPLETED")}},$=async e=>{console.log(`[LIMIT-OFFSET] Fetching page ${e}`);try{var t;const n=[];if(r.mobile&&n.push(z(r.mobile)),r.mobile2&&n.push(z(r.mobile2)),0===n.length)return console.log("No mobile numbers to search"),d(!1),void l([]);const i=E,a=(e-1)*E;console.log(`[LIMIT-OFFSET] Using limit=${i}, offset=${a} for page ${e}`);let s=D.supabase.from(k).select("*, chats:chat_id(chat_type)",{count:"exact"}).order("created_at",{ascending:!1}).in("contact_mobile",n).limit(i).offset(a);s=s.not("chats.chat_type","eq","group"),console.log("[LIMIT-OFFSET] Executing query...");let{data:c,count:u,error:p}=await s;if(p)throw console.error("[LIMIT-OFFSET] Error:",p),p;if(console.log("[LIMIT-OFFSET] Query results:",{success:!p,recordsFound:(null===(t=c)||void 0===t?void 0:t.length)||0,totalCount:u,page:e}),(!c||0===c.length)&&e>1){console.log(`[LIMIT-OFFSET] No data for page ${e}, trying alternative approach`);const t=D.supabase.from(k).select("*",{count:"exact"}).order("created_at",{ascending:!1}).in("contact_mobile",n),o=await t;if(o.error)console.error("Error fetching all data:",o.error);else if(o.data&&o.data.length>0){const t=o.data.length;console.log(`[LIMIT-OFFSET] Got ${t} total records, manual pagination`);const n=a,r=n+i,s=o.data.slice(n,r);s.length>0?(console.log(`[LIMIT-OFFSET] Manual pagination success: ${s.length} records for page ${e}`),c=s,u=o.data.length):console.log(`[LIMIT-OFFSET] Manual pagination: No data for page ${e}`)}}if(!c||0===c.length){console.log("[LIMIT-OFFSET] Trying flexible search");const t=n.filter((e=>e&&e.length>7)).map((e=>`contact_mobile.ilike.%${e.slice(-8)}`));if(t.length>0){const n=D.supabase.from(k).select("*, chats:chat_id(chat_type)",{count:"exact"}).order("created_at",{ascending:!1}).or(t.join(",")).not("chats.chat_type","eq","group").limit(i).offset(a);console.log("[LIMIT-OFFSET] Executing flexible query...");const r=await n;var o;if(r.error)console.error("[LIMIT-OFFSET] Flex error:",r.error);else if(c=r.data,u=r.count,console.log("[LIMIT-OFFSET] Flex results:",{recordsFound:(null===(o=c)||void 0===o?void 0:o.length)||0,totalCount:u,page:e}),(!c||0===c.length)&&e>1){console.log("[LIMIT-OFFSET] No flex data for page ${page}, trying manual flex pagination");const e=D.supabase.from(k).select("*",{count:"exact"}).order("created_at",{ascending:!1}).or(t.join(",")),o=await e;if(o.error)console.error("Error fetching all flex data:",o.error);else if(o.data&&o.data.length>0){const e=a,t=e+i,n=o.data.slice(e,t);n.length>0&&(console.log(`[LIMIT-OFFSET] Manual flex pagination success: ${n.length} records`),c=n,u=o.data.length)}}}}if(c&&c.length>0){const t=c.map(((t,o)=>({...t,_debugInfo:{page:e,index:o,position:a+o,queryType:"limit",timestamp:(new Date).toISOString()},debugId:`limit-p${e}-idx${o}-pos${a+o}`})));console.log(`[LIMIT-OFFSET] Setting ${t.length} records in state for page ${e}`),l(t),m(u||0),f(Math.max(Math.ceil((u||0)/E),1))}else console.log(`[LIMIT-OFFSET] No data found after all attempts for page ${e}`),l([])}catch(n){console.error("[LIMIT-OFFSET] Error:",n),l([])}finally{d(!1),console.log(`[LIMIT-OFFSET] Page ${e} fetch completed`)}},U=async()=>{if(d(!0),console.log("FETCH STARTED for initial load"),!r||!r.id)return console.error("No contact data available"),void d(!1);try{let e=[],t=0;if("Whatsapp"===i){console.log("Fetching WhatsApp data for contact:",r.id);const o=[];if(r.mobile&&o.push(z(r.mobile)),r.mobile2&&o.push(z(r.mobile2)),0===o.length)return console.log("No mobile numbers found for contact"),l([]),m(0),f(1),void d(!1);console.log("Mobile numbers to search:",o);const n=0,i=14;console.log("DEBUG: WhatsApp Filtering - Mobile numbers:",o);const a=D.supabase.from(k).select("*, chats:chat_id(chat_type)",{count:"exact"}).in("contact_mobile",o).not("chats.chat_type","eq","group");"function"===typeof a.toSQL&&console.log("DEBUG: Original query SQL:",a.toSQL());D.supabase.from(k).select("*",{count:"exact"}).in("contact_mobile",o).then((e=>{let{data:t,count:o}=e;console.log(`DEBUG: Simple query found ${o||0} messages`),t&&t.length>0&&console.log("DEBUG: Sample record:",t[0])})),console.log("DEBUG: Raw mobile numbers:",r.mobile,r.mobile2),console.log("DEBUG: Running direct table check..."),D.supabase.from(k).select("*",{count:"exact",head:!0}).then((e=>{let{count:t,error:o}=e;console.log(`DEBUG: Table ${k} has ${t||0} total records. Error:`,o)}));const s=[];r.mobile&&s.push(r.mobile),r.mobile2&&s.push(r.mobile2),console.log("DEBUG: Raw mobile formats:",s);const c=s.filter((e=>e&&e.length>4)).map((e=>e.slice(-4)));c.length>0&&(console.log("DEBUG: Checking by last 4 digits:",c),c.forEach((e=>{D.supabase.from(k).select("*").ilike("contact_mobile",`%${e}`).limit(5).then((t=>{let{data:o,error:n}=t;console.log(`DEBUG: Last 4 digits check '${e}' found:`,o?`${o.length} records`:"none",n?`Error: ${n.message}`:""),o&&o.length>0&&console.log("DEBUG: Sample record with matching digits:",o[0])}))}))),console.log("DEBUG: Using most direct approach possible");const u=[];r.mobile&&u.push(r.mobile),r.mobile2&&u.push(r.mobile2),console.log("DEBUG: Raw mobile numbers:",u);const p=u.filter((e=>e&&e.length>4)).map((e=>`contact_mobile.ilike.%${e.slice(-8)}`));console.log("DEBUG: Using conditions:",p);let h=D.supabase.from(k).select("*, chats:chat_id(chat_type)",{count:"exact"}).order("created_at",{ascending:!1}).or(p.join(","));console.log("DEBUG: Will apply group filtering in JavaScript after query"),R&&"or-null-nongroup"===T?(h=h.or("chat_id.is.null,not.chats.chat_type.eq.group"),console.log("DEBUG: Using OR filter (NULL OR NOT GROUP)")):R&&"null-only"===T?(h=h.is("chat_id",null),console.log("DEBUG: Using NULL chat_id filter")):R&&"all-messages"===T?console.log("DEBUG: Showing ALL messages"):(h=h.not("chats.chat_type","eq","group"),console.log("DEBUG: Using original NOT GROUP filter")),h=h.range(n,i),"function"===typeof h.toSQL&&console.log("DEBUG: New query SQL:",h.toSQL()),console.log("Executing initial query...");const{data:g,error:y,count:v}=await h;if(console.log(`DEBUG: Query returned ${g?g.length:0} results out of ${v||0} total`),y&&console.error("DEBUG: Query error:",y),g&&g.length>0){console.log("DEBUG: First result:",g[0]);const e=g.filter((e=>e.chat_id)),t=g.filter((e=>!e.chat_id));console.log(`DEBUG: Results with chat_id: ${e.length}, without chat_id: ${t.length}`)}if(y)throw console.error("Query error:",y),y;console.log(`Query returned ${g?g.length:0} records out of ${v} total`),g&&g.length>0&&console.log("DEBUG: FILTERING CHECK - responseData before filtering:",g.map((e=>{var t,o;return{id:e.id,chatId:e.chat_id,chatType:null===(t=e.chats)||void 0===t?void 0:t.chat_type,isGroup:"group"===(null===(o=e.chats)||void 0===o?void 0:o.chat_type)}})));const b=(g||[]).filter((e=>{e.chat_id&&console.log(`DEBUG: Message ${e.id} has chat_id ${e.chat_id}`);const t=e.chat_id&&!e.chats,o=e.chats&&"group"===e.chats.chat_type;return!t&&!o}));console.log(`FILTERING: ${g?g.length-b.length:0} group messages removed`),console.log("DEBUG: Filtered data:",null===b||void 0===b?void 0:b.map((e=>{var t;return{id:e.id,chatId:e.chat_id,chatType:null===(t=e.chats)||void 0===t?void 0:t.chat_type}}))),e=b||[],t=b.length;const x=Math.max(Math.ceil(t/E),1);if(console.log(`Total pages: ${x} (${t} records / 15 per page)`),0===e.length&&o.length>0)return void await K(o,n,i,1)}console.log(`Final data: ${e.length} records, total: ${t}`),l(e),m(t),f(Math.max(Math.ceil(t/E),1))}catch(e){console.error("Error fetching data:",e),l([]),m(0),f(1)}finally{d(!1),console.log("INITIAL FETCH COMPLETED")}},W=e=>{if(!e)return"";return new Date(e).toLocaleDateString("en-GB",{day:"2-digit",month:"2-digit",year:"numeric"}).replace(/\//g,"-")},q=e=>{console.log(`[NAV] Requested page change from ${u} to ${e} (total: ${h})`),e>=1&&e<=h&&e!==u?(console.log(`[NAV] Changing to page ${e}`),d(!0),l([]),p(e)):console.log(`[NAV] Invalid page ${e} or already on this page`)},K=async(e,t,o,n)=>{try{console.log(`[FLEX ${n}] Starting flexible search for range ${t}-${o}`);const e=[];r.mobile&&e.push(r.mobile),r.mobile2&&e.push(r.mobile2),console.log(`[FLEX ${n}] Raw mobile numbers:`,e);const i=e.filter((e=>e&&e.length>4)).map((e=>`contact_mobile.ilike.%${e.slice(-8)}`));if(0===i.length)return console.log(`[FLEX ${n}] No valid conditions for flexible search`),void l([]);const a=D.supabase.from(k).select("*, chats:chat_id(chat_type)",{count:"exact"}).order("created_at",{ascending:!1}).or(i.join(",")).range(t,o);if(console.log(`[FLEX ${n}] Conditions:`,i),"function"===typeof a.toSQL){const e=a.toSQL();console.log(`[FLEX ${n}] SQL: ${e}`)}console.log(`[FLEX ${n}] Executing query...`);const{data:s,count:c,error:d}=await a;if(d)return console.error(`[FLEX ${n}] Error:`,d),void l([]);if(s&&s.length>0?(console.log(`[FLEX ${n}] Found ${s.length} records:`),s.forEach(((e,o)=>{var n;console.log(`Flex Record ${o}:`,{id:e.id,date:e.created_at,message:(null===(n=e.message)||void 0===n?void 0:n.substring(0,30))+"...",from:t+o})}))):console.log(`[FLEX ${n}] No records found with flexible search`),s&&s.length>0){const e=s.filter((e=>{e.chat_id&&console.log(`DEBUG FLEX: Message ${e.id} has chat_id ${e.chat_id}`);const t=e.chat_id&&!e.chats,o=e.chats&&"group"===e.chats.chat_type;return!t&&!o}));console.log(`[FLEX ${n}] Filtered out ${s.length-e.length} group messages in JavaScript`);const r=e.map(((e,r)=>({...e,_debugInfo:{page:n,index:r,position:t+r,queryType:"flexible",timestamp:(new Date).toISOString(),range:`${t}-${o}`},debugId:`flex${n}-idx${r}-pos${t+r}`})));console.log(`[FLEX ${n}] Setting ${r.length} filtered flex records in state`),l(r),m(e.length),f(Math.max(Math.ceil(e.length/E),1))}else console.log(`[FLEX ${n}] No data found, setting empty state`),l([])}catch(i){console.error(`[FLEX ${n}] Error:`,i),l([])}finally{console.log(`[FLEX ${n}] Flexible search completed`)}},Y=async e=>{console.log(`[EMERGENCY] FETCH FOR PAGE ${e} STARTED`);try{d(!0),l([]);const t=(e-1)*E,o=[];if(r.mobile&&o.push(z(r.mobile)),r.mobile2&&o.push(z(r.mobile2)),0===o.length)return console.log("[EMERGENCY] No mobile numbers!"),void d(!1);console.log("[EMERGENCY] Mobile numbers:",o),console.log("[EMERGENCY] Fetching ALL records...");const n=D.supabase.from(k).select("*, chats:chat_id(chat_type)").in("contact_mobile",o).or("chat_id.is.null,not.chats.chat_type.eq.group").order("created_at",{ascending:!1}),{data:i,error:a}=await n;if(a)return console.error("[EMERGENCY] Error fetching all records:",a),void await J(e,o);if(console.log(`[EMERGENCY] Total records found: ${(null===i||void 0===i?void 0:i.length)||0}`),i&&i.length>0){const n=i.filter((e=>{e.chat_id&&console.log(`[EMERGENCY] Message ${e.id} has chat_id ${e.chat_id}`);const t=e.chat_id&&!e.chats,o=e.chats&&"group"===e.chats.chat_type;return!t&&!o}));console.log(`[EMERGENCY] Filtered out ${i.length-n.length} potential group messages`);const r=n.slice(t,t+E);if(r.length>0){console.log(`[EMERGENCY] Found ${r.length} records for page ${e}`);const o=r.map(((o,n)=>({...o,_debugInfo:{queryType:"emergency",timestamp:(new Date).toISOString()},debugId:`emrg-p${e}-idx${n}-pos${t+n}`})));l(o),m(n.length),f(Math.max(Math.ceil(n.length/E),1))}else console.log(`[EMERGENCY] No records for page ${e} (out of bounds)`),await J(e,o)}else console.log("[EMERGENCY] No records found!"),await J(e,o)}catch(t){console.error("[EMERGENCY] Critical error:",t),l([])}finally{d(!1),console.log("[EMERGENCY] FETCH COMPLETED")}},J=async(e,t)=>{console.log("[EMERGENCY-FLEX] Last resort flexible search");try{const o=(e-1)*E,n=t.filter((e=>e&&e.length>7)).map((e=>`contact_mobile.ilike.%${e.slice(-8)}`));if(0===n.length)return void console.log("[EMERGENCY-FLEX] No valid conditions!");const r=D.supabase.from(k).select("*, chats:chat_id(chat_type)").or(n.join(",")).or("chat_id.is.null,not.chats.chat_type.eq.group").order("created_at",{ascending:!1}),{data:i,error:a}=await r;if(a)return void console.error("[EMERGENCY-FLEX] Error:",a);if(console.log(`[EMERGENCY-FLEX] Total flex matches: ${(null===i||void 0===i?void 0:i.length)||0}`),i&&i.length>0){const t=i.filter((e=>{e.chat_id&&console.log(`[EMERGENCY-FLEX] Message ${e.id} has chat_id ${e.chat_id}`);const t=e.chat_id&&!e.chats,o=e.chats&&"group"===e.chats.chat_type;return!t&&!o}));console.log(`[EMERGENCY-FLEX] Filtered out ${i.length-t.length} potential group messages`);const n=t.slice(o,o+E);if(n.length>0){console.log(`[EMERGENCY-FLEX] Found ${n.length} flex records for page ${e}`);const r=n.map(((t,n)=>({...t,_debugInfo:{queryType:"emergency-flex",timestamp:(new Date).toISOString()},debugId:`emflex-p${e}-idx${n}-pos${o+n}`})));l(r),m(t.length),f(Math.max(Math.ceil(t.length/E),1))}else console.log(`[EMERGENCY-FLEX] No flex records for page ${e} (out of bounds)`),l([])}else console.log("[EMERGENCY-FLEX] No flex records found at all!"),l([])}catch(o){console.error("[EMERGENCY-FLEX] Critical error:",o),l([])}},X=async()=>{d(!0),console.log("FETCH MEETINGS STARTED");try{if(!r||!r.id)return console.error("No contact data available for fetching meetings"),d(!1),void S([]);console.log(`Fetching meetings for contact ID: ${r.id}`);const{data:e,error:t}=await D.supabase.from("meetings_contacts").select("meeting_id").eq("contact_id",r.id);if(t)return console.error("Error fetching meetings_contacts:",t),d(!1),void S([]);if(!e||0===e.length)return console.log("No meetings found for this contact"),d(!1),void S([]);const o=e.map((e=>e.meeting_id));console.log(`Found ${o.length} meeting IDs for this contact`);const{data:n,error:i}=await D.supabase.from(A).select("*").in("id",o).order("meeting_date",{ascending:!1}).range((u-1)*E,u*E-1);if(i)return console.error("Error fetching meetings data:",i),d(!1),void S([]);const{count:a,error:s}=await D.supabase.from(A).select("*",{count:"exact",head:!0}).in("id",o);s&&console.error("Error counting meetings:",s),console.log(`Fetched ${(null===n||void 0===n?void 0:n.length)||0} meetings out of ${a||0} total`),S(n||[]),m(a||0),f(Math.max(Math.ceil((a||0)/E),1))}catch(e){console.error("Error in fetchMeetings:",e),S([])}finally{d(!1),console.log("FETCH MEETINGS COMPLETED")}},Q=async()=>{if(d(!0),console.log("FETCH EMAILS STARTED"),!r||!r.id)return console.error("No contact data available"),void d(!1);try{const e=[r.email,r.email2,r.email3].filter((e=>e&&""!==e.trim()));if(C(e),console.log("Contact ID:",r.id),console.log("Contact name:",r.first_name,r.last_name),console.log("All email addresses found:",e),0===e.length)return console.log("No email addresses found for contact"),d(!1),void l([]);console.log("Using simple query approach for emails...");let t=[];for(const r of e){console.log(`Fetching emails for: ${r}`);const e=D.supabase.from(j).select("*").or(`from_email.eq."${r}",to_email.eq."${r}"`).order("created_at",{ascending:!1}),{data:o,error:n}=await e;n?console.error(`Error fetching emails for ${r}:`,n):(console.log(`Found ${(null===o||void 0===o?void 0:o.length)||0} emails for ${r}`),o&&o.length>0&&(t=[...t,...o]))}const o=t.filter(((e,t,o)=>t===o.findIndex((t=>t.id===e.id))));o.sort(((e,t)=>new Date(t.created_at)-new Date(e.created_at))),console.log(`Total unique emails found: ${o.length}`);const n=E,i=(u-1)*E,a=o.slice(i,i+n);if(console.log(`Showing ${a.length} emails for page ${u}`),a.length>0){const e=a.map(((e,t)=>({...e,_debug:{queryType:"email-simple",timestamp:(new Date).toISOString()},debugId:`email-p${u}-idx${t}-pos${i+t}`})));l(e),m(o.length),f(Math.max(Math.ceil(o.length/E),1))}else l([]),u>1&&o.length>0&&(console.log("No emails for this page, returning to page 1"),p(1))}catch(e){console.error("Error in fetchEmails:",e),l([])}finally{d(!1),console.log("FETCH EMAILS COMPLETED")}};(0,t.useEffect)((()=>{o&&r&&"Email"===i&&u>0&&(console.log(`Fetching emails for page ${u}`),Q())}),[o,r,i,u]);return(0,N.jsx)(ot(),{isOpen:o,onRequestClose:n,style:{content:{top:"50%",left:"50%",right:"auto",bottom:"auto",marginRight:"-50%",transform:"translate(-50%, -50%)",padding:"24px",border:"none",borderRadius:"8px",boxShadow:"0 10px 25px rgba(0, 0, 0, 0.2)",maxWidth:"1250px",width:"90%",height:"auto",maxHeight:"80vh",backgroundColor:"#ffffff"},overlay:{backgroundColor:"rgba(0, 0, 0, 0.75)",zIndex:1e3}},children:(0,N.jsxs)(zt,{children:[(0,N.jsx)(Ht,{style:{flexDirection:"column",alignItems:"stretch"},children:(0,N.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",width:"100%"},children:[(0,N.jsx)("div",{className:"header-left",children:(0,N.jsx)("h2",{children:"Last Interactions"})}),(0,N.jsxs)("div",{className:"header-right",children:[(0,N.jsx)("button",{onClick:()=>O(!R),style:{padding:"4px 8px",background:R?"#ff5722":"#4a90e2",color:"white",border:"none",borderRadius:"4px",marginRight:"10px"},children:R?"Hide Debug":"Debug Mode"}),(0,N.jsx)(no,{onClick:()=>(null===r||void 0===r?void 0:r.mobile)&&(e=>{if(!e)return;const t=e.startsWith("+")?e.substring(1):e;window.open(`https://wa.me/${t}`,"_blank")})(r.mobile),"aria-label":"WhatsApp",title:"Open WhatsApp",style:{color:"#25D366"},children:(0,N.jsx)(Gt.faC,{size:24})}),(0,N.jsx)(no,{onClick:()=>window.open(`https://mail.superhuman.com/search/${encodeURIComponent((null===r||void 0===r?void 0:r.first_name)||"")}%20${encodeURIComponent((null===r||void 0===r?void 0:r.last_name)||"")}`,"_blank"),"aria-label":"Email",title:"Search in Superhuman",style:{color:"#25D366"},children:(0,N.jsx)(B.pHD,{size:24})}),null!==r&&void 0!==r&&r.linkedin_url?(0,N.jsx)(no,{onClick:()=>window.open(r.linkedin_url,"_blank"),"aria-label":"LinkedIn",title:"Open LinkedIn",children:(0,N.jsx)(Gt.ijb,{size:20})}):(null===r||void 0===r?void 0:r.full_name)&&(0,N.jsx)(no,{onClick:()=>window.open(`https://www.linkedin.com/search/results/all/?keywords=${encodeURIComponent(r.full_name||"")}`,"_blank"),"aria-label":"LinkedIn Search",title:"Search on LinkedIn",children:(0,N.jsx)(Gt.ijb,{size:20})}),(0,N.jsx)("button",{onClick:n,"aria-label":"Close modal",children:(0,N.jsx)(B.yGN,{size:20})})]})]})}),R&&(0,N.jsxs)("div",{style:{margin:"10px 0",padding:"8px",background:"#f0f0f0",borderRadius:"4px",border:"1px solid #ddd"},children:[(0,N.jsxs)("div",{style:{display:"flex",alignItems:"center",marginBottom:"8px"},children:[(0,N.jsx)("strong",{style:{marginRight:"10px"},children:"Debug Filters:"}),(0,N.jsxs)("select",{value:T,onChange:e=>I(e.target.value),style:{padding:"4px",marginRight:"10px"},children:[(0,N.jsx)("option",{value:"original",children:"Original (Not Group)"}),(0,N.jsx)("option",{value:"or-null-nongroup",children:"OR (Null OR Not Group)"}),(0,N.jsx)("option",{value:"null-only",children:"Null chat_id Only"}),(0,N.jsx)("option",{value:"nongroup-only",children:"Non-Group Only"}),(0,N.jsx)("option",{value:"all-messages",children:"All Messages"}),(0,N.jsx)("option",{value:"last-4-digits",children:"Last 4 Digits"}),(0,N.jsx)("option",{value:"table-scan",children:"Recent Messages Scan"}),(0,N.jsx)("option",{value:"mobile-formats",children:"Check Mobile Formats"}),(0,N.jsx)("option",{value:"direct-messages",children:"Direct Messages Only"}),(0,N.jsx)("option",{value:"analyze-messages",children:"Analyze All Messages"})]}),(0,N.jsx)("button",{onClick:async()=>{d(!0),console.log(`DEBUG: Testing filter strategy: ${T}`),console.log("DEBUG: Checking WhatsApp table overall data");try{const{count:e,error:t}=await D.supabase.from(k).select("*",{count:"exact",head:!0});console.log(`DEBUG: WhatsApp table has ${e||0} total records`),t&&console.error("DEBUG: Error querying table:",t);const{data:o,error:n}=await D.supabase.from(k).select("*").limit(3);if(o&&o.length>0){console.log("DEBUG: Sample record structure:",o[0]),console.log("DEBUG: Field names:",Object.keys(o[0]));const e=o.map((e=>e.contact_mobile));console.log("DEBUG: Example contact_mobile values:",e)}else console.error("DEBUG: Could not get sample data. Error:",n)}catch(a){console.error("DEBUG: Error checking table:",a)}const e=[];if(r.mobile&&e.push(z(r.mobile)),r.mobile2&&e.push(z(r.mobile2)),console.log("DEBUG: Raw mobile numbers:",r.mobile,r.mobile2),console.log("DEBUG: Normalized mobile numbers:",e),0===e.length)return console.log("DEBUG: No mobile numbers to search with"),void d(!1);const t=[];let o;switch(r.mobile&&r.mobile.length>4&&t.push(r.mobile.slice(-4)),r.mobile2&&r.mobile2.length>4&&t.push(r.mobile2.slice(-4)),T){case"original":case"nongroup-only":o=D.supabase.from(k).select("*, chats:chat_id(chat_type)",{count:"exact"}).in("contact_mobile",e).not("chats.chat_type","eq","group");break;case"or-null-nongroup":o=D.supabase.from(k).select("*, chats:chat_id(chat_type)",{count:"exact"}).in("contact_mobile",e).or("chat_id.is.null,not.chats.chat_type.eq.group");break;case"null-only":o=D.supabase.from(k).select("*, chats:chat_id(chat_type)",{count:"exact"}).in("contact_mobile",e).is("chat_id",null);break;case"direct-messages":console.log("DEBUG: Checking for direct messages only");const s=[];e.forEach((e=>{e&&s.push(e,e.replace(/\D/g,""),e.startsWith("+")?e.substring(1):e,e.startsWith("+")?e:`+${e}`,e.replace(/\D/g,"").slice(-10))}));const c=[...new Set(s)].filter(Boolean);console.log("DEBUG: Trying with phone variations:",c);const u=c.map((e=>`contact_mobile.ilike.%${e.slice(-8)}`));o=D.supabase.from(k).select("*",{count:"exact"}).order("created_at",{ascending:!1}).or(u.join(",")).limit(50);break;case"analyze-messages":console.log("DEBUG: Starting comprehensive message analysis");const p=[];r.mobile&&p.push(r.mobile),r.mobile2&&p.push(r.mobile2);const h=p.filter((e=>e&&e.length>4)).map((e=>`contact_mobile.ilike.%${e.slice(-8)}`));console.log("DEBUG: Using last 8 digits conditions:",h);const{data:g}=await D.supabase.from(k).select("*, chats:chat_id(chat_type)").or(h.join(",")).order("created_at",{ascending:!1}).limit(100);if(g&&g.length>0){console.log(`DEBUG: Found ${g.length} total messages`);const e=g.filter((e=>{var t;return"group"===(null===(t=e.chats)||void 0===t?void 0:t.chat_type)})),t=g.filter((e=>null===e.chat_id)),r=g.filter((e=>{var t;return null!==e.chat_id&&"group"!==(null===(t=e.chats)||void 0===t?void 0:t.chat_type)}));var n,i;if(console.log("DEBUG: Message breakdown:",{total:g.length,group:e.length,nullChat:t.length,nonGroup:r.length}),e.length>0)console.log("DEBUG: Example group message:",{id:e[0].id,chatId:e[0].chat_id,chatType:null===(n=e[0].chats)||void 0===n?void 0:n.chat_type,mobile:e[0].contact_mobile});if(r.length>0)console.log("DEBUG: Example non-group message:",{id:r[0].id,chatId:r[0].chat_id,chatType:null===(i=r[0].chats)||void 0===i?void 0:i.chat_type,mobile:r[0].contact_mobile});o=D.supabase.from(k).select("*, chats:chat_id(chat_type)",{count:"exact"}).or(h.join(",")).is("chats.chat_type",null).order("created_at",{ascending:!1}).limit(50),console.log("DEBUG: Using IS NULL on chats.chat_type as test filter")}else console.log("DEBUG: No messages found with mobile match"),o=D.supabase.from(k).select("*",{count:"exact"}).limit(20);break;case"all-messages":default:o=D.supabase.from(k).select("*, chats:chat_id(chat_type)",{count:"exact"}).in("contact_mobile",e);break;case"last-4-digits":if(t.length>0){console.log("DEBUG: Searching by last 4 digits:",t);const e=t.map((e=>`contact_mobile.ilike.%${e}`));o=D.supabase.from(k).select("*",{count:"exact"}).or(e.join(","))}else o=D.supabase.from(k).select("*",{count:"exact"}).in("contact_mobile",e);break;case"table-scan":o=D.supabase.from(k).select("*",{count:"exact"}).order("created_at",{ascending:!1}).limit(20);break;case"mobile-formats":console.log("DEBUG: Running advanced mobile formats diagnostic");try{let e=!1;if(r.mobile){console.log("MOBILE 1 ANALYSIS:");const t=await H(r.mobile);if(t.length>0){const o=t.find((e=>"exact-match"===e.type))||t[0];if(console.log("DEBUG: Best match found:",o),o.examples&&o.examples.length>0){const t=o.examples[0];console.log(`DEBUG: Using format '${t}' to fetch messages`);const{data:n}=await D.supabase.from(k).select("*, chats:chat_id(chat_type)").eq("contact_mobile",t).not("chats.chat_type","eq","group").order("created_at",{ascending:!1}).limit(20);if(n&&n.length>0)return console.log(`DEBUG: Found ${n.length} messages using format '${t}'`),l(n),m(n.length),f(1),d(!1),void(e=!0)}if(o.variant){const{data:t}=await D.supabase.from(k).select("*, chats:chat_id(chat_type)").ilike("contact_mobile",`%${o.variant.slice(-8)}`).not("chats.chat_type","eq","group").order("created_at",{ascending:!1}).limit(20);if(t&&t.length>0)return console.log(`DEBUG: Found ${t.length} messages using last 8 digits`),l(t),m(t.length),f(1),d(!1),void(e=!0)}}}if(!e&&r.mobile2){console.log("MOBILE 2 ANALYSIS:");const t=await H(r.mobile2);if(t.length>0){const o=t.find((e=>"exact-match"===e.type))||t[0];if(console.log("DEBUG: Best match found for mobile2:",o),o.examples&&o.examples.length>0){const t=o.examples[0],{data:n}=await D.supabase.from(k).select("*, chats:chat_id(chat_type)").eq("contact_mobile",t).not("chats.chat_type","eq","group").order("created_at",{ascending:!1}).limit(20);if(n&&n.length>0)return console.log(`DEBUG: Found ${n.length} messages using format '${t}'`),l(n),m(n.length),f(1),d(!1),void(e=!0)}}}if(!e){console.log("DEBUG: No matching mobile formats found, falling back to table scan");const{data:e}=await D.supabase.from(k).select("*, chats:chat_id(chat_type)").order("created_at",{ascending:!1}).limit(20);if(e&&e.length>0)return console.log("DEBUG: Latest messages from table:",e.map((e=>({id:e.id,mobile:e.contact_mobile,date:e.created_at})))),l(e),m(e.length),f(1),void d(!1)}}catch(a){console.error("DEBUG: Error in mobile formats analysis:",a)}o=D.supabase.from(k).select("*",{count:"exact"}).limit(20)}"function"===typeof o.toSQL&&console.log(`DEBUG: ${T} SQL:`,o.toSQL());try{const{data:e,count:t,error:n}=await o;if(console.log(`DEBUG: Test query "${T}" returned:`,{count:t||0,results:(null===e||void 0===e?void 0:e.length)||0,error:n}),e&&e.length>0){console.log("DEBUG: First result:",e[0]);const o=e.filter((e=>e.chat_id)),n=e.filter((e=>!e.chat_id));console.log(`DEBUG: Results with chat_id: ${o.length}, without chat_id: ${n.length}`),l(e),m(t||0),f(Math.max(Math.ceil((t||0)/E),1))}else console.log("DEBUG: No results found"),l([]),m(0),f(1)}catch(a){console.error("DEBUG: Error executing test query:",a)}finally{d(!1)}},style:{padding:"4px 8px",background:"#4a90e2",color:"white",border:"none",borderRadius:"4px"},children:"Test Filter"})]}),(0,N.jsxs)("div",{style:{fontSize:"12px",color:"#555"},children:[(0,N.jsxs)("div",{children:["Current filter: ",(0,N.jsx)("code",{children:T})]}),(0,N.jsxs)("div",{children:["Results: ",(null===s||void 0===s?void 0:s.length)||0," messages"]}),"mobile-formats"===T&&(0,N.jsx)("div",{style:{marginTop:"10px"},children:(0,N.jsx)("button",{onClick:async()=>{console.log("Applying format fix to main query");const e=null===r||void 0===r?void 0:r.mobile,t=null===r||void 0===r?void 0:r.mobile2;let o=[];if(e&&(o=await H(e)),0===o.length&&t&&(o=await H(t)),o.length>0){const n=o.find((e=>"exact-match"===e.type))||o[0];console.log("Using best match format:",n),n.examples&&n.examples.length>0?(window.whatsAppFormats={originalMobile:e||t,foundFormat:n.examples[0],matchType:n.type,variant:n.variant},alert("Successfully identified number format. Check console for details.")):alert("Found match but no examples to use. Check console for details.")}else alert("Could not identify matching mobile format. See console logs.")},style:{backgroundColor:"#4CAF50",color:"white",border:"none",padding:"4px 8px",borderRadius:"4px",cursor:"pointer",fontSize:"12px"},children:"Apply Format Fix"})})]})]}),(0,N.jsxs)(Bt,{children:[(r.mobile||r.mobile2)&&(0,N.jsx)(Vt,{active:"Whatsapp"===i,onClick:()=>{a("Whatsapp"),p(1)},children:"WhatsApp"}),(r.mobile||r.mobile2)&&(0,N.jsx)(Vt,{active:"WhatsappChat"===i,onClick:()=>{a("WhatsappChat"),p(1)},children:"WhatsApp Group Chat"}),(r.email||r.email2||r.email3)&&(0,N.jsx)(Vt,{active:"Email"===i,onClick:()=>{a("Email"),p(1)},children:"Emails"}),(0,N.jsx)(Vt,{active:"Meeting"===i,onClick:()=>{a("Meeting"),p(1)},children:"Meetings"}),(0,N.jsx)(Vt,{active:"Snooze"===i,onClick:()=>{a("Snooze")},children:"Snooze"})]}),(0,N.jsx)(Ut,{children:"Whatsapp"===i?(()=>{console.log(`DEBUG: Rendering WhatsApp table with ${s.length} messages`),s.length>0&&console.log("DEBUG: First interaction to render:",s[0]);const e=s.filter((e=>{e.chat_id&&console.log(`DEBUG: Message ${e.id} has chat_id ${e.chat_id}`);const t=e.chat_id&&!e.chats,o=e.chats&&"group"===e.chats.chat_type;return!t&&!o}));if(console.log(`FINAL FILTER: Removed ${s.length-e.length} group messages at render time`),console.log("DEBUG: Final filtered messages:",e),c)return(0,N.jsx)(N.Fragment,{children:(0,N.jsxs)(Kt,{children:["Loading page ",u,"..."]})});if(!e.length)return(0,N.jsx)(N.Fragment,{children:(0,N.jsxs)(Kt,{children:[s.length>0?"All messages are group chats - check the 'WhatsApp Group Chat' tab":"No WhatsApp messages found for page "+u,(0,N.jsx)("div",{style:{fontSize:"0.85em",marginTop:"16px",color:"#4b5563"},children:(0,N.jsx)("button",{type:"button",onClick:()=>{console.log("Emergency fetch button clicked"),Y(u)},style:{marginTop:"16px",padding:"8px 16px",background:"#000000",color:"white",border:"none",borderRadius:"6px",cursor:"pointer",fontWeight:"bold",boxShadow:"0 2px 4px rgba(0,0,0,0.15)"},children:"Retry Fetch"})})]})});const t=(u-1)*E+1,o=(Math.min(t+e.length-1,g),P.Ay.div`
      height: 400px;
      overflow-y: auto;
      margin-bottom: 15px;
      background-color: #f0f0f0;
      border-radius: 8px;
      padding: 8px;
      display: flex;
      flex-direction: column;
      gap: 6px;
    `),n=P.Ay.div`
      max-width: 80%;
      padding: 8px 10px;
      border-radius: 8px;
      font-size: 0.85rem;
      line-height: 1.3;
      position: relative;
      word-break: break-word;
      
      ${e=>"Sent"===e.direction?"\n        align-self: flex-end;\n        background-color: #000000;\n        color: white;\n        border-bottom-right-radius: 2px;\n        \n        &:after {\n          content: '';\n          position: absolute;\n          bottom: 0;\n          right: -8px;\n          width: 0;\n          height: 0;\n          border: 8px solid transparent;\n          border-left-color: #000000;\n          border-right: 0;\n          border-bottom: 0;\n        }\n      ":"\n        align-self: flex-start;\n        background-color: #ffffff;\n        border-bottom-left-radius: 2px;\n        \n        &:after {\n          content: '';\n          position: absolute;\n          bottom: 0;\n          left: -8px;\n          width: 0;\n          height: 0;\n          border: 8px solid transparent;\n          border-right-color: #ffffff;\n          border-left: 0;\n          border-bottom: 0;\n        }\n      "}
    `,r=P.Ay.div`
      font-size: 0.65rem;
      color: ${e=>"Sent"===e.direction?"#cccccc":"#8696a0"};
      margin-top: 2px;
      display: flex;
      align-items: center;
      justify-content: ${e=>"Sent"===e.direction?"flex-end":"flex-start"};
      gap: 4px;
    `,i=P.Ay.span`
      font-size: 0.65rem;
    `,a=P.Ay.span`
      font-size: 0.65rem;
      color: #374151;
      font-weight: 500;
    `;return(0,N.jsxs)(N.Fragment,{children:[(0,N.jsxs)(ro,{children:["Individual WhatsApp Messages - Page ",u," of ",h]}),(0,N.jsx)(o,{children:e.map(((e,t)=>{var o,s,l,c,d;const u="inbound"===(null===(o=e.direction)||void 0===o?void 0:o.toLowerCase())||"incoming"===(null===(s=e.direction)||void 0===s?void 0:s.toLowerCase())||"received"===(null===(l=e.direction)||void 0===l?void 0:l.toLowerCase())||"in"===(null===(c=e.direction)||void 0===c?void 0:c.toLowerCase())?"Received":"Sent",p=W(e.whatsapp_date||e.created_at),h=(null===(d=e.message)||void 0===d?void 0:d.replace(/<a href=".*?">.*?<\/a>/g,"LINK"))||"";return(0,N.jsxs)(n,{direction:u,children:[h,(0,N.jsxs)(r,{direction:u,children:[(0,N.jsx)(i,{children:p}),"Received"===u&&(0,N.jsxs)(a,{children:["\u2022 ",e.contact_mobile]})]})]},e.id||t)}))}),(0,N.jsxs)(Qt,{children:[(0,N.jsxs)(Zt,{children:["Page ",u," of ",h]}),(0,N.jsxs)("div",{children:[(0,N.jsx)(eo,{type:"button",onClick:()=>q(1),disabled:1===u,children:"First"}),(0,N.jsx)(eo,{type:"button",onClick:()=>q(Math.max(1,u-1)),disabled:1===u,children:"Previous"}),(0,N.jsx)(eo,{type:"button",onClick:()=>q(Math.min(h,u+1)),disabled:u===h,children:"Next"}),(0,N.jsx)(eo,{type:"button",onClick:()=>q(h),disabled:u===h,children:"Last"})]})]})]})})():"WhatsappChat"===i?(()=>{if(c)return(0,N.jsx)(N.Fragment,{children:(0,N.jsx)(Kt,{children:"Loading WhatsApp chats..."})});if(!M.length)return(0,N.jsx)(N.Fragment,{children:(0,N.jsxs)(Kt,{children:["No WhatsApp chats found for this contact",(0,N.jsxs)("div",{style:{fontSize:"0.85em",marginTop:"16px",color:"#4b5563"},children:[(0,N.jsx)("p",{children:"This contact may not be a part of any WhatsApp groups or chats."}),(0,N.jsx)("button",{type:"button",onClick:()=>{console.log("Retry chats fetch button clicked"),V()},style:{marginTop:"16px",padding:"8px 16px",background:"#000000",color:"white",border:"none",borderRadius:"6px",cursor:"pointer",fontWeight:"bold",boxShadow:"0 2px 4px rgba(0,0,0,0.15)"},children:"Retry Fetch"})]})]})});const e=(u-1)*E,t=e+E,o=M.slice(e,t);return(0,N.jsxs)(N.Fragment,{children:[(0,N.jsxs)("div",{style:{marginBottom:"20px"},children:[(0,N.jsxs)("h3",{style:{marginBottom:"10px",fontSize:"1.1rem",fontWeight:"600"},children:["WhatsApp Chats (",M.length,")"]}),(0,N.jsx)("div",{style:{display:"flex",flexDirection:"column",gap:"16px"},children:o.map((e=>{var t;const o="group"===e.chat_type||e.is_group_chat;return(0,N.jsxs)("div",{style:{backgroundColor:"#ffffff",borderRadius:"8px",boxShadow:"0 2px 8px rgba(0,0,0,0.05)",padding:"16px",border:"1px solid #e5e7eb"},children:[(0,N.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"10px"},children:[(0,N.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:"10px"},children:[(0,N.jsx)("h4",{style:{margin:0,fontSize:"1rem",fontWeight:"600"},children:e.chat_name||(o?"Group Chat":"Individual Chat")}),(0,N.jsx)(to,{color:o?"#4b5563":"#f3f4f6",textColor:o?"#ffffff":"#111827",children:(0,N.jsx)("span",{children:o?"Group Chat":"Individual Chat"})})]}),(0,N.jsx)("div",{children:(0,N.jsx)("span",{style:{fontSize:"0.85rem",color:"#6b7280"},children:e.last_message_at?W(e.last_message_at):e.messages&&null!==(t=e.messages[0])&&void 0!==t&&t.created_at?W(e.messages[0].created_at):W(e.created_at)})})]}),e.messages&&e.messages.length>0?(0,N.jsxs)("div",{style:{backgroundColor:"#f9fafb",borderRadius:"6px",padding:"12px",maxHeight:"200px",overflowY:"auto",border:"1px solid #f3f4f6"},children:[e.messages.slice(0,3).map(((e,t)=>{var o,n,r,i;const a="inbound"===(null===(o=e.direction)||void 0===o?void 0:o.toLowerCase())||"incoming"===(null===(n=e.direction)||void 0===n?void 0:n.toLowerCase())||"received"===(null===(r=e.direction)||void 0===r?void 0:r.toLowerCase())||"in"===(null===(i=e.direction)||void 0===i?void 0:i.toLowerCase())?"Received":"Sent";return(0,N.jsxs)("div",{style:{padding:"8px",borderBottom:t<2?"1px solid #eaeaea":"none",marginBottom:t<2?"8px":0},children:[(0,N.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",fontSize:"0.8rem",color:"#6b7280",marginBottom:"4px"},children:[(0,N.jsx)(oo,{direction:a,children:(0,N.jsx)("span",{children:a})}),(0,N.jsx)("span",{children:W(e.created_at)})]}),(0,N.jsx)("div",{style:{fontSize:"0.9rem"},children:e.message&&(e.message.length>100?`${e.message.substring(0,100)}...`:e.message)})]},e.id||t)})),e.messages.length>3&&(0,N.jsxs)("div",{style:{textAlign:"center",fontSize:"0.85rem",color:"#6b7280",marginTop:"8px",padding:"4px"},children:["+ ",e.messages.length-3," more messages"]})]}):(0,N.jsx)("div",{style:{padding:"16px",textAlign:"center",color:"#6b7280",fontStyle:"italic",backgroundColor:"#f9fafb",borderRadius:"6px",border:"1px solid #f3f4f6"},children:"No messages found for this chat"})]},e.id)}))})]}),M.length>E&&(0,N.jsxs)(Qt,{children:[(0,N.jsxs)(Zt,{children:["Page ",u," of ",h]}),(0,N.jsxs)("div",{children:[(0,N.jsx)(eo,{type:"button",onClick:()=>q(1),disabled:1===u,children:"First"}),(0,N.jsx)(eo,{type:"button",onClick:()=>q(Math.max(1,u-1)),disabled:1===u,children:"Previous"}),(0,N.jsx)(eo,{type:"button",onClick:()=>q(Math.min(h,u+1)),disabled:u===h,children:"Next"}),(0,N.jsx)(eo,{type:"button",onClick:()=>q(h),disabled:u===h,children:"Last"})]})]})]})})():"Email"===i?(()=>{if(c)return(0,N.jsx)(N.Fragment,{children:(0,N.jsx)(Kt,{children:"Loading emails..."})});if(!s.length)return(0,N.jsx)(N.Fragment,{children:(0,N.jsxs)(Kt,{children:["No emails found for this contact",(0,N.jsxs)("div",{style:{fontSize:"0.85em",marginTop:"16px",color:"#6b7280"},children:[(0,N.jsx)("p",{children:"Please make sure the contact has valid email addresses and the emails table exists in the database."}),(0,N.jsx)("div",{style:{marginTop:"16px"},children:(0,N.jsx)("button",{type:"button",onClick:()=>{console.log("Debug email fetch button clicked"),Q()},style:{marginTop:"16px",padding:"8px 16px",background:"#000000",color:"white",border:"none",borderRadius:"6px",cursor:"pointer",fontWeight:"500",boxShadow:"0 2px 4px rgba(0,0,0,0.15)"},children:"Refresh Emails"})})]})]})});const e=s[0],t=w.includes(e.from_email)?"Sent":"Received",o={display:"flex",justifyContent:"space-between",color:"#6b7280",fontSize:"0.9rem",marginBottom:"8px"},i={fontWeight:"bold",marginRight:"10px",color:"#111827"},a={padding:"4px 8px",borderRadius:"4px",fontSize:"0.8rem",fontWeight:"bold",marginLeft:"10px",color:"Received"===t?"#111827":"#ffffff",backgroundColor:"Received"===t?"#f3f4f6":"#4b5563"},l={padding:"10px 20px",border:"none",borderRadius:"6px",fontSize:"0.95rem",fontWeight:"500",cursor:"pointer",display:"flex",alignItems:"center",justifyContent:"center",gap:"8px",minWidth:"120px",boxShadow:"0 2px 4px rgba(0,0,0,0.1)",transition:"all 0.2s ease"},d={...l,backgroundColor:"#000000",color:"#ffffff","&:hover":{backgroundColor:"#333333"}},u={...l,backgroundColor:"#4b5563",color:"#ffffff","&:hover":{backgroundColor:"#374151"}};return(0,N.jsxs)(N.Fragment,{children:[(0,N.jsxs)(ro,{children:["Latest email (",g," total emails)"]}),(0,N.jsx)("div",{style:{overflowY:"auto"},children:(0,N.jsxs)("div",{style:{backgroundColor:"#ffffff",borderRadius:"8px",boxShadow:"0 2px 10px rgba(0,0,0,0.05)",padding:"20px",marginBottom:"20px",marginTop:"0",maxWidth:"100%",overflowWrap:"break-word",border:"1px solid #e5e7eb",display:"flex",flexDirection:"column"},children:[(0,N.jsxs)("div",{style:{borderBottom:"1px solid #e5e7eb",paddingBottom:"16px",marginBottom:"16px"},children:[(0,N.jsxs)("div",{style:{fontSize:"1.2rem",fontWeight:"bold",marginBottom:"12px",color:"#111827"},children:[e.subject||"(No Subject)",(0,N.jsx)("span",{style:a,children:t})]}),(0,N.jsxs)("div",{style:o,children:[(0,N.jsxs)("div",{children:[(0,N.jsx)("span",{style:i,children:"From:"}),e.from_name||"Unknown"," <",e.from_email||"No Email",">"]}),(0,N.jsx)("div",{children:W(e.created_at)})]}),(0,N.jsx)("div",{style:o,children:(0,N.jsxs)("div",{children:[(0,N.jsx)("span",{style:i,children:"To:"}),e.to_name||"Unknown"," <",e.to_email||"No Email",">"]})})]}),(0,N.jsx)("div",{style:{minHeight:"120px",maxHeight:"180px",overflowY:"auto",border:"1px solid #f0f0f0",borderRadius:"4px",backgroundColor:"#fafafa",margin:"10px 0",padding:"15px"},children:(0,N.jsx)("div",{style:{margin:0,fontFamily:"inherit",fontSize:"1rem",lineHeight:"1.7",color:"#1f2937",whiteSpace:"normal",wordBreak:"break-word",fontWeight:"400",letterSpacing:"0.01em"},dangerouslySetInnerHTML:{__html:e.body_plain?e.body_plain.replace(/\n/g,"<br>"):"(No content)"}})}),(0,N.jsxs)("div",{style:{display:"flex",justifyContent:"center",gap:"15px",marginTop:"20px"},children:[(0,N.jsx)("button",{onClick:()=>window.open((()=>{if(e.thread_id)return`https://mail.superhuman.com/thread/${e.thread_id}`;const t=[];if(e.subject&&""!==e.subject.trim()&&"no subject"!==e.subject.toLowerCase()){const o=e.subject.split(" ").slice(0,4).join(" ");t.push(encodeURIComponent(o))}return(r.first_name||r.last_name)&&t.push(encodeURIComponent(`${r.first_name||""} ${r.last_name||""}`)),0===t.length&&r.email&&t.push(encodeURIComponent(r.email)),`https://mail.superhuman.com/search/${t.join("%20")}`})(),"_blank"),style:d,title:"View in Superhuman",children:"Open in Superhuman"}),(0,N.jsx)("button",{onClick:async()=>{try{const{error:e}=await D.supabase.from("contacts").update({contact_category:"Skip"}).eq("id",r.id);if(e)return console.error("Error updating contact category:",e),void alert("Failed to update contact category");n()}catch(e){console.error("Error in handleSkip:",e),alert("An error occurred")}},style:u,title:"Mark contact as Skip",children:"Skip Contact"})]})]})})]})})():"Meeting"===i?(()=>{if(c)return(0,N.jsx)(Kt,{children:"Loading meetings..."});if(!_.length)return(0,N.jsxs)(Kt,{children:["No meetings found for this contact",(0,N.jsx)("div",{style:{marginTop:"20px"},children:(0,N.jsx)("button",{onClick:()=>window.open("/planner","_blank"),style:{padding:"8px 16px",background:"#000000",color:"white",border:"none",borderRadius:"6px",cursor:"pointer",fontWeight:"500",boxShadow:"0 2px 4px rgba(0,0,0,0.15)",fontSize:"0.875rem",display:"inline-flex",alignItems:"center",justifyContent:"center"},children:"Schedule a Meeting"})})]});const e=(u-1)*E+1,t=Math.min(e+_.length-1,g);return(0,N.jsxs)(N.Fragment,{children:[(0,N.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"15px"},children:[(0,N.jsxs)("div",{style:{fontWeight:"bold",color:"#374151"},children:[e,"-",t," of ",g," meetings"]}),(0,N.jsx)("button",{onClick:()=>window.open("/planner","_blank"),style:{padding:"8px 16px",background:"#000000",color:"white",border:"none",borderRadius:"6px",cursor:"pointer",fontWeight:"500",boxShadow:"0 2px 4px rgba(0,0,0,0.15)",fontSize:"0.875rem",display:"inline-flex",alignItems:"center",justifyContent:"center"},children:"View All Meetings"})]}),(0,N.jsx)("div",{style:{height:"400px",overflowY:"auto",marginBottom:"15px"},children:(0,N.jsxs)(Yt,{children:[(0,N.jsx)(Jt,{children:(0,N.jsxs)("tr",{children:[(0,N.jsx)("th",{style:{width:"15%"},children:"Date"}),(0,N.jsx)("th",{style:{width:"30%"},children:"Meeting Name"}),(0,N.jsx)("th",{style:{width:"15%"},children:"Category"}),(0,N.jsx)("th",{style:{width:"40%"},children:"Notes"})]})}),(0,N.jsx)(Xt,{children:_.map(((e,t)=>(0,N.jsxs)("tr",{children:[(0,N.jsx)("td",{className:"centered",children:W(e.meeting_date)}),(0,N.jsx)("td",{children:e.meeting_name}),(0,N.jsx)("td",{className:"tag-cell",children:(0,N.jsx)(to,{color:(e=>{switch(null===e||void 0===e?void 0:e.toLowerCase()){case"inbox":case"karma_points":default:return"#f3f4f6";case"dealflow":case"portfolio":return"#4b5563"}})(e.meeting_category),textColor:(e=>{switch(null===e||void 0===e?void 0:e.toLowerCase()){case"inbox":case"karma_points":default:return"#111827";case"dealflow":case"portfolio":return"#ffffff"}})(e.meeting_category),children:(0,N.jsx)("span",{children:e.meeting_category||"None"})})}),(0,N.jsx)("td",{children:e.meeting_note?(0,N.jsx)("div",{style:{maxHeight:"80px",overflow:"auto",fontSize:"0.85rem",lineHeight:"1.5"},children:e.meeting_note}):(0,N.jsx)("span",{style:{fontStyle:"italic",color:"#6b7280"},children:"No notes"})})]},e.id||t)))})]})}),(0,N.jsxs)(Qt,{children:[(0,N.jsxs)(Zt,{children:["Page ",u," of ",h]}),(0,N.jsxs)("div",{children:[(0,N.jsx)(eo,{type:"button",onClick:()=>q(1),disabled:1===u,children:"First"}),(0,N.jsx)(eo,{type:"button",onClick:()=>q(Math.max(1,u-1)),disabled:1===u,children:"Previous"}),(0,N.jsx)(eo,{type:"button",onClick:()=>q(Math.min(h,u+1)),disabled:u===h,children:"Next"}),(0,N.jsx)(eo,{type:"button",onClick:()=>q(h),disabled:u===h,children:"Last"})]})]})]})})():"Snooze"===i?renderSnoozeTab():(0,N.jsx)($t,{children:c?(0,N.jsx)(Kt,{children:"Loading..."}):s.length?(0,N.jsx)(Wt,{children:s.map((e=>(0,N.jsxs)(qt,{type:e.type,children:[(0,N.jsx)("div",{className:"type",children:e.type}),(0,N.jsx)("div",{className:"date",children:W(e.interaction_date)}),(0,N.jsx)("div",{className:"content",children:e.content})]},e.id)))}):(0,N.jsx)(Kt,{children:"Email"===i?"No emails found":"Meeting"===i?"No meetings found":"No interactions found"})})})]})})},ao=P.Ay.div`
  display: flex;
  justify-content: space-between;
  align-items: center;
  margin-bottom: 15px;
  padding-bottom: 15px;
  border-bottom: 1px solid #e5e7eb;

  h2 {
    margin: 0;
    font-size: 1.25rem;
    color: #111827;
    font-weight: 600;
  }

  button {
    background: none;
    border: none;
    cursor: pointer;
    color: #6b7280;
    padding: 4px;
    border-radius: 4px;
    
    &:hover {
      color: #1f2937;
      background-color: #f3f4f6;
    }
  }
`,so=P.Ay.div`
  margin-bottom: 15px;
`,lo=P.Ay.h3`
  font-size: 16px;
  font-weight: bold;
  color: #374151;
  margin-bottom: 12px;
`,co=P.Ay.div`
  display: flex;
  flex-wrap: wrap;
  gap: 8px;
  margin-bottom: 16px;
  padding: 5px 0;
  min-height: 32px;
`,uo=P.Ay.div`
  display: inline-flex;
  align-items: center;
  padding: 0.25rem 0.5rem;
  font-size: 0.75rem;
  border-radius: 0.375rem;
  background-color: white;
  color: black;
  font-weight: 500;
  margin-right: 0.25rem;
  margin-bottom: 0.25rem;
  border: 1px solid black;
  text-transform: uppercase;
  gap: 6px;
  max-width: 200px;

  span {
    white-space: nowrap;
    overflow: hidden;
    text-overflow: ellipsis;
    max-width: 150px;
  }

  button {
    background: none;
    border: none;
    padding: 0;
    display: inline-flex;
    align-items: center;
    justify-content: center;
    margin-left: 0.25rem;
    color: #6b7280;
    cursor: pointer;
    
    &:hover {
      color: #ef4444;
    }
  }
`,po=P.Ay.div`
  position: relative;
  margin-bottom: 16px;
  width: 85%; /* Adjusted to match dropdown width */
`,ho=P.Ay.div`
  position: absolute;
  left: 10px;
  top: 50%;
  transform: translateY(-50%);
  color: #6b7280;
`,fo=P.Ay.input`
  width: 100%;
  padding: 10px 10px 10px 35px;
  border: 1px solid #d1d5db;
  border-radius: 6px;
  font-size: 0.875rem;
  outline: none;
  transition: border-color 0.2s;

  &:focus {
    border-color: #3b82f6;
    box-shadow: 0 0 0 3px rgba(59, 130, 246, 0.1);
  }
`,go=P.Ay.div`
  position: relative;
  margin-top: 5px;
  border: 1px solid #e5e7eb;
  border-radius: 6px;
  max-height: 200px;
  overflow-y: auto;
  background-color: white;
  box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
  z-index: 10;
  width: 87%; /* Match the width of the search container */
`,mo=P.Ay.button`
  width: 100%;
  text-align: left;
  padding: 8px 12px;
  border: none;
  background: none;
  cursor: pointer;
  font-size: 0.875rem;
  color: #374151;
  transition: background-color 0.2s;
  display: flex;
  align-items: center;
  justify-content: space-between;

  &:hover {
    background-color: #f3f4f6;
  }

  &:not(:last-child) {
    border-bottom: 1px solid #f3f4f6;
  }
`,yo=P.Ay.button`
  width: 100%;
  text-align: left;
  padding: 8px 12px;
  border: none;
  background-color: #f3f4f6;
  cursor: pointer;
  font-size: 0.875rem;
  color: #1f2937;
  display: flex;
  align-items: center;
  gap: 5px;
  transition: background-color 0.2s;

  &:hover {
    background-color: #e5e7eb;
  }
`,vo=P.Ay.div`
  padding: 10px;
  border-radius: 4px;
  margin-bottom: 15px;
  font-size: 0.875rem;

  &.success {
    background-color: #d1fae5;
    color: #065f46;
  }

  &.error {
    background-color: #fee2e2;
    color: #b91c1c;
  }
`,bo=P.Ay.div`
  display: flex;
  justify-content: flex-end;
  gap: 10px;
  margin-top: 20px;
`,xo=P.Ay.button`
  padding: 8px 16px;
  border-radius: 4px;
  font-size: 0.875rem;
  font-weight: 500;
  cursor: pointer;
  transition: all 0.2s;

  &.primary {
    background-color: #000000;
    color: white;
    border: none;

    &:hover {
      background-color: #333333;
    }
  }

  &.secondary {
    background-color: white;
    color: #4b5563;
    border: 1px solid #d1d5db;

    &:hover {
      background-color: #f9fafb;
    }
  }

  &:disabled {
    opacity: 0.5;
    cursor: not-allowed;
  }
`,wo=P.Ay.div`
  margin-bottom: 15px;
`,Co=P.Ay.label`
  display: block;
  margin-bottom: 5px;
  font-size: 0.875rem;
  font-weight: 500;
  color: #374151;
`,_o=P.Ay.input`
  width: 100%;
  padding: 8px 12px;
  border: 1px solid #d1d5db;
  border-radius: 4px;
  font-size: 0.875rem;
  
  &:focus {
    outline: none;
    border-color: #3b82f6;
    box-shadow: 0 0 0 3px rgba(59, 130, 246, 0.1);
  }
`,So=P.Ay.select`
  width: 100%;
  padding: 8px 12px;
  border: 1px solid #d1d5db;
  border-radius: 4px;
  font-size: 0.875rem;
  background-color: white;
  
  &:focus {
    outline: none;
    border-color: #3b82f6;
    box-shadow: 0 0 0 3px rgba(59, 130, 246, 0.1);
  }
`,Eo=P.Ay.textarea`
  width: 100%;
  padding: 8px 12px;
  border: 1px solid #d1d5db;
  border-radius: 4px;
  font-size: 0.875rem;
  min-height: 100px;
  resize: vertical;
  
  &:focus {
    outline: none;
    border-color: #3b82f6;
    box-shadow: 0 0 0 3px rgba(59, 130, 246, 0.1);
  }
`,ko=(0,P.Ay)(so)`
  margin-top: 20px;
`,jo=P.Ay.div`
  display: flex;
  flex-wrap: wrap;
  gap: 8px;
  margin-bottom: 16px;
  padding: 5px 0;
  min-height: 32px;
`,Ao=P.Ay.div`
  display: inline-flex;
  align-items: center;
  padding: 4px 8px;
  background-color: ${e=>e.color||"#f3f4f6"};
  color: ${e=>e.textColor||"#374151"};
  border-radius: 16px;
  font-size: 0.875rem;
  gap: 6px;
  max-width: 200px;

  span {
    white-space: nowrap;
    overflow: hidden;
    text-overflow: ellipsis;
    max-width: 150px;
  }

  button {
    background: none;
    border: none;
    padding: 2px;
    cursor: pointer;
    color: inherit;
    opacity: 0.7;
    display: flex;
    align-items: center;
    justify-content: center;
    flex-shrink: 0;

    &:hover {
      opacity: 1;
    }
  }
`,Ro=P.Ay.button`
  width: 100%;
  text-align: left;
  padding: 8px 12px;
  border: none;
  background-color: #f3f4f6;
  cursor: pointer;
  font-size: 0.875rem;
  color: #1f2937;
  display: flex;
  align-items: center;
  gap: 5px;
  transition: background-color 0.2s;

  &:hover {
    background-color: #e5e7eb;
  }

  &:disabled {
    opacity: 0.5;
    cursor: not-allowed;
  }
`,Oo=["Advisory","Corporation","Institution","Professional Investor","SME","Startup","Supplier","Media","Team"],To=e=>{let{isOpen:o,onClose:n,onSave:r}=e;const[i,a]=(0,t.useState)(""),[s,l]=(0,t.useState)(""),[c,d]=(0,t.useState)(""),[u,p]=(0,t.useState)(""),[h,f]=(0,t.useState)(!1),[g,m]=(0,t.useState)(""),[y,v]=(0,t.useState)([]),[b,x]=(0,t.useState)(""),[w,C]=(0,t.useState)([]),[_,S]=(0,t.useState)(!1);(0,t.useEffect)((()=>{o||(a(""),l(""),d(""),p(""),v([]),x(""),m(""))}),[o]);(0,t.useEffect)((()=>{(async e=>{try{if(!e||e.length<3)return void C([]);const{data:t,error:o}=await D.supabase.from("tags").select("*").ilike("name",`%${e}%`).limit(10);if(o)throw o;const n=t.filter((e=>!y.some((t=>t.id===e.id))));C(n)}catch(t){console.error("Error fetching tag suggestions:",t)}})(b)}),[b]);const E=async e=>{v([...y,e]),x(""),S(!1)};return(0,N.jsx)(ot(),{isOpen:o,onRequestClose:n,style:{content:{top:"50%",left:"50%",right:"auto",bottom:"auto",marginRight:"-50%",transform:"translate(-50%, -50%)",padding:"20px",border:"none",borderRadius:"0.5rem",boxShadow:"0 4px 6px rgba(0, 0, 0, 0.1)",maxWidth:"600px",width:"90%",maxHeight:"90vh",overflow:"auto"},overlay:{backgroundColor:"rgba(0, 0, 0, 0.5)",zIndex:1100}},children:(0,N.jsxs)("div",{style:{padding:"1rem"},children:[(0,N.jsxs)(ao,{children:[(0,N.jsx)("h2",{children:"Create New Company"}),(0,N.jsx)("button",{onClick:n,"aria-label":"Close modal",children:(0,N.jsx)(B.yGN,{size:20})})]}),(0,N.jsxs)("form",{onSubmit:async e=>{if(e.preventDefault(),m(""),i.trim())if(c)if(u.trim())try{f(!0);let e=s.trim();e&&!e.match(/^https?:\/\//)&&(e="https://"+e);const{data:t,error:o}=await D.supabase.from("companies").insert({name:i.trim(),website:e,category:c,description:u.trim()}).select().single();if(o)throw o;if(y.length>0){const e=y.map((e=>({company_id:t.id,tag_id:e.id}))),{error:o}=await D.supabase.from("companies_tags").insert(e);if(o)throw o}r(t),n()}catch(t){console.error("Error creating company:",t),m("Failed to create company. Please try again.")}finally{f(!1)}else m("Company description is required");else m("Company category is required");else m("Company name is required")},children:[(0,N.jsxs)(wo,{children:[(0,N.jsx)(Co,{htmlFor:"companyName",children:"Company Name *"}),(0,N.jsx)(_o,{id:"companyName",type:"text",value:i,onChange:e=>a(e.target.value),required:!0})]}),(0,N.jsxs)(wo,{children:[(0,N.jsx)(Co,{htmlFor:"companyWebsite",children:"Website"}),(0,N.jsx)(_o,{id:"companyWebsite",type:"text",value:s,onChange:e=>l(e.target.value),placeholder:"www.example.com"})]}),(0,N.jsxs)(wo,{children:[(0,N.jsx)(Co,{htmlFor:"companyCategory",children:"Category *"}),(0,N.jsxs)(So,{id:"companyCategory",value:c,onChange:e=>d(e.target.value),required:!0,children:[(0,N.jsx)("option",{value:"",children:"Select a category..."}),Oo.map((e=>(0,N.jsx)("option",{value:e,children:e},e)))]})]}),(0,N.jsxs)(wo,{children:[(0,N.jsx)(Co,{htmlFor:"companyDescription",children:"Description *"}),(0,N.jsx)(Eo,{id:"companyDescription",value:u,onChange:e=>p(e.target.value),placeholder:"Enter company description...",required:!0})]}),(0,N.jsxs)(ko,{children:[(0,N.jsx)(lo,{children:"Tags"}),(0,N.jsx)(jo,{children:y.map((e=>{const t=(e=>{const t=[{bg:"#fee2e2",text:"#b91c1c"},{bg:"#fef3c7",text:"#92400e"},{bg:"#ecfccb",text:"#3f6212"},{bg:"#d1fae5",text:"#065f46"},{bg:"#e0f2fe",text:"#0369a1"},{bg:"#ede9fe",text:"#5b21b6"},{bg:"#fae8ff",text:"#86198f"},{bg:"#fce7f3",text:"#9d174d"}];return t[e.split("").reduce(((e,t)=>e+t.charCodeAt(0)),0)%t.length]})(e.name);return(0,N.jsxs)(Ao,{color:t.bg,textColor:t.text,children:[(0,N.jsx)("span",{children:e.name}),(0,N.jsx)("button",{onClick:()=>{return t=e.id,void v(y.filter((e=>e.id!==t)));var t},children:(0,N.jsx)(B.yGN,{size:14})})]},e.id)}))}),(0,N.jsx)(wo,{style:{width:"87%"},children:(0,N.jsxs)(po,{style:{width:"100%"},children:[(0,N.jsx)(ho,{children:(0,N.jsx)(B.CKj,{size:16})}),(0,N.jsx)(fo,{type:"text",value:b,onChange:e=>x(e.target.value),placeholder:"Search or create new tag...",onFocus:()=>S(!0)})]})}),_&&b.length>=3&&(0,N.jsxs)(go,{children:[w.map((e=>(0,N.jsx)(mo,{onClick:()=>E(e),children:e.name},e.id))),b.trim()&&!w.find((e=>e.name.toLowerCase()===b.toLowerCase()))&&(0,N.jsxs)(Ro,{onClick:async()=>{try{const{data:e,error:t}=await D.supabase.from("tags").insert({name:b.trim()}).select().single();if(t)throw t;E(e)}catch(e){console.error("Error creating new tag:",e),m("Failed to create new tag")}},disabled:h,children:[(0,N.jsx)(B.GGD,{size:14}),'Create "',b,'"']})]})]}),g&&(0,N.jsx)(vo,{className:"error",children:g}),(0,N.jsxs)(bo,{children:[(0,N.jsx)(xo,{type:"button",className:"secondary",onClick:n,disabled:h,children:"Cancel"}),(0,N.jsx)(xo,{type:"submit",className:"primary",disabled:h,children:h?"Creating...":"Create Company"})]})]})]})})},Do=e=>{let{isOpen:o,onRequestClose:n,contact:r}=e;const[i,a]=(0,t.useState)([]),[s,l]=(0,t.useState)(""),[c,d]=(0,t.useState)([]),[u,p]=(0,t.useState)(!1),[h,f]=(0,t.useState)({type:"",text:""}),[g,m]=(0,t.useState)(!1),[y,v]=(0,t.useState)(!1);(0,t.useEffect)((()=>{o&&null===r&&v(!0)}),[o,r]);const b=async()=>{try{if(!r||!r.id)return;console.log("Fetching related companies for contact ID:",r.id);const{count:e,error:t}=await D.supabase.from("contact_companies").select("*",{count:"exact",head:!0});if(t)return console.error("Error checking contact_companies table:",t),void f({type:"error",text:"Error accessing the database"});console.log("contact_companies table exists, fetching relationships");const{data:o,error:n}=await D.supabase.from("contact_companies").select("\n          id, \n          contact_id,\n          company_id,\n          companies:company_id (\n            id, \n            name, \n            website\n          )\n        ").eq("contact_id",r.id);if(n)throw console.error("Error fetching related companies:",n),console.error("Error details:",n.message,n.details,n.hint),n;if(console.log("Related companies data:",o),!o||0===o.length)return console.log("No related companies found for this contact"),void a([]);const i=o.map((e=>e.companies&&"object"===typeof e.companies?{id:e.id,company_id:e.company_id,name:e.companies.name,website:e.companies.website}:(console.log("Got company ID without details, need to fetch company:",e.company_id),{id:e.id,company_id:e.company_id,name:"Loading...",website:""})));a(i);const s=i.filter((e=>"Loading..."===e.name));s.length>0&&x(s)}catch(e){console.error("Error fetching related companies:",e),f({type:"error",text:"Failed to load companies"})}},x=async e=>{try{const t=e.map((e=>e.company_id));console.log("Fetching details for companies:",t);const{data:o,error:n}=await D.supabase.from("companies").select("*").in("id",t);if(n)throw n;o&&o.length>0&&a((e=>{const t=[...e];return o.forEach((e=>{const o=t.findIndex((t=>t.company_id===e.id));-1!==o&&(t[o]={...t[o],name:e.name,website:e.website})})),t}))}catch(t){console.error("Error fetching missing company details:",t)}};(0,t.useEffect)((()=>{o&&r&&b()}),[o,r]),(0,t.useEffect)((()=>{s.length>=3?((async e=>{try{if(e.length<3)return void d([]);let t=D.supabase.from("companies").select("*");e&&(t=t.ilike("name",`%${e}%`));const{data:o,error:n}=await t.limit(10);if(n)throw n;const r=o.filter((e=>!i.some((t=>t.company_id===e.id))));d(r)}catch(t){console.error("Error fetching company suggestions:",t)}})(s),m(!0)):(d([]),m(!1))}),[s]);const w=async e=>{try{p(!0),console.log("Adding company to contact:",{contact_id:r.id,company_id:e.id,company_name:e.name});const{data:t,error:o}=await D.supabase.from("contact_companies").select("id").eq("contact_id",r.id).eq("company_id",e.id);if(o)throw console.error("Error checking existing company relation:",o),o;if(t&&t.length>0)return console.log("Association already exists",t),f({type:"info",text:"This company is already linked to the contact"}),void p(!1);const{data:n,error:i}=await D.supabase.from("contact_companies").insert({contact_id:r.id,company_id:e.id}).select();if(i)throw console.error("Error linking company:",i),console.error("Error details:",i.message,i.details,i.hint),i;console.log("Company linked successfully, response:",n),await b(),l(""),m(!1),f({type:"success",text:"Company linked successfully"})}catch(t){console.error("Error linking company:",t),f({type:"error",text:`Failed to link company: ${t.message||"Unknown error"}`})}finally{p(!1)}};(0,t.useEffect)((()=>{h.text&&setTimeout((()=>{f({type:"",text:""})}),3e3)}),[h]);return(0,N.jsxs)(N.Fragment,{children:[(0,N.jsx)(ot(),{isOpen:o,onRequestClose:n,style:{content:{top:"50%",left:"50%",right:"auto",bottom:"auto",marginRight:"-50%",transform:"translate(-50%, -50%)",padding:"20px",border:"none",borderRadius:"0.5rem",boxShadow:"0 4px 6px rgba(0, 0, 0, 0.1)",maxWidth:"500px",width:"90%",minHeight:"360px"},overlay:{backgroundColor:"rgba(0, 0, 0, 0.5)",zIndex:1e3}},children:(0,N.jsxs)("div",{style:{padding:"1rem"},children:[(0,N.jsxs)(ao,{children:[(0,N.jsx)("h2",{children:r?"Manage Companies":"Create Company"}),(0,N.jsx)("button",{onClick:n,"aria-label":"Close modal",children:(0,N.jsx)(B.yGN,{size:20})})]}),(0,N.jsxs)(so,{children:[(0,N.jsx)(lo,{children:"Related Companies"}),(0,N.jsxs)(co,{children:[i.map((e=>{const t={bg:"#e0f2fe",text:"#0369a1"};return(0,N.jsxs)(uo,{color:t.bg,textColor:t.text,children:[(0,N.jsx)("span",{title:e.name,children:e.name.length>25?`${e.name.substring(0,25)}...`:e.name}),(0,N.jsx)("button",{onClick:()=>(async e=>{try{p(!0),console.log("Unlinking company from contact:",{contact_id:r.id,company_id:e.company_id,relation_id:e.id,company_name:e.name});const{data:t,error:o}=await D.supabase.from("contact_companies").delete().eq("id",e.id).select();if(o)throw console.error("Error unlinking company:",o),console.error("Error details:",o.message,o.details,o.hint),o;console.log("Company unlinked successfully, response:",t),a(i.filter((t=>t.id!==e.id))),f({type:"success",text:"Company unlinked successfully"})}catch(t){console.error("Error unlinking company:",t),f({type:"error",text:`Failed to unlink company: ${t.message||"Unknown error"}`})}finally{p(!1)}})(e),disabled:u,title:"Unlink company",children:(0,N.jsx)(B.yGN,{size:14})})]},e.id)})),0===i.length&&(0,N.jsx)("span",{style:{color:"#6c757d",fontStyle:"italic",padding:"4px"},children:"No companies linked"})]})]}),(0,N.jsxs)(so,{children:[(0,N.jsx)(lo,{children:"Add Companies"}),(0,N.jsx)(wo,{style:{width:"87%"},children:(0,N.jsxs)(po,{style:{width:"100%"},children:[(0,N.jsx)(ho,{children:(0,N.jsx)(B.CKj,{size:16})}),(0,N.jsx)(fo,{type:"text",value:s,onChange:e=>l(e.target.value),placeholder:"Search for a company (type at least 3 letters)..."})]})}),g&&(0,N.jsxs)(go,{children:[c.map((e=>(0,N.jsxs)(mo,{onClick:()=>w(e),disabled:u,children:[e.name,e.website&&(0,N.jsx)("span",{style:{fontSize:"0.75rem",color:"#6b7280"},children:e.website})]},e.id))),0===c.length&&s.length>=3&&(0,N.jsx)("div",{style:{padding:"8px 12px",color:"#6c757d",fontSize:"0.875rem"},children:"No companies found"}),s.length>=3&&(0,N.jsxs)(yo,{onClick:()=>v(!0),disabled:u,children:[(0,N.jsx)(B.GGD,{size:14}),"Create new company"]})]})]}),h.text&&(0,N.jsx)(vo,{className:h.type,children:h.text}),(0,N.jsx)(bo,{children:(0,N.jsx)(xo,{className:"primary",onClick:n,children:"Done"})}),u&&(0,N.jsx)("div",{style:{textAlign:"center",marginTop:"10px"},children:(0,N.jsx)("div",{className:"spinner",style:{width:"20px",height:"20px",border:"3px solid #f3f3f3",borderTop:"3px solid #000000",borderRadius:"50%",animation:"spin 1s linear infinite"}})})]})}),(0,N.jsx)(To,{isOpen:y,onClose:()=>v(!1),onSave:e=>{if(!r)return f({type:"success",text:"Company created successfully"}),void setTimeout((()=>{n()}),1500);w(e)}})]})},Po=document.createElement("style");Po.innerHTML="\n  @keyframes spin {\n    0% { transform: rotate(0deg); }\n    100% { transform: rotate(360deg); }\n  }\n",document.head.appendChild(Po);var No=o(6688);function Io(e){return(0,No.k5)({tag:"svg",attr:{role:"img",viewBox:"0 0 24 24"},child:[{tag:"title",attr:{},child:[]},{tag:"path",attr:{d:"M11.992 1.966c-.434 0-.87.086-1.28.257L1.779 5.917c-.503.208-.49.908.012 1.116l8.982 3.558a3.266 3.266 0 0 0 2.454 0l8.982-3.558c.503-.196.503-.908.012-1.116l-8.957-3.694a3.255 3.255 0 0 0-1.272-.257zM23.4 8.056a.589.589 0 0 0-.222.045l-10.012 3.877a.612.612 0 0 0-.38.564v8.896a.6.6 0 0 0 .821.552L23.62 18.1a.583.583 0 0 0 .38-.551V8.653a.6.6 0 0 0-.6-.596zM.676 8.095a.644.644 0 0 0-.48.19C.086 8.396 0 8.53 0 8.69v8.355c0 .442.515.737.908.54l6.27-3.006.307-.147 2.969-1.436c.466-.22.43-.908-.061-1.092L.883 8.138a.57.57 0 0 0-.207-.044z"}}]})(e)}function Mo(e){return(0,No.k5)({tag:"svg",attr:{role:"img",viewBox:"0 0 24 24"},child:[{tag:"title",attr:{},child:[]},{tag:"path",attr:{d:"M18.164 7.93V5.084a2.198 2.198 0 001.267-1.978v-.067A2.2 2.2 0 0017.238.845h-.067a2.2 2.2 0 00-2.193 2.193v.067a2.196 2.196 0 001.252 1.973l.013.006v2.852a6.22 6.22 0 00-2.969 1.31l.012-.01-7.828-6.095A2.497 2.497 0 104.3 4.656l-.012.006 7.697 5.991a6.176 6.176 0 00-1.038 3.446c0 1.343.425 2.588 1.147 3.607l-.013-.02-2.342 2.343a1.968 1.968 0 00-.58-.095h-.002a2.033 2.033 0 102.033 2.033 1.978 1.978 0 00-.1-.595l.005.014 2.317-2.317a6.247 6.247 0 104.782-11.134l-.036-.005zm-.964 9.378a3.206 3.206 0 113.215-3.207v.002a3.206 3.206 0 01-3.207 3.207z"}}]})(e)}var Lo=o(1292),Fo=o(3237);function Go(e){this.content=e}Go.prototype={constructor:Go,find:function(e){for(var t=0;t<this.content.length;t+=2)if(this.content[t]===e)return t;return-1},get:function(e){var t=this.find(e);return-1==t?void 0:this.content[t+1]},update:function(e,t,o){var n=o&&o!=e?this.remove(o):this,r=n.find(e),i=n.content.slice();return-1==r?i.push(o||e,t):(i[r+1]=t,o&&(i[r]=o)),new Go(i)},remove:function(e){var t=this.find(e);if(-1==t)return this;var o=this.content.slice();return o.splice(t,2),new Go(o)},addToStart:function(e,t){return new Go([e,t].concat(this.remove(e).content))},addToEnd:function(e,t){var o=this.remove(e).content.slice();return o.push(e,t),new Go(o)},addBefore:function(e,t,o){var n=this.remove(t),r=n.content.slice(),i=n.find(e);return r.splice(-1==i?r.length:i,0,t,o),new Go(r)},forEach:function(e){for(var t=0;t<this.content.length;t+=2)e(this.content[t],this.content[t+1])},prepend:function(e){return(e=Go.from(e)).size?new Go(e.content.concat(this.subtract(e).content)):this},append:function(e){return(e=Go.from(e)).size?new Go(this.subtract(e).content.concat(e.content)):this},subtract:function(e){var t=this;e=Go.from(e);for(var o=0;o<e.content.length;o+=2)t=t.remove(e.content[o]);return t},toObject:function(){var e={};return this.forEach((function(t,o){e[t]=o})),e},get size(){return this.content.length>>1}},Go.from=function(e){if(e instanceof Go)return e;var t=[];if(e)for(var o in e)t.push(o,e[o]);return new Go(t)};const zo=Go;function Ho(e,t,o){for(let n=0;;n++){if(n==e.childCount||n==t.childCount)return e.childCount==t.childCount?null:o;let r=e.child(n),i=t.child(n);if(r!=i){if(!r.sameMarkup(i))return o;if(r.isText&&r.text!=i.text){for(let e=0;r.text[e]==i.text[e];e++)o++;return o}if(r.content.size||i.content.size){let e=Ho(r.content,i.content,o+1);if(null!=e)return e}o+=r.nodeSize}else o+=r.nodeSize}}function Bo(e,t,o,n){for(let r=e.childCount,i=t.childCount;;){if(0==r||0==i)return r==i?null:{a:o,b:n};let a=e.child(--r),s=t.child(--i),l=a.nodeSize;if(a!=s){if(!a.sameMarkup(s))return{a:o,b:n};if(a.isText&&a.text!=s.text){let e=0,t=Math.min(a.text.length,s.text.length);for(;e<t&&a.text[a.text.length-e-1]==s.text[s.text.length-e-1];)e++,o--,n--;return{a:o,b:n}}if(a.content.size||s.content.size){let e=Bo(a.content,s.content,o-1,n-1);if(e)return e}o-=l,n-=l}else o-=l,n-=l}}class Vo{constructor(e,t){if(this.content=e,this.size=t||0,null==t)for(let o=0;o<e.length;o++)this.size+=e[o].nodeSize}nodesBetween(e,t,o){let n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,r=arguments.length>4?arguments[4]:void 0;for(let i=0,a=0;a<t;i++){let s=this.content[i],l=a+s.nodeSize;if(l>e&&!1!==o(s,n+a,r||null,i)&&s.content.size){let r=a+1;s.nodesBetween(Math.max(0,e-r),Math.min(s.content.size,t-r),o,n+r)}a=l}}descendants(e){this.nodesBetween(0,this.size,e)}textBetween(e,t,o,n){let r="",i=!0;return this.nodesBetween(e,t,((a,s)=>{let l=a.isText?a.text.slice(Math.max(e,s)-s,t-s):a.isLeaf?n?"function"===typeof n?n(a):n:a.type.spec.leafText?a.type.spec.leafText(a):"":"";a.isBlock&&(a.isLeaf&&l||a.isTextblock)&&o&&(i?i=!1:r+=o),r+=l}),0),r}append(e){if(!e.size)return this;if(!this.size)return e;let t=this.lastChild,o=e.firstChild,n=this.content.slice(),r=0;for(t.isText&&t.sameMarkup(o)&&(n[n.length-1]=t.withText(t.text+o.text),r=1);r<e.content.length;r++)n.push(e.content[r]);return new Vo(n,this.size+e.size)}cut(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.size;if(0==e&&t==this.size)return this;let o=[],n=0;if(t>e)for(let r=0,i=0;i<t;r++){let a=this.content[r],s=i+a.nodeSize;s>e&&((i<e||s>t)&&(a=a.isText?a.cut(Math.max(0,e-i),Math.min(a.text.length,t-i)):a.cut(Math.max(0,e-i-1),Math.min(a.content.size,t-i-1))),o.push(a),n+=a.nodeSize),i=s}return new Vo(o,n)}cutByIndex(e,t){return e==t?Vo.empty:0==e&&t==this.content.length?this:new Vo(this.content.slice(e,t))}replaceChild(e,t){let o=this.content[e];if(o==t)return this;let n=this.content.slice(),r=this.size+t.nodeSize-o.nodeSize;return n[e]=t,new Vo(n,r)}addToStart(e){return new Vo([e].concat(this.content),this.size+e.nodeSize)}addToEnd(e){return new Vo(this.content.concat(e),this.size+e.nodeSize)}eq(e){if(this.content.length!=e.content.length)return!1;for(let t=0;t<this.content.length;t++)if(!this.content[t].eq(e.content[t]))return!1;return!0}get firstChild(){return this.content.length?this.content[0]:null}get lastChild(){return this.content.length?this.content[this.content.length-1]:null}get childCount(){return this.content.length}child(e){let t=this.content[e];if(!t)throw new RangeError("Index "+e+" out of range for "+this);return t}maybeChild(e){return this.content[e]||null}forEach(e){for(let t=0,o=0;t<this.content.length;t++){let n=this.content[t];e(n,o,t),o+=n.nodeSize}}findDiffStart(e){return Ho(this,e,arguments.length>1&&void 0!==arguments[1]?arguments[1]:0)}findDiffEnd(e){return Bo(this,e,arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.size,arguments.length>2&&void 0!==arguments[2]?arguments[2]:e.size)}findIndex(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:-1;if(0==e)return Uo(0,e);if(e==this.size)return Uo(this.content.length,e);if(e>this.size||e<0)throw new RangeError(`Position ${e} outside of fragment (${this})`);for(let o=0,n=0;;o++){let r=n+this.child(o).nodeSize;if(r>=e)return r==e||t>0?Uo(o+1,r):Uo(o,n);n=r}}toString(){return"<"+this.toStringInner()+">"}toStringInner(){return this.content.join(", ")}toJSON(){return this.content.length?this.content.map((e=>e.toJSON())):null}static fromJSON(e,t){if(!t)return Vo.empty;if(!Array.isArray(t))throw new RangeError("Invalid input for Fragment.fromJSON");return new Vo(t.map(e.nodeFromJSON))}static fromArray(e){if(!e.length)return Vo.empty;let t,o=0;for(let n=0;n<e.length;n++){let r=e[n];o+=r.nodeSize,n&&r.isText&&e[n-1].sameMarkup(r)?(t||(t=e.slice(0,n)),t[t.length-1]=r.withText(t[t.length-1].text+r.text)):t&&t.push(r)}return new Vo(t||e,o)}static from(e){if(!e)return Vo.empty;if(e instanceof Vo)return e;if(Array.isArray(e))return this.fromArray(e);if(e.attrs)return new Vo([e],e.nodeSize);throw new RangeError("Can not convert "+e+" to a Fragment"+(e.nodesBetween?" (looks like multiple versions of prosemirror-model were loaded)":""))}}Vo.empty=new Vo([],0);const $o={index:0,offset:0};function Uo(e,t){return $o.index=e,$o.offset=t,$o}function Wo(e,t){if(e===t)return!0;if(!e||"object"!=typeof e||!t||"object"!=typeof t)return!1;let o=Array.isArray(e);if(Array.isArray(t)!=o)return!1;if(o){if(e.length!=t.length)return!1;for(let o=0;o<e.length;o++)if(!Wo(e[o],t[o]))return!1}else{for(let o in e)if(!(o in t)||!Wo(e[o],t[o]))return!1;for(let o in t)if(!(o in e))return!1}return!0}class qo{constructor(e,t){this.type=e,this.attrs=t}addToSet(e){let t,o=!1;for(let n=0;n<e.length;n++){let r=e[n];if(this.eq(r))return e;if(this.type.excludes(r.type))t||(t=e.slice(0,n));else{if(r.type.excludes(this.type))return e;!o&&r.type.rank>this.type.rank&&(t||(t=e.slice(0,n)),t.push(this),o=!0),t&&t.push(r)}}return t||(t=e.slice()),o||t.push(this),t}removeFromSet(e){for(let t=0;t<e.length;t++)if(this.eq(e[t]))return e.slice(0,t).concat(e.slice(t+1));return e}isInSet(e){for(let t=0;t<e.length;t++)if(this.eq(e[t]))return!0;return!1}eq(e){return this==e||this.type==e.type&&Wo(this.attrs,e.attrs)}toJSON(){let e={type:this.type.name};for(let t in this.attrs){e.attrs=this.attrs;break}return e}static fromJSON(e,t){if(!t)throw new RangeError("Invalid input for Mark.fromJSON");let o=e.marks[t.type];if(!o)throw new RangeError(`There is no mark type ${t.type} in this schema`);let n=o.create(t.attrs);return o.checkAttrs(n.attrs),n}static sameSet(e,t){if(e==t)return!0;if(e.length!=t.length)return!1;for(let o=0;o<e.length;o++)if(!e[o].eq(t[o]))return!1;return!0}static setFrom(e){if(!e||Array.isArray(e)&&0==e.length)return qo.none;if(e instanceof qo)return[e];let t=e.slice();return t.sort(((e,t)=>e.type.rank-t.type.rank)),t}}qo.none=[];class Ko extends Error{}class Yo{constructor(e,t,o){this.content=e,this.openStart=t,this.openEnd=o}get size(){return this.content.size-this.openStart-this.openEnd}insertAt(e,t){let o=Xo(this.content,e+this.openStart,t);return o&&new Yo(o,this.openStart,this.openEnd)}removeBetween(e,t){return new Yo(Jo(this.content,e+this.openStart,t+this.openStart),this.openStart,this.openEnd)}eq(e){return this.content.eq(e.content)&&this.openStart==e.openStart&&this.openEnd==e.openEnd}toString(){return this.content+"("+this.openStart+","+this.openEnd+")"}toJSON(){if(!this.content.size)return null;let e={content:this.content.toJSON()};return this.openStart>0&&(e.openStart=this.openStart),this.openEnd>0&&(e.openEnd=this.openEnd),e}static fromJSON(e,t){if(!t)return Yo.empty;let o=t.openStart||0,n=t.openEnd||0;if("number"!=typeof o||"number"!=typeof n)throw new RangeError("Invalid input for Slice.fromJSON");return new Yo(Vo.fromJSON(e,t.content),o,n)}static maxOpen(e){let t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],o=0,n=0;for(let r=e.firstChild;r&&!r.isLeaf&&(t||!r.type.spec.isolating);r=r.firstChild)o++;for(let r=e.lastChild;r&&!r.isLeaf&&(t||!r.type.spec.isolating);r=r.lastChild)n++;return new Yo(e,o,n)}}function Jo(e,t,o){let{index:n,offset:r}=e.findIndex(t),i=e.maybeChild(n),{index:a,offset:s}=e.findIndex(o);if(r==t||i.isText){if(s!=o&&!e.child(a).isText)throw new RangeError("Removing non-flat range");return e.cut(0,t).append(e.cut(o))}if(n!=a)throw new RangeError("Removing non-flat range");return e.replaceChild(n,i.copy(Jo(i.content,t-r-1,o-r-1)))}function Xo(e,t,o,n){let{index:r,offset:i}=e.findIndex(t),a=e.maybeChild(r);if(i==t||a.isText)return n&&!n.canReplace(r,r,o)?null:e.cut(0,t).append(o).append(e.cut(t));let s=Xo(a.content,t-i-1,o);return s&&e.replaceChild(r,a.copy(s))}function Qo(e,t,o){if(o.openStart>e.depth)throw new Ko("Inserted content deeper than insertion position");if(e.depth-o.openStart!=t.depth-o.openEnd)throw new Ko("Inconsistent open depths");return Zo(e,t,o,0)}function Zo(e,t,o,n){let r=e.index(n),i=e.node(n);if(r==t.index(n)&&n<e.depth-o.openStart){let a=Zo(e,t,o,n+1);return i.copy(i.content.replaceChild(r,a))}if(o.content.size){if(o.openStart||o.openEnd||e.depth!=n||t.depth!=n){let{start:r,end:a}=function(e,t){let o=t.depth-e.openStart,n=t.node(o).copy(e.content);for(let r=o-1;r>=0;r--)n=t.node(r).copy(Vo.from(n));return{start:n.resolveNoCache(e.openStart+o),end:n.resolveNoCache(n.content.size-e.openEnd-o)}}(o,e);return rn(i,an(e,r,a,t,n))}{let n=e.parent,r=n.content;return rn(n,r.cut(0,e.parentOffset).append(o.content).append(r.cut(t.parentOffset)))}}return rn(i,sn(e,t,n))}function en(e,t){if(!t.type.compatibleContent(e.type))throw new Ko("Cannot join "+t.type.name+" onto "+e.type.name)}function tn(e,t,o){let n=e.node(o);return en(n,t.node(o)),n}function on(e,t){let o=t.length-1;o>=0&&e.isText&&e.sameMarkup(t[o])?t[o]=e.withText(t[o].text+e.text):t.push(e)}function nn(e,t,o,n){let r=(t||e).node(o),i=0,a=t?t.index(o):r.childCount;e&&(i=e.index(o),e.depth>o?i++:e.textOffset&&(on(e.nodeAfter,n),i++));for(let s=i;s<a;s++)on(r.child(s),n);t&&t.depth==o&&t.textOffset&&on(t.nodeBefore,n)}function rn(e,t){return e.type.checkContent(t),e.copy(t)}function an(e,t,o,n,r){let i=e.depth>r&&tn(e,t,r+1),a=n.depth>r&&tn(o,n,r+1),s=[];return nn(null,e,r,s),i&&a&&t.index(r)==o.index(r)?(en(i,a),on(rn(i,an(e,t,o,n,r+1)),s)):(i&&on(rn(i,sn(e,t,r+1)),s),nn(t,o,r,s),a&&on(rn(a,sn(o,n,r+1)),s)),nn(n,null,r,s),new Vo(s)}function sn(e,t,o){let n=[];if(nn(null,e,o,n),e.depth>o){on(rn(tn(e,t,o+1),sn(e,t,o+1)),n)}return nn(t,null,o,n),new Vo(n)}Yo.empty=new Yo(Vo.empty,0,0);class ln{constructor(e,t,o){this.pos=e,this.path=t,this.parentOffset=o,this.depth=t.length/3-1}resolveDepth(e){return null==e?this.depth:e<0?this.depth+e:e}get parent(){return this.node(this.depth)}get doc(){return this.node(0)}node(e){return this.path[3*this.resolveDepth(e)]}index(e){return this.path[3*this.resolveDepth(e)+1]}indexAfter(e){return e=this.resolveDepth(e),this.index(e)+(e!=this.depth||this.textOffset?1:0)}start(e){return 0==(e=this.resolveDepth(e))?0:this.path[3*e-1]+1}end(e){return e=this.resolveDepth(e),this.start(e)+this.node(e).content.size}before(e){if(!(e=this.resolveDepth(e)))throw new RangeError("There is no position before the top-level node");return e==this.depth+1?this.pos:this.path[3*e-1]}after(e){if(!(e=this.resolveDepth(e)))throw new RangeError("There is no position after the top-level node");return e==this.depth+1?this.pos:this.path[3*e-1]+this.path[3*e].nodeSize}get textOffset(){return this.pos-this.path[this.path.length-1]}get nodeAfter(){let e=this.parent,t=this.index(this.depth);if(t==e.childCount)return null;let o=this.pos-this.path[this.path.length-1],n=e.child(t);return o?e.child(t).cut(o):n}get nodeBefore(){let e=this.index(this.depth),t=this.pos-this.path[this.path.length-1];return t?this.parent.child(e).cut(0,t):0==e?null:this.parent.child(e-1)}posAtIndex(e,t){t=this.resolveDepth(t);let o=this.path[3*t],n=0==t?0:this.path[3*t-1]+1;for(let r=0;r<e;r++)n+=o.child(r).nodeSize;return n}marks(){let e=this.parent,t=this.index();if(0==e.content.size)return qo.none;if(this.textOffset)return e.child(t).marks;let o=e.maybeChild(t-1),n=e.maybeChild(t);if(!o){let e=o;o=n,n=e}let r=o.marks;for(var i=0;i<r.length;i++)!1!==r[i].type.spec.inclusive||n&&r[i].isInSet(n.marks)||(r=r[i--].removeFromSet(r));return r}marksAcross(e){let t=this.parent.maybeChild(this.index());if(!t||!t.isInline)return null;let o=t.marks,n=e.parent.maybeChild(e.index());for(var r=0;r<o.length;r++)!1!==o[r].type.spec.inclusive||n&&o[r].isInSet(n.marks)||(o=o[r--].removeFromSet(o));return o}sharedDepth(e){for(let t=this.depth;t>0;t--)if(this.start(t)<=e&&this.end(t)>=e)return t;return 0}blockRange(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this,t=arguments.length>1?arguments[1]:void 0;if(e.pos<this.pos)return e.blockRange(this);for(let o=this.depth-(this.parent.inlineContent||this.pos==e.pos?1:0);o>=0;o--)if(e.pos<=this.end(o)&&(!t||t(this.node(o))))return new pn(this,e,o);return null}sameParent(e){return this.pos-this.parentOffset==e.pos-e.parentOffset}max(e){return e.pos>this.pos?e:this}min(e){return e.pos<this.pos?e:this}toString(){let e="";for(let t=1;t<=this.depth;t++)e+=(e?"/":"")+this.node(t).type.name+"_"+this.index(t-1);return e+":"+this.parentOffset}static resolve(e,t){if(!(t>=0&&t<=e.content.size))throw new RangeError("Position "+t+" out of range");let o=[],n=0,r=t;for(let i=e;;){let{index:e,offset:t}=i.content.findIndex(r),a=r-t;if(o.push(i,e,n+t),!a)break;if(i=i.child(e),i.isText)break;r=a-1,n+=t+1}return new ln(t,o,r)}static resolveCached(e,t){let o=un.get(e);if(o)for(let r=0;r<o.elts.length;r++){let e=o.elts[r];if(e.pos==t)return e}else un.set(e,o=new cn);let n=o.elts[o.i]=ln.resolve(e,t);return o.i=(o.i+1)%dn,n}}class cn{constructor(){this.elts=[],this.i=0}}const dn=12,un=new WeakMap;class pn{constructor(e,t,o){this.$from=e,this.$to=t,this.depth=o}get start(){return this.$from.before(this.depth+1)}get end(){return this.$to.after(this.depth+1)}get parent(){return this.$from.node(this.depth)}get startIndex(){return this.$from.index(this.depth)}get endIndex(){return this.$to.indexAfter(this.depth)}}const hn=Object.create(null);class fn{constructor(e,t,o){let n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:qo.none;this.type=e,this.attrs=t,this.marks=n,this.content=o||Vo.empty}get children(){return this.content.content}get nodeSize(){return this.isLeaf?1:2+this.content.size}get childCount(){return this.content.childCount}child(e){return this.content.child(e)}maybeChild(e){return this.content.maybeChild(e)}forEach(e){this.content.forEach(e)}nodesBetween(e,t,o){let n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0;this.content.nodesBetween(e,t,o,n,this)}descendants(e){this.nodesBetween(0,this.content.size,e)}get textContent(){return this.isLeaf&&this.type.spec.leafText?this.type.spec.leafText(this):this.textBetween(0,this.content.size,"")}textBetween(e,t,o,n){return this.content.textBetween(e,t,o,n)}get firstChild(){return this.content.firstChild}get lastChild(){return this.content.lastChild}eq(e){return this==e||this.sameMarkup(e)&&this.content.eq(e.content)}sameMarkup(e){return this.hasMarkup(e.type,e.attrs,e.marks)}hasMarkup(e,t,o){return this.type==e&&Wo(this.attrs,t||e.defaultAttrs||hn)&&qo.sameSet(this.marks,o||qo.none)}copy(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;return e==this.content?this:new fn(this.type,this.attrs,e,this.marks)}mark(e){return e==this.marks?this:new fn(this.type,this.attrs,this.content,e)}cut(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.content.size;return 0==e&&t==this.content.size?this:this.copy(this.content.cut(e,t))}slice(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.content.size,o=arguments.length>2&&void 0!==arguments[2]&&arguments[2];if(e==t)return Yo.empty;let n=this.resolve(e),r=this.resolve(t),i=o?0:n.sharedDepth(t),a=n.start(i),s=n.node(i).content.cut(n.pos-a,r.pos-a);return new Yo(s,n.depth-i,r.depth-i)}replace(e,t,o){return Qo(this.resolve(e),this.resolve(t),o)}nodeAt(e){for(let t=this;;){let{index:o,offset:n}=t.content.findIndex(e);if(t=t.maybeChild(o),!t)return null;if(n==e||t.isText)return t;e-=n+1}}childAfter(e){let{index:t,offset:o}=this.content.findIndex(e);return{node:this.content.maybeChild(t),index:t,offset:o}}childBefore(e){if(0==e)return{node:null,index:0,offset:0};let{index:t,offset:o}=this.content.findIndex(e);if(o<e)return{node:this.content.child(t),index:t,offset:o};let n=this.content.child(t-1);return{node:n,index:t-1,offset:o-n.nodeSize}}resolve(e){return ln.resolveCached(this,e)}resolveNoCache(e){return ln.resolve(this,e)}rangeHasMark(e,t,o){let n=!1;return t>e&&this.nodesBetween(e,t,(e=>(o.isInSet(e.marks)&&(n=!0),!n))),n}get isBlock(){return this.type.isBlock}get isTextblock(){return this.type.isTextblock}get inlineContent(){return this.type.inlineContent}get isInline(){return this.type.isInline}get isText(){return this.type.isText}get isLeaf(){return this.type.isLeaf}get isAtom(){return this.type.isAtom}toString(){if(this.type.spec.toDebugString)return this.type.spec.toDebugString(this);let e=this.type.name;return this.content.size&&(e+="("+this.content.toStringInner()+")"),mn(this.marks,e)}contentMatchAt(e){let t=this.type.contentMatch.matchFragment(this.content,0,e);if(!t)throw new Error("Called contentMatchAt on a node with invalid content");return t}canReplace(e,t){let o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:Vo.empty,n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:o.childCount,i=this.contentMatchAt(e).matchFragment(o,n,r),a=i&&i.matchFragment(this.content,t);if(!a||!a.validEnd)return!1;for(let s=n;s<r;s++)if(!this.type.allowsMarks(o.child(s).marks))return!1;return!0}canReplaceWith(e,t,o,n){if(n&&!this.type.allowsMarks(n))return!1;let r=this.contentMatchAt(e).matchType(o),i=r&&r.matchFragment(this.content,t);return!!i&&i.validEnd}canAppend(e){return e.content.size?this.canReplace(this.childCount,this.childCount,e.content):this.type.compatibleContent(e.type)}check(){this.type.checkContent(this.content),this.type.checkAttrs(this.attrs);let e=qo.none;for(let t=0;t<this.marks.length;t++){let o=this.marks[t];o.type.checkAttrs(o.attrs),e=o.addToSet(e)}if(!qo.sameSet(e,this.marks))throw new RangeError(`Invalid collection of marks for node ${this.type.name}: ${this.marks.map((e=>e.type.name))}`);this.content.forEach((e=>e.check()))}toJSON(){let e={type:this.type.name};for(let t in this.attrs){e.attrs=this.attrs;break}return this.content.size&&(e.content=this.content.toJSON()),this.marks.length&&(e.marks=this.marks.map((e=>e.toJSON()))),e}static fromJSON(e,t){if(!t)throw new RangeError("Invalid input for Node.fromJSON");let o;if(t.marks){if(!Array.isArray(t.marks))throw new RangeError("Invalid mark data for Node.fromJSON");o=t.marks.map(e.markFromJSON)}if("text"==t.type){if("string"!=typeof t.text)throw new RangeError("Invalid text node in JSON");return e.text(t.text,o)}let n=Vo.fromJSON(e,t.content),r=e.nodeType(t.type).create(t.attrs,n,o);return r.type.checkAttrs(r.attrs),r}}fn.prototype.text=void 0;class gn extends fn{constructor(e,t,o,n){if(super(e,t,null,n),!o)throw new RangeError("Empty text nodes are not allowed");this.text=o}toString(){return this.type.spec.toDebugString?this.type.spec.toDebugString(this):mn(this.marks,JSON.stringify(this.text))}get textContent(){return this.text}textBetween(e,t){return this.text.slice(e,t)}get nodeSize(){return this.text.length}mark(e){return e==this.marks?this:new gn(this.type,this.attrs,this.text,e)}withText(e){return e==this.text?this:new gn(this.type,this.attrs,e,this.marks)}cut(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.text.length;return 0==e&&t==this.text.length?this:this.withText(this.text.slice(e,t))}eq(e){return this.sameMarkup(e)&&this.text==e.text}toJSON(){let e=super.toJSON();return e.text=this.text,e}}function mn(e,t){for(let o=e.length-1;o>=0;o--)t=e[o].type.name+"("+t+")";return t}class yn{constructor(e){this.validEnd=e,this.next=[],this.wrapCache=[]}static parse(e,t){let o=new vn(e,t);if(null==o.next)return yn.empty;let n=bn(o);o.next&&o.err("Unexpected trailing text");let r=function(e){let t=Object.create(null);return o(En(e,0));function o(n){let r=[];n.forEach((t=>{e[t].forEach((t=>{let o,{term:n,to:i}=t;if(n){for(let e=0;e<r.length;e++)r[e][0]==n&&(o=r[e][1]);En(e,i).forEach((e=>{o||r.push([n,o=[]]),-1==o.indexOf(e)&&o.push(e)}))}}))}));let i=t[n.join(",")]=new yn(n.indexOf(e.length-1)>-1);for(let e=0;e<r.length;e++){let n=r[e][1].sort(Sn);i.next.push({type:r[e][0],next:t[n.join(",")]||o(n)})}return i}}(function(e){let t=[[]];return r(i(e,0),o()),t;function o(){return t.push([])-1}function n(e,o,n){let r={term:n,to:o};return t[e].push(r),r}function r(e,t){e.forEach((e=>e.to=t))}function i(e,t){if("choice"==e.type)return e.exprs.reduce(((e,o)=>e.concat(i(o,t))),[]);if("seq"!=e.type){if("star"==e.type){let a=o();return n(t,a),r(i(e.expr,a),a),[n(a)]}if("plus"==e.type){let a=o();return r(i(e.expr,t),a),r(i(e.expr,a),a),[n(a)]}if("opt"==e.type)return[n(t)].concat(i(e.expr,t));if("range"==e.type){let a=t;for(let t=0;t<e.min;t++){let t=o();r(i(e.expr,a),t),a=t}if(-1==e.max)r(i(e.expr,a),a);else for(let t=e.min;t<e.max;t++){let t=o();n(a,t),r(i(e.expr,a),t),a=t}return[n(a)]}if("name"==e.type)return[n(t,void 0,e.value)];throw new Error("Unknown expr type")}for(let n=0;;n++){let a=i(e.exprs[n],t);if(n==e.exprs.length-1)return a;r(a,t=o())}}}(n));return function(e,t){for(let o=0,n=[e];o<n.length;o++){let e=n[o],r=!e.validEnd,i=[];for(let t=0;t<e.next.length;t++){let{type:o,next:a}=e.next[t];i.push(o.name),!r||o.isText||o.hasRequiredAttrs()||(r=!1),-1==n.indexOf(a)&&n.push(a)}r&&t.err("Only non-generatable nodes ("+i.join(", ")+") in a required position (see https://prosemirror.net/docs/guide/#generatable)")}}(r,o),r}matchType(e){for(let t=0;t<this.next.length;t++)if(this.next[t].type==e)return this.next[t].next;return null}matchFragment(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:e.childCount,n=this;for(let r=t;n&&r<o;r++)n=n.matchType(e.child(r).type);return n}get inlineContent(){return 0!=this.next.length&&this.next[0].type.isInline}get defaultType(){for(let e=0;e<this.next.length;e++){let{type:t}=this.next[e];if(!t.isText&&!t.hasRequiredAttrs())return t}return null}compatible(e){for(let t=0;t<this.next.length;t++)for(let o=0;o<e.next.length;o++)if(this.next[t].type==e.next[o].type)return!0;return!1}fillBefore(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,n=[this];return function r(i,a){let s=i.matchFragment(e,o);if(s&&(!t||s.validEnd))return Vo.from(a.map((e=>e.createAndFill())));for(let e=0;e<i.next.length;e++){let{type:t,next:o}=i.next[e];if(!t.isText&&!t.hasRequiredAttrs()&&-1==n.indexOf(o)){n.push(o);let e=r(o,a.concat(t));if(e)return e}}return null}(this,[])}findWrapping(e){for(let o=0;o<this.wrapCache.length;o+=2)if(this.wrapCache[o]==e)return this.wrapCache[o+1];let t=this.computeWrapping(e);return this.wrapCache.push(e,t),t}computeWrapping(e){let t=Object.create(null),o=[{match:this,type:null,via:null}];for(;o.length;){let n=o.shift(),r=n.match;if(r.matchType(e)){let e=[];for(let t=n;t.type;t=t.via)e.push(t.type);return e.reverse()}for(let e=0;e<r.next.length;e++){let{type:i,next:a}=r.next[e];i.isLeaf||i.hasRequiredAttrs()||i.name in t||n.type&&!a.validEnd||(o.push({match:i.contentMatch,type:i,via:n}),t[i.name]=!0)}}return null}get edgeCount(){return this.next.length}edge(e){if(e>=this.next.length)throw new RangeError(`There's no ${e}th edge in this content match`);return this.next[e]}toString(){let e=[];return function t(o){e.push(o);for(let n=0;n<o.next.length;n++)-1==e.indexOf(o.next[n].next)&&t(o.next[n].next)}(this),e.map(((t,o)=>{let n=o+(t.validEnd?"*":" ")+" ";for(let r=0;r<t.next.length;r++)n+=(r?", ":"")+t.next[r].type.name+"->"+e.indexOf(t.next[r].next);return n})).join("\n")}}yn.empty=new yn(!0);class vn{constructor(e,t){this.string=e,this.nodeTypes=t,this.inline=null,this.pos=0,this.tokens=e.split(/\s*(?=\b|\W|$)/),""==this.tokens[this.tokens.length-1]&&this.tokens.pop(),""==this.tokens[0]&&this.tokens.shift()}get next(){return this.tokens[this.pos]}eat(e){return this.next==e&&(this.pos++||!0)}err(e){throw new SyntaxError(e+" (in content expression '"+this.string+"')")}}function bn(e){let t=[];do{t.push(xn(e))}while(e.eat("|"));return 1==t.length?t[0]:{type:"choice",exprs:t}}function xn(e){let t=[];do{t.push(wn(e))}while(e.next&&")"!=e.next&&"|"!=e.next);return 1==t.length?t[0]:{type:"seq",exprs:t}}function wn(e){let t=function(e){if(e.eat("(")){let t=bn(e);return e.eat(")")||e.err("Missing closing paren"),t}if(!/\W/.test(e.next)){let t=function(e,t){let o=e.nodeTypes,n=o[t];if(n)return[n];let r=[];for(let i in o){let e=o[i];e.isInGroup(t)&&r.push(e)}0==r.length&&e.err("No node type or group '"+t+"' found");return r}(e,e.next).map((t=>(null==e.inline?e.inline=t.isInline:e.inline!=t.isInline&&e.err("Mixing inline and block content"),{type:"name",value:t})));return e.pos++,1==t.length?t[0]:{type:"choice",exprs:t}}e.err("Unexpected token '"+e.next+"'")}(e);for(;;)if(e.eat("+"))t={type:"plus",expr:t};else if(e.eat("*"))t={type:"star",expr:t};else if(e.eat("?"))t={type:"opt",expr:t};else{if(!e.eat("{"))break;t=_n(e,t)}return t}function Cn(e){/\D/.test(e.next)&&e.err("Expected number, got '"+e.next+"'");let t=Number(e.next);return e.pos++,t}function _n(e,t){let o=Cn(e),n=o;return e.eat(",")&&(n="}"!=e.next?Cn(e):-1),e.eat("}")||e.err("Unclosed braced range"),{type:"range",min:o,max:n,expr:t}}function Sn(e,t){return t-e}function En(e,t){let o=[];return function t(n){let r=e[n];if(1==r.length&&!r[0].term)return t(r[0].to);o.push(n);for(let e=0;e<r.length;e++){let{term:n,to:i}=r[e];n||-1!=o.indexOf(i)||t(i)}}(t),o.sort(Sn)}function kn(e){let t=Object.create(null);for(let o in e){let n=e[o];if(!n.hasDefault)return null;t[o]=n.default}return t}function jn(e,t){let o=Object.create(null);for(let n in e){let r=t&&t[n];if(void 0===r){let t=e[n];if(!t.hasDefault)throw new RangeError("No value supplied for attribute "+n);r=t.default}o[n]=r}return o}function An(e,t,o,n){for(let r in t)if(!(r in e))throw new RangeError(`Unsupported attribute ${r} for ${o} of type ${r}`);for(let r in e){let o=e[r];o.validate&&o.validate(t[r])}}function Rn(e,t){let o=Object.create(null);if(t)for(let n in t)o[n]=new Tn(e,n,t[n]);return o}class On{constructor(e,t,o){this.name=e,this.schema=t,this.spec=o,this.markSet=null,this.groups=o.group?o.group.split(" "):[],this.attrs=Rn(e,o.attrs),this.defaultAttrs=kn(this.attrs),this.contentMatch=null,this.inlineContent=null,this.isBlock=!(o.inline||"text"==e),this.isText="text"==e}get isInline(){return!this.isBlock}get isTextblock(){return this.isBlock&&this.inlineContent}get isLeaf(){return this.contentMatch==yn.empty}get isAtom(){return this.isLeaf||!!this.spec.atom}isInGroup(e){return this.groups.indexOf(e)>-1}get whitespace(){return this.spec.whitespace||(this.spec.code?"pre":"normal")}hasRequiredAttrs(){for(let e in this.attrs)if(this.attrs[e].isRequired)return!0;return!1}compatibleContent(e){return this==e||this.contentMatch.compatible(e.contentMatch)}computeAttrs(e){return!e&&this.defaultAttrs?this.defaultAttrs:jn(this.attrs,e)}create(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t=arguments.length>1?arguments[1]:void 0,o=arguments.length>2?arguments[2]:void 0;if(this.isText)throw new Error("NodeType.create can't construct text nodes");return new fn(this,this.computeAttrs(e),Vo.from(t),qo.setFrom(o))}createChecked(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t=arguments.length>1?arguments[1]:void 0,o=arguments.length>2?arguments[2]:void 0;return t=Vo.from(t),this.checkContent(t),new fn(this,this.computeAttrs(e),t,qo.setFrom(o))}createAndFill(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t=arguments.length>1?arguments[1]:void 0,o=arguments.length>2?arguments[2]:void 0;if(e=this.computeAttrs(e),t=Vo.from(t),t.size){let e=this.contentMatch.fillBefore(t);if(!e)return null;t=e.append(t)}let n=this.contentMatch.matchFragment(t),r=n&&n.fillBefore(Vo.empty,!0);return r?new fn(this,e,t.append(r),qo.setFrom(o)):null}validContent(e){let t=this.contentMatch.matchFragment(e);if(!t||!t.validEnd)return!1;for(let o=0;o<e.childCount;o++)if(!this.allowsMarks(e.child(o).marks))return!1;return!0}checkContent(e){if(!this.validContent(e))throw new RangeError(`Invalid content for node ${this.name}: ${e.toString().slice(0,50)}`)}checkAttrs(e){An(this.attrs,e,"node",this.name)}allowsMarkType(e){return null==this.markSet||this.markSet.indexOf(e)>-1}allowsMarks(e){if(null==this.markSet)return!0;for(let t=0;t<e.length;t++)if(!this.allowsMarkType(e[t].type))return!1;return!0}allowedMarks(e){if(null==this.markSet)return e;let t;for(let o=0;o<e.length;o++)this.allowsMarkType(e[o].type)?t&&t.push(e[o]):t||(t=e.slice(0,o));return t?t.length?t:qo.none:e}static compile(e,t){let o=Object.create(null);e.forEach(((e,n)=>o[e]=new On(e,t,n)));let n=t.spec.topNode||"doc";if(!o[n])throw new RangeError("Schema is missing its top node type ('"+n+"')");if(!o.text)throw new RangeError("Every schema needs a 'text' type");for(let r in o.text.attrs)throw new RangeError("The text node type should not have attributes");return o}}class Tn{constructor(e,t,o){this.hasDefault=Object.prototype.hasOwnProperty.call(o,"default"),this.default=o.default,this.validate="string"==typeof o.validate?function(e,t,o){let n=o.split("|");return o=>{let r=null===o?"null":typeof o;if(n.indexOf(r)<0)throw new RangeError(`Expected value of type ${n} for attribute ${t} on type ${e}, got ${r}`)}}(e,t,o.validate):o.validate}get isRequired(){return!this.hasDefault}}class Dn{constructor(e,t,o,n){this.name=e,this.rank=t,this.schema=o,this.spec=n,this.attrs=Rn(e,n.attrs),this.excluded=null;let r=kn(this.attrs);this.instance=r?new qo(this,r):null}create(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;return!e&&this.instance?this.instance:new qo(this,jn(this.attrs,e))}static compile(e,t){let o=Object.create(null),n=0;return e.forEach(((e,r)=>o[e]=new Dn(e,n++,t,r))),o}removeFromSet(e){for(var t=0;t<e.length;t++)e[t].type==this&&(e=e.slice(0,t).concat(e.slice(t+1)),t--);return e}isInSet(e){for(let t=0;t<e.length;t++)if(e[t].type==this)return e[t]}checkAttrs(e){An(this.attrs,e,"mark",this.name)}excludes(e){return this.excluded.indexOf(e)>-1}}class Pn{constructor(e){this.linebreakReplacement=null,this.cached=Object.create(null);let t=this.spec={};for(let n in e)t[n]=e[n];t.nodes=zo.from(e.nodes),t.marks=zo.from(e.marks||{}),this.nodes=On.compile(this.spec.nodes,this),this.marks=Dn.compile(this.spec.marks,this);let o=Object.create(null);for(let n in this.nodes){if(n in this.marks)throw new RangeError(n+" can not be both a node and a mark");let e=this.nodes[n],t=e.spec.content||"",r=e.spec.marks;if(e.contentMatch=o[t]||(o[t]=yn.parse(t,this.nodes)),e.inlineContent=e.contentMatch.inlineContent,e.spec.linebreakReplacement){if(this.linebreakReplacement)throw new RangeError("Multiple linebreak nodes defined");if(!e.isInline||!e.isLeaf)throw new RangeError("Linebreak replacement nodes must be inline leaf nodes");this.linebreakReplacement=e}e.markSet="_"==r?null:r?Nn(this,r.split(" ")):""!=r&&e.inlineContent?null:[]}for(let n in this.marks){let e=this.marks[n],t=e.spec.excludes;e.excluded=null==t?[e]:""==t?[]:Nn(this,t.split(" "))}this.nodeFromJSON=this.nodeFromJSON.bind(this),this.markFromJSON=this.markFromJSON.bind(this),this.topNodeType=this.nodes[this.spec.topNode||"doc"],this.cached.wrappings=Object.create(null)}node(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,o=arguments.length>2?arguments[2]:void 0,n=arguments.length>3?arguments[3]:void 0;if("string"==typeof e)e=this.nodeType(e);else{if(!(e instanceof On))throw new RangeError("Invalid node type: "+e);if(e.schema!=this)throw new RangeError("Node type from different schema used ("+e.name+")")}return e.createChecked(t,o,n)}text(e,t){let o=this.nodes.text;return new gn(o,o.defaultAttrs,e,qo.setFrom(t))}mark(e,t){return"string"==typeof e&&(e=this.marks[e]),e.create(t)}nodeFromJSON(e){return fn.fromJSON(this,e)}markFromJSON(e){return qo.fromJSON(this,e)}nodeType(e){let t=this.nodes[e];if(!t)throw new RangeError("Unknown node type: "+e);return t}}function Nn(e,t){let o=[];for(let n=0;n<t.length;n++){let r=t[n],i=e.marks[r],a=i;if(i)o.push(i);else for(let t in e.marks){let n=e.marks[t];("_"==r||n.spec.group&&n.spec.group.split(" ").indexOf(r)>-1)&&o.push(a=n)}if(!a)throw new SyntaxError("Unknown mark type: '"+t[n]+"'")}return o}class In{constructor(e,t){this.schema=e,this.rules=t,this.tags=[],this.styles=[];let o=this.matchedStyles=[];t.forEach((e=>{if(function(e){return null!=e.tag}(e))this.tags.push(e);else if(function(e){return null!=e.style}(e)){let t=/[^=]*/.exec(e.style)[0];o.indexOf(t)<0&&o.push(t),this.styles.push(e)}})),this.normalizeLists=!this.tags.some((t=>{if(!/^(ul|ol)\b/.test(t.tag)||!t.node)return!1;let o=e.nodes[t.node];return o.contentMatch.matchType(o)}))}parse(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},o=new Hn(this,t,!1);return o.addAll(e,qo.none,t.from,t.to),o.finish()}parseSlice(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},o=new Hn(this,t,!0);return o.addAll(e,qo.none,t.from,t.to),Yo.maxOpen(o.finish())}matchTag(e,t,o){for(let n=o?this.tags.indexOf(o)+1:0;n<this.tags.length;n++){let o=this.tags[n];if(Bn(e,o.tag)&&(void 0===o.namespace||e.namespaceURI==o.namespace)&&(!o.context||t.matchesContext(o.context))){if(o.getAttrs){let t=o.getAttrs(e);if(!1===t)continue;o.attrs=t||void 0}return o}}}matchStyle(e,t,o,n){for(let r=n?this.styles.indexOf(n)+1:0;r<this.styles.length;r++){let n=this.styles[r],i=n.style;if(!(0!=i.indexOf(e)||n.context&&!o.matchesContext(n.context)||i.length>e.length&&(61!=i.charCodeAt(e.length)||i.slice(e.length+1)!=t))){if(n.getAttrs){let e=n.getAttrs(t);if(!1===e)continue;n.attrs=e||void 0}return n}}}static schemaRules(e){let t=[];function o(e){let o=null==e.priority?50:e.priority,n=0;for(;n<t.length;n++){let e=t[n];if((null==e.priority?50:e.priority)<o)break}t.splice(n,0,e)}for(let n in e.marks){let t=e.marks[n].spec.parseDOM;t&&t.forEach((e=>{o(e=Vn(e)),e.mark||e.ignore||e.clearMark||(e.mark=n)}))}for(let n in e.nodes){let t=e.nodes[n].spec.parseDOM;t&&t.forEach((e=>{o(e=Vn(e)),e.node||e.ignore||e.mark||(e.node=n)}))}return t}static fromSchema(e){return e.cached.domParser||(e.cached.domParser=new In(e,In.schemaRules(e)))}}const Mn={address:!0,article:!0,aside:!0,blockquote:!0,canvas:!0,dd:!0,div:!0,dl:!0,fieldset:!0,figcaption:!0,figure:!0,footer:!0,form:!0,h1:!0,h2:!0,h3:!0,h4:!0,h5:!0,h6:!0,header:!0,hgroup:!0,hr:!0,li:!0,noscript:!0,ol:!0,output:!0,p:!0,pre:!0,section:!0,table:!0,tfoot:!0,ul:!0},Ln={head:!0,noscript:!0,object:!0,script:!0,style:!0,title:!0},Fn={ol:!0,ul:!0};function Gn(e,t,o){return null!=t?(t?1:0)|("full"===t?2:0):e&&"pre"==e.whitespace?3:-5&o}class zn{constructor(e,t,o,n,r,i){this.type=e,this.attrs=t,this.marks=o,this.solid=n,this.options=i,this.content=[],this.activeMarks=qo.none,this.match=r||(4&i?null:e.contentMatch)}findWrapping(e){if(!this.match){if(!this.type)return[];let t=this.type.contentMatch.fillBefore(Vo.from(e));if(!t){let t,o=this.type.contentMatch;return(t=o.findWrapping(e.type))?(this.match=o,t):null}this.match=this.type.contentMatch.matchFragment(t)}return this.match.findWrapping(e.type)}finish(e){if(!(1&this.options)){let e,t=this.content[this.content.length-1];if(t&&t.isText&&(e=/[ \t\r\n\u000c]+$/.exec(t.text))){let o=t;t.text.length==e[0].length?this.content.pop():this.content[this.content.length-1]=o.withText(o.text.slice(0,o.text.length-e[0].length))}}let t=Vo.from(this.content);return!e&&this.match&&(t=t.append(this.match.fillBefore(Vo.empty,!0))),this.type?this.type.create(this.attrs,t,this.marks):t}inlineContext(e){return this.type?this.type.inlineContent:this.content.length?this.content[0].isInline:e.parentNode&&!Mn.hasOwnProperty(e.parentNode.nodeName.toLowerCase())}}class Hn{constructor(e,t,o){this.parser=e,this.options=t,this.isOpen=o,this.open=0,this.localPreserveWS=!1;let n,r=t.topNode,i=Gn(null,t.preserveWhitespace,0)|(o?4:0);n=r?new zn(r.type,r.attrs,qo.none,!0,t.topMatch||r.type.contentMatch,i):new zn(o?null:e.schema.topNodeType,null,qo.none,!0,null,i),this.nodes=[n],this.find=t.findPositions,this.needsBlock=!1}get top(){return this.nodes[this.open]}addDOM(e,t){3==e.nodeType?this.addTextNode(e,t):1==e.nodeType&&this.addElement(e,t)}addTextNode(e,t){let o=e.nodeValue,n=this.top,r=2&n.options?"full":this.localPreserveWS||(1&n.options)>0;if("full"===r||n.inlineContext(e)||/[^ \t\r\n\u000c]/.test(o)){if(r)o="full"!==r?o.replace(/\r?\n|\r/g," "):o.replace(/\r\n?/g,"\n");else if(o=o.replace(/[ \t\r\n\u000c]+/g," "),/^[ \t\r\n\u000c]/.test(o)&&this.open==this.nodes.length-1){let t=n.content[n.content.length-1],r=e.previousSibling;(!t||r&&"BR"==r.nodeName||t.isText&&/[ \t\r\n\u000c]$/.test(t.text))&&(o=o.slice(1))}o&&this.insertNode(this.parser.schema.text(o),t),this.findInText(e)}else this.findInside(e)}addElement(e,t,o){let n=this.localPreserveWS,r=this.top;("PRE"==e.tagName||/pre/.test(e.style&&e.style.whiteSpace))&&(this.localPreserveWS=!0);let i,a=e.nodeName.toLowerCase();Fn.hasOwnProperty(a)&&this.parser.normalizeLists&&function(e){for(let t=e.firstChild,o=null;t;t=t.nextSibling){let e=1==t.nodeType?t.nodeName.toLowerCase():null;e&&Fn.hasOwnProperty(e)&&o?(o.appendChild(t),t=o):"li"==e?o=t:e&&(o=null)}}(e);let s=this.options.ruleFromNode&&this.options.ruleFromNode(e)||(i=this.parser.matchTag(e,this,o));e:if(s?s.ignore:Ln.hasOwnProperty(a))this.findInside(e),this.ignoreFallback(e,t);else if(!s||s.skip||s.closeParent){s&&s.closeParent?this.open=Math.max(0,this.open-1):s&&s.skip.nodeType&&(e=s.skip);let o,n=this.needsBlock;if(Mn.hasOwnProperty(a))r.content.length&&r.content[0].isInline&&this.open&&(this.open--,r=this.top),o=!0,r.type||(this.needsBlock=!0);else if(!e.firstChild){this.leafFallback(e,t);break e}let i=s&&s.skip?t:this.readStyles(e,t);i&&this.addAll(e,i),o&&this.sync(r),this.needsBlock=n}else{let o=this.readStyles(e,t);o&&this.addElementByRule(e,s,o,!1===s.consuming?i:void 0)}this.localPreserveWS=n}leafFallback(e,t){"BR"==e.nodeName&&this.top.type&&this.top.type.inlineContent&&this.addTextNode(e.ownerDocument.createTextNode("\n"),t)}ignoreFallback(e,t){"BR"!=e.nodeName||this.top.type&&this.top.type.inlineContent||this.findPlace(this.parser.schema.text("-"),t)}readStyles(e,t){let o=e.style;if(o&&o.length)for(let n=0;n<this.parser.matchedStyles.length;n++){let e=this.parser.matchedStyles[n],r=o.getPropertyValue(e);if(r)for(let o;;){let n=this.parser.matchStyle(e,r,this,o);if(!n)break;if(n.ignore)return null;if(t=n.clearMark?t.filter((e=>!n.clearMark(e))):t.concat(this.parser.schema.marks[n.mark].create(n.attrs)),!1!==n.consuming)break;o=n}}return t}addElementByRule(e,t,o,n){let r,i;if(t.node)if(i=this.parser.schema.nodes[t.node],i.isLeaf)this.insertNode(i.create(t.attrs),o)||this.leafFallback(e,o);else{let e=this.enter(i,t.attrs||null,o,t.preserveWhitespace);e&&(r=!0,o=e)}else{let e=this.parser.schema.marks[t.mark];o=o.concat(e.create(t.attrs))}let a=this.top;if(i&&i.isLeaf)this.findInside(e);else if(n)this.addElement(e,o,n);else if(t.getContent)this.findInside(e),t.getContent(e,this.parser.schema).forEach((e=>this.insertNode(e,o)));else{let n=e;"string"==typeof t.contentElement?n=e.querySelector(t.contentElement):"function"==typeof t.contentElement?n=t.contentElement(e):t.contentElement&&(n=t.contentElement),this.findAround(e,n,!0),this.addAll(n,o),this.findAround(e,n,!1)}r&&this.sync(a)&&this.open--}addAll(e,t,o,n){let r=o||0;for(let i=o?e.childNodes[o]:e.firstChild,a=null==n?null:e.childNodes[n];i!=a;i=i.nextSibling,++r)this.findAtPoint(e,r),this.addDOM(i,t);this.findAtPoint(e,r)}findPlace(e,t){let o,n;for(let r=this.open;r>=0;r--){let t=this.nodes[r],i=t.findWrapping(e);if(i&&(!o||o.length>i.length)&&(o=i,n=t,!i.length))break;if(t.solid)break}if(!o)return null;this.sync(n);for(let r=0;r<o.length;r++)t=this.enterInner(o[r],null,t,!1);return t}insertNode(e,t){if(e.isInline&&this.needsBlock&&!this.top.type){let e=this.textblockFromContext();e&&(t=this.enterInner(e,null,t))}let o=this.findPlace(e,t);if(o){this.closeExtra();let t=this.top;t.match&&(t.match=t.match.matchType(e.type));let n=qo.none;for(let r of o.concat(e.marks))(t.type?t.type.allowsMarkType(r.type):$n(r.type,e.type))&&(n=r.addToSet(n));return t.content.push(e.mark(n)),!0}return!1}enter(e,t,o,n){let r=this.findPlace(e.create(t),o);return r&&(r=this.enterInner(e,t,o,!0,n)),r}enterInner(e,t,o){let n=arguments.length>3&&void 0!==arguments[3]&&arguments[3],r=arguments.length>4?arguments[4]:void 0;this.closeExtra();let i=this.top;i.match=i.match&&i.match.matchType(e);let a=Gn(e,r,i.options);4&i.options&&0==i.content.length&&(a|=4);let s=qo.none;return o=o.filter((t=>!(i.type?i.type.allowsMarkType(t.type):$n(t.type,e))||(s=t.addToSet(s),!1))),this.nodes.push(new zn(e,t,s,n,null,a)),this.open++,o}closeExtra(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=this.nodes.length-1;if(t>this.open){for(;t>this.open;t--)this.nodes[t-1].content.push(this.nodes[t].finish(e));this.nodes.length=this.open+1}}finish(){return this.open=0,this.closeExtra(this.isOpen),this.nodes[0].finish(!(!this.isOpen&&!this.options.topOpen))}sync(e){for(let t=this.open;t>=0;t--){if(this.nodes[t]==e)return this.open=t,!0;this.localPreserveWS&&(this.nodes[t].options|=1)}return!1}get currentPos(){this.closeExtra();let e=0;for(let t=this.open;t>=0;t--){let o=this.nodes[t].content;for(let t=o.length-1;t>=0;t--)e+=o[t].nodeSize;t&&e++}return e}findAtPoint(e,t){if(this.find)for(let o=0;o<this.find.length;o++)this.find[o].node==e&&this.find[o].offset==t&&(this.find[o].pos=this.currentPos)}findInside(e){if(this.find)for(let t=0;t<this.find.length;t++)null==this.find[t].pos&&1==e.nodeType&&e.contains(this.find[t].node)&&(this.find[t].pos=this.currentPos)}findAround(e,t,o){if(e!=t&&this.find)for(let n=0;n<this.find.length;n++)if(null==this.find[n].pos&&1==e.nodeType&&e.contains(this.find[n].node)){t.compareDocumentPosition(this.find[n].node)&(o?2:4)&&(this.find[n].pos=this.currentPos)}}findInText(e){if(this.find)for(let t=0;t<this.find.length;t++)this.find[t].node==e&&(this.find[t].pos=this.currentPos-(e.nodeValue.length-this.find[t].offset))}matchesContext(e){if(e.indexOf("|")>-1)return e.split(/\s*\|\s*/).some(this.matchesContext,this);let t=e.split("/"),o=this.options.context,n=!this.isOpen&&(!o||o.parent.type==this.nodes[0].type),r=-(o?o.depth+1:0)+(n?0:1),i=(e,a)=>{for(;e>=0;e--){let s=t[e];if(""==s){if(e==t.length-1||0==e)continue;for(;a>=r;a--)if(i(e-1,a))return!0;return!1}{let e=a>0||0==a&&n?this.nodes[a].type:o&&a>=r?o.node(a-r).type:null;if(!e||e.name!=s&&!e.isInGroup(s))return!1;a--}}return!0};return i(t.length-1,this.open)}textblockFromContext(){let e=this.options.context;if(e)for(let t=e.depth;t>=0;t--){let o=e.node(t).contentMatchAt(e.indexAfter(t)).defaultType;if(o&&o.isTextblock&&o.defaultAttrs)return o}for(let t in this.parser.schema.nodes){let e=this.parser.schema.nodes[t];if(e.isTextblock&&e.defaultAttrs)return e}}}function Bn(e,t){return(e.matches||e.msMatchesSelector||e.webkitMatchesSelector||e.mozMatchesSelector).call(e,t)}function Vn(e){let t={};for(let o in e)t[o]=e[o];return t}function $n(e,t){let o=t.schema.nodes;for(let n in o){let r=o[n];if(!r.allowsMarkType(e))continue;let i=[],a=e=>{i.push(e);for(let o=0;o<e.edgeCount;o++){let{type:n,next:r}=e.edge(o);if(n==t)return!0;if(i.indexOf(r)<0&&a(r))return!0}};if(a(r.contentMatch))return!0}}class Un{constructor(e,t){this.nodes=e,this.marks=t}serializeFragment(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},o=arguments.length>2?arguments[2]:void 0;o||(o=qn(t).createDocumentFragment());let n=o,r=[];return e.forEach((e=>{if(r.length||e.marks.length){let o=0,i=0;for(;o<r.length&&i<e.marks.length;){let t=e.marks[i];if(this.marks[t.type.name]){if(!t.eq(r[o][0])||!1===t.type.spec.spanning)break;o++,i++}else i++}for(;o<r.length;)n=r.pop()[1];for(;i<e.marks.length;){let o=e.marks[i++],a=this.serializeMark(o,e.isInline,t);a&&(r.push([o,n]),n.appendChild(a.dom),n=a.contentDOM||a.dom)}}n.appendChild(this.serializeNodeInner(e,t))})),o}serializeNodeInner(e,t){let{dom:o,contentDOM:n}=Jn(qn(t),this.nodes[e.type.name](e),null,e.attrs);if(n){if(e.isLeaf)throw new RangeError("Content hole not allowed in a leaf node spec");this.serializeFragment(e.content,t,n)}return o}serializeNode(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},o=this.serializeNodeInner(e,t);for(let n=e.marks.length-1;n>=0;n--){let r=this.serializeMark(e.marks[n],e.isInline,t);r&&((r.contentDOM||r.dom).appendChild(o),o=r.dom)}return o}serializeMark(e,t){let o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},n=this.marks[e.type.name];return n&&Jn(qn(o),n(e,t),null,e.attrs)}static renderSpec(e,t){return Jn(e,t,arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,arguments.length>3?arguments[3]:void 0)}static fromSchema(e){return e.cached.domSerializer||(e.cached.domSerializer=new Un(this.nodesFromSchema(e),this.marksFromSchema(e)))}static nodesFromSchema(e){let t=Wn(e.nodes);return t.text||(t.text=e=>e.text),t}static marksFromSchema(e){return Wn(e.marks)}}function Wn(e){let t={};for(let o in e){let n=e[o].spec.toDOM;n&&(t[o]=n)}return t}function qn(e){return e.document||window.document}const Kn=new WeakMap;function Yn(e){let t=Kn.get(e);return void 0===t&&Kn.set(e,t=function(e){let t=null;function o(e){if(e&&"object"==typeof e)if(Array.isArray(e))if("string"==typeof e[0])t||(t=[]),t.push(e);else for(let t=0;t<e.length;t++)o(e[t]);else for(let t in e)o(e[t])}return o(e),t}(e)),t}function Jn(e,t,o,n){if("string"==typeof t)return{dom:e.createTextNode(t)};if(null!=t.nodeType)return{dom:t};if(t.dom&&null!=t.dom.nodeType)return t;let r,i=t[0];if("string"!=typeof i)throw new RangeError("Invalid array passed to renderSpec");if(n&&(r=Yn(n))&&r.indexOf(t)>-1)throw new RangeError("Using an array from an attribute object as a DOM spec. This may be an attempted cross site scripting attack.");let a,s=i.indexOf(" ");s>0&&(o=i.slice(0,s),i=i.slice(s+1));let l=o?e.createElementNS(o,i):e.createElement(i),c=t[1],d=1;if(c&&"object"==typeof c&&null==c.nodeType&&!Array.isArray(c)){d=2;for(let e in c)if(null!=c[e]){let t=e.indexOf(" ");t>0?l.setAttributeNS(e.slice(0,t),e.slice(t+1),c[e]):l.setAttribute(e,c[e])}}for(let u=d;u<t.length;u++){let r=t[u];if(0===r){if(u<t.length-1||u>d)throw new RangeError("Content hole must be the only child of its parent node");return{dom:l,contentDOM:l}}{let{dom:t,contentDOM:i}=Jn(e,r,o,n);if(l.appendChild(t),i){if(a)throw new RangeError("Multiple content holes");a=i}}}return{dom:l,contentDOM:a}}const Xn=Math.pow(2,16);function Qn(e){return 65535&e}class Zn{constructor(e,t,o){this.pos=e,this.delInfo=t,this.recover=o}get deleted(){return(8&this.delInfo)>0}get deletedBefore(){return(5&this.delInfo)>0}get deletedAfter(){return(6&this.delInfo)>0}get deletedAcross(){return(4&this.delInfo)>0}}class er{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(this.ranges=e,this.inverted=t,!e.length&&er.empty)return er.empty}recover(e){let t=0,o=Qn(e);if(!this.inverted)for(let n=0;n<o;n++)t+=this.ranges[3*n+2]-this.ranges[3*n+1];return this.ranges[3*o]+t+function(e){return(e-(65535&e))/Xn}(e)}mapResult(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;return this._map(e,t,!1)}map(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;return this._map(e,t,!0)}_map(e,t,o){let n=0,r=this.inverted?2:1,i=this.inverted?1:2;for(let a=0;a<this.ranges.length;a+=3){let s=this.ranges[a]-(this.inverted?n:0);if(s>e)break;let l=this.ranges[a+r],c=this.ranges[a+i],d=s+l;if(e<=d){let r=s+n+((l?e==s?-1:e==d?1:t:t)<0?0:c);if(o)return r;let i=e==(t<0?s:d)?null:a/3+(e-s)*Xn,u=e==s?2:e==d?1:4;return(t<0?e!=s:e!=d)&&(u|=8),new Zn(r,u,i)}n+=c-l}return o?e+n:new Zn(e+n,0,null)}touches(e,t){let o=0,n=Qn(t),r=this.inverted?2:1,i=this.inverted?1:2;for(let a=0;a<this.ranges.length;a+=3){let t=this.ranges[a]-(this.inverted?o:0);if(t>e)break;let s=this.ranges[a+r];if(e<=t+s&&a==3*n)return!0;o+=this.ranges[a+i]-s}return!1}forEach(e){let t=this.inverted?2:1,o=this.inverted?1:2;for(let n=0,r=0;n<this.ranges.length;n+=3){let i=this.ranges[n],a=i-(this.inverted?r:0),s=i+(this.inverted?0:r),l=this.ranges[n+t],c=this.ranges[n+o];e(a,a+l,s,s+c),r+=c-l}}invert(){return new er(this.ranges,!this.inverted)}toString(){return(this.inverted?"-":"")+JSON.stringify(this.ranges)}static offset(e){return 0==e?er.empty:new er(e<0?[0,-e,0]:[0,0,e])}}er.empty=new er([]);class tr{constructor(e,t){let o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:e?e.length:0;this.mirror=t,this.from=o,this.to=n,this._maps=e||[],this.ownData=!(e||t)}get maps(){return this._maps}slice(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.maps.length;return new tr(this._maps,this.mirror,e,t)}appendMap(e,t){this.ownData||(this._maps=this._maps.slice(),this.mirror=this.mirror&&this.mirror.slice(),this.ownData=!0),this.to=this._maps.push(e),null!=t&&this.setMirror(this._maps.length-1,t)}appendMapping(e){for(let t=0,o=this._maps.length;t<e._maps.length;t++){let n=e.getMirror(t);this.appendMap(e._maps[t],null!=n&&n<t?o+n:void 0)}}getMirror(e){if(this.mirror)for(let t=0;t<this.mirror.length;t++)if(this.mirror[t]==e)return this.mirror[t+(t%2?-1:1)]}setMirror(e,t){this.mirror||(this.mirror=[]),this.mirror.push(e,t)}appendMappingInverted(e){for(let t=e.maps.length-1,o=this._maps.length+e._maps.length;t>=0;t--){let n=e.getMirror(t);this.appendMap(e._maps[t].invert(),null!=n&&n>t?o-n-1:void 0)}}invert(){let e=new tr;return e.appendMappingInverted(this),e}map(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;if(this.mirror)return this._map(e,t,!0);for(let o=this.from;o<this.to;o++)e=this._maps[o].map(e,t);return e}mapResult(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;return this._map(e,t,!1)}_map(e,t,o){let n=0;for(let r=this.from;r<this.to;r++){let o=this._maps[r].mapResult(e,t);if(null!=o.recover){let t=this.getMirror(r);if(null!=t&&t>r&&t<this.to){r=t,e=this._maps[t].recover(o.recover);continue}}n|=o.delInfo,e=o.pos}return o?e:new Zn(e,n,null)}}const or=Object.create(null);class nr{getMap(){return er.empty}merge(e){return null}static fromJSON(e,t){if(!t||!t.stepType)throw new RangeError("Invalid input for Step.fromJSON");let o=or[t.stepType];if(!o)throw new RangeError(`No step type ${t.stepType} defined`);return o.fromJSON(e,t)}static jsonID(e,t){if(e in or)throw new RangeError("Duplicate use of step JSON ID "+e);return or[e]=t,t.prototype.jsonID=e,t}}class rr{constructor(e,t){this.doc=e,this.failed=t}static ok(e){return new rr(e,null)}static fail(e){return new rr(null,e)}static fromReplace(e,t,o,n){try{return rr.ok(e.replace(t,o,n))}catch(SM){if(SM instanceof Ko)return rr.fail(SM.message);throw SM}}}function ir(e,t,o){let n=[];for(let r=0;r<e.childCount;r++){let i=e.child(r);i.content.size&&(i=i.copy(ir(i.content,t,i))),i.isInline&&(i=t(i,o,r)),n.push(i)}return Vo.fromArray(n)}class ar extends nr{constructor(e,t,o){super(),this.from=e,this.to=t,this.mark=o}apply(e){let t=e.slice(this.from,this.to),o=e.resolve(this.from),n=o.node(o.sharedDepth(this.to)),r=new Yo(ir(t.content,((e,t)=>e.isAtom&&t.type.allowsMarkType(this.mark.type)?e.mark(this.mark.addToSet(e.marks)):e),n),t.openStart,t.openEnd);return rr.fromReplace(e,this.from,this.to,r)}invert(){return new sr(this.from,this.to,this.mark)}map(e){let t=e.mapResult(this.from,1),o=e.mapResult(this.to,-1);return t.deleted&&o.deleted||t.pos>=o.pos?null:new ar(t.pos,o.pos,this.mark)}merge(e){return e instanceof ar&&e.mark.eq(this.mark)&&this.from<=e.to&&this.to>=e.from?new ar(Math.min(this.from,e.from),Math.max(this.to,e.to),this.mark):null}toJSON(){return{stepType:"addMark",mark:this.mark.toJSON(),from:this.from,to:this.to}}static fromJSON(e,t){if("number"!=typeof t.from||"number"!=typeof t.to)throw new RangeError("Invalid input for AddMarkStep.fromJSON");return new ar(t.from,t.to,e.markFromJSON(t.mark))}}nr.jsonID("addMark",ar);class sr extends nr{constructor(e,t,o){super(),this.from=e,this.to=t,this.mark=o}apply(e){let t=e.slice(this.from,this.to),o=new Yo(ir(t.content,(e=>e.mark(this.mark.removeFromSet(e.marks))),e),t.openStart,t.openEnd);return rr.fromReplace(e,this.from,this.to,o)}invert(){return new ar(this.from,this.to,this.mark)}map(e){let t=e.mapResult(this.from,1),o=e.mapResult(this.to,-1);return t.deleted&&o.deleted||t.pos>=o.pos?null:new sr(t.pos,o.pos,this.mark)}merge(e){return e instanceof sr&&e.mark.eq(this.mark)&&this.from<=e.to&&this.to>=e.from?new sr(Math.min(this.from,e.from),Math.max(this.to,e.to),this.mark):null}toJSON(){return{stepType:"removeMark",mark:this.mark.toJSON(),from:this.from,to:this.to}}static fromJSON(e,t){if("number"!=typeof t.from||"number"!=typeof t.to)throw new RangeError("Invalid input for RemoveMarkStep.fromJSON");return new sr(t.from,t.to,e.markFromJSON(t.mark))}}nr.jsonID("removeMark",sr);class lr extends nr{constructor(e,t){super(),this.pos=e,this.mark=t}apply(e){let t=e.nodeAt(this.pos);if(!t)return rr.fail("No node at mark step's position");let o=t.type.create(t.attrs,null,this.mark.addToSet(t.marks));return rr.fromReplace(e,this.pos,this.pos+1,new Yo(Vo.from(o),0,t.isLeaf?0:1))}invert(e){let t=e.nodeAt(this.pos);if(t){let e=this.mark.addToSet(t.marks);if(e.length==t.marks.length){for(let o=0;o<t.marks.length;o++)if(!t.marks[o].isInSet(e))return new lr(this.pos,t.marks[o]);return new lr(this.pos,this.mark)}}return new cr(this.pos,this.mark)}map(e){let t=e.mapResult(this.pos,1);return t.deletedAfter?null:new lr(t.pos,this.mark)}toJSON(){return{stepType:"addNodeMark",pos:this.pos,mark:this.mark.toJSON()}}static fromJSON(e,t){if("number"!=typeof t.pos)throw new RangeError("Invalid input for AddNodeMarkStep.fromJSON");return new lr(t.pos,e.markFromJSON(t.mark))}}nr.jsonID("addNodeMark",lr);class cr extends nr{constructor(e,t){super(),this.pos=e,this.mark=t}apply(e){let t=e.nodeAt(this.pos);if(!t)return rr.fail("No node at mark step's position");let o=t.type.create(t.attrs,null,this.mark.removeFromSet(t.marks));return rr.fromReplace(e,this.pos,this.pos+1,new Yo(Vo.from(o),0,t.isLeaf?0:1))}invert(e){let t=e.nodeAt(this.pos);return t&&this.mark.isInSet(t.marks)?new lr(this.pos,this.mark):this}map(e){let t=e.mapResult(this.pos,1);return t.deletedAfter?null:new cr(t.pos,this.mark)}toJSON(){return{stepType:"removeNodeMark",pos:this.pos,mark:this.mark.toJSON()}}static fromJSON(e,t){if("number"!=typeof t.pos)throw new RangeError("Invalid input for RemoveNodeMarkStep.fromJSON");return new cr(t.pos,e.markFromJSON(t.mark))}}nr.jsonID("removeNodeMark",cr);class dr extends nr{constructor(e,t,o){let n=arguments.length>3&&void 0!==arguments[3]&&arguments[3];super(),this.from=e,this.to=t,this.slice=o,this.structure=n}apply(e){return this.structure&&pr(e,this.from,this.to)?rr.fail("Structure replace would overwrite content"):rr.fromReplace(e,this.from,this.to,this.slice)}getMap(){return new er([this.from,this.to-this.from,this.slice.size])}invert(e){return new dr(this.from,this.from+this.slice.size,e.slice(this.from,this.to))}map(e){let t=e.mapResult(this.from,1),o=e.mapResult(this.to,-1);return t.deletedAcross&&o.deletedAcross?null:new dr(t.pos,Math.max(t.pos,o.pos),this.slice)}merge(e){if(!(e instanceof dr)||e.structure||this.structure)return null;if(this.from+this.slice.size!=e.from||this.slice.openEnd||e.slice.openStart){if(e.to!=this.from||this.slice.openStart||e.slice.openEnd)return null;{let t=this.slice.size+e.slice.size==0?Yo.empty:new Yo(e.slice.content.append(this.slice.content),e.slice.openStart,this.slice.openEnd);return new dr(e.from,this.to,t,this.structure)}}{let t=this.slice.size+e.slice.size==0?Yo.empty:new Yo(this.slice.content.append(e.slice.content),this.slice.openStart,e.slice.openEnd);return new dr(this.from,this.to+(e.to-e.from),t,this.structure)}}toJSON(){let e={stepType:"replace",from:this.from,to:this.to};return this.slice.size&&(e.slice=this.slice.toJSON()),this.structure&&(e.structure=!0),e}static fromJSON(e,t){if("number"!=typeof t.from||"number"!=typeof t.to)throw new RangeError("Invalid input for ReplaceStep.fromJSON");return new dr(t.from,t.to,Yo.fromJSON(e,t.slice),!!t.structure)}}nr.jsonID("replace",dr);class ur extends nr{constructor(e,t,o,n,r,i){let a=arguments.length>6&&void 0!==arguments[6]&&arguments[6];super(),this.from=e,this.to=t,this.gapFrom=o,this.gapTo=n,this.slice=r,this.insert=i,this.structure=a}apply(e){if(this.structure&&(pr(e,this.from,this.gapFrom)||pr(e,this.gapTo,this.to)))return rr.fail("Structure gap-replace would overwrite content");let t=e.slice(this.gapFrom,this.gapTo);if(t.openStart||t.openEnd)return rr.fail("Gap is not a flat range");let o=this.slice.insertAt(this.insert,t.content);return o?rr.fromReplace(e,this.from,this.to,o):rr.fail("Content does not fit in gap")}getMap(){return new er([this.from,this.gapFrom-this.from,this.insert,this.gapTo,this.to-this.gapTo,this.slice.size-this.insert])}invert(e){let t=this.gapTo-this.gapFrom;return new ur(this.from,this.from+this.slice.size+t,this.from+this.insert,this.from+this.insert+t,e.slice(this.from,this.to).removeBetween(this.gapFrom-this.from,this.gapTo-this.from),this.gapFrom-this.from,this.structure)}map(e){let t=e.mapResult(this.from,1),o=e.mapResult(this.to,-1),n=this.from==this.gapFrom?t.pos:e.map(this.gapFrom,-1),r=this.to==this.gapTo?o.pos:e.map(this.gapTo,1);return t.deletedAcross&&o.deletedAcross||n<t.pos||r>o.pos?null:new ur(t.pos,o.pos,n,r,this.slice,this.insert,this.structure)}toJSON(){let e={stepType:"replaceAround",from:this.from,to:this.to,gapFrom:this.gapFrom,gapTo:this.gapTo,insert:this.insert};return this.slice.size&&(e.slice=this.slice.toJSON()),this.structure&&(e.structure=!0),e}static fromJSON(e,t){if("number"!=typeof t.from||"number"!=typeof t.to||"number"!=typeof t.gapFrom||"number"!=typeof t.gapTo||"number"!=typeof t.insert)throw new RangeError("Invalid input for ReplaceAroundStep.fromJSON");return new ur(t.from,t.to,t.gapFrom,t.gapTo,Yo.fromJSON(e,t.slice),t.insert,!!t.structure)}}function pr(e,t,o){let n=e.resolve(t),r=o-t,i=n.depth;for(;r>0&&i>0&&n.indexAfter(i)==n.node(i).childCount;)i--,r--;if(r>0){let e=n.node(i).maybeChild(n.indexAfter(i));for(;r>0;){if(!e||e.isLeaf)return!0;e=e.firstChild,r--}}return!1}function hr(e,t,o){let n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:o.contentMatch,r=!(arguments.length>4&&void 0!==arguments[4])||arguments[4],i=e.doc.nodeAt(t),a=[],s=t+1;for(let l=0;l<i.childCount;l++){let t=i.child(l),c=s+t.nodeSize,d=n.matchType(t.type);if(d){n=d;for(let n=0;n<t.marks.length;n++)o.allowsMarkType(t.marks[n].type)||e.step(new sr(s,c,t.marks[n]));if(r&&t.isText&&"pre"!=o.whitespace){let e,n,r=/\r?\n|\r/g;for(;e=r.exec(t.text);)n||(n=new Yo(Vo.from(o.schema.text(" ",o.allowedMarks(t.marks))),0,0)),a.push(new dr(s+e.index,s+e.index+e[0].length,n))}}else a.push(new dr(s,c,Yo.empty));s=c}if(!n.validEnd){let t=n.fillBefore(Vo.empty,!0);e.replace(s,s,new Yo(t,0,0))}for(let l=a.length-1;l>=0;l--)e.step(a[l])}function fr(e,t,o){return(0==t||e.canReplace(t,e.childCount))&&(o==e.childCount||e.canReplace(0,o))}function gr(e){let t=e.parent.content.cutByIndex(e.startIndex,e.endIndex);for(let o=e.depth;;--o){let n=e.$from.node(o),r=e.$from.index(o),i=e.$to.indexAfter(o);if(o<e.depth&&n.canReplace(r,i,t))return o;if(0==o||n.type.spec.isolating||!fr(n,r,i))break}return null}function mr(e,t){let o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:e,r=function(e,t){let{parent:o,startIndex:n,endIndex:r}=e,i=o.contentMatchAt(n).findWrapping(t);if(!i)return null;let a=i.length?i[0]:t;return o.canReplaceWith(n,r,a)?i:null}(e,t),i=r&&function(e,t){let{parent:o,startIndex:n,endIndex:r}=e,i=o.child(n),a=t.contentMatch.findWrapping(i.type);if(!a)return null;let s=(a.length?a[a.length-1]:t).contentMatch;for(let l=n;s&&l<r;l++)s=s.matchType(o.child(l).type);return s&&s.validEnd?a:null}(n,t);return i?r.map(yr).concat({type:t,attrs:o}).concat(i.map(yr)):null}function yr(e){return{type:e,attrs:null}}function vr(e,t,o,n){t.forEach(((r,i)=>{if(r.isText){let a,s=/\r?\n|\r/g;for(;a=s.exec(r.text);){let r=e.mapping.slice(n).map(o+1+i+a.index);e.replaceWith(r,r+1,t.type.schema.linebreakReplacement.create())}}}))}function br(e,t,o,n){t.forEach(((r,i)=>{if(r.type==r.type.schema.linebreakReplacement){let r=e.mapping.slice(n).map(o+1+i);e.replaceWith(r,r+1,t.type.schema.text("\n"))}}))}function xr(e,t){let o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,n=arguments.length>3?arguments[3]:void 0,r=e.resolve(t),i=r.depth-o,a=n&&n[n.length-1]||r.parent;if(i<0||r.parent.type.spec.isolating||!r.parent.canReplace(r.index(),r.parent.childCount)||!a.type.validContent(r.parent.content.cutByIndex(r.index(),r.parent.childCount)))return!1;for(let c=r.depth-1,d=o-2;c>i;c--,d--){let e=r.node(c),t=r.index(c);if(e.type.spec.isolating)return!1;let o=e.content.cutByIndex(t,e.childCount),i=n&&n[d+1];i&&(o=o.replaceChild(0,i.type.create(i.attrs)));let a=n&&n[d]||e;if(!e.canReplace(t+1,e.childCount)||!a.type.validContent(o))return!1}let s=r.indexAfter(i),l=n&&n[0];return r.node(i).canReplaceWith(s,s,l?l.type:r.node(i+1).type)}function wr(e,t){let o=e.resolve(t),n=o.index();return Cr(o.nodeBefore,o.nodeAfter)&&o.parent.canReplace(n,n+1)}function Cr(e,t){return!(!e||!t||e.isLeaf||!function(e,t){t.content.size||e.type.compatibleContent(t.type);let o=e.contentMatchAt(e.childCount),{linebreakReplacement:n}=e.type.schema;for(let r=0;r<t.childCount;r++){let i=t.child(r),a=i.type==n?e.type.schema.nodes.text:i.type;if(o=o.matchType(a),!o)return!1;if(!e.type.allowsMarks(i.marks))return!1}return o.validEnd}(e,t))}function _r(e,t){let o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:-1,n=e.resolve(t);for(let r=n.depth;;r--){let e,i,a=n.index(r);if(r==n.depth?(e=n.nodeBefore,i=n.nodeAfter):o>0?(e=n.node(r+1),a++,i=n.node(r).maybeChild(a)):(e=n.node(r).maybeChild(a-1),i=n.node(r+1)),e&&!e.isTextblock&&Cr(e,i)&&n.node(r).canReplace(a,a+1))return t;if(0==r)break;t=o<0?n.before(r):n.after(r)}}function Sr(e,t,o){let n=e.resolve(t);if(!o.content.size)return t;let r=o.content;for(let i=0;i<o.openStart;i++)r=r.firstChild.content;for(let i=1;i<=(0==o.openStart&&o.size?2:1);i++)for(let e=n.depth;e>=0;e--){let t=e==n.depth?0:n.pos<=(n.start(e+1)+n.end(e+1))/2?-1:1,o=n.index(e)+(t>0?1:0),a=n.node(e),s=!1;if(1==i)s=a.canReplace(o,o,r);else{let e=a.contentMatchAt(o).findWrapping(r.firstChild.type);s=e&&a.canReplaceWith(o,o,e[0])}if(s)return 0==t?n.pos:t<0?n.before(e+1):n.after(e+1)}return null}function Er(e,t){let o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:t,n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:Yo.empty;if(t==o&&!n.size)return null;let r=e.resolve(t),i=e.resolve(o);return kr(r,i,n)?new dr(t,o,n):new jr(r,i,n).fit()}function kr(e,t,o){return!o.openStart&&!o.openEnd&&e.start()==t.start()&&e.parent.canReplace(e.index(),t.index(),o.content)}nr.jsonID("replaceAround",ur);class jr{constructor(e,t,o){this.$from=e,this.$to=t,this.unplaced=o,this.frontier=[],this.placed=Vo.empty;for(let n=0;n<=e.depth;n++){let t=e.node(n);this.frontier.push({type:t.type,match:t.contentMatchAt(e.indexAfter(n))})}for(let n=e.depth;n>0;n--)this.placed=Vo.from(e.node(n).copy(this.placed))}get depth(){return this.frontier.length-1}fit(){for(;this.unplaced.size;){let e=this.findFittable();e?this.placeNodes(e):this.openMore()||this.dropNode()}let e=this.mustMoveInline(),t=this.placed.size-this.depth-this.$from.depth,o=this.$from,n=this.close(e<0?this.$to:o.doc.resolve(e));if(!n)return null;let r=this.placed,i=o.depth,a=n.depth;for(;i&&a&&1==r.childCount;)r=r.firstChild.content,i--,a--;let s=new Yo(r,i,a);return e>-1?new ur(o.pos,e,this.$to.pos,this.$to.end(),s,t):s.size||o.pos!=this.$to.pos?new dr(o.pos,n.pos,s):null}findFittable(){let e=this.unplaced.openStart;for(let t=this.unplaced.content,o=0,n=this.unplaced.openEnd;o<e;o++){let r=t.firstChild;if(t.childCount>1&&(n=0),r.type.spec.isolating&&n<=o){e=o;break}t=r.content}for(let t=1;t<=2;t++)for(let o=1==t?e:this.unplaced.openStart;o>=0;o--){let e,n=null;o?(n=Or(this.unplaced.content,o-1).firstChild,e=n.content):e=this.unplaced.content;let r=e.firstChild;for(let i=this.depth;i>=0;i--){let e,{type:a,match:s}=this.frontier[i],l=null;if(1==t&&(r?s.matchType(r.type)||(l=s.fillBefore(Vo.from(r),!1)):n&&a.compatibleContent(n.type)))return{sliceDepth:o,frontierDepth:i,parent:n,inject:l};if(2==t&&r&&(e=s.findWrapping(r.type)))return{sliceDepth:o,frontierDepth:i,parent:n,wrap:e};if(n&&s.matchType(n.type))break}}}openMore(){let{content:e,openStart:t,openEnd:o}=this.unplaced,n=Or(e,t);return!(!n.childCount||n.firstChild.isLeaf)&&(this.unplaced=new Yo(e,t+1,Math.max(o,n.size+t>=e.size-o?t+1:0)),!0)}dropNode(){let{content:e,openStart:t,openEnd:o}=this.unplaced,n=Or(e,t);if(n.childCount<=1&&t>0){let r=e.size-t<=t+n.size;this.unplaced=new Yo(Ar(e,t-1,1),t-1,r?t-1:o)}else this.unplaced=new Yo(Ar(e,t,1),t,o)}placeNodes(e){let{sliceDepth:t,frontierDepth:o,parent:n,inject:r,wrap:i}=e;for(;this.depth>o;)this.closeFrontierNode();if(i)for(let g=0;g<i.length;g++)this.openFrontierNode(i[g]);let a=this.unplaced,s=n?n.content:a.content,l=a.openStart-t,c=0,d=[],{match:u,type:p}=this.frontier[o];if(r){for(let e=0;e<r.childCount;e++)d.push(r.child(e));u=u.matchFragment(r)}let h=s.size+t-(a.content.size-a.openEnd);for(;c<s.childCount;){let e=s.child(c),t=u.matchType(e.type);if(!t)break;c++,(c>1||0==l||e.content.size)&&(u=t,d.push(Tr(e.mark(p.allowedMarks(e.marks)),1==c?l:0,c==s.childCount?h:-1)))}let f=c==s.childCount;f||(h=-1),this.placed=Rr(this.placed,o,Vo.from(d)),this.frontier[o].match=u,f&&h<0&&n&&n.type==this.frontier[this.depth].type&&this.frontier.length>1&&this.closeFrontierNode();for(let g=0,m=s;g<h;g++){let e=m.lastChild;this.frontier.push({type:e.type,match:e.contentMatchAt(e.childCount)}),m=e.content}this.unplaced=f?0==t?Yo.empty:new Yo(Ar(a.content,t-1,1),t-1,h<0?a.openEnd:t-1):new Yo(Ar(a.content,t,c),a.openStart,a.openEnd)}mustMoveInline(){if(!this.$to.parent.isTextblock)return-1;let e,t=this.frontier[this.depth];if(!t.type.isTextblock||!Dr(this.$to,this.$to.depth,t.type,t.match,!1)||this.$to.depth==this.depth&&(e=this.findCloseLevel(this.$to))&&e.depth==this.depth)return-1;let{depth:o}=this.$to,n=this.$to.after(o);for(;o>1&&n==this.$to.end(--o);)++n;return n}findCloseLevel(e){e:for(let t=Math.min(this.depth,e.depth);t>=0;t--){let{match:o,type:n}=this.frontier[t],r=t<e.depth&&e.end(t+1)==e.pos+(e.depth-(t+1)),i=Dr(e,t,n,o,r);if(i){for(let o=t-1;o>=0;o--){let{match:t,type:n}=this.frontier[o],r=Dr(e,o,n,t,!0);if(!r||r.childCount)continue e}return{depth:t,fit:i,move:r?e.doc.resolve(e.after(t+1)):e}}}}close(e){let t=this.findCloseLevel(e);if(!t)return null;for(;this.depth>t.depth;)this.closeFrontierNode();t.fit.childCount&&(this.placed=Rr(this.placed,t.depth,t.fit)),e=t.move;for(let o=t.depth+1;o<=e.depth;o++){let t=e.node(o),n=t.type.contentMatch.fillBefore(t.content,!0,e.index(o));this.openFrontierNode(t.type,t.attrs,n)}return e}openFrontierNode(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,o=arguments.length>2?arguments[2]:void 0,n=this.frontier[this.depth];n.match=n.match.matchType(e),this.placed=Rr(this.placed,this.depth,Vo.from(e.create(t,o))),this.frontier.push({type:e,match:e.contentMatch})}closeFrontierNode(){let e=this.frontier.pop().match.fillBefore(Vo.empty,!0);e.childCount&&(this.placed=Rr(this.placed,this.frontier.length,e))}}function Ar(e,t,o){return 0==t?e.cutByIndex(o,e.childCount):e.replaceChild(0,e.firstChild.copy(Ar(e.firstChild.content,t-1,o)))}function Rr(e,t,o){return 0==t?e.append(o):e.replaceChild(e.childCount-1,e.lastChild.copy(Rr(e.lastChild.content,t-1,o)))}function Or(e,t){for(let o=0;o<t;o++)e=e.firstChild.content;return e}function Tr(e,t,o){if(t<=0)return e;let n=e.content;return t>1&&(n=n.replaceChild(0,Tr(n.firstChild,t-1,1==n.childCount?o-1:0))),t>0&&(n=e.type.contentMatch.fillBefore(n).append(n),o<=0&&(n=n.append(e.type.contentMatch.matchFragment(n).fillBefore(Vo.empty,!0)))),e.copy(n)}function Dr(e,t,o,n,r){let i=e.node(t),a=r?e.indexAfter(t):e.index(t);if(a==i.childCount&&!o.compatibleContent(i.type))return null;let s=n.fillBefore(i.content,!0,a);return s&&!function(e,t,o){for(let n=o;n<t.childCount;n++)if(!e.allowsMarks(t.child(n).marks))return!0;return!1}(o,i.content,a)?s:null}function Pr(e,t,o,n,r){if(t<o){let r=e.firstChild;e=e.replaceChild(0,r.copy(Pr(r.content,t+1,o,n,r)))}if(t>n){let t=r.contentMatchAt(0),o=t.fillBefore(e).append(e);e=o.append(t.matchFragment(o).fillBefore(Vo.empty,!0))}return e}function Nr(e,t){let o=[];for(let n=Math.min(e.depth,t.depth);n>=0;n--){let r=e.start(n);if(r<e.pos-(e.depth-n)||t.end(n)>t.pos+(t.depth-n)||e.node(n).type.spec.isolating||t.node(n).type.spec.isolating)break;(r==t.start(n)||n==e.depth&&n==t.depth&&e.parent.inlineContent&&t.parent.inlineContent&&n&&t.start(n-1)==r-1)&&o.push(n)}return o}class Ir extends nr{constructor(e,t,o){super(),this.pos=e,this.attr=t,this.value=o}apply(e){let t=e.nodeAt(this.pos);if(!t)return rr.fail("No node at attribute step's position");let o=Object.create(null);for(let r in t.attrs)o[r]=t.attrs[r];o[this.attr]=this.value;let n=t.type.create(o,null,t.marks);return rr.fromReplace(e,this.pos,this.pos+1,new Yo(Vo.from(n),0,t.isLeaf?0:1))}getMap(){return er.empty}invert(e){return new Ir(this.pos,this.attr,e.nodeAt(this.pos).attrs[this.attr])}map(e){let t=e.mapResult(this.pos,1);return t.deletedAfter?null:new Ir(t.pos,this.attr,this.value)}toJSON(){return{stepType:"attr",pos:this.pos,attr:this.attr,value:this.value}}static fromJSON(e,t){if("number"!=typeof t.pos||"string"!=typeof t.attr)throw new RangeError("Invalid input for AttrStep.fromJSON");return new Ir(t.pos,t.attr,t.value)}}nr.jsonID("attr",Ir);class Mr extends nr{constructor(e,t){super(),this.attr=e,this.value=t}apply(e){let t=Object.create(null);for(let n in e.attrs)t[n]=e.attrs[n];t[this.attr]=this.value;let o=e.type.create(t,e.content,e.marks);return rr.ok(o)}getMap(){return er.empty}invert(e){return new Mr(this.attr,e.attrs[this.attr])}map(e){return this}toJSON(){return{stepType:"docAttr",attr:this.attr,value:this.value}}static fromJSON(e,t){if("string"!=typeof t.attr)throw new RangeError("Invalid input for DocAttrStep.fromJSON");return new Mr(t.attr,t.value)}}nr.jsonID("docAttr",Mr);let Lr=class extends Error{};Lr=function e(t){let o=Error.call(this,t);return o.__proto__=e.prototype,o},(Lr.prototype=Object.create(Error.prototype)).constructor=Lr,Lr.prototype.name="TransformError";class Fr{constructor(e){this.doc=e,this.steps=[],this.docs=[],this.mapping=new tr}get before(){return this.docs.length?this.docs[0]:this.doc}step(e){let t=this.maybeStep(e);if(t.failed)throw new Lr(t.failed);return this}maybeStep(e){let t=e.apply(this.doc);return t.failed||this.addStep(e,t.doc),t}get docChanged(){return this.steps.length>0}addStep(e,t){this.docs.push(this.doc),this.steps.push(e),this.mapping.appendMap(e.getMap()),this.doc=t}replace(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:e,o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:Yo.empty,n=Er(this.doc,e,t,o);return n&&this.step(n),this}replaceWith(e,t,o){return this.replace(e,t,new Yo(Vo.from(o),0,0))}delete(e,t){return this.replace(e,t,Yo.empty)}insert(e,t){return this.replaceWith(e,e,t)}replaceRange(e,t,o){return function(e,t,o,n){if(!n.size)return e.deleteRange(t,o);let r=e.doc.resolve(t),i=e.doc.resolve(o);if(kr(r,i,n))return e.step(new dr(t,o,n));let a=Nr(r,e.doc.resolve(o));0==a[a.length-1]&&a.pop();let s=-(r.depth+1);a.unshift(s);for(let h=r.depth,f=r.pos-1;h>0;h--,f--){let e=r.node(h).type.spec;if(e.defining||e.definingAsContext||e.isolating)break;a.indexOf(h)>-1?s=h:r.before(h)==f&&a.splice(1,0,-h)}let l=a.indexOf(s),c=[],d=n.openStart;for(let h=n.content,f=0;;f++){let e=h.firstChild;if(c.push(e),f==n.openStart)break;h=e.content}for(let h=d-1;h>=0;h--){let e=c[h],t=(u=e.type).spec.defining||u.spec.definingForContent;if(t&&!e.sameMarkup(r.node(Math.abs(s)-1)))d=h;else if(t||!e.type.isTextblock)break}var u;for(let h=n.openStart;h>=0;h--){let t=(h+d+1)%(n.openStart+1),s=c[t];if(s)for(let c=0;c<a.length;c++){let d=a[(c+l)%a.length],u=!0;d<0&&(u=!1,d=-d);let p=r.node(d-1),h=r.index(d-1);if(p.canReplaceWith(h,h,s.type,s.marks))return e.replace(r.before(d),u?i.after(d):o,new Yo(Pr(n.content,0,n.openStart,t),t,n.openEnd))}}let p=e.steps.length;for(let h=a.length-1;h>=0&&(e.replace(t,o,n),!(e.steps.length>p));h--){let e=a[h];e<0||(t=r.before(e),o=i.after(e))}}(this,e,t,o),this}replaceRangeWith(e,t,o){return function(e,t,o,n){if(!n.isInline&&t==o&&e.doc.resolve(t).parent.content.size){let r=function(e,t,o){let n=e.resolve(t);if(n.parent.canReplaceWith(n.index(),n.index(),o))return t;if(0==n.parentOffset)for(let r=n.depth-1;r>=0;r--){let e=n.index(r);if(n.node(r).canReplaceWith(e,e,o))return n.before(r+1);if(e>0)return null}if(n.parentOffset==n.parent.content.size)for(let r=n.depth-1;r>=0;r--){let e=n.indexAfter(r);if(n.node(r).canReplaceWith(e,e,o))return n.after(r+1);if(e<n.node(r).childCount)return null}return null}(e.doc,t,n.type);null!=r&&(t=o=r)}e.replaceRange(t,o,new Yo(Vo.from(n),0,0))}(this,e,t,o),this}deleteRange(e,t){return function(e,t,o){let n=e.doc.resolve(t),r=e.doc.resolve(o),i=Nr(n,r);for(let a=0;a<i.length;a++){let t=i[a],o=a==i.length-1;if(o&&0==t||n.node(t).type.contentMatch.validEnd)return e.delete(n.start(t),r.end(t));if(t>0&&(o||n.node(t-1).canReplace(n.index(t-1),r.indexAfter(t-1))))return e.delete(n.before(t),r.after(t))}for(let a=1;a<=n.depth&&a<=r.depth;a++)if(t-n.start(a)==n.depth-a&&o>n.end(a)&&r.end(a)-o!=r.depth-a&&n.start(a-1)==r.start(a-1)&&n.node(a-1).canReplace(n.index(a-1),r.index(a-1)))return e.delete(n.before(a),o);e.delete(t,o)}(this,e,t),this}lift(e,t){return function(e,t,o){let{$from:n,$to:r,depth:i}=t,a=n.before(i+1),s=r.after(i+1),l=a,c=s,d=Vo.empty,u=0;for(let f=i,g=!1;f>o;f--)g||n.index(f)>0?(g=!0,d=Vo.from(n.node(f).copy(d)),u++):l--;let p=Vo.empty,h=0;for(let f=i,g=!1;f>o;f--)g||r.after(f+1)<r.end(f)?(g=!0,p=Vo.from(r.node(f).copy(p)),h++):c++;e.step(new ur(l,c,a,s,new Yo(d.append(p),u,h),d.size-u,!0))}(this,e,t),this}join(e){return function(e,t,o){let n=null,{linebreakReplacement:r}=e.doc.type.schema,i=e.doc.resolve(t-o),a=i.node().type;if(r&&a.inlineContent){let e="pre"==a.whitespace,t=!!a.contentMatch.matchType(r);e&&!t?n=!1:!e&&t&&(n=!0)}let s=e.steps.length;if(!1===n){let n=e.doc.resolve(t+o);br(e,n.node(),n.before(),s)}a.inlineContent&&hr(e,t+o-1,a,i.node().contentMatchAt(i.index()),null==n);let l=e.mapping.slice(s),c=l.map(t-o);if(e.step(new dr(c,l.map(t+o,-1),Yo.empty,!0)),!0===n){let t=e.doc.resolve(c);vr(e,t.node(),t.before(),e.steps.length)}}(this,e,arguments.length>1&&void 0!==arguments[1]?arguments[1]:1),this}wrap(e,t){return function(e,t,o){let n=Vo.empty;for(let a=o.length-1;a>=0;a--){if(n.size){let e=o[a].type.contentMatch.matchFragment(n);if(!e||!e.validEnd)throw new RangeError("Wrapper type given to Transform.wrap does not form valid content of its parent wrapper")}n=Vo.from(o[a].type.create(o[a].attrs,n))}let r=t.start,i=t.end;e.step(new ur(r,i,r,i,new Yo(n,0,0),o.length,!0))}(this,e,t),this}setBlockType(e){return function(e,t,o,n,r){if(!n.isTextblock)throw new RangeError("Type given to setBlockType should be a textblock");let i=e.steps.length;e.doc.nodesBetween(t,o,((t,o)=>{let a="function"==typeof r?r(t):r;if(t.isTextblock&&!t.hasMarkup(n,a)&&function(e,t,o){let n=e.resolve(t),r=n.index();return n.parent.canReplaceWith(r,r+1,o)}(e.doc,e.mapping.slice(i).map(o),n)){let r=null;if(n.schema.linebreakReplacement){let e="pre"==n.whitespace,t=!!n.contentMatch.matchType(n.schema.linebreakReplacement);e&&!t?r=!1:!e&&t&&(r=!0)}!1===r&&br(e,t,o,i),hr(e,e.mapping.slice(i).map(o,1),n,void 0,null===r);let s=e.mapping.slice(i),l=s.map(o,1),c=s.map(o+t.nodeSize,1);return e.step(new ur(l,c,l+1,c-1,new Yo(Vo.from(n.create(a,null,t.marks)),0,0),1,!0)),!0===r&&vr(e,t,o,i),!1}}))}(this,e,arguments.length>1&&void 0!==arguments[1]?arguments[1]:e,arguments.length>2?arguments[2]:void 0,arguments.length>3&&void 0!==arguments[3]?arguments[3]:null),this}setNodeMarkup(e,t){return function(e,t,o,n,r){let i=e.doc.nodeAt(t);if(!i)throw new RangeError("No node at given position");o||(o=i.type);let a=o.create(n,null,r||i.marks);if(i.isLeaf)return e.replaceWith(t,t+i.nodeSize,a);if(!o.validContent(i.content))throw new RangeError("Invalid content for node type "+o.name);e.step(new ur(t,t+i.nodeSize,t+1,t+i.nodeSize-1,new Yo(Vo.from(a),0,0),1,!0))}(this,e,t,arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,arguments.length>3?arguments[3]:void 0),this}setNodeAttribute(e,t,o){return this.step(new Ir(e,t,o)),this}setDocAttribute(e,t){return this.step(new Mr(e,t)),this}addNodeMark(e,t){return this.step(new lr(e,t)),this}removeNodeMark(e,t){if(!(t instanceof qo)){let o=this.doc.nodeAt(e);if(!o)throw new RangeError("No node at position "+e);if(!(t=t.isInSet(o.marks)))return this}return this.step(new cr(e,t)),this}split(e){return function(e,t){let o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,n=arguments.length>3?arguments[3]:void 0,r=e.doc.resolve(t),i=Vo.empty,a=Vo.empty;for(let s=r.depth,l=r.depth-o,c=o-1;s>l;s--,c--){i=Vo.from(r.node(s).copy(i));let e=n&&n[c];a=Vo.from(e?e.type.create(e.attrs,a):r.node(s).copy(a))}e.step(new dr(t,t,new Yo(i.append(a),o,o),!0))}(this,e,arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,arguments.length>2?arguments[2]:void 0),this}addMark(e,t,o){return function(e,t,o,n){let r,i,a=[],s=[];e.doc.nodesBetween(t,o,((e,l,c)=>{if(!e.isInline)return;let d=e.marks;if(!n.isInSet(d)&&c.type.allowsMarkType(n.type)){let c=Math.max(l,t),u=Math.min(l+e.nodeSize,o),p=n.addToSet(d);for(let e=0;e<d.length;e++)d[e].isInSet(p)||(r&&r.to==c&&r.mark.eq(d[e])?r.to=u:a.push(r=new sr(c,u,d[e])));i&&i.to==c?i.to=u:s.push(i=new ar(c,u,n))}})),a.forEach((t=>e.step(t))),s.forEach((t=>e.step(t)))}(this,e,t,o),this}removeMark(e,t,o){return function(e,t,o,n){let r=[],i=0;e.doc.nodesBetween(t,o,((e,a)=>{if(!e.isInline)return;i++;let s=null;if(n instanceof Dn){let t,o=e.marks;for(;t=n.isInSet(o);)(s||(s=[])).push(t),o=t.removeFromSet(o)}else n?n.isInSet(e.marks)&&(s=[n]):s=e.marks;if(s&&s.length){let n=Math.min(a+e.nodeSize,o);for(let e=0;e<s.length;e++){let o,l=s[e];for(let e=0;e<r.length;e++){let t=r[e];t.step==i-1&&l.eq(r[e].style)&&(o=t)}o?(o.to=n,o.step=i):r.push({style:l,from:Math.max(a,t),to:n,step:i})}}})),r.forEach((t=>e.step(new sr(t.from,t.to,t.style))))}(this,e,t,o),this}clearIncompatible(e,t,o){return hr(this,e,t,o),this}}const Gr=Object.create(null);class zr{constructor(e,t,o){this.$anchor=e,this.$head=t,this.ranges=o||[new Hr(e.min(t),e.max(t))]}get anchor(){return this.$anchor.pos}get head(){return this.$head.pos}get from(){return this.$from.pos}get to(){return this.$to.pos}get $from(){return this.ranges[0].$from}get $to(){return this.ranges[0].$to}get empty(){let e=this.ranges;for(let t=0;t<e.length;t++)if(e[t].$from.pos!=e[t].$to.pos)return!1;return!0}content(){return this.$from.doc.slice(this.from,this.to,!0)}replace(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Yo.empty,o=t.content.lastChild,n=null;for(let a=0;a<t.openEnd;a++)n=o,o=o.lastChild;let r=e.steps.length,i=this.ranges;for(let a=0;a<i.length;a++){let{$from:s,$to:l}=i[a],c=e.mapping.slice(r);e.replaceRange(c.map(s.pos),c.map(l.pos),a?Yo.empty:t),0==a&&Xr(e,r,(o?o.isInline:n&&n.isTextblock)?-1:1)}}replaceWith(e,t){let o=e.steps.length,n=this.ranges;for(let r=0;r<n.length;r++){let{$from:i,$to:a}=n[r],s=e.mapping.slice(o),l=s.map(i.pos),c=s.map(a.pos);r?e.deleteRange(l,c):(e.replaceRangeWith(l,c,t),Xr(e,o,t.isInline?-1:1))}}static findFrom(e,t){let o=arguments.length>2&&void 0!==arguments[2]&&arguments[2],n=e.parent.inlineContent?new $r(e):Jr(e.node(0),e.parent,e.pos,e.index(),t,o);if(n)return n;for(let r=e.depth-1;r>=0;r--){let n=t<0?Jr(e.node(0),e.node(r),e.before(r+1),e.index(r),t,o):Jr(e.node(0),e.node(r),e.after(r+1),e.index(r)+1,t,o);if(n)return n}return null}static near(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;return this.findFrom(e,t)||this.findFrom(e,-t)||new Kr(e.node(0))}static atStart(e){return Jr(e,e,0,0,1)||new Kr(e)}static atEnd(e){return Jr(e,e,e.content.size,e.childCount,-1)||new Kr(e)}static fromJSON(e,t){if(!t||!t.type)throw new RangeError("Invalid input for Selection.fromJSON");let o=Gr[t.type];if(!o)throw new RangeError(`No selection type ${t.type} defined`);return o.fromJSON(e,t)}static jsonID(e,t){if(e in Gr)throw new RangeError("Duplicate use of selection JSON ID "+e);return Gr[e]=t,t.prototype.jsonID=e,t}getBookmark(){return $r.between(this.$anchor,this.$head).getBookmark()}}zr.prototype.visible=!0;class Hr{constructor(e,t){this.$from=e,this.$to=t}}let Br=!1;function Vr(e){Br||e.parent.inlineContent||(Br=!0,console.warn("TextSelection endpoint not pointing into a node with inline content ("+e.parent.type.name+")"))}class $r extends zr{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:e;Vr(e),Vr(t),super(e,t)}get $cursor(){return this.$anchor.pos==this.$head.pos?this.$head:null}map(e,t){let o=e.resolve(t.map(this.head));if(!o.parent.inlineContent)return zr.near(o);let n=e.resolve(t.map(this.anchor));return new $r(n.parent.inlineContent?n:o,o)}replace(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Yo.empty;if(super.replace(e,t),t==Yo.empty){let t=this.$from.marksAcross(this.$to);t&&e.ensureMarks(t)}}eq(e){return e instanceof $r&&e.anchor==this.anchor&&e.head==this.head}getBookmark(){return new Ur(this.anchor,this.head)}toJSON(){return{type:"text",anchor:this.anchor,head:this.head}}static fromJSON(e,t){if("number"!=typeof t.anchor||"number"!=typeof t.head)throw new RangeError("Invalid input for TextSelection.fromJSON");return new $r(e.resolve(t.anchor),e.resolve(t.head))}static create(e,t){let o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:t,n=e.resolve(t);return new this(n,o==t?n:e.resolve(o))}static between(e,t,o){let n=e.pos-t.pos;if(o&&!n||(o=n>=0?1:-1),!t.parent.inlineContent){let e=zr.findFrom(t,o,!0)||zr.findFrom(t,-o,!0);if(!e)return zr.near(t,o);t=e.$head}return e.parent.inlineContent||(0==n||(e=(zr.findFrom(e,-o,!0)||zr.findFrom(e,o,!0)).$anchor).pos<t.pos!=n<0)&&(e=t),new $r(e,t)}}zr.jsonID("text",$r);class Ur{constructor(e,t){this.anchor=e,this.head=t}map(e){return new Ur(e.map(this.anchor),e.map(this.head))}resolve(e){return $r.between(e.resolve(this.anchor),e.resolve(this.head))}}class Wr extends zr{constructor(e){let t=e.nodeAfter,o=e.node(0).resolve(e.pos+t.nodeSize);super(e,o),this.node=t}map(e,t){let{deleted:o,pos:n}=t.mapResult(this.anchor),r=e.resolve(n);return o?zr.near(r):new Wr(r)}content(){return new Yo(Vo.from(this.node),0,0)}eq(e){return e instanceof Wr&&e.anchor==this.anchor}toJSON(){return{type:"node",anchor:this.anchor}}getBookmark(){return new qr(this.anchor)}static fromJSON(e,t){if("number"!=typeof t.anchor)throw new RangeError("Invalid input for NodeSelection.fromJSON");return new Wr(e.resolve(t.anchor))}static create(e,t){return new Wr(e.resolve(t))}static isSelectable(e){return!e.isText&&!1!==e.type.spec.selectable}}Wr.prototype.visible=!1,zr.jsonID("node",Wr);class qr{constructor(e){this.anchor=e}map(e){let{deleted:t,pos:o}=e.mapResult(this.anchor);return t?new Ur(o,o):new qr(o)}resolve(e){let t=e.resolve(this.anchor),o=t.nodeAfter;return o&&Wr.isSelectable(o)?new Wr(t):zr.near(t)}}class Kr extends zr{constructor(e){super(e.resolve(0),e.resolve(e.content.size))}replace(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Yo.empty;if(t==Yo.empty){e.delete(0,e.doc.content.size);let t=zr.atStart(e.doc);t.eq(e.selection)||e.setSelection(t)}else super.replace(e,t)}toJSON(){return{type:"all"}}static fromJSON(e){return new Kr(e)}map(e){return new Kr(e)}eq(e){return e instanceof Kr}getBookmark(){return Yr}}zr.jsonID("all",Kr);const Yr={map(){return this},resolve:e=>new Kr(e)};function Jr(e,t,o,n,r){let i=arguments.length>5&&void 0!==arguments[5]&&arguments[5];if(t.inlineContent)return $r.create(e,o);for(let a=n-(r>0?0:1);r>0?a<t.childCount:a>=0;a+=r){let n=t.child(a);if(n.isAtom){if(!i&&Wr.isSelectable(n))return Wr.create(e,o-(r<0?n.nodeSize:0))}else{let t=Jr(e,n,o+r,r<0?n.childCount:0,r,i);if(t)return t}o+=n.nodeSize*r}return null}function Xr(e,t,o){let n=e.steps.length-1;if(n<t)return;let r,i=e.steps[n];(i instanceof dr||i instanceof ur)&&(e.mapping.maps[n].forEach(((e,t,o,n)=>{null==r&&(r=n)})),e.setSelection(zr.near(e.doc.resolve(r),o)))}class Qr extends Fr{constructor(e){super(e.doc),this.curSelectionFor=0,this.updated=0,this.meta=Object.create(null),this.time=Date.now(),this.curSelection=e.selection,this.storedMarks=e.storedMarks}get selection(){return this.curSelectionFor<this.steps.length&&(this.curSelection=this.curSelection.map(this.doc,this.mapping.slice(this.curSelectionFor)),this.curSelectionFor=this.steps.length),this.curSelection}setSelection(e){if(e.$from.doc!=this.doc)throw new RangeError("Selection passed to setSelection must point at the current document");return this.curSelection=e,this.curSelectionFor=this.steps.length,this.updated=-3&this.updated|1,this.storedMarks=null,this}get selectionSet(){return(1&this.updated)>0}setStoredMarks(e){return this.storedMarks=e,this.updated|=2,this}ensureMarks(e){return qo.sameSet(this.storedMarks||this.selection.$from.marks(),e)||this.setStoredMarks(e),this}addStoredMark(e){return this.ensureMarks(e.addToSet(this.storedMarks||this.selection.$head.marks()))}removeStoredMark(e){return this.ensureMarks(e.removeFromSet(this.storedMarks||this.selection.$head.marks()))}get storedMarksSet(){return(2&this.updated)>0}addStep(e,t){super.addStep(e,t),this.updated=-3&this.updated,this.storedMarks=null}setTime(e){return this.time=e,this}replaceSelection(e){return this.selection.replace(this,e),this}replaceSelectionWith(e){let t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],o=this.selection;return t&&(e=e.mark(this.storedMarks||(o.empty?o.$from.marks():o.$from.marksAcross(o.$to)||qo.none))),o.replaceWith(this,e),this}deleteSelection(){return this.selection.replace(this),this}insertText(e,t,o){let n=this.doc.type.schema;if(null==t)return e?this.replaceSelectionWith(n.text(e),!0):this.deleteSelection();{if(null==o&&(o=t),o=null==o?t:o,!e)return this.deleteRange(t,o);let r=this.storedMarks;if(!r){let e=this.doc.resolve(t);r=o==t?e.marks():e.marksAcross(this.doc.resolve(o))}return this.replaceRangeWith(t,o,n.text(e,r)),this.selection.empty||this.setSelection(zr.near(this.selection.$to)),this}}setMeta(e,t){return this.meta["string"==typeof e?e:e.key]=t,this}getMeta(e){return this.meta["string"==typeof e?e:e.key]}get isGeneric(){for(let e in this.meta)return!1;return!0}scrollIntoView(){return this.updated|=4,this}get scrolledIntoView(){return(4&this.updated)>0}}function Zr(e,t){return t&&e?e.bind(t):e}class ei{constructor(e,t,o){this.name=e,this.init=Zr(t.init,o),this.apply=Zr(t.apply,o)}}const ti=[new ei("doc",{init:e=>e.doc||e.schema.topNodeType.createAndFill(),apply:e=>e.doc}),new ei("selection",{init:(e,t)=>e.selection||zr.atStart(t.doc),apply:e=>e.selection}),new ei("storedMarks",{init:e=>e.storedMarks||null,apply:(e,t,o,n)=>n.selection.$cursor?e.storedMarks:null}),new ei("scrollToSelection",{init:()=>0,apply:(e,t)=>e.scrolledIntoView?t+1:t})];class oi{constructor(e,t){this.schema=e,this.plugins=[],this.pluginsByKey=Object.create(null),this.fields=ti.slice(),t&&t.forEach((e=>{if(this.pluginsByKey[e.key])throw new RangeError("Adding different instances of a keyed plugin ("+e.key+")");this.plugins.push(e),this.pluginsByKey[e.key]=e,e.spec.state&&this.fields.push(new ei(e.key,e.spec.state,e))}))}}class ni{constructor(e){this.config=e}get schema(){return this.config.schema}get plugins(){return this.config.plugins}apply(e){return this.applyTransaction(e).state}filterTransaction(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:-1;for(let o=0;o<this.config.plugins.length;o++)if(o!=t){let t=this.config.plugins[o];if(t.spec.filterTransaction&&!t.spec.filterTransaction.call(t,e,this))return!1}return!0}applyTransaction(e){if(!this.filterTransaction(e))return{state:this,transactions:[]};let t=[e],o=this.applyInner(e),n=null;for(;;){let r=!1;for(let i=0;i<this.config.plugins.length;i++){let a=this.config.plugins[i];if(a.spec.appendTransaction){let s=n?n[i].n:0,l=n?n[i].state:this,c=s<t.length&&a.spec.appendTransaction.call(a,s?t.slice(s):t,l,o);if(c&&o.filterTransaction(c,i)){if(c.setMeta("appendedTransaction",e),!n){n=[];for(let e=0;e<this.config.plugins.length;e++)n.push(e<i?{state:o,n:t.length}:{state:this,n:0})}t.push(c),o=o.applyInner(c),r=!0}n&&(n[i]={state:o,n:t.length})}}if(!r)return{state:o,transactions:t}}}applyInner(e){if(!e.before.eq(this.doc))throw new RangeError("Applying a mismatched transaction");let t=new ni(this.config),o=this.config.fields;for(let n=0;n<o.length;n++){let r=o[n];t[r.name]=r.apply(e,this[r.name],this,t)}return t}get tr(){return new Qr(this)}static create(e){let t=new oi(e.doc?e.doc.type.schema:e.schema,e.plugins),o=new ni(t);for(let n=0;n<t.fields.length;n++)o[t.fields[n].name]=t.fields[n].init(e,o);return o}reconfigure(e){let t=new oi(this.schema,e.plugins),o=t.fields,n=new ni(t);for(let r=0;r<o.length;r++){let t=o[r].name;n[t]=this.hasOwnProperty(t)?this[t]:o[r].init(e,n)}return n}toJSON(e){let t={doc:this.doc.toJSON(),selection:this.selection.toJSON()};if(this.storedMarks&&(t.storedMarks=this.storedMarks.map((e=>e.toJSON()))),e&&"object"==typeof e)for(let o in e){if("doc"==o||"selection"==o)throw new RangeError("The JSON fields `doc` and `selection` are reserved");let n=e[o],r=n.spec.state;r&&r.toJSON&&(t[o]=r.toJSON.call(n,this[n.key]))}return t}static fromJSON(e,t,o){if(!t)throw new RangeError("Invalid input for EditorState.fromJSON");if(!e.schema)throw new RangeError("Required config field 'schema' missing");let n=new oi(e.schema,e.plugins),r=new ni(n);return n.fields.forEach((n=>{if("doc"==n.name)r.doc=fn.fromJSON(e.schema,t.doc);else if("selection"==n.name)r.selection=zr.fromJSON(r.doc,t.selection);else if("storedMarks"==n.name)t.storedMarks&&(r.storedMarks=t.storedMarks.map(e.schema.markFromJSON));else{if(o)for(let i in o){let a=o[i],s=a.spec.state;if(a.key==n.name&&s&&s.fromJSON&&Object.prototype.hasOwnProperty.call(t,i))return void(r[n.name]=s.fromJSON.call(a,e,t[i],r))}r[n.name]=n.init(e,r)}})),r}}function ri(e,t,o){for(let n in e){let r=e[n];r instanceof Function?r=r.bind(t):"handleDOMEvents"==n&&(r=ri(r,t,{})),o[n]=r}return o}class ii{constructor(e){this.spec=e,this.props={},e.props&&ri(e.props,this,this.props),this.key=e.key?e.key.key:si("plugin")}getState(e){return e[this.key]}}const ai=Object.create(null);function si(e){return e in ai?e+"$"+ ++ai[e]:(ai[e]=0,e+"$")}class li{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"key";this.key=si(e)}get(e){return e.config.pluginsByKey[this.key]}getState(e){return e[this.key]}}const ci=function(e){for(var t=0;;t++)if(!(e=e.previousSibling))return t},di=function(e){let t=e.assignedSlot||e.parentNode;return t&&11==t.nodeType?t.host:t};let ui=null;const pi=function(e,t,o){let n=ui||(ui=document.createRange());return n.setEnd(e,null==o?e.nodeValue.length:o),n.setStart(e,t||0),n},hi=function(e,t,o,n){return o&&(gi(e,t,o,n,-1)||gi(e,t,o,n,1))},fi=/^(img|br|input|textarea|hr)$/i;function gi(e,t,o,n,r){for(;;){if(e==o&&t==n)return!0;if(t==(r<0?0:mi(e))){let o=e.parentNode;if(!o||1!=o.nodeType||yi(e)||fi.test(e.nodeName)||"false"==e.contentEditable)return!1;t=ci(e)+(r<0?0:1),e=o}else{if(1!=e.nodeType)return!1;if("false"==(e=e.childNodes[t+(r<0?-1:0)]).contentEditable)return!1;t=r<0?mi(e):0}}}function mi(e){return 3==e.nodeType?e.nodeValue.length:e.childNodes.length}function yi(e){let t;for(let o=e;o&&!(t=o.pmViewDesc);o=o.parentNode);return t&&t.node&&t.node.isBlock&&(t.dom==e||t.contentDOM==e)}const vi=function(e){return e.focusNode&&hi(e.focusNode,e.focusOffset,e.anchorNode,e.anchorOffset)};function bi(e,t){let o=document.createEvent("Event");return o.initEvent("keydown",!0,!0),o.keyCode=e,o.key=o.code=t,o}const xi="undefined"!=typeof navigator?navigator:null,wi="undefined"!=typeof document?document:null,Ci=xi&&xi.userAgent||"",_i=/Edge\/(\d+)/.exec(Ci),Si=/MSIE \d/.exec(Ci),Ei=/Trident\/(?:[7-9]|\d{2,})\..*rv:(\d+)/.exec(Ci),ki=!!(Si||Ei||_i),ji=Si?document.documentMode:Ei?+Ei[1]:_i?+_i[1]:0,Ai=!ki&&/gecko\/(\d+)/i.test(Ci);Ai&&(/Firefox\/(\d+)/.exec(Ci)||[0,0])[1];const Ri=!ki&&/Chrome\/(\d+)/.exec(Ci),Oi=!!Ri,Ti=Ri?+Ri[1]:0,Di=!ki&&!!xi&&/Apple Computer/.test(xi.vendor),Pi=Di&&(/Mobile\/\w+/.test(Ci)||!!xi&&xi.maxTouchPoints>2),Ni=Pi||!!xi&&/Mac/.test(xi.platform),Ii=!!xi&&/Win/.test(xi.platform),Mi=/Android \d/.test(Ci),Li=!!wi&&"webkitFontSmoothing"in wi.documentElement.style,Fi=Li?+(/\bAppleWebKit\/(\d+)/.exec(navigator.userAgent)||[0,0])[1]:0;function Gi(e){let t=e.defaultView&&e.defaultView.visualViewport;return t?{left:0,right:t.width,top:0,bottom:t.height}:{left:0,right:e.documentElement.clientWidth,top:0,bottom:e.documentElement.clientHeight}}function zi(e,t){return"number"==typeof e?e:e[t]}function Hi(e){let t=e.getBoundingClientRect(),o=t.width/e.offsetWidth||1,n=t.height/e.offsetHeight||1;return{left:t.left,right:t.left+e.clientWidth*o,top:t.top,bottom:t.top+e.clientHeight*n}}function Bi(e,t,o){let n=e.someProp("scrollThreshold")||0,r=e.someProp("scrollMargin")||5,i=e.dom.ownerDocument;for(let a=o||e.dom;a;){if(1!=a.nodeType){a=di(a);continue}let e=a,o=e==i.body,s=o?Gi(i):Hi(e),l=0,c=0;if(t.top<s.top+zi(n,"top")?c=-(s.top-t.top+zi(r,"top")):t.bottom>s.bottom-zi(n,"bottom")&&(c=t.bottom-t.top>s.bottom-s.top?t.top+zi(r,"top")-s.top:t.bottom-s.bottom+zi(r,"bottom")),t.left<s.left+zi(n,"left")?l=-(s.left-t.left+zi(r,"left")):t.right>s.right-zi(n,"right")&&(l=t.right-s.right+zi(r,"right")),l||c)if(o)i.defaultView.scrollBy(l,c);else{let o=e.scrollLeft,n=e.scrollTop;c&&(e.scrollTop+=c),l&&(e.scrollLeft+=l);let r=e.scrollLeft-o,i=e.scrollTop-n;t={left:t.left-r,top:t.top-i,right:t.right-r,bottom:t.bottom-i}}let d=o?"fixed":getComputedStyle(a).position;if(/^(fixed|sticky)$/.test(d))break;a="absolute"==d?a.offsetParent:di(a)}}function Vi(e){let t=[],o=e.ownerDocument;for(let n=e;n&&(t.push({dom:n,top:n.scrollTop,left:n.scrollLeft}),e!=o);n=di(n));return t}function $i(e,t){for(let o=0;o<e.length;o++){let{dom:n,top:r,left:i}=e[o];n.scrollTop!=r+t&&(n.scrollTop=r+t),n.scrollLeft!=i&&(n.scrollLeft=i)}}let Ui=null;function Wi(e,t){let o,n,r,i,a=2e8,s=0,l=t.top,c=t.top;for(let d=e.firstChild,u=0;d;d=d.nextSibling,u++){let e;if(1==d.nodeType)e=d.getClientRects();else{if(3!=d.nodeType)continue;e=pi(d).getClientRects()}for(let p=0;p<e.length;p++){let h=e[p];if(h.top<=l&&h.bottom>=c){l=Math.max(h.bottom,l),c=Math.min(h.top,c);let e=h.left>t.left?h.left-t.left:h.right<t.left?t.left-h.right:0;if(e<a){o=d,a=e,n=e&&3==o.nodeType?{left:h.right<t.left?h.right:h.left,top:t.top}:t,1==d.nodeType&&e&&(s=u+(t.left>=(h.left+h.right)/2?1:0));continue}}else h.top>t.top&&!r&&h.left<=t.left&&h.right>=t.left&&(r=d,i={left:Math.max(h.left,Math.min(h.right,t.left)),top:h.top});!o&&(t.left>=h.right&&t.top>=h.top||t.left>=h.left&&t.top>=h.bottom)&&(s=u+1)}}return!o&&r&&(o=r,n=i,a=0),o&&3==o.nodeType?function(e,t){let o=e.nodeValue.length,n=document.createRange();for(let r=0;r<o;r++){n.setEnd(e,r+1),n.setStart(e,r);let o=Xi(n,1);if(o.top!=o.bottom&&qi(t,o))return{node:e,offset:r+(t.left>=(o.left+o.right)/2?1:0)}}return{node:e,offset:0}}(o,n):!o||a&&1==o.nodeType?{node:e,offset:s}:Wi(o,n)}function qi(e,t){return e.left>=t.left-1&&e.left<=t.right+1&&e.top>=t.top-1&&e.top<=t.bottom+1}function Ki(e,t,o){let n=e.childNodes.length;if(n&&o.top<o.bottom)for(let r=Math.max(0,Math.min(n-1,Math.floor(n*(t.top-o.top)/(o.bottom-o.top))-2)),i=r;;){let o=e.childNodes[i];if(1==o.nodeType){let e=o.getClientRects();for(let n=0;n<e.length;n++){let r=e[n];if(qi(t,r))return Ki(o,t,r)}}if((i=(i+1)%n)==r)break}return e}function Yi(e,t){let o,n=e.dom.ownerDocument,r=0,i=function(e,t,o){if(e.caretPositionFromPoint)try{let n=e.caretPositionFromPoint(t,o);if(n)return{node:n.offsetNode,offset:Math.min(mi(n.offsetNode),n.offset)}}catch(n){}if(e.caretRangeFromPoint){let n=e.caretRangeFromPoint(t,o);if(n)return{node:n.startContainer,offset:Math.min(mi(n.startContainer),n.startOffset)}}}(n,t.left,t.top);i&&({node:o,offset:r}=i);let a,s=(e.root.elementFromPoint?e.root:n).elementFromPoint(t.left,t.top);if(!s||!e.dom.contains(1!=s.nodeType?s.parentNode:s)){let o=e.dom.getBoundingClientRect();if(!qi(t,o))return null;if(s=Ki(e.dom,t,o),!s)return null}if(Di)for(let c=s;o&&c;c=di(c))c.draggable&&(o=void 0);if(s=function(e,t){let o=e.parentNode;return o&&/^li$/i.test(o.nodeName)&&t.left<e.getBoundingClientRect().left?o:e}(s,t),o){if(Ai&&1==o.nodeType&&(r=Math.min(r,o.childNodes.length),r<o.childNodes.length)){let e,n=o.childNodes[r];"IMG"==n.nodeName&&(e=n.getBoundingClientRect()).right<=t.left&&e.bottom>t.top&&r++}let n;Li&&r&&1==o.nodeType&&1==(n=o.childNodes[r-1]).nodeType&&"false"==n.contentEditable&&n.getBoundingClientRect().top>=t.top&&r--,o==e.dom&&r==o.childNodes.length-1&&1==o.lastChild.nodeType&&t.top>o.lastChild.getBoundingClientRect().bottom?a=e.state.doc.content.size:0!=r&&1==o.nodeType&&"BR"==o.childNodes[r-1].nodeName||(a=function(e,t,o,n){let r=-1;for(let i=t,a=!1;i!=e.dom;){let t,o=e.docView.nearestDesc(i,!0);if(!o)return null;if(1==o.dom.nodeType&&(o.node.isBlock&&o.parent||!o.contentDOM)&&((t=o.dom.getBoundingClientRect()).width||t.height)&&(o.node.isBlock&&o.parent&&(!a&&t.left>n.left||t.top>n.top?r=o.posBefore:(!a&&t.right<n.left||t.bottom<n.top)&&(r=o.posAfter),a=!0),!o.contentDOM&&r<0&&!o.node.isText))return(o.node.isBlock?n.top<(t.top+t.bottom)/2:n.left<(t.left+t.right)/2)?o.posBefore:o.posAfter;i=o.dom.parentNode}return r>-1?r:e.docView.posFromDOM(t,o,-1)}(e,o,r,t))}null==a&&(a=function(e,t,o){let{node:n,offset:r}=Wi(t,o),i=-1;if(1==n.nodeType&&!n.firstChild){let e=n.getBoundingClientRect();i=e.left!=e.right&&o.left>(e.left+e.right)/2?1:-1}return e.docView.posFromDOM(n,r,i)}(e,s,t));let l=e.docView.nearestDesc(s,!0);return{pos:a,inside:l?l.posAtStart-l.border:-1}}function Ji(e){return e.top<e.bottom||e.left<e.right}function Xi(e,t){let o=e.getClientRects();if(o.length){let e=o[t<0?0:o.length-1];if(Ji(e))return e}return Array.prototype.find.call(o,Ji)||e.getBoundingClientRect()}const Qi=/[\u0590-\u05f4\u0600-\u06ff\u0700-\u08ac]/;function Zi(e,t,o){let{node:n,offset:r,atom:i}=e.docView.domFromPos(t,o<0?-1:1),a=Li||Ai;if(3==n.nodeType){if(!a||!Qi.test(n.nodeValue)&&(o<0?r:r!=n.nodeValue.length)){let e=r,t=r,i=o<0?1:-1;return o<0&&!r?(t++,i=-1):o>=0&&r==n.nodeValue.length?(e--,i=1):o<0?e--:t++,ea(Xi(pi(n,e,t),i),i<0)}{let e=Xi(pi(n,r,r),o);if(Ai&&r&&/\s/.test(n.nodeValue[r-1])&&r<n.nodeValue.length){let t=Xi(pi(n,r-1,r-1),-1);if(t.top==e.top){let o=Xi(pi(n,r,r+1),-1);if(o.top!=e.top)return ea(o,o.left<t.left)}}return e}}if(!e.state.doc.resolve(t-(i||0)).parent.inlineContent){if(null==i&&r&&(o<0||r==mi(n))){let e=n.childNodes[r-1];if(1==e.nodeType)return ta(e.getBoundingClientRect(),!1)}if(null==i&&r<mi(n)){let e=n.childNodes[r];if(1==e.nodeType)return ta(e.getBoundingClientRect(),!0)}return ta(n.getBoundingClientRect(),o>=0)}if(null==i&&r&&(o<0||r==mi(n))){let e=n.childNodes[r-1],t=3==e.nodeType?pi(e,mi(e)-(a?0:1)):1!=e.nodeType||"BR"==e.nodeName&&e.nextSibling?null:e;if(t)return ea(Xi(t,1),!1)}if(null==i&&r<mi(n)){let e=n.childNodes[r];for(;e.pmViewDesc&&e.pmViewDesc.ignoreForCoords;)e=e.nextSibling;let t=e?3==e.nodeType?pi(e,0,a?0:1):1==e.nodeType?e:null:null;if(t)return ea(Xi(t,-1),!0)}return ea(Xi(3==n.nodeType?pi(n):n,-o),o>=0)}function ea(e,t){if(0==e.width)return e;let o=t?e.left:e.right;return{top:e.top,bottom:e.bottom,left:o,right:o}}function ta(e,t){if(0==e.height)return e;let o=t?e.top:e.bottom;return{top:o,bottom:o,left:e.left,right:e.right}}function oa(e,t,o){let n=e.state,r=e.root.activeElement;n!=t&&e.updateState(t),r!=e.dom&&e.focus();try{return o()}finally{n!=t&&e.updateState(n),r!=e.dom&&r&&r.focus()}}const na=/[\u0590-\u08ac]/;let ra=null,ia=null,aa=!1;function sa(e,t,o){return ra==t&&ia==o?aa:(ra=t,ia=o,aa="up"==o||"down"==o?function(e,t,o){let n=t.selection,r="up"==o?n.$from:n.$to;return oa(e,t,(()=>{let{node:t}=e.docView.domFromPos(r.pos,"up"==o?-1:1);for(;;){let o=e.docView.nearestDesc(t,!0);if(!o)break;if(o.node.isBlock){t=o.contentDOM||o.dom;break}t=o.dom.parentNode}let n=Zi(e,r.pos,1);for(let e=t.firstChild;e;e=e.nextSibling){let t;if(1==e.nodeType)t=e.getClientRects();else{if(3!=e.nodeType)continue;t=pi(e,0,e.nodeValue.length).getClientRects()}for(let e=0;e<t.length;e++){let r=t[e];if(r.bottom>r.top+1&&("up"==o?n.top-r.top>2*(r.bottom-n.top):r.bottom-n.bottom>2*(n.bottom-r.top)))return!1}}return!0}))}(e,t,o):function(e,t,o){let{$head:n}=t.selection;if(!n.parent.isTextblock)return!1;let r=n.parentOffset,i=!r,a=r==n.parent.content.size,s=e.domSelection();return s?na.test(n.parent.textContent)&&s.modify?oa(e,t,(()=>{let{focusNode:t,focusOffset:r,anchorNode:i,anchorOffset:a}=e.domSelectionRange(),l=s.caretBidiLevel;s.modify("move",o,"character");let c=n.depth?e.docView.domAfterPos(n.before()):e.dom,{focusNode:d,focusOffset:u}=e.domSelectionRange(),p=d&&!c.contains(1==d.nodeType?d:d.parentNode)||t==d&&r==u;try{s.collapse(i,a),t&&(t!=i||r!=a)&&s.extend&&s.extend(t,r)}catch(h){}return null!=l&&(s.caretBidiLevel=l),p})):"left"==o||"backward"==o?i:a:n.pos==n.start()||n.pos==n.end()}(e,t,o))}class la{constructor(e,t,o,n){this.parent=e,this.children=t,this.dom=o,this.contentDOM=n,this.dirty=0,o.pmViewDesc=this}matchesWidget(e){return!1}matchesMark(e){return!1}matchesNode(e,t,o){return!1}matchesHack(e){return!1}parseRule(){return null}stopEvent(e){return!1}get size(){let e=0;for(let t=0;t<this.children.length;t++)e+=this.children[t].size;return e}get border(){return 0}destroy(){this.parent=void 0,this.dom.pmViewDesc==this&&(this.dom.pmViewDesc=void 0);for(let e=0;e<this.children.length;e++)this.children[e].destroy()}posBeforeChild(e){for(let t=0,o=this.posAtStart;;t++){let n=this.children[t];if(n==e)return o;o+=n.size}}get posBefore(){return this.parent.posBeforeChild(this)}get posAtStart(){return this.parent?this.parent.posBeforeChild(this)+this.border:0}get posAfter(){return this.posBefore+this.size}get posAtEnd(){return this.posAtStart+this.size-2*this.border}localPosFromDOM(e,t,o){if(this.contentDOM&&this.contentDOM.contains(1==e.nodeType?e:e.parentNode)){if(o<0){let o,n;if(e==this.contentDOM)o=e.childNodes[t-1];else{for(;e.parentNode!=this.contentDOM;)e=e.parentNode;o=e.previousSibling}for(;o&&(!(n=o.pmViewDesc)||n.parent!=this);)o=o.previousSibling;return o?this.posBeforeChild(n)+n.size:this.posAtStart}{let o,n;if(e==this.contentDOM)o=e.childNodes[t];else{for(;e.parentNode!=this.contentDOM;)e=e.parentNode;o=e.nextSibling}for(;o&&(!(n=o.pmViewDesc)||n.parent!=this);)o=o.nextSibling;return o?this.posBeforeChild(n):this.posAtEnd}}let n;if(e==this.dom&&this.contentDOM)n=t>ci(this.contentDOM);else if(this.contentDOM&&this.contentDOM!=this.dom&&this.dom.contains(this.contentDOM))n=2&e.compareDocumentPosition(this.contentDOM);else if(this.dom.firstChild){if(0==t)for(let t=e;;t=t.parentNode){if(t==this.dom){n=!1;break}if(t.previousSibling)break}if(null==n&&t==e.childNodes.length)for(let t=e;;t=t.parentNode){if(t==this.dom){n=!0;break}if(t.nextSibling)break}}return(null==n?o>0:n)?this.posAtEnd:this.posAtStart}nearestDesc(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];for(let o=!0,n=e;n;n=n.parentNode){let r,i=this.getDesc(n);if(i&&(!t||i.node)){if(!o||!(r=i.nodeDOM)||(1==r.nodeType?r.contains(1==e.nodeType?e:e.parentNode):r==e))return i;o=!1}}}getDesc(e){let t=e.pmViewDesc;for(let o=t;o;o=o.parent)if(o==this)return t}posFromDOM(e,t,o){for(let n=e;n;n=n.parentNode){let r=this.getDesc(n);if(r)return r.localPosFromDOM(e,t,o)}return-1}descAt(e){for(let t=0,o=0;t<this.children.length;t++){let n=this.children[t],r=o+n.size;if(o==e&&r!=o){for(;!n.border&&n.children.length;)for(let e=0;e<n.children.length;e++){let t=n.children[e];if(t.size){n=t;break}}return n}if(e<r)return n.descAt(e-o-n.border);o=r}}domFromPos(e,t){if(!this.contentDOM)return{node:this.dom,offset:0,atom:e+1};let o=0,n=0;for(let r=0;o<this.children.length;o++){let t=this.children[o],i=r+t.size;if(i>e||t instanceof ga){n=e-r;break}r=i}if(n)return this.children[o].domFromPos(n-this.children[o].border,t);for(let r;o&&!(r=this.children[o-1]).size&&r instanceof ca&&r.side>=0;o--);if(t<=0){let e,n=!0;for(;e=o?this.children[o-1]:null,e&&e.dom.parentNode!=this.contentDOM;o--,n=!1);return e&&t&&n&&!e.border&&!e.domAtom?e.domFromPos(e.size,t):{node:this.contentDOM,offset:e?ci(e.dom)+1:0}}{let e,n=!0;for(;e=o<this.children.length?this.children[o]:null,e&&e.dom.parentNode!=this.contentDOM;o++,n=!1);return e&&n&&!e.border&&!e.domAtom?e.domFromPos(0,t):{node:this.contentDOM,offset:e?ci(e.dom):this.contentDOM.childNodes.length}}}parseRange(e,t){let o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;if(0==this.children.length)return{node:this.contentDOM,from:e,to:t,fromOffset:0,toOffset:this.contentDOM.childNodes.length};let n=-1,r=-1;for(let i=o,a=0;;a++){let o=this.children[a],s=i+o.size;if(-1==n&&e<=s){let r=i+o.border;if(e>=r&&t<=s-o.border&&o.node&&o.contentDOM&&this.contentDOM.contains(o.contentDOM))return o.parseRange(e,t,r);e=i;for(let t=a;t>0;t--){let o=this.children[t-1];if(o.size&&o.dom.parentNode==this.contentDOM&&!o.emptyChildAt(1)){n=ci(o.dom)+1;break}e-=o.size}-1==n&&(n=0)}if(n>-1&&(s>t||a==this.children.length-1)){t=s;for(let e=a+1;e<this.children.length;e++){let o=this.children[e];if(o.size&&o.dom.parentNode==this.contentDOM&&!o.emptyChildAt(-1)){r=ci(o.dom);break}t+=o.size}-1==r&&(r=this.contentDOM.childNodes.length);break}i=s}return{node:this.contentDOM,from:e,to:t,fromOffset:n,toOffset:r}}emptyChildAt(e){if(this.border||!this.contentDOM||!this.children.length)return!1;let t=this.children[e<0?0:this.children.length-1];return 0==t.size||t.emptyChildAt(e)}domAfterPos(e){let{node:t,offset:o}=this.domFromPos(e,0);if(1!=t.nodeType||o==t.childNodes.length)throw new RangeError("No node after pos "+e);return t.childNodes[o]}setSelection(e,t,o){let n=arguments.length>3&&void 0!==arguments[3]&&arguments[3],r=Math.min(e,t),i=Math.max(e,t);for(let h=0,f=0;h<this.children.length;h++){let a=this.children[h],s=f+a.size;if(r>f&&i<s)return a.setSelection(e-f-a.border,t-f-a.border,o,n);f=s}let a=this.domFromPos(e,e?-1:1),s=t==e?a:this.domFromPos(t,t?-1:1),l=o.root.getSelection(),c=o.domSelectionRange(),d=!1;if((Ai||Di)&&e==t){let{node:e,offset:t}=a;if(3==e.nodeType){if(d=!(!t||"\n"!=e.nodeValue[t-1]),d&&t==e.nodeValue.length)for(let o,n=e;n;n=n.parentNode){if(o=n.nextSibling){"BR"==o.nodeName&&(a=s={node:o.parentNode,offset:ci(o)+1});break}let e=n.pmViewDesc;if(e&&e.node&&e.node.isBlock)break}}else{let o=e.childNodes[t-1];d=o&&("BR"==o.nodeName||"false"==o.contentEditable)}}if(Ai&&c.focusNode&&c.focusNode!=s.node&&1==c.focusNode.nodeType){let e=c.focusNode.childNodes[c.focusOffset];e&&"false"==e.contentEditable&&(n=!0)}if(!(n||d&&Di)&&hi(a.node,a.offset,c.anchorNode,c.anchorOffset)&&hi(s.node,s.offset,c.focusNode,c.focusOffset))return;let u=!1;if((l.extend||e==t)&&!d){l.collapse(a.node,a.offset);try{e!=t&&l.extend(s.node,s.offset),u=!0}catch(p){}}if(!u){if(e>t){let e=a;a=s,s=e}let o=document.createRange();o.setEnd(s.node,s.offset),o.setStart(a.node,a.offset),l.removeAllRanges(),l.addRange(o)}}ignoreMutation(e){return!this.contentDOM&&"selection"!=e.type}get contentLost(){return this.contentDOM&&this.contentDOM!=this.dom&&!this.dom.contains(this.contentDOM)}markDirty(e,t){for(let o=0,n=0;n<this.children.length;n++){let r=this.children[n],i=o+r.size;if(o==i?e<=i&&t>=o:e<i&&t>o){let n=o+r.border,a=i-r.border;if(e>=n&&t<=a)return this.dirty=e==o||t==i?2:1,void(e!=n||t!=a||!r.contentLost&&r.dom.parentNode==this.contentDOM?r.markDirty(e-n,t-n):r.dirty=3);r.dirty=r.dom!=r.contentDOM||r.dom.parentNode!=this.contentDOM||r.children.length?3:2}o=i}this.dirty=2}markParentsDirty(){let e=1;for(let t=this.parent;t;t=t.parent,e++){let o=1==e?2:1;t.dirty<o&&(t.dirty=o)}}get domAtom(){return!1}get ignoreForCoords(){return!1}isText(e){return!1}}class ca extends la{constructor(e,t,o,n){let r,i=t.type.toDOM;if("function"==typeof i&&(i=i(o,(()=>r?r.parent?r.parent.posBeforeChild(r):void 0:n))),!t.type.spec.raw){if(1!=i.nodeType){let e=document.createElement("span");e.appendChild(i),i=e}i.contentEditable="false",i.classList.add("ProseMirror-widget")}super(e,[],i,null),this.widget=t,this.widget=t,r=this}matchesWidget(e){return 0==this.dirty&&e.type.eq(this.widget.type)}parseRule(){return{ignore:!0}}stopEvent(e){let t=this.widget.spec.stopEvent;return!!t&&t(e)}ignoreMutation(e){return"selection"!=e.type||this.widget.spec.ignoreSelection}destroy(){this.widget.type.destroy(this.dom),super.destroy()}get domAtom(){return!0}get side(){return this.widget.type.side}}class da extends la{constructor(e,t,o,n){super(e,[],t,null),this.textDOM=o,this.text=n}get size(){return this.text.length}localPosFromDOM(e,t){return e!=this.textDOM?this.posAtStart+(t?this.size:0):this.posAtStart+t}domFromPos(e){return{node:this.textDOM,offset:e}}ignoreMutation(e){return"characterData"===e.type&&e.target.nodeValue==e.oldValue}}class ua extends la{constructor(e,t,o,n,r){super(e,[],o,n),this.mark=t,this.spec=r}static create(e,t,o,n){let r=n.nodeViews[t.type.name],i=r&&r(t,n,o);return i&&i.dom||(i=Un.renderSpec(document,t.type.spec.toDOM(t,o),null,t.attrs)),new ua(e,t,i.dom,i.contentDOM||i.dom,i)}parseRule(){return 3&this.dirty||this.mark.type.spec.reparseInView?null:{mark:this.mark.type.name,attrs:this.mark.attrs,contentElement:this.contentDOM}}matchesMark(e){return 3!=this.dirty&&this.mark.eq(e)}markDirty(e,t){if(super.markDirty(e,t),0!=this.dirty){let e=this.parent;for(;!e.node;)e=e.parent;e.dirty<this.dirty&&(e.dirty=this.dirty),this.dirty=0}}slice(e,t,o){let n=ua.create(this.parent,this.mark,!0,o),r=this.children,i=this.size;t<i&&(r=Aa(r,t,i,o)),e>0&&(r=Aa(r,0,e,o));for(let a=0;a<r.length;a++)r[a].parent=n;return n.children=r,n}ignoreMutation(e){return this.spec.ignoreMutation?this.spec.ignoreMutation(e):super.ignoreMutation(e)}destroy(){this.spec.destroy&&this.spec.destroy(),super.destroy()}}class pa extends la{constructor(e,t,o,n,r,i,a,s,l){super(e,[],r,i),this.node=t,this.outerDeco=o,this.innerDeco=n,this.nodeDOM=a}static create(e,t,o,n,r,i){let a,s=r.nodeViews[t.type.name],l=s&&s(t,r,(()=>a?a.parent?a.parent.posBeforeChild(a):void 0:i),o,n),c=l&&l.dom,d=l&&l.contentDOM;if(t.isText)if(c){if(3!=c.nodeType)throw new RangeError("Text must be rendered as a DOM text node")}else c=document.createTextNode(t.text);else if(!c){let e=Un.renderSpec(document,t.type.spec.toDOM(t),null,t.attrs);({dom:c,contentDOM:d}=e)}d||t.isText||"BR"==c.nodeName||(c.hasAttribute("contenteditable")||(c.contentEditable="false"),t.type.spec.draggable&&(c.draggable=!0));let u=c;return c=_a(c,o,t),l?a=new ma(e,t,o,n,c,d||null,u,l,r,i+1):t.isText?new fa(e,t,o,n,c,u,r):new pa(e,t,o,n,c,d||null,u,r,i+1)}parseRule(){if(this.node.type.spec.reparseInView)return null;let e={node:this.node.type.name,attrs:this.node.attrs};if("pre"==this.node.type.whitespace&&(e.preserveWhitespace="full"),this.contentDOM)if(this.contentLost){for(let t=this.children.length-1;t>=0;t--){let o=this.children[t];if(this.dom.contains(o.dom.parentNode)){e.contentElement=o.dom.parentNode;break}}e.contentElement||(e.getContent=()=>Vo.empty)}else e.contentElement=this.contentDOM;else e.getContent=()=>this.node.content;return e}matchesNode(e,t,o){return 0==this.dirty&&e.eq(this.node)&&Sa(t,this.outerDeco)&&o.eq(this.innerDeco)}get size(){return this.node.nodeSize}get border(){return this.node.isLeaf?0:1}updateChildren(e,t){let o=this.node.inlineContent,n=t,r=e.composing?this.localCompositionInfo(e,t):null,i=r&&r.pos>-1?r:null,a=r&&r.pos<0,s=new ka(this,i&&i.node,e);!function(e,t,o,n){let r=t.locals(e),i=0;if(0==r.length){for(let o=0;o<e.childCount;o++){let a=e.child(o);n(a,r,t.forChild(i,a),o),i+=a.nodeSize}return}let a=0,s=[],l=null;for(let c=0;;){let d,u,p,h;for(;a<r.length&&r[a].to==i;){let e=r[a++];e.widget&&(d?(u||(u=[d])).push(e):d=e)}if(d)if(u){u.sort(ja);for(let e=0;e<u.length;e++)o(u[e],c,!!l)}else o(d,c,!!l);if(l)h=-1,p=l,l=null;else{if(!(c<e.childCount))break;h=c,p=e.child(c++)}for(let e=0;e<s.length;e++)s[e].to<=i&&s.splice(e--,1);for(;a<r.length&&r[a].from<=i&&r[a].to>i;)s.push(r[a++]);let f=i+p.nodeSize;if(p.isText){let e=f;a<r.length&&r[a].from<e&&(e=r[a].from);for(let t=0;t<s.length;t++)s[t].to<e&&(e=s[t].to);e<f&&(l=p.cut(e-i),p=p.cut(0,e-i),f=e,h=-1)}else for(;a<r.length&&r[a].to<f;)a++;n(p,p.isInline&&!p.isLeaf?s.filter((e=>!e.inline)):s.slice(),t.forChild(i,p),h),i=f}}(this.node,this.innerDeco,((t,r,i)=>{t.spec.marks?s.syncToMarks(t.spec.marks,o,e):t.type.side>=0&&!i&&s.syncToMarks(r==this.node.childCount?qo.none:this.node.child(r).marks,o,e),s.placeWidget(t,e,n)}),((t,i,l,c)=>{let d;s.syncToMarks(t.marks,o,e),s.findNodeMatch(t,i,l,c)||a&&e.state.selection.from>n&&e.state.selection.to<n+t.nodeSize&&(d=s.findIndexWithChild(r.node))>-1&&s.updateNodeAt(t,i,l,d,e)||s.updateNextNode(t,i,l,e,c,n)||s.addNode(t,i,l,e,n),n+=t.nodeSize})),s.syncToMarks([],o,e),this.node.isTextblock&&s.addTextblockHacks(),s.destroyRest(),(s.changed||2==this.dirty)&&(i&&this.protectLocalComposition(e,i),ya(this.contentDOM,this.children,e),Pi&&function(e){if("UL"==e.nodeName||"OL"==e.nodeName){let t=e.style.cssText;e.style.cssText=t+"; list-style: square !important",window.getComputedStyle(e).listStyle,e.style.cssText=t}}(this.dom))}localCompositionInfo(e,t){let{from:o,to:n}=e.state.selection;if(!(e.state.selection instanceof $r)||o<t||n>t+this.node.content.size)return null;let r=e.input.compositionNode;if(!r||!this.dom.contains(r.parentNode))return null;if(this.node.inlineContent){let e=r.nodeValue,i=function(e,t,o,n){for(let r=0,i=0;r<e.childCount&&i<=n;){let a=e.child(r++),s=i;if(i+=a.nodeSize,!a.isText)continue;let l=a.text;for(;r<e.childCount;){let t=e.child(r++);if(i+=t.nodeSize,!t.isText)break;l+=t.text}if(i>=o){if(i>=n&&l.slice(n-t.length-s,n-s)==t)return n-t.length;let e=s<n?l.lastIndexOf(t,n-s-1):-1;if(e>=0&&e+t.length+s>=o)return s+e;if(o==n&&l.length>=n+t.length-s&&l.slice(n-s,n-s+t.length)==t)return n}}return-1}(this.node.content,e,o-t,n-t);return i<0?null:{node:r,pos:i,text:e}}return{node:r,pos:-1,text:""}}protectLocalComposition(e,t){let{node:o,pos:n,text:r}=t;if(this.getDesc(o))return;let i=o;for(;i.parentNode!=this.contentDOM;i=i.parentNode){for(;i.previousSibling;)i.parentNode.removeChild(i.previousSibling);for(;i.nextSibling;)i.parentNode.removeChild(i.nextSibling);i.pmViewDesc&&(i.pmViewDesc=void 0)}let a=new da(this,i,o,r);e.input.compositionNodes.push(a),this.children=Aa(this.children,n,n+r.length,e,a)}update(e,t,o,n){return!(3==this.dirty||!e.sameMarkup(this.node))&&(this.updateInner(e,t,o,n),!0)}updateInner(e,t,o,n){this.updateOuterDeco(t),this.node=e,this.innerDeco=o,this.contentDOM&&this.updateChildren(n,this.posAtStart),this.dirty=0}updateOuterDeco(e){if(Sa(e,this.outerDeco))return;let t=1!=this.nodeDOM.nodeType,o=this.dom;this.dom=wa(this.dom,this.nodeDOM,xa(this.outerDeco,this.node,t),xa(e,this.node,t)),this.dom!=o&&(o.pmViewDesc=void 0,this.dom.pmViewDesc=this),this.outerDeco=e}selectNode(){1==this.nodeDOM.nodeType&&this.nodeDOM.classList.add("ProseMirror-selectednode"),!this.contentDOM&&this.node.type.spec.draggable||(this.dom.draggable=!0)}deselectNode(){1==this.nodeDOM.nodeType&&(this.nodeDOM.classList.remove("ProseMirror-selectednode"),!this.contentDOM&&this.node.type.spec.draggable||this.dom.removeAttribute("draggable"))}get domAtom(){return this.node.isAtom}}function ha(e,t,o,n,r){_a(n,t,e);let i=new pa(void 0,e,t,o,n,n,n,r,0);return i.contentDOM&&i.updateChildren(r,0),i}class fa extends pa{constructor(e,t,o,n,r,i,a){super(e,t,o,n,r,null,i,a,0)}parseRule(){let e=this.nodeDOM.parentNode;for(;e&&e!=this.dom&&!e.pmIsDeco;)e=e.parentNode;return{skip:e||!0}}update(e,t,o,n){return!(3==this.dirty||0!=this.dirty&&!this.inParent()||!e.sameMarkup(this.node))&&(this.updateOuterDeco(t),0==this.dirty&&e.text==this.node.text||e.text==this.nodeDOM.nodeValue||(this.nodeDOM.nodeValue=e.text,n.trackWrites==this.nodeDOM&&(n.trackWrites=null)),this.node=e,this.dirty=0,!0)}inParent(){let e=this.parent.contentDOM;for(let t=this.nodeDOM;t;t=t.parentNode)if(t==e)return!0;return!1}domFromPos(e){return{node:this.nodeDOM,offset:e}}localPosFromDOM(e,t,o){return e==this.nodeDOM?this.posAtStart+Math.min(t,this.node.text.length):super.localPosFromDOM(e,t,o)}ignoreMutation(e){return"characterData"!=e.type&&"selection"!=e.type}slice(e,t,o){let n=this.node.cut(e,t),r=document.createTextNode(n.text);return new fa(this.parent,n,this.outerDeco,this.innerDeco,r,r,o)}markDirty(e,t){super.markDirty(e,t),this.dom==this.nodeDOM||0!=e&&t!=this.nodeDOM.nodeValue.length||(this.dirty=3)}get domAtom(){return!1}isText(e){return this.node.text==e}}class ga extends la{parseRule(){return{ignore:!0}}matchesHack(e){return 0==this.dirty&&this.dom.nodeName==e}get domAtom(){return!0}get ignoreForCoords(){return"IMG"==this.dom.nodeName}}class ma extends pa{constructor(e,t,o,n,r,i,a,s,l,c){super(e,t,o,n,r,i,a,l,c),this.spec=s}update(e,t,o,n){if(3==this.dirty)return!1;if(this.spec.update&&(this.node.type==e.type||this.spec.multiType)){let r=this.spec.update(e,t,o);return r&&this.updateInner(e,t,o,n),r}return!(!this.contentDOM&&!e.isLeaf)&&super.update(e,t,o,n)}selectNode(){this.spec.selectNode?this.spec.selectNode():super.selectNode()}deselectNode(){this.spec.deselectNode?this.spec.deselectNode():super.deselectNode()}setSelection(e,t,o,n){this.spec.setSelection?this.spec.setSelection(e,t,o.root):super.setSelection(e,t,o,n)}destroy(){this.spec.destroy&&this.spec.destroy(),super.destroy()}stopEvent(e){return!!this.spec.stopEvent&&this.spec.stopEvent(e)}ignoreMutation(e){return this.spec.ignoreMutation?this.spec.ignoreMutation(e):super.ignoreMutation(e)}}function ya(e,t,o){let n=e.firstChild,r=!1;for(let i=0;i<t.length;i++){let a=t[i],s=a.dom;if(s.parentNode==e){for(;s!=n;)n=Ea(n),r=!0;n=n.nextSibling}else r=!0,e.insertBefore(s,n);if(a instanceof ua){let t=n?n.previousSibling:e.lastChild;ya(a.contentDOM,a.children,o),n=t?t.nextSibling:e.firstChild}}for(;n;)n=Ea(n),r=!0;r&&o.trackWrites==e&&(o.trackWrites=null)}const va=function(e){e&&(this.nodeName=e)};va.prototype=Object.create(null);const ba=[new va];function xa(e,t,o){if(0==e.length)return ba;let n=o?ba[0]:new va,r=[n];for(let i=0;i<e.length;i++){let a=e[i].type.attrs;if(a){a.nodeName&&r.push(n=new va(a.nodeName));for(let e in a){let i=a[e];null!=i&&(o&&1==r.length&&r.push(n=new va(t.isInline?"span":"div")),"class"==e?n.class=(n.class?n.class+" ":"")+i:"style"==e?n.style=(n.style?n.style+";":"")+i:"nodeName"!=e&&(n[e]=i))}}}return r}function wa(e,t,o,n){if(o==ba&&n==ba)return t;let r=t;for(let i=0;i<n.length;i++){let t=n[i],a=o[i];if(i){let o;a&&a.nodeName==t.nodeName&&r!=e&&(o=r.parentNode)&&o.nodeName.toLowerCase()==t.nodeName||(o=document.createElement(t.nodeName),o.pmIsDeco=!0,o.appendChild(r),a=ba[0]),r=o}Ca(r,a||ba[0],t)}return r}function Ca(e,t,o){for(let n in t)"class"==n||"style"==n||"nodeName"==n||n in o||e.removeAttribute(n);for(let n in o)"class"!=n&&"style"!=n&&"nodeName"!=n&&o[n]!=t[n]&&e.setAttribute(n,o[n]);if(t.class!=o.class){let n=t.class?t.class.split(" ").filter(Boolean):[],r=o.class?o.class.split(" ").filter(Boolean):[];for(let t=0;t<n.length;t++)-1==r.indexOf(n[t])&&e.classList.remove(n[t]);for(let t=0;t<r.length;t++)-1==n.indexOf(r[t])&&e.classList.add(r[t]);0==e.classList.length&&e.removeAttribute("class")}if(t.style!=o.style){if(t.style){let o,n=/\s*([\w\-\xa1-\uffff]+)\s*:(?:"(?:\\.|[^"])*"|'(?:\\.|[^'])*'|\(.*?\)|[^;])*/g;for(;o=n.exec(t.style);)e.style.removeProperty(o[1])}o.style&&(e.style.cssText+=o.style)}}function _a(e,t,o){return wa(e,e,ba,xa(t,o,1!=e.nodeType))}function Sa(e,t){if(e.length!=t.length)return!1;for(let o=0;o<e.length;o++)if(!e[o].type.eq(t[o].type))return!1;return!0}function Ea(e){let t=e.nextSibling;return e.parentNode.removeChild(e),t}class ka{constructor(e,t,o){this.lock=t,this.view=o,this.index=0,this.stack=[],this.changed=!1,this.top=e,this.preMatch=function(e,t){let o=t,n=o.children.length,r=e.childCount,i=new Map,a=[];e:for(;r>0;){let s;for(;;)if(n){let e=o.children[n-1];if(!(e instanceof ua)){s=e,n--;break}o=e,n=e.children.length}else{if(o==t)break e;n=o.parent.children.indexOf(o),o=o.parent}let l=s.node;if(l){if(l!=e.child(r-1))break;--r,i.set(s,r),a.push(s)}}return{index:r,matched:i,matches:a.reverse()}}(e.node.content,e)}destroyBetween(e,t){if(e!=t){for(let o=e;o<t;o++)this.top.children[o].destroy();this.top.children.splice(e,t-e),this.changed=!0}}destroyRest(){this.destroyBetween(this.index,this.top.children.length)}syncToMarks(e,t,o){let n=0,r=this.stack.length>>1,i=Math.min(r,e.length);for(;n<i&&(n==r-1?this.top:this.stack[n+1<<1]).matchesMark(e[n])&&!1!==e[n].type.spec.spanning;)n++;for(;n<r;)this.destroyRest(),this.top.dirty=0,this.index=this.stack.pop(),this.top=this.stack.pop(),r--;for(;r<e.length;){this.stack.push(this.top,this.index+1);let n=-1;for(let t=this.index;t<Math.min(this.index+3,this.top.children.length);t++){let o=this.top.children[t];if(o.matchesMark(e[r])&&!this.isLocked(o.dom)){n=t;break}}if(n>-1)n>this.index&&(this.changed=!0,this.destroyBetween(this.index,n)),this.top=this.top.children[this.index];else{let n=ua.create(this.top,e[r],t,o);this.top.children.splice(this.index,0,n),this.top=n,this.changed=!0}this.index=0,r++}}findNodeMatch(e,t,o,n){let r,i=-1;if(n>=this.preMatch.index&&(r=this.preMatch.matches[n-this.preMatch.index]).parent==this.top&&r.matchesNode(e,t,o))i=this.top.children.indexOf(r,this.index);else for(let a=this.index,s=Math.min(this.top.children.length,a+5);a<s;a++){let n=this.top.children[a];if(n.matchesNode(e,t,o)&&!this.preMatch.matched.has(n)){i=a;break}}return!(i<0)&&(this.destroyBetween(this.index,i),this.index++,!0)}updateNodeAt(e,t,o,n,r){let i=this.top.children[n];return 3==i.dirty&&i.dom==i.contentDOM&&(i.dirty=2),!!i.update(e,t,o,r)&&(this.destroyBetween(this.index,n),this.index++,!0)}findIndexWithChild(e){for(;;){let t=e.parentNode;if(!t)return-1;if(t==this.top.contentDOM){let t=e.pmViewDesc;if(t)for(let e=this.index;e<this.top.children.length;e++)if(this.top.children[e]==t)return e;return-1}e=t}}updateNextNode(e,t,o,n,r,i){for(let a=this.index;a<this.top.children.length;a++){let s=this.top.children[a];if(s instanceof pa){let l=this.preMatch.matched.get(s);if(null!=l&&l!=r)return!1;let c,d=s.dom,u=this.isLocked(d)&&!(e.isText&&s.node&&s.node.isText&&s.nodeDOM.nodeValue==e.text&&3!=s.dirty&&Sa(t,s.outerDeco));if(!u&&s.update(e,t,o,n))return this.destroyBetween(this.index,a),s.dom!=d&&(this.changed=!0),this.index++,!0;if(!u&&(c=this.recreateWrapper(s,e,t,o,n,i)))return this.destroyBetween(this.index,a),this.top.children[this.index]=c,c.contentDOM&&(c.dirty=2,c.updateChildren(n,i+1),c.dirty=0),this.changed=!0,this.index++,!0;break}}return!1}recreateWrapper(e,t,o,n,r,i){if(e.dirty||t.isAtom||!e.children.length||!e.node.content.eq(t.content)||!Sa(o,e.outerDeco)||!n.eq(e.innerDeco))return null;let a=pa.create(this.top,t,o,n,r,i);if(a.contentDOM){a.children=e.children,e.children=[];for(let e of a.children)e.parent=a}return e.destroy(),a}addNode(e,t,o,n,r){let i=pa.create(this.top,e,t,o,n,r);i.contentDOM&&i.updateChildren(n,r+1),this.top.children.splice(this.index++,0,i),this.changed=!0}placeWidget(e,t,o){let n=this.index<this.top.children.length?this.top.children[this.index]:null;if(!n||!n.matchesWidget(e)||e!=n.widget&&n.widget.type.toDOM.parentNode){let n=new ca(this.top,e,t,o);this.top.children.splice(this.index++,0,n),this.changed=!0}else this.index++}addTextblockHacks(){let e=this.top.children[this.index-1],t=this.top;for(;e instanceof ua;)t=e,e=t.children[t.children.length-1];(!e||!(e instanceof fa)||/\n$/.test(e.node.text)||this.view.requiresGeckoHackNode&&/\s$/.test(e.node.text))&&((Di||Oi)&&e&&"false"==e.dom.contentEditable&&this.addHackNode("IMG",t),this.addHackNode("BR",this.top))}addHackNode(e,t){if(t==this.top&&this.index<t.children.length&&t.children[this.index].matchesHack(e))this.index++;else{let o=document.createElement(e);"IMG"==e&&(o.className="ProseMirror-separator",o.alt=""),"BR"==e&&(o.className="ProseMirror-trailingBreak");let n=new ga(this.top,[],o,null);t!=this.top?t.children.push(n):t.children.splice(this.index++,0,n),this.changed=!0}}isLocked(e){return this.lock&&(e==this.lock||1==e.nodeType&&e.contains(this.lock.parentNode))}}function ja(e,t){return e.type.side-t.type.side}function Aa(e,t,o,n,r){let i=[];for(let a=0,s=0;a<e.length;a++){let l=e[a],c=s,d=s+=l.size;c>=o||d<=t?i.push(l):(c<t&&i.push(l.slice(0,t-c,n)),r&&(i.push(r),r=void 0),d>o&&i.push(l.slice(o-c,l.size,n)))}return i}function Ra(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,o=e.domSelectionRange(),n=e.state.doc;if(!o.focusNode)return null;let r=e.docView.nearestDesc(o.focusNode),i=r&&0==r.size,a=e.docView.posFromDOM(o.focusNode,o.focusOffset,1);if(a<0)return null;let s,l,c=n.resolve(a);if(vi(o)){for(s=a;r&&!r.node;)r=r.parent;let e=r.node;if(r&&e.isAtom&&Wr.isSelectable(e)&&r.parent&&(!e.isInline||!function(e,t,o){for(let n=0==t,r=t==mi(e);n||r;){if(e==o)return!0;let t=ci(e);if(!(e=e.parentNode))return!1;n=n&&0==t,r=r&&t==mi(e)}}(o.focusNode,o.focusOffset,r.dom))){let e=r.posBefore;l=new Wr(a==e?c:n.resolve(e))}}else{if(o instanceof e.dom.ownerDocument.defaultView.Selection&&o.rangeCount>1){let t=a,r=a;for(let n=0;n<o.rangeCount;n++){let i=o.getRangeAt(n);t=Math.min(t,e.docView.posFromDOM(i.startContainer,i.startOffset,1)),r=Math.max(r,e.docView.posFromDOM(i.endContainer,i.endOffset,-1))}if(t<0)return null;[s,a]=r==e.state.selection.anchor?[r,t]:[t,r],c=n.resolve(a)}else s=e.docView.posFromDOM(o.anchorNode,o.anchorOffset,1);if(s<0)return null}let d=n.resolve(s);if(!l){l=Fa(e,d,c,"pointer"==t||e.state.selection.head<c.pos&&!i?1:-1)}return l}function Oa(e){return e.editable?e.hasFocus():za(e)&&document.activeElement&&document.activeElement.contains(e.dom)}function Ta(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],o=e.state.selection;if(Ma(e,o),Oa(e)){if(!t&&e.input.mouseDown&&e.input.mouseDown.allowDefault&&Oi){let t=e.domSelectionRange(),o=e.domObserver.currentSelection;if(t.anchorNode&&o.anchorNode&&hi(t.anchorNode,t.anchorOffset,o.anchorNode,o.anchorOffset))return e.input.mouseDown.delayedSelectionSync=!0,void e.domObserver.setCurSelection()}if(e.domObserver.disconnectSelection(),e.cursorWrapper)!function(e){let t=e.domSelection(),o=document.createRange();if(!t)return;let n=e.cursorWrapper.dom,r="IMG"==n.nodeName;r?o.setStart(n.parentNode,ci(n)+1):o.setStart(n,0);o.collapse(!0),t.removeAllRanges(),t.addRange(o),!r&&!e.state.selection.visible&&ki&&ji<=11&&(n.disabled=!0,n.disabled=!1)}(e);else{let n,r,{anchor:i,head:a}=o;!Da||o instanceof $r||(o.$from.parent.inlineContent||(n=Pa(e,o.from)),o.empty||o.$from.parent.inlineContent||(r=Pa(e,o.to))),e.docView.setSelection(i,a,e,t),Da&&(n&&Ia(n),r&&Ia(r)),o.visible?e.dom.classList.remove("ProseMirror-hideselection"):(e.dom.classList.add("ProseMirror-hideselection"),"onselectionchange"in document&&function(e){let t=e.dom.ownerDocument;t.removeEventListener("selectionchange",e.input.hideSelectionGuard);let o=e.domSelectionRange(),n=o.anchorNode,r=o.anchorOffset;t.addEventListener("selectionchange",e.input.hideSelectionGuard=()=>{o.anchorNode==n&&o.anchorOffset==r||(t.removeEventListener("selectionchange",e.input.hideSelectionGuard),setTimeout((()=>{Oa(e)&&!e.state.selection.visible||e.dom.classList.remove("ProseMirror-hideselection")}),20))})}(e))}e.domObserver.setCurSelection(),e.domObserver.connectSelection()}}const Da=Di||Oi&&Ti<63;function Pa(e,t){let{node:o,offset:n}=e.docView.domFromPos(t,0),r=n<o.childNodes.length?o.childNodes[n]:null,i=n?o.childNodes[n-1]:null;if(Di&&r&&"false"==r.contentEditable)return Na(r);if((!r||"false"==r.contentEditable)&&(!i||"false"==i.contentEditable)){if(r)return Na(r);if(i)return Na(i)}}function Na(e){return e.contentEditable="true",Di&&e.draggable&&(e.draggable=!1,e.wasDraggable=!0),e}function Ia(e){e.contentEditable="false",e.wasDraggable&&(e.draggable=!0,e.wasDraggable=null)}function Ma(e,t){if(t instanceof Wr){let o=e.docView.descAt(t.from);o!=e.lastSelectedViewDesc&&(La(e),o&&o.selectNode(),e.lastSelectedViewDesc=o)}else La(e)}function La(e){e.lastSelectedViewDesc&&(e.lastSelectedViewDesc.parent&&e.lastSelectedViewDesc.deselectNode(),e.lastSelectedViewDesc=void 0)}function Fa(e,t,o,n){return e.someProp("createSelectionBetween",(n=>n(e,t,o)))||$r.between(t,o,n)}function Ga(e){return!(e.editable&&!e.hasFocus())&&za(e)}function za(e){let t=e.domSelectionRange();if(!t.anchorNode)return!1;try{return e.dom.contains(3==t.anchorNode.nodeType?t.anchorNode.parentNode:t.anchorNode)&&(e.editable||e.dom.contains(3==t.focusNode.nodeType?t.focusNode.parentNode:t.focusNode))}catch(o){return!1}}function Ha(e,t){let{$anchor:o,$head:n}=e.selection,r=t>0?o.max(n):o.min(n),i=r.parent.inlineContent?r.depth?e.doc.resolve(t>0?r.after():r.before()):null:r;return i&&zr.findFrom(i,t)}function Ba(e,t){return e.dispatch(e.state.tr.setSelection(t).scrollIntoView()),!0}function Va(e,t,o){let n=e.state.selection;if(!(n instanceof $r)){if(n instanceof Wr&&n.node.isInline)return Ba(e,new $r(t>0?n.$to:n.$from));{let o=Ha(e.state,t);return!!o&&Ba(e,o)}}if(o.indexOf("s")>-1){let{$head:o}=n,r=o.textOffset?null:t<0?o.nodeBefore:o.nodeAfter;if(!r||r.isText||!r.isLeaf)return!1;let i=e.state.doc.resolve(o.pos+r.nodeSize*(t<0?-1:1));return Ba(e,new $r(n.$anchor,i))}if(!n.empty)return!1;if(e.endOfTextblock(t>0?"forward":"backward")){let o=Ha(e.state,t);return!!(o&&o instanceof Wr)&&Ba(e,o)}if(!(Ni&&o.indexOf("m")>-1)){let o,r=n.$head,i=r.textOffset?null:t<0?r.nodeBefore:r.nodeAfter;if(!i||i.isText)return!1;let a=t<0?r.pos-i.nodeSize:r.pos;return!!(i.isAtom||(o=e.docView.descAt(a))&&!o.contentDOM)&&(Wr.isSelectable(i)?Ba(e,new Wr(t<0?e.state.doc.resolve(r.pos-i.nodeSize):r)):!!Li&&Ba(e,new $r(e.state.doc.resolve(t<0?a:a+i.nodeSize))))}}function $a(e){return 3==e.nodeType?e.nodeValue.length:e.childNodes.length}function Ua(e,t){let o=e.pmViewDesc;return o&&0==o.size&&(t<0||e.nextSibling||"BR"!=e.nodeName)}function Wa(e,t){return t<0?function(e){let t=e.domSelectionRange(),o=t.focusNode,n=t.focusOffset;if(!o)return;let r,i,a=!1;Ai&&1==o.nodeType&&n<$a(o)&&Ua(o.childNodes[n],-1)&&(a=!0);for(;;)if(n>0){if(1!=o.nodeType)break;{let e=o.childNodes[n-1];if(Ua(e,-1))r=o,i=--n;else{if(3!=e.nodeType)break;o=e,n=o.nodeValue.length}}}else{if(qa(o))break;{let t=o.previousSibling;for(;t&&Ua(t,-1);)r=o.parentNode,i=ci(t),t=t.previousSibling;if(t)o=t,n=$a(o);else{if(o=o.parentNode,o==e.dom)break;n=0}}}a?Ka(e,o,n):r&&Ka(e,r,i)}(e):function(e){let t=e.domSelectionRange(),o=t.focusNode,n=t.focusOffset;if(!o)return;let r,i,a=$a(o);for(;;)if(n<a){if(1!=o.nodeType)break;if(!Ua(o.childNodes[n],1))break;r=o,i=++n}else{if(qa(o))break;{let t=o.nextSibling;for(;t&&Ua(t,1);)r=t.parentNode,i=ci(t)+1,t=t.nextSibling;if(t)o=t,n=0,a=$a(o);else{if(o=o.parentNode,o==e.dom)break;n=a=0}}}r&&Ka(e,r,i)}(e)}function qa(e){let t=e.pmViewDesc;return t&&t.node&&t.node.isBlock}function Ka(e,t,o){if(3!=t.nodeType){let e,n;(n=function(e,t){for(;e&&t==e.childNodes.length&&!yi(e);)t=ci(e)+1,e=e.parentNode;for(;e&&t<e.childNodes.length;){let o=e.childNodes[t];if(3==o.nodeType)return o;if(1==o.nodeType&&"false"==o.contentEditable)break;e=o,t=0}}(t,o))?(t=n,o=0):(e=function(e,t){for(;e&&!t&&!yi(e);)t=ci(e),e=e.parentNode;for(;e&&t;){let o=e.childNodes[t-1];if(3==o.nodeType)return o;if(1==o.nodeType&&"false"==o.contentEditable)break;t=(e=o).childNodes.length}}(t,o))&&(t=e,o=e.nodeValue.length)}let n=e.domSelection();if(!n)return;if(vi(n)){let e=document.createRange();e.setEnd(t,o),e.setStart(t,o),n.removeAllRanges(),n.addRange(e)}else n.extend&&n.extend(t,o);e.domObserver.setCurSelection();let{state:r}=e;setTimeout((()=>{e.state==r&&Ta(e)}),50)}function Ya(e,t){let o=e.state.doc.resolve(t);if(!Oi&&!Ii&&o.parent.inlineContent){let n=e.coordsAtPos(t);if(t>o.start()){let o=e.coordsAtPos(t-1),r=(o.top+o.bottom)/2;if(r>n.top&&r<n.bottom&&Math.abs(o.left-n.left)>1)return o.left<n.left?"ltr":"rtl"}if(t<o.end()){let o=e.coordsAtPos(t+1),r=(o.top+o.bottom)/2;if(r>n.top&&r<n.bottom&&Math.abs(o.left-n.left)>1)return o.left>n.left?"ltr":"rtl"}}return"rtl"==getComputedStyle(e.dom).direction?"rtl":"ltr"}function Ja(e,t,o){let n=e.state.selection;if(n instanceof $r&&!n.empty||o.indexOf("s")>-1)return!1;if(Ni&&o.indexOf("m")>-1)return!1;let{$from:r,$to:i}=n;if(!r.parent.inlineContent||e.endOfTextblock(t<0?"up":"down")){let o=Ha(e.state,t);if(o&&o instanceof Wr)return Ba(e,o)}if(!r.parent.inlineContent){let o=t<0?r:i,a=n instanceof Kr?zr.near(o,t):zr.findFrom(o,t);return!!a&&Ba(e,a)}return!1}function Xa(e,t){if(!(e.state.selection instanceof $r))return!0;let{$head:o,$anchor:n,empty:r}=e.state.selection;if(!o.sameParent(n))return!0;if(!r)return!1;if(e.endOfTextblock(t>0?"forward":"backward"))return!0;let i=!o.textOffset&&(t<0?o.nodeBefore:o.nodeAfter);if(i&&!i.isText){let n=e.state.tr;return t<0?n.delete(o.pos-i.nodeSize,o.pos):n.delete(o.pos,o.pos+i.nodeSize),e.dispatch(n),!0}return!1}function Qa(e,t,o){e.domObserver.stop(),t.contentEditable=o,e.domObserver.start()}function Za(e,t){let o=t.keyCode,n=function(e){let t="";return e.ctrlKey&&(t+="c"),e.metaKey&&(t+="m"),e.altKey&&(t+="a"),e.shiftKey&&(t+="s"),t}(t);if(8==o||Ni&&72==o&&"c"==n)return Xa(e,-1)||Wa(e,-1);if(46==o&&!t.shiftKey||Ni&&68==o&&"c"==n)return Xa(e,1)||Wa(e,1);if(13==o||27==o)return!0;if(37==o||Ni&&66==o&&"c"==n){let t=37==o?"ltr"==Ya(e,e.state.selection.from)?-1:1:-1;return Va(e,t,n)||Wa(e,t)}if(39==o||Ni&&70==o&&"c"==n){let t=39==o?"ltr"==Ya(e,e.state.selection.from)?1:-1:1;return Va(e,t,n)||Wa(e,t)}return 38==o||Ni&&80==o&&"c"==n?Ja(e,-1,n)||Wa(e,-1):40==o||Ni&&78==o&&"c"==n?function(e){if(!Di||e.state.selection.$head.parentOffset>0)return!1;let{focusNode:t,focusOffset:o}=e.domSelectionRange();if(t&&1==t.nodeType&&0==o&&t.firstChild&&"false"==t.firstChild.contentEditable){let o=t.firstChild;Qa(e,o,"true"),setTimeout((()=>Qa(e,o,"false")),20)}return!1}(e)||Ja(e,1,n)||Wa(e,1):n==(Ni?"m":"c")&&(66==o||73==o||89==o||90==o)}function es(e,t){e.someProp("transformCopied",(o=>{t=o(t,e)}));let o=[],{content:n,openStart:r,openEnd:i}=t;for(;r>1&&i>1&&1==n.childCount&&1==n.firstChild.childCount;){r--,i--;let e=n.firstChild;o.push(e.type.name,e.attrs!=e.type.defaultAttrs?e.attrs:null),n=e.content}let a=e.someProp("clipboardSerializer")||Un.fromSchema(e.state.schema),s=us(),l=s.createElement("div");l.appendChild(a.serializeFragment(n,{document:s}));let c,d=l.firstChild,u=0;for(;d&&1==d.nodeType&&(c=cs[d.nodeName.toLowerCase()]);){for(let e=c.length-1;e>=0;e--){let t=s.createElement(c[e]);for(;l.firstChild;)t.appendChild(l.firstChild);l.appendChild(t),u++}d=l.firstChild}return d&&1==d.nodeType&&d.setAttribute("data-pm-slice",`${r} ${i}${u?` -${u}`:""} ${JSON.stringify(o)}`),{dom:l,text:e.someProp("clipboardTextSerializer",(o=>o(t,e)))||t.content.textBetween(0,t.content.size,"\n\n"),slice:t}}function ts(e,t,o,n,r){let i,a,s=r.parent.type.spec.code;if(!o&&!t)return null;let l=t&&(n||s||!o);if(l){if(e.someProp("transformPastedText",(o=>{t=o(t,s||n,e)})),s)return t?new Yo(Vo.from(e.state.schema.text(t.replace(/\r\n?/g,"\n"))),0,0):Yo.empty;let o=e.someProp("clipboardTextParser",(o=>o(t,r,n,e)));if(o)a=o;else{let o=r.marks(),{schema:n}=e.state,a=Un.fromSchema(n);i=document.createElement("div"),t.split(/(?:\r\n?|\n)+/).forEach((e=>{let t=i.appendChild(document.createElement("p"));e&&t.appendChild(a.serializeNode(n.text(e,o)))}))}}else e.someProp("transformPastedHTML",(t=>{o=t(o,e)})),i=function(e){let t=/^(\s*<meta [^>]*>)*/.exec(e);t&&(e=e.slice(t[0].length));let o,n=us().createElement("div"),r=/<([a-z][^>\s]+)/i.exec(e);(o=r&&cs[r[1].toLowerCase()])&&(e=o.map((e=>"<"+e+">")).join("")+e+o.map((e=>"</"+e+">")).reverse().join(""));if(n.innerHTML=function(e){let t=window.trustedTypes;if(!t)return e;ps||(ps=t.createPolicy("ProseMirrorClipboard",{createHTML:e=>e}));return ps.createHTML(e)}(e),o)for(let i=0;i<o.length;i++)n=n.querySelector(o[i])||n;return n}(o),Li&&function(e){let t=e.querySelectorAll(Oi?"span:not([class]):not([style])":"span.Apple-converted-space");for(let o=0;o<t.length;o++){let n=t[o];1==n.childNodes.length&&"\xa0"==n.textContent&&n.parentNode&&n.parentNode.replaceChild(e.ownerDocument.createTextNode(" "),n)}}(i);let c=i&&i.querySelector("[data-pm-slice]"),d=c&&/^(\d+) (\d+)(?: -(\d+))? (.*)/.exec(c.getAttribute("data-pm-slice")||"");if(d&&d[3])for(let u=+d[3];u>0;u--){let e=i.firstChild;for(;e&&1!=e.nodeType;)e=e.nextSibling;if(!e)break;i=e}if(!a){let t=e.someProp("clipboardParser")||e.someProp("domParser")||In.fromSchema(e.state.schema);a=t.parseSlice(i,{preserveWhitespace:!(!l&&!d),context:r,ruleFromNode:e=>"BR"!=e.nodeName||e.nextSibling||!e.parentNode||ns.test(e.parentNode.nodeName)?null:{ignore:!0}})}if(d)a=function(e,t){if(!e.size)return e;let o,n=e.content.firstChild.type.schema;try{o=JSON.parse(t)}catch(SM){return e}let{content:r,openStart:i,openEnd:a}=e;for(let s=o.length-2;s>=0;s-=2){let e=n.nodes[o[s]];if(!e||e.hasRequiredAttrs())break;r=Vo.from(e.create(o[s+1],r)),i++,a++}return new Yo(r,i,a)}(ls(a,+d[1],+d[2]),d[4]);else if(a=Yo.maxOpen(function(e,t){if(e.childCount<2)return e;for(let o=t.depth;o>=0;o--){let n,r=t.node(o).contentMatchAt(t.index(o)),i=[];if(e.forEach((e=>{if(!i)return;let t,o=r.findWrapping(e.type);if(!o)return i=null;if(t=i.length&&n.length&&is(o,n,e,i[i.length-1],0))i[i.length-1]=t;else{i.length&&(i[i.length-1]=as(i[i.length-1],n.length));let t=rs(e,o);i.push(t),r=r.matchType(t.type),n=o}})),i)return Vo.from(i)}return e}(a.content,r),!0),a.openStart||a.openEnd){let e=0,t=0;for(let o=a.content.firstChild;e<a.openStart&&!o.type.spec.isolating;e++,o=o.firstChild);for(let o=a.content.lastChild;t<a.openEnd&&!o.type.spec.isolating;t++,o=o.lastChild);a=ls(a,e,t)}return e.someProp("transformPasted",(t=>{a=t(a,e)})),a}const ns=/^(a|abbr|acronym|b|cite|code|del|em|i|ins|kbd|label|output|q|ruby|s|samp|span|strong|sub|sup|time|u|tt|var)$/i;function rs(e,t){let o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;for(let n=t.length-1;n>=o;n--)e=t[n].create(null,Vo.from(e));return e}function is(e,t,o,n,r){if(r<e.length&&r<t.length&&e[r]==t[r]){let i=is(e,t,o,n.lastChild,r+1);if(i)return n.copy(n.content.replaceChild(n.childCount-1,i));if(n.contentMatchAt(n.childCount).matchType(r==e.length-1?o.type:e[r+1]))return n.copy(n.content.append(Vo.from(rs(o,e,r+1))))}}function as(e,t){if(0==t)return e;let o=e.content.replaceChild(e.childCount-1,as(e.lastChild,t-1)),n=e.contentMatchAt(e.childCount).fillBefore(Vo.empty,!0);return e.copy(o.append(n))}function ss(e,t,o,n,r,i){let a=t<0?e.firstChild:e.lastChild,s=a.content;return e.childCount>1&&(i=0),r<n-1&&(s=ss(s,t,o,n,r+1,i)),r>=o&&(s=t<0?a.contentMatchAt(0).fillBefore(s,i<=r).append(s):s.append(a.contentMatchAt(a.childCount).fillBefore(Vo.empty,!0))),e.replaceChild(t<0?0:e.childCount-1,a.copy(s))}function ls(e,t,o){return t<e.openStart&&(e=new Yo(ss(e.content,-1,t,e.openStart,0,e.openEnd),t,e.openEnd)),o<e.openEnd&&(e=new Yo(ss(e.content,1,o,e.openEnd,0,0),e.openStart,o)),e}const cs={thead:["table"],tbody:["table"],tfoot:["table"],caption:["table"],colgroup:["table"],col:["table","colgroup"],tr:["table","tbody"],td:["table","tbody","tr"],th:["table","tbody","tr"]};let ds=null;function us(){return ds||(ds=document.implementation.createHTMLDocument("title"))}let ps=null;const hs={},fs={},gs={touchstart:!0,touchmove:!0};class ms{constructor(){this.shiftKey=!1,this.mouseDown=null,this.lastKeyCode=null,this.lastKeyCodeTime=0,this.lastClick={time:0,x:0,y:0,type:""},this.lastSelectionOrigin=null,this.lastSelectionTime=0,this.lastIOSEnter=0,this.lastIOSEnterFallbackTimeout=-1,this.lastFocus=0,this.lastTouch=0,this.lastChromeDelete=0,this.composing=!1,this.compositionNode=null,this.composingTimeout=-1,this.compositionNodes=[],this.compositionEndedAt=-2e8,this.compositionID=1,this.compositionPendingChanges=0,this.domChangeCount=0,this.eventHandlers=Object.create(null),this.hideSelectionGuard=null}}function ys(e,t){e.input.lastSelectionOrigin=t,e.input.lastSelectionTime=Date.now()}function vs(e){e.someProp("handleDOMEvents",(t=>{for(let o in t)e.input.eventHandlers[o]||e.dom.addEventListener(o,e.input.eventHandlers[o]=t=>bs(e,t))}))}function bs(e,t){return e.someProp("handleDOMEvents",(o=>{let n=o[t.type];return!!n&&(n(e,t)||t.defaultPrevented)}))}function xs(e,t){if(!t.bubbles)return!0;if(t.defaultPrevented)return!1;for(let o=t.target;o!=e.dom;o=o.parentNode)if(!o||11==o.nodeType||o.pmViewDesc&&o.pmViewDesc.stopEvent(t))return!1;return!0}function ws(e){return{left:e.clientX,top:e.clientY}}function Cs(e,t,o,n,r){if(-1==n)return!1;let i=e.state.doc.resolve(n);for(let a=i.depth+1;a>0;a--)if(e.someProp(t,(t=>a>i.depth?t(e,o,i.nodeAfter,i.before(a),r,!0):t(e,o,i.node(a),i.before(a),r,!1))))return!0;return!1}function _s(e,t,o){if(e.focused||e.focus(),e.state.selection.eq(t))return;let n=e.state.tr.setSelection(t);"pointer"==o&&n.setMeta("pointer",!0),e.dispatch(n)}function Ss(e,t,o,n,r){return Cs(e,"handleClickOn",t,o,n)||e.someProp("handleClick",(o=>o(e,t,n)))||(r?function(e,t){if(-1==t)return!1;let o,n,r=e.state.selection;r instanceof Wr&&(o=r.node);let i=e.state.doc.resolve(t);for(let a=i.depth+1;a>0;a--){let e=a>i.depth?i.nodeAfter:i.node(a);if(Wr.isSelectable(e)){n=o&&r.$from.depth>0&&a>=r.$from.depth&&i.before(r.$from.depth+1)==r.$from.pos?i.before(r.$from.depth):i.before(a);break}}return null!=n&&(_s(e,Wr.create(e.state.doc,n),"pointer"),!0)}(e,o):function(e,t){if(-1==t)return!1;let o=e.state.doc.resolve(t),n=o.nodeAfter;return!!(n&&n.isAtom&&Wr.isSelectable(n))&&(_s(e,new Wr(o),"pointer"),!0)}(e,o))}function Es(e,t,o,n){return Cs(e,"handleDoubleClickOn",t,o,n)||e.someProp("handleDoubleClick",(o=>o(e,t,n)))}function ks(e,t,o,n){return Cs(e,"handleTripleClickOn",t,o,n)||e.someProp("handleTripleClick",(o=>o(e,t,n)))||function(e,t,o){if(0!=o.button)return!1;let n=e.state.doc;if(-1==t)return!!n.inlineContent&&(_s(e,$r.create(n,0,n.content.size),"pointer"),!0);let r=n.resolve(t);for(let i=r.depth+1;i>0;i--){let t=i>r.depth?r.nodeAfter:r.node(i),o=r.before(i);if(t.inlineContent)_s(e,$r.create(n,o+1,o+1+t.content.size),"pointer");else{if(!Wr.isSelectable(t))continue;_s(e,Wr.create(n,o),"pointer")}return!0}}(e,o,n)}function js(e){return Is(e)}fs.keydown=(e,t)=>{let o=t;if(e.input.shiftKey=16==o.keyCode||o.shiftKey,!Os(e,o)&&(e.input.lastKeyCode=o.keyCode,e.input.lastKeyCodeTime=Date.now(),!Mi||!Oi||13!=o.keyCode))if(229!=o.keyCode&&e.domObserver.forceFlush(),!Pi||13!=o.keyCode||o.ctrlKey||o.altKey||o.metaKey)e.someProp("handleKeyDown",(t=>t(e,o)))||Za(e,o)?o.preventDefault():ys(e,"key");else{let t=Date.now();e.input.lastIOSEnter=t,e.input.lastIOSEnterFallbackTimeout=setTimeout((()=>{e.input.lastIOSEnter==t&&(e.someProp("handleKeyDown",(t=>t(e,bi(13,"Enter")))),e.input.lastIOSEnter=0)}),200)}},fs.keyup=(e,t)=>{16==t.keyCode&&(e.input.shiftKey=!1)},fs.keypress=(e,t)=>{let o=t;if(Os(e,o)||!o.charCode||o.ctrlKey&&!o.altKey||Ni&&o.metaKey)return;if(e.someProp("handleKeyPress",(t=>t(e,o))))return void o.preventDefault();let n=e.state.selection;if(!(n instanceof $r)||!n.$from.sameParent(n.$to)){let t=String.fromCharCode(o.charCode);/[\r\n]/.test(t)||e.someProp("handleTextInput",(o=>o(e,n.$from.pos,n.$to.pos,t)))||e.dispatch(e.state.tr.insertText(t).scrollIntoView()),o.preventDefault()}};const As=Ni?"metaKey":"ctrlKey";hs.mousedown=(e,t)=>{let o=t;e.input.shiftKey=o.shiftKey;let n=js(e),r=Date.now(),i="singleClick";r-e.input.lastClick.time<500&&function(e,t){let o=t.x-e.clientX,n=t.y-e.clientY;return o*o+n*n<100}(o,e.input.lastClick)&&!o[As]&&("singleClick"==e.input.lastClick.type?i="doubleClick":"doubleClick"==e.input.lastClick.type&&(i="tripleClick")),e.input.lastClick={time:r,x:o.clientX,y:o.clientY,type:i};let a=e.posAtCoords(ws(o));a&&("singleClick"==i?(e.input.mouseDown&&e.input.mouseDown.done(),e.input.mouseDown=new Rs(e,a,o,!!n)):("doubleClick"==i?Es:ks)(e,a.pos,a.inside,o)?o.preventDefault():ys(e,"pointer"))};class Rs{constructor(e,t,o,n){let r,i;if(this.view=e,this.pos=t,this.event=o,this.flushed=n,this.delayedSelectionSync=!1,this.mightDrag=null,this.startDoc=e.state.doc,this.selectNode=!!o[As],this.allowDefault=o.shiftKey,t.inside>-1)r=e.state.doc.nodeAt(t.inside),i=t.inside;else{let o=e.state.doc.resolve(t.pos);r=o.parent,i=o.depth?o.before():0}const a=n?null:o.target,s=a?e.docView.nearestDesc(a,!0):null;this.target=s&&1==s.dom.nodeType?s.dom:null;let{selection:l}=e.state;(0==o.button&&r.type.spec.draggable&&!1!==r.type.spec.selectable||l instanceof Wr&&l.from<=i&&l.to>i)&&(this.mightDrag={node:r,pos:i,addAttr:!(!this.target||this.target.draggable),setUneditable:!(!this.target||!Ai||this.target.hasAttribute("contentEditable"))}),this.target&&this.mightDrag&&(this.mightDrag.addAttr||this.mightDrag.setUneditable)&&(this.view.domObserver.stop(),this.mightDrag.addAttr&&(this.target.draggable=!0),this.mightDrag.setUneditable&&setTimeout((()=>{this.view.input.mouseDown==this&&this.target.setAttribute("contentEditable","false")}),20),this.view.domObserver.start()),e.root.addEventListener("mouseup",this.up=this.up.bind(this)),e.root.addEventListener("mousemove",this.move=this.move.bind(this)),ys(e,"pointer")}done(){this.view.root.removeEventListener("mouseup",this.up),this.view.root.removeEventListener("mousemove",this.move),this.mightDrag&&this.target&&(this.view.domObserver.stop(),this.mightDrag.addAttr&&this.target.removeAttribute("draggable"),this.mightDrag.setUneditable&&this.target.removeAttribute("contentEditable"),this.view.domObserver.start()),this.delayedSelectionSync&&setTimeout((()=>Ta(this.view))),this.view.input.mouseDown=null}up(e){if(this.done(),!this.view.dom.contains(e.target))return;let t=this.pos;this.view.state.doc!=this.startDoc&&(t=this.view.posAtCoords(ws(e))),this.updateAllowDefault(e),this.allowDefault||!t?ys(this.view,"pointer"):Ss(this.view,t.pos,t.inside,e,this.selectNode)?e.preventDefault():0==e.button&&(this.flushed||Di&&this.mightDrag&&!this.mightDrag.node.isAtom||Oi&&!this.view.state.selection.visible&&Math.min(Math.abs(t.pos-this.view.state.selection.from),Math.abs(t.pos-this.view.state.selection.to))<=2)?(_s(this.view,zr.near(this.view.state.doc.resolve(t.pos)),"pointer"),e.preventDefault()):ys(this.view,"pointer")}move(e){this.updateAllowDefault(e),ys(this.view,"pointer"),0==e.buttons&&this.done()}updateAllowDefault(e){!this.allowDefault&&(Math.abs(this.event.x-e.clientX)>4||Math.abs(this.event.y-e.clientY)>4)&&(this.allowDefault=!0)}}function Os(e,t){return!!e.composing||!!(Di&&Math.abs(t.timeStamp-e.input.compositionEndedAt)<500)&&(e.input.compositionEndedAt=-2e8,!0)}hs.touchstart=e=>{e.input.lastTouch=Date.now(),js(e),ys(e,"pointer")},hs.touchmove=e=>{e.input.lastTouch=Date.now(),ys(e,"pointer")},hs.contextmenu=e=>js(e);const Ts=Mi?5e3:-1;function Ds(e,t){clearTimeout(e.input.composingTimeout),t>-1&&(e.input.composingTimeout=setTimeout((()=>Is(e)),t))}function Ps(e){for(e.composing&&(e.input.composing=!1,e.input.compositionEndedAt=function(){let e=document.createEvent("Event");return e.initEvent("event",!0,!0),e.timeStamp}());e.input.compositionNodes.length>0;)e.input.compositionNodes.pop().markParentsDirty()}function Ns(e){let t=e.domSelectionRange();if(!t.focusNode)return null;let o=function(e,t){for(;;){if(3==e.nodeType&&t)return e;if(1==e.nodeType&&t>0){if("false"==e.contentEditable)return null;t=mi(e=e.childNodes[t-1])}else{if(!e.parentNode||yi(e))return null;t=ci(e),e=e.parentNode}}}(t.focusNode,t.focusOffset),n=function(e,t){for(;;){if(3==e.nodeType&&t<e.nodeValue.length)return e;if(1==e.nodeType&&t<e.childNodes.length){if("false"==e.contentEditable)return null;e=e.childNodes[t],t=0}else{if(!e.parentNode||yi(e))return null;t=ci(e)+1,e=e.parentNode}}}(t.focusNode,t.focusOffset);if(o&&n&&o!=n){let t=n.pmViewDesc,r=e.domObserver.lastChangedTextNode;if(o==r||n==r)return r;if(!t||!t.isText(n.nodeValue))return n;if(e.input.compositionNode==n){let e=o.pmViewDesc;if(e&&e.isText(o.nodeValue))return n}}return o||n}function Is(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(!(Mi&&e.domObserver.flushingSoon>=0)){if(e.domObserver.forceFlush(),Ps(e),t||e.docView&&e.docView.dirty){let o=Ra(e);return o&&!o.eq(e.state.selection)?e.dispatch(e.state.tr.setSelection(o)):!e.markCursor&&!t||e.state.selection.empty?e.updateState(e.state):e.dispatch(e.state.tr.deleteSelection()),!0}return!1}}fs.compositionstart=fs.compositionupdate=e=>{if(!e.composing){e.domObserver.flush();let{state:t}=e,o=t.selection.$to;if(t.selection instanceof $r&&(t.storedMarks||!o.textOffset&&o.parentOffset&&o.nodeBefore.marks.some((e=>!1===e.type.spec.inclusive))))e.markCursor=e.state.storedMarks||o.marks(),Is(e,!0),e.markCursor=null;else if(Is(e,!t.selection.empty),Ai&&t.selection.empty&&o.parentOffset&&!o.textOffset&&o.nodeBefore.marks.length){let t=e.domSelectionRange();for(let o=t.focusNode,n=t.focusOffset;o&&1==o.nodeType&&0!=n;){let t=n<0?o.lastChild:o.childNodes[n-1];if(!t)break;if(3==t.nodeType){let o=e.domSelection();o&&o.collapse(t,t.nodeValue.length);break}o=t,n=-1}}e.input.composing=!0}Ds(e,Ts)},fs.compositionend=(e,t)=>{e.composing&&(e.input.composing=!1,e.input.compositionEndedAt=t.timeStamp,e.input.compositionPendingChanges=e.domObserver.pendingRecords().length?e.input.compositionID:0,e.input.compositionNode=null,e.input.compositionPendingChanges&&Promise.resolve().then((()=>e.domObserver.flush())),e.input.compositionID++,Ds(e,20))};const Ms=ki&&ji<15||Pi&&Fi<604;function Ls(e,t,o,n,r){let i=ts(e,t,o,n,e.state.selection.$from);if(e.someProp("handlePaste",(t=>t(e,r,i||Yo.empty))))return!0;if(!i)return!1;let a=function(e){return 0==e.openStart&&0==e.openEnd&&1==e.content.childCount?e.content.firstChild:null}(i),s=a?e.state.tr.replaceSelectionWith(a,n):e.state.tr.replaceSelection(i);return e.dispatch(s.scrollIntoView().setMeta("paste",!0).setMeta("uiEvent","paste")),!0}function Fs(e){let t=e.getData("text/plain")||e.getData("Text");if(t)return t;let o=e.getData("text/uri-list");return o?o.replace(/\r?\n/g," "):""}hs.copy=fs.cut=(e,t)=>{let o=t,n=e.state.selection,r="cut"==o.type;if(n.empty)return;let i=Ms?null:o.clipboardData,a=n.content(),{dom:s,text:l}=es(e,a);i?(o.preventDefault(),i.clearData(),i.setData("text/html",s.innerHTML),i.setData("text/plain",l)):function(e,t){if(!e.dom.parentNode)return;let o=e.dom.parentNode.appendChild(document.createElement("div"));o.appendChild(t),o.style.cssText="position: fixed; left: -10000px; top: 10px";let n=getSelection(),r=document.createRange();r.selectNodeContents(t),e.dom.blur(),n.removeAllRanges(),n.addRange(r),setTimeout((()=>{o.parentNode&&o.parentNode.removeChild(o),e.focus()}),50)}(e,s),r&&e.dispatch(e.state.tr.deleteSelection().scrollIntoView().setMeta("uiEvent","cut"))},fs.paste=(e,t)=>{let o=t;if(e.composing&&!Mi)return;let n=Ms?null:o.clipboardData,r=e.input.shiftKey&&45!=e.input.lastKeyCode;n&&Ls(e,Fs(n),n.getData("text/html"),r,o)?o.preventDefault():function(e,t){if(!e.dom.parentNode)return;let o=e.input.shiftKey||e.state.selection.$from.parent.type.spec.code,n=e.dom.parentNode.appendChild(document.createElement(o?"textarea":"div"));o||(n.contentEditable="true"),n.style.cssText="position: fixed; left: -10000px; top: 10px",n.focus();let r=e.input.shiftKey&&45!=e.input.lastKeyCode;setTimeout((()=>{e.focus(),n.parentNode&&n.parentNode.removeChild(n),o?Ls(e,n.value,null,r,t):Ls(e,n.textContent,n.innerHTML,r,t)}),50)}(e,o)};class Gs{constructor(e,t,o){this.slice=e,this.move=t,this.node=o}}const zs=Ni?"altKey":"ctrlKey";hs.dragstart=(e,t)=>{let o=t,n=e.input.mouseDown;if(n&&n.done(),!o.dataTransfer)return;let r,i=e.state.selection,a=i.empty?null:e.posAtCoords(ws(o));if(a&&a.pos>=i.from&&a.pos<=(i instanceof Wr?i.to-1:i.to));else if(n&&n.mightDrag)r=Wr.create(e.state.doc,n.mightDrag.pos);else if(o.target&&1==o.target.nodeType){let t=e.docView.nearestDesc(o.target,!0);t&&t.node.type.spec.draggable&&t!=e.docView&&(r=Wr.create(e.state.doc,t.posBefore))}let s=(r||e.state.selection).content(),{dom:l,text:c,slice:d}=es(e,s);(!o.dataTransfer.files.length||!Oi||Ti>120)&&o.dataTransfer.clearData(),o.dataTransfer.setData(Ms?"Text":"text/html",l.innerHTML),o.dataTransfer.effectAllowed="copyMove",Ms||o.dataTransfer.setData("text/plain",c),e.dragging=new Gs(d,!o[zs],r)},hs.dragend=e=>{let t=e.dragging;window.setTimeout((()=>{e.dragging==t&&(e.dragging=null)}),50)},fs.dragover=fs.dragenter=(e,t)=>t.preventDefault(),fs.drop=(e,t)=>{let o=t,n=e.dragging;if(e.dragging=null,!o.dataTransfer)return;let r=e.posAtCoords(ws(o));if(!r)return;let i=e.state.doc.resolve(r.pos),a=n&&n.slice;a?e.someProp("transformPasted",(t=>{a=t(a,e)})):a=ts(e,Fs(o.dataTransfer),Ms?null:o.dataTransfer.getData("text/html"),!1,i);let s=!(!n||o[zs]);if(e.someProp("handleDrop",(t=>t(e,o,a||Yo.empty,s))))return void o.preventDefault();if(!a)return;o.preventDefault();let l=a?Sr(e.state.doc,i.pos,a):i.pos;null==l&&(l=i.pos);let c=e.state.tr;if(s){let{node:e}=n;e?e.replace(c):c.deleteSelection()}let d=c.mapping.map(l),u=0==a.openStart&&0==a.openEnd&&1==a.content.childCount,p=c.doc;if(u?c.replaceRangeWith(d,d,a.content.firstChild):c.replaceRange(d,d,a),c.doc.eq(p))return;let h=c.doc.resolve(d);if(u&&Wr.isSelectable(a.content.firstChild)&&h.nodeAfter&&h.nodeAfter.sameMarkup(a.content.firstChild))c.setSelection(new Wr(h));else{let t=c.mapping.map(l);c.mapping.maps[c.mapping.maps.length-1].forEach(((e,o,n,r)=>t=r)),c.setSelection(Fa(e,h,c.doc.resolve(t)))}e.focus(),e.dispatch(c.setMeta("uiEvent","drop"))},hs.focus=e=>{e.input.lastFocus=Date.now(),e.focused||(e.domObserver.stop(),e.dom.classList.add("ProseMirror-focused"),e.domObserver.start(),e.focused=!0,setTimeout((()=>{e.docView&&e.hasFocus()&&!e.domObserver.currentSelection.eq(e.domSelectionRange())&&Ta(e)}),20))},hs.blur=(e,t)=>{let o=t;e.focused&&(e.domObserver.stop(),e.dom.classList.remove("ProseMirror-focused"),e.domObserver.start(),o.relatedTarget&&e.dom.contains(o.relatedTarget)&&e.domObserver.currentSelection.clear(),e.focused=!1)},hs.beforeinput=(e,t)=>{if(Oi&&Mi&&"deleteContentBackward"==t.inputType){e.domObserver.flushSoon();let{domChangeCount:t}=e.input;setTimeout((()=>{if(e.input.domChangeCount!=t)return;if(e.dom.blur(),e.focus(),e.someProp("handleKeyDown",(t=>t(e,bi(8,"Backspace")))))return;let{$cursor:o}=e.state.selection;o&&o.pos>0&&e.dispatch(e.state.tr.delete(o.pos-1,o.pos).scrollIntoView())}),50)}};for(let o in fs)hs[o]=fs[o];function Hs(e,t){if(e==t)return!0;for(let o in e)if(e[o]!==t[o])return!1;for(let o in t)if(!(o in e))return!1;return!0}class Bs{constructor(e,t){this.toDOM=e,this.spec=t||qs,this.side=this.spec.side||0}map(e,t,o,n){let{pos:r,deleted:i}=e.mapResult(t.from+n,this.side<0?-1:1);return i?null:new Us(r-o,r-o,this)}valid(){return!0}eq(e){return this==e||e instanceof Bs&&(this.spec.key&&this.spec.key==e.spec.key||this.toDOM==e.toDOM&&Hs(this.spec,e.spec))}destroy(e){this.spec.destroy&&this.spec.destroy(e)}}class Vs{constructor(e,t){this.attrs=e,this.spec=t||qs}map(e,t,o,n){let r=e.map(t.from+n,this.spec.inclusiveStart?-1:1)-o,i=e.map(t.to+n,this.spec.inclusiveEnd?1:-1)-o;return r>=i?null:new Us(r,i,this)}valid(e,t){return t.from<t.to}eq(e){return this==e||e instanceof Vs&&Hs(this.attrs,e.attrs)&&Hs(this.spec,e.spec)}static is(e){return e.type instanceof Vs}destroy(){}}class $s{constructor(e,t){this.attrs=e,this.spec=t||qs}map(e,t,o,n){let r=e.mapResult(t.from+n,1);if(r.deleted)return null;let i=e.mapResult(t.to+n,-1);return i.deleted||i.pos<=r.pos?null:new Us(r.pos-o,i.pos-o,this)}valid(e,t){let o,{index:n,offset:r}=e.content.findIndex(t.from);return r==t.from&&!(o=e.child(n)).isText&&r+o.nodeSize==t.to}eq(e){return this==e||e instanceof $s&&Hs(this.attrs,e.attrs)&&Hs(this.spec,e.spec)}destroy(){}}class Us{constructor(e,t,o){this.from=e,this.to=t,this.type=o}copy(e,t){return new Us(e,t,this.type)}eq(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return this.type.eq(e.type)&&this.from+t==e.from&&this.to+t==e.to}map(e,t,o){return this.type.map(e,this,t,o)}static widget(e,t,o){return new Us(e,e,new Bs(t,o))}static inline(e,t,o,n){return new Us(e,t,new Vs(o,n))}static node(e,t,o,n){return new Us(e,t,new $s(o,n))}get spec(){return this.type.spec}get inline(){return this.type instanceof Vs}get widget(){return this.type instanceof Bs}}const Ws=[],qs={};class Ks{constructor(e,t){this.local=e.length?e:Ws,this.children=t.length?t:Ws}static create(e,t){return t.length?el(t,e,0,qs):Ys}find(e,t,o){let n=[];return this.findInner(null==e?0:e,null==t?1e9:t,n,0,o),n}findInner(e,t,o,n,r){for(let i=0;i<this.local.length;i++){let a=this.local[i];a.from<=t&&a.to>=e&&(!r||r(a.spec))&&o.push(a.copy(a.from+n,a.to+n))}for(let i=0;i<this.children.length;i+=3)if(this.children[i]<t&&this.children[i+1]>e){let a=this.children[i]+1;this.children[i+2].findInner(e-a,t-a,o,n+a,r)}}map(e,t,o){return this==Ys||0==e.maps.length?this:this.mapInner(e,t,0,0,o||qs)}mapInner(e,t,o,n,r){let i;for(let a=0;a<this.local.length;a++){let s=this.local[a].map(e,o,n);s&&s.type.valid(t,s)?(i||(i=[])).push(s):r.onRemove&&r.onRemove(this.local[a].spec)}return this.children.length?function(e,t,o,n,r,i,a){let s=e.slice();for(let c=0,d=i;c<o.maps.length;c++){let e=0;o.maps[c].forEach(((t,o,n,r)=>{let i=r-n-(o-t);for(let a=0;a<s.length;a+=3){let n=s[a+1];if(n<0||t>n+d-e)continue;let r=s[a]+d-e;o>=r?s[a+1]=t<=r?-2:-1:t>=d&&i&&(s[a]+=i,s[a+1]+=i)}e+=i})),d=o.maps[c].map(d,-1)}let l=!1;for(let c=0;c<s.length;c+=3)if(s[c+1]<0){if(-2==s[c+1]){l=!0,s[c+1]=-1;continue}let t=o.map(e[c]+i),d=t-r;if(d<0||d>=n.content.size){l=!0;continue}let u=o.map(e[c+1]+i,-1)-r,{index:p,offset:h}=n.content.findIndex(d),f=n.maybeChild(p);if(f&&h==d&&h+f.nodeSize==u){let n=s[c+2].mapInner(o,f,t+1,e[c]+i+1,a);n!=Ys?(s[c]=d,s[c+1]=u,s[c+2]=n):(s[c+1]=-2,l=!0)}else l=!0}if(l){let l=function(e,t,o,n,r,i,a){function s(e,t){for(let i=0;i<e.local.length;i++){let s=e.local[i].map(n,r,t);s?o.push(s):a.onRemove&&a.onRemove(e.local[i].spec)}for(let o=0;o<e.children.length;o+=3)s(e.children[o+2],e.children[o]+t+1)}for(let l=0;l<e.length;l+=3)-1==e[l+1]&&s(e[l+2],t[l]+i+1);return o}(s,e,t,o,r,i,a),c=el(l,n,0,a);t=c.local;for(let e=0;e<s.length;e+=3)s[e+1]<0&&(s.splice(e,3),e-=3);for(let e=0,t=0;e<c.children.length;e+=3){let o=c.children[e];for(;t<s.length&&s[t]<o;)t+=3;s.splice(t,0,c.children[e],c.children[e+1],c.children[e+2])}}return new Ks(t.sort(tl),s)}(this.children,i||[],e,t,o,n,r):i?new Ks(i.sort(tl),Ws):Ys}add(e,t){return t.length?this==Ys?Ks.create(e,t):this.addInner(e,t,0):this}addInner(e,t,o){let n,r=0;e.forEach(((e,i)=>{let a,s=i+o;if(a=Qs(t,e,s)){for(n||(n=this.children.slice());r<n.length&&n[r]<i;)r+=3;n[r]==i?n[r+2]=n[r+2].addInner(e,a,s+1):n.splice(r,0,i,i+e.nodeSize,el(a,e,s+1,qs)),r+=3}}));let i=Xs(r?Zs(t):t,-o);for(let a=0;a<i.length;a++)i[a].type.valid(e,i[a])||i.splice(a--,1);return new Ks(i.length?this.local.concat(i).sort(tl):this.local,n||this.children)}remove(e){return 0==e.length||this==Ys?this:this.removeInner(e,0)}removeInner(e,t){let o=this.children,n=this.local;for(let r=0;r<o.length;r+=3){let n,i=o[r]+t,a=o[r+1]+t;for(let t,o=0;o<e.length;o++)(t=e[o])&&t.from>i&&t.to<a&&(e[o]=null,(n||(n=[])).push(t));if(!n)continue;o==this.children&&(o=this.children.slice());let s=o[r+2].removeInner(n,i+1);s!=Ys?o[r+2]=s:(o.splice(r,3),r-=3)}if(n.length)for(let r,i=0;i<e.length;i++)if(r=e[i])for(let e=0;e<n.length;e++)n[e].eq(r,t)&&(n==this.local&&(n=this.local.slice()),n.splice(e--,1));return o==this.children&&n==this.local?this:n.length||o.length?new Ks(n,o):Ys}forChild(e,t){if(this==Ys)return this;if(t.isLeaf)return Ks.empty;let o,n;for(let a=0;a<this.children.length;a+=3)if(this.children[a]>=e){this.children[a]==e&&(o=this.children[a+2]);break}let r=e+1,i=r+t.content.size;for(let a=0;a<this.local.length;a++){let e=this.local[a];if(e.from<i&&e.to>r&&e.type instanceof Vs){let t=Math.max(r,e.from)-r,o=Math.min(i,e.to)-r;t<o&&(n||(n=[])).push(e.copy(t,o))}}if(n){let e=new Ks(n.sort(tl),Ws);return o?new Js([e,o]):e}return o||Ys}eq(e){if(this==e)return!0;if(!(e instanceof Ks)||this.local.length!=e.local.length||this.children.length!=e.children.length)return!1;for(let t=0;t<this.local.length;t++)if(!this.local[t].eq(e.local[t]))return!1;for(let t=0;t<this.children.length;t+=3)if(this.children[t]!=e.children[t]||this.children[t+1]!=e.children[t+1]||!this.children[t+2].eq(e.children[t+2]))return!1;return!0}locals(e){return ol(this.localsInner(e))}localsInner(e){if(this==Ys)return Ws;if(e.inlineContent||!this.local.some(Vs.is))return this.local;let t=[];for(let o=0;o<this.local.length;o++)this.local[o].type instanceof Vs||t.push(this.local[o]);return t}forEachSet(e){e(this)}}Ks.empty=new Ks([],[]),Ks.removeOverlap=ol;const Ys=Ks.empty;class Js{constructor(e){this.members=e}map(e,t){const o=this.members.map((o=>o.map(e,t,qs)));return Js.from(o)}forChild(e,t){if(t.isLeaf)return Ks.empty;let o=[];for(let n=0;n<this.members.length;n++){let r=this.members[n].forChild(e,t);r!=Ys&&(r instanceof Js?o=o.concat(r.members):o.push(r))}return Js.from(o)}eq(e){if(!(e instanceof Js)||e.members.length!=this.members.length)return!1;for(let t=0;t<this.members.length;t++)if(!this.members[t].eq(e.members[t]))return!1;return!0}locals(e){let t,o=!0;for(let n=0;n<this.members.length;n++){let r=this.members[n].localsInner(e);if(r.length)if(t){o&&(t=t.slice(),o=!1);for(let e=0;e<r.length;e++)t.push(r[e])}else t=r}return t?ol(o?t:t.sort(tl)):Ws}static from(e){switch(e.length){case 0:return Ys;case 1:return e[0];default:return new Js(e.every((e=>e instanceof Ks))?e:e.reduce(((e,t)=>e.concat(t instanceof Ks?t:t.members)),[]))}}forEachSet(e){for(let t=0;t<this.members.length;t++)this.members[t].forEachSet(e)}}function Xs(e,t){if(!t||!e.length)return e;let o=[];for(let n=0;n<e.length;n++){let r=e[n];o.push(new Us(r.from+t,r.to+t,r.type))}return o}function Qs(e,t,o){if(t.isLeaf)return null;let n=o+t.nodeSize,r=null;for(let i,a=0;a<e.length;a++)(i=e[a])&&i.from>o&&i.to<n&&((r||(r=[])).push(i),e[a]=null);return r}function Zs(e){let t=[];for(let o=0;o<e.length;o++)null!=e[o]&&t.push(e[o]);return t}function el(e,t,o,n){let r=[],i=!1;t.forEach(((t,a)=>{let s=Qs(e,t,a+o);if(s){i=!0;let e=el(s,t,o+a+1,n);e!=Ys&&r.push(a,a+t.nodeSize,e)}}));let a=Xs(i?Zs(e):e,-o).sort(tl);for(let s=0;s<a.length;s++)a[s].type.valid(t,a[s])||(n.onRemove&&n.onRemove(a[s].spec),a.splice(s--,1));return a.length||r.length?new Ks(a,r):Ys}function tl(e,t){return e.from-t.from||e.to-t.to}function ol(e){let t=e;for(let o=0;o<t.length-1;o++){let n=t[o];if(n.from!=n.to)for(let r=o+1;r<t.length;r++){let i=t[r];if(i.from!=n.from){i.from<n.to&&(t==e&&(t=e.slice()),t[o]=n.copy(n.from,i.from),nl(t,r,n.copy(i.from,n.to)));break}i.to!=n.to&&(t==e&&(t=e.slice()),t[r]=i.copy(i.from,n.to),nl(t,r+1,i.copy(n.to,i.to)))}}return t}function nl(e,t,o){for(;t<e.length&&tl(o,e[t])>0;)t++;e.splice(t,0,o)}function rl(e){let t=[];return e.someProp("decorations",(o=>{let n=o(e.state);n&&n!=Ys&&t.push(n)})),e.cursorWrapper&&t.push(Ks.create(e.state.doc,[e.cursorWrapper.deco])),Js.from(t)}const il={childList:!0,characterData:!0,characterDataOldValue:!0,attributes:!0,attributeOldValue:!0,subtree:!0},al=ki&&ji<=11;class sl{constructor(){this.anchorNode=null,this.anchorOffset=0,this.focusNode=null,this.focusOffset=0}set(e){this.anchorNode=e.anchorNode,this.anchorOffset=e.anchorOffset,this.focusNode=e.focusNode,this.focusOffset=e.focusOffset}clear(){this.anchorNode=this.focusNode=null}eq(e){return e.anchorNode==this.anchorNode&&e.anchorOffset==this.anchorOffset&&e.focusNode==this.focusNode&&e.focusOffset==this.focusOffset}}class ll{constructor(e,t){this.view=e,this.handleDOMChange=t,this.queue=[],this.flushingSoon=-1,this.observer=null,this.currentSelection=new sl,this.onCharData=null,this.suppressingSelectionUpdates=!1,this.lastChangedTextNode=null,this.observer=window.MutationObserver&&new window.MutationObserver((e=>{for(let t=0;t<e.length;t++)this.queue.push(e[t]);ki&&ji<=11&&e.some((e=>"childList"==e.type&&e.removedNodes.length||"characterData"==e.type&&e.oldValue.length>e.target.nodeValue.length))?this.flushSoon():this.flush()})),al&&(this.onCharData=e=>{this.queue.push({target:e.target,type:"characterData",oldValue:e.prevValue}),this.flushSoon()}),this.onSelectionChange=this.onSelectionChange.bind(this)}flushSoon(){this.flushingSoon<0&&(this.flushingSoon=window.setTimeout((()=>{this.flushingSoon=-1,this.flush()}),20))}forceFlush(){this.flushingSoon>-1&&(window.clearTimeout(this.flushingSoon),this.flushingSoon=-1,this.flush())}start(){this.observer&&(this.observer.takeRecords(),this.observer.observe(this.view.dom,il)),this.onCharData&&this.view.dom.addEventListener("DOMCharacterDataModified",this.onCharData),this.connectSelection()}stop(){if(this.observer){let e=this.observer.takeRecords();if(e.length){for(let t=0;t<e.length;t++)this.queue.push(e[t]);window.setTimeout((()=>this.flush()),20)}this.observer.disconnect()}this.onCharData&&this.view.dom.removeEventListener("DOMCharacterDataModified",this.onCharData),this.disconnectSelection()}connectSelection(){this.view.dom.ownerDocument.addEventListener("selectionchange",this.onSelectionChange)}disconnectSelection(){this.view.dom.ownerDocument.removeEventListener("selectionchange",this.onSelectionChange)}suppressSelectionUpdates(){this.suppressingSelectionUpdates=!0,setTimeout((()=>this.suppressingSelectionUpdates=!1),50)}onSelectionChange(){if(Ga(this.view)){if(this.suppressingSelectionUpdates)return Ta(this.view);if(ki&&ji<=11&&!this.view.state.selection.empty){let e=this.view.domSelectionRange();if(e.focusNode&&hi(e.focusNode,e.focusOffset,e.anchorNode,e.anchorOffset))return this.flushSoon()}this.flush()}}setCurSelection(){this.currentSelection.set(this.view.domSelectionRange())}ignoreSelectionChange(e){if(!e.focusNode)return!0;let t,o=new Set;for(let r=e.focusNode;r;r=di(r))o.add(r);for(let r=e.anchorNode;r;r=di(r))if(o.has(r)){t=r;break}let n=t&&this.view.docView.nearestDesc(t);return n&&n.ignoreMutation({type:"selection",target:3==t.nodeType?t.parentNode:t})?(this.setCurSelection(),!0):void 0}pendingRecords(){if(this.observer)for(let e of this.observer.takeRecords())this.queue.push(e);return this.queue}flush(){let{view:e}=this;if(!e.docView||this.flushingSoon>-1)return;let t=this.pendingRecords();t.length&&(this.queue=[]);let o=e.domSelectionRange(),n=!this.suppressingSelectionUpdates&&!this.currentSelection.eq(o)&&Ga(e)&&!this.ignoreSelectionChange(o),r=-1,i=-1,a=!1,s=[];if(e.editable)for(let c=0;c<t.length;c++){let e=this.registerMutation(t[c],s);e&&(r=r<0?e.from:Math.min(e.from,r),i=i<0?e.to:Math.max(e.to,i),e.typeOver&&(a=!0))}if(Ai&&s.length){let t=s.filter((e=>"BR"==e.nodeName));if(2==t.length){let[e,o]=t;e.parentNode&&e.parentNode.parentNode==o.parentNode?o.remove():e.remove()}else{let{focusNode:o}=this.currentSelection;for(let n of t){let t=n.parentNode;!t||"LI"!=t.nodeName||o&&pl(e,o)==t||n.remove()}}}let l=null;r<0&&n&&e.input.lastFocus>Date.now()-200&&Math.max(e.input.lastTouch,e.input.lastClick.time)<Date.now()-300&&vi(o)&&(l=Ra(e))&&l.eq(zr.near(e.state.doc.resolve(0),1))?(e.input.lastFocus=0,Ta(e),this.currentSelection.set(o),e.scrollToSelection()):(r>-1||n)&&(r>-1&&(e.docView.markDirty(r,i),function(e){if(cl.has(e))return;if(cl.set(e,null),-1!==["normal","nowrap","pre-line"].indexOf(getComputedStyle(e.dom).whiteSpace)){if(e.requiresGeckoHackNode=Ai,dl)return;console.warn("ProseMirror expects the CSS white-space property to be set, preferably to 'pre-wrap'. It is recommended to load style/prosemirror.css from the prosemirror-view package."),dl=!0}}(e)),this.handleDOMChange(r,i,a,s),e.docView&&e.docView.dirty?e.updateState(e.state):this.currentSelection.eq(o)||Ta(e),this.currentSelection.set(o))}registerMutation(e,t){if(t.indexOf(e.target)>-1)return null;let o=this.view.docView.nearestDesc(e.target);if("attributes"==e.type&&(o==this.view.docView||"contenteditable"==e.attributeName||"style"==e.attributeName&&!e.oldValue&&!e.target.getAttribute("style")))return null;if(!o||o.ignoreMutation(e))return null;if("childList"==e.type){for(let o=0;o<e.addedNodes.length;o++){let n=e.addedNodes[o];t.push(n),3==n.nodeType&&(this.lastChangedTextNode=n)}if(o.contentDOM&&o.contentDOM!=o.dom&&!o.contentDOM.contains(e.target))return{from:o.posBefore,to:o.posAfter};let n=e.previousSibling,r=e.nextSibling;if(ki&&ji<=11&&e.addedNodes.length)for(let t=0;t<e.addedNodes.length;t++){let{previousSibling:o,nextSibling:i}=e.addedNodes[t];(!o||Array.prototype.indexOf.call(e.addedNodes,o)<0)&&(n=o),(!i||Array.prototype.indexOf.call(e.addedNodes,i)<0)&&(r=i)}let i=n&&n.parentNode==e.target?ci(n)+1:0,a=o.localPosFromDOM(e.target,i,-1),s=r&&r.parentNode==e.target?ci(r):e.target.childNodes.length;return{from:a,to:o.localPosFromDOM(e.target,s,1)}}return"attributes"==e.type?{from:o.posAtStart-o.border,to:o.posAtEnd+o.border}:(this.lastChangedTextNode=e.target,{from:o.posAtStart,to:o.posAtEnd,typeOver:e.target.nodeValue==e.oldValue})}}let cl=new WeakMap,dl=!1;function ul(e,t){let o=t.startContainer,n=t.startOffset,r=t.endContainer,i=t.endOffset,a=e.domAtPos(e.state.selection.anchor);return hi(a.node,a.offset,r,i)&&([o,n,r,i]=[r,i,o,n]),{anchorNode:o,anchorOffset:n,focusNode:r,focusOffset:i}}function pl(e,t){for(let o=t.parentNode;o&&o!=e.dom;o=o.parentNode){let t=e.docView.nearestDesc(o,!0);if(t&&t.node.isBlock)return o}return null}function hl(e){let t=e.pmViewDesc;if(t)return t.parseRule();if("BR"==e.nodeName&&e.parentNode){if(Di&&/^(ul|ol)$/i.test(e.parentNode.nodeName)){let e=document.createElement("div");return e.appendChild(document.createElement("li")),{skip:e}}if(e.parentNode.lastChild==e||Di&&/^(tr|table)$/i.test(e.parentNode.nodeName))return{ignore:!0}}else if("IMG"==e.nodeName&&e.getAttribute("mark-placeholder"))return{ignore:!0};return null}const fl=/^(a|abbr|acronym|b|bd[io]|big|br|button|cite|code|data(list)?|del|dfn|em|i|ins|kbd|label|map|mark|meter|output|q|ruby|s|samp|small|span|strong|su[bp]|time|u|tt|var)$/i;function gl(e,t,o,n,r){let i=e.input.compositionPendingChanges||(e.composing?e.input.compositionID:0);if(e.input.compositionPendingChanges=0,t<0){let t=e.input.lastSelectionTime>Date.now()-50?e.input.lastSelectionOrigin:null,o=Ra(e,t);if(o&&!e.state.selection.eq(o)){if(Oi&&Mi&&13===e.input.lastKeyCode&&Date.now()-100<e.input.lastKeyCodeTime&&e.someProp("handleKeyDown",(t=>t(e,bi(13,"Enter")))))return;let n=e.state.tr.setSelection(o);"pointer"==t?n.setMeta("pointer",!0):"key"==t&&n.scrollIntoView(),i&&n.setMeta("composition",i),e.dispatch(n)}return}let a=e.state.doc.resolve(t),s=a.sharedDepth(o);t=a.before(s+1),o=e.state.doc.resolve(o).after(s+1);let l,c,d=e.state.selection,u=function(e,t,o){let n,{node:r,fromOffset:i,toOffset:a,from:s,to:l}=e.docView.parseRange(t,o),c=e.domSelectionRange(),d=c.anchorNode;if(d&&e.dom.contains(1==d.nodeType?d:d.parentNode)&&(n=[{node:d,offset:c.anchorOffset}],vi(c)||n.push({node:c.focusNode,offset:c.focusOffset})),Oi&&8===e.input.lastKeyCode)for(let m=a;m>i;m--){let e=r.childNodes[m-1],t=e.pmViewDesc;if("BR"==e.nodeName&&!t){a=m;break}if(!t||t.size)break}let u=e.state.doc,p=e.someProp("domParser")||In.fromSchema(e.state.schema),h=u.resolve(s),f=null,g=p.parse(r,{topNode:h.parent,topMatch:h.parent.contentMatchAt(h.index()),topOpen:!0,from:i,to:a,preserveWhitespace:"pre"!=h.parent.type.whitespace||"full",findPositions:n,ruleFromNode:hl,context:h});if(n&&null!=n[0].pos){let e=n[0].pos,t=n[1]&&n[1].pos;null==t&&(t=e),f={anchor:e+s,head:t+s}}return{doc:g,sel:f,from:s,to:l}}(e,t,o),p=e.state.doc,h=p.slice(u.from,u.to);8===e.input.lastKeyCode&&Date.now()-100<e.input.lastKeyCodeTime?(l=e.state.selection.to,c="end"):(l=e.state.selection.from,c="start"),e.input.lastKeyCode=null;let f=function(e,t,o,n,r){let i=e.findDiffStart(t,o);if(null==i)return null;let{a:a,b:s}=e.findDiffEnd(t,o+e.size,o+t.size);if("end"==r){n-=a+Math.max(0,i-Math.min(a,s))-i}if(a<i&&e.size<t.size){let e=n<=i&&n>=a?i-n:0;i-=e,i&&i<t.size&&vl(t.textBetween(i-1,i+1))&&(i+=e?1:-1),s=i+(s-a),a=i}else if(s<i){let t=n<=i&&n>=s?i-n:0;i-=t,i&&i<e.size&&vl(e.textBetween(i-1,i+1))&&(i+=t?1:-1),a=i+(a-s),s=i}return{start:i,endA:a,endB:s}}(h.content,u.doc.content,u.from,l,c);if(f&&e.input.domChangeCount++,(Pi&&e.input.lastIOSEnter>Date.now()-225||Mi)&&r.some((e=>1==e.nodeType&&!fl.test(e.nodeName)))&&(!f||f.endA>=f.endB)&&e.someProp("handleKeyDown",(t=>t(e,bi(13,"Enter")))))return void(e.input.lastIOSEnter=0);if(!f){if(!(n&&d instanceof $r&&!d.empty&&d.$head.sameParent(d.$anchor))||e.composing||u.sel&&u.sel.anchor!=u.sel.head){if(u.sel){let t=ml(e,e.state.doc,u.sel);if(t&&!t.eq(e.state.selection)){let o=e.state.tr.setSelection(t);i&&o.setMeta("composition",i),e.dispatch(o)}}return}f={start:d.from,endA:d.to,endB:d.to}}e.state.selection.from<e.state.selection.to&&f.start==f.endB&&e.state.selection instanceof $r&&(f.start>e.state.selection.from&&f.start<=e.state.selection.from+2&&e.state.selection.from>=u.from?f.start=e.state.selection.from:f.endA<e.state.selection.to&&f.endA>=e.state.selection.to-2&&e.state.selection.to<=u.to&&(f.endB+=e.state.selection.to-f.endA,f.endA=e.state.selection.to)),ki&&ji<=11&&f.endB==f.start+1&&f.endA==f.start&&f.start>u.from&&" \xa0"==u.doc.textBetween(f.start-u.from-1,f.start-u.from+1)&&(f.start--,f.endA--,f.endB--);let g,m=u.doc.resolveNoCache(f.start-u.from),y=u.doc.resolveNoCache(f.endB-u.from),v=p.resolve(f.start),b=m.sameParent(y)&&m.parent.inlineContent&&v.end()>=f.endA;if((Pi&&e.input.lastIOSEnter>Date.now()-225&&(!b||r.some((e=>"DIV"==e.nodeName||"P"==e.nodeName)))||!b&&m.pos<u.doc.content.size&&!m.sameParent(y)&&(g=zr.findFrom(u.doc.resolve(m.pos+1),1,!0))&&g.head==y.pos)&&e.someProp("handleKeyDown",(t=>t(e,bi(13,"Enter")))))return void(e.input.lastIOSEnter=0);if(e.state.selection.anchor>f.start&&function(e,t,o,n,r){if(o-t<=r.pos-n.pos||yl(n,!0,!1)<r.pos)return!1;let i=e.resolve(t);if(!n.parent.isTextblock){let e=i.nodeAfter;return null!=e&&o==t+e.nodeSize}if(i.parentOffset<i.parent.content.size||!i.parent.isTextblock)return!1;let a=e.resolve(yl(i,!0,!0));return!(!a.parent.isTextblock||a.pos>o||yl(a,!0,!1)<o)&&n.parent.content.cut(n.parentOffset).eq(a.parent.content)}(p,f.start,f.endA,m,y)&&e.someProp("handleKeyDown",(t=>t(e,bi(8,"Backspace")))))return void(Mi&&Oi&&e.domObserver.suppressSelectionUpdates());Oi&&f.endB==f.start&&(e.input.lastChromeDelete=Date.now()),Mi&&!b&&m.start()!=y.start()&&0==y.parentOffset&&m.depth==y.depth&&u.sel&&u.sel.anchor==u.sel.head&&u.sel.head==f.endA&&(f.endB-=2,y=u.doc.resolveNoCache(f.endB-u.from),setTimeout((()=>{e.someProp("handleKeyDown",(function(t){return t(e,bi(13,"Enter"))}))}),20));let x,w,C,_=f.start,S=f.endA;if(b)if(m.pos==y.pos)ki&&ji<=11&&0==m.parentOffset&&(e.domObserver.suppressSelectionUpdates(),setTimeout((()=>Ta(e)),20)),x=e.state.tr.delete(_,S),w=p.resolve(f.start).marksAcross(p.resolve(f.endA));else if(f.endA==f.endB&&(C=function(e,t){let o,n,r,i=e.firstChild.marks,a=t.firstChild.marks,s=i,l=a;for(let d=0;d<a.length;d++)s=a[d].removeFromSet(s);for(let d=0;d<i.length;d++)l=i[d].removeFromSet(l);if(1==s.length&&0==l.length)n=s[0],o="add",r=e=>e.mark(n.addToSet(e.marks));else{if(0!=s.length||1!=l.length)return null;n=l[0],o="remove",r=e=>e.mark(n.removeFromSet(e.marks))}let c=[];for(let d=0;d<t.childCount;d++)c.push(r(t.child(d)));if(Vo.from(c).eq(e))return{mark:n,type:o}}(m.parent.content.cut(m.parentOffset,y.parentOffset),v.parent.content.cut(v.parentOffset,f.endA-v.start()))))x=e.state.tr,"add"==C.type?x.addMark(_,S,C.mark):x.removeMark(_,S,C.mark);else if(m.parent.child(m.index()).isText&&m.index()==y.index()-(y.textOffset?0:1)){let t=m.parent.textBetween(m.parentOffset,y.parentOffset);if(e.someProp("handleTextInput",(o=>o(e,_,S,t))))return;x=e.state.tr.insertText(t,_,S)}if(x||(x=e.state.tr.replace(_,S,u.doc.slice(f.start-u.from,f.endB-u.from))),u.sel){let t=ml(e,x.doc,u.sel);t&&!(Oi&&e.composing&&t.empty&&(f.start!=f.endB||e.input.lastChromeDelete<Date.now()-100)&&(t.head==_||t.head==x.mapping.map(S)-1)||ki&&t.empty&&t.head==_)&&x.setSelection(t)}w&&x.ensureMarks(w),i&&x.setMeta("composition",i),e.dispatch(x.scrollIntoView())}function ml(e,t,o){return Math.max(o.anchor,o.head)>t.content.size?null:Fa(e,t.resolve(o.anchor),t.resolve(o.head))}function yl(e,t,o){let n=e.depth,r=t?e.end():e.pos;for(;n>0&&(t||e.indexAfter(n)==e.node(n).childCount);)n--,r++,t=!1;if(o){let t=e.node(n).maybeChild(e.indexAfter(n));for(;t&&!t.isLeaf;)t=t.firstChild,r++}return r}function vl(e){if(2!=e.length)return!1;let t=e.charCodeAt(0),o=e.charCodeAt(1);return t>=56320&&t<=57343&&o>=55296&&o<=56319}class bl{constructor(e,t){this._root=null,this.focused=!1,this.trackWrites=null,this.mounted=!1,this.markCursor=null,this.cursorWrapper=null,this.lastSelectedViewDesc=void 0,this.input=new ms,this.prevDirectPlugins=[],this.pluginViews=[],this.requiresGeckoHackNode=!1,this.dragging=null,this._props=t,this.state=t.state,this.directPlugins=t.plugins||[],this.directPlugins.forEach(Sl),this.dispatch=this.dispatch.bind(this),this.dom=e&&e.mount||document.createElement("div"),e&&(e.appendChild?e.appendChild(this.dom):"function"==typeof e?e(this.dom):e.mount&&(this.mounted=!0)),this.editable=Cl(this),wl(this),this.nodeViews=_l(this),this.docView=ha(this.state.doc,xl(this),rl(this),this.dom,this),this.domObserver=new ll(this,((e,t,o,n)=>gl(this,e,t,o,n))),this.domObserver.start(),function(e){for(let t in hs){let o=hs[t];e.dom.addEventListener(t,e.input.eventHandlers[t]=t=>{!xs(e,t)||bs(e,t)||!e.editable&&t.type in fs||o(e,t)},gs[t]?{passive:!0}:void 0)}Di&&e.dom.addEventListener("input",(()=>null)),vs(e)}(this),this.updatePluginViews()}get composing(){return this.input.composing}get props(){if(this._props.state!=this.state){let e=this._props;this._props={};for(let t in e)this._props[t]=e[t];this._props.state=this.state}return this._props}update(e){e.handleDOMEvents!=this._props.handleDOMEvents&&vs(this);let t=this._props;this._props=e,e.plugins&&(e.plugins.forEach(Sl),this.directPlugins=e.plugins),this.updateStateInner(e.state,t)}setProps(e){let t={};for(let o in this._props)t[o]=this._props[o];t.state=this.state;for(let o in e)t[o]=e[o];this.update(t)}updateState(e){this.updateStateInner(e,this._props)}updateStateInner(e,t){var o;let n=this.state,r=!1,i=!1;e.storedMarks&&this.composing&&(Ps(this),i=!0),this.state=e;let a=n.plugins!=e.plugins||this._props.plugins!=t.plugins;if(a||this._props.plugins!=t.plugins||this._props.nodeViews!=t.nodeViews){let e=_l(this);(function(e,t){let o=0,n=0;for(let r in e){if(e[r]!=t[r])return!0;o++}for(let r in t)n++;return o!=n})(e,this.nodeViews)&&(this.nodeViews=e,r=!0)}(a||t.handleDOMEvents!=this._props.handleDOMEvents)&&vs(this),this.editable=Cl(this),wl(this);let s=rl(this),l=xl(this),c=n.plugins==e.plugins||n.doc.eq(e.doc)?e.scrollToSelection>n.scrollToSelection?"to selection":"preserve":"reset",d=r||!this.docView.matchesNode(e.doc,l,s);!d&&e.selection.eq(n.selection)||(i=!0);let u="preserve"==c&&i&&null==this.dom.style.overflowAnchor&&function(e){let t,o,n=e.dom.getBoundingClientRect(),r=Math.max(0,n.top);for(let i=(n.left+n.right)/2,a=r+1;a<Math.min(innerHeight,n.bottom);a+=5){let n=e.root.elementFromPoint(i,a);if(!n||n==e.dom||!e.dom.contains(n))continue;let s=n.getBoundingClientRect();if(s.top>=r-20){t=n,o=s.top;break}}return{refDOM:t,refTop:o,stack:Vi(e.dom)}}(this);if(i){this.domObserver.stop();let t=d&&(ki||Oi)&&!this.composing&&!n.selection.empty&&!e.selection.empty&&function(e,t){let o=Math.min(e.$anchor.sharedDepth(e.head),t.$anchor.sharedDepth(t.head));return e.$anchor.start(o)!=t.$anchor.start(o)}(n.selection,e.selection);if(d){let o=Oi?this.trackWrites=this.domSelectionRange().focusNode:null;this.composing&&(this.input.compositionNode=Ns(this)),!r&&this.docView.update(e.doc,l,s,this)||(this.docView.updateOuterDeco(l),this.docView.destroy(),this.docView=ha(e.doc,l,s,this.dom,this)),o&&!this.trackWrites&&(t=!0)}t||!(this.input.mouseDown&&this.domObserver.currentSelection.eq(this.domSelectionRange())&&function(e){let t=e.docView.domFromPos(e.state.selection.anchor,0),o=e.domSelectionRange();return hi(t.node,t.offset,o.anchorNode,o.anchorOffset)}(this))?Ta(this,t):(Ma(this,e.selection),this.domObserver.setCurSelection()),this.domObserver.start()}this.updatePluginViews(n),(null===(o=this.dragging)||void 0===o?void 0:o.node)&&!n.doc.eq(e.doc)&&this.updateDraggedNode(this.dragging,n),"reset"==c?this.dom.scrollTop=0:"to selection"==c?this.scrollToSelection():u&&function(e){let{refDOM:t,refTop:o,stack:n}=e,r=t?t.getBoundingClientRect().top:0;$i(n,0==r?0:r-o)}(u)}scrollToSelection(){let e=this.domSelectionRange().focusNode;if(e&&this.dom.contains(1==e.nodeType?e:e.parentNode))if(this.someProp("handleScrollToSelection",(e=>e(this))));else if(this.state.selection instanceof Wr){let t=this.docView.domAfterPos(this.state.selection.from);1==t.nodeType&&Bi(this,t.getBoundingClientRect(),e)}else Bi(this,this.coordsAtPos(this.state.selection.head,1),e);else;}destroyPluginViews(){let e;for(;e=this.pluginViews.pop();)e.destroy&&e.destroy()}updatePluginViews(e){if(e&&e.plugins==this.state.plugins&&this.directPlugins==this.prevDirectPlugins)for(let t=0;t<this.pluginViews.length;t++){let o=this.pluginViews[t];o.update&&o.update(this,e)}else{this.prevDirectPlugins=this.directPlugins,this.destroyPluginViews();for(let e=0;e<this.directPlugins.length;e++){let t=this.directPlugins[e];t.spec.view&&this.pluginViews.push(t.spec.view(this))}for(let e=0;e<this.state.plugins.length;e++){let t=this.state.plugins[e];t.spec.view&&this.pluginViews.push(t.spec.view(this))}}}updateDraggedNode(e,t){let o=e.node,n=-1;if(this.state.doc.nodeAt(o.from)==o.node)n=o.from;else{let e=o.from+(this.state.doc.content.size-t.doc.content.size);(e>0&&this.state.doc.nodeAt(e))==o.node&&(n=e)}this.dragging=new Gs(e.slice,e.move,n<0?void 0:Wr.create(this.state.doc,n))}someProp(e,t){let o,n=this._props&&this._props[e];if(null!=n&&(o=t?t(n):n))return o;for(let i=0;i<this.directPlugins.length;i++){let n=this.directPlugins[i].props[e];if(null!=n&&(o=t?t(n):n))return o}let r=this.state.plugins;if(r)for(let i=0;i<r.length;i++){let n=r[i].props[e];if(null!=n&&(o=t?t(n):n))return o}}hasFocus(){if(ki){let e=this.root.activeElement;if(e==this.dom)return!0;if(!e||!this.dom.contains(e))return!1;for(;e&&this.dom!=e&&this.dom.contains(e);){if("false"==e.contentEditable)return!1;e=e.parentElement}return!0}return this.root.activeElement==this.dom}focus(){this.domObserver.stop(),this.editable&&function(e){if(e.setActive)return e.setActive();if(Ui)return e.focus(Ui);let t=Vi(e);e.focus(null==Ui?{get preventScroll(){return Ui={preventScroll:!0},!0}}:void 0),Ui||(Ui=!1,$i(t,0))}(this.dom),Ta(this),this.domObserver.start()}get root(){let e=this._root;if(null==e)for(let t=this.dom.parentNode;t;t=t.parentNode)if(9==t.nodeType||11==t.nodeType&&t.host)return t.getSelection||(Object.getPrototypeOf(t).getSelection=()=>t.ownerDocument.getSelection()),this._root=t;return e||document}updateRoot(){this._root=null}posAtCoords(e){return Yi(this,e)}coordsAtPos(e){return Zi(this,e,arguments.length>1&&void 0!==arguments[1]?arguments[1]:1)}domAtPos(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return this.docView.domFromPos(e,t)}nodeDOM(e){let t=this.docView.descAt(e);return t?t.nodeDOM:null}posAtDOM(e,t){let o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:-1,n=this.docView.posFromDOM(e,t,o);if(null==n)throw new RangeError("DOM position not inside the editor");return n}endOfTextblock(e,t){return sa(this,t||this.state,e)}pasteHTML(e,t){return Ls(this,"",e,!1,t||new ClipboardEvent("paste"))}pasteText(e,t){return Ls(this,e,null,!0,t||new ClipboardEvent("paste"))}serializeForClipboard(e){return es(this,e)}destroy(){this.docView&&(!function(e){e.domObserver.stop();for(let t in e.input.eventHandlers)e.dom.removeEventListener(t,e.input.eventHandlers[t]);clearTimeout(e.input.composingTimeout),clearTimeout(e.input.lastIOSEnterFallbackTimeout)}(this),this.destroyPluginViews(),this.mounted?(this.docView.update(this.state.doc,[],rl(this),this),this.dom.textContent=""):this.dom.parentNode&&this.dom.parentNode.removeChild(this.dom),this.docView.destroy(),this.docView=null,ui=null)}get isDestroyed(){return null==this.docView}dispatchEvent(e){return function(e,t){bs(e,t)||!hs[t.type]||!e.editable&&t.type in fs||hs[t.type](e,t)}(this,e)}dispatch(e){let t=this._props.dispatchTransaction;t?t.call(this,e):this.updateState(this.state.apply(e))}domSelectionRange(){let e=this.domSelection();return e?Di&&11===this.root.nodeType&&function(e){let t=e.activeElement;for(;t&&t.shadowRoot;)t=t.shadowRoot.activeElement;return t}(this.dom.ownerDocument)==this.dom&&function(e,t){if(t.getComposedRanges){let o=t.getComposedRanges(e.root)[0];if(o)return ul(e,o)}let o;function n(e){e.preventDefault(),e.stopImmediatePropagation(),o=e.getTargetRanges()[0]}return e.dom.addEventListener("beforeinput",n,!0),document.execCommand("indent"),e.dom.removeEventListener("beforeinput",n,!0),o?ul(e,o):null}(this,e)||e:{focusNode:null,focusOffset:0,anchorNode:null,anchorOffset:0}}domSelection(){return this.root.getSelection()}}function xl(e){let t=Object.create(null);return t.class="ProseMirror",t.contenteditable=String(e.editable),e.someProp("attributes",(o=>{if("function"==typeof o&&(o=o(e.state)),o)for(let e in o)"class"==e?t.class+=" "+o[e]:"style"==e?t.style=(t.style?t.style+";":"")+o[e]:t[e]||"contenteditable"==e||"nodeName"==e||(t[e]=String(o[e]))})),t.translate||(t.translate="no"),[Us.node(0,e.state.doc.content.size,t)]}function wl(e){if(e.markCursor){let t=document.createElement("img");t.className="ProseMirror-separator",t.setAttribute("mark-placeholder","true"),t.setAttribute("alt",""),e.cursorWrapper={dom:t,deco:Us.widget(e.state.selection.from,t,{raw:!0,marks:e.markCursor})}}else e.cursorWrapper=null}function Cl(e){return!e.someProp("editable",(t=>!1===t(e.state)))}function _l(e){let t=Object.create(null);function o(e){for(let o in e)Object.prototype.hasOwnProperty.call(t,o)||(t[o]=e[o])}return e.someProp("nodeViews",o),e.someProp("markViews",o),t}function Sl(e){if(e.spec.state||e.spec.filterTransaction||e.spec.appendTransaction)throw new RangeError("Plugins passed directly to the view must not have a state component")}for(var El={8:"Backspace",9:"Tab",10:"Enter",12:"NumLock",13:"Enter",16:"Shift",17:"Control",18:"Alt",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",44:"PrintScreen",45:"Insert",46:"Delete",59:";",61:"=",91:"Meta",92:"Meta",106:"*",107:"+",108:",",109:"-",110:".",111:"/",144:"NumLock",145:"ScrollLock",160:"Shift",161:"Shift",162:"Control",163:"Control",164:"Alt",165:"Alt",173:"-",186:";",187:"=",188:",",189:"-",190:".",191:"/",192:"`",219:"[",220:"\\",221:"]",222:"'"},kl={48:")",49:"!",50:"@",51:"#",52:"$",53:"%",54:"^",55:"&",56:"*",57:"(",59:":",61:"+",173:"_",186:":",187:"+",188:"<",189:"_",190:">",191:"?",192:"~",219:"{",220:"|",221:"}",222:'"'},jl="undefined"!=typeof navigator&&/Mac/.test(navigator.platform),Al="undefined"!=typeof navigator&&/MSIE \d|Trident\/(?:[7-9]|\d{2,})\..*rv:(\d+)/.exec(navigator.userAgent),Rl=0;Rl<10;Rl++)El[48+Rl]=El[96+Rl]=String(Rl);for(Rl=1;Rl<=24;Rl++)El[Rl+111]="F"+Rl;for(Rl=65;Rl<=90;Rl++)El[Rl]=String.fromCharCode(Rl+32),kl[Rl]=String.fromCharCode(Rl);for(var Ol in El)kl.hasOwnProperty(Ol)||(kl[Ol]=El[Ol]);const Tl="undefined"!=typeof navigator&&/Mac|iP(hone|[oa]d)/.test(navigator.platform);function Dl(e){let t,o,n,r,i=e.split(/-(?!$)/),a=i[i.length-1];"Space"==a&&(a=" ");for(let s=0;s<i.length-1;s++){let e=i[s];if(/^(cmd|meta|m)$/i.test(e))r=!0;else if(/^a(lt)?$/i.test(e))t=!0;else if(/^(c|ctrl|control)$/i.test(e))o=!0;else if(/^s(hift)?$/i.test(e))n=!0;else{if(!/^mod$/i.test(e))throw new Error("Unrecognized modifier name: "+e);Tl?r=!0:o=!0}}return t&&(a="Alt-"+a),o&&(a="Ctrl-"+a),r&&(a="Meta-"+a),n&&(a="Shift-"+a),a}function Pl(e,t){let o=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];return t.altKey&&(e="Alt-"+e),t.ctrlKey&&(e="Ctrl-"+e),t.metaKey&&(e="Meta-"+e),o&&t.shiftKey&&(e="Shift-"+e),e}function Nl(e){let t=function(e){let t=Object.create(null);for(let o in e)t[Dl(o)]=e[o];return t}(e);return function(e,o){let n,r=function(e){var t=!(jl&&e.metaKey&&e.shiftKey&&!e.ctrlKey&&!e.altKey||Al&&e.shiftKey&&e.key&&1==e.key.length||"Unidentified"==e.key)&&e.key||(e.shiftKey?kl:El)[e.keyCode]||e.key||"Unidentified";return"Esc"==t&&(t="Escape"),"Del"==t&&(t="Delete"),"Left"==t&&(t="ArrowLeft"),"Up"==t&&(t="ArrowUp"),"Right"==t&&(t="ArrowRight"),"Down"==t&&(t="ArrowDown"),t}(o),i=t[Pl(r,o)];if(i&&i(e.state,e.dispatch,e))return!0;if(1==r.length&&" "!=r){if(o.shiftKey){let n=t[Pl(r,o,!1)];if(n&&n(e.state,e.dispatch,e))return!0}if((o.shiftKey||o.altKey||o.metaKey||r.charCodeAt(0)>127)&&(n=El[o.keyCode])&&n!=r){let r=t[Pl(n,o)];if(r&&r(e.state,e.dispatch,e))return!0}}return!1}}const Il=(e,t)=>!e.selection.empty&&(t&&t(e.tr.deleteSelection().scrollIntoView()),!0);function Ml(e,t){let{$cursor:o}=e.selection;return!o||(t?!t.endOfTextblock("backward",e):o.parentOffset>0)?null:o}const Ll=(e,t,o)=>{let n=Ml(e,o);if(!n)return!1;let r=Hl(n);if(!r){let o=n.blockRange(),r=o&&gr(o);return null!=r&&(t&&t(e.tr.lift(o,r).scrollIntoView()),!0)}let i=r.nodeBefore;if(Zl(e,r,t,-1))return!0;if(0==n.parent.content.size&&(Gl(i,"end")||Wr.isSelectable(i)))for(let a=n.depth;;a--){let o=Er(e.doc,n.before(a),n.after(a),Yo.empty);if(o&&o.slice.size<o.to-o.from){if(t){let n=e.tr.step(o);n.setSelection(Gl(i,"end")?zr.findFrom(n.doc.resolve(n.mapping.map(r.pos,-1)),-1):Wr.create(n.doc,r.pos-i.nodeSize)),t(n.scrollIntoView())}return!0}if(1==a||n.node(a-1).childCount>1)break}return!(!i.isAtom||r.depth!=n.depth-1)&&(t&&t(e.tr.delete(r.pos-i.nodeSize,r.pos).scrollIntoView()),!0)};function Fl(e,t,o){let n=t.nodeBefore,r=t.pos-1;for(;!n.isTextblock;r--){if(n.type.spec.isolating)return!1;let e=n.lastChild;if(!e)return!1;n=e}let i=t.nodeAfter,a=t.pos+1;for(;!i.isTextblock;a++){if(i.type.spec.isolating)return!1;let e=i.firstChild;if(!e)return!1;i=e}let s=Er(e.doc,r,a,Yo.empty);if(!s||s.from!=r||s instanceof dr&&s.slice.size>=a-r)return!1;if(o){let t=e.tr.step(s);t.setSelection($r.create(t.doc,r)),o(t.scrollIntoView())}return!0}function Gl(e,t){let o=arguments.length>2&&void 0!==arguments[2]&&arguments[2];for(let n=e;n;n="start"==t?n.firstChild:n.lastChild){if(n.isTextblock)return!0;if(o&&1!=n.childCount)return!1}return!1}const zl=(e,t,o)=>{let{$head:n,empty:r}=e.selection,i=n;if(!r)return!1;if(n.parent.isTextblock){if(o?!o.endOfTextblock("backward",e):n.parentOffset>0)return!1;i=Hl(n)}let a=i&&i.nodeBefore;return!(!a||!Wr.isSelectable(a))&&(t&&t(e.tr.setSelection(Wr.create(e.doc,i.pos-a.nodeSize)).scrollIntoView()),!0)};function Hl(e){if(!e.parent.type.spec.isolating)for(let t=e.depth-1;t>=0;t--){if(e.index(t)>0)return e.doc.resolve(e.before(t+1));if(e.node(t).type.spec.isolating)break}return null}function Bl(e,t){let{$cursor:o}=e.selection;return!o||(t?!t.endOfTextblock("forward",e):o.parentOffset<o.parent.content.size)?null:o}const Vl=(e,t,o)=>{let n=Bl(e,o);if(!n)return!1;let r=Ul(n);if(!r)return!1;let i=r.nodeAfter;if(Zl(e,r,t,1))return!0;if(0==n.parent.content.size&&(Gl(i,"start")||Wr.isSelectable(i))){let o=Er(e.doc,n.before(),n.after(),Yo.empty);if(o&&o.slice.size<o.to-o.from){if(t){let n=e.tr.step(o);n.setSelection(Gl(i,"start")?zr.findFrom(n.doc.resolve(n.mapping.map(r.pos)),1):Wr.create(n.doc,n.mapping.map(r.pos))),t(n.scrollIntoView())}return!0}}return!(!i.isAtom||r.depth!=n.depth-1)&&(t&&t(e.tr.delete(r.pos,r.pos+i.nodeSize).scrollIntoView()),!0)},$l=(e,t,o)=>{let{$head:n,empty:r}=e.selection,i=n;if(!r)return!1;if(n.parent.isTextblock){if(o?!o.endOfTextblock("forward",e):n.parentOffset<n.parent.content.size)return!1;i=Ul(n)}let a=i&&i.nodeAfter;return!(!a||!Wr.isSelectable(a))&&(t&&t(e.tr.setSelection(Wr.create(e.doc,i.pos)).scrollIntoView()),!0)};function Ul(e){if(!e.parent.type.spec.isolating)for(let t=e.depth-1;t>=0;t--){let o=e.node(t);if(e.index(t)+1<o.childCount)return e.doc.resolve(e.after(t+1));if(o.type.spec.isolating)break}return null}const Wl=(e,t)=>{let{$head:o,$anchor:n}=e.selection;return!(!o.parent.type.spec.code||!o.sameParent(n))&&(t&&t(e.tr.insertText("\n").scrollIntoView()),!0)};function ql(e){for(let t=0;t<e.edgeCount;t++){let{type:o}=e.edge(t);if(o.isTextblock&&!o.hasRequiredAttrs())return o}return null}const Kl=(e,t)=>{let{$head:o,$anchor:n}=e.selection;if(!o.parent.type.spec.code||!o.sameParent(n))return!1;let r=o.node(-1),i=o.indexAfter(-1),a=ql(r.contentMatchAt(i));if(!a||!r.canReplaceWith(i,i,a))return!1;if(t){let n=o.after(),r=e.tr.replaceWith(n,n,a.createAndFill());r.setSelection(zr.near(r.doc.resolve(n),1)),t(r.scrollIntoView())}return!0},Yl=(e,t)=>{let o=e.selection,{$from:n,$to:r}=o;if(o instanceof Kr||n.parent.inlineContent||r.parent.inlineContent)return!1;let i=ql(r.parent.contentMatchAt(r.indexAfter()));if(!i||!i.isTextblock)return!1;if(t){let o=(!n.parentOffset&&r.index()<r.parent.childCount?n:r).pos,a=e.tr.insert(o,i.createAndFill());a.setSelection($r.create(a.doc,o+1)),t(a.scrollIntoView())}return!0},Jl=(e,t)=>{let{$cursor:o}=e.selection;if(!o||o.parent.content.size)return!1;if(o.depth>1&&o.after()!=o.end(-1)){let n=o.before();if(xr(e.doc,n))return t&&t(e.tr.split(n).scrollIntoView()),!0}let n=o.blockRange(),r=n&&gr(n);return null!=r&&(t&&t(e.tr.lift(n,r).scrollIntoView()),!0)};const Xl=(e,t)=>{let{$from:o,$to:n}=e.selection;if(e.selection instanceof Wr&&e.selection.node.isBlock)return!(!o.parentOffset||!xr(e.doc,o.pos))&&(t&&t(e.tr.split(o.pos).scrollIntoView()),!0);if(!o.depth)return!1;let r,i,a=[],s=!1,l=!1;for(let p=o.depth;;p--){if(o.node(p).isBlock){s=o.end(p)==o.pos+(o.depth-p),l=o.start(p)==o.pos-(o.depth-p),i=ql(o.node(p-1).contentMatchAt(o.indexAfter(p-1)));let e=Ql&&Ql(n.parent,s,o);a.unshift(e||(s&&i?{type:i}:null)),r=p;break}if(1==p)return!1;a.unshift(null)}let c=e.tr;(e.selection instanceof $r||e.selection instanceof Kr)&&c.deleteSelection();let d=c.mapping.map(o.pos),u=xr(c.doc,d,a.length,a);if(u||(a[0]=i?{type:i}:null,u=xr(c.doc,d,a.length,a)),c.split(d,a.length,a),!s&&l&&o.node(r).type!=i){let e=c.mapping.map(o.before(r)),t=c.doc.resolve(e);i&&o.node(r-1).canReplaceWith(t.index(),t.index()+1,i)&&c.setNodeMarkup(c.mapping.map(o.before(r)),i)}return t&&t(c.scrollIntoView()),!0};var Ql;function Zl(e,t,o,n){let r,i,a=t.nodeBefore,s=t.nodeAfter,l=a.type.spec.isolating||s.type.spec.isolating;if(!l&&function(e,t,o){let n=t.nodeBefore,r=t.nodeAfter,i=t.index();return!!(n&&r&&n.type.compatibleContent(r.type))&&(!n.content.size&&t.parent.canReplace(i-1,i)?(o&&o(e.tr.delete(t.pos-n.nodeSize,t.pos).scrollIntoView()),!0):!(!t.parent.canReplace(i,i+1)||!r.isTextblock&&!wr(e.doc,t.pos))&&(o&&o(e.tr.join(t.pos).scrollIntoView()),!0))}(e,t,o))return!0;let c=!l&&t.parent.canReplace(t.index(),t.index()+1);if(c&&(r=(i=a.contentMatchAt(a.childCount)).findWrapping(s.type))&&i.matchType(r[0]||s.type).validEnd){if(o){let n=t.pos+s.nodeSize,i=Vo.empty;for(let e=r.length-1;e>=0;e--)i=Vo.from(r[e].create(null,i));i=Vo.from(a.copy(i));let l=e.tr.step(new ur(t.pos-1,n,t.pos,n,new Yo(i,1,0),r.length,!0)),c=l.doc.resolve(n+2*r.length);c.nodeAfter&&c.nodeAfter.type==a.type&&wr(l.doc,c.pos)&&l.join(c.pos),o(l.scrollIntoView())}return!0}let d=s.type.spec.isolating||n>0&&l?null:zr.findFrom(t,1),u=d&&d.$from.blockRange(d.$to),p=u&&gr(u);if(null!=p&&p>=t.depth)return o&&o(e.tr.lift(u,p).scrollIntoView()),!0;if(c&&Gl(s,"start",!0)&&Gl(a,"end")){let n=a,r=[];for(;r.push(n),!n.isTextblock;)n=n.lastChild;let i=s,l=1;for(;!i.isTextblock;i=i.firstChild)l++;if(n.canReplace(n.childCount,n.childCount,i.content)){if(o){let n=Vo.empty;for(let e=r.length-1;e>=0;e--)n=Vo.from(r[e].copy(n));o(e.tr.step(new ur(t.pos-r.length,t.pos+s.nodeSize,t.pos+l,t.pos+s.nodeSize-l,new Yo(n,r.length,0),0,!0)).scrollIntoView())}return!0}}return!1}function ec(e){return function(t,o){let n=t.selection,r=e<0?n.$from:n.$to,i=r.depth;for(;r.node(i).isInline;){if(!i)return!1;i--}return!!r.node(i).isTextblock&&(o&&o(t.tr.setSelection($r.create(t.doc,e<0?r.start(i):r.end(i)))),!0)}}const tc=ec(-1),oc=ec(1);function nc(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;return function(o,n){let r=!1;for(let i=0;i<o.selection.ranges.length&&!r;i++){let{$from:{pos:n},$to:{pos:a}}=o.selection.ranges[i];o.doc.nodesBetween(n,a,((n,i)=>{if(r)return!1;if(n.isTextblock&&!n.hasMarkup(e,t))if(n.type==e)r=!0;else{let t=o.doc.resolve(i),n=t.index();r=t.parent.canReplaceWith(n,n+1,e)}}))}if(!r)return!1;if(n){let r=o.tr;for(let n=0;n<o.selection.ranges.length;n++){let{$from:{pos:i},$to:{pos:a}}=o.selection.ranges[n];r.setBlockType(i,a,e,t)}n(r.scrollIntoView())}return!0}}function rc(){for(var e=arguments.length,t=new Array(e),o=0;o<e;o++)t[o]=arguments[o];return function(e,o,n){for(let r=0;r<t.length;r++)if(t[r](e,o,n))return!0;return!1}}let ic=rc(Il,Ll,zl),ac=rc(Il,Vl,$l);const sc={Enter:rc(Wl,Yl,Jl,Xl),"Mod-Enter":Kl,Backspace:ic,"Mod-Backspace":ic,"Shift-Backspace":ic,Delete:ac,"Mod-Delete":ac,"Mod-a":(e,t)=>(t&&t(e.tr.setSelection(new Kr(e.doc))),!0)},lc={"Ctrl-h":sc.Backspace,"Alt-Backspace":sc["Mod-Backspace"],"Ctrl-d":sc.Delete,"Ctrl-Alt-Backspace":sc["Mod-Delete"],"Alt-Delete":sc["Mod-Delete"],"Alt-d":sc["Mod-Delete"],"Ctrl-a":tc,"Ctrl-e":oc};for(let o in sc)lc[o]=sc[o];"undefined"!=typeof navigator?/Mac|iP(hone|[oa]d)/.test(navigator.platform):!("undefined"==typeof os||!os.platform)&&os.platform();function cc(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;return function(o,n){let{$from:r,$to:i}=o.selection,a=r.blockRange(i);if(!a)return!1;let s=n?o.tr:null;return!!function(e,t,o){let n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,r=!1,i=t,a=t.$from.doc;if(t.depth>=2&&t.$from.node(t.depth-1).type.compatibleContent(o)&&0==t.startIndex){if(0==t.$from.index(t.depth-1))return!1;let e=a.resolve(t.start-2);i=new pn(e,e,t.depth),t.endIndex<t.parent.childCount&&(t=new pn(t.$from,a.resolve(t.$to.end(t.depth)),t.depth)),r=!0}let s=mr(i,o,n,t);if(!s)return!1;e&&function(e,t,o,n,r){let i=Vo.empty;for(let d=o.length-1;d>=0;d--)i=Vo.from(o[d].type.create(o[d].attrs,i));e.step(new ur(t.start-(n?2:0),t.end,t.start,t.end,new Yo(i,0,0),o.length,!0));let a=0;for(let d=0;d<o.length;d++)o[d].type==r&&(a=d+1);let s=o.length-a,l=t.start+o.length-(n?2:0),c=t.parent;for(let d=t.startIndex,u=t.endIndex,p=!0;d<u;d++,p=!1)!p&&xr(e.doc,l,s)&&(e.split(l,s),l+=2*s),l+=c.child(d).nodeSize}(e,t,s,r,o);return!0}(s,a,e,t)&&(n&&n(s.scrollIntoView()),!0)}}function dc(e){return function(t,o){let{$from:n,$to:r}=t.selection,i=n.blockRange(r,(t=>t.childCount>0&&t.firstChild.type==e));return!!i&&(!o||(n.node(i.depth-1).type==e?function(e,t,o,n){let r=e.tr,i=n.end,a=n.$to.end(n.depth);i<a&&(r.step(new ur(i-1,a,i,a,new Yo(Vo.from(o.create(null,n.parent.copy())),1,0),1,!0)),n=new pn(r.doc.resolve(n.$from.pos),r.doc.resolve(a),n.depth));const s=gr(n);if(null==s)return!1;r.lift(n,s);let l=r.doc.resolve(r.mapping.map(i,-1)-1);wr(r.doc,l.pos)&&l.nodeBefore.type==l.nodeAfter.type&&r.join(l.pos);return t(r.scrollIntoView()),!0}(t,o,e,i):function(e,t,o){let n=e.tr,r=o.parent;for(let h=o.end,f=o.endIndex-1,g=o.startIndex;f>g;f--)h-=r.child(f).nodeSize,n.delete(h-1,h+1);let i=n.doc.resolve(o.start),a=i.nodeAfter;if(n.mapping.map(o.end)!=o.start+i.nodeAfter.nodeSize)return!1;let s=0==o.startIndex,l=o.endIndex==r.childCount,c=i.node(-1),d=i.index(-1);if(!c.canReplace(d+(s?0:1),d+1,a.content.append(l?Vo.empty:Vo.from(r))))return!1;let u=i.pos,p=u+a.nodeSize;return n.step(new ur(u-(s?1:0),p+(l?1:0),u+1,p-1,new Yo((s?Vo.empty:Vo.from(r.copy(Vo.empty))).append(l?Vo.empty:Vo.from(r.copy(Vo.empty))),s?0:1,l?0:1),s?0:1)),t(n.scrollIntoView()),!0}(t,o,i)))}}function uc(e){const{state:t,transaction:o}=e;let{selection:n}=o,{doc:r}=o,{storedMarks:i}=o;return{...t,apply:t.apply.bind(t),applyTransaction:t.applyTransaction.bind(t),plugins:t.plugins,schema:t.schema,reconfigure:t.reconfigure.bind(t),toJSON:t.toJSON.bind(t),get storedMarks(){return i},get selection(){return n},get doc(){return r},get tr(){return n=o.selection,r=o.doc,i=o.storedMarks,o}}}class pc{constructor(e){this.editor=e.editor,this.rawCommands=this.editor.extensionManager.commands,this.customState=e.state}get hasCustomState(){return!!this.customState}get state(){return this.customState||this.editor.state}get commands(){var e=this;const{rawCommands:t,editor:o,state:n}=this,{view:r}=o,{tr:i}=n,a=this.buildProps(i);return Object.fromEntries(Object.entries(t).map((t=>{let[o,n]=t;return[o,function(){const t=n(...arguments)(a);return i.getMeta("preventDispatch")||e.hasCustomState||r.dispatch(i),t}]})))}get chain(){return()=>this.createChain()}get can(){return()=>this.createCan()}createChain(e){var t=this;let o=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];const{rawCommands:n,editor:r,state:i}=this,{view:a}=r,s=[],l=!!e,c=e||i.tr,d={...Object.fromEntries(Object.entries(n).map((e=>{let[n,r]=e;return[n,function(){const e=t.buildProps(c,o),n=r(...arguments)(e);return s.push(n),d}]}))),run:()=>(l||!o||c.getMeta("preventDispatch")||this.hasCustomState||a.dispatch(c),s.every((e=>!0===e)))};return d}createCan(e){const{rawCommands:t,state:o}=this,n=!1,r=e||o.tr,i=this.buildProps(r,n),a=Object.fromEntries(Object.entries(t).map((e=>{let[t,o]=e;return[t,function(){return o(...arguments)({...i,dispatch:void 0})}]})));return{...a,chain:()=>this.createChain(r,n)}}buildProps(e){let t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];const{rawCommands:o,editor:n,state:r}=this,{view:i}=n,a={tr:e,editor:n,view:i,state:uc({state:r,transaction:e}),dispatch:t?()=>{}:void 0,chain:()=>this.createChain(e,t),can:()=>this.createCan(e),get commands(){return Object.fromEntries(Object.entries(o).map((e=>{let[t,o]=e;return[t,function(){return o(...arguments)(a)}]})))}};return a}}class hc{constructor(){this.callbacks={}}on(e,t){return this.callbacks[e]||(this.callbacks[e]=[]),this.callbacks[e].push(t),this}emit(e){for(var t=arguments.length,o=new Array(t>1?t-1:0),n=1;n<t;n++)o[n-1]=arguments[n];const r=this.callbacks[e];return r&&r.forEach((e=>e.apply(this,o))),this}off(e,t){const o=this.callbacks[e];return o&&(t?this.callbacks[e]=o.filter((e=>e!==t)):delete this.callbacks[e]),this}once(e,t){var o=this;const n=function(){o.off(e,n);for(var r=arguments.length,i=new Array(r),a=0;a<r;a++)i[a]=arguments[a];t.apply(o,i)};return this.on(e,n)}removeAllListeners(){this.callbacks={}}}function fc(e,t,o){if(void 0===e.config[t]&&e.parent)return fc(e.parent,t,o);if("function"===typeof e.config[t]){return e.config[t].bind({...o,parent:e.parent?fc(e.parent,t,o):null})}return e.config[t]}function gc(e){return{baseExtensions:e.filter((e=>"extension"===e.type)),nodeExtensions:e.filter((e=>"node"===e.type)),markExtensions:e.filter((e=>"mark"===e.type))}}function mc(e){const t=[],{nodeExtensions:o,markExtensions:n}=gc(e),r=[...o,...n],i={default:null,rendered:!0,renderHTML:null,parseHTML:null,keepOnSplit:!0,isRequired:!1};return e.forEach((e=>{const o=fc(e,"addGlobalAttributes",{name:e.name,options:e.options,storage:e.storage,extensions:r});if(!o)return;o().forEach((e=>{e.types.forEach((o=>{Object.entries(e.attributes).forEach((e=>{let[n,r]=e;t.push({type:o,name:n,attribute:{...i,...r}})}))}))}))})),r.forEach((e=>{const o={name:e.name,options:e.options,storage:e.storage},n=fc(e,"addAttributes",o);if(!n)return;const r=n();Object.entries(r).forEach((o=>{let[n,r]=o;const a={...i,...r};"function"===typeof(null===a||void 0===a?void 0:a.default)&&(a.default=a.default()),(null===a||void 0===a?void 0:a.isRequired)&&void 0===(null===a||void 0===a?void 0:a.default)&&delete a.default,t.push({type:e.name,name:n,attribute:a})}))})),t}function yc(e,t){if("string"===typeof e){if(!t.nodes[e])throw Error(`There is no node type named '${e}'. Maybe you forgot to add the extension?`);return t.nodes[e]}return e}function vc(){for(var e=arguments.length,t=new Array(e),o=0;o<e;o++)t[o]=arguments[o];return t.filter((e=>!!e)).reduce(((e,t)=>{const o={...e};return Object.entries(t).forEach((e=>{let[t,n]=e;if(o[t])if("class"===t){const e=n?String(n).split(" "):[],r=o[t]?o[t].split(" "):[],i=e.filter((e=>!r.includes(e)));o[t]=[...r,...i].join(" ")}else if("style"===t){const e=n?n.split(";").map((e=>e.trim())).filter(Boolean):[],r=o[t]?o[t].split(";").map((e=>e.trim())).filter(Boolean):[],i=new Map;r.forEach((e=>{const[t,o]=e.split(":").map((e=>e.trim()));i.set(t,o)})),e.forEach((e=>{const[t,o]=e.split(":").map((e=>e.trim()));i.set(t,o)})),o[t]=Array.from(i.entries()).map((e=>{let[t,o]=e;return`${t}: ${o}`})).join("; ")}else o[t]=n;else o[t]=n})),o}),{})}function bc(e,t){return t.filter((t=>t.type===e.type.name)).filter((e=>e.attribute.rendered)).map((t=>t.attribute.renderHTML?t.attribute.renderHTML(e.attrs)||{}:{[t.name]:e.attrs[t.name]})).reduce(((e,t)=>vc(e,t)),{})}function xc(e){return"function"===typeof e}function wc(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:void 0;if(xc(e)){for(var o=arguments.length,n=new Array(o>2?o-2:0),r=2;r<o;r++)n[r-2]=arguments[r];return t?e.bind(t)(...n):e(...n)}return e}function Cc(e,t){return"style"in e?e:{...e,getAttrs:o=>{const n=e.getAttrs?e.getAttrs(o):e.attrs;if(!1===n)return!1;const r=t.reduce(((e,t)=>{const n=t.attribute.parseHTML?t.attribute.parseHTML(o):function(e){return"string"!==typeof e?e:e.match(/^[+-]?(?:\d*\.)?\d+$/)?Number(e):"true"===e||"false"!==e&&e}(o.getAttribute(t.name));return null===n||void 0===n?e:{...e,[t.name]:n}}),{});return{...n,...r}}}}function _c(e){return Object.fromEntries(Object.entries(e).filter((e=>{let[t,o]=e;return("attrs"!==t||!function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return 0===Object.keys(e).length&&e.constructor===Object}(o))&&(null!==o&&void 0!==o)})))}function Sc(e,t){var o;const n=mc(e),{nodeExtensions:r,markExtensions:i}=gc(e),a=null===(o=r.find((e=>fc(e,"topNode"))))||void 0===o?void 0:o.name,s=Object.fromEntries(r.map((o=>{const r=n.filter((e=>e.type===o.name)),i={name:o.name,options:o.options,storage:o.storage,editor:t},a=_c({...e.reduce(((e,t)=>{const n=fc(t,"extendNodeSchema",i);return{...e,...n?n(o):{}}}),{}),content:wc(fc(o,"content",i)),marks:wc(fc(o,"marks",i)),group:wc(fc(o,"group",i)),inline:wc(fc(o,"inline",i)),atom:wc(fc(o,"atom",i)),selectable:wc(fc(o,"selectable",i)),draggable:wc(fc(o,"draggable",i)),code:wc(fc(o,"code",i)),whitespace:wc(fc(o,"whitespace",i)),linebreakReplacement:wc(fc(o,"linebreakReplacement",i)),defining:wc(fc(o,"defining",i)),isolating:wc(fc(o,"isolating",i)),attrs:Object.fromEntries(r.map((e=>{var t;return[e.name,{default:null===(t=null===e||void 0===e?void 0:e.attribute)||void 0===t?void 0:t.default}]})))}),s=wc(fc(o,"parseHTML",i));s&&(a.parseDOM=s.map((e=>Cc(e,r))));const l=fc(o,"renderHTML",i);l&&(a.toDOM=e=>l({node:e,HTMLAttributes:bc(e,r)}));const c=fc(o,"renderText",i);return c&&(a.toText=c),[o.name,a]}))),l=Object.fromEntries(i.map((o=>{const r=n.filter((e=>e.type===o.name)),i={name:o.name,options:o.options,storage:o.storage,editor:t},a=_c({...e.reduce(((e,t)=>{const n=fc(t,"extendMarkSchema",i);return{...e,...n?n(o):{}}}),{}),inclusive:wc(fc(o,"inclusive",i)),excludes:wc(fc(o,"excludes",i)),group:wc(fc(o,"group",i)),spanning:wc(fc(o,"spanning",i)),code:wc(fc(o,"code",i)),attrs:Object.fromEntries(r.map((e=>{var t;return[e.name,{default:null===(t=null===e||void 0===e?void 0:e.attribute)||void 0===t?void 0:t.default}]})))}),s=wc(fc(o,"parseHTML",i));s&&(a.parseDOM=s.map((e=>Cc(e,r))));const l=fc(o,"renderHTML",i);return l&&(a.toDOM=e=>l({mark:e,HTMLAttributes:bc(e,r)})),[o.name,a]})));return new Pn({topNode:a,nodes:s,marks:l})}function Ec(e,t){return t.nodes[e]||t.marks[e]||null}function kc(e,t){return Array.isArray(t)?t.some((t=>("string"===typeof t?t:t.name)===e.name)):t}function jc(e,t){const o=Un.fromSchema(t).serializeFragment(e),n=document.implementation.createHTMLDocument().createElement("div");return n.appendChild(o),n.innerHTML}function Ac(e){return"[object RegExp]"===Object.prototype.toString.call(e)}class Rc{constructor(e){this.find=e.find,this.handler=e.handler}}function Oc(e){var t;const{editor:o,from:n,to:r,text:i,rules:a,plugin:s}=e,{view:l}=o;if(l.composing)return!1;const c=l.state.doc.resolve(n);if(c.parent.type.spec.code||(null===(t=c.nodeBefore||c.nodeAfter)||void 0===t?void 0:t.marks.find((e=>e.type.spec.code))))return!1;let d=!1;const u=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:500,o="";const n=e.parentOffset;return e.parent.nodesBetween(Math.max(0,n-t),n,((e,t,r,i)=>{var a,s;const l=(null===(s=(a=e.type.spec).toText)||void 0===s?void 0:s.call(a,{node:e,pos:t,parent:r,index:i}))||e.textContent||"%leaf%";o+=e.isAtom&&!e.isText?l:l.slice(0,Math.max(0,n-t))})),o}(c)+i;return a.forEach((e=>{if(d)return;const t=((e,t)=>{if(Ac(t))return t.exec(e);const o=t(e);if(!o)return null;const n=[o.text];return n.index=o.index,n.input=e,n.data=o.data,o.replaceWith&&(o.text.includes(o.replaceWith)||console.warn('[tiptap warn]: "inputRuleMatch.replaceWith" must be part of "inputRuleMatch.text".'),n.push(o.replaceWith)),n})(u,e.find);if(!t)return;const a=l.state.tr,c=uc({state:l.state,transaction:a}),p={from:n-(t[0].length-i.length),to:r},{commands:h,chain:f,can:g}=new pc({editor:o,state:c});null!==e.handler({state:c,range:p,match:t,commands:h,chain:f,can:g})&&a.steps.length&&(a.setMeta(s,{transform:a,from:n,to:r,text:i}),l.dispatch(a),d=!0)})),d}function Tc(e){const{editor:t,rules:o}=e,n=new ii({state:{init:()=>null,apply(e,r,i){const a=e.getMeta(n);if(a)return a;const s=e.getMeta("applyInputRules");return!!s&&setTimeout((()=>{let{text:e}=s;"string"===typeof e||(e=jc(Vo.from(e),i.schema));const{from:r}=s,a=r+e.length;Oc({editor:t,from:r,to:a,text:e,rules:o,plugin:n})})),e.selectionSet||e.docChanged?null:r}},props:{handleTextInput:(e,r,i,a)=>Oc({editor:t,from:r,to:i,text:a,rules:o,plugin:n}),handleDOMEvents:{compositionend:e=>(setTimeout((()=>{const{$cursor:r}=e.state.selection;r&&Oc({editor:t,from:r.pos,to:r.pos,text:"",rules:o,plugin:n})})),!1)},handleKeyDown(e,r){if("Enter"!==r.key)return!1;const{$cursor:i}=e.state.selection;return!!i&&Oc({editor:t,from:i.pos,to:i.pos,text:"\n",rules:o,plugin:n})}},isInputRules:!0});return n}function Dc(e){return"Object"===function(e){return Object.prototype.toString.call(e).slice(8,-1)}(e)&&(e.constructor===Object&&Object.getPrototypeOf(e)===Object.prototype)}function Pc(e,t){const o={...e};return Dc(e)&&Dc(t)&&Object.keys(t).forEach((n=>{Dc(t[n])&&Dc(e[n])?o[n]=Pc(e[n],t[n]):o[n]=t[n]})),o}class Nc{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this.type="mark",this.name="mark",this.parent=null,this.child=null,this.config={name:this.name,defaultOptions:{}},this.config={...this.config,...e},this.name=this.config.name,e.defaultOptions&&Object.keys(e.defaultOptions).length>0&&console.warn(`[tiptap warn]: BREAKING CHANGE: "defaultOptions" is deprecated. Please use "addOptions" instead. Found in extension: "${this.name}".`),this.options=this.config.defaultOptions,this.config.addOptions&&(this.options=wc(fc(this,"addOptions",{name:this.name}))),this.storage=wc(fc(this,"addStorage",{name:this.name,options:this.options}))||{}}static create(){return new Nc(arguments.length>0&&void 0!==arguments[0]?arguments[0]:{})}configure(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const t=this.extend({...this.config,addOptions:()=>Pc(this.options,e)});return t.name=this.name,t.parent=this.parent,t}extend(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const t=new Nc(e);return t.parent=this,this.child=t,t.name=e.name?e.name:t.parent.name,e.defaultOptions&&Object.keys(e.defaultOptions).length>0&&console.warn(`[tiptap warn]: BREAKING CHANGE: "defaultOptions" is deprecated. Please use "addOptions" instead. Found in extension: "${t.name}".`),t.options=wc(fc(t,"addOptions",{name:t.name})),t.storage=wc(fc(t,"addStorage",{name:t.name,options:t.options})),t}static handleExit(e){let{editor:t,mark:o}=e;const{tr:n}=t.state,r=t.state.selection.$from;if(r.pos===r.end()){const e=r.marks();if(!!!e.find((e=>(null===e||void 0===e?void 0:e.type.name)===o.name)))return!1;const i=e.find((e=>(null===e||void 0===e?void 0:e.type.name)===o.name));return i&&n.removeStoredMark(i),n.insertText(" ",r.pos),t.view.dispatch(n),!0}return!1}}class Ic{constructor(e){this.find=e.find,this.handler=e.handler}}function Mc(e){const{editor:t,state:o,from:n,to:r,rule:i,pasteEvent:a,dropEvent:s}=e,{commands:l,chain:c,can:d}=new pc({editor:t,state:o}),u=[];o.doc.nodesBetween(n,r,((e,t)=>{if(!e.isTextblock||e.type.spec.code)return;const p=Math.max(n,t),h=Math.min(r,t+e.content.size);((e,t,o)=>{if(Ac(t))return[...e.matchAll(t)];const n=t(e,o);return n?n.map((t=>{const o=[t.text];return o.index=t.index,o.input=e,o.data=t.data,t.replaceWith&&(t.text.includes(t.replaceWith)||console.warn('[tiptap warn]: "pasteRuleMatch.replaceWith" must be part of "pasteRuleMatch.text".'),o.push(t.replaceWith)),o})):[]})(e.textBetween(p-t,h-t,void 0,"\ufffc"),i.find,a).forEach((e=>{if(void 0===e.index)return;const t=p+e.index+1,n=t+e[0].length,r={from:o.tr.mapping.map(t),to:o.tr.mapping.map(n)},h=i.handler({state:o,range:r,match:e,commands:l,chain:c,can:d,pasteEvent:a,dropEvent:s});u.push(h)}))}));return u.every((e=>null!==e))}let Lc=null;function Fc(e){const{editor:t,rules:o}=e;let n,r=null,i=!1,a=!1,s="undefined"!==typeof ClipboardEvent?new ClipboardEvent("paste"):null;try{n="undefined"!==typeof DragEvent?new DragEvent("drop"):null}catch{n=null}const l=e=>{let{state:o,from:r,to:i,rule:a,pasteEvt:l}=e;const c=o.tr,d=uc({state:o,transaction:c});if(Mc({editor:t,state:d,from:Math.max(r-1,0),to:i.b-1,rule:a,pasteEvent:l,dropEvent:n})&&c.steps.length){try{n="undefined"!==typeof DragEvent?new DragEvent("drop"):null}catch{n=null}return s="undefined"!==typeof ClipboardEvent?new ClipboardEvent("paste"):null,c}};return o.map((e=>new ii({view(e){const o=o=>{var n;r=(null===(n=e.dom.parentElement)||void 0===n?void 0:n.contains(o.target))?e.dom.parentElement:null,r&&(Lc=t)},n=()=>{Lc&&(Lc=null)};return window.addEventListener("dragstart",o),window.addEventListener("dragend",n),{destroy(){window.removeEventListener("dragstart",o),window.removeEventListener("dragend",n)}}},props:{handleDOMEvents:{drop:(e,t)=>{if(a=r===e.dom.parentElement,n=t,!a){const e=Lc;e&&setTimeout((()=>{const t=e.state.selection;t&&e.commands.deleteRange({from:t.from,to:t.to})}),10)}return!1},paste:(e,t)=>{var o;const n=null===(o=t.clipboardData)||void 0===o?void 0:o.getData("text/html");return s=t,i=!!(null===n||void 0===n?void 0:n.includes("data-pm-slice")),!1}}},appendTransaction:(t,o,n)=>{const r=t[0],c="paste"===r.getMeta("uiEvent")&&!i,d="drop"===r.getMeta("uiEvent")&&!a,u=r.getMeta("applyPasteRules"),p=!!u;if(!c&&!d&&!p)return;if(p){let{text:t}=u;"string"===typeof t||(t=jc(Vo.from(t),n.schema));const{from:o}=u,r=o+t.length,i=(e=>{var t;const o=new ClipboardEvent("paste",{clipboardData:new DataTransfer});return null===(t=o.clipboardData)||void 0===t||t.setData("text/html",e),o})(t);return l({rule:e,state:n,from:o,to:{b:r},pasteEvt:i})}const h=o.doc.content.findDiffStart(n.doc.content),f=o.doc.content.findDiffEnd(n.doc.content);return"number"===typeof h&&f&&h!==f.b?l({rule:e,state:n,from:h,to:f,pasteEvt:s}):void 0}})))}class Gc{constructor(e,t){this.splittableMarks=[],this.editor=t,this.extensions=Gc.resolve(e),this.schema=Sc(this.extensions,t),this.setupExtensions()}static resolve(e){const t=Gc.sort(Gc.flatten(e)),o=function(e){const t=e.filter(((t,o)=>e.indexOf(t)!==o));return Array.from(new Set(t))}(t.map((e=>e.name)));return o.length&&console.warn(`[tiptap warn]: Duplicate extension names found: [${o.map((e=>`'${e}'`)).join(", ")}]. This can lead to issues.`),t}static flatten(e){return e.map((e=>{const t=fc(e,"addExtensions",{name:e.name,options:e.options,storage:e.storage});return t?[e,...this.flatten(t())]:e})).flat(10)}static sort(e){return e.sort(((e,t)=>{const o=fc(e,"priority")||100,n=fc(t,"priority")||100;return o>n?-1:o<n?1:0}))}get commands(){return this.extensions.reduce(((e,t)=>{const o=fc(t,"addCommands",{name:t.name,options:t.options,storage:t.storage,editor:this.editor,type:Ec(t.name,this.schema)});return o?{...e,...o()}:e}),{})}get plugins(){const{editor:e}=this,t=Gc.sort([...this.extensions].reverse()),o=[],n=[],r=t.map((t=>{const r={name:t.name,options:t.options,storage:t.storage,editor:e,type:Ec(t.name,this.schema)},i=[],a=fc(t,"addKeyboardShortcuts",r);let s={};if("mark"===t.type&&fc(t,"exitable",r)&&(s.ArrowRight=()=>Nc.handleExit({editor:e,mark:t})),a){const t=Object.fromEntries(Object.entries(a()).map((t=>{let[o,n]=t;return[o,()=>n({editor:e})]})));s={...s,...t}}const l=new ii({props:{handleKeyDown:Nl(s)}});i.push(l);const c=fc(t,"addInputRules",r);kc(t,e.options.enableInputRules)&&c&&o.push(...c());const d=fc(t,"addPasteRules",r);kc(t,e.options.enablePasteRules)&&d&&n.push(...d());const u=fc(t,"addProseMirrorPlugins",r);if(u){const e=u();i.push(...e)}return i})).flat();return[Tc({editor:e,rules:o}),...Fc({editor:e,rules:n}),...r]}get attributes(){return mc(this.extensions)}get nodeViews(){const{editor:e}=this,{nodeExtensions:t}=gc(this.extensions);return Object.fromEntries(t.filter((e=>!!fc(e,"addNodeView"))).map((t=>{const o=this.attributes.filter((e=>e.type===t.name)),n={name:t.name,options:t.options,storage:t.storage,editor:e,type:yc(t.name,this.schema)},r=fc(t,"addNodeView",n);if(!r)return[];return[t.name,(n,i,a,s,l)=>{const c=bc(n,o);return r()({node:n,view:i,getPos:a,decorations:s,innerDecorations:l,editor:e,extension:t,HTMLAttributes:c})}]})))}setupExtensions(){this.extensions.forEach((e=>{var t;this.editor.extensionStorage[e.name]=e.storage;const o={name:e.name,options:e.options,storage:e.storage,editor:this.editor,type:Ec(e.name,this.schema)};if("mark"===e.type){(null===(t=wc(fc(e,"keepOnSplit",o)))||void 0===t||t)&&this.splittableMarks.push(e.name)}const n=fc(e,"onBeforeCreate",o),r=fc(e,"onCreate",o),i=fc(e,"onUpdate",o),a=fc(e,"onSelectionUpdate",o),s=fc(e,"onTransaction",o),l=fc(e,"onFocus",o),c=fc(e,"onBlur",o),d=fc(e,"onDestroy",o);n&&this.editor.on("beforeCreate",n),r&&this.editor.on("create",r),i&&this.editor.on("update",i),a&&this.editor.on("selectionUpdate",a),s&&this.editor.on("transaction",s),l&&this.editor.on("focus",l),c&&this.editor.on("blur",c),d&&this.editor.on("destroy",d)}))}}class zc{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this.type="extension",this.name="extension",this.parent=null,this.child=null,this.config={name:this.name,defaultOptions:{}},this.config={...this.config,...e},this.name=this.config.name,e.defaultOptions&&Object.keys(e.defaultOptions).length>0&&console.warn(`[tiptap warn]: BREAKING CHANGE: "defaultOptions" is deprecated. Please use "addOptions" instead. Found in extension: "${this.name}".`),this.options=this.config.defaultOptions,this.config.addOptions&&(this.options=wc(fc(this,"addOptions",{name:this.name}))),this.storage=wc(fc(this,"addStorage",{name:this.name,options:this.options}))||{}}static create(){return new zc(arguments.length>0&&void 0!==arguments[0]?arguments[0]:{})}configure(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const t=this.extend({...this.config,addOptions:()=>Pc(this.options,e)});return t.name=this.name,t.parent=this.parent,t}extend(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const t=new zc({...this.config,...e});return t.parent=this,this.child=t,t.name=e.name?e.name:t.parent.name,e.defaultOptions&&Object.keys(e.defaultOptions).length>0&&console.warn(`[tiptap warn]: BREAKING CHANGE: "defaultOptions" is deprecated. Please use "addOptions" instead. Found in extension: "${t.name}".`),t.options=wc(fc(t,"addOptions",{name:t.name})),t.storage=wc(fc(t,"addStorage",{name:t.name,options:t.options})),t}}function Hc(e,t,o){const{from:n,to:r}=t,{blockSeparator:i="\n\n",textSerializers:a={}}=o||{};let s="";return e.nodesBetween(n,r,((e,o,l,c)=>{var d;e.isBlock&&o>n&&(s+=i);const u=null===a||void 0===a?void 0:a[e.type.name];if(u)return l&&(s+=u({node:e,pos:o,parent:l,index:c,range:t})),!1;e.isText&&(s+=null===(d=null===e||void 0===e?void 0:e.text)||void 0===d?void 0:d.slice(Math.max(n,o)-o,r-o))})),s}function Bc(e){return Object.fromEntries(Object.entries(e.nodes).filter((e=>{let[,t]=e;return t.spec.toText})).map((e=>{let[t,o]=e;return[t,o.spec.toText]})))}const Vc=zc.create({name:"clipboardTextSerializer",addOptions:()=>({blockSeparator:void 0}),addProseMirrorPlugins(){return[new ii({key:new li("clipboardTextSerializer"),props:{clipboardTextSerializer:()=>{const{editor:e}=this,{state:t,schema:o}=e,{doc:n,selection:r}=t,{ranges:i}=r,a=Math.min(...i.map((e=>e.$from.pos))),s=Math.max(...i.map((e=>e.$to.pos))),l=Bc(o);return Hc(n,{from:a,to:s},{...void 0!==this.options.blockSeparator?{blockSeparator:this.options.blockSeparator}:{},textSerializers:l})}}})]}});function $c(e,t){let o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{strict:!0};const n=Object.keys(t);return!n.length||n.every((n=>o.strict?t[n]===e[n]:Ac(t[n])?t[n].test(e[n]):t[n]===e[n]))}function Uc(e,t){let o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return e.find((e=>e.type===t&&$c(Object.fromEntries(Object.keys(o).map((t=>[t,e.attrs[t]]))),o)))}function Wc(e,t){return!!Uc(e,t,arguments.length>2&&void 0!==arguments[2]?arguments[2]:{})}function qc(e,t,o){var n;if(!e||!t)return;let r=e.parent.childAfter(e.parentOffset);if(r.node&&r.node.marks.some((e=>e.type===t))||(r=e.parent.childBefore(e.parentOffset)),!r.node||!r.node.marks.some((e=>e.type===t)))return;o=o||(null===(n=r.node.marks[0])||void 0===n?void 0:n.attrs);if(!Uc([...r.node.marks],t,o))return;let i=r.index,a=e.start()+r.offset,s=i+1,l=a+r.node.nodeSize;for(;i>0&&Wc([...e.parent.child(i-1).marks],t,o);)i-=1,a-=e.parent.child(i).nodeSize;for(;s<e.parent.childCount&&Wc([...e.parent.child(s).marks],t,o);)l+=e.parent.child(s).nodeSize,s+=1;return{from:a,to:l}}function Kc(e,t){if("string"===typeof e){if(!t.marks[e])throw Error(`There is no mark type named '${e}'. Maybe you forgot to add the extension?`);return t.marks[e]}return e}function Yc(e){return e instanceof $r}function Jc(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;return Math.min(Math.max(e,t),o)}function Xc(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;if(!t)return null;const o=zr.atStart(e),n=zr.atEnd(e);if("start"===t||!0===t)return o;if("end"===t)return n;const r=o.from,i=n.to;return"all"===t?$r.create(e,Jc(0,r,i),Jc(e.content.size,r,i)):$r.create(e,Jc(t,r,i),Jc(t,r,i))}function Qc(){return"Android"===navigator.platform||/android/i.test(navigator.userAgent)}function Zc(){return["iPad Simulator","iPhone Simulator","iPod Simulator","iPad","iPhone","iPod"].includes(navigator.platform)||navigator.userAgent.includes("Mac")&&"ontouchend"in document}const ed=e=>{const t=e.childNodes;for(let o=t.length-1;o>=0;o-=1){const n=t[o];3===n.nodeType&&n.nodeValue&&/^(\n\s\s|\n)$/.test(n.nodeValue)?e.removeChild(n):1===n.nodeType&&ed(n)}return e};function td(e){const t=`<body>${e}</body>`,o=(new window.DOMParser).parseFromString(t,"text/html").body;return ed(o)}function od(e,t,o){if(e instanceof fn||e instanceof Vo)return e;o={slice:!0,parseOptions:{},...o};const n="string"===typeof e;if("object"===typeof e&&null!==e)try{if(Array.isArray(e)&&e.length>0)return Vo.fromArray(e.map((e=>t.nodeFromJSON(e))));const n=t.nodeFromJSON(e);return o.errorOnInvalidContent&&n.check(),n}catch(r){if(o.errorOnInvalidContent)throw new Error("[tiptap error]: Invalid JSON content",{cause:r});return console.warn("[tiptap warn]: Invalid content.","Passed value:",e,"Error:",r),od("",t,o)}if(n){if(o.errorOnInvalidContent){let n=!1,r="";const i=new Pn({topNode:t.spec.topNode,marks:t.spec.marks,nodes:t.spec.nodes.append({__tiptap__private__unknown__catch__all__node:{content:"inline*",group:"block",parseDOM:[{tag:"*",getAttrs:e=>(n=!0,r="string"===typeof e?e:e.outerHTML,null)}]}})});if(o.slice?In.fromSchema(i).parseSlice(td(e),o.parseOptions):In.fromSchema(i).parse(td(e),o.parseOptions),o.errorOnInvalidContent&&n)throw new Error("[tiptap error]: Invalid HTML content",{cause:new Error(`Invalid element found: ${r}`)})}const n=In.fromSchema(t);return o.slice?n.parseSlice(td(e),o.parseOptions).content:n.parse(td(e),o.parseOptions)}return od("",t,o)}function nd(){return"undefined"!==typeof navigator&&/Mac/.test(navigator.platform)}function rd(e,t){let o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};const{from:n,to:r,empty:i}=e.selection,a=t?yc(t,e.schema):null,s=[];e.doc.nodesBetween(n,r,((e,t)=>{if(e.isText)return;const o=Math.max(n,t),i=Math.min(r,t+e.nodeSize);s.push({node:e,from:o,to:i})}));const l=r-n,c=s.filter((e=>!a||a.name===e.node.type.name)).filter((e=>$c(e.node.attrs,o,{strict:!1})));if(i)return!!c.length;return c.reduce(((e,t)=>e+t.to-t.from),0)>=l}function id(e,t){return t.nodes[e]?"node":t.marks[e]?"mark":null}function ad(e,t){const o="string"===typeof t?[t]:t;return Object.keys(e).reduce(((t,n)=>(o.includes(n)||(t[n]=e[n]),t)),{})}function sd(e,t){return od(e,t,{slice:!1,parseOptions:arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},errorOnInvalidContent:(arguments.length>3&&void 0!==arguments[3]?arguments[3]:{}).errorOnInvalidContent})}function ld(e,t){const o=Kc(t,e.schema),{from:n,to:r,empty:i}=e.selection,a=[];i?(e.storedMarks&&a.push(...e.storedMarks),a.push(...e.selection.$head.marks())):e.doc.nodesBetween(n,r,(e=>{a.push(...e.marks)}));const s=a.find((e=>e.type.name===o.name));return s?{...s.attrs}:{}}function cd(e){return t=>function(e,t){for(let o=e.depth;o>0;o-=1){const n=e.node(o);if(t(n))return{pos:o>0?e.before(o):0,start:e.start(o),depth:o,node:n}}}(t.$from,e)}function dd(e,t){return Hc(e,{from:0,to:e.content.size},t)}function ud(e,t){const o=id("string"===typeof t?t:t.name,e.schema);return"node"===o?function(e,t){const o=yc(t,e.schema),{from:n,to:r}=e.selection,i=[];e.doc.nodesBetween(n,r,(e=>{i.push(e)}));const a=i.reverse().find((e=>e.type.name===o.name));return a?{...a.attrs}:{}}(e,t):"mark"===o?ld(e,t):{}}function pd(e){const t=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:JSON.stringify;const o={};return e.filter((e=>{const n=t(e);return!Object.prototype.hasOwnProperty.call(o,n)&&(o[n]=!0)}))}(e);return 1===t.length?t:t.filter(((e,o)=>!t.filter(((e,t)=>t!==o)).some((t=>e.oldRange.from>=t.oldRange.from&&e.oldRange.to<=t.oldRange.to&&e.newRange.from>=t.newRange.from&&e.newRange.to<=t.newRange.to))))}function hd(e,t,o){const n=[];return e===t?o.resolve(e).marks().forEach((t=>{const r=qc(o.resolve(e),t.type);r&&n.push({mark:t,...r})})):o.nodesBetween(e,t,((e,t)=>{e&&void 0!==(null===e||void 0===e?void 0:e.nodeSize)&&n.push(...e.marks.map((o=>({from:t,to:t+e.nodeSize,mark:o}))))})),n}function fd(e,t,o){return Object.fromEntries(Object.entries(o).filter((o=>{let[n]=o;const r=e.find((e=>e.type===t&&e.name===n));return!!r&&r.attribute.keepOnSplit})))}function gd(e,t){let o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};const{empty:n,ranges:r}=e.selection,i=t?Kc(t,e.schema):null;if(n)return!!(e.storedMarks||e.selection.$from.marks()).filter((e=>!i||i.name===e.type.name)).find((e=>$c(e.attrs,o,{strict:!1})));let a=0;const s=[];if(r.forEach((t=>{let{$from:o,$to:n}=t;const r=o.pos,i=n.pos;e.doc.nodesBetween(r,i,((e,t)=>{if(!e.isText&&!e.marks.length)return;const o=Math.max(r,t),n=Math.min(i,t+e.nodeSize);a+=n-o,s.push(...e.marks.map((e=>({mark:e,from:o,to:n}))))}))})),0===a)return!1;const l=s.filter((e=>!i||i.name===e.mark.type.name)).filter((e=>$c(e.mark.attrs,o,{strict:!1}))).reduce(((e,t)=>e+t.to-t.from),0),c=s.filter((e=>!i||e.mark.type!==i&&e.mark.type.excludes(i))).reduce(((e,t)=>e+t.to-t.from),0);return(l>0?l+c:l)>=a}function md(e,t){const{nodeExtensions:o}=gc(t),n=o.find((t=>t.name===e));if(!n)return!1;const r=wc(fc(n,"group",{name:n.name,options:n.options,storage:n.storage}));return"string"===typeof r&&r.split(" ").includes("list")}function yd(e){let{checkChildren:t=!0,ignoreWhitespace:o=!1}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};var n;if(o){if("hardBreak"===e.type.name)return!0;if(e.isText)return/^\s*$/m.test(null!==(n=e.text)&&void 0!==n?n:"")}if(e.isText)return!e.text;if(e.isAtom||e.isLeaf)return!1;if(0===e.content.childCount)return!0;if(t){let n=!0;return e.content.forEach((e=>{!1!==n&&(yd(e,{ignoreWhitespace:o,checkChildren:t})||(n=!1))})),n}return!1}function vd(e,t){const o=e.storedMarks||e.selection.$to.parentOffset&&e.selection.$from.marks();if(o){const n=o.filter((e=>null===t||void 0===t?void 0:t.includes(e.type.name)));e.tr.ensureMarks(n)}}const bd=(e,t)=>{const o=cd((e=>e.type===t))(e.selection);if(!o)return!0;const n=e.doc.resolve(Math.max(0,o.pos-1)).before(o.depth);if(void 0===n)return!0;const r=e.doc.nodeAt(n);return o.node.type!==(null===r||void 0===r?void 0:r.type)||!wr(e.doc,o.pos)||(e.join(o.pos),!0)},xd=(e,t)=>{const o=cd((e=>e.type===t))(e.selection);if(!o)return!0;const n=e.doc.resolve(o.start).after(o.depth);if(void 0===n)return!0;const r=e.doc.nodeAt(n);return o.node.type!==(null===r||void 0===r?void 0:r.type)||!wr(e.doc,n)||(e.join(n),!0)};var wd=Object.freeze({__proto__:null,blur:()=>e=>{let{editor:t,view:o}=e;return requestAnimationFrame((()=>{var e;t.isDestroyed||(o.dom.blur(),null===(e=null===window||void 0===window?void 0:window.getSelection())||void 0===e||e.removeAllRanges())})),!0},clearContent:function(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];return t=>{let{commands:o}=t;return o.setContent("",e)}},clearNodes:()=>e=>{let{state:t,tr:o,dispatch:n}=e;const{selection:r}=o,{ranges:i}=r;return!n||(i.forEach((e=>{let{$from:n,$to:r}=e;t.doc.nodesBetween(n.pos,r.pos,((e,t)=>{if(e.type.isText)return;const{doc:n,mapping:r}=o,i=n.resolve(r.map(t)),a=n.resolve(r.map(t+e.nodeSize)),s=i.blockRange(a);if(!s)return;const l=gr(s);if(e.type.isTextblock){const{defaultType:e}=i.parent.contentMatchAt(i.index());o.setNodeMarkup(s.start,e)}(l||0===l)&&o.lift(s,l)}))})),!0)},command:e=>t=>e(t),createParagraphNear:()=>e=>{let{state:t,dispatch:o}=e;return Yl(t,o)},cut:(e,t)=>o=>{let{editor:n,tr:r}=o;const{state:i}=n,a=i.doc.slice(e.from,e.to);r.deleteRange(e.from,e.to);const s=r.mapping.map(t);return r.insert(s,a.content),r.setSelection(new $r(r.doc.resolve(s-1))),!0},deleteCurrentNode:()=>e=>{let{tr:t,dispatch:o}=e;const{selection:n}=t,r=n.$anchor.node();if(r.content.size>0)return!1;const i=t.selection.$anchor;for(let a=i.depth;a>0;a-=1){if(i.node(a).type===r.type){if(o){const e=i.before(a),o=i.after(a);t.delete(e,o).scrollIntoView()}return!0}}return!1},deleteNode:e=>t=>{let{tr:o,state:n,dispatch:r}=t;const i=yc(e,n.schema),a=o.selection.$anchor;for(let e=a.depth;e>0;e-=1){if(a.node(e).type===i){if(r){const t=a.before(e),n=a.after(e);o.delete(t,n).scrollIntoView()}return!0}}return!1},deleteRange:e=>t=>{let{tr:o,dispatch:n}=t;const{from:r,to:i}=e;return n&&o.delete(r,i),!0},deleteSelection:()=>e=>{let{state:t,dispatch:o}=e;return Il(t,o)},enter:()=>e=>{let{commands:t}=e;return t.keyboardShortcut("Enter")},exitCode:()=>e=>{let{state:t,dispatch:o}=e;return Kl(t,o)},extendMarkRange:function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return o=>{let{tr:n,state:r,dispatch:i}=o;const a=Kc(e,r.schema),{doc:s,selection:l}=n,{$from:c,from:d,to:u}=l;if(i){const e=qc(c,a,t);if(e&&e.from<=d&&e.to>=u){const t=$r.create(s,e.from,e.to);n.setSelection(t)}}return!0}},first:e=>t=>{const o="function"===typeof e?e(t):e;for(let e=0;e<o.length;e+=1)if(o[e](t))return!0;return!1},focus:function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return o=>{let{editor:n,view:r,tr:i,dispatch:a}=o;t={scrollIntoView:!0,...t};const s=()=>{(Zc()||Qc())&&r.dom.focus(),requestAnimationFrame((()=>{n.isDestroyed||(r.focus(),(null===t||void 0===t?void 0:t.scrollIntoView)&&n.commands.scrollIntoView())}))};if(r.hasFocus()&&null===e||!1===e)return!0;if(a&&null===e&&!Yc(n.state.selection))return s(),!0;const l=Xc(i.doc,e)||n.state.selection,c=n.state.selection.eq(l);return a&&(c||i.setSelection(l),c&&i.storedMarks&&i.setStoredMarks(i.storedMarks),s()),!0}},forEach:(e,t)=>o=>e.every(((e,n)=>t(e,{...o,index:n}))),insertContent:(e,t)=>o=>{let{tr:n,commands:r}=o;return r.insertContentAt({from:n.selection.from,to:n.selection.to},e,t)},insertContentAt:(e,t,o)=>n=>{let{tr:r,dispatch:i,editor:a}=n;var s;if(i){let n;o={parseOptions:a.options.parseOptions,updateSelection:!0,applyInputRules:!1,applyPasteRules:!1,...o};try{n=od(t,a.schema,{parseOptions:{preserveWhitespace:"full",...o.parseOptions},errorOnInvalidContent:null!==(s=o.errorOnInvalidContent)&&void 0!==s?s:a.options.enableContentCheck})}catch(SM){return a.emit("contentError",{editor:a,error:SM,disableCollaboration:()=>{a.storage.collaboration&&(a.storage.collaboration.isDisabled=!0)}}),!1}let{from:i,to:l}="number"===typeof e?{from:e,to:e}:{from:e.from,to:e.to},c=!0,d=!0;if(("type"in n?[n]:n).forEach((e=>{e.check(),c=!!c&&(e.isText&&0===e.marks.length),d=!!d&&e.isBlock})),i===l&&d){const{parent:e}=r.doc.resolve(i);e.isTextblock&&!e.type.spec.code&&!e.childCount&&(i-=1,l+=1)}let u;if(c){if(Array.isArray(t))u=t.map((e=>e.text||"")).join("");else if(t instanceof Vo){let e="";t.forEach((t=>{t.text&&(e+=t.text)})),u=e}else u="object"===typeof t&&t&&t.text?t.text:t;r.insertText(u,i,l)}else u=n,r.replaceWith(i,l,u);o.updateSelection&&function(e,t,o){const n=e.steps.length-1;if(n<t)return;const r=e.steps[n];if(!(r instanceof dr||r instanceof ur))return;const i=e.mapping.maps[n];let a=0;i.forEach(((e,t,o,n)=>{0===a&&(a=n)})),e.setSelection(zr.near(e.doc.resolve(a),o))}(r,r.steps.length-1,-1),o.applyInputRules&&r.setMeta("applyInputRules",{from:i,text:u}),o.applyPasteRules&&r.setMeta("applyPasteRules",{from:i,text:u})}return!0},joinBackward:()=>e=>{let{state:t,dispatch:o}=e;return Ll(t,o)},joinDown:()=>e=>{let{state:t,dispatch:o}=e;return((e,t)=>{let o,n=e.selection;if(n instanceof Wr){if(n.node.isTextblock||!wr(e.doc,n.to))return!1;o=n.to}else if(o=_r(e.doc,n.to,1),null==o)return!1;return t&&t(e.tr.join(o).scrollIntoView()),!0})(t,o)},joinForward:()=>e=>{let{state:t,dispatch:o}=e;return Vl(t,o)},joinItemBackward:()=>e=>{let{state:t,dispatch:o,tr:n}=e;try{const e=_r(t.doc,t.selection.$from.pos,-1);return null!==e&&void 0!==e&&(n.join(e,2),o&&o(n),!0)}catch{return!1}},joinItemForward:()=>e=>{let{state:t,dispatch:o,tr:n}=e;try{const e=_r(t.doc,t.selection.$from.pos,1);return null!==e&&void 0!==e&&(n.join(e,2),o&&o(n),!0)}catch{return!1}},joinTextblockBackward:()=>e=>{let{state:t,dispatch:o}=e;return((e,t,o)=>{let n=Ml(e,o);if(!n)return!1;let r=Hl(n);return!!r&&Fl(e,r,t)})(t,o)},joinTextblockForward:()=>e=>{let{state:t,dispatch:o}=e;return((e,t,o)=>{let n=Bl(e,o);if(!n)return!1;let r=Ul(n);return!!r&&Fl(e,r,t)})(t,o)},joinUp:()=>e=>{let{state:t,dispatch:o}=e;return((e,t)=>{let o,n=e.selection,r=n instanceof Wr;if(r){if(n.node.isTextblock||!wr(e.doc,n.from))return!1;o=n.from}else if(o=_r(e.doc,n.from,-1),null==o)return!1;if(t){let n=e.tr.join(o);r&&n.setSelection(Wr.create(n.doc,o-e.doc.resolve(o).nodeBefore.nodeSize)),t(n.scrollIntoView())}return!0})(t,o)},keyboardShortcut:e=>t=>{let{editor:o,view:n,tr:r,dispatch:i}=t;const a=function(e){const t=e.split(/-(?!$)/);let o,n,r,i,a=t[t.length-1];"Space"===a&&(a=" ");for(let s=0;s<t.length-1;s+=1){const e=t[s];if(/^(cmd|meta|m)$/i.test(e))i=!0;else if(/^a(lt)?$/i.test(e))o=!0;else if(/^(c|ctrl|control)$/i.test(e))n=!0;else if(/^s(hift)?$/i.test(e))r=!0;else{if(!/^mod$/i.test(e))throw new Error(`Unrecognized modifier name: ${e}`);Zc()||nd()?i=!0:n=!0}}return o&&(a=`Alt-${a}`),n&&(a=`Ctrl-${a}`),i&&(a=`Meta-${a}`),r&&(a=`Shift-${a}`),a}(e).split(/-(?!$)/),s=a.find((e=>!["Alt","Ctrl","Meta","Shift"].includes(e))),l=new KeyboardEvent("keydown",{key:"Space"===s?" ":s,altKey:a.includes("Alt"),ctrlKey:a.includes("Ctrl"),metaKey:a.includes("Meta"),shiftKey:a.includes("Shift"),bubbles:!0,cancelable:!0}),c=o.captureTransaction((()=>{n.someProp("handleKeyDown",(e=>e(n,l)))}));return null===c||void 0===c||c.steps.forEach((e=>{const t=e.map(r.mapping);t&&i&&r.maybeStep(t)})),!0},lift:function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return o=>{let{state:n,dispatch:r}=o;return!!rd(n,yc(e,n.schema),t)&&((e,t)=>{let{$from:o,$to:n}=e.selection,r=o.blockRange(n),i=r&&gr(r);return null!=i&&(t&&t(e.tr.lift(r,i).scrollIntoView()),!0)})(n,r)}},liftEmptyBlock:()=>e=>{let{state:t,dispatch:o}=e;return Jl(t,o)},liftListItem:e=>t=>{let{state:o,dispatch:n}=t;return dc(yc(e,o.schema))(o,n)},newlineInCode:()=>e=>{let{state:t,dispatch:o}=e;return Wl(t,o)},resetAttributes:(e,t)=>o=>{let{tr:n,state:r,dispatch:i}=o,a=null,s=null;const l=id("string"===typeof e?e:e.name,r.schema);return!!l&&("node"===l&&(a=yc(e,r.schema)),"mark"===l&&(s=Kc(e,r.schema)),i&&n.selection.ranges.forEach((e=>{r.doc.nodesBetween(e.$from.pos,e.$to.pos,((e,o)=>{a&&a===e.type&&n.setNodeMarkup(o,void 0,ad(e.attrs,t)),s&&e.marks.length&&e.marks.forEach((r=>{s===r.type&&n.addMark(o,o+e.nodeSize,s.create(ad(r.attrs,t)))}))}))})),!0)},scrollIntoView:()=>e=>{let{tr:t,dispatch:o}=e;return o&&t.scrollIntoView(),!0},selectAll:()=>e=>{let{tr:t,dispatch:o}=e;if(o){const e=new Kr(t.doc);t.setSelection(e)}return!0},selectNodeBackward:()=>e=>{let{state:t,dispatch:o}=e;return zl(t,o)},selectNodeForward:()=>e=>{let{state:t,dispatch:o}=e;return $l(t,o)},selectParentNode:()=>e=>{let{state:t,dispatch:o}=e;return((e,t)=>{let o,{$from:n,to:r}=e.selection,i=n.sharedDepth(r);return 0!=i&&(o=n.before(i),t&&t(e.tr.setSelection(Wr.create(e.doc,o))),!0)})(t,o)},selectTextblockEnd:()=>e=>{let{state:t,dispatch:o}=e;return oc(t,o)},selectTextblockStart:()=>e=>{let{state:t,dispatch:o}=e;return tc(t,o)},setContent:function(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};return r=>{let{editor:i,tr:a,dispatch:s,commands:l}=r;var c,d;const{doc:u}=a;if("full"!==o.preserveWhitespace){const r=sd(e,i.schema,o,{errorOnInvalidContent:null!==(c=n.errorOnInvalidContent)&&void 0!==c?c:i.options.enableContentCheck});return s&&a.replaceWith(0,u.content.size,r).setMeta("preventUpdate",!t),!0}return s&&a.setMeta("preventUpdate",!t),l.insertContentAt({from:0,to:u.content.size},e,{parseOptions:o,errorOnInvalidContent:null!==(d=n.errorOnInvalidContent)&&void 0!==d?d:i.options.enableContentCheck})}},setMark:function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return o=>{let{tr:n,state:r,dispatch:i}=o;const{selection:a}=n,{empty:s,ranges:l}=a,c=Kc(e,r.schema);if(i)if(s){const e=ld(r,c);n.addStoredMark(c.create({...e,...t}))}else l.forEach((e=>{const o=e.$from.pos,i=e.$to.pos;r.doc.nodesBetween(o,i,((e,r)=>{const a=Math.max(r,o),s=Math.min(r+e.nodeSize,i);e.marks.find((e=>e.type===c))?e.marks.forEach((e=>{c===e.type&&n.addMark(a,s,c.create({...e.attrs,...t}))})):n.addMark(a,s,c.create(t))}))}));return function(e,t,o){var n;const{selection:r}=t;let i=null;if(Yc(r)&&(i=r.$cursor),i){const t=null!==(n=e.storedMarks)&&void 0!==n?n:i.marks();return!!o.isInSet(t)||!t.some((e=>e.type.excludes(o)))}const{ranges:a}=r;return a.some((t=>{let{$from:n,$to:r}=t,i=0===n.depth&&e.doc.inlineContent&&e.doc.type.allowsMarkType(o);return e.doc.nodesBetween(n.pos,r.pos,((e,t,n)=>{if(i)return!1;if(e.isInline){const t=!n||n.type.allowsMarkType(o),r=!!o.isInSet(e.marks)||!e.marks.some((e=>e.type.excludes(o)));i=t&&r}return!i})),i}))}(r,n,c)}},setMeta:(e,t)=>o=>{let{tr:n}=o;return n.setMeta(e,t),!0},setNode:function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return o=>{let{state:n,dispatch:r,chain:i}=o;const a=yc(e,n.schema);let s;return n.selection.$anchor.sameParent(n.selection.$head)&&(s=n.selection.$anchor.parent.attrs),a.isTextblock?i().command((e=>{let{commands:o}=e;return!!nc(a,{...s,...t})(n)||o.clearNodes()})).command((e=>{let{state:o}=e;return nc(a,{...s,...t})(o,r)})).run():(console.warn('[tiptap warn]: Currently "setNode()" only supports text block nodes.'),!1)}},setNodeSelection:e=>t=>{let{tr:o,dispatch:n}=t;if(n){const{doc:t}=o,n=Jc(e,0,t.content.size),r=Wr.create(t,n);o.setSelection(r)}return!0},setTextSelection:e=>t=>{let{tr:o,dispatch:n}=t;if(n){const{doc:t}=o,{from:n,to:r}="number"===typeof e?{from:e,to:e}:e,i=$r.atStart(t).from,a=$r.atEnd(t).to,s=Jc(n,i,a),l=Jc(r,i,a),c=$r.create(t,s,l);o.setSelection(c)}return!0},sinkListItem:e=>t=>{let{state:o,dispatch:n}=t;const r=yc(e,o.schema);return(i=r,function(e,t){let{$from:o,$to:n}=e.selection,r=o.blockRange(n,(e=>e.childCount>0&&e.firstChild.type==i));if(!r)return!1;let a=r.startIndex;if(0==a)return!1;let s=r.parent,l=s.child(a-1);if(l.type!=i)return!1;if(t){let o=l.lastChild&&l.lastChild.type==s.type,n=Vo.from(o?i.create():null),a=new Yo(Vo.from(i.create(null,Vo.from(s.type.create(null,n)))),o?3:1,0),c=r.start,d=r.end;t(e.tr.step(new ur(c-(o?3:1),d,c,d,a,1,!0)).scrollIntoView())}return!0})(o,n);var i},splitBlock:function(){let{keepMarks:e=!0}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return t=>{let{tr:o,state:n,dispatch:r,editor:i}=t;const{selection:a,doc:s}=o,{$from:l,$to:c}=a,d=fd(i.extensionManager.attributes,l.node().type.name,l.node().attrs);if(a instanceof Wr&&a.node.isBlock)return!(!l.parentOffset||!xr(s,l.pos))&&(r&&(e&&vd(n,i.extensionManager.splittableMarks),o.split(l.pos).scrollIntoView()),!0);if(!l.parent.isBlock)return!1;const u=c.parentOffset===c.parent.content.size,p=0===l.depth?void 0:function(e){for(let t=0;t<e.edgeCount;t+=1){const{type:o}=e.edge(t);if(o.isTextblock&&!o.hasRequiredAttrs())return o}return null}(l.node(-1).contentMatchAt(l.indexAfter(-1)));let h=u&&p?[{type:p,attrs:d}]:void 0,f=xr(o.doc,o.mapping.map(l.pos),1,h);if(h||f||!xr(o.doc,o.mapping.map(l.pos),1,p?[{type:p}]:void 0)||(f=!0,h=p?[{type:p,attrs:d}]:void 0),r){if(f&&(a instanceof $r&&o.deleteSelection(),o.split(o.mapping.map(l.pos),1,h),p&&!u&&!l.parentOffset&&l.parent.type!==p)){const e=o.mapping.map(l.before()),t=o.doc.resolve(e);l.node(-1).canReplaceWith(t.index(),t.index()+1,p)&&o.setNodeMarkup(o.mapping.map(l.before()),p)}e&&vd(n,i.extensionManager.splittableMarks),o.scrollIntoView()}return f}},splitListItem:function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return o=>{let{tr:n,state:r,dispatch:i,editor:a}=o;var s;const l=yc(e,r.schema),{$from:c,$to:d}=r.selection,u=r.selection.node;if(u&&u.isBlock||c.depth<2||!c.sameParent(d))return!1;const p=c.node(-1);if(p.type!==l)return!1;const h=a.extensionManager.attributes;if(0===c.parent.content.size&&c.node(-1).childCount===c.indexAfter(-1)){if(2===c.depth||c.node(-3).type!==l||c.index(-2)!==c.node(-2).childCount-1)return!1;if(i){let e=Vo.empty;const o=c.index(-1)?1:c.index(-2)?2:3;for(let t=c.depth-o;t>=c.depth-3;t-=1)e=Vo.from(c.node(t).copy(e));const r=c.indexAfter(-1)<c.node(-2).childCount?1:c.indexAfter(-2)<c.node(-3).childCount?2:3,i={...fd(h,c.node().type.name,c.node().attrs),...t},a=(null===(s=l.contentMatch.defaultType)||void 0===s?void 0:s.createAndFill(i))||void 0;e=e.append(Vo.from(l.createAndFill(null,a)||void 0));const d=c.before(c.depth-(o-1));n.replace(d,c.after(-r),new Yo(e,4-o,0));let u=-1;n.doc.nodesBetween(d,n.doc.content.size,((e,t)=>{if(u>-1)return!1;e.isTextblock&&0===e.content.size&&(u=t+1)})),u>-1&&n.setSelection($r.near(n.doc.resolve(u))),n.scrollIntoView()}return!0}const f=d.pos===c.end()?p.contentMatchAt(0).defaultType:null,g={...fd(h,p.type.name,p.attrs),...t},m={...fd(h,c.node().type.name,c.node().attrs),...t};n.delete(c.pos,d.pos);const y=f?[{type:l,attrs:g},{type:f,attrs:m}]:[{type:l,attrs:g}];if(!xr(n.doc,c.pos,2))return!1;if(i){const{selection:e,storedMarks:t}=r,{splittableMarks:o}=a.extensionManager,s=t||e.$to.parentOffset&&e.$from.marks();if(n.split(c.pos,2,y).scrollIntoView(),!s||!i)return!0;const l=s.filter((e=>o.includes(e.type.name)));n.ensureMarks(l)}return!0}},toggleList:function(e,t,o){let n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};return r=>{let{editor:i,tr:a,state:s,dispatch:l,chain:c,commands:d,can:u}=r;const{extensions:p,splittableMarks:h}=i.extensionManager,f=yc(e,s.schema),g=yc(t,s.schema),{selection:m,storedMarks:y}=s,{$from:v,$to:b}=m,x=v.blockRange(b),w=y||m.$to.parentOffset&&m.$from.marks();if(!x)return!1;const C=cd((e=>md(e.type.name,p)))(m);if(x.depth>=1&&C&&x.depth-C.depth<=1){if(C.node.type===f)return d.liftListItem(g);if(md(C.node.type.name,p)&&f.validContent(C.node.content)&&l)return c().command((()=>(a.setNodeMarkup(C.pos,f),!0))).command((()=>bd(a,f))).command((()=>xd(a,f))).run()}return o&&w&&l?c().command((()=>{const e=u().wrapInList(f,n),t=w.filter((e=>h.includes(e.type.name)));return a.ensureMarks(t),!!e||d.clearNodes()})).wrapInList(f,n).command((()=>bd(a,f))).command((()=>xd(a,f))).run():c().command((()=>!!u().wrapInList(f,n)||d.clearNodes())).wrapInList(f,n).command((()=>bd(a,f))).command((()=>xd(a,f))).run()}},toggleMark:function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return n=>{let{state:r,commands:i}=n;const{extendEmptyMarkRange:a=!1}=o,s=Kc(e,r.schema);return gd(r,s,t)?i.unsetMark(s,{extendEmptyMarkRange:a}):i.setMark(s,t)}},toggleNode:function(e,t){let o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return n=>{let{state:r,commands:i}=n;const a=yc(e,r.schema),s=yc(t,r.schema),l=rd(r,a,o);let c;return r.selection.$anchor.sameParent(r.selection.$head)&&(c=r.selection.$anchor.parent.attrs),l?i.setNode(s,c):i.setNode(a,{...c,...o})}},toggleWrap:function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return o=>{let{state:n,commands:r}=o;const i=yc(e,n.schema);return rd(n,i,t)?r.lift(i):r.wrapIn(i,t)}},undoInputRule:()=>e=>{let{state:t,dispatch:o}=e;const n=t.plugins;for(let r=0;r<n.length;r+=1){const e=n[r];let i;if(e.spec.isInputRules&&(i=e.getState(t))){if(o){const e=t.tr,o=i.transform;for(let t=o.steps.length-1;t>=0;t-=1)e.step(o.steps[t].invert(o.docs[t]));if(i.text){const o=e.doc.resolve(i.from).marks();e.replaceWith(i.from,i.to,t.schema.text(i.text,o))}else e.delete(i.from,i.to)}return!0}}return!1},unsetAllMarks:()=>e=>{let{tr:t,dispatch:o}=e;const{selection:n}=t,{empty:r,ranges:i}=n;return r||o&&i.forEach((e=>{t.removeMark(e.$from.pos,e.$to.pos)})),!0},unsetMark:function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return o=>{let{tr:n,state:r,dispatch:i}=o;var a;const{extendEmptyMarkRange:s=!1}=t,{selection:l}=n,c=Kc(e,r.schema),{$from:d,empty:u,ranges:p}=l;if(!i)return!0;if(u&&s){let{from:e,to:t}=l;const o=null===(a=d.marks().find((e=>e.type===c)))||void 0===a?void 0:a.attrs,r=qc(d,c,o);r&&(e=r.from,t=r.to),n.removeMark(e,t,c)}else p.forEach((e=>{n.removeMark(e.$from.pos,e.$to.pos,c)}));return n.removeStoredMark(c),!0}},updateAttributes:function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return o=>{let{tr:n,state:r,dispatch:i}=o,a=null,s=null;const l=id("string"===typeof e?e:e.name,r.schema);return!!l&&("node"===l&&(a=yc(e,r.schema)),"mark"===l&&(s=Kc(e,r.schema)),i&&n.selection.ranges.forEach((e=>{const o=e.$from.pos,i=e.$to.pos;let l,c,d,u;n.selection.empty?r.doc.nodesBetween(o,i,((e,t)=>{a&&a===e.type&&(d=Math.max(t,o),u=Math.min(t+e.nodeSize,i),l=t,c=e)})):r.doc.nodesBetween(o,i,((e,r)=>{r<o&&a&&a===e.type&&(d=Math.max(r,o),u=Math.min(r+e.nodeSize,i),l=r,c=e),r>=o&&r<=i&&(a&&a===e.type&&n.setNodeMarkup(r,void 0,{...e.attrs,...t}),s&&e.marks.length&&e.marks.forEach((a=>{if(s===a.type){const l=Math.max(r,o),c=Math.min(r+e.nodeSize,i);n.addMark(l,c,s.create({...a.attrs,...t}))}})))})),c&&(void 0!==l&&n.setNodeMarkup(l,void 0,{...c.attrs,...t}),s&&c.marks.length&&c.marks.forEach((e=>{s===e.type&&n.addMark(d,u,s.create({...e.attrs,...t}))})))})),!0)}},wrapIn:function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return o=>{let{state:n,dispatch:r}=o;return function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;return function(o,n){let{$from:r,$to:i}=o.selection,a=r.blockRange(i),s=a&&mr(a,e,t);return!!s&&(n&&n(o.tr.wrap(a,s).scrollIntoView()),!0)}}(yc(e,n.schema),t)(n,r)}},wrapInList:function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return o=>{let{state:n,dispatch:r}=o;return cc(yc(e,n.schema),t)(n,r)}}});const Cd=zc.create({name:"commands",addCommands:()=>({...wd})}),_d=zc.create({name:"drop",addProseMirrorPlugins(){return[new ii({key:new li("tiptapDrop"),props:{handleDrop:(e,t,o,n)=>{this.editor.emit("drop",{editor:this.editor,event:t,slice:o,moved:n})}}})]}}),Sd=zc.create({name:"editable",addProseMirrorPlugins(){return[new ii({key:new li("editable"),props:{editable:()=>this.editor.options.editable}})]}}),Ed=zc.create({name:"focusEvents",addProseMirrorPlugins(){const{editor:e}=this;return[new ii({key:new li("focusEvents"),props:{handleDOMEvents:{focus:(t,o)=>{e.isFocused=!0;const n=e.state.tr.setMeta("focus",{event:o}).setMeta("addToHistory",!1);return t.dispatch(n),!1},blur:(t,o)=>{e.isFocused=!1;const n=e.state.tr.setMeta("blur",{event:o}).setMeta("addToHistory",!1);return t.dispatch(n),!1}}}})]}}),kd=zc.create({name:"keymap",addKeyboardShortcuts(){const e=()=>this.editor.commands.first((e=>{let{commands:t}=e;return[()=>t.undoInputRule(),()=>t.command((e=>{let{tr:o}=e;const{selection:n,doc:r}=o,{empty:i,$anchor:a}=n,{pos:s,parent:l}=a,c=a.parent.isTextblock&&s>0?o.doc.resolve(s-1):a,d=c.parent.type.spec.isolating,u=a.pos-a.parentOffset,p=d&&1===c.parent.childCount?u===a.pos:zr.atStart(r).from===s;return!(!i||!l.type.isTextblock||l.textContent.length||!p||p&&"paragraph"===a.parent.type.name)&&t.clearNodes()})),()=>t.deleteSelection(),()=>t.joinBackward(),()=>t.selectNodeBackward()]})),t=()=>this.editor.commands.first((e=>{let{commands:t}=e;return[()=>t.deleteSelection(),()=>t.deleteCurrentNode(),()=>t.joinForward(),()=>t.selectNodeForward()]})),o={Enter:()=>this.editor.commands.first((e=>{let{commands:t}=e;return[()=>t.newlineInCode(),()=>t.createParagraphNear(),()=>t.liftEmptyBlock(),()=>t.splitBlock()]})),"Mod-Enter":()=>this.editor.commands.exitCode(),Backspace:e,"Mod-Backspace":e,"Shift-Backspace":e,Delete:t,"Mod-Delete":t,"Mod-a":()=>this.editor.commands.selectAll()},n={...o},r={...o,"Ctrl-h":e,"Alt-Backspace":e,"Ctrl-d":t,"Ctrl-Alt-Backspace":t,"Alt-Delete":t,"Alt-d":t,"Ctrl-a":()=>this.editor.commands.selectTextblockStart(),"Ctrl-e":()=>this.editor.commands.selectTextblockEnd()};return Zc()||nd()?r:n},addProseMirrorPlugins(){return[new ii({key:new li("clearDocument"),appendTransaction:(e,t,o)=>{if(e.some((e=>e.getMeta("composition"))))return;const n=e.some((e=>e.docChanged))&&!t.doc.eq(o.doc),r=e.some((e=>e.getMeta("preventClearDocument")));if(!n||r)return;const{empty:i,from:a,to:s}=t.selection,l=zr.atStart(t.doc).from,c=zr.atEnd(t.doc).to;if(i||!(a===l&&s===c))return;if(!yd(o.doc))return;const d=o.tr,u=uc({state:o,transaction:d}),{commands:p}=new pc({editor:this.editor,state:u});return p.clearNodes(),d.steps.length?d:void 0}})]}}),jd=zc.create({name:"paste",addProseMirrorPlugins(){return[new ii({key:new li("tiptapPaste"),props:{handlePaste:(e,t,o)=>{this.editor.emit("paste",{editor:this.editor,event:t,slice:o})}}})]}}),Ad=zc.create({name:"tabindex",addProseMirrorPlugins(){return[new ii({key:new li("tabindex"),props:{attributes:()=>this.editor.isEditable?{tabindex:"0"}:{}}})]}});class Rd{get name(){return this.node.type.name}constructor(e,t){let o=arguments.length>2&&void 0!==arguments[2]&&arguments[2],n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null;this.currentNode=null,this.actualDepth=null,this.isBlock=o,this.resolvedPos=e,this.editor=t,this.currentNode=n}get node(){return this.currentNode||this.resolvedPos.node()}get element(){return this.editor.view.domAtPos(this.pos).node}get depth(){var e;return null!==(e=this.actualDepth)&&void 0!==e?e:this.resolvedPos.depth}get pos(){return this.resolvedPos.pos}get content(){return this.node.content}set content(e){let t=this.from,o=this.to;if(this.isBlock){if(0===this.content.size)return void console.error(`You can\u2019t set content on a block node. Tried to set content on ${this.name} at ${this.pos}`);t=this.from+1,o=this.to-1}this.editor.commands.insertContentAt({from:t,to:o},e)}get attributes(){return this.node.attrs}get textContent(){return this.node.textContent}get size(){return this.node.nodeSize}get from(){return this.isBlock?this.pos:this.resolvedPos.start(this.resolvedPos.depth)}get range(){return{from:this.from,to:this.to}}get to(){return this.isBlock?this.pos+this.size:this.resolvedPos.end(this.resolvedPos.depth)+(this.node.isText?0:1)}get parent(){if(0===this.depth)return null;const e=this.resolvedPos.start(this.resolvedPos.depth-1),t=this.resolvedPos.doc.resolve(e);return new Rd(t,this.editor)}get before(){let e=this.resolvedPos.doc.resolve(this.from-(this.isBlock?1:2));return e.depth!==this.depth&&(e=this.resolvedPos.doc.resolve(this.from-3)),new Rd(e,this.editor)}get after(){let e=this.resolvedPos.doc.resolve(this.to+(this.isBlock?2:1));return e.depth!==this.depth&&(e=this.resolvedPos.doc.resolve(this.to+3)),new Rd(e,this.editor)}get children(){const e=[];return this.node.content.forEach(((t,o)=>{const n=t.isBlock&&!t.isTextblock,r=t.isAtom&&!t.isText,i=this.pos+o+(r?0:1),a=this.resolvedPos.doc.resolve(i);if(!n&&a.depth<=this.depth)return;const s=new Rd(a,this.editor,n,n?t:null);n&&(s.actualDepth=this.depth+1),e.push(new Rd(a,this.editor,n,n?t:null))})),e}get firstChild(){return this.children[0]||null}get lastChild(){const e=this.children;return e[e.length-1]||null}closest(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},o=null,n=this.parent;for(;n&&!o;){if(n.node.type.name===e)if(Object.keys(t).length>0){const e=n.node.attrs,o=Object.keys(t);for(let n=0;n<o.length;n+=1){const r=o[n];if(e[r]!==t[r])break}}else o=n;n=n.parent}return o}querySelector(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return this.querySelectorAll(e,t,!0)[0]||null}querySelectorAll(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},o=arguments.length>2&&void 0!==arguments[2]&&arguments[2],n=[];if(!this.children||0===this.children.length)return n;const r=Object.keys(t);return this.children.forEach((i=>{if(!(o&&n.length>0)){if(i.node.type.name===e){r.every((e=>t[e]===i.node.attrs[e]))&&n.push(i)}o&&n.length>0||(n=n.concat(i.querySelectorAll(e,t,o)))}})),n}setAttribute(e){const{tr:t}=this.editor.state;t.setNodeMarkup(this.from,void 0,{...this.node.attrs,...e}),this.editor.view.dispatch(t)}}class Od extends hc{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};super(),this.isFocused=!1,this.isInitialized=!1,this.extensionStorage={},this.options={element:document.createElement("div"),content:"",injectCSS:!0,injectNonce:void 0,extensions:[],autofocus:!1,editable:!0,editorProps:{},parseOptions:{},coreExtensionOptions:{},enableInputRules:!0,enablePasteRules:!0,enableCoreExtensions:!0,enableContentCheck:!1,onBeforeCreate:()=>null,onCreate:()=>null,onUpdate:()=>null,onSelectionUpdate:()=>null,onTransaction:()=>null,onFocus:()=>null,onBlur:()=>null,onDestroy:()=>null,onContentError:e=>{let{error:t}=e;throw t},onPaste:()=>null,onDrop:()=>null},this.isCapturingTransaction=!1,this.capturedTransaction=null,this.setOptions(e),this.createExtensionManager(),this.createCommandManager(),this.createSchema(),this.on("beforeCreate",this.options.onBeforeCreate),this.emit("beforeCreate",{editor:this}),this.on("contentError",this.options.onContentError),this.createView(),this.injectCSS(),this.on("create",this.options.onCreate),this.on("update",this.options.onUpdate),this.on("selectionUpdate",this.options.onSelectionUpdate),this.on("transaction",this.options.onTransaction),this.on("focus",this.options.onFocus),this.on("blur",this.options.onBlur),this.on("destroy",this.options.onDestroy),this.on("drop",(e=>{let{event:t,slice:o,moved:n}=e;return this.options.onDrop(t,o,n)})),this.on("paste",(e=>{let{event:t,slice:o}=e;return this.options.onPaste(t,o)})),window.setTimeout((()=>{this.isDestroyed||(this.commands.focus(this.options.autofocus),this.emit("create",{editor:this}),this.isInitialized=!0)}),0)}get storage(){return this.extensionStorage}get commands(){return this.commandManager.commands}chain(){return this.commandManager.chain()}can(){return this.commandManager.can()}injectCSS(){this.options.injectCSS&&document&&(this.css=function(e,t,o){const n=document.querySelector(`style[data-tiptap-style${o?`-${o}`:""}]`);if(null!==n)return n;const r=document.createElement("style");return t&&r.setAttribute("nonce",t),r.setAttribute("data-tiptap-style"+(o?`-${o}`:""),""),r.innerHTML=e,document.getElementsByTagName("head")[0].appendChild(r),r}('.ProseMirror {\n  position: relative;\n}\n\n.ProseMirror {\n  word-wrap: break-word;\n  white-space: pre-wrap;\n  white-space: break-spaces;\n  -webkit-font-variant-ligatures: none;\n  font-variant-ligatures: none;\n  font-feature-settings: "liga" 0; /* the above doesn\'t seem to work in Edge */\n}\n\n.ProseMirror [contenteditable="false"] {\n  white-space: normal;\n}\n\n.ProseMirror [contenteditable="false"] [contenteditable="true"] {\n  white-space: pre-wrap;\n}\n\n.ProseMirror pre {\n  white-space: pre-wrap;\n}\n\nimg.ProseMirror-separator {\n  display: inline !important;\n  border: none !important;\n  margin: 0 !important;\n  width: 0 !important;\n  height: 0 !important;\n}\n\n.ProseMirror-gapcursor {\n  display: none;\n  pointer-events: none;\n  position: absolute;\n  margin: 0;\n}\n\n.ProseMirror-gapcursor:after {\n  content: "";\n  display: block;\n  position: absolute;\n  top: -2px;\n  width: 20px;\n  border-top: 1px solid black;\n  animation: ProseMirror-cursor-blink 1.1s steps(2, start) infinite;\n}\n\n@keyframes ProseMirror-cursor-blink {\n  to {\n    visibility: hidden;\n  }\n}\n\n.ProseMirror-hideselection *::selection {\n  background: transparent;\n}\n\n.ProseMirror-hideselection *::-moz-selection {\n  background: transparent;\n}\n\n.ProseMirror-hideselection * {\n  caret-color: transparent;\n}\n\n.ProseMirror-focused .ProseMirror-gapcursor {\n  display: block;\n}\n\n.tippy-box[data-animation=fade][data-state=hidden] {\n  opacity: 0\n}',this.options.injectNonce))}setOptions(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this.options={...this.options,...e},this.view&&this.state&&!this.isDestroyed&&(this.options.editorProps&&this.view.setProps(this.options.editorProps),this.view.updateState(this.state))}setEditable(e){let t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];this.setOptions({editable:e}),t&&this.emit("update",{editor:this,transaction:this.state.tr})}get isEditable(){return this.options.editable&&this.view&&this.view.editable}get state(){return this.view.state}registerPlugin(e,t){const o=xc(t)?t(e,[...this.state.plugins]):[...this.state.plugins,e],n=this.state.reconfigure({plugins:o});return this.view.updateState(n),n}unregisterPlugin(e){if(this.isDestroyed)return;const t=this.state.plugins;let o=t;if([].concat(e).forEach((e=>{const n="string"===typeof e?`${e}$`:e.key;o=t.filter((e=>!e.key.startsWith(n)))})),t.length===o.length)return;const n=this.state.reconfigure({plugins:o});return this.view.updateState(n),n}createExtensionManager(){var e,t;const o=[...this.options.enableCoreExtensions?[Sd,Vc.configure({blockSeparator:null===(t=null===(e=this.options.coreExtensionOptions)||void 0===e?void 0:e.clipboardTextSerializer)||void 0===t?void 0:t.blockSeparator}),Cd,Ed,kd,Ad,_d,jd].filter((e=>"object"!==typeof this.options.enableCoreExtensions||!1!==this.options.enableCoreExtensions[e.name])):[],...this.options.extensions].filter((e=>["extension","node","mark"].includes(null===e||void 0===e?void 0:e.type)));this.extensionManager=new Gc(o,this)}createCommandManager(){this.commandManager=new pc({editor:this})}createSchema(){this.schema=this.extensionManager.schema}createView(){var e;let t;try{t=sd(this.options.content,this.schema,this.options.parseOptions,{errorOnInvalidContent:this.options.enableContentCheck})}catch(SM){if(!(SM instanceof Error)||!["[tiptap error]: Invalid JSON content","[tiptap error]: Invalid HTML content"].includes(SM.message))throw SM;this.emit("contentError",{editor:this,error:SM,disableCollaboration:()=>{this.storage.collaboration&&(this.storage.collaboration.isDisabled=!0),this.options.extensions=this.options.extensions.filter((e=>"collaboration"!==e.name)),this.createExtensionManager()}}),t=sd(this.options.content,this.schema,this.options.parseOptions,{errorOnInvalidContent:!1})}const o=Xc(t,this.options.autofocus);this.view=new bl(this.options.element,{...this.options.editorProps,attributes:{role:"textbox",...null===(e=this.options.editorProps)||void 0===e?void 0:e.attributes},dispatchTransaction:this.dispatchTransaction.bind(this),state:ni.create({doc:t,selection:o||void 0})});const n=this.state.reconfigure({plugins:this.extensionManager.plugins});this.view.updateState(n),this.createNodeViews(),this.prependClass();this.view.dom.editor=this}createNodeViews(){this.view.isDestroyed||this.view.setProps({nodeViews:this.extensionManager.nodeViews})}prependClass(){this.view.dom.className=`tiptap ${this.view.dom.className}`}captureTransaction(e){this.isCapturingTransaction=!0,e(),this.isCapturingTransaction=!1;const t=this.capturedTransaction;return this.capturedTransaction=null,t}dispatchTransaction(e){if(this.view.isDestroyed)return;if(this.isCapturingTransaction)return this.capturedTransaction?void e.steps.forEach((e=>{var t;return null===(t=this.capturedTransaction)||void 0===t?void 0:t.step(e)})):void(this.capturedTransaction=e);const t=this.state.apply(e),o=!this.state.selection.eq(t.selection);this.emit("beforeTransaction",{editor:this,transaction:e,nextState:t}),this.view.updateState(t),this.emit("transaction",{editor:this,transaction:e}),o&&this.emit("selectionUpdate",{editor:this,transaction:e});const n=e.getMeta("focus"),r=e.getMeta("blur");n&&this.emit("focus",{editor:this,event:n.event,transaction:e}),r&&this.emit("blur",{editor:this,event:r.event,transaction:e}),e.docChanged&&!e.getMeta("preventUpdate")&&this.emit("update",{editor:this,transaction:e})}getAttributes(e){return ud(this.state,e)}isActive(e,t){const o="string"===typeof e?e:null,n="string"===typeof e?t:e;return function(e,t){let o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};if(!t)return rd(e,null,o)||gd(e,null,o);const n=id(t,e.schema);return"node"===n?rd(e,t,o):"mark"===n&&gd(e,t,o)}(this.state,o,n)}getJSON(){return this.state.doc.toJSON()}getHTML(){return jc(this.state.doc.content,this.schema)}getText(e){const{blockSeparator:t="\n\n",textSerializers:o={}}=e||{};return dd(this.state.doc,{blockSeparator:t,textSerializers:{...Bc(this.schema),...o}})}get isEmpty(){return yd(this.state.doc)}getCharacterCount(){return console.warn('[tiptap warn]: "editor.getCharacterCount()" is deprecated. Please use "editor.storage.characterCount.characters()" instead.'),this.state.doc.content.size-2}destroy(){if(this.emit("destroy"),this.view){const e=this.view.dom;e&&e.editor&&delete e.editor,this.view.destroy()}this.removeAllListeners()}get isDestroyed(){var e;return!(null===(e=this.view)||void 0===e?void 0:e.docView)}$node(e,t){var o;return(null===(o=this.$doc)||void 0===o?void 0:o.querySelector(e,t))||null}$nodes(e,t){var o;return(null===(o=this.$doc)||void 0===o?void 0:o.querySelectorAll(e,t))||null}$pos(e){const t=this.state.doc.resolve(e);return new Rd(t,this)}get $doc(){return this.$pos(0)}}function Td(e){return new Rc({find:e.find,handler:t=>{let{state:o,range:n,match:r}=t;const i=wc(e.getAttributes,void 0,r);if(!1===i||null===i)return null;const{tr:a}=o,s=r[r.length-1],l=r[0];if(s){const t=l.search(/\S/),r=n.from+l.indexOf(s),c=r+s.length;if(hd(n.from,n.to,o.doc).filter((t=>t.mark.type.excluded.find((o=>o===e.type&&o!==t.mark.type)))).filter((e=>e.to>r)).length)return null;c<n.to&&a.delete(c,n.to),r>n.from&&a.delete(n.from+t,r);const d=n.from+t+s.length;a.addMark(n.from+t,d,e.type.create(i||{})),a.removeStoredMark(e.type)}}})}function Dd(e){return new Rc({find:e.find,handler:t=>{let{state:o,range:n,match:r}=t;const i=o.doc.resolve(n.from),a=wc(e.getAttributes,void 0,r)||{};if(!i.node(-1).canReplaceWith(i.index(-1),i.indexAfter(-1),e.type))return null;o.tr.delete(n.from,n.to).setBlockType(n.from,n.from,e.type,a)}})}function Pd(e){return new Rc({find:e.find,handler:t=>{let{state:o,range:n,match:r,chain:i}=t;const a=wc(e.getAttributes,void 0,r)||{},s=o.tr.delete(n.from,n.to),l=s.doc.resolve(n.from).blockRange(),c=l&&mr(l,e.type,a);if(!c)return null;if(s.wrap(l,c),e.keepMarks&&e.editor){const{selection:t,storedMarks:n}=o,{splittableMarks:r}=e.editor.extensionManager,i=n||t.$to.parentOffset&&t.$from.marks();if(i){const e=i.filter((e=>r.includes(e.type.name)));s.ensureMarks(e)}}if(e.keepAttributes){const t="bulletList"===e.type.name||"orderedList"===e.type.name?"listItem":"taskList";i().updateAttributes(t,a).run()}const d=s.doc.resolve(n.from-1).nodeBefore;d&&d.type===e.type&&wr(s.doc,n.from-1)&&(!e.joinPredicate||e.joinPredicate(r,d))&&s.join(n.from-1)}})}class Nd{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this.type="node",this.name="node",this.parent=null,this.child=null,this.config={name:this.name,defaultOptions:{}},this.config={...this.config,...e},this.name=this.config.name,e.defaultOptions&&Object.keys(e.defaultOptions).length>0&&console.warn(`[tiptap warn]: BREAKING CHANGE: "defaultOptions" is deprecated. Please use "addOptions" instead. Found in extension: "${this.name}".`),this.options=this.config.defaultOptions,this.config.addOptions&&(this.options=wc(fc(this,"addOptions",{name:this.name}))),this.storage=wc(fc(this,"addStorage",{name:this.name,options:this.options}))||{}}static create(){return new Nd(arguments.length>0&&void 0!==arguments[0]?arguments[0]:{})}configure(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const t=this.extend({...this.config,addOptions:()=>Pc(this.options,e)});return t.name=this.name,t.parent=this.parent,t}extend(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const t=new Nd(e);return t.parent=this,this.child=t,t.name=e.name?e.name:t.parent.name,e.defaultOptions&&Object.keys(e.defaultOptions).length>0&&console.warn(`[tiptap warn]: BREAKING CHANGE: "defaultOptions" is deprecated. Please use "addOptions" instead. Found in extension: "${t.name}".`),t.options=wc(fc(t,"addOptions",{name:t.name})),t.storage=wc(fc(t,"addStorage",{name:t.name,options:t.options})),t}}function Id(e){return new Ic({find:e.find,handler:t=>{let{state:o,range:n,match:r,pasteEvent:i}=t;const a=wc(e.getAttributes,void 0,r,i);if(!1===a||null===a)return null;const{tr:s}=o,l=r[r.length-1],c=r[0];let d=n.to;if(l){const t=c.search(/\S/),r=n.from+c.indexOf(l),i=r+l.length;if(hd(n.from,n.to,o.doc).filter((t=>t.mark.type.excluded.find((o=>o===e.type&&o!==t.mark.type)))).filter((e=>e.to>r)).length)return null;i<n.to&&s.delete(i,n.to),r>n.from&&s.delete(n.from+t,r),d=n.from+t+l.length,s.addMark(n.from+t,d,e.type.create(a||{})),s.removeStoredMark(e.type)}}})}function Md(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}var Ld,Fd={exports:{}},Gd={};Fd.exports=function(){if(Ld)return Gd;Ld=1;var e=t,o="function"===typeof Object.is?Object.is:function(e,t){return e===t&&(0!==e||1/e===1/t)||e!==e&&t!==t},n=e.useState,r=e.useEffect,i=e.useLayoutEffect,a=e.useDebugValue;function s(e){var t=e.getSnapshot;e=e.value;try{var n=t();return!o(e,n)}catch(r){return!0}}var l="undefined"===typeof window||"undefined"===typeof window.document||"undefined"===typeof window.document.createElement?function(e,t){return t()}:function(e,t){var o=t(),l=n({inst:{value:o,getSnapshot:t}}),c=l[0].inst,d=l[1];return i((function(){c.value=o,c.getSnapshot=t,s(c)&&d({inst:c})}),[e,o,t]),r((function(){return s(c)&&d({inst:c}),e((function(){s(c)&&d({inst:c})}))}),[e]),a(o),o};return Gd.useSyncExternalStore=void 0!==e.useSyncExternalStore?e.useSyncExternalStore:l,Gd}();var zd=Fd.exports;const Hd=function(){for(var e=arguments.length,t=new Array(e),o=0;o<e;o++)t[o]=arguments[o];return e=>{t.forEach((t=>{"function"===typeof t?t(e):t&&(t.current=e)}))}},Bd=e=>{let{contentComponent:o}=e;const n=zd.useSyncExternalStore(o.subscribe,o.getSnapshot,o.getServerSnapshot);return t.createElement(t.Fragment,null,Object.values(n))};class Vd extends t.Component{constructor(e){var o;super(e),this.editorContentRef=t.createRef(),this.initialized=!1,this.state={hasContentComponentInitialized:Boolean(null===(o=e.editor)||void 0===o?void 0:o.contentComponent)}}componentDidMount(){this.init()}componentDidUpdate(){this.init()}init(){const e=this.props.editor;if(e&&!e.isDestroyed&&e.options.element){if(e.contentComponent)return;const t=this.editorContentRef.current;t.append(...e.options.element.childNodes),e.setOptions({element:t}),e.contentComponent=function(){const e=new Set;let t={};return{subscribe:t=>(e.add(t),()=>{e.delete(t)}),getSnapshot:()=>t,getServerSnapshot:()=>t,setRenderer(o,n){t={...t,[o]:a.createPortal(n.reactElement,n.element,o)},e.forEach((e=>e()))},removeRenderer(o){const n={...t};delete n[o],t=n,e.forEach((e=>e()))}}}(),this.state.hasContentComponentInitialized||(this.unsubscribeToContentComponent=e.contentComponent.subscribe((()=>{this.setState((e=>e.hasContentComponentInitialized?e:{hasContentComponentInitialized:!0})),this.unsubscribeToContentComponent&&this.unsubscribeToContentComponent()}))),e.createNodeViews(),this.initialized=!0}}componentWillUnmount(){const e=this.props.editor;if(!e)return;if(this.initialized=!1,e.isDestroyed||e.view.setProps({nodeViews:{}}),this.unsubscribeToContentComponent&&this.unsubscribeToContentComponent(),e.contentComponent=null,!e.options.element.firstChild)return;const t=document.createElement("div");t.append(...e.options.element.childNodes),e.setOptions({element:t})}render(){const{editor:e,innerRef:o,...n}=this.props;return t.createElement(t.Fragment,null,t.createElement("div",{ref:Hd(o,this.editorContentRef),...n}),(null===e||void 0===e?void 0:e.contentComponent)&&t.createElement(Bd,{contentComponent:e.contentComponent}))}}const $d=(0,t.forwardRef)(((e,o)=>{const n=t.useMemo((()=>Math.floor(4294967295*Math.random()).toString()),[e.editor]);return t.createElement(Vd,{key:n,innerRef:o,...e})})),Ud=t.memo($d);var Wd,qd=Md((function e(t,o){if(t===o)return!0;if(t&&o&&"object"==typeof t&&"object"==typeof o){if(t.constructor!==o.constructor)return!1;var n,r,i;if(Array.isArray(t)){if((n=t.length)!=o.length)return!1;for(r=n;0!==r--;)if(!e(t[r],o[r]))return!1;return!0}if(t instanceof Map&&o instanceof Map){if(t.size!==o.size)return!1;for(r of t.entries())if(!o.has(r[0]))return!1;for(r of t.entries())if(!e(r[1],o.get(r[0])))return!1;return!0}if(t instanceof Set&&o instanceof Set){if(t.size!==o.size)return!1;for(r of t.entries())if(!o.has(r[0]))return!1;return!0}if(ArrayBuffer.isView(t)&&ArrayBuffer.isView(o)){if((n=t.length)!=o.length)return!1;for(r=n;0!==r--;)if(t[r]!==o[r])return!1;return!0}if(t.constructor===RegExp)return t.source===o.source&&t.flags===o.flags;if(t.valueOf!==Object.prototype.valueOf)return t.valueOf()===o.valueOf();if(t.toString!==Object.prototype.toString)return t.toString()===o.toString();if((n=(i=Object.keys(t)).length)!==Object.keys(o).length)return!1;for(r=n;0!==r--;)if(!Object.prototype.hasOwnProperty.call(o,i[r]))return!1;for(r=n;0!==r--;){var a=i[r];if(("_owner"!==a||!t.$$typeof)&&!e(t[a],o[a]))return!1}return!0}return t!==t&&o!==o})),Kd={exports:{}},Yd={};Kd.exports=function(){if(Wd)return Yd;Wd=1;var e=t,o=zd,n="function"===typeof Object.is?Object.is:function(e,t){return e===t&&(0!==e||1/e===1/t)||e!==e&&t!==t},r=o.useSyncExternalStore,i=e.useRef,a=e.useEffect,s=e.useMemo,l=e.useDebugValue;return Yd.useSyncExternalStoreWithSelector=function(e,t,o,c,d){var u=i(null);if(null===u.current){var p={hasValue:!1,value:null};u.current=p}else p=u.current;u=s((function(){function e(e){if(!a){if(a=!0,r=e,e=c(e),void 0!==d&&p.hasValue){var t=p.value;if(d(t,e))return i=t}return i=e}if(t=i,n(r,e))return t;var o=c(e);return void 0!==d&&d(t,o)?t:(r=e,i=o)}var r,i,a=!1,s=void 0===o?null:o;return[function(){return e(t())},null===s?void 0:function(){return e(s())}]}),[t,o,c,d]);var h=r(e,u[0],u[1]);return a((function(){p.hasValue=!0,p.value=h}),[h]),l(h),h},Yd}();var Jd=Kd.exports;const Xd="undefined"!==typeof window?t.useLayoutEffect:t.useEffect;class Qd{constructor(e){this.transactionNumber=0,this.lastTransactionNumber=0,this.subscribers=new Set,this.editor=e,this.lastSnapshot={editor:e,transactionNumber:0},this.getSnapshot=this.getSnapshot.bind(this),this.getServerSnapshot=this.getServerSnapshot.bind(this),this.watch=this.watch.bind(this),this.subscribe=this.subscribe.bind(this)}getSnapshot(){return this.transactionNumber===this.lastTransactionNumber||(this.lastTransactionNumber=this.transactionNumber,this.lastSnapshot={editor:this.editor,transactionNumber:this.transactionNumber}),this.lastSnapshot}getServerSnapshot(){return{editor:null,transactionNumber:0}}subscribe(e){return this.subscribers.add(e),()=>{this.subscribers.delete(e)}}watch(e){if(this.editor=e,this.editor){const e=()=>{this.transactionNumber+=1,this.subscribers.forEach((e=>e()))},t=this.editor;return t.on("transaction",e),()=>{t.off("transaction",e)}}}}const Zd="undefined"===typeof window,eu=Zd||Boolean("undefined"!==typeof window&&window.next);class tu{constructor(e){this.editor=null,this.subscriptions=new Set,this.isComponentMounted=!1,this.previousDeps=null,this.instanceId="",this.options=e,this.subscriptions=new Set,this.setEditor(this.getInitialEditor()),this.scheduleDestroy(),this.getEditor=this.getEditor.bind(this),this.getServerSnapshot=this.getServerSnapshot.bind(this),this.subscribe=this.subscribe.bind(this),this.refreshEditorInstance=this.refreshEditorInstance.bind(this),this.scheduleDestroy=this.scheduleDestroy.bind(this),this.onRender=this.onRender.bind(this),this.createEditor=this.createEditor.bind(this)}setEditor(e){this.editor=e,this.instanceId=Math.random().toString(36).slice(2,9),this.subscriptions.forEach((e=>e()))}getInitialEditor(){return void 0===this.options.current.immediatelyRender?Zd||eu?null:this.createEditor():(this.options.current.immediatelyRender,this.options.current.immediatelyRender?this.createEditor():null)}createEditor(){var e=this;const t={...this.options.current,onBeforeCreate:function(){for(var t,o,n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return null===(o=(t=e.options.current).onBeforeCreate)||void 0===o?void 0:o.call(t,...r)},onBlur:function(){for(var t,o,n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return null===(o=(t=e.options.current).onBlur)||void 0===o?void 0:o.call(t,...r)},onCreate:function(){for(var t,o,n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return null===(o=(t=e.options.current).onCreate)||void 0===o?void 0:o.call(t,...r)},onDestroy:function(){for(var t,o,n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return null===(o=(t=e.options.current).onDestroy)||void 0===o?void 0:o.call(t,...r)},onFocus:function(){for(var t,o,n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return null===(o=(t=e.options.current).onFocus)||void 0===o?void 0:o.call(t,...r)},onSelectionUpdate:function(){for(var t,o,n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return null===(o=(t=e.options.current).onSelectionUpdate)||void 0===o?void 0:o.call(t,...r)},onTransaction:function(){for(var t,o,n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return null===(o=(t=e.options.current).onTransaction)||void 0===o?void 0:o.call(t,...r)},onUpdate:function(){for(var t,o,n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return null===(o=(t=e.options.current).onUpdate)||void 0===o?void 0:o.call(t,...r)},onContentError:function(){for(var t,o,n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return null===(o=(t=e.options.current).onContentError)||void 0===o?void 0:o.call(t,...r)},onDrop:function(){for(var t,o,n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return null===(o=(t=e.options.current).onDrop)||void 0===o?void 0:o.call(t,...r)},onPaste:function(){for(var t,o,n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return null===(o=(t=e.options.current).onPaste)||void 0===o?void 0:o.call(t,...r)}};return new Od(t)}getEditor(){return this.editor}getServerSnapshot(){return null}subscribe(e){return this.subscriptions.add(e),()=>{this.subscriptions.delete(e)}}static compareOptions(e,t){return Object.keys(e).every((o=>!!["onCreate","onBeforeCreate","onDestroy","onUpdate","onTransaction","onFocus","onBlur","onSelectionUpdate","onContentError","onDrop","onPaste"].includes(o)||("extensions"===o&&e.extensions&&t.extensions?e.extensions.length===t.extensions.length&&e.extensions.every(((e,o)=>{var n;return e===(null===(n=t.extensions)||void 0===n?void 0:n[o])})):e[o]===t[o])))}onRender(e){return()=>(this.isComponentMounted=!0,clearTimeout(this.scheduledDestructionTimeout),this.editor&&!this.editor.isDestroyed&&0===e.length?tu.compareOptions(this.options.current,this.editor.options)||this.editor.setOptions({...this.options.current,editable:this.editor.isEditable}):this.refreshEditorInstance(e),()=>{this.isComponentMounted=!1,this.scheduleDestroy()})}refreshEditorInstance(e){if(this.editor&&!this.editor.isDestroyed){if(null===this.previousDeps)return void(this.previousDeps=e);if(this.previousDeps.length===e.length&&this.previousDeps.every(((t,o)=>t===e[o])))return}this.editor&&!this.editor.isDestroyed&&this.editor.destroy(),this.setEditor(this.createEditor()),this.previousDeps=e}scheduleDestroy(){const e=this.instanceId,t=this.editor;this.scheduledDestructionTimeout=setTimeout((()=>{this.isComponentMounted&&this.instanceId===e?t&&t.setOptions(this.options.current):t&&!t.isDestroyed&&(t.destroy(),this.instanceId===e&&this.setEditor(null))}),1)}}function ou(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},o=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];const n=(0,t.useRef)(e);n.current=e;const[r]=(0,t.useState)((()=>new tu(n))),i=zd.useSyncExternalStore(r.subscribe,r.getEditor,r.getServerSnapshot);return(0,t.useDebugValue)(i),(0,t.useEffect)(r.onRender(o)),function(e){var o;const[n]=(0,t.useState)((()=>new Qd(e.editor))),r=Jd.useSyncExternalStoreWithSelector(n.subscribe,n.getSnapshot,n.getServerSnapshot,e.selector,null!==(o=e.equalityFn)&&void 0!==o?o:qd);Xd((()=>n.watch(e.editor)),[e.editor,n]),(0,t.useDebugValue)(r)}({editor:i,selector:t=>{let{transactionNumber:o}=t;return!1===e.shouldRerenderOnTransaction?null:e.immediatelyRender&&0===o?0:o+1}}),i}const nu=(0,t.createContext)({editor:null});nu.Consumer;const ru=(0,t.createContext)({onDragStart:void 0}),iu=()=>(0,t.useContext)(ru);t.forwardRef(((e,o)=>{const{onDragStart:n}=iu(),r=e.as||"div";return t.createElement(r,{...e,ref:o,"data-node-view-wrapper":"",onDragStart:n,style:{whiteSpace:"normal",...e.style}})}));const au=/^\s*>\s$/,su=Nd.create({name:"blockquote",addOptions:()=>({HTMLAttributes:{}}),content:"block+",group:"block",defining:!0,parseHTML:()=>[{tag:"blockquote"}],renderHTML(e){let{HTMLAttributes:t}=e;return["blockquote",vc(this.options.HTMLAttributes,t),0]},addCommands(){return{setBlockquote:()=>e=>{let{commands:t}=e;return t.wrapIn(this.name)},toggleBlockquote:()=>e=>{let{commands:t}=e;return t.toggleWrap(this.name)},unsetBlockquote:()=>e=>{let{commands:t}=e;return t.lift(this.name)}}},addKeyboardShortcuts(){return{"Mod-Shift-b":()=>this.editor.commands.toggleBlockquote()}},addInputRules(){return[Pd({find:au,type:this.type})]}}),lu=/(?:^|\s)(\*\*(?!\s+\*\*)((?:[^*]+))\*\*(?!\s+\*\*))$/,cu=/(?:^|\s)(\*\*(?!\s+\*\*)((?:[^*]+))\*\*(?!\s+\*\*))/g,du=/(?:^|\s)(__(?!\s+__)((?:[^_]+))__(?!\s+__))$/,uu=/(?:^|\s)(__(?!\s+__)((?:[^_]+))__(?!\s+__))/g,pu=Nc.create({name:"bold",addOptions:()=>({HTMLAttributes:{}}),parseHTML(){return[{tag:"strong"},{tag:"b",getAttrs:e=>"normal"!==e.style.fontWeight&&null},{style:"font-weight=400",clearMark:e=>e.type.name===this.name},{style:"font-weight",getAttrs:e=>/^(bold(er)?|[5-9]\d{2,})$/.test(e)&&null}]},renderHTML(e){let{HTMLAttributes:t}=e;return["strong",vc(this.options.HTMLAttributes,t),0]},addCommands(){return{setBold:()=>e=>{let{commands:t}=e;return t.setMark(this.name)},toggleBold:()=>e=>{let{commands:t}=e;return t.toggleMark(this.name)},unsetBold:()=>e=>{let{commands:t}=e;return t.unsetMark(this.name)}}},addKeyboardShortcuts(){return{"Mod-b":()=>this.editor.commands.toggleBold(),"Mod-B":()=>this.editor.commands.toggleBold()}},addInputRules(){return[Td({find:lu,type:this.type}),Td({find:du,type:this.type})]},addPasteRules(){return[Id({find:cu,type:this.type}),Id({find:uu,type:this.type})]}}),hu="textStyle",fu=/^\s*([-+*])\s$/,gu=Nd.create({name:"bulletList",addOptions:()=>({itemTypeName:"listItem",HTMLAttributes:{},keepMarks:!1,keepAttributes:!1}),group:"block list",content(){return`${this.options.itemTypeName}+`},parseHTML:()=>[{tag:"ul"}],renderHTML(e){let{HTMLAttributes:t}=e;return["ul",vc(this.options.HTMLAttributes,t),0]},addCommands(){return{toggleBulletList:()=>e=>{let{commands:t,chain:o}=e;return this.options.keepAttributes?o().toggleList(this.name,this.options.itemTypeName,this.options.keepMarks).updateAttributes("listItem",this.editor.getAttributes(hu)).run():t.toggleList(this.name,this.options.itemTypeName,this.options.keepMarks)}}},addKeyboardShortcuts(){return{"Mod-Shift-8":()=>this.editor.commands.toggleBulletList()}},addInputRules(){let e=Pd({find:fu,type:this.type});return(this.options.keepMarks||this.options.keepAttributes)&&(e=Pd({find:fu,type:this.type,keepMarks:this.options.keepMarks,keepAttributes:this.options.keepAttributes,getAttributes:()=>this.editor.getAttributes(hu),editor:this.editor})),[e]}}),mu=/(^|[^`])`([^`]+)`(?!`)/,yu=/(^|[^`])`([^`]+)`(?!`)/g,vu=Nc.create({name:"code",addOptions:()=>({HTMLAttributes:{}}),excludes:"_",code:!0,exitable:!0,parseHTML:()=>[{tag:"code"}],renderHTML(e){let{HTMLAttributes:t}=e;return["code",vc(this.options.HTMLAttributes,t),0]},addCommands(){return{setCode:()=>e=>{let{commands:t}=e;return t.setMark(this.name)},toggleCode:()=>e=>{let{commands:t}=e;return t.toggleMark(this.name)},unsetCode:()=>e=>{let{commands:t}=e;return t.unsetMark(this.name)}}},addKeyboardShortcuts(){return{"Mod-e":()=>this.editor.commands.toggleCode()}},addInputRules(){return[Td({find:mu,type:this.type})]},addPasteRules(){return[Id({find:yu,type:this.type})]}}),bu=/^```([a-z]+)?[\s\n]$/,xu=/^~~~([a-z]+)?[\s\n]$/,wu=Nd.create({name:"codeBlock",addOptions:()=>({languageClassPrefix:"language-",exitOnTripleEnter:!0,exitOnArrowDown:!0,defaultLanguage:null,HTMLAttributes:{}}),content:"text*",marks:"",group:"block",code:!0,defining:!0,addAttributes(){return{language:{default:this.options.defaultLanguage,parseHTML:e=>{var t;const{languageClassPrefix:o}=this.options,n=[...(null===(t=e.firstElementChild)||void 0===t?void 0:t.classList)||[]].filter((e=>e.startsWith(o))).map((e=>e.replace(o,"")))[0];return n||null},rendered:!1}}},parseHTML:()=>[{tag:"pre",preserveWhitespace:"full"}],renderHTML(e){let{node:t,HTMLAttributes:o}=e;return["pre",vc(this.options.HTMLAttributes,o),["code",{class:t.attrs.language?this.options.languageClassPrefix+t.attrs.language:null},0]]},addCommands(){return{setCodeBlock:e=>t=>{let{commands:o}=t;return o.setNode(this.name,e)},toggleCodeBlock:e=>t=>{let{commands:o}=t;return o.toggleNode(this.name,"paragraph",e)}}},addKeyboardShortcuts(){return{"Mod-Alt-c":()=>this.editor.commands.toggleCodeBlock(),Backspace:()=>{const{empty:e,$anchor:t}=this.editor.state.selection,o=1===t.pos;return!(!e||t.parent.type.name!==this.name)&&(!(!o&&t.parent.textContent.length)&&this.editor.commands.clearNodes())},Enter:e=>{let{editor:t}=e;if(!this.options.exitOnTripleEnter)return!1;const{state:o}=t,{selection:n}=o,{$from:r,empty:i}=n;if(!i||r.parent.type!==this.type)return!1;const a=r.parentOffset===r.parent.nodeSize-2,s=r.parent.textContent.endsWith("\n\n");return!(!a||!s)&&t.chain().command((e=>{let{tr:t}=e;return t.delete(r.pos-2,r.pos),!0})).exitCode().run()},ArrowDown:e=>{let{editor:t}=e;if(!this.options.exitOnArrowDown)return!1;const{state:o}=t,{selection:n,doc:r}=o,{$from:i,empty:a}=n;if(!a||i.parent.type!==this.type)return!1;if(!(i.parentOffset===i.parent.nodeSize-2))return!1;const s=i.after();if(void 0===s)return!1;return r.nodeAt(s)?t.commands.command((e=>{let{tr:t}=e;return t.setSelection(zr.near(r.resolve(s))),!0})):t.commands.exitCode()}}},addInputRules(){return[Dd({find:bu,type:this.type,getAttributes:e=>({language:e[1]})}),Dd({find:xu,type:this.type,getAttributes:e=>({language:e[1]})})]},addProseMirrorPlugins(){return[new ii({key:new li("codeBlockVSCodeHandler"),props:{handlePaste:(e,t)=>{if(!t.clipboardData)return!1;if(this.editor.isActive(this.type.name))return!1;const o=t.clipboardData.getData("text/plain"),n=t.clipboardData.getData("vscode-editor-data"),r=n?JSON.parse(n):void 0,i=null===r||void 0===r?void 0:r.mode;if(!o||!i)return!1;const{tr:a,schema:s}=e.state,l=s.text(o.replace(/\r\n?/g,"\n"));return a.replaceSelectionWith(this.type.create({language:i},l)),a.selection.$from.parent.type!==this.type&&a.setSelection($r.near(a.doc.resolve(Math.max(0,a.selection.from-2)))),a.setMeta("paste",!0),e.dispatch(a),!0}}})]}}),Cu=Nd.create({name:"doc",topNode:!0,content:"block+"});function _u(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return new ii({view:t=>new Su(t,e)})}class Su{constructor(e,t){var o;this.editorView=e,this.cursorPos=null,this.element=null,this.timeout=-1,this.width=null!==(o=t.width)&&void 0!==o?o:1,this.color=!1===t.color?void 0:t.color||"black",this.class=t.class,this.handlers=["dragover","dragend","drop","dragleave"].map((t=>{let o=e=>{this[t](e)};return e.dom.addEventListener(t,o),{name:t,handler:o}}))}destroy(){this.handlers.forEach((e=>{let{name:t,handler:o}=e;return this.editorView.dom.removeEventListener(t,o)}))}update(e,t){null!=this.cursorPos&&t.doc!=e.state.doc&&(this.cursorPos>e.state.doc.content.size?this.setCursor(null):this.updateOverlay())}setCursor(e){e!=this.cursorPos&&(this.cursorPos=e,null==e?(this.element.parentNode.removeChild(this.element),this.element=null):this.updateOverlay())}updateOverlay(){let e,t=this.editorView.state.doc.resolve(this.cursorPos),o=!t.parent.inlineContent;if(o){let o=t.nodeBefore,n=t.nodeAfter;if(o||n){let t=this.editorView.nodeDOM(this.cursorPos-(o?o.nodeSize:0));if(t){let r=t.getBoundingClientRect(),i=o?r.bottom:r.top;o&&n&&(i=(i+this.editorView.nodeDOM(this.cursorPos).getBoundingClientRect().top)/2),e={left:r.left,right:r.right,top:i-this.width/2,bottom:i+this.width/2}}}}if(!e){let t=this.editorView.coordsAtPos(this.cursorPos);e={left:t.left-this.width/2,right:t.left+this.width/2,top:t.top,bottom:t.bottom}}let n,r,i=this.editorView.dom.offsetParent;if(this.element||(this.element=i.appendChild(document.createElement("div")),this.class&&(this.element.className=this.class),this.element.style.cssText="position: absolute; z-index: 50; pointer-events: none;",this.color&&(this.element.style.backgroundColor=this.color)),this.element.classList.toggle("prosemirror-dropcursor-block",o),this.element.classList.toggle("prosemirror-dropcursor-inline",!o),!i||i==document.body&&"static"==getComputedStyle(i).position)n=-pageXOffset,r=-pageYOffset;else{let e=i.getBoundingClientRect();n=e.left-i.scrollLeft,r=e.top-i.scrollTop}this.element.style.left=e.left-n+"px",this.element.style.top=e.top-r+"px",this.element.style.width=e.right-e.left+"px",this.element.style.height=e.bottom-e.top+"px"}scheduleRemoval(e){clearTimeout(this.timeout),this.timeout=setTimeout((()=>this.setCursor(null)),e)}dragover(e){if(!this.editorView.editable)return;let t=this.editorView.posAtCoords({left:e.clientX,top:e.clientY}),o=t&&t.inside>=0&&this.editorView.state.doc.nodeAt(t.inside),n=o&&o.type.spec.disableDropCursor,r="function"==typeof n?n(this.editorView,t,e):n;if(t&&!r){let e=t.pos;if(this.editorView.dragging&&this.editorView.dragging.slice){let t=Sr(this.editorView.state.doc,e,this.editorView.dragging.slice);null!=t&&(e=t)}this.setCursor(e),this.scheduleRemoval(5e3)}}dragend(){this.scheduleRemoval(20)}drop(){this.scheduleRemoval(20)}dragleave(e){e.target!=this.editorView.dom&&this.editorView.dom.contains(e.relatedTarget)||this.setCursor(null)}}const Eu=zc.create({name:"dropCursor",addOptions:()=>({color:"currentColor",width:1,class:void 0}),addProseMirrorPlugins(){return[_u(this.options)]}});class ku extends zr{constructor(e){super(e,e)}map(e,t){let o=e.resolve(t.map(this.head));return ku.valid(o)?new ku(o):zr.near(o)}content(){return Yo.empty}eq(e){return e instanceof ku&&e.head==this.head}toJSON(){return{type:"gapcursor",pos:this.head}}static fromJSON(e,t){if("number"!=typeof t.pos)throw new RangeError("Invalid input for GapCursor.fromJSON");return new ku(e.resolve(t.pos))}getBookmark(){return new ju(this.anchor)}static valid(e){let t=e.parent;if(t.isTextblock||!function(e){for(let t=e.depth;t>=0;t--){let o=e.index(t),n=e.node(t);if(0!=o)for(let e=n.child(o-1);;e=e.lastChild){if(0==e.childCount&&!e.inlineContent||e.isAtom||e.type.spec.isolating)return!0;if(e.inlineContent)return!1}else if(n.type.spec.isolating)return!0}return!0}(e)||!function(e){for(let t=e.depth;t>=0;t--){let o=e.indexAfter(t),n=e.node(t);if(o!=n.childCount)for(let e=n.child(o);;e=e.firstChild){if(0==e.childCount&&!e.inlineContent||e.isAtom||e.type.spec.isolating)return!0;if(e.inlineContent)return!1}else if(n.type.spec.isolating)return!0}return!0}(e))return!1;let o=t.type.spec.allowGapCursor;if(null!=o)return o;let n=t.contentMatchAt(e.index()).defaultType;return n&&n.isTextblock}static findGapCursorFrom(e,t){let o=arguments.length>2&&void 0!==arguments[2]&&arguments[2];e:for(;;){if(!o&&ku.valid(e))return e;let n=e.pos,r=null;for(let o=e.depth;;o--){let i=e.node(o);if(t>0?e.indexAfter(o)<i.childCount:e.index(o)>0){r=i.child(t>0?e.indexAfter(o):e.index(o)-1);break}if(0==o)return null;n+=t;let a=e.doc.resolve(n);if(ku.valid(a))return a}for(;;){let i=t>0?r.firstChild:r.lastChild;if(!i){if(r.isAtom&&!r.isText&&!Wr.isSelectable(r)){e=e.doc.resolve(n+r.nodeSize*t),o=!1;continue e}break}r=i,n+=t;let a=e.doc.resolve(n);if(ku.valid(a))return a}return null}}}ku.prototype.visible=!1,ku.findFrom=ku.findGapCursorFrom,zr.jsonID("gapcursor",ku);class ju{constructor(e){this.pos=e}map(e){return new ju(e.map(this.pos))}resolve(e){let t=e.resolve(this.pos);return ku.valid(t)?new ku(t):zr.near(t)}}const Au=Nl({ArrowLeft:Ru("horiz",-1),ArrowRight:Ru("horiz",1),ArrowUp:Ru("vert",-1),ArrowDown:Ru("vert",1)});function Ru(e,t){const o="vert"==e?t>0?"down":"up":t>0?"right":"left";return function(e,n,r){let i=e.selection,a=t>0?i.$to:i.$from,s=i.empty;if(i instanceof $r){if(!r.endOfTextblock(o)||0==a.depth)return!1;s=!1,a=e.doc.resolve(t>0?a.after():a.before())}let l=ku.findGapCursorFrom(a,t,s);return!!l&&(n&&n(e.tr.setSelection(new ku(l))),!0)}}function Ou(e,t,o){if(!e||!e.editable)return!1;let n=e.state.doc.resolve(t);if(!ku.valid(n))return!1;let r=e.posAtCoords({left:o.clientX,top:o.clientY});return!(r&&r.inside>-1&&Wr.isSelectable(e.state.doc.nodeAt(r.inside)))&&(e.dispatch(e.state.tr.setSelection(new ku(n))),!0)}function Tu(e,t){if("insertCompositionText"!=t.inputType||!(e.state.selection instanceof ku))return!1;let{$from:o}=e.state.selection,n=o.parent.contentMatchAt(o.index()).findWrapping(e.state.schema.nodes.text);if(!n)return!1;let r=Vo.empty;for(let a=n.length-1;a>=0;a--)r=Vo.from(n[a].createAndFill(null,r));let i=e.state.tr.replace(o.pos,o.pos,new Yo(r,0,0));return i.setSelection($r.near(i.doc.resolve(o.pos+1))),e.dispatch(i),!1}function Du(e){if(!(e.selection instanceof ku))return null;let t=document.createElement("div");return t.className="ProseMirror-gapcursor",Ks.create(e.doc,[Us.widget(e.selection.head,t,{key:"gapcursor"})])}const Pu=zc.create({name:"gapCursor",addProseMirrorPlugins:()=>[new ii({props:{decorations:Du,createSelectionBetween:(e,t,o)=>t.pos==o.pos&&ku.valid(o)?new ku(o):null,handleClick:Ou,handleKeyDown:Au,handleDOMEvents:{beforeinput:Tu}}})],extendNodeSchema(e){var t;return{allowGapCursor:null!==(t=wc(fc(e,"allowGapCursor",{name:e.name,options:e.options,storage:e.storage})))&&void 0!==t?t:null}}}),Nu=Nd.create({name:"hardBreak",addOptions:()=>({keepMarks:!0,HTMLAttributes:{}}),inline:!0,group:"inline",selectable:!1,linebreakReplacement:!0,parseHTML:()=>[{tag:"br"}],renderHTML(e){let{HTMLAttributes:t}=e;return["br",vc(this.options.HTMLAttributes,t)]},renderText:()=>"\n",addCommands(){return{setHardBreak:()=>e=>{let{commands:t,chain:o,state:n,editor:r}=e;return t.first([()=>t.exitCode(),()=>t.command((()=>{const{selection:e,storedMarks:t}=n;if(e.$from.parent.type.spec.isolating)return!1;const{keepMarks:i}=this.options,{splittableMarks:a}=r.extensionManager,s=t||e.$to.parentOffset&&e.$from.marks();return o().insertContent({type:this.name}).command((e=>{let{tr:t,dispatch:o}=e;if(o&&s&&i){const e=s.filter((e=>a.includes(e.type.name)));t.ensureMarks(e)}return!0})).run()}))])}}},addKeyboardShortcuts(){return{"Mod-Enter":()=>this.editor.commands.setHardBreak(),"Shift-Enter":()=>this.editor.commands.setHardBreak()}}}),Iu=Nd.create({name:"heading",addOptions:()=>({levels:[1,2,3,4,5,6],HTMLAttributes:{}}),content:"inline*",group:"block",defining:!0,addAttributes:()=>({level:{default:1,rendered:!1}}),parseHTML(){return this.options.levels.map((e=>({tag:`h${e}`,attrs:{level:e}})))},renderHTML(e){let{node:t,HTMLAttributes:o}=e;return[`h${this.options.levels.includes(t.attrs.level)?t.attrs.level:this.options.levels[0]}`,vc(this.options.HTMLAttributes,o),0]},addCommands(){return{setHeading:e=>t=>{let{commands:o}=t;return!!this.options.levels.includes(e.level)&&o.setNode(this.name,e)},toggleHeading:e=>t=>{let{commands:o}=t;return!!this.options.levels.includes(e.level)&&o.toggleNode(this.name,"paragraph",e)}}},addKeyboardShortcuts(){return this.options.levels.reduce(((e,t)=>({...e,[`Mod-Alt-${t}`]:()=>this.editor.commands.toggleHeading({level:t})})),{})},addInputRules(){return this.options.levels.map((e=>Dd({find:new RegExp(`^(#{${Math.min(...this.options.levels)},${e}})\\s$`),type:this.type,getAttributes:{level:e}})))}});var Mu=200,Lu=function(){};Lu.prototype.append=function(e){return e.length?(e=Lu.from(e),!this.length&&e||e.length<Mu&&this.leafAppend(e)||this.length<Mu&&e.leafPrepend(this)||this.appendInner(e)):this},Lu.prototype.prepend=function(e){return e.length?Lu.from(e).append(this):this},Lu.prototype.appendInner=function(e){return new Gu(this,e)},Lu.prototype.slice=function(e,t){return void 0===e&&(e=0),void 0===t&&(t=this.length),e>=t?Lu.empty:this.sliceInner(Math.max(0,e),Math.min(this.length,t))},Lu.prototype.get=function(e){if(!(e<0||e>=this.length))return this.getInner(e)},Lu.prototype.forEach=function(e,t,o){void 0===t&&(t=0),void 0===o&&(o=this.length),t<=o?this.forEachInner(e,t,o,0):this.forEachInvertedInner(e,t,o,0)},Lu.prototype.map=function(e,t,o){void 0===t&&(t=0),void 0===o&&(o=this.length);var n=[];return this.forEach((function(t,o){return n.push(e(t,o))}),t,o),n},Lu.from=function(e){return e instanceof Lu?e:e&&e.length?new Fu(e):Lu.empty};var Fu=function(e){function t(t){e.call(this),this.values=t}e&&(t.__proto__=e),t.prototype=Object.create(e&&e.prototype),t.prototype.constructor=t;var o={length:{configurable:!0},depth:{configurable:!0}};return t.prototype.flatten=function(){return this.values},t.prototype.sliceInner=function(e,o){return 0==e&&o==this.length?this:new t(this.values.slice(e,o))},t.prototype.getInner=function(e){return this.values[e]},t.prototype.forEachInner=function(e,t,o,n){for(var r=t;r<o;r++)if(!1===e(this.values[r],n+r))return!1},t.prototype.forEachInvertedInner=function(e,t,o,n){for(var r=t-1;r>=o;r--)if(!1===e(this.values[r],n+r))return!1},t.prototype.leafAppend=function(e){if(this.length+e.length<=Mu)return new t(this.values.concat(e.flatten()))},t.prototype.leafPrepend=function(e){if(this.length+e.length<=Mu)return new t(e.flatten().concat(this.values))},o.length.get=function(){return this.values.length},o.depth.get=function(){return 0},Object.defineProperties(t.prototype,o),t}(Lu);Lu.empty=new Fu([]);var Gu=function(e){function t(t,o){e.call(this),this.left=t,this.right=o,this.length=t.length+o.length,this.depth=Math.max(t.depth,o.depth)+1}return e&&(t.__proto__=e),t.prototype=Object.create(e&&e.prototype),t.prototype.constructor=t,t.prototype.flatten=function(){return this.left.flatten().concat(this.right.flatten())},t.prototype.getInner=function(e){return e<this.left.length?this.left.get(e):this.right.get(e-this.left.length)},t.prototype.forEachInner=function(e,t,o,n){var r=this.left.length;return!(t<r&&!1===this.left.forEachInner(e,t,Math.min(o,r),n))&&(!(o>r&&!1===this.right.forEachInner(e,Math.max(t-r,0),Math.min(this.length,o)-r,n+r))&&void 0)},t.prototype.forEachInvertedInner=function(e,t,o,n){var r=this.left.length;return!(t>r&&!1===this.right.forEachInvertedInner(e,t-r,Math.max(o,r)-r,n+r))&&(!(o<r&&!1===this.left.forEachInvertedInner(e,Math.min(t,r),o,n))&&void 0)},t.prototype.sliceInner=function(e,t){if(0==e&&t==this.length)return this;var o=this.left.length;return t<=o?this.left.slice(e,t):e>=o?this.right.slice(e-o,t-o):this.left.slice(e,o).append(this.right.slice(0,t-o))},t.prototype.leafAppend=function(e){var o=this.right.leafAppend(e);if(o)return new t(this.left,o)},t.prototype.leafPrepend=function(e){var o=this.left.leafPrepend(e);if(o)return new t(o,this.right)},t.prototype.appendInner=function(e){return this.left.depth>=Math.max(this.right.depth,e.depth)+1?new t(this.left,new t(this.right,e)):new t(this,e)},t}(Lu);const zu=Lu;class Hu{constructor(e,t){this.items=e,this.eventCount=t}popEvent(e,t){if(0==this.eventCount)return null;let o,n,r=this.items.length;for(;;r--){if(this.items.get(r-1).selection){--r;break}}t&&(o=this.remapping(r,this.items.length),n=o.maps.length);let i,a,s=e.tr,l=[],c=[];return this.items.forEach(((e,t)=>{if(!e.step)return o||(o=this.remapping(r,t+1),n=o.maps.length),n--,void c.push(e);if(o){c.push(new Bu(e.map));let t,r=e.step.map(o.slice(n));r&&s.maybeStep(r).doc&&(t=s.mapping.maps[s.mapping.maps.length-1],l.push(new Bu(t,void 0,void 0,l.length+c.length))),n--,t&&o.appendMap(t,n)}else s.maybeStep(e.step);return e.selection?(i=o?e.selection.map(o.slice(n)):e.selection,a=new Hu(this.items.slice(0,r).append(c.reverse().concat(l)),this.eventCount-1),!1):void 0}),this.items.length,0),{remaining:a,transform:s,selection:i}}addTransform(e,t,o,n){let r=[],i=this.eventCount,a=this.items,s=!n&&a.length?a.get(a.length-1):null;for(let c=0;c<e.steps.length;c++){let o,l=e.steps[c].invert(e.docs[c]),d=new Bu(e.mapping.maps[c],l,t);(o=s&&s.merge(d))&&(d=o,c?r.pop():a=a.slice(0,a.length-1)),r.push(d),t&&(i++,t=void 0),n||(s=d)}let l=i-o.depth;return l>$u&&(a=function(e,t){let o;return e.forEach(((e,n)=>{if(e.selection&&0==t--)return o=n,!1})),e.slice(o)}(a,l),i-=l),new Hu(a.append(r),i)}remapping(e,t){let o=new tr;return this.items.forEach(((t,n)=>{let r=null!=t.mirrorOffset&&n-t.mirrorOffset>=e?o.maps.length-t.mirrorOffset:void 0;o.appendMap(t.map,r)}),e,t),o}addMaps(e){return 0==this.eventCount?this:new Hu(this.items.append(e.map((e=>new Bu(e)))),this.eventCount)}rebased(e,t){if(!this.eventCount)return this;let o=[],n=Math.max(0,this.items.length-t),r=e.mapping,i=e.steps.length,a=this.eventCount;this.items.forEach((e=>{e.selection&&a--}),n);let s=t;this.items.forEach((t=>{let n=r.getMirror(--s);if(null==n)return;i=Math.min(i,n);let l=r.maps[n];if(t.step){let i=e.steps[n].invert(e.docs[n]),c=t.selection&&t.selection.map(r.slice(s+1,n));c&&a++,o.push(new Bu(l,i,c))}else o.push(new Bu(l))}),n);let l=[];for(let u=t;u<i;u++)l.push(new Bu(r.maps[u]));let c=this.items.slice(0,n).append(l).append(o),d=new Hu(c,a);return d.emptyItemCount()>500&&(d=d.compress(this.items.length-o.length)),d}emptyItemCount(){let e=0;return this.items.forEach((t=>{t.step||e++})),e}compress(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.items.length,t=this.remapping(0,e),o=t.maps.length,n=[],r=0;return this.items.forEach(((i,a)=>{if(a>=e)n.push(i),i.selection&&r++;else if(i.step){let e=i.step.map(t.slice(o)),a=e&&e.getMap();if(o--,a&&t.appendMap(a,o),e){let s=i.selection&&i.selection.map(t.slice(o));s&&r++;let l,c=new Bu(a.invert(),e,s),d=n.length-1;(l=n.length&&n[d].merge(c))?n[d]=l:n.push(c)}}else i.map&&o--}),this.items.length,0),new Hu(zu.from(n.reverse()),r)}}Hu.empty=new Hu(zu.empty,0);class Bu{constructor(e,t,o,n){this.map=e,this.step=t,this.selection=o,this.mirrorOffset=n}merge(e){if(this.step&&e.step&&!e.selection){let t=e.step.merge(this.step);if(t)return new Bu(t.getMap().invert(),t,this.selection)}}}class Vu{constructor(e,t,o,n,r){this.done=e,this.undone=t,this.prevRanges=o,this.prevTime=n,this.prevComposition=r}}const $u=20;function Uu(e){let t=[];for(let o=e.length-1;o>=0&&0==t.length;o--)e[o].forEach(((e,o,n,r)=>t.push(n,r)));return t}function Wu(e,t){if(!e)return null;let o=[];for(let n=0;n<e.length;n+=2){let r=t.map(e[n],1),i=t.map(e[n+1],-1);r<=i&&o.push(r,i)}return o}let qu=!1,Ku=null;function Yu(e){let t=e.plugins;if(Ku!=t){qu=!1,Ku=t;for(let e=0;e<t.length;e++)if(t[e].spec.historyPreserveItems){qu=!0;break}}return qu}const Ju=new li("history"),Xu=new li("closeHistory");function Qu(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return e={depth:e.depth||100,newGroupDelay:e.newGroupDelay||500},new ii({key:Ju,state:{init:()=>new Vu(Hu.empty,Hu.empty,null,0,-1),apply:(t,o,n)=>function(e,t,o,n){let r,i=o.getMeta(Ju);if(i)return i.historyState;o.getMeta(Xu)&&(e=new Vu(e.done,e.undone,null,0,-1));let a=o.getMeta("appendedTransaction");if(0==o.steps.length)return e;if(a&&a.getMeta(Ju))return a.getMeta(Ju).redo?new Vu(e.done.addTransform(o,void 0,n,Yu(t)),e.undone,Uu(o.mapping.maps),e.prevTime,e.prevComposition):new Vu(e.done,e.undone.addTransform(o,void 0,n,Yu(t)),null,e.prevTime,e.prevComposition);if(!1===o.getMeta("addToHistory")||a&&!1===a.getMeta("addToHistory"))return(r=o.getMeta("rebased"))?new Vu(e.done.rebased(o,r),e.undone.rebased(o,r),Wu(e.prevRanges,o.mapping),e.prevTime,e.prevComposition):new Vu(e.done.addMaps(o.mapping.maps),e.undone.addMaps(o.mapping.maps),Wu(e.prevRanges,o.mapping),e.prevTime,e.prevComposition);{let r=o.getMeta("composition"),i=0==e.prevTime||!a&&e.prevComposition!=r&&(e.prevTime<(o.time||0)-n.newGroupDelay||!function(e,t){if(!t)return!1;if(!e.docChanged)return!0;let o=!1;return e.mapping.maps[0].forEach(((e,n)=>{for(let r=0;r<t.length;r+=2)e<=t[r+1]&&n>=t[r]&&(o=!0)})),o}(o,e.prevRanges)),s=a?Wu(e.prevRanges,o.mapping):Uu(o.mapping.maps);return new Vu(e.done.addTransform(o,i?t.selection.getBookmark():void 0,n,Yu(t)),Hu.empty,s,o.time,null==r?e.prevComposition:r)}}(o,n,t,e)},config:e,props:{handleDOMEvents:{beforeinput(e,t){let o=t.inputType,n="historyUndo"==o?ep:"historyRedo"==o?tp:null;return!!n&&(t.preventDefault(),n(e.state,e.dispatch))}}}})}function Zu(e,t){return(o,n)=>{let r=Ju.getState(o);if(!r||0==(e?r.undone:r.done).eventCount)return!1;if(n){let i=function(e,t,o){let n=Yu(t),r=Ju.get(t).spec.config,i=(o?e.undone:e.done).popEvent(t,n);if(!i)return null;let a=i.selection.resolve(i.transform.doc),s=(o?e.done:e.undone).addTransform(i.transform,t.selection.getBookmark(),r,n),l=new Vu(o?s:i.remaining,o?i.remaining:s,null,0,-1);return i.transform.setSelection(a).setMeta(Ju,{redo:o,historyState:l})}(r,o,e);i&&n(t?i.scrollIntoView():i)}return!0}}const ep=Zu(!1,!0),tp=Zu(!0,!0);Zu(!1,!1),Zu(!0,!1);const op=zc.create({name:"history",addOptions:()=>({depth:100,newGroupDelay:500}),addCommands:()=>({undo:()=>e=>{let{state:t,dispatch:o}=e;return ep(t,o)},redo:()=>e=>{let{state:t,dispatch:o}=e;return tp(t,o)}}),addProseMirrorPlugins(){return[Qu(this.options)]},addKeyboardShortcuts(){return{"Mod-z":()=>this.editor.commands.undo(),"Shift-Mod-z":()=>this.editor.commands.redo(),"Mod-y":()=>this.editor.commands.redo(),"Mod-\u044f":()=>this.editor.commands.undo(),"Shift-Mod-\u044f":()=>this.editor.commands.redo()}}}),np=Nd.create({name:"horizontalRule",addOptions:()=>({HTMLAttributes:{}}),group:"block",parseHTML:()=>[{tag:"hr"}],renderHTML(e){let{HTMLAttributes:t}=e;return["hr",vc(this.options.HTMLAttributes,t)]},addCommands(){return{setHorizontalRule:()=>e=>{let{chain:t,state:o}=e;const{selection:n}=o,{$from:r,$to:i}=n,a=t();return 0===r.parentOffset?a.insertContentAt({from:Math.max(r.pos-1,0),to:i.pos},{type:this.name}):n instanceof Wr?a.insertContentAt(i.pos,{type:this.name}):a.insertContent({type:this.name}),a.command((e=>{let{tr:t,dispatch:o}=e;var n;if(o){const{$to:e}=t.selection,o=e.end();if(e.nodeAfter)e.nodeAfter.isTextblock?t.setSelection($r.create(t.doc,e.pos+1)):e.nodeAfter.isBlock?t.setSelection(Wr.create(t.doc,e.pos)):t.setSelection($r.create(t.doc,e.pos));else{const r=null===(n=e.parent.type.contentMatch.defaultType)||void 0===n?void 0:n.create();r&&(t.insert(o,r),t.setSelection($r.create(t.doc,o+1)))}t.scrollIntoView()}return!0})).run()}}},addInputRules(){return[(e={find:/^(?:---|\u2014-|___\s|\*\*\*\s)$/,type:this.type},new Rc({find:e.find,handler:t=>{let{state:o,range:n,match:r}=t;const i=wc(e.getAttributes,void 0,r)||{},{tr:a}=o,s=n.from;let l=n.to;const c=e.type.create(i);if(r[1]){let e=s+r[0].lastIndexOf(r[1]);e>l?e=l:l=e+r[1].length;const t=r[0][r[0].length-1];a.insertText(t,s+r[0].length-1),a.replaceWith(e,l,c)}else if(r[0]){const t=e.type.isInline?s:s-1;a.insert(t,e.type.create(i)).delete(a.mapping.map(s),a.mapping.map(l))}a.scrollIntoView()}}))];var e}}),rp=/(?:^|\s)(\*(?!\s+\*)((?:[^*]+))\*(?!\s+\*))$/,ip=/(?:^|\s)(\*(?!\s+\*)((?:[^*]+))\*(?!\s+\*))/g,ap=/(?:^|\s)(_(?!\s+_)((?:[^_]+))_(?!\s+_))$/,sp=/(?:^|\s)(_(?!\s+_)((?:[^_]+))_(?!\s+_))/g,lp=Nc.create({name:"italic",addOptions:()=>({HTMLAttributes:{}}),parseHTML(){return[{tag:"em"},{tag:"i",getAttrs:e=>"normal"!==e.style.fontStyle&&null},{style:"font-style=normal",clearMark:e=>e.type.name===this.name},{style:"font-style=italic"}]},renderHTML(e){let{HTMLAttributes:t}=e;return["em",vc(this.options.HTMLAttributes,t),0]},addCommands(){return{setItalic:()=>e=>{let{commands:t}=e;return t.setMark(this.name)},toggleItalic:()=>e=>{let{commands:t}=e;return t.toggleMark(this.name)},unsetItalic:()=>e=>{let{commands:t}=e;return t.unsetMark(this.name)}}},addKeyboardShortcuts(){return{"Mod-i":()=>this.editor.commands.toggleItalic(),"Mod-I":()=>this.editor.commands.toggleItalic()}},addInputRules(){return[Td({find:rp,type:this.type}),Td({find:ap,type:this.type})]},addPasteRules(){return[Id({find:ip,type:this.type}),Id({find:sp,type:this.type})]}}),cp=Nd.create({name:"listItem",addOptions:()=>({HTMLAttributes:{},bulletListTypeName:"bulletList",orderedListTypeName:"orderedList"}),content:"paragraph block*",defining:!0,parseHTML:()=>[{tag:"li"}],renderHTML(e){let{HTMLAttributes:t}=e;return["li",vc(this.options.HTMLAttributes,t),0]},addKeyboardShortcuts(){return{Enter:()=>this.editor.commands.splitListItem(this.name),Tab:()=>this.editor.commands.sinkListItem(this.name),"Shift-Tab":()=>this.editor.commands.liftListItem(this.name)}}}),dp="textStyle",up=/^(\d+)\.\s$/,pp=Nd.create({name:"orderedList",addOptions:()=>({itemTypeName:"listItem",HTMLAttributes:{},keepMarks:!1,keepAttributes:!1}),group:"block list",content(){return`${this.options.itemTypeName}+`},addAttributes:()=>({start:{default:1,parseHTML:e=>e.hasAttribute("start")?parseInt(e.getAttribute("start")||"",10):1},type:{default:void 0,parseHTML:e=>e.getAttribute("type")}}),parseHTML:()=>[{tag:"ol"}],renderHTML(e){let{HTMLAttributes:t}=e;const{start:o,...n}=t;return 1===o?["ol",vc(this.options.HTMLAttributes,n),0]:["ol",vc(this.options.HTMLAttributes,t),0]},addCommands(){return{toggleOrderedList:()=>e=>{let{commands:t,chain:o}=e;return this.options.keepAttributes?o().toggleList(this.name,this.options.itemTypeName,this.options.keepMarks).updateAttributes("listItem",this.editor.getAttributes(dp)).run():t.toggleList(this.name,this.options.itemTypeName,this.options.keepMarks)}}},addKeyboardShortcuts(){return{"Mod-Shift-7":()=>this.editor.commands.toggleOrderedList()}},addInputRules(){let e=Pd({find:up,type:this.type,getAttributes:e=>({start:+e[1]}),joinPredicate:(e,t)=>t.childCount+t.attrs.start===+e[1]});return(this.options.keepMarks||this.options.keepAttributes)&&(e=Pd({find:up,type:this.type,keepMarks:this.options.keepMarks,keepAttributes:this.options.keepAttributes,getAttributes:e=>({start:+e[1],...this.editor.getAttributes(dp)}),joinPredicate:(e,t)=>t.childCount+t.attrs.start===+e[1],editor:this.editor})),[e]}}),hp=Nd.create({name:"paragraph",priority:1e3,addOptions:()=>({HTMLAttributes:{}}),group:"block",content:"inline*",parseHTML:()=>[{tag:"p"}],renderHTML(e){let{HTMLAttributes:t}=e;return["p",vc(this.options.HTMLAttributes,t),0]},addCommands(){return{setParagraph:()=>e=>{let{commands:t}=e;return t.setNode(this.name)}}},addKeyboardShortcuts(){return{"Mod-Alt-0":()=>this.editor.commands.setParagraph()}}}),fp=/(?:^|\s)(~~(?!\s+~~)((?:[^~]+))~~(?!\s+~~))$/,gp=/(?:^|\s)(~~(?!\s+~~)((?:[^~]+))~~(?!\s+~~))/g,mp=Nc.create({name:"strike",addOptions:()=>({HTMLAttributes:{}}),parseHTML:()=>[{tag:"s"},{tag:"del"},{tag:"strike"},{style:"text-decoration",consuming:!1,getAttrs:e=>!!e.includes("line-through")&&{}}],renderHTML(e){let{HTMLAttributes:t}=e;return["s",vc(this.options.HTMLAttributes,t),0]},addCommands(){return{setStrike:()=>e=>{let{commands:t}=e;return t.setMark(this.name)},toggleStrike:()=>e=>{let{commands:t}=e;return t.toggleMark(this.name)},unsetStrike:()=>e=>{let{commands:t}=e;return t.unsetMark(this.name)}}},addKeyboardShortcuts(){return{"Mod-Shift-s":()=>this.editor.commands.toggleStrike()}},addInputRules(){return[Td({find:fp,type:this.type})]},addPasteRules(){return[Id({find:gp,type:this.type})]}}),yp=Nd.create({name:"text",group:"inline"}),vp=zc.create({name:"starterKit",addExtensions(){var e,t,o,n,r,i,a,s,l,c,d,u,p,h,f,g,m,y;const v=[];return!1!==this.options.bold&&v.push(pu.configure(null===(e=this.options)||void 0===e?void 0:e.bold)),!1!==this.options.blockquote&&v.push(su.configure(null===(t=this.options)||void 0===t?void 0:t.blockquote)),!1!==this.options.bulletList&&v.push(gu.configure(null===(o=this.options)||void 0===o?void 0:o.bulletList)),!1!==this.options.code&&v.push(vu.configure(null===(n=this.options)||void 0===n?void 0:n.code)),!1!==this.options.codeBlock&&v.push(wu.configure(null===(r=this.options)||void 0===r?void 0:r.codeBlock)),!1!==this.options.document&&v.push(Cu.configure(null===(i=this.options)||void 0===i?void 0:i.document)),!1!==this.options.dropcursor&&v.push(Eu.configure(null===(a=this.options)||void 0===a?void 0:a.dropcursor)),!1!==this.options.gapcursor&&v.push(Pu.configure(null===(s=this.options)||void 0===s?void 0:s.gapcursor)),!1!==this.options.hardBreak&&v.push(Nu.configure(null===(l=this.options)||void 0===l?void 0:l.hardBreak)),!1!==this.options.heading&&v.push(Iu.configure(null===(c=this.options)||void 0===c?void 0:c.heading)),!1!==this.options.history&&v.push(op.configure(null===(d=this.options)||void 0===d?void 0:d.history)),!1!==this.options.horizontalRule&&v.push(np.configure(null===(u=this.options)||void 0===u?void 0:u.horizontalRule)),!1!==this.options.italic&&v.push(lp.configure(null===(p=this.options)||void 0===p?void 0:p.italic)),!1!==this.options.listItem&&v.push(cp.configure(null===(h=this.options)||void 0===h?void 0:h.listItem)),!1!==this.options.orderedList&&v.push(pp.configure(null===(f=this.options)||void 0===f?void 0:f.orderedList)),!1!==this.options.paragraph&&v.push(hp.configure(null===(g=this.options)||void 0===g?void 0:g.paragraph)),!1!==this.options.strike&&v.push(mp.configure(null===(m=this.options)||void 0===m?void 0:m.strike)),!1!==this.options.text&&v.push(yp.configure(null===(y=this.options)||void 0===y?void 0:y.text)),v}}),bp=(e,t)=>{for(const o in t)e[o]=t[o];return e},xp="numeric",wp="ascii",Cp="alpha",_p="asciinumeric",Sp="alphanumeric",Ep="domain",kp="emoji",jp="scheme",Ap="slashscheme",Rp="whitespace";function Op(e,t){return e in t||(t[e]=[]),t[e]}function Tp(e,t,o){t[xp]&&(t[_p]=!0,t[Sp]=!0),t[wp]&&(t[_p]=!0,t[Cp]=!0),t[_p]&&(t[Sp]=!0),t[Cp]&&(t[Sp]=!0),t[Sp]&&(t[Ep]=!0),t[kp]&&(t[Ep]=!0);for(const n in t){const t=Op(n,o);t.indexOf(e)<0&&t.push(e)}}function Dp(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;this.j={},this.jr=[],this.jd=null,this.t=e}Dp.groups={},Dp.prototype={accepts(){return!!this.t},go(e){const t=this,o=t.j[e];if(o)return o;for(let n=0;n<t.jr.length;n++){const o=t.jr[n][0],r=t.jr[n][1];if(r&&o.test(e))return r}return t.jd},has(e){return arguments.length>1&&void 0!==arguments[1]&&arguments[1]?e in this.j:!!this.go(e)},ta(e,t,o,n){for(let r=0;r<e.length;r++)this.tt(e[r],t,o,n)},tr(e,t,o,n){let r;return n=n||Dp.groups,t&&t.j?r=t:(r=new Dp(t),o&&n&&Tp(t,o,n)),this.jr.push([e,r]),r},ts(e,t,o,n){let r=this;const i=e.length;if(!i)return r;for(let a=0;a<i-1;a++)r=r.tt(e[a]);return r.tt(e[i-1],t,o,n)},tt(e,t,o,n){n=n||Dp.groups;const r=this;if(t&&t.j)return r.j[e]=t,t;const i=t;let a,s=r.go(e);if(s?(a=new Dp,bp(a.j,s.j),a.jr.push.apply(a.jr,s.jr),a.jd=s.jd,a.t=s.t):a=new Dp,i){if(n)if(a.t&&"string"===typeof a.t){const e=bp(function(e,t){const o={};for(const n in t)t[n].indexOf(e)>=0&&(o[n]=!0);return o}(a.t,n),o);Tp(i,e,n)}else o&&Tp(i,o,n);a.t=i}return r.j[e]=a,a}};const Pp=(e,t,o,n,r)=>e.ta(t,o,n,r),Np=(e,t,o,n,r)=>e.tr(t,o,n,r),Ip=(e,t,o,n,r)=>e.ts(t,o,n,r),Mp=(e,t,o,n,r)=>e.tt(t,o,n,r),Lp="WORD",Fp="UWORD",Gp="ASCIINUMERICAL",zp="ALPHANUMERICAL",Hp="LOCALHOST",Bp="TLD",Vp="UTLD",$p="SCHEME",Up="SLASH_SCHEME",Wp="NUM",qp="WS",Kp="NL",Yp="OPENBRACE",Jp="CLOSEBRACE",Xp="OPENBRACKET",Qp="CLOSEBRACKET",Zp="OPENPAREN",eh="CLOSEPAREN",th="OPENANGLEBRACKET",oh="CLOSEANGLEBRACKET",nh="FULLWIDTHLEFTPAREN",rh="FULLWIDTHRIGHTPAREN",ih="LEFTCORNERBRACKET",ah="RIGHTCORNERBRACKET",sh="LEFTWHITECORNERBRACKET",lh="RIGHTWHITECORNERBRACKET",ch="FULLWIDTHLESSTHAN",dh="FULLWIDTHGREATERTHAN",uh="AMPERSAND",ph="APOSTROPHE",hh="ASTERISK",fh="AT",gh="BACKSLASH",mh="BACKTICK",yh="CARET",vh="COLON",bh="COMMA",xh="DOLLAR",wh="DOT",Ch="EQUALS",_h="EXCLAMATION",Sh="HYPHEN",Eh="PERCENT",kh="PIPE",jh="PLUS",Ah="POUND",Rh="QUERY",Oh="QUOTE",Th="FULLWIDTHMIDDLEDOT",Dh="SEMI",Ph="SLASH",Nh="TILDE",Ih="UNDERSCORE",Mh="EMOJI",Lh="SYM";var Fh=Object.freeze({__proto__:null,WORD:Lp,UWORD:Fp,ASCIINUMERICAL:Gp,ALPHANUMERICAL:zp,LOCALHOST:Hp,TLD:Bp,UTLD:Vp,SCHEME:$p,SLASH_SCHEME:Up,NUM:Wp,WS:qp,NL:Kp,OPENBRACE:Yp,CLOSEBRACE:Jp,OPENBRACKET:Xp,CLOSEBRACKET:Qp,OPENPAREN:Zp,CLOSEPAREN:eh,OPENANGLEBRACKET:th,CLOSEANGLEBRACKET:oh,FULLWIDTHLEFTPAREN:nh,FULLWIDTHRIGHTPAREN:rh,LEFTCORNERBRACKET:ih,RIGHTCORNERBRACKET:ah,LEFTWHITECORNERBRACKET:sh,RIGHTWHITECORNERBRACKET:lh,FULLWIDTHLESSTHAN:ch,FULLWIDTHGREATERTHAN:dh,AMPERSAND:uh,APOSTROPHE:ph,ASTERISK:hh,AT:fh,BACKSLASH:gh,BACKTICK:mh,CARET:yh,COLON:vh,COMMA:bh,DOLLAR:xh,DOT:wh,EQUALS:Ch,EXCLAMATION:_h,HYPHEN:Sh,PERCENT:Eh,PIPE:kh,PLUS:jh,POUND:Ah,QUERY:Rh,QUOTE:Oh,FULLWIDTHMIDDLEDOT:Th,SEMI:Dh,SLASH:Ph,TILDE:Nh,UNDERSCORE:Ih,EMOJI:Mh,SYM:Lh});const Gh=/[a-z]/,zh=/\p{L}/u,Hh=/\p{Emoji}/u,Bh=/\d/,Vh=/\s/;let $h=null,Uh=null;function Wh(e,t){const o=function(e){const t=[],o=e.length;let n=0;for(;n<o;){let r,i=e.charCodeAt(n),a=i<55296||i>56319||n+1===o||(r=e.charCodeAt(n+1))<56320||r>57343?e[n]:e.slice(n,n+2);t.push(a),n+=a.length}return t}(t.replace(/[A-Z]/g,(e=>e.toLowerCase()))),n=o.length,r=[];let i=0,a=0;for(;a<n;){let s=e,l=null,c=0,d=null,u=-1,p=-1;for(;a<n&&(l=s.go(o[a]));)s=l,s.accepts()?(u=0,p=0,d=s):u>=0&&(u+=o[a].length,p++),c+=o[a].length,i+=o[a].length,a++;i-=u,a-=p,c-=u,r.push({t:d.t,v:t.slice(i-c,i),s:i-c,e:i})}return r}function qh(e,t,o,n,r){let i;const a=t.length;for(let s=0;s<a-1;s++){const o=t[s];e.j[o]?i=e.j[o]:(i=new Dp(n),i.jr=r.slice(),e.j[o]=i),e=i}return i=new Dp(o),i.jr=r.slice(),e.j[t[a-1]]=i,i}function Kh(e){const t=[],o=[];let n=0;for(;n<e.length;){let r=0;for(;"0123456789".indexOf(e[n+r])>=0;)r++;if(r>0){t.push(o.join(""));for(let t=parseInt(e.substring(n,n+r),10);t>0;t--)o.pop();n+=r}else o.push(e[n]),n++}return t}const Yh={defaultProtocol:"http",events:null,format:Xh,formatHref:Xh,nl2br:!1,tagName:"a",target:null,rel:null,validate:!0,truncate:1/0,className:null,attributes:null,ignoreTags:[],render:null};function Jh(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,o=bp({},Yh);e&&(o=bp(o,e instanceof Jh?e.o:e));const n=o.ignoreTags,r=[];for(let i=0;i<n.length;i++)r.push(n[i].toUpperCase());this.o=o,t&&(this.defaultRender=t),this.ignoreTags=r}function Xh(e){return e}Jh.prototype={o:Yh,ignoreTags:[],defaultRender:e=>e,check(e){return this.get("validate",e.toString(),e)},get(e,t,o){const n=null!=t;let r=this.o[e];return r?("object"===typeof r?(r=o.t in r?r[o.t]:Yh[e],"function"===typeof r&&n&&(r=r(t,o))):"function"===typeof r&&n&&(r=r(t,o.t,o)),r):r},getObj(e,t,o){let n=this.o[e];return"function"===typeof n&&null!=t&&(n=n(t,o.t,o)),n},render(e){const t=e.render(this);return(this.get("render",null,e)||this.defaultRender)(t,e.t,e)}};function Qh(e,t){this.t="token",this.v=e,this.tk=t}function Zh(e,t){class o extends Qh{constructor(t,o){super(t,o),this.t=e}}for(const n in t)o.prototype[n]=t[n];return o.t=e,o}Qh.prototype={isLink:!1,toString(){return this.v},toHref(e){return this.toString()},toFormattedString(e){const t=this.toString(),o=e.get("truncate",t,this),n=e.get("format",t,this);return o&&n.length>o?n.substring(0,o)+"\u2026":n},toFormattedHref(e){return e.get("formatHref",this.toHref(e.get("defaultProtocol")),this)},startIndex(){return this.tk[0].s},endIndex(){return this.tk[this.tk.length-1].e},toObject(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Yh.defaultProtocol;return{type:this.t,value:this.toString(),isLink:this.isLink,href:this.toHref(e),start:this.startIndex(),end:this.endIndex()}},toFormattedObject(e){return{type:this.t,value:this.toFormattedString(e),isLink:this.isLink,href:this.toFormattedHref(e),start:this.startIndex(),end:this.endIndex()}},validate(e){return e.get("validate",this.toString(),this)},render(e){const t=this,o=this.toHref(e.get("defaultProtocol")),n=e.get("formatHref",o,this),r=e.get("tagName",o,t),i=this.toFormattedString(e),a={},s=e.get("className",o,t),l=e.get("target",o,t),c=e.get("rel",o,t),d=e.getObj("attributes",o,t),u=e.getObj("events",o,t);return a.href=n,s&&(a.class=s),l&&(a.target=l),c&&(a.rel=c),d&&bp(a,d),{tagName:r,attributes:a,content:i,eventListeners:u}}};const ef=Zh("email",{isLink:!0,toHref(){return"mailto:"+this.toString()}}),tf=Zh("text"),of=Zh("nl"),nf=Zh("url",{isLink:!0,toHref(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Yh.defaultProtocol;return this.hasProtocol()?this.v:`${e}://${this.v}`},hasProtocol(){const e=this.tk;return e.length>=2&&e[0].t!==Hp&&e[1].t===vh}});const rf=e=>new Dp(e);function af(e,t,o){const n=o[0].s,r=o[o.length-1].e;return new e(t.slice(n,r),o)}const sf="undefined"!==typeof console&&console&&console.warn||(()=>{}),lf="until manual call of linkify.init(). Register all schemes and plugins before invoking linkify the first time.",cf={scanner:null,parser:null,tokenQueue:[],pluginQueue:[],customSchemes:[],initialized:!1};function df(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(cf.initialized&&sf(`linkifyjs: already initialized - will not register custom scheme "${e}" ${lf}`),!/^[0-9a-z]+(-[0-9a-z]+)*$/.test(e))throw new Error('linkifyjs: incorrect scheme format.\n1. Must only contain digits, lowercase ASCII letters or "-"\n2. Cannot start or end with "-"\n3. "-" cannot repeat');cf.customSchemes.push([e,t])}function uf(){cf.scanner=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];const t={};Dp.groups=t;const o=new Dp;null==$h&&($h=Kh("aaa1rp3bb0ott3vie4c1le2ogado5udhabi7c0ademy5centure6ountant0s9o1tor4d0s1ult4e0g1ro2tna4f0l1rica5g0akhan5ency5i0g1rbus3force5tel5kdn3l0ibaba4pay4lfinanz6state5y2sace3tom5m0azon4ericanexpress7family11x2fam3ica3sterdam8nalytics7droid5quan4z2o0l2partments8p0le4q0uarelle8r0ab1mco4chi3my2pa2t0e3s0da2ia2sociates9t0hleta5torney7u0ction5di0ble3o3spost5thor3o0s4w0s2x0a2z0ure5ba0by2idu3namex4d1k2r0celona5laycard4s5efoot5gains6seball5ketball8uhaus5yern5b0c1t1va3cg1n2d1e0ats2uty4er2ntley5rlin4st0buy5t2f1g1h0arti5i0ble3d1ke2ng0o3o1z2j1lack0friday9ockbuster8g1omberg7ue3m0s1w2n0pparibas9o0ats3ehringer8fa2m1nd2o0k0ing5sch2tik2on4t1utique6x2r0adesco6idgestone9oadway5ker3ther5ussels7s1t1uild0ers6siness6y1zz3v1w1y1z0h3ca0b1fe2l0l1vinklein9m0era3p2non3petown5ital0one8r0avan4ds2e0er0s4s2sa1e1h1ino4t0ering5holic7ba1n1re3c1d1enter4o1rn3f0a1d2g1h0anel2nel4rity4se2t2eap3intai5ristmas6ome4urch5i0priani6rcle4sco3tadel4i0c2y3k1l0aims4eaning6ick2nic1que6othing5ud3ub0med6m1n1o0ach3des3ffee4llege4ogne5m0mbank4unity6pany2re3uter5sec4ndos3struction8ulting7tact3ractors9oking4l1p2rsica5untry4pon0s4rses6pa2r0edit0card4union9icket5own3s1uise0s6u0isinella9v1w1x1y0mru3ou3z2dad1nce3ta1e1ing3sun4y2clk3ds2e0al0er2s3gree4livery5l1oitte5ta3mocrat6ntal2ist5si0gn4v2hl2iamonds6et2gital5rect0ory7scount3ver5h2y2j1k1m1np2o0cs1tor4g1mains5t1wnload7rive4tv2ubai3nlop4pont4rban5vag2r2z2earth3t2c0o2deka3u0cation8e1g1mail3erck5nergy4gineer0ing9terprises10pson4quipment8r0icsson6ni3s0q1tate5t1u0rovision8s2vents5xchange6pert3osed4ress5traspace10fage2il1rwinds6th3mily4n0s2rm0ers5shion4t3edex3edback6rrari3ero6i0delity5o2lm2nal1nce1ial7re0stone6mdale6sh0ing5t0ness6j1k1lickr3ghts4r2orist4wers5y2m1o0o0d1tball6rd1ex2sale4um3undation8x2r0ee1senius7l1ogans4ntier7tr2ujitsu5n0d2rniture7tbol5yi3ga0l0lery3o1up4me0s3p1rden4y2b0iz3d0n2e0a1nt0ing5orge5f1g0ee3h1i0ft0s3ves2ing5l0ass3e1obal2o4m0ail3bh2o1x2n1odaddy5ld0point6f2o0dyear5g0le4p1t1v2p1q1r0ainger5phics5tis4een3ipe3ocery4up4s1t1u0cci3ge2ide2tars5ru3w1y2hair2mburg5ngout5us3bo2dfc0bank7ealth0care8lp1sinki6re1mes5iphop4samitsu7tachi5v2k0t2m1n1ockey4ldings5iday5medepot5goods5s0ense7nda3rse3spital5t0ing5t0els3mail5use3w2r1sbc3t1u0ghes5yatt3undai7ibm2cbc2e1u2d1e0ee3fm2kano4l1m0amat4db2mo0bilien9n0c1dustries8finiti5o2g1k1stitute6urance4e4t0ernational10uit4vestments10o1piranga7q1r0ish4s0maili5t0anbul7t0au2v3jaguar4va3cb2e0ep2tzt3welry6io2ll2m0p2nj2o0bs1urg4t1y2p0morgan6rs3uegos4niper7kaufen5ddi3e0rryhotels6logistics9properties14fh2g1h1i0a1ds2m1ndle4tchen5wi3m1n1oeln3matsu5sher5p0mg2n2r0d1ed3uokgroup8w1y0oto4z2la0caixa5mborghini8er3ncaster6d0rover6xess5salle5t0ino3robe5w0yer5b1c1ds2ease3clerc5frak4gal2o2xus4gbt3i0dl2fe0insurance9style7ghting6ke2lly3mited4o2ncoln4k2psy3ve1ing5k1lc1p2oan0s3cker3us3l1ndon4tte1o3ve3pl0financial11r1s1t0d0a3u0ndbeck6xe1ury5v1y2ma0drid4if1son4keup4n0agement7go3p1rket0ing3s4riott5shalls7ttel5ba2c0kinsey7d1e0d0ia3et2lbourne7me1orial6n0u2rckmsd7g1h1iami3crosoft7l1ni1t2t0subishi9k1l0b1s2m0a2n1o0bi0le4da2e1i1m1nash3ey2ster5rmon3tgage6scow4to0rcycles9v0ie4p1q1r1s0d2t0n1r2u0seum3ic4v1w1x1y1z2na0b1goya4me2vy3ba2c1e0c1t0bank4flix4work5ustar5w0s2xt0direct7us4f0l2g0o2hk2i0co2ke1on3nja3ssan1y5l1o0kia3rton4w0ruz3tv4p1r0a1w2tt2u1yc2z2obi1server7ffice5kinawa6layan0group9lo3m0ega4ne1g1l0ine5oo2pen3racle3nge4g0anic5igins6saka4tsuka4t2vh3pa0ge2nasonic7ris2s1tners4s1y3y2ccw3e0t2f0izer5g1h0armacy6d1ilips5one2to0graphy6s4ysio5ics1tet2ures6d1n0g1k2oneer5zza4k1l0ace2y0station9umbing5s3m1n0c2ohl2ker3litie5rn2st3r0america6xi3ess3ime3o0d0uctions8f1gressive8mo2perties3y5tection8u0dential9s1t1ub2w0c2y2qa1pon3uebec3st5racing4dio4e0ad1lestate6tor2y4cipes5d0stone5umbrella9hab3ise0n3t2liance6n0t0als5pair3ort3ublican8st0aurant8view0s5xroth6ich0ardli6oh3l1o1p2o0cks3deo3gers4om3s0vp3u0gby3hr2n2w0e2yukyu6sa0arland6fe0ty4kura4le1on3msclub4ung5ndvik0coromant12ofi4p1rl2s1ve2xo3b0i1s2c0b1haeffler7midt4olarships8ol3ule3warz5ience5ot3d1e0arch3t2cure1ity6ek2lect4ner3rvices6ven3w1x0y3fr2g1h0angrila6rp3ell3ia1ksha5oes2p0ping5uji3w3i0lk2na1gles5te3j1k0i0n2y0pe4l0ing4m0art3ile4n0cf3o0ccer3ial4ftbank4ware6hu2lar2utions7ng1y2y2pa0ce3ort2t3r0l2s1t0ada2ples4r1tebank4farm7c0group6ockholm6rage3e3ream4udio2y3yle4u0cks3pplies3y2ort5rf1gery5zuki5v1watch4iss4x1y0dney4stems6z2tab1ipei4lk2obao4rget4tamotors6r2too4x0i3c0i2d0k2eam2ch0nology8l1masek5nnis4va3f1g1h0d1eater2re6iaa2ckets5enda4ps2res2ol4j0maxx4x2k0maxx5l1m0all4n1o0day3kyo3ols3p1ray3shiba5tal3urs3wn2yota3s3r0ade1ing4ining5vel0ers0insurance16ust3v2t1ube2i1nes3shu4v0s2w1z2ua1bank3s2g1k1nicom3versity8o2ol2ps2s1y1z2va0cations7na1guard7c1e0gas3ntures6risign5m\xf6gensberater2ung14sicherung10t2g1i0ajes4deo3g1king4llas4n1p1rgin4sa1ion4va1o3laanderen9n1odka3lvo3te1ing3o2yage5u2wales2mart4ter4ng0gou5tch0es6eather0channel12bcam3er2site5d0ding5ibo2r3f1hoswho6ien2ki2lliamhill9n0dows4e1ners6me2olterskluwer11odside6rk0s2ld3w2s1tc1f3xbox3erox4ihuan4n2xx2yz3yachts4hoo3maxun5ndex5e1odobashi7ga2kohama6u0tube6t1un3za0ppos4ra3ero3ip2m1one3uerich6w2")),null==Uh&&(Uh=Kh("\u03b5\u03bb1\u03c52\u0431\u04331\u0435\u043b3\u0434\u0435\u0442\u04384\u0435\u044e2\u043a\u0430\u0442\u043e\u043b\u0438\u043a6\u043e\u043c3\u043c\u043a\u04342\u043e\u043d1\u0441\u043a\u0432\u04306\u043e\u043d\u043b\u0430\u0439\u043d5\u0440\u04333\u0440\u0443\u04412\u04442\u0441\u0430\u0439\u04423\u0440\u04313\u0443\u043a\u04403\u049b\u0430\u04373\u0570\u0561\u05753\u05d9\u05e9\u05e8\u05d0\u05dc5\u05e7\u05d5\u05dd3\u0627\u0628\u0648\u0638\u0628\u064a5\u0631\u0627\u0645\u0643\u06485\u0644\u0627\u0631\u062f\u06464\u0628\u062d\u0631\u064a\u06465\u062c\u0632\u0627\u0626\u06315\u0633\u0639\u0648\u062f\u064a\u06296\u0639\u0644\u064a\u0627\u06465\u0645\u063a\u0631\u06285\u0645\u0627\u0631\u0627\u062a5\u06cc\u0631\u0627\u06465\u0628\u0627\u0631\u062a2\u0632\u0627\u06314\u064a\u062a\u06433\u06be\u0627\u0631\u062a5\u062a\u0648\u0646\u06334\u0633\u0648\u062f\u0627\u06463\u0631\u064a\u06295\u0634\u0628\u0643\u06294\u0639\u0631\u0627\u06422\u06282\u0645\u0627\u06464\u0641\u0644\u0633\u0637\u064a\u06466\u0642\u0637\u06313\u0643\u0627\u062b\u0648\u0644\u064a\u06436\u0648\u06453\u0645\u0635\u06312\u0644\u064a\u0633\u064a\u06275\u0648\u0631\u064a\u062a\u0627\u0646\u064a\u06277\u0642\u06394\u0647\u0645\u0631\u0627\u06475\u067e\u0627\u06a9\u0633\u062a\u0627\u06467\u0680\u0627\u0631\u062a4\u0915\u0949\u092e3\u0928\u0947\u091f3\u092d\u093e\u0930\u09240\u092e\u094d3\u094b\u09245\u0938\u0902\u0917\u0920\u09285\u09ac\u09be\u0982\u09b2\u09be5\u09ad\u09be\u09b0\u09a42\u09f0\u09a44\u0a2d\u0a3e\u0a30\u0a244\u0aad\u0abe\u0ab0\u0aa44\u0b2d\u0b3e\u0b30\u0b244\u0b87\u0ba8\u0bcd\u0ba4\u0bbf\u0baf\u0bbe6\u0bb2\u0b99\u0bcd\u0b95\u0bc86\u0b9a\u0bbf\u0b99\u0bcd\u0b95\u0baa\u0bcd\u0baa\u0bc2\u0bb0\u0bcd11\u0c2d\u0c3e\u0c30\u0c24\u0c4d5\u0cad\u0cbe\u0cb0\u0ca44\u0d2d\u0d3e\u0d30\u0d24\u0d025\u0dbd\u0d82\u0d9a\u0dcf4\u0e04\u0e2d\u0e213\u0e44\u0e17\u0e223\u0ea5\u0eb2\u0ea73\u10d2\u10d42\u307f\u3093\u306a3\u30a2\u30de\u30be\u30f34\u30af\u30e9\u30a6\u30c94\u30b0\u30fc\u30b0\u30eb4\u30b3\u30e02\u30b9\u30c8\u30a23\u30bb\u30fc\u30eb3\u30d5\u30a1\u30c3\u30b7\u30e7\u30f36\u30dd\u30a4\u30f3\u30c84\u4e16\u754c2\u4e2d\u4fe11\u56fd1\u570b1\u6587\u7f513\u4e9a\u9a6c\u900a3\u4f01\u4e1a2\u4f5b\u5c712\u4fe1\u606f2\u5065\u5eb72\u516b\u53662\u516c\u53f81\u76ca2\u53f0\u6e7e1\u70632\u5546\u57ce1\u5e971\u68072\u5609\u91cc0\u5927\u9152\u5e975\u5728\u7ebf2\u5927\u62ff2\u5929\u4e3b\u65593\u5a31\u4e502\u5bb6\u96fb2\u5e7f\u4e1c2\u5fae\u535a2\u6148\u55842\u6211\u7231\u4f603\u624b\u673a2\u62db\u80582\u653f\u52a11\u5e9c2\u65b0\u52a0\u57612\u95fb2\u65f6\u5c1a2\u66f8\u7c4d2\u673a\u67842\u6de1\u9a6c\u95213\u6e38\u620f2\u6fb3\u95802\u70b9\u770b2\u79fb\u52a82\u7ec4\u7ec7\u673a\u67844\u7f51\u57401\u5e971\u7ad91\u7edc2\u8054\u901a2\u8c37\u6b4c2\u8d2d\u72692\u901a\u8ca92\u96c6\u56e22\u96fb\u8a0a\u76c8\u79d14\u98de\u5229\u6d663\u98df\u54c12\u9910\u53852\u9999\u683c\u91cc\u62c93\u6e2f2\ub2f7\ub1371\ucef42\uc0bc\uc1312\ud55c\uad6d2")),Mp(o,"'",ph),Mp(o,"{",Yp),Mp(o,"}",Jp),Mp(o,"[",Xp),Mp(o,"]",Qp),Mp(o,"(",Zp),Mp(o,")",eh),Mp(o,"<",th),Mp(o,">",oh),Mp(o,"\uff08",nh),Mp(o,"\uff09",rh),Mp(o,"\u300c",ih),Mp(o,"\u300d",ah),Mp(o,"\u300e",sh),Mp(o,"\u300f",lh),Mp(o,"\uff1c",ch),Mp(o,"\uff1e",dh),Mp(o,"&",uh),Mp(o,"*",hh),Mp(o,"@",fh),Mp(o,"`",mh),Mp(o,"^",yh),Mp(o,":",vh),Mp(o,",",bh),Mp(o,"$",xh),Mp(o,".",wh),Mp(o,"=",Ch),Mp(o,"!",_h),Mp(o,"-",Sh),Mp(o,"%",Eh),Mp(o,"|",kh),Mp(o,"+",jh),Mp(o,"#",Ah),Mp(o,"?",Rh),Mp(o,'"',Oh),Mp(o,"/",Ph),Mp(o,";",Dh),Mp(o,"~",Nh),Mp(o,"_",Ih),Mp(o,"\\",gh),Mp(o,"\u30fb",Th);const n=Np(o,Bh,Wp,{[xp]:!0});Np(n,Bh,n);const r=Np(n,Gh,Gp,{[_p]:!0}),i=Np(n,zh,zp,{[Sp]:!0}),a=Np(o,Gh,Lp,{[wp]:!0});Np(a,Bh,r),Np(a,Gh,a),Np(r,Bh,r),Np(r,Gh,r);const s=Np(o,zh,Fp,{[Cp]:!0});Np(s,Gh),Np(s,Bh,i),Np(s,zh,s),Np(i,Bh,i),Np(i,Gh),Np(i,zh,i);const l=Mp(o,"\n",Kp,{[Rp]:!0}),c=Mp(o,"\r",qp,{[Rp]:!0}),d=Np(o,Vh,qp,{[Rp]:!0});Mp(o,"\ufffc",d),Mp(c,"\n",l),Mp(c,"\ufffc",d),Np(c,Vh,d),Mp(d,"\r"),Mp(d,"\n"),Np(d,Vh,d),Mp(d,"\ufffc",d);const u=Np(o,Hh,Mh,{[kp]:!0});Mp(u,"#"),Np(u,Hh,u),Mp(u,"\ufe0f",u);const p=Mp(u,"\u200d");Mp(p,"#"),Np(p,Hh,u);const h=[[Gh,a],[Bh,r]],f=[[Gh,null],[zh,s],[Bh,i]];for(let g=0;g<$h.length;g++)qh(o,$h[g],Bp,Lp,h);for(let g=0;g<Uh.length;g++)qh(o,Uh[g],Vp,Fp,f);Tp(Bp,{tld:!0,ascii:!0},t),Tp(Vp,{utld:!0,alpha:!0},t),qh(o,"file",$p,Lp,h),qh(o,"mailto",$p,Lp,h),qh(o,"http",Up,Lp,h),qh(o,"https",Up,Lp,h),qh(o,"ftp",Up,Lp,h),qh(o,"ftps",Up,Lp,h),Tp($p,{scheme:!0,ascii:!0},t),Tp(Up,{slashscheme:!0,ascii:!0},t),e=e.sort(((e,t)=>e[0]>t[0]?1:-1));for(let g=0;g<e.length;g++){const t=e[g][0],n=e[g][1]?{[jp]:!0}:{[Ap]:!0};t.indexOf("-")>=0?n[Ep]=!0:Gh.test(t)?Bh.test(t)?n[_p]=!0:n[wp]=!0:n[xp]=!0,Ip(o,t,t,n)}return Ip(o,"localhost",Hp,{ascii:!0}),o.jd=new Dp(Lh),{start:o,tokens:bp({groups:t},Fh)}}(cf.customSchemes);for(let e=0;e<cf.tokenQueue.length;e++)cf.tokenQueue[e][1]({scanner:cf.scanner});cf.parser=function(e){let{groups:t}=e;const o=t.domain.concat([uh,hh,fh,gh,mh,yh,xh,Ch,Sh,Wp,Eh,kh,jh,Ah,Ph,Lh,Nh,Ih]),n=[vh,bh,wh,_h,Eh,Rh,Oh,Dh,th,oh,Yp,Jp,Qp,Xp,Zp,eh,nh,rh,ih,ah,sh,lh,ch,dh],r=[uh,ph,hh,gh,mh,yh,xh,Ch,Sh,Yp,Jp,Eh,kh,jh,Ah,Rh,Ph,Lh,Nh,Ih],i=rf(),a=Mp(i,Nh);Pp(a,r,a),Pp(a,t.domain,a);const s=rf(),l=rf(),c=rf();Pp(i,t.domain,s),Pp(i,t.scheme,l),Pp(i,t.slashscheme,c),Pp(s,r,a),Pp(s,t.domain,s);const d=Mp(s,fh);Mp(a,fh,d),Mp(l,fh,d),Mp(c,fh,d);const u=Mp(a,wh);Pp(u,r,a),Pp(u,t.domain,a);const p=rf();Pp(d,t.domain,p),Pp(p,t.domain,p);const h=Mp(p,wh);Pp(h,t.domain,p);const f=rf(ef);Pp(h,t.tld,f),Pp(h,t.utld,f),Mp(d,Hp,f);const g=Mp(p,Sh);Mp(g,Sh,g),Pp(g,t.domain,p),Pp(f,t.domain,p),Mp(f,wh,h),Mp(f,Sh,g);const m=Mp(f,vh);Pp(m,t.numeric,ef);const y=Mp(s,Sh),v=Mp(s,wh);Mp(y,Sh,y),Pp(y,t.domain,s),Pp(v,r,a),Pp(v,t.domain,s);const b=rf(nf);Pp(v,t.tld,b),Pp(v,t.utld,b),Pp(b,t.domain,s),Pp(b,r,a),Mp(b,wh,v),Mp(b,Sh,y),Mp(b,fh,d);const x=Mp(b,vh),w=rf(nf);Pp(x,t.numeric,w);const C=rf(nf),_=rf();Pp(C,o,C),Pp(C,n,_),Pp(_,o,C),Pp(_,n,_),Mp(b,Ph,C),Mp(w,Ph,C);const S=Mp(l,vh),E=Mp(c,vh),k=Mp(E,Ph),j=Mp(k,Ph);Pp(l,t.domain,s),Mp(l,wh,v),Mp(l,Sh,y),Pp(c,t.domain,s),Mp(c,wh,v),Mp(c,Sh,y),Pp(S,t.domain,C),Mp(S,Ph,C),Mp(S,Rh,C),Pp(j,t.domain,C),Pp(j,o,C),Mp(j,Ph,C);const A=[[Yp,Jp],[Xp,Qp],[Zp,eh],[th,oh],[nh,rh],[ih,ah],[sh,lh],[ch,dh]];for(let R=0;R<A.length;R++){const[e,t]=A[R],r=Mp(C,e);Mp(_,e,r),Mp(r,t,C);const i=rf(nf);Pp(r,o,i);const a=rf();Pp(r,n),Pp(i,o,i),Pp(i,n,a),Pp(a,o,i),Pp(a,n,a),Mp(i,t,C),Mp(a,t,C)}return Mp(i,Hp,b),Mp(i,Kp,of),{start:i,tokens:Fh}}(cf.scanner.tokens);for(let e=0;e<cf.pluginQueue.length;e++)cf.pluginQueue[e][1]({scanner:cf.scanner,parser:cf.parser});return cf.initialized=!0,cf}function pf(e){return cf.initialized||uf(),function(e,t,o){let n=o.length,r=0,i=[],a=[];for(;r<n;){let s=e,l=null,c=null,d=0,u=null,p=-1;for(;r<n&&!(l=s.go(o[r].t));)a.push(o[r++]);for(;r<n&&(c=l||s.go(o[r].t));)l=null,s=c,s.accepts()?(p=0,u=s):p>=0&&p++,r++,d++;if(p<0)r-=d,r<n&&(a.push(o[r]),r++);else{a.length>0&&(i.push(af(tf,t,a)),a=[]),r-=p,d-=p;const e=u.t,n=o.slice(r-d,r);i.push(af(e,t,n))}}return a.length>0&&i.push(af(tf,t,a)),i}(cf.parser.start,e,Wh(cf.scanner.start,e))}function hf(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;if(t&&"object"===typeof t){if(o)throw Error(`linkifyjs: Invalid link type ${t}; must be a string`);o=t,t=null}const n=new Jh(o),r=pf(e),i=[];for(let a=0;a<r.length;a++){const e=r[a];!e.isLink||t&&e.t!==t||!n.check(e)||i.push(e.toFormattedObject(n))}return i}function ff(e){return new ii({key:new li("autolink"),appendTransaction:(t,o,n)=>{const r=t.some((e=>e.docChanged))&&!o.doc.eq(n.doc),i=t.some((e=>e.getMeta("preventAutolink")));if(!r||i)return;const{tr:a}=n,s=function(e,t){const o=new Fr(e);return t.forEach((e=>{e.steps.forEach((e=>{o.step(e)}))})),o}(o.doc,[...t]),l=function(e){const{mapping:t,steps:o}=e,n=[];return t.maps.forEach(((e,r)=>{const i=[];if(e.ranges.length)e.forEach(((e,t)=>{i.push({from:e,to:t})}));else{const{from:e,to:t}=o[r];if(void 0===e||void 0===t)return;i.push({from:e,to:t})}i.forEach((e=>{let{from:o,to:i}=e;const a=t.slice(r).map(o,-1),s=t.slice(r).map(i),l=t.invert().map(a,-1),c=t.invert().map(s);n.push({oldRange:{from:l,to:c},newRange:{from:a,to:s}})}))})),pd(n)}(s);return l.forEach((t=>{let{newRange:o}=t;const r=function(e,t,o){const n=[];return e.nodesBetween(t.from,t.to,((e,t)=>{o(e)&&n.push({node:e,pos:t})})),n}(n.doc,o,(e=>e.isTextblock));let i,s;if(r.length>1?(i=r[0],s=n.doc.textBetween(i.pos,i.pos+i.node.nodeSize,void 0," ")):r.length&&n.doc.textBetween(o.from,o.to," "," ").endsWith(" ")&&(i=r[0],s=n.doc.textBetween(i.pos,o.to,void 0," ")),i&&s){const t=s.split(" ").filter((e=>""!==e));if(t.length<=0)return!1;const o=t[t.length-1],r=i.pos+s.lastIndexOf(o);if(!o)return!1;const c=pf(o).map((t=>t.toObject(e.defaultProtocol)));if(!(1===(l=c).length?l[0].isLink:3===l.length&&l[1].isLink&&["()","[]"].includes(l[0].value+l[2].value)))return!1;c.filter((e=>e.isLink)).map((e=>({...e,from:r+e.start+1,to:r+e.end+1}))).filter((e=>!n.schema.marks.code||!n.doc.rangeHasMark(e.from,e.to,n.schema.marks.code))).filter((t=>e.validate(t.value))).filter((t=>e.shouldAutoLink(t.value))).forEach((t=>{hd(t.from,t.to,n.doc).some((t=>t.mark.type===e.type))||a.addMark(t.from,t.to,e.type.create({href:t.href}))}))}var l})),a.steps.length?a:void 0}})}pf.scan=Wh;const gf=/[\u0000-\u0020\u00A0\u1680\u180E\u2000-\u2029\u205F\u3000]/g;function mf(e,t){const o=["http","https","ftp","ftps","mailto","tel","callto","sms","cid","xmpp"];return t&&t.forEach((e=>{const t="string"===typeof e?e:e.scheme;t&&o.push(t)})),!e||e.replace(gf,"").match(new RegExp(`^(?:(?:${o.join("|")}):|[^a-z]|[a-z0-9+.-]+(?:[^a-z+.-:]|$))`,"i"))}const yf=Nc.create({name:"link",priority:1e3,keepOnSplit:!1,exitable:!0,onCreate(){this.options.validate&&!this.options.shouldAutoLink&&(this.options.shouldAutoLink=this.options.validate,console.warn("The `validate` option is deprecated. Rename to the `shouldAutoLink` option instead.")),this.options.protocols.forEach((e=>{"string"!==typeof e?df(e.scheme,e.optionalSlashes):df(e)}))},onDestroy(){Dp.groups={},cf.scanner=null,cf.parser=null,cf.tokenQueue=[],cf.pluginQueue=[],cf.customSchemes=[],cf.initialized=!1},inclusive(){return this.options.autolink},addOptions:()=>({openOnClick:!0,linkOnPaste:!0,autolink:!0,protocols:[],defaultProtocol:"http",HTMLAttributes:{target:"_blank",rel:"noopener noreferrer nofollow",class:null},isAllowedUri:(e,t)=>!!mf(e,t.protocols),validate:e=>!!e,shouldAutoLink:e=>!!e}),addAttributes(){return{href:{default:null,parseHTML:e=>e.getAttribute("href")},target:{default:this.options.HTMLAttributes.target},rel:{default:this.options.HTMLAttributes.rel},class:{default:this.options.HTMLAttributes.class}}},parseHTML(){return[{tag:"a[href]",getAttrs:e=>{const t=e.getAttribute("href");return!(!t||!this.options.isAllowedUri(t,{defaultValidate:e=>!!mf(e,this.options.protocols),protocols:this.options.protocols,defaultProtocol:this.options.defaultProtocol}))&&null}}]},renderHTML(e){let{HTMLAttributes:t}=e;return this.options.isAllowedUri(t.href,{defaultValidate:e=>!!mf(e,this.options.protocols),protocols:this.options.protocols,defaultProtocol:this.options.defaultProtocol})?["a",vc(this.options.HTMLAttributes,t),0]:["a",vc(this.options.HTMLAttributes,{...t,href:""}),0]},addCommands(){return{setLink:e=>t=>{let{chain:o}=t;const{href:n}=e;return!!this.options.isAllowedUri(n,{defaultValidate:e=>!!mf(e,this.options.protocols),protocols:this.options.protocols,defaultProtocol:this.options.defaultProtocol})&&o().setMark(this.name,e).setMeta("preventAutolink",!0).run()},toggleLink:e=>t=>{let{chain:o}=t;const{href:n}=e;return!!this.options.isAllowedUri(n,{defaultValidate:e=>!!mf(e,this.options.protocols),protocols:this.options.protocols,defaultProtocol:this.options.defaultProtocol})&&o().toggleMark(this.name,e,{extendEmptyMarkRange:!0}).setMeta("preventAutolink",!0).run()},unsetLink:()=>e=>{let{chain:t}=e;return t().unsetMark(this.name,{extendEmptyMarkRange:!0}).setMeta("preventAutolink",!0).run()}}},addPasteRules(){return[Id({find:e=>{const t=[];if(e){const{protocols:o,defaultProtocol:n}=this.options,r=hf(e).filter((e=>e.isLink&&this.options.isAllowedUri(e.value,{defaultValidate:e=>!!mf(e,o),protocols:o,defaultProtocol:n})));r.length&&r.forEach((e=>t.push({text:e.value,data:{href:e.href},index:e.start})))}return t},type:this.type,getAttributes:e=>{var t;return{href:null===(t=e.data)||void 0===t?void 0:t.href}}})]},addProseMirrorPlugins(){const e=[],{protocols:t,defaultProtocol:o}=this.options;var n;return this.options.autolink&&e.push(ff({type:this.type,defaultProtocol:this.options.defaultProtocol,validate:e=>this.options.isAllowedUri(e,{defaultValidate:e=>!!mf(e,t),protocols:t,defaultProtocol:o}),shouldAutoLink:this.options.shouldAutoLink})),!0===this.options.openOnClick&&e.push((n={type:this.type},new ii({key:new li("handleClickLink"),props:{handleClick:(e,t,o)=>{var r,i;if(0!==o.button)return!1;if(!e.editable)return!1;let a=o.target;const s=[];for(;"DIV"!==a.nodeName;)s.push(a),a=a.parentNode;if(!s.find((e=>"A"===e.nodeName)))return!1;const l=ud(e.state,n.type.name),c=o.target,d=null!==(r=null===c||void 0===c?void 0:c.href)&&void 0!==r?r:l.href,u=null!==(i=null===c||void 0===c?void 0:c.target)&&void 0!==i?i:l.target;return!(!c||!d)&&(window.open(d,u),!0)}}}))),this.options.linkOnPaste&&e.push(function(e){return new ii({key:new li("handlePasteLink"),props:{handlePaste:(t,o,n)=>{const{state:r}=t,{selection:i}=r,{empty:a}=i;if(a)return!1;let s="";n.content.forEach((e=>{s+=e.textContent}));const l=hf(s,{defaultProtocol:e.defaultProtocol}).find((e=>e.isLink&&e.value===s));return!(!s||!l)&&e.editor.commands.setMark(e.type,{href:l.href})}}})}({editor:this.editor,defaultProtocol:this.options.defaultProtocol,type:this.type})),e}}),vf=P.Ay.div`
  padding: 0 24px;
`,bf=P.Ay.div`
  display: flex;
  justify-content: space-between;
  align-items: center;
  margin-bottom: 24px;
`,xf=P.Ay.h3`
  margin: 0;
  font-size: 18px;
  font-weight: 600;
`,wf=P.Ay.button`
  display: inline-flex;
  align-items: center;
  gap: 8px;
  padding: 8px 16px;
  color: white;
  background-color: ${e=>e.secondary?"#6c757d":"#000000"};
  border: none;
  border-radius: 4px;
  font-size: 14px;
  cursor: pointer;
  transition: all 0.2s;

  &:hover {
    background-color: ${e=>e.secondary?"#5a6268":"#333333"};
  }

  &:disabled {
    background-color: #e9ecef;
    color: #6c757d;
    cursor: not-allowed;
  }
`,Cf=P.Ay.div`
  display: flex;
  flex-direction: column;
  gap: 16px;
  margin-bottom: 20px;
`,_f=P.Ay.div`
  padding: 16px;
  border: 1px solid #e5e7eb;
  border-radius: 8px;
  background-color: white;
`,Sf=P.Ay.div`
  display: flex;
  justify-content: space-between;
  align-items: center;
  margin-bottom: 12px;
  padding-bottom: 8px;
  border-bottom: 1px solid #f3f4f6;
`,Ef=P.Ay.h4`
  margin: 0;
  font-size: 16px;
  font-weight: 500;
  color: #111827;
`,kf=P.Ay.div`
  display: flex;
  align-items: center;
  gap: 4px;
  font-size: 12px;
  color: #6b7280;
`,jf=P.Ay.div`
  font-size: 14px;
  color: #374151;
  line-height: 1.5;
  
  .ProseMirror {
    outline: none;
    
    ul, ol {
      padding-left: 1rem;
    }
    
    p {
      margin: 0.5rem 0;
    }
    
    h1, h2, h3 {
      margin-top: 1rem;
      margin-bottom: 0.5rem;
    }
    
    blockquote {
      border-left: 3px solid #e5e7eb;
      padding-left: 1rem;
      color: #6b7280;
      margin-left: 0;
    }
  }
`,Af=P.Ay.div`
  display: flex;
  justify-content: flex-end;
  gap: 8px;
  margin-top: 12px;
`,Rf=P.Ay.button`
  display: inline-flex;
  align-items: center;
  justify-content: center;
  padding: 4px;
  background: none;
  border: none;
  color: #6b7280;
  cursor: pointer;
  transition: all 0.2s;
  border-radius: 4px;
  
  &:hover {
    color: ${e=>e.delete?"#ef4444":"#000000"};
    background-color: ${e=>e.delete?"#fee2e2":"#f3f4f6"};
  }
`,Of=P.Ay.div`
  margin-top: 20px;
  border: 1px solid #e5e7eb;
  border-radius: 8px;
  overflow: hidden;
`,Tf=P.Ay.div`
  display: flex;
  background-color: #f9fafb;
  padding: 8px 12px;
  border-bottom: 1px solid #e5e7eb;
`,Df=P.Ay.button`
  display: inline-flex;
  align-items: center;
  justify-content: center;
  padding: 4px 8px;
  background: none;
  border: none;
  color: #374151;
  font-size: 14px;
  cursor: pointer;
  border-radius: 4px;
  margin-right: 4px;
  
  &:hover {
    background-color: #f3f4f6;
  }
  
  &.is-active {
    background-color: #e5e7eb;
    color: #111827;
  }
`,Pf=P.Ay.div`
  padding: 16px;
  background-color: white;
  
  .ProseMirror {
    min-height: 150px;
    outline: none;
    
    ul, ol {
      padding-left: 1rem;
    }
    
    p {
      margin: 0.5rem 0;
    }
    
    h1, h2, h3 {
      margin-top: 1rem;
      margin-bottom: 0.5rem;
    }
    
    blockquote {
      border-left: 3px solid #e5e7eb;
      padding-left: 1rem;
      color: #6b7280;
      margin-left: 0;
    }
  }
`,Nf=P.Ay.input`
  width: 100%;
  padding: 8px 12px;
  border: 1px solid #e5e7eb;
  border-radius: 4px;
  font-size: 14px;
  margin-bottom: 12px;
  
  &:focus {
    outline: none;
    border-color: #000000;
    box-shadow: 0 0 0 2px rgba(0, 0, 0, 0.1);
  }
`,If=P.Ay.div`
  display: flex;
  justify-content: flex-end;
  gap: 8px;
  margin-top: 16px;
`,Mf=P.Ay.div`
  text-align: center;
  padding: 40px 20px;
  color: #6b7280;
  font-size: 14px;
`,Lf=e=>{let{editor:t}=e;return t?(0,N.jsxs)(Tf,{children:[(0,N.jsx)(Df,{onClick:()=>t.chain().focus().toggleBold().run(),className:t.isActive("bold")?"is-active":"",children:"Bold"}),(0,N.jsx)(Df,{onClick:()=>t.chain().focus().toggleItalic().run(),className:t.isActive("italic")?"is-active":"",children:"Italic"}),(0,N.jsx)(Df,{onClick:()=>t.chain().focus().toggleBulletList().run(),className:t.isActive("bulletList")?"is-active":"",children:"Bullet List"}),(0,N.jsx)(Df,{onClick:()=>t.chain().focus().toggleOrderedList().run(),className:t.isActive("orderedList")?"is-active":"",children:"Numbered List"}),(0,N.jsx)(Df,{onClick:()=>t.chain().focus().toggleHeading({level:3}).run(),className:t.isActive("heading",{level:3})?"is-active":"",children:"Heading"}),(0,N.jsx)(Df,{onClick:()=>t.chain().focus().toggleBlockquote().run(),className:t.isActive("blockquote")?"is-active":"",children:"Quote"})]}):null},Ff=e=>{if(!e)return"<p>No content</p>";if("string"===typeof e)return e;try{if("doc"===e.type&&e.content&&Array.isArray(e.content)){let t="";return e.content.forEach((e=>{if("paragraph"===e.type&&e.content&&Array.isArray(e.content))t+="<p>",e.content.forEach((e=>{let o=e.text||"";e.marks&&Array.isArray(e.marks)&&e.marks.forEach((e=>{"bold"===e.type&&(o=`<strong>${o}</strong>`),"italic"===e.type&&(o=`<em>${o}</em>`)})),t+=o})),t+="</p>";else if("heading"===e.type&&e.content&&Array.isArray(e.content)){var o;const n=(null===(o=e.attrs)||void 0===o?void 0:o.level)||3;t+=`<h${n}>`,e.content.forEach((e=>{t+=e.text||""})),t+=`</h${n}>`}else"bulletList"===e.type&&e.content&&Array.isArray(e.content)&&(t+="<ul>",e.content.forEach((e=>{"listItem"===e.type&&e.content&&Array.isArray(e.content)&&(t+="<li>",e.content.forEach((e=>{"paragraph"===e.type&&e.content&&Array.isArray(e.content)&&e.content.forEach((e=>{t+=e.text||""}))})),t+="</li>")})),t+="</ul>")})),t||"<p>No content</p>"}}catch(t){return console.error("Error rendering note content:",t),"<p>Error displaying note content</p>"}return"<p>Unknown content format</p>"},Gf=e=>{let{contact:o}=e;const[n,r]=(0,t.useState)([]),[i,a]=(0,t.useState)(!0),[s,l]=(0,t.useState)(!1),[c,d]=(0,t.useState)(null),[u,p]=(0,t.useState)(""),h=ou({extensions:[vp,yf.configure({openOnClick:!1})],content:"<p>Start writing your note here...</p>"}),f=async()=>{if(null!==o&&void 0!==o&&o.id){a(!0);try{const{data:e,error:t}=await D.supabase.from("notes_contacts").select("note_id").eq("contact_id",o.id);if(t)throw t;if(!e||0===e.length)return r([]),void a(!1);const n=e.map((e=>e.note_id)),{data:i,error:s}=await D.supabase.from("notes").select("*").in("id",n).order("created_at",{ascending:!1});if(s)throw s;r(i||[])}catch(e){console.error("Error fetching notes:",e),nt.oR.error("Failed to load notes")}finally{a(!1)}}},g=e=>{if(!e)return"Unknown";return new Date(e).toLocaleDateString("en-GB",{day:"2-digit",month:"2-digit",year:"numeric",hour:"2-digit",minute:"2-digit"})};return(0,t.useEffect)((()=>{null!==o&&void 0!==o&&o.id&&f()}),[null===o||void 0===o?void 0:o.id]),!i||s||c?(0,N.jsxs)(vf,{children:[(0,N.jsxs)(bf,{children:[(0,N.jsx)(xf,{children:"Notes"}),!s&&!c&&(0,N.jsxs)(wf,{onClick:()=>l(!0),children:[(0,N.jsx)(B.GGD,{size:16}),"Add New Note"]})]}),(s||c)&&(0,N.jsxs)("div",{children:[(0,N.jsx)(Nf,{type:"text",placeholder:"Note Title",value:u,onChange:e=>p(e.target.value)}),(0,N.jsxs)(Of,{children:[(0,N.jsx)(Lf,{editor:h}),(0,N.jsx)(Pf,{children:(0,N.jsx)(Ud,{editor:h})})]}),(0,N.jsxs)(If,{children:[(0,N.jsxs)(wf,{secondary:!0,onClick:()=>{l(!1),d(null),p(""),h&&h.commands.clearContent()},children:[(0,N.jsx)(B.yGN,{size:16}),"Cancel"]}),(0,N.jsxs)(wf,{onClick:c?async()=>{if(c&&h)try{const e=h.getJSON(),{error:t}=await D.supabase.from("notes").update({title:u||"Untitled Note",content:e}).eq("id",c);if(t)throw t;h.commands.clearContent(),p(""),d(null),f(),nt.oR.success("Note updated successfully")}catch(e){console.error("Error updating note:",e),nt.oR.error("Failed to update note")}}:async()=>{if(null!==o&&void 0!==o&&o.id&&h)try{const e=h.getJSON(),{data:t,error:n}=await D.supabase.from("notes").insert({title:u||"Untitled Note",content:e}).select().single();if(n)throw n;const{error:r}=await D.supabase.from("notes_contacts").insert({note_id:t.id,contact_id:o.id});if(r)throw r;h.commands.clearContent(),p(""),l(!1),f(),nt.oR.success("Note created successfully")}catch(e){console.error("Error creating note:",e),nt.oR.error("Failed to create note")}},children:[(0,N.jsx)(B.Bc_,{size:16}),c?"Update Note":"Save Note"]})]})]}),!s&&!c&&(0,N.jsx)(N.Fragment,{children:n.length>0?(0,N.jsx)(Cf,{children:n.map((e=>(0,N.jsxs)(_f,{children:[(0,N.jsxs)(Sf,{children:[(0,N.jsx)(Ef,{children:e.title}),(0,N.jsxs)(kf,{children:[(0,N.jsx)(B.Ohp,{size:12}),g(e.created_at)]})]}),(0,N.jsx)(jf,{children:(0,N.jsx)("div",{className:"ProseMirror",dangerouslySetInnerHTML:{__html:Ff(e.content)}})}),(0,N.jsxs)(Af,{children:[(0,N.jsx)(Rf,{onClick:()=>(e=>{d(e.id),p(e.title),h&&h.commands.setContent(e.content)})(e),children:(0,N.jsx)(B.WXf,{size:16})}),(0,N.jsx)(Rf,{delete:!0,onClick:()=>(async e=>{if(e&&window.confirm("Are you sure you want to delete this note?"))try{const{error:t}=await D.supabase.from("notes").delete().eq("id",e);if(t)throw t;f(),nt.oR.success("Note deleted successfully")}catch(t){console.error("Error deleting note:",t),nt.oR.error("Failed to delete note")}})(e.id),children:(0,N.jsx)(B.IXo,{size:16})})]})]},e.id)))}):(0,N.jsxs)(Mf,{children:[(0,N.jsx)("p",{children:"No notes found for this contact."}),(0,N.jsx)("p",{children:'Click "Add New Note" to create one.'})]})})]}):(0,N.jsxs)(vf,{children:[(0,N.jsx)(bf,{children:(0,N.jsx)(xf,{children:"Notes"})}),(0,N.jsx)("div",{style:{textAlign:"center",padding:"40px 0"},children:"Loading notes..."})]})},zf=["Founder","Professional Investor","Advisor","Team","Friend and Family","Manager","Institution","Media","Student","Supplier","Skip"],Hf=P.Ay.div`
  display: flex;
  flex-direction: column;
  height: 75vh;
  min-height: 600px;
  overflow: hidden;
`,Bf=P.Ay.div`
  display: flex;
  justify-content: space-between;
  align-items: flex-start;
  margin-bottom: 24px;
  padding-bottom: 16px;
  border-bottom: 1px solid #e5e7eb;
  
  .header-content {
    flex: 1;
    
    .name-and-cities {
      display: flex;
      align-items: center;
      flex-wrap: wrap;
      margin-bottom: 8px;
      
      h2 {
        margin: 0;
        font-size: 1.5rem;
        font-weight: 600;
        color: #111827;
      }
      
      .city-tags {
        display: flex;
        flex-wrap: wrap;
        gap: 4px;
      }
    }
    
    .dates {
      display: flex;
      flex-wrap: wrap;
      gap: 16px;
      font-size: 0.875rem;
      color: #6b7280;
      
      span {
        display: inline-block;
      }
    }
  }
`,Vf=P.Ay.button`
  background: none;
  border: none;
  cursor: pointer;
  color: #6b7280;
  height: 32px;
  width: 32px;
  display: flex;
  align-items: center;
  justify-content: center;
  border-radius: 4px;
  transition: all 0.2s;
  
  &:hover {
    background-color: #f3f4f6;
    color: #1f2937;
  }
`,$f=P.Ay.div`
  display: flex;
  gap: 2px;
  margin-bottom: 24px;
  border-bottom: 1px solid #e5e7eb;
`,Uf=P.Ay.button`
  padding: 12px 20px;
  background: none;
  border: none;
  border-bottom: 2px solid ${e=>e.active?"#000000":"transparent"};
  color: ${e=>e.active?"#000000":"#6b7280"};
  font-weight: ${e=>e.active?"600":"500"};
  font-size: 0.938rem;
  cursor: pointer;
  transition: all 0.2s;
  
  &:hover {
    color: ${e=>e.active?"#000000":"#1f2937"};
  }
  
  &:disabled {
    color: #9ca3af;
    font-style: italic;
    cursor: not-allowed;
  }
`,Wf=P.Ay.div`
  flex: 1;
  overflow-y: auto;
  padding: 0 24px 24px;
  scrollbar-width: thin;
  scrollbar-color: rgba(200, 200, 200, 0.5) transparent;
  
  &::-webkit-scrollbar {
    width: 4px;
  }
  
  &::-webkit-scrollbar-track {
    background: transparent;
  }
  
  &::-webkit-scrollbar-thumb {
    background-color: rgba(200, 200, 200, 0.5);
    border-radius: 10px;
    border: none;
  }
  
  &::-webkit-scrollbar-thumb:hover {
    background-color: rgba(180, 180, 180, 0.8);
  }
`,qf=P.Ay.div`
  width: 90%;
  margin: 0 auto;
`,Kf=P.Ay.div`
  display: grid;
  grid-template-columns: repeat(3, 1fr);
  gap: 32px;
  margin-bottom: 40px;
`,Yf=P.Ay.h3`
  font-size: 1.125rem;
  color: #111827;
  margin: 32px 0 20px;
  padding-bottom: 8px;
  border-bottom: 1px solid #f3f4f6;
`,Jf=P.Ay.div`
  display: flex;
  flex-direction: column;
  
  &.full-width {
    grid-column: span 3;
  }
`,Xf=P.Ay.label`
  display: block;
  margin-bottom: 10px;
  font-size: 0.875rem;
  color: #4b5563;
  font-weight: 500;
`,Qf=P.Ay.input`
  width: 100%;
  height: 40px;
  padding: 8px 12px;
  border: 1px solid #d1d5db;
  border-radius: 4px;
  font-size: 0.875rem;
  color: #111827;
  background-color: #fff;
  transition: border-color 0.2s, box-shadow 0.2s;
  box-sizing: border-box;
  line-height: 24px;

  &:focus {
    outline: none;
    border-color: #000000;
    box-shadow: 0 0 0 2px rgba(0, 0, 0, 0.15);
  }

  &:disabled {
    background-color: #f3f4f6;
    cursor: not-allowed;
  }
`,Zf=P.Ay.select`
  width: 100%;
  height: 40px;
  box-sizing: border-box;
  padding: 8px 12px;
  border: 1px solid #d1d5db;
  border-radius: 4px;
  font-size: 0.875rem;
  color: #111827;
  background-color: #fff;
  transition: border-color 0.2s, box-shadow 0.2s;
  cursor: pointer;
  line-height: 24px;
  
  /* Custom styling to ensure consistent appearance */
  -webkit-appearance: none;
  -moz-appearance: none;
  appearance: none;
  
  /* Custom dropdown arrow */
  background-image: url("data:image/svg+xml;charset=UTF-8,%3csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 24 24' fill='none' stroke='%23666' stroke-width='2' stroke-linecap='round' stroke-linejoin='round'%3e%3cpolyline points='6 9 12 15 18 9'%3e%3c/polyline%3e%3c/svg%3e");
  background-repeat: no-repeat;
  background-position: right 12px center;
  background-size: 16px;
  padding-right: 40px;

  &:focus {
    outline: none;
    border-color: #000000;
    box-shadow: 0 0 0 2px rgba(0, 0, 0, 0.15);
  }
  
  &::-ms-expand {
    display: none;
  }
`,eg=P.Ay.textarea`
  width: 100%;
  min-height: 150px;
  padding: 12px;
  border: 1px solid #d1d5db;
  border-radius: 4px;
  font-size: 0.875rem;
  color: #111827;
  background-color: #fff;
  transition: border-color 0.2s, box-shadow 0.2s;
  resize: vertical;

  &:focus {
    outline: none;
    border-color: #000000;
    box-shadow: 0 0 0 2px rgba(0, 0, 0, 0.15);
  }
`,tg=P.Ay.div`
  display: flex;
  justify-content: flex-end;
  gap: 12px;
  width: 90%;
  margin: 0 auto;
  padding-top: 16px;
  border-top: 1px solid #f3f4f6;
`,og=P.Ay.button`
  display: flex;
  align-items: center;
  gap: 6px;
  padding: 10px 16px;
  border-radius: 4px;
  font-size: 0.875rem;
  font-weight: 500;
  cursor: pointer;
  transition: all 0.2s;
`,ng=P.Ay.button`
  display: flex;
  align-items: center;
  justify-content: center;
  width: 36px;
  height: 36px;
  border-radius: 50%;
  font-size: 18px;
  cursor: pointer;
  transition: all 0.2s;
  outline: none;
  background-color: #f8f9fa;
  color: #495057;
  border: 1px solid #dee2e6;
  
  &:hover {
    background-color: #e9ecef;
    color: #212529;
  }
  
  &:disabled {
    opacity: 0.6;
    cursor: not-allowed;
  }
  
  svg {
    width: 18px;
    height: 18px;
    
    &.spinning {
      animation: spin 1s linear infinite;
    }
  }
  
  @keyframes spin {
    from {
      transform: rotate(0deg);
    }
    to {
      transform: rotate(360deg);
    }
  }
`,rg=(0,P.Ay)(og)`
  background-color: white;
  color: #4b5563;
  border: 1px solid #d1d5db;
  
  &:hover {
    background-color: #f9fafb;
    border-color: #9ca3af;
  }
`,ig=(0,P.Ay)(og)`
  background-color: #000000;
  color: white;
  border: none;
  
  &:hover {
    background-color: #333333;
  }
`,ag=(P.Ay.div`
  position: relative;
`,P.Ay.div`
  display: flex;
  flex-wrap: wrap;
  gap: 8px;
  margin-bottom: 16px;
  padding: 5px 0;
  min-height: 32px;
`),sg=P.Ay.div`
  display: inline-flex;
  align-items: center;
  padding: 0.25rem 0.5rem;
  font-size: 0.75rem;
  border-radius: 1rem;
  background-color: ${e=>e.color||"#f3f4f6"};
  color: ${e=>e.textColor||"#4b5563"};
  font-weight: 500;
  margin-right: 0.25rem;
  margin-bottom: 0.25rem;
  border: 1px solid black;
  gap: 6px;
  max-width: 200px;

  span {
    white-space: nowrap;
    overflow: hidden;
    text-overflow: ellipsis;
    max-width: 150px;
  }

  button {
    background: none;
    border: none;
    padding: 0;
    display: inline-flex;
    align-items: center;
    justify-content: center;
    margin-left: 0.25rem;
    color: #6b7280;
    cursor: pointer;
    
    &:hover { 
      color: #ef4444; 
    }
  }
`,lg=(P.Ay.div`
  position: relative;
  margin-bottom: 8px;
`,P.Ay.input`
  width: 100%;
  padding: 8px 12px;
  padding-right: 30px;
  border: 1px solid #d1d5db;
  border-radius: 4px;
  font-size: 0.875rem;
  color: #111827;
  background-color: #fff;

  &:focus {
    outline: none;
    border-color: #000000;
    box-shadow: 0 0 0 2px rgba(0, 0, 0, 0.15);
  }
`,P.Ay.div`
  position: absolute;
  right: 10px;
  top: 50%;
  transform: translateY(-50%);
  color: #6b7280;
`,P.Ay.div`
  position: absolute;
  width: 100%;
  max-height: 200px;
  overflow-y: auto;
  background-color: white;
  border: 1px solid #d1d5db;
  border-radius: 4px;
  box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
  z-index: 10;
`,P.Ay.div`
  padding: 8px 12px;
  cursor: pointer;
  font-size: 0.875rem;
  color: #111827;

  &:hover {
    background-color: #f3f4f6;
  }
`,P.Ay.button`
  width: 100%;
  text-align: left;
  padding: 8px 12px;
  border: none;
  background-color: #f3f4f6;
  cursor: pointer;
  font-size: 0.875rem;
  color: #1f2937;
  display: flex;
  align-items: center;
  gap: 5px;
  transition: background-color 0.2s;

  &:hover {
    background-color: #e5e7eb;
  }

  &:disabled {
    opacity: 0.5;
    cursor: not-allowed;
  }
`,P.Ay.div`
  display: flex;
  flex-wrap: wrap;
  margin-top: 8px;
  gap: 4px;
`,P.Ay.div`
  display: inline-flex;
  align-items: center;
  padding: 0.25rem 0.5rem;
  font-size: 0.75rem;
  border-radius: 0.375rem;
  background-color: white;
  color: black;
  font-weight: 500;
  margin-right: 0.25rem;
  margin-bottom: 0.25rem;
  border: 1px solid black;
  text-transform: uppercase;

  span {
    margin-right: 6px;
  }

  button {
    background: none;
    border: none;
    padding: 0;
    display: inline-flex;
    align-items: center;
    justify-content: center;
    margin-left: 0.25rem;
    color: #6b7280;
    cursor: pointer;
    
    &:hover {
      color: #ef4444;
    }
  }
`),cg=e=>{const t=[{bg:"#fee2e2",text:"#b91c1c"},{bg:"#fef3c7",text:"#92400e"},{bg:"#ecfccb",text:"#3f6212"},{bg:"#d1fae5",text:"#065f46"},{bg:"#e0f2fe",text:"#0369a1"},{bg:"#ede9fe",text:"#5b21b6"},{bg:"#fae8ff",text:"#86198f"},{bg:"#fce7f3",text:"#9d174d"}];let o=0;for(let n=0;n<e.length;n++)o+=e.charCodeAt(n);return t[o%t.length]},dg=P.Ay.button`
  background: none;
  border: none;
  padding: 4px;
  margin: 0 4px;
  cursor: pointer;
  color: #6B7280;
  transition: all 0.2s;

  &:hover {
    color: ${e=>e.delete?"#EF4444":"#3B82F6"};
  }
`,ug=P.Ay.div`
  display: flex;
  align-items: center;
  justify-content: flex-start;
`,pg=P.Ay.div`
  width: 90%;
  margin: 0 auto;
`,hg=P.Ay.div`
  display: grid;
  grid-template-columns: ${e=>0===e.duplicatesCount?"1fr":1===e.duplicatesCount?"repeat(2, 1fr)":"repeat(3, 1fr)"};
  gap: 24px;
`,fg=P.Ay.div`
  background-color: #f9fafb;
  border-radius: 8px;
  padding: 16px;
  border: 1px solid ${e=>e.isMain?"#3b82f6":"#e5e7eb"};
  position: relative;
  
  h3 {
    margin: 0 0 16px;
    font-size: 1rem;
    color: ${e=>e.isMain?"#3b82f6":"#111827"};
    padding-bottom: 8px;
    border-bottom: 1px solid #e5e7eb;
    display: flex;
    justify-content: space-between;
    align-items: center;
  }
`,gg=P.Ay.button`
  display: inline-flex;
  align-items: center;
  gap: 6px;
  padding: 4px 8px;
  background-color: #eff6ff;
  color: #3b82f6;
  border: 1px solid #bfdbfe;
  border-radius: 4px;
  font-size: 0.75rem;
  font-weight: 500;
  cursor: pointer;
  transition: all 0.2s;
  
  &:hover {
    background-color: #dbeafe;
  }
`,mg=P.Ay.span`
  display: inline-flex;
  align-items: center;
  gap: 4px;
  padding: 2px 6px;
  background-color: #dbeafe;
  color: #1d4ed8;
  border-radius: 4px;
  font-size: 0.75rem;
  font-weight: 500;
`,yg=P.Ay.div`
  margin-bottom: 12px;
  
  .label {
    font-size: 0.75rem;
    color: #6b7280;
    margin-bottom: 4px;
  }
  
  .value {
    font-size: 0.875rem;
    color: #111827;
    word-break: break-word;
  }
  
  &.empty .value {
    color: #9ca3af;
    font-style: italic;
  }
`,vg=P.Ay.div`
  display: flex;
  flex-wrap: wrap;
  gap: 4px;
  margin-bottom: 12px;
  
  .label {
    font-size: 0.75rem;
    color: #6b7280;
    margin-bottom: 4px;
    width: 100%;
  }
  
  &.empty .value {
    color: #9ca3af;
    font-style: italic;
    font-size: 0.875rem;
  }
`,bg=(P.Ay.div`
  margin-bottom: 12px;
  
  .label {
    font-size: 0.75rem;
    color: #6b7280;
    margin-bottom: 4px;
  }
  
  .company-item {
    font-size: 0.875rem;
    background-color: #f3f4f6;
    padding: 4px 8px;
    border-radius: 4px;
    margin-bottom: 4px;
    display: inline-block;
    margin-right: 4px;
  }
  
  &.empty .value {
    color: #9ca3af;
    font-style: italic;
    font-size: 0.875rem;
  }
`,P.Ay.button`
  display: flex;
  align-items: center;
  justify-content: center;
  gap: 8px;
  padding: 8px 16px;
  background-color: #fee2e2;
  color: #b91c1c;
  border: none;
  border-radius: 4px;
  font-size: 0.875rem;
  font-weight: 500;
  cursor: pointer;
  margin-top: 16px;
  transition: all 0.2s;
  
  &:hover {
    background-color: #fecaca;
  }
  
  &:disabled {
    opacity: 0.5;
    cursor: not-allowed;
  }
`),xg=P.Ay.button`
  background: none;
  border: none;
  cursor: pointer;
  color: #6b7280;
  display: flex;
  align-items: center;
  justify-content: center;
  transition: color 0.2s;
  
  &:hover {
    color: #000000;
  }
`,wg=P.Ay.button`
  display: inline-flex;
  align-items: center;
  justify-content: center;
  width: 18px;
  height: 18px;
  border-radius: 50%;
  border: none;
  background: transparent;
  color: #4b5563;
  cursor: pointer;
  margin-left: 4px;
  padding: 0;
  
  &:hover {
    color: #1d4ed8;
  }
`,Cg=P.Ay.button`
  display: inline-flex;
  align-items: center;
  justify-content: center;
  width: 18px;
  height: 18px;
  border-radius: 50%;
  border: none;
  background: transparent;
  color: #4b5563;
  cursor: pointer;
  margin-left: 4px;
  padding: 0;
  
  &:hover {
    color: #1d4ed8;
  }
`,_g=P.Ay.button`
  display: inline-flex;
  align-items: center;
  justify-content: center;
  background-color: transparent;
  color: #1d4ed8;
  border: none;
  cursor: pointer;
  padding: 4px 8px;
  border-radius: 4px;
  font-size: 0.875rem;
  font-weight: 500;
  gap: 4px;
  
  &:hover {
    background-color: #eff6ff;
  }
`,Sg=P.Ay.span`
  display: inline-flex;
  align-items: center;
  padding: 4px 8px;
  background-color: #000000;
  color: white;
  border-radius: 4px;
  margin-left: 8px;
  font-size: 0.75rem;
  font-weight: 500;
  gap: 4px;

  button {
    background: none;
    border: none;
    padding: 0;
    display: flex;
    align-items: center;
    justify-content: center;
    color: inherit;
    cursor: pointer;
    opacity: 0.7;
    
    &:hover {
      opacity: 1;
    }
  }
`,Eg=P.Ay.button`
  display: inline-flex;
  align-items: center;
  padding: 4px 8px;
  background-color: transparent;
  border: none;
  color: #4b5563;
  font-size: 0.75rem;
  font-weight: 500;
  cursor: pointer;
  margin-left: 8px;
  gap: 4px;
  
  &:hover {
    background-color: #f3f4f6;
    border-radius: 4px;
  }
`,kg=P.Ay.span`
  width: 8px;
  height: 8px;
  background-color: #3b82f6;
  border-radius: 50%;
  display: inline-block;
  margin-left: 6px;
`,jg=P.Ay.table`
  width: 100%;
  border-collapse: separate;
  border-spacing: 0;
  margin-top: 16px;
  background: #fff;
  border: 1px solid #e5e7eb;
  border-radius: 8px;
  overflow: hidden;
`,Ag=P.Ay.thead`
  background: #f9fafb;
  th {
    padding: 12px 16px;
    text-align: left;
    font-size: 0.875rem;
    font-weight: 500;
    color: #4b5563;
    border-bottom: 1px solid #e5e7eb;
  }
`,Rg=P.Ay.tbody`
  tr {
    &:hover {
      background-color: #f9fafb;
    }
    &:not(:last-child) {
      border-bottom: 1px solid #e5e7eb;
    }
  }
  td {
    padding: 12px 16px;
    font-size: 0.875rem;
    color: #1f2937;
    vertical-align: middle;
  }
`,Og=P.Ay.span`
  display: inline-block;
  padding: 2px 8px;
  border-radius: 9999px;
  font-size: 0.75rem;
  font-weight: 500;
  background-color: ${e=>{switch(e.type){case"Karma Points":return"#DCFCE7";case"Dealflow Related":return"#FEF3C7";case"Portfolio Company Related":return"#DBEAFE";default:return"#F3F4F6"}}};
  color: ${e=>{switch(e.type){case"Karma Points":return"#166534";case"Dealflow Related":return"#92400E";case"Portfolio Company Related":return"#1E40AF";default:return"#374151"}}};
`,Tg=P.Ay.span`
  display: inline-flex;
  align-items: center;
  background: #e5e7eb;
  padding: 2px 8px;
  border-radius: 16px;
  margin: 2px;
  font-size: 0.75rem;
`,Dg=P.Ay.div`
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
  max-width: 300px;
  position: relative;

  &:hover::after {
    content: attr(data-tooltip);
    position: absolute;
    left: 0;
    top: 100%;
    background: #1f2937;
    color: white;
    padding: 8px 12px;
    border-radius: 6px;
    font-size: 0.875rem;
    white-space: normal;
    max-width: 300px;
    word-wrap: break-word;
    z-index: 1000;
    box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1), 0 2px 4px -1px rgba(0, 0, 0, 0.06);
  }
`,Pg=P.Ay.button`
  display: inline-flex;
  align-items: center;
  justify-content: center;
  padding: 8px 16px;
  background-color: #000000;
  color: white;
  border: none;
  border-radius: 6px;
  font-size: 0.875rem;
  font-weight: 500;
  cursor: pointer;
  transition: background-color 0.2s;

  &:hover {
    background-color: #333333;
  }

  svg {
    margin-right: 8px;
    width: 16px;
    height: 16px;
  }
`,Ng=P.Ay.div`
  display: flex;
  justify-content: space-between;
  align-items: center;
  margin-bottom: 16px;
`,Ig=e=>{let{isOpen:o,onRequestClose:n,contact:r}=e;const[i,a]=(0,t.useState)("about"),[s,l]=(0,t.useState)({first_name:"",last_name:"",email:"",email2:"",email3:"",mobile:"",mobile2:"",job_title:"",contact_category:"",about_the_contact:"",linkedin:""}),[c,d]=(0,t.useState)([]),[u,p]=(0,t.useState)([]),[h,f]=(0,t.useState)([]),[g,m]=(0,t.useState)(!1),[y,v]=(0,t.useState)(!1),[b,x]=(0,t.useState)([]),[w,C]=(0,t.useState)(!1),[_,S]=(0,t.useState)(""),[E,k]=(0,t.useState)(""),[j,A]=(0,t.useState)(null),[R,O]=(0,t.useState)(!1),[T,I]=(0,t.useState)([]),[M,L]=(0,t.useState)([]),[F,G]=(0,t.useState)([]),[z,H]=(0,t.useState)(!1),[V,$]=(0,t.useState)(!1),[U,W]=(0,t.useState)(!1),[q,K]=(0,t.useState)([]),[Y,J]=(0,t.useState)([]),[X,Q]=(0,t.useState)(!1),[Z,ee]=(0,t.useState)(!1),[te,oe]=(0,t.useState)(null),[ne,re]=(0,t.useState)(!1),[ie,ae]=(0,t.useState)(null),[se,le]=(0,t.useState)({companies:!0,tags:!0,category:!0}),[ce,de]=(0,t.useState)({}),[ue,pe]=(0,t.useState)({}),[he,fe]=(0,t.useState)(null),me=async()=>{if(r)try{await Promise.all([Te(),Pe(),ze(),"duplicates"===i&&_e(),"related"===i&&Promise.all([ve(),be(),xe()]),"introductions"===i&&Qe()].filter(Boolean));const{data:e,error:t}=await D.supabase.from("contacts").select("*").eq("id",r.id).single();!t&&e&&l((t=>({...t,first_name:e.first_name||"",last_name:e.last_name||"",email:e.email||"",email2:e.email2||"",email3:e.email3||"",mobile:e.mobile||"",mobile2:e.mobile2||"",job_title:e.job_title||"",contact_category:e.contact_category||"",about_the_contact:e.about_the_contact||"",linkedin:e.linkedin||""})))}catch(e){console.error("Error refreshing contact data:",e),nt.oR.error("Failed to refresh contact data")}};(0,t.useEffect)((()=>{r&&(l({first_name:r.first_name||"",last_name:r.last_name||"",email:r.email||"",email2:r.email2||"",email3:r.email3||"",mobile:r.mobile||"",mobile2:r.mobile2||"",job_title:r.job_title||"",contact_category:r.contact_category||"",about_the_contact:r.about_the_contact||"",linkedin:r.linkedin||""}),A(r),Te(),Pe(),ze())}),[r]);(0,t.useEffect)((()=>{"merge"===i&&r&&_e(),"related"===i&&r&&ye()}),[i,r]);const ye=async()=>{if(r){H(!0);try{await Promise.all([ve(),be(),xe()])}catch(e){console.error("Error fetching related contacts:",e),nt.oR.error("Failed to load related contacts")}finally{H(!1)}}},ve=async()=>{if(r&&r.id)try{const{data:e,error:t}=await D.supabase.from("contact_companies").select("company_id").eq("contact_id",r.id);if(t)throw t;if(!e||0===e.length)return console.log("No companies found for this contact"),void I([]);const o=e.map((e=>e.company_id)),{data:n,error:i}=await D.supabase.from("contact_companies").select("\n          contact_id,\n          contacts:contact_id(\n            id, first_name, last_name, email, mobile, contact_category, job_title\n          )\n        ").in("company_id",o).neq("contact_id",r.id);if(i)throw i;if(!n||0===n.length)return console.log("No contacts with matching companies found"),void I([]);const a=new Map;n.forEach((e=>{e.contacts&&a.set(e.contacts.id,e.contacts)}));const s=Array.from(a.values());I(s),console.log(`Found ${s.length} contacts with matching companies`)}catch(e){console.error("Error fetching related company contacts:",e),I([])}},be=async()=>{if(r&&r.id)try{const{data:e,error:t}=await D.supabase.from("contact_tags").select("tag_id").eq("contact_id",r.id);if(t)throw t;if(!e||0===e.length)return console.log("No tags found for this contact"),void L([]);const o=e.map((e=>e.tag_id)),{data:n,error:i}=await D.supabase.from("contact_tags").select("\n          contact_id,\n          contacts:contact_id(\n            id, first_name, last_name, email, mobile, contact_category, job_title\n          )\n        ").in("tag_id",o).neq("contact_id",r.id);if(i)throw i;if(!n||0===n.length)return console.log("No contacts with matching tags found"),void L([]);const a=new Map;n.forEach((e=>{e.contacts&&a.set(e.contacts.id,e.contacts)}));const s=Array.from(a.values());L(s),console.log(`Found ${s.length} contacts with matching tags`)}catch(e){console.error("Error fetching related tag contacts:",e),L([])}},xe=async()=>{if(r&&r.id&&r.contact_category)try{const{data:e,error:t}=await D.supabase.from("contact_cities").select("city_id").eq("contact_id",r.id);if(t)throw t;if(!e||0===e.length)return console.log("No cities found for this contact"),void G([]);const o=e.map((e=>e.city_id)),{data:n,error:i}=await D.supabase.from("contacts").select("\n          id, first_name, last_name, email, mobile, contact_category, job_title\n        ").eq("contact_category",r.contact_category).neq("id",r.id);if(i)throw i;if(!n||0===n.length)return console.log("No contacts with matching category found"),void G([]);const a=n.map((e=>e.id)),{data:s,error:l}=await D.supabase.from("contact_cities").select("contact_id, city_id").in("contact_id",a).in("city_id",o);if(l)throw l;if(!s||0===s.length)return console.log("No contacts with matching category and city found"),void G([]);const c=s.map((e=>e.contact_id)),d=n.filter((e=>c.includes(e.id)));G(d),console.log(`Found ${d.length} contacts with matching category and city`)}catch(e){console.error("Error fetching related category contacts:",e),G([])}};(0,t.useEffect)((()=>{(async()=>{if(r&&r.first_name&&r.last_name)try{const{data:e,error:t}=await D.supabase.from("contacts").select("id").eq("first_name",r.first_name).eq("last_name",r.last_name).neq("id",r.id);if(t)throw t;W(e&&e.length>0)}catch(e){console.error("Error checking duplicates:",e)}})()}),[r]);const we=e=>{if(!e)return"N/A";return new Date(e).toLocaleDateString("en-GB",{day:"2-digit",month:"2-digit",year:"numeric"})},Ce=e=>{const{name:t,value:o}=e.target;l((e=>({...e,[t]:o})))},_e=async()=>{if(r&&r.first_name&&r.last_name)try{const{data:e,error:t}=await D.supabase.from("contacts").select("*").eq("first_name",r.first_name).eq("last_name",r.last_name).neq("id",r.id).order("created_at",{ascending:!1});if(t)throw t;const o=await Promise.all(e.map((async e=>{const t=await ke(e.id),o=await je(e.id),n=await Se(e.id);return{...e,tags:t,companies:o,cities:n}})));x(o)}catch(e){console.error("Error fetching duplicate contacts:",e)}},Se=async e=>{try{const{data:t,error:o}=await D.supabase.from("contact_cities").select("\n          city_id,\n          cities:city_id(id, name)\n        ").eq("contact_id",e);if(o)throw o;return t.map((e=>({id:e.city_id,name:e.cities.name})))}catch(t){return console.error("Error fetching contact cities:",t),[]}},Ee=async e=>{try{const{error:t}=await D.supabase.from("contact_cities").delete().match({contact_id:r.id,city_id:e.id});if(t)throw t;f((t=>t.filter((t=>t.id!==e.id)))),nt.oR.success("City removed successfully")}catch(t){console.error("Error removing city:",t),nt.oR.error("Failed to remove city")}},ke=async e=>{try{const{data:t,error:o}=await D.supabase.from("contact_tags").select("\n          tag_id,\n          tags:tag_id(id, name)\n        ").eq("contact_id",e);if(o)throw o;return t.map((e=>({id:e.tag_id,name:e.tags.name})))}catch(t){return console.error("Error fetching contact tags:",t),[]}},je=async e=>{try{const{data:t,error:o}=await D.supabase.from("contact_companies").select("\n          company_id,\n          companies:company_id(id, name, website, category)\n        ").eq("contact_id",e);if(o)throw o;return t.map((e=>({id:e.company_id,name:e.companies.name,website:e.companies.website,category:e.companies.category})))}catch(t){return console.error("Error fetching related companies:",t),[]}},Re=(e,t)=>{l((o=>({...o,[e]:t})))},Oe=async()=>{try{const{error:e}=await D.supabase.from("contacts").update(s).eq("id",r.id);if(e)throw e;alert("Main contact updated successfully.")}catch(e){console.error("Error updating main contact:",e),alert("Failed to update main contact. Please try again.")}},Te=async()=>{if(r&&r.id)try{const{data:e,error:t}=await D.supabase.from("contact_tags").select("\n          tag_id,\n          tags:tag_id(id, name)\n        ").eq("contact_id",r.id);if(t)throw t;const o=e.map((e=>({id:e.tag_id,name:e.tags.name})));d(o)}catch(e){console.error("Error fetching contact tags:",e)}},De=async e=>{try{const{error:t}=await D.supabase.from("contact_tags").delete().eq("contact_id",r.id).eq("tag_id",e.id);if(t)throw t;d((t=>t.filter((t=>t.id!==e.id))))}catch(t){console.error("Error removing tag:",t)}},Pe=async()=>{if(r&&r.id)try{const{data:e,error:t}=await D.supabase.from("contact_companies").select("\n          company_id,\n          companies:company_id(id, name, website, category)\n        ").eq("contact_id",r.id);if(t)throw t;const o=e.map((e=>({id:e.company_id,name:e.companies.name,website:e.companies.website,category:e.companies.category})));p(o)}catch(e){console.error("Error fetching related companies:",e)}},Ne=async e=>{try{const{error:t}=await D.supabase.from("contact_companies").delete().eq("contact_id",r.id).eq("company_id",e.id);if(t)throw t;p((t=>t.filter((t=>t.id!==e.id))))}catch(t){console.error("Error removing company:",t)}},Ie=()=>{m(!0)},Me=()=>{v(!0)},Le=async()=>{if(!r||!r.id)return;fe("apollo");const e=nt.oR.loading("Enriching contact from Apollo...");try{var t,o,n;console.log("Calling Apollo enrichment for contact:",r.id);const i=await fetch("https://efazuvegwxouysfcgwja.supabase.co/functions/v1/apollo-enrich",{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${(null===(t=await D.supabase.auth.getSession())||void 0===t||null===(o=t.data)||void 0===o||null===(n=o.session)||void 0===n?void 0:n.access_token)||""}`,apikey:"eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImVmYXp1dmVnd3hvdXlzZmNnd2phIiwicm9sZSI6ImFub24iLCJpYXQiOjE3MzU5Mjk1MjcsImV4cCI6MjA1MTUwNTUyN30.1G5n0CyQEHGeE1XaJld_PbpstUFd0Imaao6N8MUmfvE"},body:JSON.stringify({contactId:r.id})});if(console.log("Apollo enrichment response status:",i.status),!i.ok){const e=await i.json();throw new Error(e.error||"Failed to enrich contact from Apollo")}const a=await i.json();console.log("Apollo enrichment successful:",a),await me(),nt.oR.dismiss(e),nt.oR.success("Contact enriched successfully from Apollo!")}catch(i){console.error("Error enriching contact from Apollo:",i),nt.oR.dismiss(e),nt.oR.error(i.message||"Failed to enrich contact from Apollo")}finally{fe(null)}},Fe=async()=>{if(!r||!r.id)return;fe("airtable");const e=nt.oR.loading("Enriching contact from Airtable...");try{var t,o,n;console.log("Calling Airtable enrichment for contact:",r.id);const i=await fetch("https://efazuvegwxouysfcgwja.supabase.co/functions/v1/airtable-enrich",{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${(null===(t=await D.supabase.auth.getSession())||void 0===t||null===(o=t.data)||void 0===o||null===(n=o.session)||void 0===n?void 0:n.access_token)||""}`,apikey:"eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImVmYXp1dmVnd3hvdXlzZmNnd2phIiwicm9sZSI6ImFub24iLCJpYXQiOjE3MzU5Mjk1MjcsImV4cCI6MjA1MTUwNTUyN30.1G5n0CyQEHGeE1XaJld_PbpstUFd0Imaao6N8MUmfvE"},body:JSON.stringify({contactId:r.id})});if(console.log("Airtable enrichment response status:",i.status),!i.ok){const e=await i.json();throw new Error(e.error||"Failed to enrich contact from Airtable")}const a=await i.json();console.log("Airtable enrichment successful:",a),await me(),nt.oR.dismiss(e),nt.oR.success("Contact enriched successfully from Airtable!")}catch(i){console.error("Error enriching contact from Airtable:",i),nt.oR.dismiss(e),nt.oR.error(i.message||"Failed to enrich contact from Airtable")}finally{fe(null)}},Ge=async()=>{if(!r||!r.id)return;fe("hubspot");const e=nt.oR.loading("Enriching contact from HubSpot...");try{console.log("HubSpot enrichment not yet implemented"),nt.oR.dismiss(e),nt.oR.info("HubSpot enrichment will be implemented soon")}catch(t){console.error("Error enriching contact from HubSpot:",t),nt.oR.dismiss(e),nt.oR.error(t.message||"Failed to enrich contact from HubSpot")}finally{fe(null)}},ze=async()=>{if(r)try{const{data:e,error:t}=await D.supabase.from("contact_cities").select("\n          city_id,\n          cities:city_id(id, name)\n        ").eq("contact_id",r.id);if(t)throw t;const o=e.map((e=>({id:e.city_id,name:e.cities.name})));f(o)}catch(e){console.error("Error fetching contact cities:",e),f([])}},He=P.Ay.div`
    margin-bottom: 24px;
    width: 90%;
    margin: 0 auto;
  `,Be=P.Ay.div`
    display: flex;
    align-items: center;
    justify-content: space-between;
    padding: 12px 16px;
    background-color: #f9fafb;
    border: 1px solid #e5e7eb;
    border-radius: 8px;
    cursor: pointer;
    margin-bottom: ${e=>e.isOpen?"0":"16px"};
    border-bottom-left-radius: ${e=>e.isOpen?"0":"8px"};
    border-bottom-right-radius: ${e=>e.isOpen?"0":"8px"};
    transition: background-color 0.2s;

    &:hover {
      background-color: #f3f4f6;
    }

    h3 {
      font-size: 1.125rem;
      font-weight: 600;
      color: #111827;
      margin: 0;
      display: flex;
      align-items: center;
      gap: 8px;
    }
  `,Ve=P.Ay.div`
    display: ${e=>e.isOpen?"block":"none"};
    background-color: #f9fafb;
    border: 1px solid #e5e7eb;
    border-top: none;
    border-bottom-left-radius: 8px;
    border-bottom-right-radius: 8px;
    padding: 16px;
    margin-bottom: 16px;
  `,$e=P.Ay.div`
    display: flex;
    justify-content: space-between;
    align-items: center;
    padding: 12px;
    border-bottom: 1px solid #f3f4f6;
    cursor: pointer;
    transition: background-color 0.2s;
    border-radius: 4px;

    &:hover {
      background-color: #f3f4f6;
    }

    &:last-child {
      border-bottom: none;
    }
  `,Ue=P.Ay.div`
    font-weight: 500;
    color: #111827;
  `,We=P.Ay.div`
    font-size: 0.875rem;
    color: #6b7280;
  `,qe=P.Ay.span`
    display: inline-block;
    padding: 1.8px 5.4px;
    border-radius: 4px;
    font-size: 0.7rem;
    font-weight: 500;
    background-color: ${e=>"Inbox"===e.category?"#ffefef":"Skip"===e.category?"#f3f4f6":"#e0f2fe"};
    color: ${e=>"Inbox"===e.category?"#ef4444":"Skip"===e.category?"#4b5563":"#0369a1"};
    margin-left: 8px;
  `,Ke=P.Ay.div`
    margin-bottom: 16px;
    padding: 12px;
    background-color: #fff;
    border-radius: 6px;
    border: 1px solid #e5e7eb;
  `,Ye=P.Ay.div`
    font-weight: 500;
    color: #111827;
    margin-bottom: 8px;
    padding-bottom: 8px;
    border-bottom: 1px solid #f3f4f6;
    display: flex;
    align-items: center;
    gap: 6px;

    .tag-badge {
      display: inline-block;
      padding: 0.25rem 0.5rem;
      font-size: 0.75rem;
      border-radius: 1rem;
      background-color: ${e=>e.bgColor||"#f3f4f6"};
      color: ${e=>e.textColor||"#374151"};
      border: 1px solid black;
    }
  `,Je=P.Ay.div`
    color: #6b7280;
    font-style: italic;
    padding: 16px;
    text-align: center;
  `,Xe=e=>{le((t=>({...t,[e]:!t[e]})))};(0,t.useEffect)((()=>{r&&r.id&&M.length>0&&(async()=>{if(r&&r.id&&M.length)try{const{data:e,error:t}=await D.supabase.from("contact_tags").select("\n          tag_id,\n          tags:tag_id(id, name)\n        ").eq("contact_id",r.id);if(t)throw t;if(!e||0===e.length)return;const o={};e.forEach((e=>{o[e.tag_id]={id:e.tag_id,name:e.tags.name}}));const n={},i={};Object.keys(o).forEach((e=>{i[e]=[]}));const a=M.map((async e=>{const{data:t,error:r}=await D.supabase.from("contact_tags").select("\n            tag_id,\n            tags:tag_id(id, name)\n          ").eq("contact_id",e.id).in("tag_id",Object.keys(o));if(r)throw r;t.forEach((t=>{i[t.tag_id]&&i[t.tag_id].push(e)})),n[e.id]=t.map((e=>e.tag_id))}));await Promise.all(a),pe(o),de(i)}catch(e){console.error("Error fetching tag details:",e)}})()}),[M]);const Qe=async()=>{if(r){Q(!0);try{const{data:e,error:t}=await D.supabase.from("contact_introductions").select("*").contains("contacts_introduced",[r.id]).order("intro_date",{ascending:!1});if(t)throw t;const o=new Set;if(e.forEach((e=>{e.contacts_introduced.forEach((e=>{e!==r.id&&o.add(e)}))})),o.size>0){const{data:e,error:t}=await D.supabase.from("contacts").select("id, first_name, last_name").in("id",Array.from(o));if(t)throw t;J(e)}else J([]);K(e)}catch(e){console.error("Error fetching introductions:",e)}finally{Q(!1)}}};(0,t.useEffect)((()=>{"intros"===i&&Qe()}),[i]);const Ze=e=>{if(!e||!Array.isArray(e))return"No contacts";const t=e.filter((e=>e!==r.id));return 0===t.length?"No contacts":t.map((e=>{const t=Y.find((t=>t.id===e));return t?`${t.first_name} ${t.last_name}`:(console.log(`Contact not found for ID: ${e}`),`Contact #${e}`)})).join(", ")};return(0,N.jsxs)(N.Fragment,{children:[(0,N.jsx)(ot(),{isOpen:o,onRequestClose:n,style:{content:{top:"50%",left:"50%",right:"auto",bottom:"auto",marginRight:"-50%",transform:"translate(-50%, -50%)",padding:"24px",border:"none",borderRadius:"8px",boxShadow:"0 4px 12px rgba(0, 0, 0, 0.15)",width:"75%",maxHeight:"85vh",overflow:"hidden"},overlay:{backgroundColor:"rgba(0, 0, 0, 0.5)",zIndex:1e3}},children:(0,N.jsxs)(Hf,{children:[(0,N.jsxs)(Bf,{children:[(0,N.jsxs)("div",{className:"header-content",children:[(0,N.jsxs)("div",{className:"name-and-cities",children:[(0,N.jsx)("h2",{children:`${r.first_name||""} ${r.last_name||""}`.trim()||"Unnamed Contact"}),(0,N.jsxs)("div",{className:"city-tags",children:[h.map((e=>(0,N.jsxs)(Sg,{children:[e.name,(0,N.jsx)("button",{onClick:()=>Ee(e),title:"Remove city",children:(0,N.jsx)(B.yGN,{size:12})})]},e.id))),(0,N.jsxs)(Eg,{onClick:()=>{$(!0)},children:[(0,N.jsx)(B.GGD,{size:12}),"Add City"]})]})]}),(0,N.jsxs)("div",{className:"dates",children:[(0,N.jsxs)("span",{children:["Created: ",we(r.created_at)]}),(0,N.jsxs)("span",{children:["Last Modified: ",we(r.last_modified)]})]})]}),(0,N.jsx)(Vf,{onClick:n,"aria-label":"Close modal",children:(0,N.jsx)(B.yGN,{size:20})})]}),(0,N.jsxs)($f,{children:[(0,N.jsx)(Uf,{active:"about"===i,onClick:()=>a("about"),children:"About"}),(0,N.jsxs)(Uf,{active:"merge"===i,onClick:()=>a("merge"),children:["Merge",U&&(0,N.jsx)(kg,{})]}),(0,N.jsx)(Uf,{active:"related"===i,onClick:()=>a("related"),children:"Related"}),(0,N.jsx)(Uf,{active:"intros"===i,onClick:()=>a("intros"),children:"Intros"}),(0,N.jsx)(Uf,{active:"deals"===i,onClick:()=>a("deals"),disabled:!0,children:"Deals (Coming Soon)"}),(0,N.jsx)(Uf,{active:"notes"===i,onClick:()=>a("notes"),children:"Notes"})]}),(0,N.jsxs)(Wf,{children:["about"===i&&(0,N.jsxs)(qf,{children:[(0,N.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[(0,N.jsx)(Yf,{children:"Contact Information"}),(0,N.jsxs)("div",{style:{display:"flex",gap:"8px"},children:[(0,N.jsx)(ng,{onClick:Le,disabled:he,title:"Enrich from Apollo",children:"apollo"===he?(0,N.jsx)(B.jTZ,{className:"spinning"}):(0,N.jsx)(Ae.nBS,{})}),r&&r.airtable_id&&(0,N.jsx)(ng,{onClick:Fe,disabled:he,title:"Pull from Airtable",children:"airtable"===he?(0,N.jsx)(B.jTZ,{className:"spinning"}):(0,N.jsx)(Io,{})}),r&&r.hubspot_id&&(0,N.jsx)(ng,{onClick:Ge,disabled:he,title:"Sync with HubSpot",children:"hubspot"===he?(0,N.jsx)(B.jTZ,{className:"spinning"}):(0,N.jsx)(Mo,{})})]})]}),(0,N.jsxs)(Kf,{children:[(0,N.jsxs)(Jf,{children:[(0,N.jsx)(Xf,{htmlFor:"first_name",children:"First Name"}),(0,N.jsx)(Qf,{id:"first_name",type:"text",name:"first_name",value:s.first_name,onChange:Ce,placeholder:"Enter first name"})]}),(0,N.jsxs)(Jf,{children:[(0,N.jsx)(Xf,{htmlFor:"last_name",children:"Last Name"}),(0,N.jsx)(Qf,{id:"last_name",type:"text",name:"last_name",value:s.last_name,onChange:Ce,placeholder:"Enter last name"})]}),(0,N.jsxs)(Jf,{children:[(0,N.jsx)(Xf,{htmlFor:"job_title",children:"Job Title"}),(0,N.jsx)(Qf,{id:"job_title",type:"text",name:"job_title",value:s.job_title,onChange:Ce,placeholder:"Enter job title"})]}),(0,N.jsxs)(Jf,{children:[(0,N.jsx)(Xf,{htmlFor:"contact_category",children:"Main Category"}),(0,N.jsxs)(Zf,{id:"contact_category",name:"contact_category",value:s.contact_category,onChange:Ce,children:[(0,N.jsx)("option",{value:"",children:"Select Category"}),zf.map((e=>(0,N.jsx)("option",{value:e,children:e},e)))]})]}),(0,N.jsxs)(Jf,{children:[(0,N.jsx)(Xf,{children:"Keywords"}),(0,N.jsx)(ag,{children:c.map((e=>{const{bg:t,text:o}=cg(e.name);return(0,N.jsxs)(sg,{color:t,textColor:o,children:[(0,N.jsx)("span",{children:e.name}),(0,N.jsx)("button",{onClick:()=>De(e),children:(0,N.jsx)(B.yGN,{size:14})})]},e.id)}))}),(0,N.jsxs)(dg,{onClick:Ie,children:[(0,N.jsx)(B.cnX,{size:14})," Manage Tags"]})]}),(0,N.jsxs)(Jf,{children:[(0,N.jsx)(Xf,{children:"Related Companies"}),(0,N.jsx)(ag,{children:u.map((e=>(0,N.jsxs)(lg,{children:[(0,N.jsx)("span",{children:e.name}),(0,N.jsx)("button",{onClick:()=>Ne(e),children:(0,N.jsx)(B.yGN,{size:14})})]},e.id)))}),(0,N.jsxs)(dg,{onClick:Me,children:[(0,N.jsx)(B.ayE,{size:14})," Manage Companies"]})]})]}),(0,N.jsx)(Yf,{children:"Contact Details"}),(0,N.jsxs)(Kf,{children:[(0,N.jsxs)(Jf,{children:[(0,N.jsx)(Xf,{htmlFor:"linkedin",children:"LinkedIn"}),(0,N.jsx)(Qf,{id:"linkedin",type:"text",name:"linkedin",value:s.linkedin||"",onChange:Ce,placeholder:"https://www.linkedin.com/in/username"})]}),(0,N.jsxs)(Jf,{children:[(0,N.jsx)(Xf,{htmlFor:"mobile",children:"Mobile"}),(0,N.jsx)(Qf,{id:"mobile",type:"tel",name:"mobile",value:s.mobile,onChange:Ce,placeholder:"+447597685011"})]}),(0,N.jsxs)(Jf,{children:[(0,N.jsx)(Xf,{htmlFor:"mobile2",children:"Mobile 2"}),(0,N.jsx)(Qf,{id:"mobile2",type:"tel",name:"mobile2",value:s.mobile2,onChange:Ce,placeholder:"+447597685011"})]})]}),(0,N.jsxs)(Kf,{children:[(0,N.jsxs)(Jf,{children:[(0,N.jsx)(Xf,{htmlFor:"email",children:"Email"}),(0,N.jsx)(Qf,{id:"email",type:"email",name:"email",value:s.email,onChange:Ce,placeholder:"email@example.com"})]}),(0,N.jsxs)(Jf,{children:[(0,N.jsx)(Xf,{htmlFor:"email2",children:"Email 2"}),(0,N.jsx)(Qf,{id:"email2",type:"email",name:"email2",value:s.email2,onChange:Ce,placeholder:"email@example.com"})]}),(0,N.jsxs)(Jf,{children:[(0,N.jsx)(Xf,{htmlFor:"email3",children:"Email 3"}),(0,N.jsx)(Qf,{id:"email3",type:"email",name:"email3",value:s.email3,onChange:Ce,placeholder:"email@example.com"})]})]}),(0,N.jsx)(Yf,{children:"Additional Information"}),(0,N.jsx)(Kf,{children:(0,N.jsxs)(Jf,{className:"full-width",children:[(0,N.jsx)(Xf,{htmlFor:"about_the_contact",children:"About the Contact"}),(0,N.jsx)(eg,{id:"about_the_contact",name:"about_the_contact",value:s.about_the_contact,onChange:Ce,placeholder:"Enter notes and details about this contact..."})]})})]}),"merge"===i&&(()=>{if(0===b.length)return(0,N.jsx)(pg,{children:(0,N.jsxs)("p",{style:{textAlign:"center",padding:"40px 0",color:"#6b7280"},children:["No duplicate contacts found for ",r.first_name," ",r.last_name,"."]})});const e={...r,tags:c,companies:u,cities:h};return(0,N.jsxs)(pg,{children:[_&&(0,N.jsx)("div",{style:{backgroundColor:"#dcfce7",color:"#166534",padding:"8px 12px",borderRadius:"4px",marginBottom:"16px"},children:_}),E&&(0,N.jsx)("div",{style:{backgroundColor:"#fee2e2",color:"#b91c1c",padding:"8px 12px",borderRadius:"4px",marginBottom:"16px"},children:E}),(0,N.jsx)("h3",{style:{marginBottom:"16px"},children:"Duplicate Contacts"}),(0,N.jsx)("p",{style:{marginBottom:"16px",color:"#6b7280",fontSize:"0.875rem"},children:"The following contacts have the same name. Review and delete duplicates as needed."}),(0,N.jsxs)(hg,{duplicatesCount:b.length,children:[(0,N.jsxs)(fg,{isMain:!0,children:[(0,N.jsx)("h3",{children:(0,N.jsxs)(mg,{children:[(0,N.jsx)(B.A3x,{size:12}),"Main Contact"]})}),(0,N.jsxs)(yg,{children:[(0,N.jsx)("div",{className:"label",children:"ID"}),(0,N.jsx)("div",{className:"value",children:e.id})]}),(0,N.jsxs)(yg,{children:[(0,N.jsx)("div",{className:"label",children:"Created"}),(0,N.jsx)("div",{className:"value",children:we(e.created_at)})]}),(0,N.jsxs)(yg,{children:[(0,N.jsx)("div",{className:"label",children:"Last Modified"}),(0,N.jsx)("div",{className:"value",children:we(e.last_modified)})]}),(0,N.jsxs)(yg,{children:[(0,N.jsx)("div",{className:"label",children:"Email"}),(0,N.jsx)("input",{type:"email",name:"email",value:s.email,onChange:Ce,className:"value"})]}),(0,N.jsxs)(yg,{children:[(0,N.jsx)("div",{className:"label",children:"Email 2"}),(0,N.jsx)("input",{type:"email",name:"email2",value:s.email2,onChange:Ce,className:"value"})]}),(0,N.jsxs)(yg,{children:[(0,N.jsx)("div",{className:"label",children:"Email 3"}),(0,N.jsx)("input",{type:"email",name:"email3",value:s.email3,onChange:Ce,className:"value"})]}),(0,N.jsxs)(yg,{children:[(0,N.jsx)("div",{className:"label",children:"Mobile"}),(0,N.jsx)("input",{type:"tel",name:"mobile",value:s.mobile,onChange:Ce,className:"value"})]}),(0,N.jsxs)(yg,{children:[(0,N.jsx)("div",{className:"label",children:"Mobile 2"}),(0,N.jsx)("input",{type:"tel",name:"mobile2",value:s.mobile2,onChange:Ce,className:"value"})]}),(0,N.jsxs)(yg,{children:[(0,N.jsx)("div",{className:"label",children:"LinkedIn"}),(0,N.jsx)("input",{type:"text",name:"linkedin",value:s.linkedin,onChange:Ce,className:"value"})]}),(0,N.jsxs)(vg,{children:[(0,N.jsx)("div",{className:"label",children:"Tags"}),(0,N.jsxs)("div",{className:"value-container",children:[e.tags.length>0?(0,N.jsx)("div",{className:"tags-list",children:e.tags.map((e=>{const{bg:t,text:o}=cg(e.name);return(0,N.jsxs)(sg,{color:t,textColor:o,style:{margin:"0 4px 4px 0"},children:[(0,N.jsx)("span",{children:e.name}),(0,N.jsx)(Cg,{onClick:()=>De(e),children:(0,N.jsx)(B.yGN,{size:14})})]},e.id)}))}):(0,N.jsx)("div",{className:"empty-message",children:"No tags"}),(0,N.jsxs)(_g,{onClick:Ie,children:[(0,N.jsx)(B.GGD,{size:16}),"Add Tags"]})]})]}),(0,N.jsxs)(vg,{children:[(0,N.jsx)("div",{className:"label",children:"Companies"}),(0,N.jsxs)("div",{className:"value-container",children:[e.companies.length>0?(0,N.jsx)("div",{className:"tags-list",children:e.companies.map((e=>(0,N.jsxs)(lg,{children:[(0,N.jsx)("span",{children:e.name}),(0,N.jsx)(Cg,{onClick:()=>Ne(e),children:(0,N.jsx)(B.yGN,{size:14})})]},e.id)))}):(0,N.jsx)("div",{className:"empty-message",children:"No companies"}),(0,N.jsxs)(_g,{onClick:Me,children:[(0,N.jsx)(B.GGD,{size:16}),"Add Company"]})]})]}),(0,N.jsxs)(vg,{children:[(0,N.jsx)("div",{className:"label",children:"Cities"}),(0,N.jsx)("div",{className:"value-container",children:e.cities.length>0?(0,N.jsx)("div",{className:"tags-list",children:e.cities.map((e=>(0,N.jsxs)(Sg,{children:[(0,N.jsx)("span",{children:e.name}),(0,N.jsx)(Cg,{onClick:()=>Ee(e),children:(0,N.jsx)(B.yGN,{size:14})})]},e.id)))}):(0,N.jsx)("div",{className:"empty-message",children:"No cities"})})]}),(0,N.jsx)(tg,{children:(0,N.jsxs)(ig,{onClick:Oe,children:[(0,N.jsx)(B.Bc_,{size:16}),"Save Main Contact"]})})]}),b.map((e=>(0,N.jsxs)(fg,{children:[(0,N.jsxs)("h3",{children:[(0,N.jsx)("span",{children:"Duplicate"}),(0,N.jsx)(gg,{onClick:()=>(async e=>{try{O(!0);const t=b.find((t=>t.id===e));if(!t)throw new Error("Duplicate contact not found");nt.oR.loading("Swapping contacts..."),l({first_name:t.first_name||"",last_name:t.last_name||"",email:t.email||"",email2:t.email2||"",email3:t.email3||"",mobile:t.mobile||"",mobile2:t.mobile2||"",job_title:t.job_title||"",contact_category:t.contact_category||"",about_the_contact:t.about_the_contact||"",linkedin:t.linkedin||""}),d(t.tags||[]),p(t.companies||[]),f(t.cities||[]),A(t);const o={...r,tags:c,companies:u,cities:h};x((t=>t.filter((t=>t.id!==e)).concat([o]))),nt.oR.dismiss(),nt.oR.success("Main contact changed successfully")}catch(t){console.error("Error making duplicate the main contact:",t),nt.oR.error("Failed to change main contact")}finally{O(!1)}})(e.id),disabled:R,children:"Make Main"})]}),(0,N.jsxs)(yg,{children:[(0,N.jsx)("div",{className:"label",children:"ID"}),(0,N.jsx)("div",{className:"value",children:e.id})]}),(0,N.jsxs)(yg,{children:[(0,N.jsx)("div",{className:"label",children:"Created"}),(0,N.jsx)("div",{className:"value",children:we(e.created_at)})]}),(0,N.jsxs)(yg,{children:[(0,N.jsx)("div",{className:"label",children:"Last Modified"}),(0,N.jsx)("div",{className:"value",children:we(e.last_modified)})]}),(0,N.jsxs)(yg,{className:e.email?"":"empty",children:[(0,N.jsx)("div",{className:"label",children:"Email"}),(0,N.jsx)("div",{className:"value",children:e.email||"Not set"}),(0,N.jsx)(xg,{onClick:()=>Re("email",e.email),children:(0,N.jsx)(B.kRp,{size:16})})]}),(0,N.jsxs)(yg,{className:e.email2?"":"empty",children:[(0,N.jsx)("div",{className:"label",children:"Email 2"}),(0,N.jsx)("div",{className:"value",children:e.email2||"Not set"}),(0,N.jsx)(xg,{onClick:()=>Re("email2",e.email2),children:(0,N.jsx)(B.kRp,{size:16})})]}),(0,N.jsxs)(yg,{className:e.email3?"":"empty",children:[(0,N.jsx)("div",{className:"label",children:"Email 3"}),(0,N.jsx)("div",{className:"value",children:e.email3||"Not set"}),(0,N.jsx)(xg,{onClick:()=>Re("email3",e.email3),children:(0,N.jsx)(B.kRp,{size:16})})]}),(0,N.jsxs)(yg,{className:e.mobile?"":"empty",children:[(0,N.jsx)("div",{className:"label",children:"Mobile"}),(0,N.jsx)("div",{className:"value",children:e.mobile||"Not set"}),(0,N.jsx)(xg,{onClick:()=>Re("mobile",e.mobile),children:(0,N.jsx)(B.kRp,{size:16})})]}),(0,N.jsxs)(yg,{className:e.mobile2?"":"empty",children:[(0,N.jsx)("div",{className:"label",children:"Mobile 2"}),(0,N.jsx)("div",{className:"value",children:e.mobile2||"Not set"}),(0,N.jsx)(xg,{onClick:()=>Re("mobile2",e.mobile2),children:(0,N.jsx)(B.kRp,{size:16})})]}),(0,N.jsxs)(yg,{className:e.linkedin?"":"empty",children:[(0,N.jsx)("div",{className:"label",children:"LinkedIn"}),(0,N.jsx)("div",{className:"value",children:e.linkedin||"Not set"}),(0,N.jsx)(xg,{onClick:()=>Re("linkedin",e.linkedin),children:(0,N.jsx)(B.kRp,{size:16})})]}),(0,N.jsxs)(vg,{className:0===e.tags.length?"empty":"",children:[(0,N.jsx)("div",{className:"label",children:"Tags"}),(0,N.jsx)("div",{className:"value-container",children:e.tags.length>0?(0,N.jsx)("div",{className:"tags-list",children:e.tags.map((t=>{const{bg:o,text:n}=cg(t.name);return(0,N.jsxs)(sg,{color:o,textColor:n,style:{margin:"0 4px 4px 0"},children:[(0,N.jsx)("span",{children:t.name}),(0,N.jsx)(Cg,{onClick:()=>(async(e,t)=>{try{const{error:o}=await D.supabase.from("contact_tags").delete().match({contact_id:e,tag_id:t});if(o)throw o;x((o=>o.map((o=>o.id===e?{...o,tags:o.tags.filter((e=>e.id!==t))}:o)))),nt.oR.success("Tag removed successfully")}catch(o){console.error("Error removing tag:",o),nt.oR.error("Failed to remove tag")}})(e.id,t.id),children:(0,N.jsx)(B.yGN,{size:14})}),(0,N.jsx)(wg,{onClick:()=>(async e=>{try{if(c.some((t=>t.id===e.id)))nt.oR.info("Tag already exists on main contact");else{const{error:t}=await D.supabase.from("contact_tags").insert({contact_id:r.id,tag_id:e.id});if(t)throw t;d((t=>[...t,e])),nt.oR.success("Tag added to main contact")}}catch(t){console.error("Error transferring tag:",t),nt.oR.error("Failed to transfer tag")}})(t),children:(0,N.jsx)(B.kRp,{size:14})})]},t.id)}))}):(0,N.jsx)("div",{className:"empty-message",children:"No tags"})})]}),(0,N.jsxs)(vg,{className:0===e.companies.length?"empty":"",children:[(0,N.jsx)("div",{className:"label",children:"Companies"}),(0,N.jsx)("div",{className:"value-container",children:e.companies.length>0?(0,N.jsx)("div",{className:"tags-list",children:e.companies.map((t=>(0,N.jsxs)(lg,{children:[(0,N.jsx)("span",{children:t.name}),(0,N.jsx)(Cg,{onClick:()=>(async(e,t)=>{try{const{error:o}=await D.supabase.from("contact_companies").delete().match({contact_id:e,company_id:t});if(o)throw o;x((o=>o.map((o=>o.id===e?{...o,companies:o.companies.filter((e=>e.id!==t))}:o)))),nt.oR.success("Company removed successfully")}catch(o){console.error("Error removing company:",o),nt.oR.error("Failed to remove company")}})(e.id,t.id),children:(0,N.jsx)(B.yGN,{size:14})}),(0,N.jsx)(wg,{onClick:()=>(async e=>{try{if(u.some((t=>t.id===e.id)))nt.oR.info("Company already exists on main contact");else{const{error:t}=await D.supabase.from("contact_companies").insert({contact_id:r.id,company_id:e.id});if(t)throw t;p((t=>[...t,e])),nt.oR.success("Company added to main contact")}}catch(t){console.error("Error transferring company:",t),nt.oR.error("Failed to transfer company")}})(t),children:(0,N.jsx)(B.kRp,{size:14})})]},t.id)))}):(0,N.jsx)("div",{className:"empty-message",children:"No companies"})})]}),(0,N.jsxs)(vg,{className:e.cities&&0===e.cities.length?"empty":"",children:[(0,N.jsx)("div",{className:"label",children:"Cities"}),(0,N.jsx)("div",{className:"value-container",children:e.cities&&e.cities.length>0?(0,N.jsx)("div",{className:"tags-list",children:e.cities.map((t=>(0,N.jsxs)(Sg,{children:[(0,N.jsx)("span",{children:t.name}),(0,N.jsx)(Cg,{onClick:()=>(async(e,t)=>{try{const{error:o}=await D.supabase.from("contact_cities").delete().eq("contact_id",e).eq("city_id",t);if(o)throw o;x((o=>o.map((o=>o.id===e?{...o,cities:o.cities.filter((e=>e.id!==t))}:o)))),nt.oR.success("City removed successfully")}catch(o){console.error("Error removing city:",o),nt.oR.error("Failed to remove city")}})(e.id,t.id),children:(0,N.jsx)(B.yGN,{size:14})}),(0,N.jsx)(wg,{onClick:()=>(async e=>{try{if(h.some((t=>t.id===e.id)))nt.oR.info("City already exists on main contact");else{const{error:t}=await D.supabase.from("contact_cities").insert({contact_id:r.id,city_id:e.id});if(t)throw t;f((t=>[...t,e])),nt.oR.success("City added to main contact")}}catch(t){console.error("Error transferring city:",t),nt.oR.error("Failed to transfer city")}})(t),children:(0,N.jsx)(B.kRp,{size:14})})]},t.id)))}):(0,N.jsx)("div",{className:"empty-message",children:"No cities"})})]}),(0,N.jsxs)(bg,{onClick:()=>(async e=>{console.log("Attempting to delete duplicate with ID:",e),C(!0),S(""),k("");const t=nt.oR.loading("Deleting contact and related data...",{duration:1e4});try{const o=b.find((t=>t.id===e));if(o){console.log("Found duplicate to delete:",o),console.log("Checking and deleting meeting associations...");const{error:t,data:n}=await D.supabase.from("meetings_contacts").select("*").eq("contact_id",e);if(t)console.error("Error checking meeting associations:",t);else if(n&&n.length>0){console.log(`Found ${n.length} meeting associations to delete`);const{error:t}=await D.supabase.from("meetings_contacts").delete().eq("contact_id",e);if(t)throw console.error("Error deleting meeting associations:",t),new Error("Could not delete meeting associations: "+t.message);console.log("Successfully deleted meeting associations")}else console.log("No meeting associations found");if(o.cities&&o.cities.length>0){console.log("Deleting cities associations...");for(const t of o.cities){const{error:o}=await D.supabase.from("contact_cities").delete().eq("contact_id",e).eq("city_id",t.id);o&&console.error(`Error deleting city ${t.id} association:`,o)}}if(o.tags&&o.tags.length>0){console.log("Deleting tags associations...");for(const t of o.tags){const{error:o}=await D.supabase.from("contact_tags").delete().eq("contact_id",e).eq("tag_id",t.id);o&&console.error(`Error deleting tag ${t.id} association:`,o)}}if(o.companies&&o.companies.length>0){console.log("Deleting company associations...");for(const t of o.companies){const{error:o}=await D.supabase.from("contact_companies").delete().eq("contact_id",e).eq("company_id",t.id);o&&console.error(`Error deleting company ${t.id} association:`,o)}}console.log("Checking for any other potential relationships...");const{data:r,error:i}=await D.supabase.from("contact_interactions").select("*").eq("contact_id",e);if(i)console.error("Error checking interactions:",i);else if(r&&r.length>0){console.log(`Found ${r.length} interaction records to delete`);const{error:t}=await D.supabase.from("contact_interactions").delete().eq("contact_id",e);t?console.error("Error deleting interactions:",t):console.log("Successfully deleted interaction records")}else console.log("No interaction records found");const{data:a,error:s}=await D.supabase.from("keep_in_touch").select("*").eq("contact_id",e);if(s)console.error("Error checking keep_in_touch records:",s);else if(a&&a.length>0){console.log(`Found ${a.length} keep_in_touch records to delete`);const{error:t}=await D.supabase.from("keep_in_touch").delete().eq("contact_id",e);t?console.error("Error deleting keep_in_touch records:",t):console.log("Successfully deleted keep_in_touch records")}else console.log("No keep_in_touch records found")}console.log("Double-checking for any remaining city associations...");const{data:n,error:r}=await D.supabase.from("contact_cities").select("*").eq("contact_id",e);if(r)console.error("Error checking remaining cities:",r);else if(n&&n.length>0){console.log("Found remaining city associations, deleting them all at once...");const{error:t}=await D.supabase.from("contact_cities").delete().eq("contact_id",e);t&&console.error("Error bulk deleting remaining cities:",t)}console.log("Deleting the contact itself...");const{error:i}=await D.supabase.from("contacts").delete().eq("id",e);if(i)throw console.error("Error deleting contact:",i),i;x((t=>{const o=t.filter((t=>t.id!==e));return console.log("Updated duplicate contacts:",o),o})),nt.oR.dismiss(t),nt.oR.success("Contact deleted successfully",{duration:3e3}),S("Contact deleted successfully."),setTimeout((()=>{S("")}),3e3)}catch(o){console.error("Error deleting contact:",o),nt.oR.dismiss(t);let e="Failed to delete contact.";o.message&&o.message.includes("foreign key constraint")&&(e=o.message.includes("meetings_contacts_contact_id_fkey")?"This contact is linked to meetings that prevented deletion. Please try again.":o.message.includes("contact_cities_contact_id_fkey")?"This contact has city associations that prevented deletion. Please try again.":"This contact has relationships that prevented deletion. Please try again."),nt.oR.error(e,{duration:5e3}),k(e+" Please try again."),setTimeout((()=>{k("")}),5e3)}finally{C(!1)}})(e.id),disabled:w,children:[(0,N.jsx)(B.IXo,{size:16}),"Delete Duplicate"]})]},e.id)))]})]})})(),"related"===i&&(()=>{const e=e=>(0,N.jsx)($e,{onClick:()=>(async e=>{try{const{data:t,error:o}=await D.supabase.from("contacts").select("*").eq("id",e).single();if(o)throw o;ae(t),re(!0)}catch(t){console.error("Error fetching contact details:",t),nt.oR.error("Error fetching contact details")}})(e.id),children:(0,N.jsxs)("div",{children:[(0,N.jsxs)(Ue,{children:[e.first_name," ",e.last_name,e.contact_category&&(0,N.jsx)(qe,{category:e.contact_category,children:"Skip"===e.contact_category?"\u274c Skip":"Inbox"===e.contact_category?"\ud83d\udcec Inbox":e.contact_category})]}),(0,N.jsxs)(We,{children:[e.job_title&&(0,N.jsxs)("span",{children:[e.job_title," \u2022 "]}),e.email||"No email"]})]})},e.id);return z?(0,N.jsx)("div",{style:{textAlign:"center",padding:"40px 0"},children:(0,N.jsx)("p",{children:"Loading related contacts..."})}):(0,N.jsxs)("div",{children:[(0,N.jsxs)(He,{children:[(0,N.jsxs)(Be,{isOpen:se.companies,onClick:()=>Xe("companies"),children:[(0,N.jsxs)("h3",{children:[(0,N.jsx)(B.ayE,{size:16}),"Related by Company (",T.length,")"]}),se.companies?(0,N.jsx)(B.yGN,{size:16}):(0,N.jsx)(B.GGD,{size:16})]}),(0,N.jsx)(Ve,{isOpen:se.companies,children:T.length>0?T.map((t=>e(t))):(0,N.jsx)(Je,{children:"No contacts with matching companies found"})})]}),(0,N.jsxs)(He,{children:[(0,N.jsxs)(Be,{isOpen:se.tags,onClick:()=>Xe("tags"),children:[(0,N.jsxs)("h3",{children:[(0,N.jsx)(B.cnX,{size:16}),"Related by Tags (",M.length,")"]}),se.tags?(0,N.jsx)(B.yGN,{size:16}):(0,N.jsx)(B.GGD,{size:16})]}),(0,N.jsx)(Ve,{isOpen:se.tags,children:M.length>0?Object.entries(ce).length>0?Object.entries(ce).map((t=>{let[o,n]=t;if(!n||0===n.length)return null;const r=ue[o];if(!r)return null;const{bg:i,text:a}=cg(r.name);return(0,N.jsxs)(Ke,{children:[(0,N.jsxs)(Ye,{bgColor:i,textColor:a,children:[(0,N.jsx)("span",{className:"tag-badge",children:r.name}),(0,N.jsxs)("span",{children:["(",n.length," contacts)"]})]}),n.map((t=>e(t)))]},o)})):M.map((t=>e(t))):(0,N.jsx)(Je,{children:"No contacts with matching tags found"})})]}),(0,N.jsxs)(He,{children:[(0,N.jsxs)(Be,{isOpen:se.category,onClick:()=>Xe("category"),children:[(0,N.jsxs)("h3",{children:[(0,N.jsx)(B.JXP,{size:16}),"Related by Category and City (",F.length,")"]}),se.category?(0,N.jsx)(B.yGN,{size:16}):(0,N.jsx)(B.GGD,{size:16})]}),(0,N.jsx)(Ve,{isOpen:se.category,children:F.length>0?F.map((t=>e(t))):(0,N.jsxs)(Je,{children:["No contacts with matching category (",(null===r||void 0===r?void 0:r.contact_category)||"None",") and city found"]})})]})]})})(),"intros"===i&&(X?(0,N.jsx)("div",{style:{textAlign:"center",padding:"40px 0"},children:(0,N.jsx)("p",{children:"Loading introductions..."})}):(0,N.jsxs)("div",{style:{padding:"24px"},children:[(0,N.jsxs)(Ng,{children:[(0,N.jsx)("h3",{style:{fontSize:"1.125rem",fontWeight:"600"},children:"Introductions History"}),(0,N.jsxs)(Pg,{onClick:()=>ee(!0),children:[(0,N.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,N.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 4v16m8-8H4"})}),"Add Introduction"]})]}),0===q.length?(0,N.jsx)("div",{style:{textAlign:"center",padding:"40px 0",color:"#6b7280"},children:(0,N.jsx)("p",{children:"No introductions found for this contact."})}):(0,N.jsxs)(jg,{children:[(0,N.jsx)(Ag,{children:(0,N.jsxs)("tr",{children:[(0,N.jsx)("th",{style:{width:"15%"},children:"Date"}),(0,N.jsx)("th",{style:{width:"25%"},children:"Introduced To"}),(0,N.jsx)("th",{style:{width:"20%"},children:"Rationale"}),(0,N.jsx)("th",{style:{width:"30%"},children:"Note"}),(0,N.jsx)("th",{style:{width:"10%"},children:"Actions"})]})}),(0,N.jsx)(Rg,{children:q.map((e=>{return(0,N.jsxs)("tr",{children:[(0,N.jsx)("td",{children:(0,ge.A)(new Date(e.intro_date),"dd/MM/yyyy")}),(0,N.jsx)("td",{children:(0,N.jsx)(Tg,{children:Ze(e.contacts_introduced)})}),(0,N.jsx)("td",{children:(0,N.jsx)(Og,{type:e.introduction_rationale,children:e.introduction_rationale})}),(0,N.jsx)("td",{children:(t=e.introduction_note,t?(0,N.jsx)(Dg,{"data-tooltip":t,children:t}):"-")}),(0,N.jsx)("td",{children:(0,N.jsxs)(ug,{children:[(0,N.jsx)(dg,{onClick:()=>(e=>{oe(e),ee(!0)})(e),title:"Edit",children:(0,N.jsx)(B.SG1,{size:16})}),(0,N.jsx)(dg,{onClick:()=>(async e=>{if(window.confirm("Are you sure you want to delete this introduction?"))try{const{error:t}=await D.supabase.from("contact_introductions").delete().eq("intro_id",e);if(t)throw t;nt.oR.success("Introduction deleted successfully"),Qe()}catch(t){console.error("Error deleting introduction:",t),nt.oR.error("Failed to delete introduction")}})(e.intro_id),delete:!0,title:"Delete",children:(0,N.jsx)(B.IXo,{size:16})})]})})]},e.intro_id);var t}))})]})]})),"deals"===i&&(0,N.jsx)("div",{children:"Deals tab content coming soon"}),"notes"===i&&(0,N.jsx)(Gf,{contact:r})]}),"merge"!==i&&(0,N.jsxs)(tg,{children:[(0,N.jsx)(rg,{onClick:n,children:"Cancel"}),(0,N.jsxs)(ig,{onClick:async()=>{try{const{error:e}=await D.supabase.from("contacts").update({first_name:s.first_name,last_name:s.last_name,email:s.email,email2:s.email2,email3:s.email3,mobile:s.mobile,mobile2:s.mobile2,job_title:s.job_title,contact_category:s.contact_category,about_the_contact:s.about_the_contact,linkedin:s.linkedin,last_modified:new Date}).eq("id",r.id);if(e)throw e;n()}catch(e){console.error("Error updating contact:",e),alert("Failed to update contact. Please try again.")}},children:[(0,N.jsx)(B.Bc_,{size:16}),"Save Changes"]})]})]})}),(0,N.jsx)(Fo.A,{isOpen:Z,onRequestClose:()=>{ee(!1),oe(null),Qe()},preSelectedContact:r,editingIntro:te}),g&&(0,N.jsx)(pt.A,{isOpen:g,onRequestClose:()=>{m(!1),Te()},contact:r}),y&&(0,N.jsx)(Do,{isOpen:y,onRequestClose:()=>{v(!1),Pe()},contact:r}),V&&(0,N.jsx)(Lo.A,{isOpen:V,onRequestClose:()=>{$(!1),ze()},contact:r}),ne&&ie&&(0,N.jsx)(Ig,{isOpen:ne,onRequestClose:()=>{re(!1),ae(null)},contact:ie})]})},Mg=Ig;ot().setAppElement("#root");const Lg=P.Ay.div`
  position: relative;
  width: 100%;
`,Fg=P.Ay.div`
  position: absolute;
  top: 0;
  left: 0;
  right: 0;
  bottom: 0;
  background-color: rgba(255, 255, 255, 0.9);
  display: flex;
  align-items: center;
  justify-content: center;
  z-index: 100;
  transition: opacity 0.2s ease-in-out;
  
  p {
    background-color: white;
    padding: 1rem 2rem;
    border-radius: 0.5rem;
    box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
    font-weight: 500;
  }
`,Gg=P.Ay.table`
  width: 100%;
  border-collapse: separate;
  border-spacing: 0;
  margin-bottom: 1.5rem;
  table-layout: fixed; /* Use fixed layout for better column control */
  padding: 0 1rem;
  
  /* Column width specifications - adjusted as requested */
  th:nth-child(1) { width: 15%; }    /* Name column - reduced by 3% */
  th:nth-child(2) { width: 18%; }    /* Company column - increased by 3% */
  th:nth-child(3) { width: 18%; }    /* Tags column */
  th:nth-child(4) { width: 9%; }     /* Last Interaction column */
  th:nth-child(5) { width: 10%; }    /* Category column - increased by 2% */
  th:nth-child(6) { width: 8%; }     /* Keep in Touch column */
  th:nth-child(7) { width: 6%; }     /* Score column */
  th:nth-child(8) { width: 16%; }    /* Actions column - increased by 3% */
  
  @media (max-width: 1200px) {
    th:nth-child(3) { width: 16%; } /* Slightly reduce Tags column on smaller screens */
    th:nth-child(8) { width: 18%; } /* Increase Actions column on smaller screens */
  }
`,zg=P.Ay.thead`
  background-color: white;
  
  th {
    padding: 0.875rem 1rem;
    text-align: left;
    font-weight: 700;
    font-size: 0.75rem;
    color: black;
    border-bottom: 1px solid black;
    position: sticky;
    top: 0;
    z-index: 10;
    white-space: nowrap;
  }
`,Hg=P.Ay.tbody`
  tr {
    border-bottom: 1px solid #e5e7eb;
    transition: background-color 0.15s;
    
    &:hover {
      background-color: #f9fafb;
    }
    
    &:last-child {
      border-bottom: none;
    }
  }
  
  td {
    padding: 0.875rem 1rem;
    font-size: 0.875rem;
    color: #1f2937;
    vertical-align: middle;
    
    &.actions-cell {
      padding-right: 0.5rem; /* Reduce right padding */
      min-width: 120px; /* Increased from 110px to match column width increase */
      white-space: nowrap; /* Prevent wrapping */
      overflow: visible; /* Allow overflow */
    }
    
    .cell-content {
  display: flex;
  align-items: center;
    }
    
    .actions {
      margin-left: auto;
      display: flex;
      visibility: hidden;
    }
    
    &:hover .actions {
      visibility: visible;
    }
    
    input, select {
  width: 100%;
      padding: 0.5rem;
      border: 1px solid #d1d5db;
      border-radius: 0.25rem;
      font-size: 0.875rem;
      background-color: white;
      
      &:focus {
        outline: none;
        border-color: #3b82f6;
        box-shadow: 0 0 0 2px rgba(59, 130, 246, 0.25);
      }
    }
  }
`,Bg=P.Ay.button`
  background-color: transparent;
  border: none;
  color: black;
  width: 26px; /* Slightly reduced from 28px */
  height: 26px; /* Slightly reduced from 28px */
  border-radius: 0.25rem;
  display: flex;
  align-items: center;
  justify-content: center;
  cursor: pointer;
  font-size: 0.9rem; /* Slightly reduced from 1rem */
  transition: all 0.2s;
  padding: 0; /* Ensure no extra padding */
  margin: 0 1px; /* Add tiny horizontal margins */
  
  &:hover {
    background-color: #f3f4f6;
    color: #1f2937;
  }
  
  &.edit:hover {
    color: #3b82f6;
  }
  
  &.delete:hover {
    color: #ef4444;
  }
  
  &.whatsapp:hover {
    color: #25D366;
  }
  
  &.email:hover {
    color: #4285F4;
  }
  
  &.linkedin:hover {
    color: #0077B5;
  }
  
  &.hubspot:hover {
    color: #FF7A59;
  }
`,Vg=P.Ay.div`
  display: flex;
  align-items: center;
`,$g=P.Ay.span`
  color: ${e=>e.filled?"#f59e0b":"#d1d5db"};
  cursor: pointer;
  margin-right: 2px;
  transition: color 0.2s;
  display: flex;
  align-items: center;
  
  svg {
    stroke: black;
    stroke-width: ${e=>(e.filled,"2px")};
  }
  
  &:hover {
    color: #f59e0b;
  }
`,Ug=P.Ay.span`
  display: inline-flex;
  align-items: center;
  padding: 0.25rem 0.5rem;
  font-size: 0.75rem;
  border-radius: 1rem;
  background-color: ${e=>e.color||"#f3f4f6"};
  color: ${e=>e.textColor||"#4b5563"};
  font-weight: 500;
  margin-right: 0.25rem;
  margin-bottom: 0.25rem;
  border: 1px solid black;
  
  button {
  background: none;
  border: none;
    padding: 0;
    display: inline-flex;
  align-items: center;
  justify-content: center;
    margin-left: 0.25rem;
  color: #6b7280;
  cursor: pointer;
  
  &:hover { 
    color: #ef4444; 
  }
  }
`,Wg=(P.Ay.button`
  display: flex;
  align-items: center;
  justify-content: center;
  width: 20px;
  height: 20px;
  border-radius: 50%;
  background-color: #e5e7eb;
  border: none;
  color: #6b7280;
  font-size: 0.75rem;
  cursor: pointer;
  margin-left: 0.5rem;
  transition: all 0.2s;
  
  &:hover { 
    background-color: #d1d5db;
    color: #1f2937;
  }
`,P.Ay.div`
  display: flex;
  flex-wrap: wrap;
  align-items: center;
  width: 100%; /* Use full width of the cell */
  min-width: 0; /* Allow proper truncation */
`),qg=P.Ay.span`
  display: inline-flex;
  align-items: center;
  justify-content: center;
  padding: 0.15rem 0.25rem;
  min-width: 80px;
  font-size: 0.7rem;
  border-radius: 0.375rem;
  background-color: ${e=>"Inbox"===e.category?"#ffefef":(e.category,"#f3f4f6")};
  color: ${e=>"Inbox"===e.category?"#ef4444":(e.category,"#4b5563")};
  font-weight: 500;
  margin-right: 0.25rem;
  margin-bottom: 0.25rem;
`,Kg=P.Ay.span`
  display: inline-flex;
  align-items: center;
  padding: 0.25rem 0.5rem;
  font-size: 0.75rem;
  border-radius: 0.25rem;
  background-color: ${e=>{switch(e.frequency){case"Monthly":return"#000000";case"Quarterly":return"#444444";case"Twice a year":return"#888888";default:return"#ffffff"}}};
  color: ${e=>{switch(e.frequency){case"Monthly":case"Quarterly":return"#ffffff";case"Twice a year":return"#333333";default:return"#000000"}}};
  font-weight: 500;
  border: 1px solid #d1d5db;
`,Yg=P.Ay.span`
  color: #000000;
  font-weight: normal;
  position: relative; /* Added for overlay positioning */
`,Jg=(P.Ay.div`
  position: absolute;
  top: 0;
  left: 0;
  right: 0;
  bottom: 0;
  background-color: rgba(59, 130, 246, 0.1);
  display: flex;
  align-items: center;
  justify-content: center;
  opacity: 0;
  transition: opacity 0.2s;
  cursor: pointer;
  
  &:hover {
    opacity: 1;
  }
  
  span {
    background-color: #3b82f6;
    color: white;
    padding: 0.25rem 0.5rem;
    border-radius: 0.25rem;
    font-size: 0.75rem;
    font-weight: 500;
  }
`,P.Ay.div`
  position: relative;
  display: inline-flex;
  
  .tooltip-text {
    visibility: hidden;
    position: absolute;
    z-index: 100;
    bottom: 125%;
    left: 50%;
    transform: translateX(-50%);
    background-color: #1f2937;
    color: white;
    text-align: center;
    padding: 3px 6px;
    border-radius: 4px;
    font-size: 0.7rem; /* Smaller font size */
    white-space: nowrap;
    opacity: 0;
    transition: opacity 0.3s;
    pointer-events: none; /* Prevent tooltip from interfering with clicks */
  }
  
  &:hover .tooltip-text {
    visibility: visible;
    opacity: 1;
  }
`),Xg=P.Ay.div`
  display: flex;
  align-items: center;
  gap: 0.25rem; /* Reduced from 0.5rem to create more compact spacing */
  flex-wrap: wrap; /* Allow wrapping if needed */
  justify-content: flex-start;
  width: 100%;
  
  /* Ensure consistent spacing when wrapping */
  & > * {
    margin-bottom: 2px;
  }
`,Qg=P.Ay.div`
  display: flex;
  align-items: center;
  justify-content: flex-end;
  padding: 1rem 0;
`,Zg=P.Ay.button`
  background-color: ${e=>e.active?"#3b82f6":"white"};
  color: ${e=>e.active?"white":"#4b5563"};
  border: 1px solid ${e=>e.active?"#3b82f6":"#d1d5db"};
  padding: 0.375rem 0.75rem;
  font-size: 0.875rem;
  border-radius: 0.25rem;
  cursor: ${e=>e.disabled?"not-allowed":"pointer"};
  opacity: ${e=>e.disabled?.5:1};
  margin: 0 0.25rem;
  transition: all 0.2s;
  
  &:hover:not(:disabled) {
    background-color: ${e=>e.active?"#2563eb":"#f9fafb"};
  }
  
  &:focus {
    outline: none;
    box-shadow: 0 0 0 2px rgba(59, 130, 246, 0.25);
  }
`,em=(P.Ay.div`
  margin: 0 0.75rem;
  font-size: 0.875rem;
  color: #4b5563;
`,P.Ay.div`
  display: flex;
  flex-direction: column;
  align-items: center;
  justify-content: center;
  padding: 3rem 1rem;
  text-align: center;
  
  h3 {
    font-size: 1.125rem;
    font-weight: 500;
    color: #4b5563;
  margin-bottom: 0.5rem;
  }
  
  p {
    color: #6b7280;
  font-size: 0.875rem;
  }
`,P.Ay.span`
  display: block;
  max-width: ${e=>e.maxWidth||"150px"};
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
`,P.Ay.span`
  display: inline-flex;
  align-items: center;
  padding: 0.25rem 0.5rem;
  font-size: 0.75rem;
  border-radius: 0.375rem;
  background-color: white;
  color: black;
  font-weight: 500;
  margin-right: 0.25rem;
  margin-bottom: 0.25rem;
  border: 1px solid black;
  text-transform: uppercase;
  
  button {
  background: none;
  border: none;
    padding: 0;
    display: inline-flex;
    align-items: center;
    justify-content: center;
    margin-left: 0.25rem;
    color: #6b7280;
  cursor: pointer;
  
  &:hover {
      color: #ef4444;
    }
  }
`),tm=P.Ay.div`
  display: flex;
  flex-wrap: wrap;
  align-items: center;
`,om=P.Ay.span`
  display: inline-flex;
  align-items: center;
  justify-content: center;
  padding: 0.2rem 0.45rem;
  border-radius: 9999px;
  font-size: 0.75rem;
  font-weight: 500;
  background-color: #e5e7eb;
  color: #4b5563;
  cursor: pointer;
  line-height: 1.2;
  margin-left: 3px;
  vertical-align: top;
  transform: translateY(-1px); /* Fine-tune vertical alignment */
  
  &:hover {
    background-color: #d1d5db;
  }
`,nm=e=>{const t=[{bg:"#fee2e2",text:"#b91c1c"},{bg:"#fef3c7",text:"#92400e"},{bg:"#ecfccb",text:"#3f6212"},{bg:"#d1fae5",text:"#065f46"},{bg:"#e0f2fe",text:"#0369a1"},{bg:"#ede9fe",text:"#5b21b6"},{bg:"#fae8ff",text:"#86198f"},{bg:"#fce7f3",text:"#9d174d"}];return t[e.split("").reduce(((e,t)=>e+t.charCodeAt(0)),0)%t.length]};const rm=P.Ay.td`
  cursor: pointer;
  position: relative;
  transition: background-color 0.2s;
  
  /* For proper content handling */
  overflow: hidden; /* Prevent content overflow */
  
  .cell-content {
    display: flex;
    align-items: center;
    width: 100%;
    min-width: 0; /* Allow children to truncate */
    padding: 0.25rem 0; /* Add some vertical padding */
  }
  
  &:hover {
    background-color: #f3f4f6;
  }
  
  &:hover::after {
    content: "${e=>e.hoverText||"Click to edit"}";
    position: absolute;
    top: 0;
    right: 0;
    background-color: #000000;
    color: white;
    font-size: 10px;
    padding: 2px 5px;
    border-radius: 0 0 0 4px;
    opacity: 0.9;
    z-index: 10; /* Ensure it's above other elements */
  }
`,im=P.Ay.div`
  position: fixed;
  top: 0;
  left: 0;
  right: 0;
  bottom: 0;
  background-color: rgba(0, 0, 0, 0.5);
  display: flex;
  align-items: center;
  justify-content: center;
  z-index: 1000;
`,am=P.Ay.div`
  background-color: white;
  border-radius: 8px;
  width: 90%;
  max-width: 600px;
  max-height: 80vh;
  overflow-y: auto;
  padding: 24px;
  box-shadow: 0 10px 25px rgba(0, 0, 0, 0.1);
`,sm=P.Ay.div`
  display: flex;
  justify-content: space-between;
  align-items: center;
  margin-bottom: 16px;
  
  h2 {
    margin: 0;
    font-size: 1.25rem;
  }
  
  button {
  background: none;
  border: none;
  cursor: pointer;
    color: #6b7280;
    
  &:hover {
      color: #1f2937;
    }
  }
`,lm=P.Ay.div`
  font-weight: 500;
  color: #111827;
  
  /* Text truncation styling */
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
  max-width: 100%;
  min-width: 0;
  display: block; /* Better for consistent spacing */
`,cm=(P.Ay.div`
  font-size: 0.875rem;
  color: #6b7280;
  margin-bottom: 8px;
`,P.Ay.div`
  display: flex;
  gap: 8px;
`,(e,t)=>{const o=[e||"",t||""].filter(Boolean).join(" ");if(!o)return{displayName:"Unknown",fullName:"Unknown",isTruncated:!1};const n=o.length>20;return{displayName:n?o.substring(0,20)+"...":o,fullName:o,isTruncated:n}}),dm=P.Ay.td`
  cursor: pointer;
  transition: background-color 0.2s;
  
  &:hover {
    background-color: #f3f4f6; /* Same gray color as ClickableCell hover */
  }
`,um=(0,t.forwardRef)(((e,o)=>{let{defaultShowAll:n=!1,defaultFilter:r="all",searchTerm:i="",searchField:a="name",activeFilter:s=null,onCountUpdate:l=()=>{},refreshTrigger:c=0}=e;const[d,u]=(0,t.useState)({lastInteraction:0,recentlyCreated:0,missingKeepInTouch:0,missingScore:0,missingCities:0,missingCompanies:0,missingTags:0}),[p,h]=(0,t.useState)(!0),[f,g]=(0,t.useState)(null),[m,y]=(0,t.useState)(0),[v,b]=(0,t.useState)([]),[x,w]=(0,t.useState)(0),[C,_]=(0,t.useState)(0),[S,E]=(0,t.useState)(1),[k,j]=(0,t.useState)({}),[A,R]=(0,t.useState)([]),[O,T]=(0,t.useState)("last_modified desc"),[P,I]=(0,t.useState)("none"),[M,L]=(0,t.useState)(null),[F,G]=(0,t.useState)(null),[z,H]=(0,t.useState)({}),[V,$]=(0,t.useState)({}),[U,W]=(0,t.useState)(""),[q,K]=(0,t.useState)(!1),Y=async()=>{try{const e=new Date;e.setDate(e.getDate()-7);const t=e.toISOString(),{count:o}=await D.supabase.from("contacts").select("*",{count:"exact",head:!0}).gte("last_interaction",t).not("category","eq","Skip"),{count:n}=await D.supabase.from("contacts").select("*",{count:"exact",head:!0}).eq("category","Inbox"),{count:r}=await D.supabase.from("contacts").select("*",{count:"exact",head:!0}).is("keep_in_touch_frequency",null).not("category","eq","Skip").not("category","eq","WhatsApp Group Contact"),i=new Date;i.setDate(i.getDate()-7);const a=i.toISOString(),{count:s}=await D.supabase.from("contacts").select("*",{count:"exact",head:!0}).is("score",null).not("category","eq","Skip").not("category","eq","WhatsApp Group Contact").gte("last_interaction",a),{data:l,error:c}=await D.supabase.rpc("get_contacts_without_cities_count");let d=0;c?console.error("Error fetching missing cities count:",c):d=Array.isArray(l)&&l.length>0?l[0].count:"object"===typeof l&&null!==l?l.count:l||0;const{data:p,error:h}=await D.supabase.rpc("get_contacts_without_companies_count");let f=0;h?console.error("Error fetching missing companies count:",h):f=Array.isArray(p)&&p.length>0?p[0].count:"object"===typeof p&&null!==p?p.count:p||0;const{data:g,error:m}=await D.supabase.rpc("get_contacts_without_tags_count");let y=0;return m?console.error("Error fetching missing tags count:",m):y=Array.isArray(g)&&g.length>0?g[0].count:"object"===typeof g&&null!==g?g.count:g||0,u({lastInteraction:o||0,recentlyCreated:n||0,missingKeepInTouch:r||0,missingScore:s||0,missingCities:d||0,missingCompanies:f||0,missingTags:y||0}),{lastInteraction:o||0,recentlyCreated:n||0,missingKeepInTouch:r||0,missingScore:s||0,missingCities:d||0,missingCompanies:f||0,missingTags:y||0}}catch(f){return console.error("Error calculating filter counts:",f),null}},[J,X]=(0,t.useState)(null),[Q,Z]=(0,t.useState)("contact"),[ee,te]=(0,t.useState)(null),[oe,ne]=(0,t.useState)(!1),[re,ie]=(0,t.useState)(!1),[ae,se]=(0,t.useState)({}),[le,ce]=(0,t.useState)(""),[de,ue]=(0,t.useState)(null),[pe,he]=(0,t.useState)({}),[fe,ge]=(0,t.useState)(!1),[me,ye]=(0,t.useState)(""),[ve,be]=(0,t.useState)(""),[xe,we]=(0,t.useState)(null),Ce=function(e,o){const[n,r]=(0,t.useState)(e);return(0,t.useEffect)((()=>{const t=setTimeout((()=>{r(e)}),o);return()=>{clearTimeout(t)}}),[e,o]),n}(i,300),[_e,Se]=(0,t.useState)(""),[Ee,ke]=(0,t.useState)(!1),[je,Re]=(0,t.useState)(null),[Oe,Ne]=(0,t.useState)(!1),[Ie,Me]=(0,t.useState)(!1),[Le,Fe]=(0,t.useState)(null),[Ge,ze]=(0,t.useState)(new Set),He=(0,t.useCallback)((async e=>{if(!e||0===e.length)return;const t=new Set,o=new Map;e.forEach((e=>{e.email&&(o.has(e.email)?(t.add(e.id),t.add(o.get(e.email))):o.set(e.email,e.id))}));const n=new Map;e.forEach((e=>{e.mobile&&(n.has(e.mobile)?(t.add(e.id),t.add(n.get(e.mobile))):n.set(e.mobile,e.id))})),ze(t)}),[]),Ve=(0,t.useCallback)((async()=>{var e,t,o,n,r,i;if(!Ce&&""!==Ce&&!s)return;let c="last_modified desc, last_interaction desc",u="category != Skip";try{h(!0),g(null);let p=D.supabase.from("contacts").select("*, contact_companies:contact_companies(contact_id, company_id, companies(id, name, website))");if(s)switch(s){case"recentlyCreated":const a=10*m,s=a+9;p=p.eq("category","Inbox").order("created_at",{ascending:!1}).range(a,s),c="created_at desc",u="category is Inbox";break;case"lastInteraction":const l=new Date;l.setDate(l.getDate()-7);const d=l.toISOString(),f=10*m,g=f+9;p=p.gte("last_interaction",d).not("category","eq","Skip").not("category","eq","WhatsApp Group Contact").order("last_interaction",{ascending:!1}).range(f,g),c="last_interaction desc",u=`last_interaction >= ${d}, excluding "Skip" and "WhatsApp Group Contact" categories`;break;case"missingKeepInTouch":const y=10*m,v=y+9;p=p.is("keep_in_touch_frequency",null).not("category","eq","Skip").not("category","eq","WhatsApp Group Contact").order("last_modified",{ascending:!1}).range(y,v),c="last_modified desc",u="keep_in_touch_frequency is null, excluding Skip and WhatsApp Group Contact categories";break;case"missingScore":const x=new Date;x.setDate(x.getDate()-7);const C=x.toISOString(),S=10*m,E=S+9;p=p.is("score",null).not("category","eq","Skip").not("category","eq","WhatsApp Group Contact").gte("last_interaction",C).order("last_interaction",{ascending:!1}).range(S,E),c="last_interaction desc",u="score is null, excluding Skip and WhatsApp Group Contact categories, with recent interactions";break;case"keepInTouch":p=p.not("keep_in_touch_frequency","is",null).not("keep_in_touch_frequency","eq","Do not keep"),c="calculated due date (asc)",u='keep_in_touch_frequency is not null AND keep_in_touch_frequency != "Do not keep"';break;case"missingInfos":p=p.order("last_interaction",{ascending:!1}),c="last_interaction desc",u="missing required fields (applied after fetch)";break;case"missingCities":const{data:k,error:j}=await D.supabase.rpc("get_contacts_without_cities",{page_size:10,page_number:m,search_term:Ce||""});if(j)throw j;const{data:A,error:R}=await D.supabase.rpc("get_contacts_without_cities_count");if(R)throw R;const O=k?k.map((e=>e.id)):[];if(w((null===(e=A[0])||void 0===e?void 0:e.count)||0),_((null===(t=A[0])||void 0===t?void 0:t.count)||0),O.length>0){const{data:e}=await D.supabase.from("contact_companies").select("contact_id, company_id, companies:company_id(id, name, website)").in("contact_id",O),t=k.map((t=>{const o=e?e.filter((e=>e.contact_id===t.id)):[];return{...t,contact_companies:o,companiesList:o.map((e=>{var t,o;return{id:e.company_id,name:(null===(t=e.companies)||void 0===t?void 0:t.name)||"Unknown",website:null===(o=e.companies)||void 0===o?void 0:o.website}}))}}));b(t)}else b([]);return void h(!1);case"missingCompanies":const{data:T,error:P}=await D.supabase.rpc("get_contacts_without_companies",{page_size:10,page_number:m,search_term:Ce||""});if(P)throw P;const{data:N,error:I}=await D.supabase.rpc("get_contacts_without_companies_count");if(I)throw I;return b(T||[]),w((null===(o=N[0])||void 0===o?void 0:o.count)||0),_((null===(n=N[0])||void 0===n?void 0:n.count)||0),void h(!1);case"missingTags":const{data:M,error:L}=await D.supabase.rpc("get_contacts_without_tags",{page_size:10,page_number:m,search_term:Ce||""});if(L)throw L;const{data:F,error:G}=await D.supabase.rpc("get_contacts_without_tags_count");if(G)throw G;const z=M?M.map((e=>e.id)):[];if(w((null===(r=F[0])||void 0===r?void 0:r.count)||0),_((null===(i=F[0])||void 0===i?void 0:i.count)||0),c="last_interaction desc",u="contacts without tags and recent interactions",z.length>0){const{data:e}=await D.supabase.from("contact_companies").select("contact_id, company_id, companies:company_id(id, name, website)").in("contact_id",z),t=M.map((t=>{const o=e?e.filter((e=>e.contact_id===t.id)):[];return{...t,contact_companies:o,companiesList:o.map((e=>{var t,o;return{id:e.company_id,name:(null===(t=e.companies)||void 0===t?void 0:t.name)||"Unknown",website:null===(o=e.companies)||void 0===o?void 0:o.website}}))}}));b(t)}else b([]);return void h(!1);default:p=p.order("last_modified",{ascending:!1})}else if(Ce&&Ce.length>=3){switch(a){case"name":p=p.or(`first_name.ilike.%${Ce}%,last_name.ilike.%${Ce}%`),u=`first_name ILIKE "%${Ce}%" OR last_name ILIKE "%${Ce}%"`;break;case"email":p=p.ilike("email",`%${Ce}%`),u=`email ILIKE "%${Ce}%"`;break;case"mobile":p=p.ilike("mobile",`%${Ce}%`),u=`mobile ILIKE "%${Ce}%"`;break;case"city":p=p.ilike("city",`%${Ce}%`),u=`city ILIKE "%${Ce}%"`;break;default:p=p.or(`first_name.ilike.%${Ce}%,last_name.ilike.%${Ce}%`),u=`Search in ${a}: "${Ce}" (applied after fetch)`}p=p.order("last_modified",{ascending:!1}).order("last_interaction",{ascending:!1})}else p=p.order("last_modified",{ascending:!1}).order("last_interaction",{ascending:!1});T(c),I(u);const f=10*m,y=f+9;p=p.range(f,y);const{data:v,error:x}=await p,S=v||[];if(x)throw x;S&&S.length>0&&(console.log("Sample contact data:",S[0]),console.log("Keep in touch values:",S.map((e=>({id:e.id,keep_in_touch_frequency:e.keep_in_touch_frequency,type:typeof e.keep_in_touch_frequency})))));let k=D.supabase.from("contacts").select("*",{count:"exact",head:!0}).not("category","eq","Skip");if(Y(),s)switch(s){case"recentlyCreated":k=k.eq("category","Inbox");break;case"lastInteraction":const e=new Date;e.setDate(e.getDate()-7);const t=e.toISOString();k=k.gte("last_interaction",t).not("category","eq","Skip");break;case"keepInTouch":k=k.not("keep_in_touch_frequency","is",null).not("keep_in_touch_frequency","eq","Do not keep");break;case"missingKeepInTouch":k=k.is("keep_in_touch_frequency",null).not("category","eq","Skip");break;case"missingScore":const o=new Date;o.setDate(o.getDate()-7);const n=o.toISOString();k=k.is("score",null).not("category","eq","Skip").gte("last_interaction",n);break;case"missingCities":case"missingCompanies":case"missingTags":return}else if(Ce&&Ce.length>=3)switch(a){case"name":k=k.or(`first_name.ilike.%${Ce}%,last_name.ilike.%${Ce}%`);break;case"email":k=k.ilike("email",`%${Ce}%`);break;case"mobile":k=k.ilike("mobile",`%${Ce}%`);break;case"city":k=k.ilike("city",`%${Ce}%`)}const{count:A,error:R}=await k;if(R)throw R;if(w(A||0),E(Math.ceil((A||0)/10)),l&&l(A||0,d),S&&S.length>0){const e=S.map((e=>e.id)),{data:t,error:o}=await D.supabase.from("contact_tags").select("*, tag_id(*)").in("contact_id",e);if(o)throw o;const n={};null===t||void 0===t||t.forEach((e=>{n[e.contact_id]||(n[e.contact_id]=[]),n[e.contact_id].push({id:e.id,name:e.tag_id.name,tag_id:e.tag_id.id})})),j(n),S.forEach((e=>{e.companiesList=[],e.contact_companies&&e.contact_companies.forEach((t=>{t.companies&&e.companiesList.push({id:t.company_id,name:t.companies.name,website:t.companies.website})}))}));let r=[...S];if(Ce&&Ce.length>=3&&("company"===a?r=r.filter((e=>e.companiesList.some((e=>e.name.toLowerCase().includes(Ce.toLowerCase()))))):"tags"===a&&(r=r.filter((e=>(n[e.id]||[]).some((e=>e.name.toLowerCase().includes(Ce.toLowerCase()))))))),("company"===a||"tags"===a)&&Ce&&Ce.length>=3){const{data:e,error:t}=await D.supabase.from("contacts").select("id, contact_companies:contact_companies(company_id, companies:company_id(name))").not("category","eq","Skip");if(!t&&e){const t=e.map((e=>e.id));if("tags"===a){const{data:o}=await D.supabase.from("contact_tags").select("contact_id, tag_id(name)").in("contact_id",t);if(o){const t={};o.forEach((e=>{t[e.contact_id]||(t[e.contact_id]=[]),e.tag_id&&t[e.contact_id].push(e.tag_id.name)}));const n=e.filter((e=>(t[e.id]||[]).some((e=>e.toLowerCase().includes(Ce.toLowerCase()))))).length;_(n),E(Math.ceil(n/10))}}else if("company"===a){const t=e.filter((e=>!!e.contact_companies&&e.contact_companies.some((e=>e.companies&&e.companies.name.toLowerCase().includes(Ce.toLowerCase()))))).length;_(t),E(Math.ceil(t/10))}}}if(s)switch(s){case"missingInfos":r=r.filter((e=>!e.first_name||!e.last_name||!e.city||!e.keywords||!e.category||!e.keep_in_touch_frequency));const{data:e,error:t}=await D.supabase.from("contacts").select("id, first_name, last_name, city, keywords, category, keep_in_touch_frequency").not("category","eq","Skip");if(!t&&e){const t=e.filter((e=>!e.first_name||!e.last_name||!e.city||!e.keywords||!e.category||!e.keep_in_touch_frequency)).length;_(t),E(Math.ceil(t/10))}break;case"keepInTouch":r.forEach((e=>{if(e.last_interaction&&e.keep_in_touch_frequency){const t=new Date(e.last_interaction);let o=0;switch(e.keep_in_touch_frequency){case"Weekly":o=7;break;case"Monthly":o=30;break;case"Quarterly":o=90;break;default:o=999}const n=new Date(t);n.setDate(n.getDate()+o),e.dueDate=n}else e.dueDate=new Date("2099-12-31")})),r.sort(((e,t)=>e.dueDate-t.dueDate)),_(A||0);break;default:_(A||0)}else _(A||0);b(r),E(Math.ceil((C||A||0)/10))}else b([]),_(0),w(A||0),E(Math.ceil((A||0)/10))}catch(p){console.error("Error fetching contacts:",p),g(p.message),b([]),_(0)}finally{h(!1)}}),[Ce,a,m,s,He]),$e=(0,t.useCallback)((async function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";try{let t=D.supabase.from("tags").select("*").order("name");e&&(t=t.ilike("name",`%${e}%`));const{data:o,error:n}=await t.limit(10);if(n)throw n;R(o||[])}catch(t){console.error("Error fetching tag suggestions:",t)}}),[]);(0,t.useImperativeHandle)(o,(()=>({refresh:()=>{Ve()}})),[Ve]),(0,t.useEffect)((()=>{y(0)}),[s]),(0,t.useEffect)((()=>{l(C)}),[C,l]),(0,t.useEffect)((()=>{c>0&&Ve()}),[c,Ve]),(0,t.useEffect)((()=>{Ve(),$e()}),[Ve,$e]),(0,t.useEffect)((()=>{const e=e=>{if(Object.keys(ae).some((e=>ae[e]))){const t=e.target.closest("[data-whatsapp-dropdown]"),o=e.target.closest("[data-whatsapp-button]");t||o||se({})}};return document.addEventListener("mousedown",e),()=>{document.removeEventListener("mousedown",e)}}),[ae]),(0,t.useEffect)((()=>{const e=e=>{if(Object.keys(pe).some((e=>pe[e]))){const t=e.target.closest("[data-email-dropdown]"),o=e.target.closest("[data-email-button]");t||o||he({})}};return document.addEventListener("mousedown",e),()=>{document.removeEventListener("mousedown",e)}}),[pe]);const Ue=e=>{if(!e)return"Never";try{const t=Pe(e);if(!(0,Be.A)(t))return"Invalid date";const o=new Date,n=qe(o,t),r=Xe(o,t),i=Qe(o,t);if(Ze(t,o))return"Today";return Ze(t,function(e,t){return(0,Te.A)(2,arguments),et(e,-(0,De.A)(t))}(o,1))?"Yesterday":n<7?"This Week":r<1?"This Month":i>=1?"More than a Year ago":"More than a Month ago"}catch(t){return"Invalid date"}},We=async()=>{if(M&&F)try{h(!0);const{error:e}=await D.supabase.from("contacts").update({[F]:z[F]}).eq("id",M.id);if(e)throw e;b(v.map((e=>e.id===M.id?{...e,[F]:z[F]}:e))),L(null),G(null),H({})}catch(e){console.error("Error saving contact:",e),g(e.message)}finally{h(!1)}},Ke=(e,t)=>{"name"===t?(Fe(e),Me(!0)):"category"===t?(Re(e),ke(!0)):"history"===t?(X(e),Ne(!0)):((e,t)=>{switch(Z(e),X(t),ne(!0),e){case"name":te((0,N.jsx)(ut,{contact:t,onSave:We,onClose:()=>ne(!1)}));break;case"company":te((0,N.jsx)(Do,{isOpen:!0,onRequestClose:()=>ne(!1),contact:t}));break;case"tags":te((0,N.jsx)(pt.A,{isOpen:!0,onRequestClose:()=>ne(!1),contact:t}));break;case"history":te((0,N.jsxs)("div",{style:{padding:"1rem"},children:[(0,N.jsx)("h3",{style:{marginBottom:"1rem"},children:"Communication History"}),(0,N.jsx)("p",{children:"Communication history view coming soon..."}),(0,N.jsx)("button",{onClick:()=>ne(!1),style:{marginTop:"1rem",padding:"0.5rem 1rem",backgroundColor:"#3b82f6",color:"white",border:"none",borderRadius:"0.25rem",cursor:"pointer"},children:"Close"})]}));break;default:te(null)}})(t,e)},Ye=async()=>{if(de&&le.trim())try{Se(""),h(!0);if(!/^\+?[0-9]{10,15}$/.test(le.trim()))return void Se("Please enter a valid phone number (10-15 digits)");const e=de.mobile?"mobile2":"mobile",{error:t}=await D.supabase.from("contacts").update({[e]:le.trim()}).eq("id",de.id);if(t)throw t;b(v.map((t=>t.id===de.id?{...t,[e]:le.trim()}:t))),ie(!1),ue(null),ce("")}catch(e){console.error("Error saving mobile number:",e),g(e.message),Se("Failed to save mobile number. Please try again.")}finally{h(!1)}else Se("Please enter a mobile number")},Je=e=>Boolean(e.email||e.email2||e.email3),tt=e=>{var t;let o="";o=e.first_name||e.last_name?`${e.first_name||""} ${e.last_name||""}`.trim():null!==(t=e.companies)&&void 0!==t&&t.name?e.companies.name:"Contact";const n=`https://mail.superhuman.com/search/${encodeURIComponent(o)}`;window.open(n,"_blank")},rt=async()=>{if(xe&&me.trim())try{be(""),h(!0);if(!/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(me.trim()))return void be("Please enter a valid email address");let e="email";const{error:t}=await D.supabase.from("contacts").update({[e]:me.trim()}).eq("id",xe.id);if(t)throw t;b(v.map((t=>t.id===xe.id?{...t,[e]:me.trim()}:t))),ge(!1),we(null),ye("")}catch(e){console.error("Error saving email:",e),g(e.message),be("Failed to save email. Please try again.")}finally{h(!1)}else be("Please enter an email address")};return(0,N.jsxs)(Lg,{children:[p&&(0,N.jsx)(Fg,{children:(0,N.jsx)("p",{children:"Loading contacts..."})}),f&&(0,N.jsxs)("div",{style:{background:"#FEF2F2",color:"#B91C1C",padding:"1rem",borderRadius:"0.375rem",marginBottom:"1rem",fontSize:"0.875rem"},children:[(0,N.jsx)("strong",{children:"Error:"})," ",f]}),oe&&(0,N.jsx)(ot(),{isOpen:oe,onRequestClose:()=>ne(!1),style:{content:{top:"50%",left:"50%",right:"auto",bottom:"auto",marginRight:"-50%",transform:"translate(-50%, -50%)",padding:"0",border:"none",borderRadius:"0.5rem",boxShadow:"0 4px 6px rgba(0, 0, 0, 0.1)",maxWidth:"500px",width:"90%"},overlay:{backgroundColor:"rgba(0, 0, 0, 0.5)",zIndex:1e3}},children:ee}),re&&(()=>{if(!re||!de)return null;const e=de.mobile?"mobile2":"mobile",t="mobile"===e?"Primary Mobile Number":"Secondary Mobile Number",o="mobile"===e?"Add":"Add secondary";return(0,N.jsx)(im,{onClick:()=>ie(!1),children:(0,N.jsxs)(am,{onClick:e=>e.stopPropagation(),children:[(0,N.jsxs)(sm,{children:[(0,N.jsxs)("h2",{children:[o," Mobile Number"]}),(0,N.jsx)("button",{onClick:()=>ie(!1),children:(0,N.jsx)(B.yGN,{size:20})})]}),(0,N.jsxs)("div",{style:{padding:"1rem"},children:[(0,N.jsxs)("p",{style:{marginBottom:"1rem"},children:[o," a mobile number for ",(e=>{const t=e.first_name||"",o=e.last_name||"";return t||o?`${t} ${o}`.trim():"(No name)"})(de)," to enable WhatsApp messaging.","mobile2"===e&&(0,N.jsxs)("span",{style:{display:"block",marginTop:"0.5rem",fontSize:"0.875rem",color:"#4b5563"},children:["This will be saved as a secondary number. Primary number: ",de.mobile]})]}),(0,N.jsxs)("div",{style:{marginBottom:"1rem"},children:[(0,N.jsxs)("label",{htmlFor:"mobileInput",style:{display:"block",marginBottom:"0.5rem",fontWeight:"500"},children:[t,":"]}),(0,N.jsx)("input",{id:"mobileInput",type:"tel",value:le,onChange:e=>{ce(e.target.value),Se("")},placeholder:"Enter mobile number with country code (e.g. +1234567890)",onKeyDown:e=>{"Enter"===e.key?Ye():"Escape"===e.key&&ie(!1)},style:{width:"100%",padding:"0.5rem",border:"1px solid "+(_e?"#ef4444":"#d1d5db"),borderRadius:"0.25rem",fontSize:"0.875rem"}}),_e&&(0,N.jsx)("p",{style:{fontSize:"0.75rem",color:"#ef4444",marginTop:"0.25rem"},children:_e}),(0,N.jsx)("p",{style:{fontSize:"0.75rem",color:"#6b7280",marginTop:"0.25rem"},children:"Include the country code with + symbol (e.g. +1 for US)"})]}),(0,N.jsxs)("div",{style:{display:"flex",justifyContent:"flex-end",gap:"0.5rem"},children:[(0,N.jsx)("button",{onClick:()=>ie(!1),style:{padding:"0.5rem 1rem",backgroundColor:"white",color:"#4b5563",border:"1px solid #d1d5db",borderRadius:"0.25rem",cursor:"pointer",fontSize:"0.875rem"},children:"Cancel"}),(0,N.jsx)("button",{onClick:Ye,style:{padding:"0.5rem 1rem",backgroundColor:"#3b82f6",color:"white",border:"none",borderRadius:"0.25rem",cursor:"pointer",fontSize:"0.875rem"},children:"Save"})]})]})]})})})(),fe&&(()=>{if(!fe||!xe)return null;return(0,N.jsx)(im,{onClick:()=>ge(!1),children:(0,N.jsxs)(am,{onClick:e=>e.stopPropagation(),children:[(0,N.jsxs)(sm,{children:[(0,N.jsx)("h2",{children:"Add Email Address"}),(0,N.jsx)("button",{onClick:()=>ge(!1),children:(0,N.jsx)(B.yGN,{size:20})})]}),(0,N.jsxs)("div",{style:{padding:"1rem"},children:[(0,N.jsxs)("p",{style:{marginBottom:"1rem"},children:["Add an email address for ",(e=>{const t=e.first_name||"",o=e.last_name||"";return t||o?`${t} ${o}`.trim():"(No name)"})(xe),"."]}),(0,N.jsxs)("div",{style:{marginBottom:"1rem"},children:[(0,N.jsx)("label",{htmlFor:"emailInput",style:{display:"block",marginBottom:"0.5rem",fontWeight:"500"},children:"Email Address:"}),(0,N.jsx)("input",{id:"emailInput",type:"email",value:me,onChange:e=>{ye(e.target.value),be("")},placeholder:"Enter email address",onKeyDown:e=>{"Enter"===e.key?rt():"Escape"===e.key&&ge(!1)},style:{width:"100%",padding:"0.5rem",border:"1px solid "+(ve?"#ef4444":"#d1d5db"),borderRadius:"0.25rem",fontSize:"0.875rem"}}),ve&&(0,N.jsx)("p",{style:{fontSize:"0.75rem",color:"#ef4444",marginTop:"0.25rem"},children:ve})]}),(0,N.jsxs)("div",{style:{display:"flex",justifyContent:"flex-end",gap:"0.5rem"},children:[(0,N.jsx)("button",{onClick:()=>ge(!1),style:{padding:"0.5rem 1rem",backgroundColor:"white",color:"#4b5563",border:"1px solid #d1d5db",borderRadius:"0.25rem",cursor:"pointer",fontSize:"0.875rem"},children:"Cancel"}),(0,N.jsx)("button",{onClick:rt,style:{padding:"0.5rem 1rem",backgroundColor:"#3b82f6",color:"white",border:"none",borderRadius:"0.25rem",cursor:"pointer",fontSize:"0.875rem"},children:"Save"})]})]})]})})})(),(0,N.jsxs)(Gg,{children:[(0,N.jsx)(zg,{children:(0,N.jsxs)("tr",{children:[(0,N.jsx)("th",{children:"Name"}),(0,N.jsx)("th",{children:"Company"}),(0,N.jsx)("th",{children:"Tags"}),(0,N.jsx)("th",{style:{textAlign:"center"},children:"Last Interaction"}),(0,N.jsx)("th",{className:"category-header",style:{textAlign:"center"},children:"Category"}),(0,N.jsx)("th",{style:{textAlign:"center"},children:"Keep in Touch"}),(0,N.jsx)("th",{children:"Score"}),(0,N.jsx)("th",{children:"Actions"})]})}),(0,N.jsx)(Hg,{children:p||0!==v.length?v.map((e=>{var t,o;return(0,N.jsxs)("tr",{children:[(0,N.jsx)(rm,{onClick:()=>Ke(e,"name"),children:(0,N.jsx)("div",{className:"cell-content",children:(0,N.jsxs)(lm,{title:cm(e.first_name,e.last_name).fullName,children:[cm(e.first_name,e.last_name).displayName,Ge.has(e.id)&&(0,N.jsx)("span",{style:{marginLeft:"0.25rem",color:"#ef4444",fontSize:"0.875rem",cursor:"help"},title:"This contact has potential duplicates",children:"\u26a0\ufe0f"})]})})}),(0,N.jsx)(rm,{onClick:()=>Ke(e,"company"),children:(0,N.jsx)("div",{className:"cell-content",children:(0,N.jsx)(tm,{children:(null===(t=e.companiesList)||void 0===t?void 0:t.length)>0?e.companiesList.map((e=>(0,N.jsx)(em,{children:e.name},e.id))):(0,N.jsx)("span",{style:{color:"#444444",fontStyle:"italic"},children:"No company"})})})}),(0,N.jsx)(rm,{onClick:()=>Ke(e,"tags"),children:(0,N.jsx)("div",{className:"cell-content",children:(0,N.jsx)(Wg,{children:(null===(o=k[e.id])||void 0===o?void 0:o.length)>0?(0,N.jsxs)(N.Fragment,{children:[k[e.id].slice(0,2).map((e=>(0,N.jsx)(Ug,{color:nm(e.name).bg,textColor:nm(e.name).text,children:e.name},e.id))),k[e.id].length>2&&(0,N.jsxs)(om,{children:["+",k[e.id].length-2," more"]})]}):(0,N.jsx)("span",{style:{color:"#444444",fontStyle:"italic"},children:"No tags"})})})}),(0,N.jsx)(rm,{onClick:()=>Ke(e,"history"),hoverText:"View history",children:(0,N.jsx)("div",{className:"cell-content",style:{justifyContent:"center"},children:(0,N.jsx)(Yg,{children:Ue(e.last_interaction)})})}),(0,N.jsx)(rm,{onClick:()=>Ke(e,"category"),className:"category-cell",children:(0,N.jsx)("div",{className:"cell-content",style:{justifyContent:"center"},children:e.category?(0,N.jsx)(qg,{category:e.category,children:"Professional Investor"===e.category?"\ud83d\udcb0 Investor":"Friend and Family"===e.category?"\u2764\ufe0f Loved one":"Client"===e.category?"\ud83e\udd1d Client":"Colleague"===e.category?"\ud83d\udc65 Colleague":"Prospect"===e.category?"\ud83c\udfaf Prospect":"Advisor"===e.category?"\ud83e\udde0 Advisor":"Team"===e.category?"\u26bd Team":"Manager"===e.category?"\ud83d\udcbc Manager":"Founder"===e.category?"\ud83d\udcbb Founder":"Supplier"===e.category?"\ud83d\udce6 Supplier":"Skip"===e.category?"\u274c Skip":"Inbox"===e.category?"\ud83d\udcec Inbox":"Other"===e.category?"\ud83d\udccc Other":`\u26aa ${e.category}`}):(0,N.jsx)("span",{style:{color:"#444444",fontStyle:"italic",textAlign:"center",width:"100%"},children:"Not set"})})}),(0,N.jsx)(rm,{onClick:()=>Ke(e,"keepInTouch"),children:(0,N.jsx)("div",{className:"cell-content",style:{justifyContent:"center"},children:e.keep_in_touch_frequency?"Do not keep in touch"===e.keep_in_touch_frequency?(0,N.jsx)("span",{style:{color:"#ef4444",fontWeight:"bold",fontSize:"1.2em"},children:"\u274c"}):(0,N.jsxs)(Kg,{frequency:e.keep_in_touch_frequency,children:["Monthly"===e.keep_in_touch_frequency?"\u2764\ufe0f ":"",e.keep_in_touch_frequency]}):(0,N.jsx)("span",{style:{color:"#9ca3af",fontStyle:"italic"},children:"Not set"})})}),(0,N.jsx)(dm,{children:(0,N.jsx)(Vg,{children:[1,2,3,4,5].map((t=>(0,N.jsx)($g,{filled:t<=(e.score||0),onClick:()=>(async(e,t)=>{try{await D.supabase.from("contacts").update({score:t}).eq("id",e),b(v.map((o=>o.id===e?{...o,score:t}:o))),nt.Ay.success("Contact score updated successfully"),"missingScore"===s?Ve():Y().then((()=>{l&&l(x||0,d)}))}catch(f){console.error("Error updating contact score:",f),g(f.message),nt.Ay.error("Failed to update contact score")}})(e.id,t),children:(0,N.jsx)(B.usP,{style:{fill:t<=(e.score||0)?"#f59e0b":"transparent",color:"black",strokeWidth:"2px"}})},t)))})}),(0,N.jsx)("td",{className:"actions-cell",children:(0,N.jsxs)(Xg,{children:[(0,N.jsxs)(Jg,{children:[(0,N.jsx)(Bg,{className:"whatsapp",onClick:t=>((e,t)=>{if(t.stopPropagation(),e.mobile||e.mobile2)if(e.mobile&&e.mobile2)se((t=>({...t,[e.id]:!t[e.id]})));else{const t=e.mobile||e.mobile2;window.open(`https://wa.me/${t.replace(/\D/g,"")}`,"_blank")}else ue(e),ce(""),ie(!0)})(e,t),style:{color:e.mobile||e.mobile2?"black":"#444444"},"data-whatsapp-button":!0,children:(0,N.jsx)(Ae.EcP,{})}),(0,N.jsx)("span",{className:"tooltip-text",children:e.mobile||e.mobile2?e.mobile&&e.mobile2?"Choose mobile number":"WhatsApp":"Add mobile number"})]}),(0,N.jsxs)(Jg,{children:[(0,N.jsx)(Bg,{className:"linkedin",onClick:t=>((e,t)=>{if(t.stopPropagation(),e.linkedin)window.open(e.linkedin,"_blank");else{var o;let t="";t=e.first_name||e.last_name?`${e.first_name||""} ${e.last_name||""}`.trim():e.email?e.email.split("@")[0].replace(/[._]/g," "):null!==(o=e.companies)&&void 0!==o&&o.name?e.companies.name:"Contact";const n=`https://www.linkedin.com/search/results/all/?keywords=${encodeURIComponent(t)}`;window.open(n,"_blank")}})(e,t),style:{color:e.linkedin?"black":"#444444"},children:(0,N.jsx)(Ae.QEs,{})}),(0,N.jsx)("span",{className:"tooltip-text",children:e.linkedin?"View LinkedIn profile":"Search on LinkedIn"})]}),(0,N.jsxs)(Jg,{children:[(0,N.jsx)(Bg,{className:"email",onClick:t=>((e,t)=>{t.stopPropagation(),Je(e)?tt(e):he((t=>({...t,[e.id]:!t[e.id]})))})(e,t),"data-email-button":!0,style:{color:Je(e)?"black":"#444444"},children:(0,N.jsx)(B.pHD,{})}),(0,N.jsx)("span",{className:"tooltip-text",children:Je(e)?"Search in Superhuman":"Add/Search"})]}),(0,N.jsxs)(Jg,{children:[(0,N.jsx)(Bg,{className:"delete",onClick:()=>(async e=>{if(window.confirm("Are you sure you want to delete this contact? This action cannot be undone."))try{h(!0);const{error:t}=await D.supabase.from("meetings_contacts").delete().eq("contact_id",e);t&&console.warn("Error deleting related meetings_contacts:",t);const{error:o}=await D.supabase.from("contact_tags").delete().eq("contact_id",e);o&&console.warn("Error deleting related contact_tags:",o);const{error:n}=await D.supabase.from("contact_companies").delete().eq("contact_id",e);n&&console.warn("Error deleting related contact_companies:",n);const{error:r}=await D.supabase.from("contact_cities").delete().eq("contact_id",e);r&&console.warn("Error deleting related contact_cities:",r);const{error:i}=await D.supabase.from("contact_introductions").delete().contains("contacts_introduced",[e]);i&&console.warn("Error deleting related contact_introductions:",i);const{error:a}=await D.supabase.from("contacts").delete().eq("id",e);if(a)throw a;b(v.filter((t=>t.id!==e))),nt.Ay.success("Contact deleted successfully")}catch(t){console.error("Error deleting contact:",t),g(t.message),nt.Ay.error(`Failed to delete contact: ${t.message}`)}finally{h(!1)}})(e.id),style:{color:"black"},children:(0,N.jsx)(B.IXo,{size:16})}),(0,N.jsx)("span",{className:"tooltip-text",children:"Delete Contact"})]})]})})]},e.id)})):(0,N.jsx)("tr",{children:(0,N.jsx)("td",{colSpan:"8",style:{textAlign:"center",padding:"2rem"},children:Ce&&Ce.length>=3?`No contacts found matching "${Ce}" in ${a}`:"No contacts found"})})})]}),!p&&(v.length>0||!Ce)&&S>1&&(0,N.jsxs)(Qg,{children:[(0,N.jsx)(Zg,{onClick:()=>y(0),disabled:0===m||p,children:"\u27ea"}),(0,N.jsx)(Zg,{onClick:()=>y((e=>Math.max(0,e-1))),disabled:0===m||p,children:"\u27e8"}),(0,N.jsx)(Zg,{onClick:()=>y((e=>Math.min(S-1,e+1))),disabled:m===S-1||p,children:"\u27e9"}),(0,N.jsx)(Zg,{onClick:()=>y(S-1),disabled:m===S-1||p,children:"\u27eb"})]}),oe&&"keepInTouch"===Q&&(0,N.jsx)(Et,{isOpen:oe,onRequestClose:()=>ne(!1),contact:J}),Ee&&je&&(0,N.jsx)(Lt,{isOpen:Ee,onRequestClose:()=>{ke(!1),Re(null),Ve()},contact:je}),Oe&&J&&(0,N.jsx)(io,{isOpen:Oe,onRequestClose:()=>Ne(!1),contact:J}),Ie&&Le&&(0,N.jsx)(Mg,{isOpen:Ie,onRequestClose:()=>{Me(!1),Fe(null),Ve()},contact:Le})]})}));um.displayName="RecentContactsList";const pm=um,hm=P.Ay.div`
  display: grid;
  grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
  gap: 1rem;
  margin-bottom: 2rem;
`,fm=P.Ay.div`
  background: white;
  border-radius: 12px;
  padding: 1.5rem;
  box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
`,gm=P.Ay.div`
  font-size: 2rem;
  font-weight: bold;
  color: black;
  margin-bottom: 0.5rem;
`,mm=P.Ay.div`
  color: #6c757d;
`,ym=()=>{const[e,o]=(0,t.useState)({todayCount:0,weekCount:0,totalCount:0}),[n,r]=(0,t.useState)(!0);return(0,t.useEffect)((()=>{!async function(){r(!0);try{const{count:e,error:t}=await D.supabase.from("contacts").select("*",{count:"exact",head:!0}).or("contact_category.is.null,contact_category.neq.Skip"),n=(new Date).toISOString().split("T")[0],{count:r,error:i}=await D.supabase.from("contacts").select("*",{count:"exact",head:!0}).gte("created_at",n).or("contact_category.is.null,contact_category.neq.Skip"),a=new Date;a.setDate(a.getDate()-7);const s=a.toISOString().split("T")[0],{count:l,error:c}=await D.supabase.from("contacts").select("*",{count:"exact",head:!0}).gte("created_at",s).or("contact_category.is.null,contact_category.neq.Skip");t||i||c?console.error("Error fetching stats:",{totalError:t,todayError:i,weekError:c}):o({todayCount:r||0,weekCount:l||0,totalCount:e||0})}catch(e){console.error("Exception fetching stats:",e)}finally{r(!1)}}()}),[]),(0,N.jsxs)(N.Fragment,{children:[(0,N.jsx)("h1",{children:"Dashboard"}),(0,N.jsxs)(hm,{children:[(0,N.jsxs)(fm,{children:[(0,N.jsx)(gm,{children:n?"...":e.todayCount}),(0,N.jsx)(mm,{children:"New Contacts Today"})]}),(0,N.jsxs)(fm,{children:[(0,N.jsx)(gm,{children:n?"...":e.weekCount}),(0,N.jsx)(mm,{children:"Contacts This Week"})]}),(0,N.jsxs)(fm,{children:[(0,N.jsx)(gm,{children:n?"...":e.totalCount}),(0,N.jsx)(mm,{children:"Total Contacts"})]})]}),(0,N.jsx)(je,{}),(0,N.jsx)(pm,{})]})},vm=()=>(0,N.jsxs)(fe,{children:[(0,N.jsx)("h1",{children:"New Contacts"}),(0,N.jsx)(je,{})]}),bm=(0,t.lazy)((()=>o.e(647).then(o.bind(o,7647)))),xm=(0,t.lazy)((()=>Promise.resolve().then(o.bind(o,4473)))),wm=(0,t.lazy)((()=>Promise.resolve().then(o.bind(o,954)))),Cm=(0,t.lazy)((()=>Promise.resolve().then(o.bind(o,7309)))),_m=(0,t.lazy)((()=>o.e(972).then(o.bind(o,3972)))),Sm=(0,t.lazy)((()=>Promise.resolve().then(o.bind(o,933)))),Em=(0,t.lazy)((()=>o.e(748).then(o.bind(o,7748)))),km=P.Ay.div`
  padding: 0;
  margin: 0;
  margin-top: -1px; /* Pull content to the very top */
  height: 100%;
  width: 100%;
  overflow: hidden;
  box-sizing: border-box;
  max-width: 100%;
  position: relative;
`,jm=P.Ay.div`
  display: flex;
  background-color: #111;
  border-bottom: 1px solid #333;
  overflow-x: auto;
  scrollbar-width: thin;
  scrollbar-color: #00ff00 #222;
  padding: 8px 0;
  margin-bottom: 0;
  position: sticky;
  top: 0;
  z-index: 100;
  width: 100%;
  
  &::-webkit-scrollbar {
    height: 6px;
  }
  
  &::-webkit-scrollbar-track {
    background: #222;
  }
  
  &::-webkit-scrollbar-thumb {
    background-color: #00ff00;
    border-radius: 3px;
  }
`,Am=P.Ay.div`
  padding: 0px 0px 0px 0px;
  width: 100%;
  overflow: hidden;
  box-sizing: border-box;
  max-width: 100%;
`,Rm=P.Ay.div`
  display: flex;
  align-items: center;
  padding: 10px 20px;
  color: ${e=>e.$active?"#00ff00":"#ccc"};
  text-decoration: none;
  border-bottom: 3px solid ${e=>e.$active?"#00ff00":"transparent"};
  margin-right: 20px;
  font-family: 'Courier New', monospace;
  transition: all 0.2s ease;
  white-space: nowrap;
  cursor: pointer;
  font-size: 1rem;
  font-weight: ${e=>e.$active?"bold":"normal"};
  background-color: ${e=>e.$active?"rgba(0, 255, 0, 0.05)":"transparent"};
  border-radius: 4px 4px 0 0;
  
  &:hover {
    color: #00ff00;
    background-color: rgba(0, 255, 0, 0.05);
  }
  
  &:first-child {
    margin-left: 10px;
  }
  
  svg {
    margin-right: 10px;
    font-size: 1.1rem;
  }
`,Om=P.Ay.div`
  width: 100%;
  overflow: hidden;
  box-sizing: border-box;
  max-width: 100%;
`,Tm=P.Ay.div`
  display: flex;
  justify-content: center;
  align-items: center;
  height: 300px;
  color: #00ff00;
  font-family: 'Courier New', monospace;
`,Dm=()=>{const e=new URLSearchParams(window.location.search).get("source"),o=(0,i.Zp)(),n=sessionStorage.getItem("workflow_contact_id"),[r,a]=(0,t.useState)("category"===e?"category":"whatsapp");(0,t.useEffect)((()=>{n&&(sessionStorage.removeItem("workflow_contact_id"),o(`/contacts/workflow/${n}`))}),[n,o]);const s=[{id:"whatsapp",name:"WhatsApp",icon:(0,N.jsx)(B.QFc,{})},{id:"email",name:"Email",icon:(0,N.jsx)(B.pHD,{})},{id:"recent",name:"Recent",icon:(0,N.jsx)(B.z1n,{})},{id:"category",name:"Categories",icon:(0,N.jsx)(B.cfS,{})},{id:"kit",name:"Keep in Touch",icon:(0,N.jsx)(B.Ohp,{})},{id:"skip",name:"Skip",icon:(0,N.jsx)(B.Oge,{})},{id:"duplicates",name:"Duplicates",icon:(0,N.jsx)(B.nxz,{})}];return(0,N.jsxs)(km,{children:[(0,N.jsx)(jm,{children:s.map((e=>(0,N.jsxs)(Rm,{$active:r===e.id,onClick:()=>a(e.id),children:[e.icon," ",e.name]},e.id)))}),(0,N.jsx)(Am,{children:(0,N.jsx)(Om,{children:(0,N.jsx)(t.Suspense,{fallback:(0,N.jsx)(Tm,{children:"Loading..."}),children:(()=>{switch(r){case"whatsapp":return(0,N.jsx)(bm,{});case"email":return(0,N.jsx)(xm,{});case"recent":return(0,N.jsx)(Em,{});case"category":return(0,N.jsx)(wm,{});case"kit":return(0,N.jsx)(Cm,{});case"skip":return(0,N.jsx)(_m,{});case"duplicates":return(0,N.jsx)(Sm,{});default:return(0,N.jsx)("div",{style:{color:"#00ff00",textAlign:"center",paddingTop:"40px"},children:"Select an inbox type from the menu above"})}})()})})})]})};var Pm=o(2115);o(2342);const Nm=P.Ay.div`
  background-color: white;
  border-radius: 16px;
  box-shadow: 0 1px 3px rgba(0, 0, 0, 0.05);
  overflow: hidden;
`,Im=P.Ay.div`
  padding: 1.5rem 1.5rem 0.5rem 1.5rem; /* Reduced bottom padding */
`,Mm=P.Ay.div`
  display: flex;
  justify-content: space-between;
  align-items: flex-start;
  margin-bottom: 1rem;
`,Lm=P.Ay.div`
  flex: 1;
`,Fm=P.Ay.h1`
  font-size: 1.5rem;
  font-weight: 600;
  color: #111827;
  margin: 0;
  display: flex;
  align-items: center;
  gap: 0.5rem;
`,Gm=(P.Ay.span`
  font-size: 1rem;
  font-weight: 400;
  color: #6b7280;
`,P.Ay.p`
  color: #6b7280;
  margin: 0;
  max-width: 100%;
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
`,P.Ay.div`
  display: flex;
  gap: 0.75rem;
`),zm=P.Ay.button`
  display: flex;
  align-items: center;
  gap: 0.5rem;
  padding: 0.5rem 1rem;
  border-radius: 0.375rem;
  font-size: 0.875rem;
  font-weight: 500;
  cursor: pointer;
  transition: all 0.2s;
  
  &:hover {
    opacity: 0.9;
  }
`,Hm=((0,P.Ay)(zm)`
  background-color: #3b82f6;
  color: white;
  border: none;
  
  &:hover {
    background-color: #2563eb;
  }
`,(0,P.Ay)(zm)`
  background-color: transparent;
  color: black;
  border: 1px solid black;
  
  &:hover {
    background-color: rgba(0, 0, 0, 0.05);
  }
`),Bm=P.Ay.div`
  display: flex;
  align-items: center;
  width: 100%;
  background-color: white;
  border: 1px solid black;
  border-radius: 0.375rem;
  overflow: hidden;
  margin-top: 1rem;
  box-shadow: none;
`,Vm=P.Ay.div`
  position: relative;
  min-width: 140px;
  border-right: 1px solid black;
`,$m=P.Ay.button`
  display: flex;
  align-items: center;
  justify-content: space-between;
  width: 100%;
  padding: 0.625rem 1rem;
  font-size: 0.875rem;
  color: black;
  background: none;
  border: none;
  cursor: pointer;
  
  &:hover {
    background-color: rgba(0, 0, 0, 0.05);
  }
`,Um=P.Ay.div.attrs((e=>({"data-open":e.isOpen?"true":"false"})))`
  position: absolute;
  top: 100%;
  left: 0;
  width: 100%;
  background-color: white;
  border: 1px solid black;
  border-radius: 0.375rem;
  box-shadow: none;
  z-index: 50;
  max-height: 250px;
  overflow-y: auto;
  display: ${e=>"true"===e["data-open"]?"block":"none"};
`,Wm=P.Ay.button`
  display: block;
  width: 100%;
  padding: 0.5rem 1rem;
  text-align: left;
  font-size: 0.875rem;
  color: black;
  background: none;
  border: none;
  cursor: pointer;
  
  &:hover {
    background-color: rgba(0, 0, 0, 0.05);
  }
  
  &.active {
    background-color: rgba(0, 0, 0, 0.1);
    font-weight: 500;
  }
`,qm=P.Ay.input`
  flex: 1;
  padding: 0.625rem 1rem;
  font-size: 0.875rem;
  color: black;
  border: none;
  outline: none;
  
  &::placeholder {
    color: #555555;
  }
`,Km=P.Ay.div`
  display: flex;
  align-items: center;
  justify-content: center;
  padding: 0 1rem;
  color: black;
`,Ym=P.Ay.div`
  padding: 0 1.5rem;
`,Jm=P.Ay.div`
  display: flex;
  gap: 0.75rem;
  padding: 2rem 0 0.5rem 0;  /* Reduced bottom padding from 1rem to 0.5rem */
  margin: 0 1.5rem;
  overflow-x: auto;
  
  @media (max-width: 768px) {
    flex-wrap: nowrap;
    padding: 1.5rem 0 0.25rem 0;  /* Reduced bottom padding in mobile view */
    margin: 0 1rem;
  }
`,Xm=P.Ay.button.attrs((e=>({active:e.active?"true":"false"})))`
  display: flex;
  align-items: center;
  gap: 0.5rem;
  padding: 0.5rem 1rem;
  border-radius: 0.375rem;
  font-size: 0.875rem;
  font-weight: 500;
  cursor: pointer;
  transition: all 0.2s;
  background-color: ${e=>"true"===e.active?"black":"white"};
  color: ${e=>"true"===e.active?"white":"black"};
  border: 1px solid black;
  position: relative;
  
  &:hover {
    background-color: ${e=>"true"===e.active?"#333333":"rgba(0, 0, 0, 0.05)"};
  }
  
  svg {
    font-size: 1rem;
  }
  
  .count {
    margin-left: 0.25rem;
    background-color: ${e=>"true"===e.active?"rgba(255, 255, 255, 0.2)":"rgba(0, 0, 0, 0.1)"};
    padding: 0.125rem 0.375rem;
    border-radius: 1rem;
    font-size: 0.75rem;
  }
`,Qm=(P.Ay.div`
  position: absolute;
  top: 0.25rem;
  right: 0.25rem;
  width: 0.5rem;
  height: 0.5rem;
  background-color: black;
  border-radius: 50%;
  border: 2px solid white;
`,e=>{var o,n;let{defaultFilter:r=null}=e;const[i,a]=(0,t.useState)(0),[s,l]=(0,t.useState)(0),[c,d]=(0,t.useState)(0),[u,p]=(0,t.useState)(""),[h,f]=(0,t.useState)("name"),[g,m]=(0,t.useState)(!1),[y,v]=(0,t.useState)(!0),[b,x]=(0,t.useState)(r),[w,C]=(0,t.useState)(0),[_,S]=(0,t.useState)(null),[E,k]=(0,t.useState)(!1),[j]=T(),[A,R]=(0,t.useState)({lastInteraction:0,recentlyCreated:0,missingKeepInTouch:0,missingScore:0,missingCities:0,missingCompanies:0,missingTags:0}),O=(0,t.useRef)(null);(0,t.useEffect)((()=>{const e=j.get("id");if(e){(async()=>{try{const{data:t,error:o}=await D.supabase.from("contacts").select("*").eq("id",e).single();if(o)throw o;t&&(S(t),k(!0))}catch(t){console.error("Error fetching contact:",t)}})()}}),[j]);const P=[{id:"name",label:"Name Surname"},{id:"email",label:"Email"},{id:"mobile",label:"Mobile"},{id:"city",label:"City"},{id:"company",label:"Company"},{id:"tags",label:"Tags"}];(0,t.useEffect)((()=>{I(),M()}),[]);const I=async()=>{try{v(!0);const{count:e,error:t}=await D.supabase.from("contacts").select("*",{count:"exact"}).not("category","eq","Skip");if(t)throw t;a(e||0),l(e||0)}catch(e){console.error("Error fetching contact count:",e.message)}finally{v(!1)}},M=async()=>{try{const{count:e,error:t}=await D.supabase.from("contacts").select("*",{count:"exact"}).eq("category","Inbox");if(t)throw t;d(e||0)}catch(e){console.error("Error fetching inbox count:",e.message)}},L=e=>{x(b===e?null:e),p("")};return(0,N.jsxs)(Nm,{children:[(0,N.jsxs)(Im,{children:[(0,N.jsxs)(Mm,{children:[(0,N.jsx)(Lm,{children:(0,N.jsx)(Fm,{children:(()=>{if(!b)return"All Contacts";switch(b){case"recentlyCreated":return"Missing Category";case"lastInteraction":return"Recent Interactions";case"missingKeepInTouch":return"Missing Keep in Touch";case"missingScore":return"Missing Score";case"missingCities":return"Missing Cities";case"missingCompanies":return"Missing Companies";case"missingTags":return"Missing Tags";default:return"All Contacts"}})()})}),(0,N.jsx)(Gm,{children:(0,N.jsxs)(Hm,{onClick:()=>{C((e=>e+1))},title:"Refresh contacts",children:[(0,N.jsx)(B.jTZ,{}),"Refresh"]})})]}),(0,N.jsxs)(Bm,{children:[(0,N.jsxs)(Vm,{children:[(0,N.jsxs)($m,{onClick:()=>m(!g),children:[null===(o=P.find((e=>e.id===h)))||void 0===o?void 0:o.label,(0,N.jsx)(B.fK4,{})]}),(0,N.jsx)(Um,{isOpen:g,children:P.map((e=>(0,N.jsx)(Wm,{className:e.id===h?"active":"",onClick:()=>(e=>{f(e),m(!1),p(""),x(null)})(e.id),children:e.label},e.id)))})]}),(0,N.jsx)(qm,{type:"text",placeholder:`Search by ${null===(n=P.find((e=>e.id===h)))||void 0===n?void 0:n.label.toLowerCase()}...`,value:u,onChange:e=>{const t=e.target.value;p(t),x(null)}}),(0,N.jsx)(Km,{children:(0,N.jsx)(B.CKj,{})})]}),(0,N.jsxs)(Jm,{children:[(0,N.jsxs)(Xm,{active:"lastInteraction"===b,onClick:()=>L("lastInteraction"),children:[(0,N.jsx)(B.mEP,{}),"Last Interaction",(0,N.jsx)("span",{className:"count",children:A.lastInteraction})]}),(0,N.jsxs)(Xm,{active:"recentlyCreated"===b,onClick:()=>L("recentlyCreated"),children:[(0,N.jsx)(B.Ohp,{}),"Inbox",(0,N.jsx)("span",{className:"count",children:A.recentlyCreated})]}),(0,N.jsxs)(Xm,{active:"missingKeepInTouch"===b,onClick:()=>L("missingKeepInTouch"),children:[(0,N.jsx)(B.y3G,{}),"Missing Keep in Touch",(0,N.jsx)("span",{className:"count",children:A.missingKeepInTouch})]}),(0,N.jsxs)(Xm,{active:"missingScore"===b,onClick:()=>L("missingScore"),children:[(0,N.jsx)(B.usP,{}),"Missing Score",(0,N.jsx)("span",{className:"count",children:A.missingScore})]}),(0,N.jsxs)(Xm,{active:"missingCities"===b,onClick:()=>L("missingCities"),children:[(0,N.jsx)(B.HzC,{}),"Missing Cities",(0,N.jsx)("span",{className:"count",children:A.missingCities})]}),(0,N.jsxs)(Xm,{active:"missingCompanies"===b,onClick:()=>L("missingCompanies"),children:[(0,N.jsx)(B.H9b,{}),"Missing Companies",(0,N.jsx)("span",{className:"count",children:A.missingCompanies})]}),(0,N.jsxs)(Xm,{active:"missingTags"===b,onClick:()=>L("missingTags"),children:[(0,N.jsx)(Ae.wJQ,{}),"Missing Tags",(0,N.jsx)("span",{className:"count",children:A.missingTags})]})]})]}),(0,N.jsx)(Ym,{children:(0,N.jsx)(pm,{ref:O,defaultShowAll:!0,searchTerm:u.length>=3?u:"",searchField:h,activeFilter:b,onCountUpdate:(e,t)=>{l(e),t&&R(t)},refreshTrigger:w,showIconsOnly:!0})}),E&&_&&(0,N.jsx)(Mg,{isOpen:E,onRequestClose:()=>{k(!1),S(null);const e=window.location.pathname;window.history.pushState({},"",e)},contact:_})]})}),Zm=()=>(0,N.jsx)(Qm,{defaultFilter:"lastInteraction"});ot().setAppElement("#root");P.Ay.div`
  position: relative;
  width: 100%;
`,P.Ay.div`
  position: absolute;
  top: 0;
  left: 0;
  right: 0;
  bottom: 0;
  background-color: rgba(255, 255, 255, 0.9);
  display: flex;
  align-items: center;
  justify-content: center;
  z-index: 100;
  transition: opacity 0.2s ease-in-out;
  
  p {
    background-color: white;
    padding: 1rem 2rem;
    border-radius: 0.5rem;
    box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
    font-weight: 500;
  }
`,P.Ay.table`
  width: 100%;
  border-collapse: separate;
  border-spacing: 0;
  margin-bottom: 1.5rem;
  table-layout: fixed; /* Use fixed layout for better column control */
  padding: 0 1rem;
  
  /* Column width specifications */
  th:nth-child(1) { width: 19%; }  /* Name */
  th:nth-child(2) { width: 16%; }  /* Company */
  th:nth-child(3) { width: 12%; }  /* Category */
  th:nth-child(4) { width: 16%; }  /* Tags */
  th:nth-child(5) { width: 10%; }  /* Keep in Touch */
  th:nth-child(6) { width: 8%; }   /* Last Interaction */
  th:nth-child(7) { width: 8%; }   /* Snooze */
  th:nth-child(8) { width: 11%; }  /* Next Due */
  
  @media (max-width: 1200px) {
    th:nth-child(1) { width: 20%; } /* Increase Name column on smaller screens */
    th:nth-child(2) { width: 15%; } /* Reduce Company column on smaller screens */
    th:nth-child(3) { width: 11%; } /* Reduce Category column on smaller screens */
    th:nth-child(4) { width: 16%; } /* Keep Tags column the same on smaller screens */
    th:nth-child(6) { width: 7%; }  /* Reduce Last Interaction column on smaller screens */
    th:nth-child(7) { width: 7%; }  /* Reduce Snooze column on smaller screens */
  }
`,P.Ay.thead`
  background-color: white;
  
  th {
    padding: 0.875rem 1rem;
    text-align: left;
    font-weight: 700;
    font-size: 0.75rem;
    color: black;
    border-bottom: 1px solid black;
    position: sticky;
    top: 0;
    z-index: 10;
    white-space: nowrap;
    
    &.centered {
      text-align: center;
    }
  }
`,P.Ay.tbody`
  tr {
    border-bottom: 1px solid #e5e7eb;
    transition: background-color 0.15s;
    
    &:hover {
      background-color: #f9fafb;
    }
    
    &:last-child {
      border-bottom: none;
    }
  }
  
  td {
    padding: 0.875rem 1rem;
    font-size: 0.875rem;
    color: #1f2937;
    vertical-align: middle;
    
    &.centered {
      text-align: center;
    }
    
    .cell-content {
      display: flex;
      align-items: center;
    }
  }
`,P.Ay.td`
  cursor: pointer;
  position: relative;
  transition: background-color 0.2s;
  
  /* For proper content handling */
  overflow: hidden; /* Prevent content overflow */
  
  .cell-content {
    display: flex;
    align-items: center;
    width: 100%;
    min-width: 0; /* Allow children to truncate */
    padding: 0.25rem 0; /* Add some vertical padding */
    gap: 0.5rem;
  }
  
  &:hover {
    background-color: rgba(59, 130, 246, 0.05);
  }
`,P.Ay.span`
  display: inline-flex;
  align-items: center;
  justify-content: center;
  padding: 0.15rem 0.25rem;
  min-width: 80px;
  font-size: 0.7rem;
  border-radius: 0.375rem;
  background-color: ${e=>{switch(e.category){case"Client":return"#e0f2fe";case"Lead":return"#fef3c7";case"Partner":return"#f3e8ff";case"Vendor":return"#dcfce7";case"Inbox":return"#ffefef";default:return"#f3f4f6"}}};
  color: ${e=>{switch(e.category){case"Client":return"#0369a1";case"Lead":return"#92400e";case"Partner":return"#6b21a8";case"Vendor":return"#15803d";case"Inbox":return"#ef4444";default:return"#4b5563"}}};
  font-weight: 500;
  margin-right: 0.25rem;
  margin-bottom: 0.25rem;
`,P.Ay.span`
  display: inline-flex;
  align-items: center;
  padding: 0.25rem 0.5rem;
  font-size: 0.75rem;
  border-radius: 0.25rem;
  background-color: ${e=>{switch(e.frequency){case"Weekly":case"Monthly":return"#000000";case"Quarterly":return"#444444";case"Twice per Year":case"Twice a year":return"#888888";default:return"#ffffff"}}};
  color: ${e=>{switch(e.frequency){case"Weekly":case"Monthly":case"Quarterly":return"#ffffff";case"Twice per Year":case"Twice a year":return"#333333";default:return"#000000"}}};
  font-weight: 500;
  border: 1px solid #d1d5db;
`,P.Ay.div`
  display: flex;
  flex-wrap: wrap;
  align-items: center;
  width: 100%; /* Use full width of the cell */
  min-width: 0; /* Allow proper truncation */
`,P.Ay.span`
  display: inline-flex;
  align-items: center;
  padding: 0.25rem 0.5rem;
  font-size: 0.75rem;
  border-radius: 1rem;
  background-color: ${e=>e.color||"#f3f4f6"};
  color: ${e=>e.textColor||"#4b5563"};
  font-weight: 500;
  margin-right: 0.25rem;
  margin-bottom: 0.25rem;
  border: 1px solid black;
`,P.Ay.div`
  display: flex;
  flex-wrap: wrap;
  align-items: center;
`,P.Ay.span`
  display: inline-flex;
  align-items: center;
  padding: 0.25rem 0.5rem;
  font-size: 0.75rem;
  border-radius: 0.375rem;
  background-color: white;
  color: black;
  font-weight: 500;
  margin-right: 0.25rem;
  margin-bottom: 0.25rem;
  border: 1px solid black;
  text-transform: uppercase;
  
  span {
    white-space: nowrap;
    overflow: hidden;
    text-overflow: ellipsis;
    max-width: 150px;
  }
`,P.Ay.td`
  color: ${e=>e.isOverdue?"#dc2626":e.isUpcoming?"#059669":"#000000"};
  font-weight: ${e=>e.isOverdue||e.isUpcoming?"500":"normal"};
`,P.Ay.span`
  display: block;
  max-width: ${e=>e.maxWidth||"150px"};
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
`,P.Ay.span`
  color: #000000;
  font-weight: normal;
  position: relative; /* Added for overlay positioning */
`,P.Ay.div`
  position: absolute;
  top: 0;
  left: 0;
  right: 0;
  bottom: 0;
  background-color: rgba(59, 130, 246, 0.1);
  display: flex;
  align-items: center;
  justify-content: center;
  opacity: 0;
  transition: opacity 0.2s;
  cursor: pointer;
  
  &:hover {
    opacity: 1;
  }
  
  span {
    background-color: #3b82f6;
    color: white;
    padding: 0.25rem 0.5rem;
    border-radius: 0.25rem;
    font-size: 0.75rem;
    font-weight: 500;
  }
`,P.Ay.div`
  position: relative;
  width: 100%;
  display: flex;
  justify-content: center;
`,P.Ay.select`
  padding: 0.35rem;
  border-radius: 0.25rem;
  border: 1px solid #000000;
  font-size: 0.7rem;
  background-color: white;
  cursor: pointer;
  width: 95%;
  margin: 0 auto;
  appearance: menulist;
  
  &:hover {
    border-color: #000000;
  }
  
  &:focus {
    outline: none;
    border-color: #000000;
    box-shadow: 0 0 0 2px rgba(0, 0, 0, 0.1);
  }
`,P.Ay.div`
  display: flex;
  align-items: center;
  justify-content: center;
  gap: 0.2rem;
  font-size: 0.7rem;
  font-weight: ${e=>e.days>0?"500":"normal"};
  color: #000000;
  padding: 0.35rem;
  background-color: white;
  border-radius: 0.25rem;
  cursor: pointer;
  border: 1px solid ${e=>e.days>0?"#000000":"#d1d5db"};
  width: 95%;
  margin: 0 auto;
  transition: all 0.2s;
  
  svg {
    font-size: 0.8rem;
  }
  
  &:hover {
    background-color: #f3f4f6;
  }
`,P.Ay.div`
  display: flex;
  align-items: center;
  justify-content: center;
  padding: 0.35rem;
  color: #6b7280;
  font-size: 0.7rem;
  cursor: pointer;
  width: 95%;
  margin: 0 auto;
  border: 1px dashed #d1d5db;
  border-radius: 0.25rem;
  transition: all 0.2s;
  
  &:hover {
    border-color: #000000;
    background-color: #f3f4f6;
  }
  
  &::before {
    content: "+";
    margin-right: 4px;
    font-weight: bold;
  }
`,P.Ay.span`
  display: inline-flex;
  align-items: center;
  justify-content: center;
  padding: 0.12rem 0.4rem;
  font-size: 0.6rem;
  font-weight: 600;
  border-radius: 1rem;
  margin-left: 0.5rem;
  white-space: nowrap;
  
  /* Overdue: black with white text */
  ${e=>e.overdue&&"\n    background-color: #000000;\n    color: #FFFFFF;\n  "}
  
  /* Upcoming: white with black text and border */
  ${e=>e.upcoming&&"\n    background-color: #FFFFFF;\n    color: #000000;\n    border: 1px solid #000000;\n  "}
`,P.Ay.div`
  display: flex;
  gap: 6px; /* Add spacing between buttons */
  margin-bottom: 1.5rem;
  padding-left: 1.5rem; /* Align with page title */
  margin-top: -0.5rem; /* Reduce space to get closer to subtitle */
`,P.Ay.button`
  padding: 0.5rem 1rem;
  border-radius: 0;
  font-size: 0.875rem;
  font-weight: 500;
  cursor: pointer;
  transition: all 0.2s;
  
  ${e=>e.active?"\n    background-color: black;\n    color: white;\n    border: 1px solid black;\n  ":"\n    background-color: white;\n    color: black;\n    border: 1px solid black;\n  "}
  
  &:hover {
    opacity: 0.9;
  }
`,P.Ay.div`
  background-color: white;
  border-radius: 0.5rem;
  box-shadow: 0 1px 3px rgba(0, 0, 0, 0.05);
  overflow: hidden;
`,P.Ay.div`
  padding: 1.5rem;
  
  h1 {
    font-size: 1.5rem;
    font-weight: 600;
    color: #111827;
    margin-bottom: 8px;
    display: flex;
    align-items: center;
    gap: 8px;
  }
  
  .counter {
    font-size: 1.25rem;
    color: #6b7280;
    font-weight: normal;
  }
  
  p {
    color: #6b7280;
    font-size: 0.875rem;
  }
`,P.Ay.div`
  padding: 0;
`;var ey=o(2284);function ty(e){var t=function(e,t){if("object"!=(0,ey.A)(e)||!e)return e;var o=e[Symbol.toPrimitive];if(void 0!==o){var n=o.call(e,t||"default");if("object"!=(0,ey.A)(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==(0,ey.A)(t)?t:t+""}function oy(e,t,o){return(t=ty(t))in e?Object.defineProperty(e,t,{value:o,enumerable:!0,configurable:!0,writable:!0}):e[t]=o,e}function ny(e,t){var o=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),o.push.apply(o,n)}return o}function ry(e){for(var t=1;t<arguments.length;t++){var o=null!=arguments[t]?arguments[t]:{};t%2?ny(Object(o),!0).forEach((function(t){oy(e,t,o[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(o)):ny(Object(o)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(o,t))}))}return e}function iy(e,t){(null==t||t>e.length)&&(t=e.length);for(var o=0,n=Array(t);o<t;o++)n[o]=e[o];return n}function ay(e,t){if(e){if("string"==typeof e)return iy(e,t);var o={}.toString.call(e).slice(8,-1);return"Object"===o&&e.constructor&&(o=e.constructor.name),"Map"===o||"Set"===o?Array.from(e):"Arguments"===o||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(o)?iy(e,t):void 0}}function sy(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var o=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=o){var n,r,i,a,s=[],l=!0,c=!1;try{if(i=(o=o.call(e)).next,0===t){if(Object(o)!==o)return;l=!1}else for(;!(l=(n=i.call(o)).done)&&(s.push(n.value),s.length!==t);l=!0);}catch(e){c=!0,r=e}finally{try{if(!l&&null!=o.return&&(a=o.return(),Object(a)!==a))return}finally{if(c)throw r}}return s}}(e,t)||ay(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function ly(e,t){if(null==e)return{};var o,n,r=function(e,t){if(null==e)return{};var o={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(-1!==t.indexOf(n))continue;o[n]=e[n]}return o}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(n=0;n<i.length;n++)o=i[n],-1===t.indexOf(o)&&{}.propertyIsEnumerable.call(e,o)&&(r[o]=e[o])}return r}var cy=["defaultInputValue","defaultMenuIsOpen","defaultValue","inputValue","menuIsOpen","onChange","onInputChange","onMenuClose","onMenuOpen","value"];function dy(){return dy=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var o=arguments[t];for(var n in o)({}).hasOwnProperty.call(o,n)&&(e[n]=o[n])}return e},dy.apply(null,arguments)}function uy(e,t){for(var o=0;o<t.length;o++){var n=t[o];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,ty(n.key),n)}}function py(e,t){return py=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},py(e,t)}function hy(e){return hy=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},hy(e)}function fy(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return(fy=function(){return!!e})()}function gy(e,t){if(t&&("object"==(0,ey.A)(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function my(e){return function(e){if(Array.isArray(e))return iy(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||ay(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}var yy=function(){function e(e){var t=this;this._insertTag=function(e){var o;o=0===t.tags.length?t.insertionPoint?t.insertionPoint.nextSibling:t.prepend?t.container.firstChild:t.before:t.tags[t.tags.length-1].nextSibling,t.container.insertBefore(e,o),t.tags.push(e)},this.isSpeedy=void 0===e.speedy||e.speedy,this.tags=[],this.ctr=0,this.nonce=e.nonce,this.key=e.key,this.container=e.container,this.prepend=e.prepend,this.insertionPoint=e.insertionPoint,this.before=null}var t=e.prototype;return t.hydrate=function(e){e.forEach(this._insertTag)},t.insert=function(e){this.ctr%(this.isSpeedy?65e3:1)===0&&this._insertTag(function(e){var t=document.createElement("style");return t.setAttribute("data-emotion",e.key),void 0!==e.nonce&&t.setAttribute("nonce",e.nonce),t.appendChild(document.createTextNode("")),t.setAttribute("data-s",""),t}(this));var t=this.tags[this.tags.length-1];if(this.isSpeedy){var o=function(e){if(e.sheet)return e.sheet;for(var t=0;t<document.styleSheets.length;t++)if(document.styleSheets[t].ownerNode===e)return document.styleSheets[t]}(t);try{o.insertRule(e,o.cssRules.length)}catch(SM){}}else t.appendChild(document.createTextNode(e));this.ctr++},t.flush=function(){this.tags.forEach((function(e){var t;return null==(t=e.parentNode)?void 0:t.removeChild(e)})),this.tags=[],this.ctr=0},e}(),vy=Math.abs,by=String.fromCharCode,xy=Object.assign;function wy(e){return e.trim()}function Cy(e,t,o){return e.replace(t,o)}function _y(e,t){return e.indexOf(t)}function Sy(e,t){return 0|e.charCodeAt(t)}function Ey(e,t,o){return e.slice(t,o)}function ky(e){return e.length}function jy(e){return e.length}function Ay(e,t){return t.push(e),e}var Ry=1,Oy=1,Ty=0,Dy=0,Py=0,Ny="";function Iy(e,t,o,n,r,i,a){return{value:e,root:t,parent:o,type:n,props:r,children:i,line:Ry,column:Oy,length:a,return:""}}function My(e,t){return xy(Iy("",null,null,"",null,null,0),e,{length:-e.length},t)}function Ly(){return Py=Dy<Ty?Sy(Ny,Dy++):0,Oy++,10===Py&&(Oy=1,Ry++),Py}function Fy(){return Sy(Ny,Dy)}function Gy(){return Dy}function zy(e,t){return Ey(Ny,e,t)}function Hy(e){switch(e){case 0:case 9:case 10:case 13:case 32:return 5;case 33:case 43:case 44:case 47:case 62:case 64:case 126:case 59:case 123:case 125:return 4;case 58:return 3;case 34:case 39:case 40:case 91:return 2;case 41:case 93:return 1}return 0}function By(e){return Ry=Oy=1,Ty=ky(Ny=e),Dy=0,[]}function Vy(e){return Ny="",e}function $y(e){return wy(zy(Dy-1,qy(91===e?e+2:40===e?e+1:e)))}function Uy(e){for(;(Py=Fy())&&Py<33;)Ly();return Hy(e)>2||Hy(Py)>3?"":" "}function Wy(e,t){for(;--t&&Ly()&&!(Py<48||Py>102||Py>57&&Py<65||Py>70&&Py<97););return zy(e,Gy()+(t<6&&32==Fy()&&32==Ly()))}function qy(e){for(;Ly();)switch(Py){case e:return Dy;case 34:case 39:34!==e&&39!==e&&qy(Py);break;case 40:41===e&&qy(e);break;case 92:Ly()}return Dy}function Ky(e,t){for(;Ly()&&e+Py!==57&&(e+Py!==84||47!==Fy()););return"/*"+zy(t,Dy-1)+"*"+by(47===e?e:Ly())}function Yy(e){for(;!Hy(Fy());)Ly();return zy(e,Dy)}var Jy="-ms-",Xy="-moz-",Qy="-webkit-",Zy="comm",ev="rule",tv="decl",ov="@keyframes";function nv(e,t){for(var o="",n=jy(e),r=0;r<n;r++)o+=t(e[r],r,e,t)||"";return o}function rv(e,t,o,n){switch(e.type){case"@layer":if(e.children.length)break;case"@import":case tv:return e.return=e.return||e.value;case Zy:return"";case ov:return e.return=e.value+"{"+nv(e.children,n)+"}";case ev:e.value=e.props.join(",")}return ky(o=nv(e.children,n))?e.return=e.value+"{"+o+"}":""}function iv(e){return Vy(av("",null,null,null,[""],e=By(e),0,[0],e))}function av(e,t,o,n,r,i,a,s,l){for(var c=0,d=0,u=a,p=0,h=0,f=0,g=1,m=1,y=1,v=0,b="",x=r,w=i,C=n,_=b;m;)switch(f=v,v=Ly()){case 40:if(108!=f&&58==Sy(_,u-1)){-1!=_y(_+=Cy($y(v),"&","&\f"),"&\f")&&(y=-1);break}case 34:case 39:case 91:_+=$y(v);break;case 9:case 10:case 13:case 32:_+=Uy(f);break;case 92:_+=Wy(Gy()-1,7);continue;case 47:switch(Fy()){case 42:case 47:Ay(lv(Ky(Ly(),Gy()),t,o),l);break;default:_+="/"}break;case 123*g:s[c++]=ky(_)*y;case 125*g:case 59:case 0:switch(v){case 0:case 125:m=0;case 59+d:-1==y&&(_=Cy(_,/\f/g,"")),h>0&&ky(_)-u&&Ay(h>32?cv(_+";",n,o,u-1):cv(Cy(_," ","")+";",n,o,u-2),l);break;case 59:_+=";";default:if(Ay(C=sv(_,t,o,c,d,r,s,b,x=[],w=[],u),i),123===v)if(0===d)av(_,t,C,C,x,i,u,s,w);else switch(99===p&&110===Sy(_,3)?100:p){case 100:case 108:case 109:case 115:av(e,C,C,n&&Ay(sv(e,C,C,0,0,r,s,b,r,x=[],u),w),r,w,u,s,n?x:w);break;default:av(_,C,C,C,[""],w,0,s,w)}}c=d=h=0,g=y=1,b=_="",u=a;break;case 58:u=1+ky(_),h=f;default:if(g<1)if(123==v)--g;else if(125==v&&0==g++&&125==(Py=Dy>0?Sy(Ny,--Dy):0,Oy--,10===Py&&(Oy=1,Ry--),Py))continue;switch(_+=by(v),v*g){case 38:y=d>0?1:(_+="\f",-1);break;case 44:s[c++]=(ky(_)-1)*y,y=1;break;case 64:45===Fy()&&(_+=$y(Ly())),p=Fy(),d=u=ky(b=_+=Yy(Gy())),v++;break;case 45:45===f&&2==ky(_)&&(g=0)}}return i}function sv(e,t,o,n,r,i,a,s,l,c,d){for(var u=r-1,p=0===r?i:[""],h=jy(p),f=0,g=0,m=0;f<n;++f)for(var y=0,v=Ey(e,u+1,u=vy(g=a[f])),b=e;y<h;++y)(b=wy(g>0?p[y]+" "+v:Cy(v,/&\f/g,p[y])))&&(l[m++]=b);return Iy(e,t,o,0===r?ev:s,l,c,d)}function lv(e,t,o){return Iy(e,t,o,Zy,by(Py),Ey(e,2,-2),0)}function cv(e,t,o,n){return Iy(e,t,o,tv,Ey(e,0,n),Ey(e,n+1,-1),n)}var dv=function(e,t,o){for(var n=0,r=0;n=r,r=Fy(),38===n&&12===r&&(t[o]=1),!Hy(r);)Ly();return zy(e,Dy)},uv=function(e,t){return Vy(function(e,t){var o=-1,n=44;do{switch(Hy(n)){case 0:38===n&&12===Fy()&&(t[o]=1),e[o]+=dv(Dy-1,t,o);break;case 2:e[o]+=$y(n);break;case 4:if(44===n){e[++o]=58===Fy()?"&\f":"",t[o]=e[o].length;break}default:e[o]+=by(n)}}while(n=Ly());return e}(By(e),t))},pv=new WeakMap,hv=function(e){if("rule"===e.type&&e.parent&&!(e.length<1)){for(var t=e.value,o=e.parent,n=e.column===o.column&&e.line===o.line;"rule"!==o.type;)if(!(o=o.parent))return;if((1!==e.props.length||58===t.charCodeAt(0)||pv.get(o))&&!n){pv.set(e,!0);for(var r=[],i=uv(t,r),a=o.props,s=0,l=0;s<i.length;s++)for(var c=0;c<a.length;c++,l++)e.props[l]=r[s]?i[s].replace(/&\f/g,a[c]):a[c]+" "+i[s]}}},fv=function(e){if("decl"===e.type){var t=e.value;108===t.charCodeAt(0)&&98===t.charCodeAt(2)&&(e.return="",e.value="")}};function gv(e,t){switch(function(e,t){return 45^Sy(e,0)?(((t<<2^Sy(e,0))<<2^Sy(e,1))<<2^Sy(e,2))<<2^Sy(e,3):0}(e,t)){case 5103:return Qy+"print-"+e+e;case 5737:case 4201:case 3177:case 3433:case 1641:case 4457:case 2921:case 5572:case 6356:case 5844:case 3191:case 6645:case 3005:case 6391:case 5879:case 5623:case 6135:case 4599:case 4855:case 4215:case 6389:case 5109:case 5365:case 5621:case 3829:return Qy+e+e;case 5349:case 4246:case 4810:case 6968:case 2756:return Qy+e+Xy+e+Jy+e+e;case 6828:case 4268:return Qy+e+Jy+e+e;case 6165:return Qy+e+Jy+"flex-"+e+e;case 5187:return Qy+e+Cy(e,/(\w+).+(:[^]+)/,Qy+"box-$1$2"+Jy+"flex-$1$2")+e;case 5443:return Qy+e+Jy+"flex-item-"+Cy(e,/flex-|-self/,"")+e;case 4675:return Qy+e+Jy+"flex-line-pack"+Cy(e,/align-content|flex-|-self/,"")+e;case 5548:return Qy+e+Jy+Cy(e,"shrink","negative")+e;case 5292:return Qy+e+Jy+Cy(e,"basis","preferred-size")+e;case 6060:return Qy+"box-"+Cy(e,"-grow","")+Qy+e+Jy+Cy(e,"grow","positive")+e;case 4554:return Qy+Cy(e,/([^-])(transform)/g,"$1"+Qy+"$2")+e;case 6187:return Cy(Cy(Cy(e,/(zoom-|grab)/,Qy+"$1"),/(image-set)/,Qy+"$1"),e,"")+e;case 5495:case 3959:return Cy(e,/(image-set\([^]*)/,Qy+"$1$`$1");case 4968:return Cy(Cy(e,/(.+:)(flex-)?(.*)/,Qy+"box-pack:$3"+Jy+"flex-pack:$3"),/s.+-b[^;]+/,"justify")+Qy+e+e;case 4095:case 3583:case 4068:case 2532:return Cy(e,/(.+)-inline(.+)/,Qy+"$1$2")+e;case 8116:case 7059:case 5753:case 5535:case 5445:case 5701:case 4933:case 4677:case 5533:case 5789:case 5021:case 4765:if(ky(e)-1-t>6)switch(Sy(e,t+1)){case 109:if(45!==Sy(e,t+4))break;case 102:return Cy(e,/(.+:)(.+)-([^]+)/,"$1"+Qy+"$2-$3$1"+Xy+(108==Sy(e,t+3)?"$3":"$2-$3"))+e;case 115:return~_y(e,"stretch")?gv(Cy(e,"stretch","fill-available"),t)+e:e}break;case 4949:if(115!==Sy(e,t+1))break;case 6444:switch(Sy(e,ky(e)-3-(~_y(e,"!important")&&10))){case 107:return Cy(e,":",":"+Qy)+e;case 101:return Cy(e,/(.+:)([^;!]+)(;|!.+)?/,"$1"+Qy+(45===Sy(e,14)?"inline-":"")+"box$3$1"+Qy+"$2$3$1"+Jy+"$2box$3")+e}break;case 5936:switch(Sy(e,t+11)){case 114:return Qy+e+Jy+Cy(e,/[svh]\w+-[tblr]{2}/,"tb")+e;case 108:return Qy+e+Jy+Cy(e,/[svh]\w+-[tblr]{2}/,"tb-rl")+e;case 45:return Qy+e+Jy+Cy(e,/[svh]\w+-[tblr]{2}/,"lr")+e}return Qy+e+Jy+e+e}return e}var mv=[function(e,t,o,n){if(e.length>-1&&!e.return)switch(e.type){case tv:e.return=gv(e.value,e.length);break;case ov:return nv([My(e,{value:Cy(e.value,"@","@"+Qy)})],n);case ev:if(e.length)return function(e,t){return e.map(t).join("")}(e.props,(function(t){switch(function(e,t){return(e=t.exec(e))?e[0]:e}(t,/(::plac\w+|:read-\w+)/)){case":read-only":case":read-write":return nv([My(e,{props:[Cy(t,/:(read-\w+)/,":-moz-$1")]})],n);case"::placeholder":return nv([My(e,{props:[Cy(t,/:(plac\w+)/,":"+Qy+"input-$1")]}),My(e,{props:[Cy(t,/:(plac\w+)/,":-moz-$1")]}),My(e,{props:[Cy(t,/:(plac\w+)/,Jy+"input-$1")]})],n)}return""}))}}],yv=function(e){var t=e.key;if("css"===t){var o=document.querySelectorAll("style[data-emotion]:not([data-s])");Array.prototype.forEach.call(o,(function(e){-1!==e.getAttribute("data-emotion").indexOf(" ")&&(document.head.appendChild(e),e.setAttribute("data-s",""))}))}var n,r,i=e.stylisPlugins||mv,a={},s=[];n=e.container||document.head,Array.prototype.forEach.call(document.querySelectorAll('style[data-emotion^="'+t+' "]'),(function(e){for(var t=e.getAttribute("data-emotion").split(" "),o=1;o<t.length;o++)a[t[o]]=!0;s.push(e)}));var l,c,d=[rv,(c=function(e){l.insert(e)},function(e){e.root||(e=e.return)&&c(e)})],u=function(e){var t=jy(e);return function(o,n,r,i){for(var a="",s=0;s<t;s++)a+=e[s](o,n,r,i)||"";return a}}([hv,fv].concat(i,d));r=function(e,t,o,n){l=o,nv(iv(e?e+"{"+t.styles+"}":t.styles),u),n&&(p.inserted[t.name]=!0)};var p={key:t,sheet:new yy({key:t,container:n,nonce:e.nonce,speedy:e.speedy,prepend:e.prepend,insertionPoint:e.insertionPoint}),nonce:e.nonce,inserted:a,registered:{},insert:r};return p.sheet.hydrate(s),p};var vv=function(e,t,o){var n=e.key+"-"+t.name;!1===o&&void 0===e.registered[n]&&(e.registered[n]=t.styles)};var bv={animationIterationCount:1,aspectRatio:1,borderImageOutset:1,borderImageSlice:1,borderImageWidth:1,boxFlex:1,boxFlexGroup:1,boxOrdinalGroup:1,columnCount:1,columns:1,flex:1,flexGrow:1,flexPositive:1,flexShrink:1,flexNegative:1,flexOrder:1,gridRow:1,gridRowEnd:1,gridRowSpan:1,gridRowStart:1,gridColumn:1,gridColumnEnd:1,gridColumnSpan:1,gridColumnStart:1,msGridRow:1,msGridRowSpan:1,msGridColumn:1,msGridColumnSpan:1,fontWeight:1,lineHeight:1,opacity:1,order:1,orphans:1,scale:1,tabSize:1,widows:1,zIndex:1,zoom:1,WebkitLineClamp:1,fillOpacity:1,floodOpacity:1,stopOpacity:1,strokeDasharray:1,strokeDashoffset:1,strokeMiterlimit:1,strokeOpacity:1,strokeWidth:1};function xv(e){var t=Object.create(null);return function(o){return void 0===t[o]&&(t[o]=e(o)),t[o]}}var wv=/[A-Z]|^ms/g,Cv=/_EMO_([^_]+?)_([^]*?)_EMO_/g,_v=function(e){return 45===e.charCodeAt(1)},Sv=function(e){return null!=e&&"boolean"!==typeof e},Ev=xv((function(e){return _v(e)?e:e.replace(wv,"-$&").toLowerCase()})),kv=function(e,t){switch(e){case"animation":case"animationName":if("string"===typeof t)return t.replace(Cv,(function(e,t,o){return Av={name:t,styles:o,next:Av},t}))}return 1===bv[e]||_v(e)||"number"!==typeof t||0===t?t:t+"px"};function jv(e,t,o){if(null==o)return"";var n=o;if(void 0!==n.__emotion_styles)return n;switch(typeof o){case"boolean":return"";case"object":var r=o;if(1===r.anim)return Av={name:r.name,styles:r.styles,next:Av},r.name;var i=o;if(void 0!==i.styles){var a=i.next;if(void 0!==a)for(;void 0!==a;)Av={name:a.name,styles:a.styles,next:Av},a=a.next;return i.styles+";"}return function(e,t,o){var n="";if(Array.isArray(o))for(var r=0;r<o.length;r++)n+=jv(e,t,o[r])+";";else for(var i in o){var a=o[i];if("object"!==typeof a){var s=a;null!=t&&void 0!==t[s]?n+=i+"{"+t[s]+"}":Sv(s)&&(n+=Ev(i)+":"+kv(i,s)+";")}else if(!Array.isArray(a)||"string"!==typeof a[0]||null!=t&&void 0!==t[a[0]]){var l=jv(e,t,a);switch(i){case"animation":case"animationName":n+=Ev(i)+":"+l+";";break;default:n+=i+"{"+l+"}"}}else for(var c=0;c<a.length;c++)Sv(a[c])&&(n+=Ev(i)+":"+kv(i,a[c])+";")}return n}(e,t,o);case"function":if(void 0!==e){var s=Av,l=o(e);return Av=s,jv(e,t,l)}}var c=o;if(null==t)return c;var d=t[c];return void 0!==d?d:c}var Av,Rv=/label:\s*([^\s;{]+)\s*(;|$)/g;function Ov(e,t,o){if(1===e.length&&"object"===typeof e[0]&&null!==e[0]&&void 0!==e[0].styles)return e[0];var n=!0,r="";Av=void 0;var i=e[0];null==i||void 0===i.raw?(n=!1,r+=jv(o,t,i)):r+=i[0];for(var a=1;a<e.length;a++){if(r+=jv(o,t,e[a]),n)r+=i[a]}Rv.lastIndex=0;for(var s,l="";null!==(s=Rv.exec(r));)l+="-"+s[1];var c=function(e){for(var t,o=0,n=0,r=e.length;r>=4;++n,r-=4)t=1540483477*(65535&(t=255&e.charCodeAt(n)|(255&e.charCodeAt(++n))<<8|(255&e.charCodeAt(++n))<<16|(255&e.charCodeAt(++n))<<24))+(59797*(t>>>16)<<16),o=1540483477*(65535&(t^=t>>>24))+(59797*(t>>>16)<<16)^1540483477*(65535&o)+(59797*(o>>>16)<<16);switch(r){case 3:o^=(255&e.charCodeAt(n+2))<<16;case 2:o^=(255&e.charCodeAt(n+1))<<8;case 1:o=1540483477*(65535&(o^=255&e.charCodeAt(n)))+(59797*(o>>>16)<<16)}return(((o=1540483477*(65535&(o^=o>>>13))+(59797*(o>>>16)<<16))^o>>>15)>>>0).toString(36)}(r)+l;return{name:c,styles:r,next:Av}}var Tv=!!n.useInsertionEffect&&n.useInsertionEffect,Dv=Tv||function(e){return e()},Pv=(Tv||t.useLayoutEffect,t.createContext("undefined"!==typeof HTMLElement?yv({key:"css"}):null)),Nv=(Pv.Provider,function(e){return(0,t.forwardRef)((function(o,n){var r=(0,t.useContext)(Pv);return e(o,r,n)}))}),Iv=t.createContext({});var Mv={}.hasOwnProperty,Lv="__EMOTION_TYPE_PLEASE_DO_NOT_USE__",Fv=function(e){var t=e.cache,o=e.serialized,n=e.isStringTag;return vv(t,o,n),Dv((function(){return function(e,t,o){vv(e,t,o);var n=e.key+"-"+t.name;if(void 0===e.inserted[t.name]){var r=t;do{e.insert(t===r?"."+n:"",r,e.sheet,!0),r=r.next}while(void 0!==r)}}(t,o,n)})),null},Gv=Nv((function(e,o,n){var r=e.css;"string"===typeof r&&void 0!==o.registered[r]&&(r=o.registered[r]);var i=e[Lv],a=[r],s="";"string"===typeof e.className?s=function(e,t,o){var n="";return o.split(" ").forEach((function(o){void 0!==e[o]?t.push(e[o]+";"):o&&(n+=o+" ")})),n}(o.registered,a,e.className):null!=e.className&&(s=e.className+" ");var l=Ov(a,void 0,t.useContext(Iv));s+=o.key+"-"+l.name;var c={};for(var d in e)Mv.call(e,d)&&"css"!==d&&d!==Lv&&(c[d]=e[d]);return c.className=s,n&&(c.ref=n),t.createElement(t.Fragment,null,t.createElement(Fv,{cache:o,serialized:l,isStringTag:"string"===typeof i}),t.createElement(i,c))})),zv=Gv,Hv=(o(219),function(e,o){var n=arguments;if(null==o||!Mv.call(o,"css"))return t.createElement.apply(void 0,n);var r=n.length,i=new Array(r);i[0]=zv,i[1]=function(e,t){var o={};for(var n in t)Mv.call(t,n)&&(o[n]=t[n]);return o[Lv]=e,o}(e,o);for(var a=2;a<r;a++)i[a]=n[a];return t.createElement.apply(null,i)});!function(e){var t;t||(t=e.JSX||(e.JSX={}))}(Hv||(Hv={}));function Bv(){for(var e=arguments.length,t=new Array(e),o=0;o<e;o++)t[o]=arguments[o];return Ov(t)}const Vv=Math.min,$v=Math.max,Uv=Math.round,Wv=Math.floor,qv=e=>({x:e,y:e});function Kv(e){const{x:t,y:o,width:n,height:r}=e;return{width:n,height:r,top:o,left:t,right:t+n,bottom:o+r,x:t,y:o}}function Yv(){return"undefined"!==typeof window}function Jv(e){return Zv(e)?(e.nodeName||"").toLowerCase():"#document"}function Xv(e){var t;return(null==e||null==(t=e.ownerDocument)?void 0:t.defaultView)||window}function Qv(e){var t;return null==(t=(Zv(e)?e.ownerDocument:e.document)||window.document)?void 0:t.documentElement}function Zv(e){return!!Yv()&&(e instanceof Node||e instanceof Xv(e).Node)}function eb(e){return!!Yv()&&(e instanceof Element||e instanceof Xv(e).Element)}function tb(e){return!!Yv()&&(e instanceof HTMLElement||e instanceof Xv(e).HTMLElement)}function ob(e){return!(!Yv()||"undefined"===typeof ShadowRoot)&&(e instanceof ShadowRoot||e instanceof Xv(e).ShadowRoot)}function nb(e){const{overflow:t,overflowX:o,overflowY:n,display:r}=ab(e);return/auto|scroll|overlay|hidden|clip/.test(t+n+o)&&!["inline","contents"].includes(r)}function rb(){return!("undefined"===typeof CSS||!CSS.supports)&&CSS.supports("-webkit-backdrop-filter","none")}function ib(e){return["html","body","#document"].includes(Jv(e))}function ab(e){return Xv(e).getComputedStyle(e)}function sb(e){if("html"===Jv(e))return e;const t=e.assignedSlot||e.parentNode||ob(e)&&e.host||Qv(e);return ob(t)?t.host:t}function lb(e){const t=sb(e);return ib(t)?e.ownerDocument?e.ownerDocument.body:e.body:tb(t)&&nb(t)?t:lb(t)}function cb(e,t,o){var n;void 0===t&&(t=[]),void 0===o&&(o=!0);const r=lb(e),i=r===(null==(n=e.ownerDocument)?void 0:n.body),a=Xv(r);if(i){const e=db(a);return t.concat(a,a.visualViewport||[],nb(r)?r:[],e&&o?cb(e):[])}return t.concat(r,cb(r,[],o))}function db(e){return e.parent&&Object.getPrototypeOf(e.parent)?e.frameElement:null}function ub(e){const t=ab(e);let o=parseFloat(t.width)||0,n=parseFloat(t.height)||0;const r=tb(e),i=r?e.offsetWidth:o,a=r?e.offsetHeight:n,s=Uv(o)!==i||Uv(n)!==a;return s&&(o=i,n=a),{width:o,height:n,$:s}}function pb(e){return eb(e)?e:e.contextElement}function hb(e){const t=pb(e);if(!tb(t))return qv(1);const o=t.getBoundingClientRect(),{width:n,height:r,$:i}=ub(t);let a=(i?Uv(o.width):o.width)/n,s=(i?Uv(o.height):o.height)/r;return a&&Number.isFinite(a)||(a=1),s&&Number.isFinite(s)||(s=1),{x:a,y:s}}const fb=qv(0);function gb(e){const t=Xv(e);return rb()&&t.visualViewport?{x:t.visualViewport.offsetLeft,y:t.visualViewport.offsetTop}:fb}function mb(e,t,o,n){void 0===t&&(t=!1),void 0===o&&(o=!1);const r=e.getBoundingClientRect(),i=pb(e);let a=qv(1);t&&(n?eb(n)&&(a=hb(n)):a=hb(e));const s=function(e,t,o){return void 0===t&&(t=!1),!(!o||t&&o!==Xv(e))&&t}(i,o,n)?gb(i):qv(0);let l=(r.left+s.x)/a.x,c=(r.top+s.y)/a.y,d=r.width/a.x,u=r.height/a.y;if(i){const e=Xv(i),t=n&&eb(n)?Xv(n):n;let o=e,r=db(o);for(;r&&n&&t!==o;){const e=hb(r),t=r.getBoundingClientRect(),n=ab(r),i=t.left+(r.clientLeft+parseFloat(n.paddingLeft))*e.x,a=t.top+(r.clientTop+parseFloat(n.paddingTop))*e.y;l*=e.x,c*=e.y,d*=e.x,u*=e.y,l+=i,c+=a,o=Xv(r),r=db(o)}}return Kv({width:d,height:u,x:l,y:c})}function yb(e,t){return e.x===t.x&&e.y===t.y&&e.width===t.width&&e.height===t.height}function vb(e,t,o,n){void 0===n&&(n={});const{ancestorScroll:r=!0,ancestorResize:i=!0,elementResize:a="function"===typeof ResizeObserver,layoutShift:s="function"===typeof IntersectionObserver,animationFrame:l=!1}=n,c=pb(e),d=r||i?[...c?cb(c):[],...cb(t)]:[];d.forEach((e=>{r&&e.addEventListener("scroll",o,{passive:!0}),i&&e.addEventListener("resize",o)}));const u=c&&s?function(e,t){let o,n=null;const r=Qv(e);function i(){var e;clearTimeout(o),null==(e=n)||e.disconnect(),n=null}return function a(s,l){void 0===s&&(s=!1),void 0===l&&(l=1),i();const c=e.getBoundingClientRect(),{left:d,top:u,width:p,height:h}=c;if(s||t(),!p||!h)return;const f={rootMargin:-Wv(u)+"px "+-Wv(r.clientWidth-(d+p))+"px "+-Wv(r.clientHeight-(u+h))+"px "+-Wv(d)+"px",threshold:$v(0,Vv(1,l))||1};let g=!0;function m(t){const n=t[0].intersectionRatio;if(n!==l){if(!g)return a();n?a(!1,n):o=setTimeout((()=>{a(!1,1e-7)}),1e3)}1!==n||yb(c,e.getBoundingClientRect())||a(),g=!1}try{n=new IntersectionObserver(m,{...f,root:r.ownerDocument})}catch(SM){n=new IntersectionObserver(m,f)}n.observe(e)}(!0),i}(c,o):null;let p,h=-1,f=null;a&&(f=new ResizeObserver((e=>{let[n]=e;n&&n.target===c&&f&&(f.unobserve(t),cancelAnimationFrame(h),h=requestAnimationFrame((()=>{var e;null==(e=f)||e.observe(t)}))),o()})),c&&!l&&f.observe(c),f.observe(t));let g=l?mb(e):null;return l&&function t(){const n=mb(e);g&&!yb(g,n)&&o();g=n,p=requestAnimationFrame(t)}(),o(),()=>{var e;d.forEach((e=>{r&&e.removeEventListener("scroll",o),i&&e.removeEventListener("resize",o)})),null==u||u(),null==(e=f)||e.disconnect(),f=null,l&&cancelAnimationFrame(p)}}var bb=t.useLayoutEffect,xb=["className","clearValue","cx","getStyles","getClassNames","getValue","hasValue","isMulti","isRtl","options","selectOption","selectProps","setValue","theme"],wb=function(){};function Cb(e,t){return t?"-"===t[0]?e+t:e+"__"+t:e}function _b(e,t){for(var o=arguments.length,n=new Array(o>2?o-2:0),r=2;r<o;r++)n[r-2]=arguments[r];var i=[].concat(n);if(t&&e)for(var a in t)t.hasOwnProperty(a)&&t[a]&&i.push("".concat(Cb(e,a)));return i.filter((function(e){return e})).map((function(e){return String(e).trim()})).join(" ")}var Sb=function(e){return t=e,Array.isArray(t)?e.filter(Boolean):"object"===(0,ey.A)(e)&&null!==e?[e]:[];var t},Eb=function(e){return e.className,e.clearValue,e.cx,e.getStyles,e.getClassNames,e.getValue,e.hasValue,e.isMulti,e.isRtl,e.options,e.selectOption,e.selectProps,e.setValue,e.theme,ry({},ly(e,xb))},kb=function(e,t,o){var n=e.cx,r=e.getStyles,i=e.getClassNames,a=e.className;return{css:r(t,e),className:n(null!==o&&void 0!==o?o:{},i(t,e),a)}};function jb(e){return[document.documentElement,document.body,window].indexOf(e)>-1}function Ab(e){return jb(e)?window.pageYOffset:e.scrollTop}function Rb(e,t){jb(e)?window.scrollTo(0,t):e.scrollTop=t}function Ob(e,t){var o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:200,n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:wb,r=Ab(e),i=t-r,a=0;!function t(){var s=function(e,t,o,n){return o*((e=e/n-1)*e*e+1)+t}(a+=10,r,i,o);Rb(e,s),a<o?window.requestAnimationFrame(t):n(e)}()}function Tb(e,t){var o=e.getBoundingClientRect(),n=t.getBoundingClientRect(),r=t.offsetHeight/3;n.bottom+r>o.bottom?Rb(e,Math.min(t.offsetTop+t.clientHeight-e.offsetHeight+r,e.scrollHeight)):n.top-r<o.top&&Rb(e,Math.max(t.offsetTop-r,0))}function Db(){try{return document.createEvent("TouchEvent"),!0}catch(SM){return!1}}var Pb=!1,Nb={get passive(){return Pb=!0}},Ib="undefined"!==typeof window?window:{};Ib.addEventListener&&Ib.removeEventListener&&(Ib.addEventListener("p",wb,Nb),Ib.removeEventListener("p",wb,!1));var Mb=Pb;function Lb(e){return null!=e}function Fb(e,t,o){return e?t:o}var Gb=["children","innerProps"],zb=["children","innerProps"];function Hb(e){var t=e.maxHeight,o=e.menuEl,n=e.minHeight,r=e.placement,i=e.shouldScroll,a=e.isFixedPosition,s=e.controlHeight,l=function(e){var t=getComputedStyle(e),o="absolute"===t.position,n=/(auto|scroll)/;if("fixed"===t.position)return document.documentElement;for(var r=e;r=r.parentElement;)if(t=getComputedStyle(r),(!o||"static"!==t.position)&&n.test(t.overflow+t.overflowY+t.overflowX))return r;return document.documentElement}(o),c={placement:"bottom",maxHeight:t};if(!o||!o.offsetParent)return c;var d,u=l.getBoundingClientRect().height,p=o.getBoundingClientRect(),h=p.bottom,f=p.height,g=p.top,m=o.offsetParent.getBoundingClientRect().top,y=a?window.innerHeight:jb(d=l)?window.innerHeight:d.clientHeight,v=Ab(l),b=parseInt(getComputedStyle(o).marginBottom,10),x=parseInt(getComputedStyle(o).marginTop,10),w=m-x,C=y-g,_=w+v,S=u-v-g,E=h-y+v+b,k=v+g-x,j=160;switch(r){case"auto":case"bottom":if(C>=f)return{placement:"bottom",maxHeight:t};if(S>=f&&!a)return i&&Ob(l,E,j),{placement:"bottom",maxHeight:t};if(!a&&S>=n||a&&C>=n)return i&&Ob(l,E,j),{placement:"bottom",maxHeight:a?C-b:S-b};if("auto"===r||a){var A=t,R=a?w:_;return R>=n&&(A=Math.min(R-b-s,t)),{placement:"top",maxHeight:A}}if("bottom"===r)return i&&Rb(l,E),{placement:"bottom",maxHeight:t};break;case"top":if(w>=f)return{placement:"top",maxHeight:t};if(_>=f&&!a)return i&&Ob(l,k,j),{placement:"top",maxHeight:t};if(!a&&_>=n||a&&w>=n){var O=t;return(!a&&_>=n||a&&w>=n)&&(O=a?w-x:_-x),i&&Ob(l,k,j),{placement:"top",maxHeight:O}}return{placement:"bottom",maxHeight:t};default:throw new Error('Invalid placement provided "'.concat(r,'".'))}return c}var Bb,Vb=function(e){return"auto"===e?"bottom":e},$b=(0,t.createContext)(null),Ub=function(e){var o=e.children,n=e.minMenuHeight,r=e.maxMenuHeight,i=e.menuPlacement,a=e.menuPosition,s=e.menuShouldScrollIntoView,l=e.theme,c=((0,t.useContext)($b)||{}).setPortalPlacement,d=(0,t.useRef)(null),u=sy((0,t.useState)(r),2),p=u[0],h=u[1],f=sy((0,t.useState)(null),2),g=f[0],m=f[1],y=l.spacing.controlHeight;return bb((function(){var e=d.current;if(e){var t="fixed"===a,o=Hb({maxHeight:r,menuEl:e,minHeight:n,placement:i,shouldScroll:s&&!t,isFixedPosition:t,controlHeight:y});h(o.maxHeight),m(o.placement),null===c||void 0===c||c(o.placement)}}),[r,i,a,s,n,c,y]),o({ref:d,placerProps:ry(ry({},e),{},{placement:g||Vb(i),maxHeight:p})})},Wb=function(e){var t=e.children,o=e.innerRef,n=e.innerProps;return Hv("div",dy({},kb(e,"menu",{menu:!0}),{ref:o},n),t)},qb=function(e,t){var o=e.theme,n=o.spacing.baseUnit,r=o.colors;return ry({textAlign:"center"},t?{}:{color:r.neutral40,padding:"".concat(2*n,"px ").concat(3*n,"px")})},Kb=qb,Yb=qb,Jb=["size"],Xb=["innerProps","isRtl","size"];var Qb={name:"8mmkcg",styles:"display:inline-block;fill:currentColor;line-height:1;stroke:currentColor;stroke-width:0"},Zb=function(e){var t=e.size,o=ly(e,Jb);return Hv("svg",dy({height:t,width:t,viewBox:"0 0 20 20","aria-hidden":"true",focusable:"false",css:Qb},o))},ex=function(e){return Hv(Zb,dy({size:20},e),Hv("path",{d:"M14.348 14.849c-0.469 0.469-1.229 0.469-1.697 0l-2.651-3.030-2.651 3.029c-0.469 0.469-1.229 0.469-1.697 0-0.469-0.469-0.469-1.229 0-1.697l2.758-3.15-2.759-3.152c-0.469-0.469-0.469-1.228 0-1.697s1.228-0.469 1.697 0l2.652 3.031 2.651-3.031c0.469-0.469 1.228-0.469 1.697 0s0.469 1.229 0 1.697l-2.758 3.152 2.758 3.15c0.469 0.469 0.469 1.229 0 1.698z"}))},tx=function(e){return Hv(Zb,dy({size:20},e),Hv("path",{d:"M4.516 7.548c0.436-0.446 1.043-0.481 1.576 0l3.908 3.747 3.908-3.747c0.533-0.481 1.141-0.446 1.574 0 0.436 0.445 0.408 1.197 0 1.615-0.406 0.418-4.695 4.502-4.695 4.502-0.217 0.223-0.502 0.335-0.787 0.335s-0.57-0.112-0.789-0.335c0 0-4.287-4.084-4.695-4.502s-0.436-1.17 0-1.615z"}))},ox=function(e,t){var o=e.isFocused,n=e.theme,r=n.spacing.baseUnit,i=n.colors;return ry({label:"indicatorContainer",display:"flex",transition:"color 150ms"},t?{}:{color:o?i.neutral60:i.neutral20,padding:2*r,":hover":{color:o?i.neutral80:i.neutral40}})},nx=ox,rx=ox,ix=function(){var e=Bv.apply(void 0,arguments),t="animation-"+e.name;return{name:t,styles:"@keyframes "+t+"{"+e.styles+"}",anim:1,toString:function(){return"_EMO_"+this.name+"_"+this.styles+"_EMO_"}}}(Bb||(Bb=function(e,t){return t||(t=e.slice(0)),Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(t)}}))}(["\n  0%, 80%, 100% { opacity: 0; }\n  40% { opacity: 1; }\n"]))),ax=function(e){var t=e.delay,o=e.offset;return Hv("span",{css:Bv({animation:"".concat(ix," 1s ease-in-out ").concat(t,"ms infinite;"),backgroundColor:"currentColor",borderRadius:"1em",display:"inline-block",marginLeft:o?"1em":void 0,height:"1em",verticalAlign:"top",width:"1em"},"","")})},sx=function(e){var t=e.children,o=e.isDisabled,n=e.isFocused,r=e.innerRef,i=e.innerProps,a=e.menuIsOpen;return Hv("div",dy({ref:r},kb(e,"control",{control:!0,"control--is-disabled":o,"control--is-focused":n,"control--menu-is-open":a}),i,{"aria-disabled":o||void 0}),t)},lx=["data"],cx=function(e){var t=e.children,o=e.cx,n=e.getStyles,r=e.getClassNames,i=e.Heading,a=e.headingProps,s=e.innerProps,l=e.label,c=e.theme,d=e.selectProps;return Hv("div",dy({},kb(e,"group",{group:!0}),s),Hv(i,dy({},a,{selectProps:d,theme:c,getStyles:n,getClassNames:r,cx:o}),l),Hv("div",null,t))},dx=["innerRef","isDisabled","isHidden","inputClassName"],ux={gridArea:"1 / 2",font:"inherit",minWidth:"2px",border:0,margin:0,outline:0,padding:0},px={flex:"1 1 auto",display:"inline-grid",gridArea:"1 / 1 / 2 / 3",gridTemplateColumns:"0 min-content","&:after":ry({content:'attr(data-value) " "',visibility:"hidden",whiteSpace:"pre"},ux)},hx=function(e){return ry({label:"input",color:"inherit",background:0,opacity:e?0:1,width:"100%"},ux)},fx=function(e){var t=e.children,o=e.innerProps;return Hv("div",o,t)};var gx={ClearIndicator:function(e){var t=e.children,o=e.innerProps;return Hv("div",dy({},kb(e,"clearIndicator",{indicator:!0,"clear-indicator":!0}),o),t||Hv(ex,null))},Control:sx,DropdownIndicator:function(e){var t=e.children,o=e.innerProps;return Hv("div",dy({},kb(e,"dropdownIndicator",{indicator:!0,"dropdown-indicator":!0}),o),t||Hv(tx,null))},DownChevron:tx,CrossIcon:ex,Group:cx,GroupHeading:function(e){var t=Eb(e);t.data;var o=ly(t,lx);return Hv("div",dy({},kb(e,"groupHeading",{"group-heading":!0}),o))},IndicatorsContainer:function(e){var t=e.children,o=e.innerProps;return Hv("div",dy({},kb(e,"indicatorsContainer",{indicators:!0}),o),t)},IndicatorSeparator:function(e){var t=e.innerProps;return Hv("span",dy({},t,kb(e,"indicatorSeparator",{"indicator-separator":!0})))},Input:function(e){var t=e.cx,o=e.value,n=Eb(e),r=n.innerRef,i=n.isDisabled,a=n.isHidden,s=n.inputClassName,l=ly(n,dx);return Hv("div",dy({},kb(e,"input",{"input-container":!0}),{"data-value":o||""}),Hv("input",dy({className:t({input:!0},s),ref:r,style:hx(a),disabled:i},l)))},LoadingIndicator:function(e){var t=e.innerProps,o=e.isRtl,n=e.size,r=void 0===n?4:n,i=ly(e,Xb);return Hv("div",dy({},kb(ry(ry({},i),{},{innerProps:t,isRtl:o,size:r}),"loadingIndicator",{indicator:!0,"loading-indicator":!0}),t),Hv(ax,{delay:0,offset:o}),Hv(ax,{delay:160,offset:!0}),Hv(ax,{delay:320,offset:!o}))},Menu:Wb,MenuList:function(e){var t=e.children,o=e.innerProps,n=e.innerRef,r=e.isMulti;return Hv("div",dy({},kb(e,"menuList",{"menu-list":!0,"menu-list--is-multi":r}),{ref:n},o),t)},MenuPortal:function(e){var o=e.appendTo,n=e.children,r=e.controlElement,i=e.innerProps,s=e.menuPlacement,l=e.menuPosition,c=(0,t.useRef)(null),d=(0,t.useRef)(null),u=sy((0,t.useState)(Vb(s)),2),p=u[0],h=u[1],f=(0,t.useMemo)((function(){return{setPortalPlacement:h}}),[]),g=sy((0,t.useState)(null),2),m=g[0],y=g[1],v=(0,t.useCallback)((function(){if(r){var e=function(e){var t=e.getBoundingClientRect();return{bottom:t.bottom,height:t.height,left:t.left,right:t.right,top:t.top,width:t.width}}(r),t="fixed"===l?0:window.pageYOffset,o=e[p]+t;o===(null===m||void 0===m?void 0:m.offset)&&e.left===(null===m||void 0===m?void 0:m.rect.left)&&e.width===(null===m||void 0===m?void 0:m.rect.width)||y({offset:o,rect:e})}}),[r,l,p,null===m||void 0===m?void 0:m.offset,null===m||void 0===m?void 0:m.rect.left,null===m||void 0===m?void 0:m.rect.width]);bb((function(){v()}),[v]);var b=(0,t.useCallback)((function(){"function"===typeof d.current&&(d.current(),d.current=null),r&&c.current&&(d.current=vb(r,c.current,v,{elementResize:"ResizeObserver"in window}))}),[r,v]);bb((function(){b()}),[b]);var x=(0,t.useCallback)((function(e){c.current=e,b()}),[b]);if(!o&&"fixed"!==l||!m)return null;var w=Hv("div",dy({ref:x},kb(ry(ry({},e),{},{offset:m.offset,position:l,rect:m.rect}),"menuPortal",{"menu-portal":!0}),i),n);return Hv($b.Provider,{value:f},o?(0,a.createPortal)(w,o):w)},LoadingMessage:function(e){var t=e.children,o=void 0===t?"Loading...":t,n=e.innerProps,r=ly(e,zb);return Hv("div",dy({},kb(ry(ry({},r),{},{children:o,innerProps:n}),"loadingMessage",{"menu-notice":!0,"menu-notice--loading":!0}),n),o)},NoOptionsMessage:function(e){var t=e.children,o=void 0===t?"No options":t,n=e.innerProps,r=ly(e,Gb);return Hv("div",dy({},kb(ry(ry({},r),{},{children:o,innerProps:n}),"noOptionsMessage",{"menu-notice":!0,"menu-notice--no-options":!0}),n),o)},MultiValue:function(e){var t=e.children,o=e.components,n=e.data,r=e.innerProps,i=e.isDisabled,a=e.removeProps,s=e.selectProps,l=o.Container,c=o.Label,d=o.Remove;return Hv(l,{data:n,innerProps:ry(ry({},kb(e,"multiValue",{"multi-value":!0,"multi-value--is-disabled":i})),r),selectProps:s},Hv(c,{data:n,innerProps:ry({},kb(e,"multiValueLabel",{"multi-value__label":!0})),selectProps:s},t),Hv(d,{data:n,innerProps:ry(ry({},kb(e,"multiValueRemove",{"multi-value__remove":!0})),{},{"aria-label":"Remove ".concat(t||"option")},a),selectProps:s}))},MultiValueContainer:fx,MultiValueLabel:fx,MultiValueRemove:function(e){var t=e.children,o=e.innerProps;return Hv("div",dy({role:"button"},o),t||Hv(ex,{size:14}))},Option:function(e){var t=e.children,o=e.isDisabled,n=e.isFocused,r=e.isSelected,i=e.innerRef,a=e.innerProps;return Hv("div",dy({},kb(e,"option",{option:!0,"option--is-disabled":o,"option--is-focused":n,"option--is-selected":r}),{ref:i,"aria-disabled":o},a),t)},Placeholder:function(e){var t=e.children,o=e.innerProps;return Hv("div",dy({},kb(e,"placeholder",{placeholder:!0}),o),t)},SelectContainer:function(e){var t=e.children,o=e.innerProps,n=e.isDisabled,r=e.isRtl;return Hv("div",dy({},kb(e,"container",{"--is-disabled":n,"--is-rtl":r}),o),t)},SingleValue:function(e){var t=e.children,o=e.isDisabled,n=e.innerProps;return Hv("div",dy({},kb(e,"singleValue",{"single-value":!0,"single-value--is-disabled":o}),n),t)},ValueContainer:function(e){var t=e.children,o=e.innerProps,n=e.isMulti,r=e.hasValue;return Hv("div",dy({},kb(e,"valueContainer",{"value-container":!0,"value-container--is-multi":n,"value-container--has-value":r}),o),t)}},mx=Number.isNaN||function(e){return"number"===typeof e&&e!==e};function yx(e,t){if(e.length!==t.length)return!1;for(var o=0;o<e.length;o++)if(n=e[o],r=t[o],!(n===r||mx(n)&&mx(r)))return!1;var n,r;return!0}for(var vx={name:"7pg0cj-a11yText",styles:"label:a11yText;z-index:9999;border:0;clip:rect(1px, 1px, 1px, 1px);height:1px;width:1px;position:absolute;overflow:hidden;padding:0;white-space:nowrap"},bx=function(e){return Hv("span",dy({css:vx},e))},xx={guidance:function(e){var t=e.isSearchable,o=e.isMulti,n=e.tabSelectsValue,r=e.context,i=e.isInitialFocus;switch(r){case"menu":return"Use Up and Down to choose options, press Enter to select the currently focused option, press Escape to exit the menu".concat(n?", press Tab to select the option and exit the menu":"",".");case"input":return i?"".concat(e["aria-label"]||"Select"," is focused ").concat(t?",type to refine list":"",", press Down to open the menu, ").concat(o?" press left to focus selected values":""):"";case"value":return"Use left and right to toggle between focused values, press Backspace to remove the currently focused value";default:return""}},onChange:function(e){var t=e.action,o=e.label,n=void 0===o?"":o,r=e.labels,i=e.isDisabled;switch(t){case"deselect-option":case"pop-value":case"remove-value":return"option ".concat(n,", deselected.");case"clear":return"All selected options have been cleared.";case"initial-input-focus":return"option".concat(r.length>1?"s":""," ").concat(r.join(","),", selected.");case"select-option":return"option ".concat(n,i?" is disabled. Select another option.":", selected.");default:return""}},onFocus:function(e){var t=e.context,o=e.focused,n=e.options,r=e.label,i=void 0===r?"":r,a=e.selectValue,s=e.isDisabled,l=e.isSelected,c=e.isAppleDevice,d=function(e,t){return e&&e.length?"".concat(e.indexOf(t)+1," of ").concat(e.length):""};if("value"===t&&a)return"value ".concat(i," focused, ").concat(d(a,o),".");if("menu"===t&&c){var u=s?" disabled":"",p="".concat(l?" selected":"").concat(u);return"".concat(i).concat(p,", ").concat(d(n,o),".")}return""},onFilter:function(e){var t=e.inputValue,o=e.resultsMessage;return"".concat(o).concat(t?" for search term "+t:"",".")}},wx=function(e){var o=e.ariaSelection,n=e.focusedOption,r=e.focusedValue,i=e.focusableOptions,a=e.isFocused,s=e.selectValue,l=e.selectProps,c=e.id,d=e.isAppleDevice,u=l.ariaLiveMessages,p=l.getOptionLabel,h=l.inputValue,f=l.isMulti,g=l.isOptionDisabled,m=l.isSearchable,y=l.menuIsOpen,v=l.options,b=l.screenReaderStatus,x=l.tabSelectsValue,w=l.isLoading,C=l["aria-label"],_=l["aria-live"],S=(0,t.useMemo)((function(){return ry(ry({},xx),u||{})}),[u]),E=(0,t.useMemo)((function(){var e,t="";if(o&&S.onChange){var n=o.option,r=o.options,i=o.removedValue,a=o.removedValues,l=o.value,c=i||n||(e=l,Array.isArray(e)?null:e),d=c?p(c):"",u=r||a||void 0,h=u?u.map(p):[],f=ry({isDisabled:c&&g(c,s),label:d,labels:h},o);t=S.onChange(f)}return t}),[o,S,g,s,p]),k=(0,t.useMemo)((function(){var e="",t=n||r,o=!!(n&&s&&s.includes(n));if(t&&S.onFocus){var a={focused:t,label:p(t),isDisabled:g(t,s),isSelected:o,options:i,context:t===n?"menu":"value",selectValue:s,isAppleDevice:d};e=S.onFocus(a)}return e}),[n,r,p,g,S,i,s,d]),j=(0,t.useMemo)((function(){var e="";if(y&&v.length&&!w&&S.onFilter){var t=b({count:i.length});e=S.onFilter({inputValue:h,resultsMessage:t})}return e}),[i,h,y,S,v,b,w]),A="initial-input-focus"===(null===o||void 0===o?void 0:o.action),R=(0,t.useMemo)((function(){var e="";if(S.guidance){var t=r?"value":y?"menu":"input";e=S.guidance({"aria-label":C,context:t,isDisabled:n&&g(n,s),isMulti:f,isSearchable:m,tabSelectsValue:x,isInitialFocus:A})}return e}),[C,n,r,f,g,m,y,S,s,x,A]),O=Hv(t.Fragment,null,Hv("span",{id:"aria-selection"},E),Hv("span",{id:"aria-focused"},k),Hv("span",{id:"aria-results"},j),Hv("span",{id:"aria-guidance"},R));return Hv(t.Fragment,null,Hv(bx,{id:c},A&&O),Hv(bx,{"aria-live":_,"aria-atomic":"false","aria-relevant":"additions text",role:"log"},a&&!A&&O))},Cx=[{base:"A",letters:"A\u24b6\uff21\xc0\xc1\xc2\u1ea6\u1ea4\u1eaa\u1ea8\xc3\u0100\u0102\u1eb0\u1eae\u1eb4\u1eb2\u0226\u01e0\xc4\u01de\u1ea2\xc5\u01fa\u01cd\u0200\u0202\u1ea0\u1eac\u1eb6\u1e00\u0104\u023a\u2c6f"},{base:"AA",letters:"\ua732"},{base:"AE",letters:"\xc6\u01fc\u01e2"},{base:"AO",letters:"\ua734"},{base:"AU",letters:"\ua736"},{base:"AV",letters:"\ua738\ua73a"},{base:"AY",letters:"\ua73c"},{base:"B",letters:"B\u24b7\uff22\u1e02\u1e04\u1e06\u0243\u0182\u0181"},{base:"C",letters:"C\u24b8\uff23\u0106\u0108\u010a\u010c\xc7\u1e08\u0187\u023b\ua73e"},{base:"D",letters:"D\u24b9\uff24\u1e0a\u010e\u1e0c\u1e10\u1e12\u1e0e\u0110\u018b\u018a\u0189\ua779"},{base:"DZ",letters:"\u01f1\u01c4"},{base:"Dz",letters:"\u01f2\u01c5"},{base:"E",letters:"E\u24ba\uff25\xc8\xc9\xca\u1ec0\u1ebe\u1ec4\u1ec2\u1ebc\u0112\u1e14\u1e16\u0114\u0116\xcb\u1eba\u011a\u0204\u0206\u1eb8\u1ec6\u0228\u1e1c\u0118\u1e18\u1e1a\u0190\u018e"},{base:"F",letters:"F\u24bb\uff26\u1e1e\u0191\ua77b"},{base:"G",letters:"G\u24bc\uff27\u01f4\u011c\u1e20\u011e\u0120\u01e6\u0122\u01e4\u0193\ua7a0\ua77d\ua77e"},{base:"H",letters:"H\u24bd\uff28\u0124\u1e22\u1e26\u021e\u1e24\u1e28\u1e2a\u0126\u2c67\u2c75\ua78d"},{base:"I",letters:"I\u24be\uff29\xcc\xcd\xce\u0128\u012a\u012c\u0130\xcf\u1e2e\u1ec8\u01cf\u0208\u020a\u1eca\u012e\u1e2c\u0197"},{base:"J",letters:"J\u24bf\uff2a\u0134\u0248"},{base:"K",letters:"K\u24c0\uff2b\u1e30\u01e8\u1e32\u0136\u1e34\u0198\u2c69\ua740\ua742\ua744\ua7a2"},{base:"L",letters:"L\u24c1\uff2c\u013f\u0139\u013d\u1e36\u1e38\u013b\u1e3c\u1e3a\u0141\u023d\u2c62\u2c60\ua748\ua746\ua780"},{base:"LJ",letters:"\u01c7"},{base:"Lj",letters:"\u01c8"},{base:"M",letters:"M\u24c2\uff2d\u1e3e\u1e40\u1e42\u2c6e\u019c"},{base:"N",letters:"N\u24c3\uff2e\u01f8\u0143\xd1\u1e44\u0147\u1e46\u0145\u1e4a\u1e48\u0220\u019d\ua790\ua7a4"},{base:"NJ",letters:"\u01ca"},{base:"Nj",letters:"\u01cb"},{base:"O",letters:"O\u24c4\uff2f\xd2\xd3\xd4\u1ed2\u1ed0\u1ed6\u1ed4\xd5\u1e4c\u022c\u1e4e\u014c\u1e50\u1e52\u014e\u022e\u0230\xd6\u022a\u1ece\u0150\u01d1\u020c\u020e\u01a0\u1edc\u1eda\u1ee0\u1ede\u1ee2\u1ecc\u1ed8\u01ea\u01ec\xd8\u01fe\u0186\u019f\ua74a\ua74c"},{base:"OI",letters:"\u01a2"},{base:"OO",letters:"\ua74e"},{base:"OU",letters:"\u0222"},{base:"P",letters:"P\u24c5\uff30\u1e54\u1e56\u01a4\u2c63\ua750\ua752\ua754"},{base:"Q",letters:"Q\u24c6\uff31\ua756\ua758\u024a"},{base:"R",letters:"R\u24c7\uff32\u0154\u1e58\u0158\u0210\u0212\u1e5a\u1e5c\u0156\u1e5e\u024c\u2c64\ua75a\ua7a6\ua782"},{base:"S",letters:"S\u24c8\uff33\u1e9e\u015a\u1e64\u015c\u1e60\u0160\u1e66\u1e62\u1e68\u0218\u015e\u2c7e\ua7a8\ua784"},{base:"T",letters:"T\u24c9\uff34\u1e6a\u0164\u1e6c\u021a\u0162\u1e70\u1e6e\u0166\u01ac\u01ae\u023e\ua786"},{base:"TZ",letters:"\ua728"},{base:"U",letters:"U\u24ca\uff35\xd9\xda\xdb\u0168\u1e78\u016a\u1e7a\u016c\xdc\u01db\u01d7\u01d5\u01d9\u1ee6\u016e\u0170\u01d3\u0214\u0216\u01af\u1eea\u1ee8\u1eee\u1eec\u1ef0\u1ee4\u1e72\u0172\u1e76\u1e74\u0244"},{base:"V",letters:"V\u24cb\uff36\u1e7c\u1e7e\u01b2\ua75e\u0245"},{base:"VY",letters:"\ua760"},{base:"W",letters:"W\u24cc\uff37\u1e80\u1e82\u0174\u1e86\u1e84\u1e88\u2c72"},{base:"X",letters:"X\u24cd\uff38\u1e8a\u1e8c"},{base:"Y",letters:"Y\u24ce\uff39\u1ef2\xdd\u0176\u1ef8\u0232\u1e8e\u0178\u1ef6\u1ef4\u01b3\u024e\u1efe"},{base:"Z",letters:"Z\u24cf\uff3a\u0179\u1e90\u017b\u017d\u1e92\u1e94\u01b5\u0224\u2c7f\u2c6b\ua762"},{base:"a",letters:"a\u24d0\uff41\u1e9a\xe0\xe1\xe2\u1ea7\u1ea5\u1eab\u1ea9\xe3\u0101\u0103\u1eb1\u1eaf\u1eb5\u1eb3\u0227\u01e1\xe4\u01df\u1ea3\xe5\u01fb\u01ce\u0201\u0203\u1ea1\u1ead\u1eb7\u1e01\u0105\u2c65\u0250"},{base:"aa",letters:"\ua733"},{base:"ae",letters:"\xe6\u01fd\u01e3"},{base:"ao",letters:"\ua735"},{base:"au",letters:"\ua737"},{base:"av",letters:"\ua739\ua73b"},{base:"ay",letters:"\ua73d"},{base:"b",letters:"b\u24d1\uff42\u1e03\u1e05\u1e07\u0180\u0183\u0253"},{base:"c",letters:"c\u24d2\uff43\u0107\u0109\u010b\u010d\xe7\u1e09\u0188\u023c\ua73f\u2184"},{base:"d",letters:"d\u24d3\uff44\u1e0b\u010f\u1e0d\u1e11\u1e13\u1e0f\u0111\u018c\u0256\u0257\ua77a"},{base:"dz",letters:"\u01f3\u01c6"},{base:"e",letters:"e\u24d4\uff45\xe8\xe9\xea\u1ec1\u1ebf\u1ec5\u1ec3\u1ebd\u0113\u1e15\u1e17\u0115\u0117\xeb\u1ebb\u011b\u0205\u0207\u1eb9\u1ec7\u0229\u1e1d\u0119\u1e19\u1e1b\u0247\u025b\u01dd"},{base:"f",letters:"f\u24d5\uff46\u1e1f\u0192\ua77c"},{base:"g",letters:"g\u24d6\uff47\u01f5\u011d\u1e21\u011f\u0121\u01e7\u0123\u01e5\u0260\ua7a1\u1d79\ua77f"},{base:"h",letters:"h\u24d7\uff48\u0125\u1e23\u1e27\u021f\u1e25\u1e29\u1e2b\u1e96\u0127\u2c68\u2c76\u0265"},{base:"hv",letters:"\u0195"},{base:"i",letters:"i\u24d8\uff49\xec\xed\xee\u0129\u012b\u012d\xef\u1e2f\u1ec9\u01d0\u0209\u020b\u1ecb\u012f\u1e2d\u0268\u0131"},{base:"j",letters:"j\u24d9\uff4a\u0135\u01f0\u0249"},{base:"k",letters:"k\u24da\uff4b\u1e31\u01e9\u1e33\u0137\u1e35\u0199\u2c6a\ua741\ua743\ua745\ua7a3"},{base:"l",letters:"l\u24db\uff4c\u0140\u013a\u013e\u1e37\u1e39\u013c\u1e3d\u1e3b\u017f\u0142\u019a\u026b\u2c61\ua749\ua781\ua747"},{base:"lj",letters:"\u01c9"},{base:"m",letters:"m\u24dc\uff4d\u1e3f\u1e41\u1e43\u0271\u026f"},{base:"n",letters:"n\u24dd\uff4e\u01f9\u0144\xf1\u1e45\u0148\u1e47\u0146\u1e4b\u1e49\u019e\u0272\u0149\ua791\ua7a5"},{base:"nj",letters:"\u01cc"},{base:"o",letters:"o\u24de\uff4f\xf2\xf3\xf4\u1ed3\u1ed1\u1ed7\u1ed5\xf5\u1e4d\u022d\u1e4f\u014d\u1e51\u1e53\u014f\u022f\u0231\xf6\u022b\u1ecf\u0151\u01d2\u020d\u020f\u01a1\u1edd\u1edb\u1ee1\u1edf\u1ee3\u1ecd\u1ed9\u01eb\u01ed\xf8\u01ff\u0254\ua74b\ua74d\u0275"},{base:"oi",letters:"\u01a3"},{base:"ou",letters:"\u0223"},{base:"oo",letters:"\ua74f"},{base:"p",letters:"p\u24df\uff50\u1e55\u1e57\u01a5\u1d7d\ua751\ua753\ua755"},{base:"q",letters:"q\u24e0\uff51\u024b\ua757\ua759"},{base:"r",letters:"r\u24e1\uff52\u0155\u1e59\u0159\u0211\u0213\u1e5b\u1e5d\u0157\u1e5f\u024d\u027d\ua75b\ua7a7\ua783"},{base:"s",letters:"s\u24e2\uff53\xdf\u015b\u1e65\u015d\u1e61\u0161\u1e67\u1e63\u1e69\u0219\u015f\u023f\ua7a9\ua785\u1e9b"},{base:"t",letters:"t\u24e3\uff54\u1e6b\u1e97\u0165\u1e6d\u021b\u0163\u1e71\u1e6f\u0167\u01ad\u0288\u2c66\ua787"},{base:"tz",letters:"\ua729"},{base:"u",letters:"u\u24e4\uff55\xf9\xfa\xfb\u0169\u1e79\u016b\u1e7b\u016d\xfc\u01dc\u01d8\u01d6\u01da\u1ee7\u016f\u0171\u01d4\u0215\u0217\u01b0\u1eeb\u1ee9\u1eef\u1eed\u1ef1\u1ee5\u1e73\u0173\u1e77\u1e75\u0289"},{base:"v",letters:"v\u24e5\uff56\u1e7d\u1e7f\u028b\ua75f\u028c"},{base:"vy",letters:"\ua761"},{base:"w",letters:"w\u24e6\uff57\u1e81\u1e83\u0175\u1e87\u1e85\u1e98\u1e89\u2c73"},{base:"x",letters:"x\u24e7\uff58\u1e8b\u1e8d"},{base:"y",letters:"y\u24e8\uff59\u1ef3\xfd\u0177\u1ef9\u0233\u1e8f\xff\u1ef7\u1e99\u1ef5\u01b4\u024f\u1eff"},{base:"z",letters:"z\u24e9\uff5a\u017a\u1e91\u017c\u017e\u1e93\u1e95\u01b6\u0225\u0240\u2c6c\ua763"}],_x=new RegExp("["+Cx.map((function(e){return e.letters})).join("")+"]","g"),Sx={},Ex=0;Ex<Cx.length;Ex++)for(var kx=Cx[Ex],jx=0;jx<kx.letters.length;jx++)Sx[kx.letters[jx]]=kx.base;var Ax=function(e){return e.replace(_x,(function(e){return Sx[e]}))},Rx=function(e,t){void 0===t&&(t=yx);var o=null;function n(){for(var n=[],r=0;r<arguments.length;r++)n[r]=arguments[r];if(o&&o.lastThis===this&&t(n,o.lastArgs))return o.lastResult;var i=e.apply(this,n);return o={lastResult:i,lastArgs:n,lastThis:this},i}return n.clear=function(){o=null},n}(Ax),Ox=function(e){return e.replace(/^\s+|\s+$/g,"")},Tx=function(e){return"".concat(e.label," ").concat(e.value)},Dx=["innerRef"];function Px(e){var t=e.innerRef,o=function(e){for(var t=arguments.length,o=new Array(t>1?t-1:0),n=1;n<t;n++)o[n-1]=arguments[n];return Object.entries(e).filter((function(e){var t=sy(e,1)[0];return!o.includes(t)})).reduce((function(e,t){var o=sy(t,2),n=o[0],r=o[1];return e[n]=r,e}),{})}(ly(e,Dx),"onExited","in","enter","exit","appear");return Hv("input",dy({ref:t},o,{css:Bv({label:"dummyInput",background:0,border:0,caretColor:"transparent",fontSize:"inherit",gridArea:"1 / 1 / 2 / 3",outline:0,padding:0,width:1,color:"transparent",left:-100,opacity:0,position:"relative",transform:"scale(.01)"},"","")}))}var Nx=["boxSizing","height","overflow","paddingRight","position"],Ix={boxSizing:"border-box",overflow:"hidden",position:"relative",height:"100%"};function Mx(e){e.cancelable&&e.preventDefault()}function Lx(e){e.stopPropagation()}function Fx(){var e=this.scrollTop,t=this.scrollHeight,o=e+this.offsetHeight;0===e?this.scrollTop=1:o===t&&(this.scrollTop=e-1)}function Gx(){return"ontouchstart"in window||navigator.maxTouchPoints}var zx=!("undefined"===typeof window||!window.document||!window.document.createElement),Hx=0,Bx={capture:!1,passive:!1};var Vx=function(e){var t=e.target;return t.ownerDocument.activeElement&&t.ownerDocument.activeElement.blur()},$x={name:"1kfdb0e",styles:"position:fixed;left:0;bottom:0;right:0;top:0"};function Ux(e){var o=e.children,n=e.lockEnabled,r=e.captureEnabled,i=function(e){var o=e.isEnabled,n=e.onBottomArrive,r=e.onBottomLeave,i=e.onTopArrive,a=e.onTopLeave,s=(0,t.useRef)(!1),l=(0,t.useRef)(!1),c=(0,t.useRef)(0),d=(0,t.useRef)(null),u=(0,t.useCallback)((function(e,t){if(null!==d.current){var o=d.current,c=o.scrollTop,u=o.scrollHeight,p=o.clientHeight,h=d.current,f=t>0,g=u-p-c,m=!1;g>t&&s.current&&(r&&r(e),s.current=!1),f&&l.current&&(a&&a(e),l.current=!1),f&&t>g?(n&&!s.current&&n(e),h.scrollTop=u,m=!0,s.current=!0):!f&&-t>c&&(i&&!l.current&&i(e),h.scrollTop=0,m=!0,l.current=!0),m&&function(e){e.cancelable&&e.preventDefault(),e.stopPropagation()}(e)}}),[n,r,i,a]),p=(0,t.useCallback)((function(e){u(e,e.deltaY)}),[u]),h=(0,t.useCallback)((function(e){c.current=e.changedTouches[0].clientY}),[]),f=(0,t.useCallback)((function(e){var t=c.current-e.changedTouches[0].clientY;u(e,t)}),[u]),g=(0,t.useCallback)((function(e){if(e){var t=!!Mb&&{passive:!1};e.addEventListener("wheel",p,t),e.addEventListener("touchstart",h,t),e.addEventListener("touchmove",f,t)}}),[f,h,p]),m=(0,t.useCallback)((function(e){e&&(e.removeEventListener("wheel",p,!1),e.removeEventListener("touchstart",h,!1),e.removeEventListener("touchmove",f,!1))}),[f,h,p]);return(0,t.useEffect)((function(){if(o){var e=d.current;return g(e),function(){m(e)}}}),[o,g,m]),function(e){d.current=e}}({isEnabled:void 0===r||r,onBottomArrive:e.onBottomArrive,onBottomLeave:e.onBottomLeave,onTopArrive:e.onTopArrive,onTopLeave:e.onTopLeave}),a=function(e){var o=e.isEnabled,n=e.accountForScrollbars,r=void 0===n||n,i=(0,t.useRef)({}),a=(0,t.useRef)(null),s=(0,t.useCallback)((function(e){if(zx){var t=document.body,o=t&&t.style;if(r&&Nx.forEach((function(e){var t=o&&o[e];i.current[e]=t})),r&&Hx<1){var n=parseInt(i.current.paddingRight,10)||0,a=document.body?document.body.clientWidth:0,s=window.innerWidth-a+n||0;Object.keys(Ix).forEach((function(e){var t=Ix[e];o&&(o[e]=t)})),o&&(o.paddingRight="".concat(s,"px"))}t&&Gx()&&(t.addEventListener("touchmove",Mx,Bx),e&&(e.addEventListener("touchstart",Fx,Bx),e.addEventListener("touchmove",Lx,Bx))),Hx+=1}}),[r]),l=(0,t.useCallback)((function(e){if(zx){var t=document.body,o=t&&t.style;Hx=Math.max(Hx-1,0),r&&Hx<1&&Nx.forEach((function(e){var t=i.current[e];o&&(o[e]=t)})),t&&Gx()&&(t.removeEventListener("touchmove",Mx,Bx),e&&(e.removeEventListener("touchstart",Fx,Bx),e.removeEventListener("touchmove",Lx,Bx)))}}),[r]);return(0,t.useEffect)((function(){if(o){var e=a.current;return s(e),function(){l(e)}}}),[o,s,l]),function(e){a.current=e}}({isEnabled:n});return Hv(t.Fragment,null,n&&Hv("div",{onClick:Vx,css:$x}),o((function(e){i(e),a(e)})))}var Wx={name:"1a0ro4n-requiredInput",styles:"label:requiredInput;opacity:0;pointer-events:none;position:absolute;bottom:0;left:0;right:0;width:100%"},qx=function(e){var t=e.name,o=e.onFocus;return Hv("input",{required:!0,name:t,tabIndex:-1,"aria-hidden":"true",onFocus:o,css:Wx,value:"",onChange:function(){}})};function Kx(e){var t;return"undefined"!==typeof window&&null!=window.navigator&&e.test((null===(t=window.navigator.userAgentData)||void 0===t?void 0:t.platform)||window.navigator.platform)}function Yx(){return Kx(/^Mac/i)}function Jx(){return Kx(/^iPhone/i)||Kx(/^iPad/i)||Yx()&&navigator.maxTouchPoints>1}var Xx={clearIndicator:rx,container:function(e){var t=e.isDisabled;return{label:"container",direction:e.isRtl?"rtl":void 0,pointerEvents:t?"none":void 0,position:"relative"}},control:function(e,t){var o=e.isDisabled,n=e.isFocused,r=e.theme,i=r.colors,a=r.borderRadius;return ry({label:"control",alignItems:"center",cursor:"default",display:"flex",flexWrap:"wrap",justifyContent:"space-between",minHeight:r.spacing.controlHeight,outline:"0 !important",position:"relative",transition:"all 100ms"},t?{}:{backgroundColor:o?i.neutral5:i.neutral0,borderColor:o?i.neutral10:n?i.primary:i.neutral20,borderRadius:a,borderStyle:"solid",borderWidth:1,boxShadow:n?"0 0 0 1px ".concat(i.primary):void 0,"&:hover":{borderColor:n?i.primary:i.neutral30}})},dropdownIndicator:nx,group:function(e,t){var o=e.theme.spacing;return t?{}:{paddingBottom:2*o.baseUnit,paddingTop:2*o.baseUnit}},groupHeading:function(e,t){var o=e.theme,n=o.colors,r=o.spacing;return ry({label:"group",cursor:"default",display:"block"},t?{}:{color:n.neutral40,fontSize:"75%",fontWeight:500,marginBottom:"0.25em",paddingLeft:3*r.baseUnit,paddingRight:3*r.baseUnit,textTransform:"uppercase"})},indicatorsContainer:function(){return{alignItems:"center",alignSelf:"stretch",display:"flex",flexShrink:0}},indicatorSeparator:function(e,t){var o=e.isDisabled,n=e.theme,r=n.spacing.baseUnit,i=n.colors;return ry({label:"indicatorSeparator",alignSelf:"stretch",width:1},t?{}:{backgroundColor:o?i.neutral10:i.neutral20,marginBottom:2*r,marginTop:2*r})},input:function(e,t){var o=e.isDisabled,n=e.value,r=e.theme,i=r.spacing,a=r.colors;return ry(ry({visibility:o?"hidden":"visible",transform:n?"translateZ(0)":""},px),t?{}:{margin:i.baseUnit/2,paddingBottom:i.baseUnit/2,paddingTop:i.baseUnit/2,color:a.neutral80})},loadingIndicator:function(e,t){var o=e.isFocused,n=e.size,r=e.theme,i=r.colors,a=r.spacing.baseUnit;return ry({label:"loadingIndicator",display:"flex",transition:"color 150ms",alignSelf:"center",fontSize:n,lineHeight:1,marginRight:n,textAlign:"center",verticalAlign:"middle"},t?{}:{color:o?i.neutral60:i.neutral20,padding:2*a})},loadingMessage:Yb,menu:function(e,t){var o,n=e.placement,r=e.theme,i=r.borderRadius,a=r.spacing,s=r.colors;return ry((oy(o={label:"menu"},function(e){return e?{bottom:"top",top:"bottom"}[e]:"bottom"}(n),"100%"),oy(o,"position","absolute"),oy(o,"width","100%"),oy(o,"zIndex",1),o),t?{}:{backgroundColor:s.neutral0,borderRadius:i,boxShadow:"0 0 0 1px hsla(0, 0%, 0%, 0.1), 0 4px 11px hsla(0, 0%, 0%, 0.1)",marginBottom:a.menuGutter,marginTop:a.menuGutter})},menuList:function(e,t){var o=e.maxHeight,n=e.theme.spacing.baseUnit;return ry({maxHeight:o,overflowY:"auto",position:"relative",WebkitOverflowScrolling:"touch"},t?{}:{paddingBottom:n,paddingTop:n})},menuPortal:function(e){var t=e.rect,o=e.offset,n=e.position;return{left:t.left,position:n,top:o,width:t.width,zIndex:1}},multiValue:function(e,t){var o=e.theme,n=o.spacing,r=o.borderRadius,i=o.colors;return ry({label:"multiValue",display:"flex",minWidth:0},t?{}:{backgroundColor:i.neutral10,borderRadius:r/2,margin:n.baseUnit/2})},multiValueLabel:function(e,t){var o=e.theme,n=o.borderRadius,r=o.colors,i=e.cropWithEllipsis;return ry({overflow:"hidden",textOverflow:i||void 0===i?"ellipsis":void 0,whiteSpace:"nowrap"},t?{}:{borderRadius:n/2,color:r.neutral80,fontSize:"85%",padding:3,paddingLeft:6})},multiValueRemove:function(e,t){var o=e.theme,n=o.spacing,r=o.borderRadius,i=o.colors,a=e.isFocused;return ry({alignItems:"center",display:"flex"},t?{}:{borderRadius:r/2,backgroundColor:a?i.dangerLight:void 0,paddingLeft:n.baseUnit,paddingRight:n.baseUnit,":hover":{backgroundColor:i.dangerLight,color:i.danger}})},noOptionsMessage:Kb,option:function(e,t){var o=e.isDisabled,n=e.isFocused,r=e.isSelected,i=e.theme,a=i.spacing,s=i.colors;return ry({label:"option",cursor:"default",display:"block",fontSize:"inherit",width:"100%",userSelect:"none",WebkitTapHighlightColor:"rgba(0, 0, 0, 0)"},t?{}:{backgroundColor:r?s.primary:n?s.primary25:"transparent",color:o?s.neutral20:r?s.neutral0:"inherit",padding:"".concat(2*a.baseUnit,"px ").concat(3*a.baseUnit,"px"),":active":{backgroundColor:o?void 0:r?s.primary:s.primary50}})},placeholder:function(e,t){var o=e.theme,n=o.spacing,r=o.colors;return ry({label:"placeholder",gridArea:"1 / 1 / 2 / 3"},t?{}:{color:r.neutral50,marginLeft:n.baseUnit/2,marginRight:n.baseUnit/2})},singleValue:function(e,t){var o=e.isDisabled,n=e.theme,r=n.spacing,i=n.colors;return ry({label:"singleValue",gridArea:"1 / 1 / 2 / 3",maxWidth:"100%",overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"},t?{}:{color:o?i.neutral40:i.neutral80,marginLeft:r.baseUnit/2,marginRight:r.baseUnit/2})},valueContainer:function(e,t){var o=e.theme.spacing,n=e.isMulti,r=e.hasValue,i=e.selectProps.controlShouldRenderValue;return ry({alignItems:"center",display:n&&r&&i?"flex":"grid",flex:1,flexWrap:"wrap",WebkitOverflowScrolling:"touch",position:"relative",overflow:"hidden"},t?{}:{padding:"".concat(o.baseUnit/2,"px ").concat(2*o.baseUnit,"px")})}};var Qx,Zx={borderRadius:4,colors:{primary:"#2684FF",primary75:"#4C9AFF",primary50:"#B2D4FF",primary25:"#DEEBFF",danger:"#DE350B",dangerLight:"#FFBDAD",neutral0:"hsl(0, 0%, 100%)",neutral5:"hsl(0, 0%, 95%)",neutral10:"hsl(0, 0%, 90%)",neutral20:"hsl(0, 0%, 80%)",neutral30:"hsl(0, 0%, 70%)",neutral40:"hsl(0, 0%, 60%)",neutral50:"hsl(0, 0%, 50%)",neutral60:"hsl(0, 0%, 40%)",neutral70:"hsl(0, 0%, 30%)",neutral80:"hsl(0, 0%, 20%)",neutral90:"hsl(0, 0%, 10%)"},spacing:{baseUnit:4,controlHeight:38,menuGutter:8}},ew={"aria-live":"polite",backspaceRemovesValue:!0,blurInputOnSelect:Db(),captureMenuScroll:!Db(),classNames:{},closeMenuOnSelect:!0,closeMenuOnScroll:!1,components:{},controlShouldRenderValue:!0,escapeClearsValue:!1,filterOption:function(e,t){if(e.data.__isNew__)return!0;var o=ry({ignoreCase:!0,ignoreAccents:!0,stringify:Tx,trim:!0,matchFrom:"any"},Qx),n=o.ignoreCase,r=o.ignoreAccents,i=o.stringify,a=o.trim,s=o.matchFrom,l=a?Ox(t):t,c=a?Ox(i(e)):i(e);return n&&(l=l.toLowerCase(),c=c.toLowerCase()),r&&(l=Rx(l),c=Ax(c)),"start"===s?c.substr(0,l.length)===l:c.indexOf(l)>-1},formatGroupLabel:function(e){return e.label},getOptionLabel:function(e){return e.label},getOptionValue:function(e){return e.value},isDisabled:!1,isLoading:!1,isMulti:!1,isRtl:!1,isSearchable:!0,isOptionDisabled:function(e){return!!e.isDisabled},loadingMessage:function(){return"Loading..."},maxMenuHeight:300,minMenuHeight:140,menuIsOpen:!1,menuPlacement:"bottom",menuPosition:"absolute",menuShouldBlockScroll:!1,menuShouldScrollIntoView:!function(){try{return/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent)}catch(SM){return!1}}(),noOptionsMessage:function(){return"No options"},openMenuOnFocus:!1,openMenuOnClick:!0,options:[],pageSize:5,placeholder:"Select...",screenReaderStatus:function(e){var t=e.count;return"".concat(t," result").concat(1!==t?"s":""," available")},styles:{},tabIndex:0,tabSelectsValue:!0,unstyled:!1};function tw(e,t,o,n){return{type:"option",data:t,isDisabled:cw(e,t,o),isSelected:dw(e,t,o),label:sw(e,t),value:lw(e,t),index:n}}function ow(e,t){return e.options.map((function(o,n){if("options"in o){var r=o.options.map((function(o,n){return tw(e,o,t,n)})).filter((function(t){return iw(e,t)}));return r.length>0?{type:"group",data:o,options:r,index:n}:void 0}var i=tw(e,o,t,n);return iw(e,i)?i:void 0})).filter(Lb)}function nw(e){return e.reduce((function(e,t){return"group"===t.type?e.push.apply(e,my(t.options.map((function(e){return e.data})))):e.push(t.data),e}),[])}function rw(e,t){return e.reduce((function(e,o){return"group"===o.type?e.push.apply(e,my(o.options.map((function(e){return{data:e.data,id:"".concat(t,"-").concat(o.index,"-").concat(e.index)}})))):e.push({data:o.data,id:"".concat(t,"-").concat(o.index)}),e}),[])}function iw(e,t){var o=e.inputValue,n=void 0===o?"":o,r=t.data,i=t.isSelected,a=t.label,s=t.value;return(!pw(e)||!i)&&uw(e,{label:a,value:s,data:r},n)}var aw=function(e,t){var o;return(null===(o=e.find((function(e){return e.data===t})))||void 0===o?void 0:o.id)||null},sw=function(e,t){return e.getOptionLabel(t)},lw=function(e,t){return e.getOptionValue(t)};function cw(e,t,o){return"function"===typeof e.isOptionDisabled&&e.isOptionDisabled(t,o)}function dw(e,t,o){if(o.indexOf(t)>-1)return!0;if("function"===typeof e.isOptionSelected)return e.isOptionSelected(t,o);var n=lw(e,t);return o.some((function(t){return lw(e,t)===n}))}function uw(e,t,o){return!e.filterOption||e.filterOption(t,o)}var pw=function(e){var t=e.hideSelectedOptions,o=e.isMulti;return void 0===t?o:t},hw=1,fw=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&py(e,t)}(n,e);var o=function(e){var t=fy();return function(){var o,n=hy(e);if(t){var r=hy(this).constructor;o=Reflect.construct(n,arguments,r)}else o=n.apply(this,arguments);return gy(this,o)}}(n);function n(e){var t;if(function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,n),(t=o.call(this,e)).state={ariaSelection:null,focusedOption:null,focusedOptionId:null,focusableOptionsWithIds:[],focusedValue:null,inputIsHidden:!1,isFocused:!1,selectValue:[],clearFocusValueOnUpdate:!1,prevWasFocused:!1,inputIsHiddenAfterUpdate:void 0,prevProps:void 0,instancePrefix:""},t.blockOptionHover=!1,t.isComposing=!1,t.commonProps=void 0,t.initialTouchX=0,t.initialTouchY=0,t.openAfterFocus=!1,t.scrollToFocusedOptionOnUpdate=!1,t.userIsDragging=void 0,t.isAppleDevice=Yx()||Jx(),t.controlRef=null,t.getControlRef=function(e){t.controlRef=e},t.focusedOptionRef=null,t.getFocusedOptionRef=function(e){t.focusedOptionRef=e},t.menuListRef=null,t.getMenuListRef=function(e){t.menuListRef=e},t.inputRef=null,t.getInputRef=function(e){t.inputRef=e},t.focus=t.focusInput,t.blur=t.blurInput,t.onChange=function(e,o){var n=t.props,r=n.onChange,i=n.name;o.name=i,t.ariaOnChange(e,o),r(e,o)},t.setValue=function(e,o,n){var r=t.props,i=r.closeMenuOnSelect,a=r.isMulti,s=r.inputValue;t.onInputChange("",{action:"set-value",prevInputValue:s}),i&&(t.setState({inputIsHiddenAfterUpdate:!a}),t.onMenuClose()),t.setState({clearFocusValueOnUpdate:!0}),t.onChange(e,{action:o,option:n})},t.selectOption=function(e){var o=t.props,n=o.blurInputOnSelect,r=o.isMulti,i=o.name,a=t.state.selectValue,s=r&&t.isOptionSelected(e,a),l=t.isOptionDisabled(e,a);if(s){var c=t.getOptionValue(e);t.setValue(a.filter((function(e){return t.getOptionValue(e)!==c})),"deselect-option",e)}else{if(l)return void t.ariaOnChange(e,{action:"select-option",option:e,name:i});r?t.setValue([].concat(my(a),[e]),"select-option",e):t.setValue(e,"select-option")}n&&t.blurInput()},t.removeValue=function(e){var o=t.props.isMulti,n=t.state.selectValue,r=t.getOptionValue(e),i=n.filter((function(e){return t.getOptionValue(e)!==r})),a=Fb(o,i,i[0]||null);t.onChange(a,{action:"remove-value",removedValue:e}),t.focusInput()},t.clearValue=function(){var e=t.state.selectValue;t.onChange(Fb(t.props.isMulti,[],null),{action:"clear",removedValues:e})},t.popValue=function(){var e=t.props.isMulti,o=t.state.selectValue,n=o[o.length-1],r=o.slice(0,o.length-1),i=Fb(e,r,r[0]||null);n&&t.onChange(i,{action:"pop-value",removedValue:n})},t.getFocusedOptionId=function(e){return aw(t.state.focusableOptionsWithIds,e)},t.getFocusableOptionsWithIds=function(){return rw(ow(t.props,t.state.selectValue),t.getElementId("option"))},t.getValue=function(){return t.state.selectValue},t.cx=function(){for(var e=arguments.length,o=new Array(e),n=0;n<e;n++)o[n]=arguments[n];return _b.apply(void 0,[t.props.classNamePrefix].concat(o))},t.getOptionLabel=function(e){return sw(t.props,e)},t.getOptionValue=function(e){return lw(t.props,e)},t.getStyles=function(e,o){var n=t.props.unstyled,r=Xx[e](o,n);r.boxSizing="border-box";var i=t.props.styles[e];return i?i(r,o):r},t.getClassNames=function(e,o){var n,r;return null===(n=(r=t.props.classNames)[e])||void 0===n?void 0:n.call(r,o)},t.getElementId=function(e){return"".concat(t.state.instancePrefix,"-").concat(e)},t.getComponents=function(){return e=t.props,ry(ry({},gx),e.components);var e},t.buildCategorizedOptions=function(){return ow(t.props,t.state.selectValue)},t.getCategorizedOptions=function(){return t.props.menuIsOpen?t.buildCategorizedOptions():[]},t.buildFocusableOptions=function(){return nw(t.buildCategorizedOptions())},t.getFocusableOptions=function(){return t.props.menuIsOpen?t.buildFocusableOptions():[]},t.ariaOnChange=function(e,o){t.setState({ariaSelection:ry({value:e},o)})},t.onMenuMouseDown=function(e){0===e.button&&(e.stopPropagation(),e.preventDefault(),t.focusInput())},t.onMenuMouseMove=function(e){t.blockOptionHover=!1},t.onControlMouseDown=function(e){if(!e.defaultPrevented){var o=t.props.openMenuOnClick;t.state.isFocused?t.props.menuIsOpen?"INPUT"!==e.target.tagName&&"TEXTAREA"!==e.target.tagName&&t.onMenuClose():o&&t.openMenu("first"):(o&&(t.openAfterFocus=!0),t.focusInput()),"INPUT"!==e.target.tagName&&"TEXTAREA"!==e.target.tagName&&e.preventDefault()}},t.onDropdownIndicatorMouseDown=function(e){if((!e||"mousedown"!==e.type||0===e.button)&&!t.props.isDisabled){var o=t.props,n=o.isMulti,r=o.menuIsOpen;t.focusInput(),r?(t.setState({inputIsHiddenAfterUpdate:!n}),t.onMenuClose()):t.openMenu("first"),e.preventDefault()}},t.onClearIndicatorMouseDown=function(e){e&&"mousedown"===e.type&&0!==e.button||(t.clearValue(),e.preventDefault(),t.openAfterFocus=!1,"touchend"===e.type?t.focusInput():setTimeout((function(){return t.focusInput()})))},t.onScroll=function(e){"boolean"===typeof t.props.closeMenuOnScroll?e.target instanceof HTMLElement&&jb(e.target)&&t.props.onMenuClose():"function"===typeof t.props.closeMenuOnScroll&&t.props.closeMenuOnScroll(e)&&t.props.onMenuClose()},t.onCompositionStart=function(){t.isComposing=!0},t.onCompositionEnd=function(){t.isComposing=!1},t.onTouchStart=function(e){var o=e.touches,n=o&&o.item(0);n&&(t.initialTouchX=n.clientX,t.initialTouchY=n.clientY,t.userIsDragging=!1)},t.onTouchMove=function(e){var o=e.touches,n=o&&o.item(0);if(n){var r=Math.abs(n.clientX-t.initialTouchX),i=Math.abs(n.clientY-t.initialTouchY);t.userIsDragging=r>5||i>5}},t.onTouchEnd=function(e){t.userIsDragging||(t.controlRef&&!t.controlRef.contains(e.target)&&t.menuListRef&&!t.menuListRef.contains(e.target)&&t.blurInput(),t.initialTouchX=0,t.initialTouchY=0)},t.onControlTouchEnd=function(e){t.userIsDragging||t.onControlMouseDown(e)},t.onClearIndicatorTouchEnd=function(e){t.userIsDragging||t.onClearIndicatorMouseDown(e)},t.onDropdownIndicatorTouchEnd=function(e){t.userIsDragging||t.onDropdownIndicatorMouseDown(e)},t.handleInputChange=function(e){var o=t.props.inputValue,n=e.currentTarget.value;t.setState({inputIsHiddenAfterUpdate:!1}),t.onInputChange(n,{action:"input-change",prevInputValue:o}),t.props.menuIsOpen||t.onMenuOpen()},t.onInputFocus=function(e){t.props.onFocus&&t.props.onFocus(e),t.setState({inputIsHiddenAfterUpdate:!1,isFocused:!0}),(t.openAfterFocus||t.props.openMenuOnFocus)&&t.openMenu("first"),t.openAfterFocus=!1},t.onInputBlur=function(e){var o=t.props.inputValue;t.menuListRef&&t.menuListRef.contains(document.activeElement)?t.inputRef.focus():(t.props.onBlur&&t.props.onBlur(e),t.onInputChange("",{action:"input-blur",prevInputValue:o}),t.onMenuClose(),t.setState({focusedValue:null,isFocused:!1}))},t.onOptionHover=function(e){if(!t.blockOptionHover&&t.state.focusedOption!==e){var o=t.getFocusableOptions().indexOf(e);t.setState({focusedOption:e,focusedOptionId:o>-1?t.getFocusedOptionId(e):null})}},t.shouldHideSelectedOptions=function(){return pw(t.props)},t.onValueInputFocus=function(e){e.preventDefault(),e.stopPropagation(),t.focus()},t.onKeyDown=function(e){var o=t.props,n=o.isMulti,r=o.backspaceRemovesValue,i=o.escapeClearsValue,a=o.inputValue,s=o.isClearable,l=o.isDisabled,c=o.menuIsOpen,d=o.onKeyDown,u=o.tabSelectsValue,p=o.openMenuOnFocus,h=t.state,f=h.focusedOption,g=h.focusedValue,m=h.selectValue;if(!l&&("function"!==typeof d||(d(e),!e.defaultPrevented))){switch(t.blockOptionHover=!0,e.key){case"ArrowLeft":if(!n||a)return;t.focusValue("previous");break;case"ArrowRight":if(!n||a)return;t.focusValue("next");break;case"Delete":case"Backspace":if(a)return;if(g)t.removeValue(g);else{if(!r)return;n?t.popValue():s&&t.clearValue()}break;case"Tab":if(t.isComposing)return;if(e.shiftKey||!c||!u||!f||p&&t.isOptionSelected(f,m))return;t.selectOption(f);break;case"Enter":if(229===e.keyCode)break;if(c){if(!f)return;if(t.isComposing)return;t.selectOption(f);break}return;case"Escape":c?(t.setState({inputIsHiddenAfterUpdate:!1}),t.onInputChange("",{action:"menu-close",prevInputValue:a}),t.onMenuClose()):s&&i&&t.clearValue();break;case" ":if(a)return;if(!c){t.openMenu("first");break}if(!f)return;t.selectOption(f);break;case"ArrowUp":c?t.focusOption("up"):t.openMenu("last");break;case"ArrowDown":c?t.focusOption("down"):t.openMenu("first");break;case"PageUp":if(!c)return;t.focusOption("pageup");break;case"PageDown":if(!c)return;t.focusOption("pagedown");break;case"Home":if(!c)return;t.focusOption("first");break;case"End":if(!c)return;t.focusOption("last");break;default:return}e.preventDefault()}},t.state.instancePrefix="react-select-"+(t.props.instanceId||++hw),t.state.selectValue=Sb(e.value),e.menuIsOpen&&t.state.selectValue.length){var r=t.getFocusableOptionsWithIds(),i=t.buildFocusableOptions(),a=i.indexOf(t.state.selectValue[0]);t.state.focusableOptionsWithIds=r,t.state.focusedOption=i[a],t.state.focusedOptionId=aw(r,i[a])}return t}return function(e,t,o){t&&uy(e.prototype,t),o&&uy(e,o),Object.defineProperty(e,"prototype",{writable:!1})}(n,[{key:"componentDidMount",value:function(){this.startListeningComposition(),this.startListeningToTouch(),this.props.closeMenuOnScroll&&document&&document.addEventListener&&document.addEventListener("scroll",this.onScroll,!0),this.props.autoFocus&&this.focusInput(),this.props.menuIsOpen&&this.state.focusedOption&&this.menuListRef&&this.focusedOptionRef&&Tb(this.menuListRef,this.focusedOptionRef)}},{key:"componentDidUpdate",value:function(e){var t=this.props,o=t.isDisabled,n=t.menuIsOpen,r=this.state.isFocused;(r&&!o&&e.isDisabled||r&&n&&!e.menuIsOpen)&&this.focusInput(),r&&o&&!e.isDisabled?this.setState({isFocused:!1},this.onMenuClose):r||o||!e.isDisabled||this.inputRef!==document.activeElement||this.setState({isFocused:!0}),this.menuListRef&&this.focusedOptionRef&&this.scrollToFocusedOptionOnUpdate&&(Tb(this.menuListRef,this.focusedOptionRef),this.scrollToFocusedOptionOnUpdate=!1)}},{key:"componentWillUnmount",value:function(){this.stopListeningComposition(),this.stopListeningToTouch(),document.removeEventListener("scroll",this.onScroll,!0)}},{key:"onMenuOpen",value:function(){this.props.onMenuOpen()}},{key:"onMenuClose",value:function(){this.onInputChange("",{action:"menu-close",prevInputValue:this.props.inputValue}),this.props.onMenuClose()}},{key:"onInputChange",value:function(e,t){this.props.onInputChange(e,t)}},{key:"focusInput",value:function(){this.inputRef&&this.inputRef.focus()}},{key:"blurInput",value:function(){this.inputRef&&this.inputRef.blur()}},{key:"openMenu",value:function(e){var t=this,o=this.state,n=o.selectValue,r=o.isFocused,i=this.buildFocusableOptions(),a="first"===e?0:i.length-1;if(!this.props.isMulti){var s=i.indexOf(n[0]);s>-1&&(a=s)}this.scrollToFocusedOptionOnUpdate=!(r&&this.menuListRef),this.setState({inputIsHiddenAfterUpdate:!1,focusedValue:null,focusedOption:i[a],focusedOptionId:this.getFocusedOptionId(i[a])},(function(){return t.onMenuOpen()}))}},{key:"focusValue",value:function(e){var t=this.state,o=t.selectValue,n=t.focusedValue;if(this.props.isMulti){this.setState({focusedOption:null});var r=o.indexOf(n);n||(r=-1);var i=o.length-1,a=-1;if(o.length){switch(e){case"previous":a=0===r?0:-1===r?i:r-1;break;case"next":r>-1&&r<i&&(a=r+1)}this.setState({inputIsHidden:-1!==a,focusedValue:o[a]})}}}},{key:"focusOption",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"first",t=this.props.pageSize,o=this.state.focusedOption,n=this.getFocusableOptions();if(n.length){var r=0,i=n.indexOf(o);o||(i=-1),"up"===e?r=i>0?i-1:n.length-1:"down"===e?r=(i+1)%n.length:"pageup"===e?(r=i-t)<0&&(r=0):"pagedown"===e?(r=i+t)>n.length-1&&(r=n.length-1):"last"===e&&(r=n.length-1),this.scrollToFocusedOptionOnUpdate=!0,this.setState({focusedOption:n[r],focusedValue:null,focusedOptionId:this.getFocusedOptionId(n[r])})}}},{key:"getTheme",value:function(){return this.props.theme?"function"===typeof this.props.theme?this.props.theme(Zx):ry(ry({},Zx),this.props.theme):Zx}},{key:"getCommonProps",value:function(){var e=this.clearValue,t=this.cx,o=this.getStyles,n=this.getClassNames,r=this.getValue,i=this.selectOption,a=this.setValue,s=this.props,l=s.isMulti,c=s.isRtl,d=s.options;return{clearValue:e,cx:t,getStyles:o,getClassNames:n,getValue:r,hasValue:this.hasValue(),isMulti:l,isRtl:c,options:d,selectOption:i,selectProps:s,setValue:a,theme:this.getTheme()}}},{key:"hasValue",value:function(){return this.state.selectValue.length>0}},{key:"hasOptions",value:function(){return!!this.getFocusableOptions().length}},{key:"isClearable",value:function(){var e=this.props,t=e.isClearable,o=e.isMulti;return void 0===t?o:t}},{key:"isOptionDisabled",value:function(e,t){return cw(this.props,e,t)}},{key:"isOptionSelected",value:function(e,t){return dw(this.props,e,t)}},{key:"filterOption",value:function(e,t){return uw(this.props,e,t)}},{key:"formatOptionLabel",value:function(e,t){if("function"===typeof this.props.formatOptionLabel){var o=this.props.inputValue,n=this.state.selectValue;return this.props.formatOptionLabel(e,{context:t,inputValue:o,selectValue:n})}return this.getOptionLabel(e)}},{key:"formatGroupLabel",value:function(e){return this.props.formatGroupLabel(e)}},{key:"startListeningComposition",value:function(){document&&document.addEventListener&&(document.addEventListener("compositionstart",this.onCompositionStart,!1),document.addEventListener("compositionend",this.onCompositionEnd,!1))}},{key:"stopListeningComposition",value:function(){document&&document.removeEventListener&&(document.removeEventListener("compositionstart",this.onCompositionStart),document.removeEventListener("compositionend",this.onCompositionEnd))}},{key:"startListeningToTouch",value:function(){document&&document.addEventListener&&(document.addEventListener("touchstart",this.onTouchStart,!1),document.addEventListener("touchmove",this.onTouchMove,!1),document.addEventListener("touchend",this.onTouchEnd,!1))}},{key:"stopListeningToTouch",value:function(){document&&document.removeEventListener&&(document.removeEventListener("touchstart",this.onTouchStart),document.removeEventListener("touchmove",this.onTouchMove),document.removeEventListener("touchend",this.onTouchEnd))}},{key:"renderInput",value:function(){var e=this.props,o=e.isDisabled,n=e.isSearchable,r=e.inputId,i=e.inputValue,a=e.tabIndex,s=e.form,l=e.menuIsOpen,c=e.required,d=this.getComponents().Input,u=this.state,p=u.inputIsHidden,h=u.ariaSelection,f=this.commonProps,g=r||this.getElementId("input"),m=ry(ry(ry({"aria-autocomplete":"list","aria-expanded":l,"aria-haspopup":!0,"aria-errormessage":this.props["aria-errormessage"],"aria-invalid":this.props["aria-invalid"],"aria-label":this.props["aria-label"],"aria-labelledby":this.props["aria-labelledby"],"aria-required":c,role:"combobox","aria-activedescendant":this.isAppleDevice?void 0:this.state.focusedOptionId||""},l&&{"aria-controls":this.getElementId("listbox")}),!n&&{"aria-readonly":!0}),this.hasValue()?"initial-input-focus"===(null===h||void 0===h?void 0:h.action)&&{"aria-describedby":this.getElementId("live-region")}:{"aria-describedby":this.getElementId("placeholder")});return n?t.createElement(d,dy({},f,{autoCapitalize:"none",autoComplete:"off",autoCorrect:"off",id:g,innerRef:this.getInputRef,isDisabled:o,isHidden:p,onBlur:this.onInputBlur,onChange:this.handleInputChange,onFocus:this.onInputFocus,spellCheck:"false",tabIndex:a,form:s,type:"text",value:i},m)):t.createElement(Px,dy({id:g,innerRef:this.getInputRef,onBlur:this.onInputBlur,onChange:wb,onFocus:this.onInputFocus,disabled:o,tabIndex:a,inputMode:"none",form:s,value:""},m))}},{key:"renderPlaceholderOrValue",value:function(){var e=this,o=this.getComponents(),n=o.MultiValue,r=o.MultiValueContainer,i=o.MultiValueLabel,a=o.MultiValueRemove,s=o.SingleValue,l=o.Placeholder,c=this.commonProps,d=this.props,u=d.controlShouldRenderValue,p=d.isDisabled,h=d.isMulti,f=d.inputValue,g=d.placeholder,m=this.state,y=m.selectValue,v=m.focusedValue,b=m.isFocused;if(!this.hasValue()||!u)return f?null:t.createElement(l,dy({},c,{key:"placeholder",isDisabled:p,isFocused:b,innerProps:{id:this.getElementId("placeholder")}}),g);if(h)return y.map((function(o,s){var l=o===v,d="".concat(e.getOptionLabel(o),"-").concat(e.getOptionValue(o));return t.createElement(n,dy({},c,{components:{Container:r,Label:i,Remove:a},isFocused:l,isDisabled:p,key:d,index:s,removeProps:{onClick:function(){return e.removeValue(o)},onTouchEnd:function(){return e.removeValue(o)},onMouseDown:function(e){e.preventDefault()}},data:o}),e.formatOptionLabel(o,"value"))}));if(f)return null;var x=y[0];return t.createElement(s,dy({},c,{data:x,isDisabled:p}),this.formatOptionLabel(x,"value"))}},{key:"renderClearIndicator",value:function(){var e=this.getComponents().ClearIndicator,o=this.commonProps,n=this.props,r=n.isDisabled,i=n.isLoading,a=this.state.isFocused;if(!this.isClearable()||!e||r||!this.hasValue()||i)return null;var s={onMouseDown:this.onClearIndicatorMouseDown,onTouchEnd:this.onClearIndicatorTouchEnd,"aria-hidden":"true"};return t.createElement(e,dy({},o,{innerProps:s,isFocused:a}))}},{key:"renderLoadingIndicator",value:function(){var e=this.getComponents().LoadingIndicator,o=this.commonProps,n=this.props,r=n.isDisabled,i=n.isLoading,a=this.state.isFocused;if(!e||!i)return null;return t.createElement(e,dy({},o,{innerProps:{"aria-hidden":"true"},isDisabled:r,isFocused:a}))}},{key:"renderIndicatorSeparator",value:function(){var e=this.getComponents(),o=e.DropdownIndicator,n=e.IndicatorSeparator;if(!o||!n)return null;var r=this.commonProps,i=this.props.isDisabled,a=this.state.isFocused;return t.createElement(n,dy({},r,{isDisabled:i,isFocused:a}))}},{key:"renderDropdownIndicator",value:function(){var e=this.getComponents().DropdownIndicator;if(!e)return null;var o=this.commonProps,n=this.props.isDisabled,r=this.state.isFocused,i={onMouseDown:this.onDropdownIndicatorMouseDown,onTouchEnd:this.onDropdownIndicatorTouchEnd,"aria-hidden":"true"};return t.createElement(e,dy({},o,{innerProps:i,isDisabled:n,isFocused:r}))}},{key:"renderMenu",value:function(){var e=this,o=this.getComponents(),n=o.Group,r=o.GroupHeading,i=o.Menu,a=o.MenuList,s=o.MenuPortal,l=o.LoadingMessage,c=o.NoOptionsMessage,d=o.Option,u=this.commonProps,p=this.state.focusedOption,h=this.props,f=h.captureMenuScroll,g=h.inputValue,m=h.isLoading,y=h.loadingMessage,v=h.minMenuHeight,b=h.maxMenuHeight,x=h.menuIsOpen,w=h.menuPlacement,C=h.menuPosition,_=h.menuPortalTarget,S=h.menuShouldBlockScroll,E=h.menuShouldScrollIntoView,k=h.noOptionsMessage,j=h.onMenuScrollToTop,A=h.onMenuScrollToBottom;if(!x)return null;var R,O=function(o,n){var r=o.type,i=o.data,a=o.isDisabled,s=o.isSelected,l=o.label,c=o.value,h=p===i,f=a?void 0:function(){return e.onOptionHover(i)},g=a?void 0:function(){return e.selectOption(i)},m="".concat(e.getElementId("option"),"-").concat(n),y={id:m,onClick:g,onMouseMove:f,onMouseOver:f,tabIndex:-1,role:"option","aria-selected":e.isAppleDevice?void 0:s};return t.createElement(d,dy({},u,{innerProps:y,data:i,isDisabled:a,isSelected:s,key:m,label:l,type:r,value:c,isFocused:h,innerRef:h?e.getFocusedOptionRef:void 0}),e.formatOptionLabel(o.data,"menu"))};if(this.hasOptions())R=this.getCategorizedOptions().map((function(o){if("group"===o.type){var i=o.data,a=o.options,s=o.index,l="".concat(e.getElementId("group"),"-").concat(s),c="".concat(l,"-heading");return t.createElement(n,dy({},u,{key:l,data:i,options:a,Heading:r,headingProps:{id:c,data:o.data},label:e.formatGroupLabel(o.data)}),o.options.map((function(e){return O(e,"".concat(s,"-").concat(e.index))})))}if("option"===o.type)return O(o,"".concat(o.index))}));else if(m){var T=y({inputValue:g});if(null===T)return null;R=t.createElement(l,u,T)}else{var D=k({inputValue:g});if(null===D)return null;R=t.createElement(c,u,D)}var P={minMenuHeight:v,maxMenuHeight:b,menuPlacement:w,menuPosition:C,menuShouldScrollIntoView:E},N=t.createElement(Ub,dy({},u,P),(function(o){var n=o.ref,r=o.placerProps,s=r.placement,l=r.maxHeight;return t.createElement(i,dy({},u,P,{innerRef:n,innerProps:{onMouseDown:e.onMenuMouseDown,onMouseMove:e.onMenuMouseMove},isLoading:m,placement:s}),t.createElement(Ux,{captureEnabled:f,onTopArrive:j,onBottomArrive:A,lockEnabled:S},(function(o){return t.createElement(a,dy({},u,{innerRef:function(t){e.getMenuListRef(t),o(t)},innerProps:{role:"listbox","aria-multiselectable":u.isMulti,id:e.getElementId("listbox")},isLoading:m,maxHeight:l,focusedOption:p}),R)})))}));return _||"fixed"===C?t.createElement(s,dy({},u,{appendTo:_,controlElement:this.controlRef,menuPlacement:w,menuPosition:C}),N):N}},{key:"renderFormField",value:function(){var e=this,o=this.props,n=o.delimiter,r=o.isDisabled,i=o.isMulti,a=o.name,s=o.required,l=this.state.selectValue;if(s&&!this.hasValue()&&!r)return t.createElement(qx,{name:a,onFocus:this.onValueInputFocus});if(a&&!r){if(i){if(n){var c=l.map((function(t){return e.getOptionValue(t)})).join(n);return t.createElement("input",{name:a,type:"hidden",value:c})}var d=l.length>0?l.map((function(o,n){return t.createElement("input",{key:"i-".concat(n),name:a,type:"hidden",value:e.getOptionValue(o)})})):t.createElement("input",{name:a,type:"hidden",value:""});return t.createElement("div",null,d)}var u=l[0]?this.getOptionValue(l[0]):"";return t.createElement("input",{name:a,type:"hidden",value:u})}}},{key:"renderLiveRegion",value:function(){var e=this.commonProps,o=this.state,n=o.ariaSelection,r=o.focusedOption,i=o.focusedValue,a=o.isFocused,s=o.selectValue,l=this.getFocusableOptions();return t.createElement(wx,dy({},e,{id:this.getElementId("live-region"),ariaSelection:n,focusedOption:r,focusedValue:i,isFocused:a,selectValue:s,focusableOptions:l,isAppleDevice:this.isAppleDevice}))}},{key:"render",value:function(){var e=this.getComponents(),o=e.Control,n=e.IndicatorsContainer,r=e.SelectContainer,i=e.ValueContainer,a=this.props,s=a.className,l=a.id,c=a.isDisabled,d=a.menuIsOpen,u=this.state.isFocused,p=this.commonProps=this.getCommonProps();return t.createElement(r,dy({},p,{className:s,innerProps:{id:l,onKeyDown:this.onKeyDown},isDisabled:c,isFocused:u}),this.renderLiveRegion(),t.createElement(o,dy({},p,{innerRef:this.getControlRef,innerProps:{onMouseDown:this.onControlMouseDown,onTouchEnd:this.onControlTouchEnd},isDisabled:c,isFocused:u,menuIsOpen:d}),t.createElement(i,dy({},p,{isDisabled:c}),this.renderPlaceholderOrValue(),this.renderInput()),t.createElement(n,dy({},p,{isDisabled:c}),this.renderClearIndicator(),this.renderLoadingIndicator(),this.renderIndicatorSeparator(),this.renderDropdownIndicator())),this.renderMenu(),this.renderFormField())}}],[{key:"getDerivedStateFromProps",value:function(e,t){var o=t.prevProps,n=t.clearFocusValueOnUpdate,r=t.inputIsHiddenAfterUpdate,i=t.ariaSelection,a=t.isFocused,s=t.prevWasFocused,l=t.instancePrefix,c=e.options,d=e.value,u=e.menuIsOpen,p=e.inputValue,h=e.isMulti,f=Sb(d),g={};if(o&&(d!==o.value||c!==o.options||u!==o.menuIsOpen||p!==o.inputValue)){var m=u?function(e,t){return nw(ow(e,t))}(e,f):[],y=u?rw(ow(e,f),"".concat(l,"-option")):[],v=n?function(e,t){var o=e.focusedValue,n=e.selectValue.indexOf(o);if(n>-1){if(t.indexOf(o)>-1)return o;if(n<t.length)return t[n]}return null}(t,f):null,b=function(e,t){var o=e.focusedOption;return o&&t.indexOf(o)>-1?o:t[0]}(t,m);g={selectValue:f,focusedOption:b,focusedOptionId:aw(y,b),focusableOptionsWithIds:y,focusedValue:v,clearFocusValueOnUpdate:!1}}var x=null!=r&&e!==o?{inputIsHidden:r,inputIsHiddenAfterUpdate:void 0}:{},w=i,C=a&&s;return a&&!C&&(w={value:Fb(h,f,f[0]||null),options:f,action:"initial-input-focus"},C=!s),"initial-input-focus"===(null===i||void 0===i?void 0:i.action)&&(w=null),ry(ry(ry({},g),x),{},{prevProps:e,ariaSelection:w,prevWasFocused:C})}}]),n}(t.Component);fw.defaultProps=ew;var gw=(0,t.forwardRef)((function(e,o){var n=function(e){var o=e.defaultInputValue,n=void 0===o?"":o,r=e.defaultMenuIsOpen,i=void 0!==r&&r,a=e.defaultValue,s=void 0===a?null:a,l=e.inputValue,c=e.menuIsOpen,d=e.onChange,u=e.onInputChange,p=e.onMenuClose,h=e.onMenuOpen,f=e.value,g=ly(e,cy),m=sy((0,t.useState)(void 0!==l?l:n),2),y=m[0],v=m[1],b=sy((0,t.useState)(void 0!==c?c:i),2),x=b[0],w=b[1],C=sy((0,t.useState)(void 0!==f?f:s),2),_=C[0],S=C[1],E=(0,t.useCallback)((function(e,t){"function"===typeof d&&d(e,t),S(e)}),[d]),k=(0,t.useCallback)((function(e,t){var o;"function"===typeof u&&(o=u(e,t)),v(void 0!==o?o:e)}),[u]),j=(0,t.useCallback)((function(){"function"===typeof h&&h(),w(!0)}),[h]),A=(0,t.useCallback)((function(){"function"===typeof p&&p(),w(!1)}),[p]),R=void 0!==l?l:y,O=void 0!==c?c:x,T=void 0!==f?f:_;return ry(ry({},g),{},{inputValue:R,menuIsOpen:O,onChange:E,onInputChange:k,onMenuClose:A,onMenuOpen:j,value:T})}(e);return t.createElement(fw,dy({ref:o},n))}));const mw=P.Ay.div`
  padding: 24px;
  background-color: white;
  border-radius: 8px;
`,yw=P.Ay.div`
  margin-bottom: 24px;
  
  h1 {
    font-size: 1.5rem;
    font-weight: 600;
    color: #111827;
    margin-bottom: 8px;
  }
  
  p {
    color: #6b7280;
    font-size: 0.875rem;
  }
`,vw=P.Ay.table`
  width: 100%;
  border-collapse: separate;
  border-spacing: 0;
  margin-top: 24px;
  background: #fff;
  border: none;
  border-radius: 8px;
  overflow: hidden;
`,bw=P.Ay.thead`
  background: white;
  th {
    padding: 12px 16px;
    text-align: left;
    font-size: 0.875rem;
    font-weight: 500;
    color: black;
    border-bottom: 1px solid black;
    &.date-col { width: 3%; }
    &.contacts-col { width: 38%; }
    &.rationale-col { width: 12%; }
    &.note-col { width: 42%; }
    &.actions-col { width: 5%; }
  }
`,xw=P.Ay.tbody`
  tr {
    &:hover {
      background-color: #f9fafb;
    }
    /* Removing row borders */
  }
  td {
    padding: 12px 16px;
    font-size: 0.875rem;
    color: #1f2937;
    vertical-align: middle;
    border-bottom: none;
  }
`,ww=P.Ay.button`
  padding: 6px 12px;
  border-radius: 0px;
  font-size: 0.875rem;
  font-weight: 500;
  background-color: #000000;
  color: white;
  border: none;
  cursor: pointer;
  transition: background-color 0.2s ease;
  
  &:hover {
    background-color: #333333;
  }

  &:disabled {
    background-color: #9ca3af;
    cursor: not-allowed;
  }
`,Cw=P.Ay.div`
  padding: 24px;
`,_w=P.Ay.div`
  margin-bottom: 20px;

  label {
    display: block;
    margin-bottom: 8px;
    font-weight: 500;
    color: #374151;
  }

  input {
    width: 100%;
    padding: 8px 12px;
    border: 1px solid #d1d5db;
    border-radius: 4px;
    font-size: 0.875rem;
    height: 38px;
    box-sizing: border-box;
  }
  
  textarea {
    width: 100%;
    padding: 8px 12px;
    border: 1px solid #d1d5db;
    border-radius: 4px;
    font-size: 0.875rem;
    min-height: 80px;
    font-family: inherit;
    box-sizing: border-box;
  }
  
  /* Ensure the react-select components match our styling */
  .css-13cymwt-control {
    min-height: 38px;
  }
`,Sw={content:{top:"50%",left:"50%",right:"auto",bottom:"auto",marginRight:"-50%",transform:"translate(-50%, -50%)",width:"600px",maxWidth:"90%",borderRadius:"8px",padding:"0"},overlay:{backgroundColor:"rgba(0, 0, 0, 0.75)"}},Ew=P.Ay.span`
  display: inline-flex;
  align-items: center;
  padding: 2px 8px;
  border-radius: 0;
  font-size: 0.75rem;
  font-weight: 500;
  background-color: white;
  border: 1.5px solid black;
  color: black;
  cursor: pointer;
  position: relative;
  
  &:hover {
    background-color: #f3f4f6;
  }
`,kw=P.Ay.div`
  display: flex;
  gap: 12px;
  justify-content: flex-end;
  margin-top: 24px;
`,jw=P.Ay.span`
  display: inline-flex;
  align-items: center;
  background: #e5e7eb;
  padding: 2px 8px;
  border-radius: 16px;
  margin: 2px;
  font-size: 0.75rem;

  .contact-name {
    cursor: pointer;
    &:hover {
      color: #3b82f6;
    }
  }

  button {
    background: none;
    border: none;
    margin-left: 4px;
    cursor: pointer;
    color: #4b5563;
    padding: 0 2px;
    
    &:hover {
      color: #ef4444;
    }
  }
`,Aw=P.Ay.button`
  background: none;
  border: 1px dashed #9ca3af;
  padding: 2px 8px;
  border-radius: 16px;
  color: #6b7280;
  cursor: pointer;
  font-size: 0.75rem;
  margin: 2px;

  &:hover {
    background: #f3f4f6;
  }
`,Rw=(0,P.Ay)(gw)`
  min-width: 200px;
`,Ow=P.Ay.div`
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
  max-width: 100%;
  position: relative;

  &:hover::after {
    content: attr(data-tooltip);
    position: absolute;
    left: 0;
    top: 100%;
    background: #1f2937;
    color: white;
    padding: 8px 12px;
    border-radius: 6px;
    font-size: 0.875rem;
    white-space: normal;
    max-width: 400px;
    word-wrap: break-word;
    z-index: 1000;
    box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1), 0 2px 4px -1px rgba(0, 0, 0, 0.06);
  }
`,Tw=P.Ay.div`
  position: absolute;
  top: 100%;
  left: 0;
  background: white;
  border: 1px solid #d1d5db;
  box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1), 0 2px 4px -1px rgba(0, 0, 0, 0.06);
  z-index: 1000;
  width: 150px;
`,Dw=P.Ay.div`
  padding: 8px 12px;
  font-size: 0.75rem;
  cursor: pointer;
  display: flex;
  align-items: center;
  
  &:hover {
    background-color: #f3f4f6;
  }
`,Pw=P.Ay.div`
  position: relative;
  width: 100%;
  
  textarea {
    width: 100%;
    padding: 8px;
    font-size: 0.875rem;
    border: 1px solid black;
    border-radius: 0;
    min-height: 60px;
    font-family: inherit;
  }
  
  &::after {
    content: 'Press Enter to save, Esc to cancel';
    position: absolute;
    bottom: -20px;
    right: 0;
    font-size: 0.7rem;
    color: #6b7280;
  }
`,Nw=P.Ay.div`
  cursor: pointer;
  padding: 4px;
  
  &:hover {
    background-color: #f3f4f6;
  }
`,Iw=P.Ay.button`
  padding: 4px 8px;
  background-color: ${e=>e.confirm?"#ef4444":"black"};
  color: white;
  border: none;
  border-radius: 0;
  cursor: pointer;
  font-size: 0.75rem;
  
  &:hover {
    background-color: ${e=>e.confirm?"#dc2626":"#333333"};
  }
`,Mw=()=>{const[e,o]=(0,t.useState)(!1),[n,r]=(0,t.useState)(!1),[i,a]=(0,t.useState)([]),[s,l]=(0,t.useState)([]),[c,d]=(0,t.useState)(!0),[u,p]=(0,t.useState)(null),[h,f]=(0,t.useState)(null),[g,m]=(0,t.useState)(null),[y,v]=(0,t.useState)(!1),[b,x]=(0,t.useState)(null),[w,C]=(0,t.useState)(null),[_,S]=(0,t.useState)(""),[E,k]=(0,t.useState)(null),[j,A]=(0,t.useState)({intro_date:(0,ge.A)(new Date,"yyyy-MM-dd"),contacts_introduced:[],introduction_rationale:"",introduction_note:""}),R=[{value:"Karma Points",label:"\ud83c\udfb0 Karma Points"},{value:"Dealflow Related",label:"\ud83c\udf08 Dealflow"},{value:"Portfolio Company Related",label:"\ud83e\udd11 Portfolio"}];(0,t.useEffect)((()=>{O()}),[]);const O=async()=>{try{const{data:e,error:t}=await D.supabase.from("contacts").select("id, first_name, last_name").order("last_modified",{ascending:!1});if(t)throw t;l(e);const{data:o,error:n}=await D.supabase.from("contact_introductions").select("*").order("intro_date",{ascending:!1});if(n)throw n;console.log("Introductions data:",o),o&&o.length>0&&console.log("First introduction contacts_introduced type:",typeof o[0].contacts_introduced,"value:",o[0].contacts_introduced),a(o)}catch(e){console.error("Error fetching data:",e)}finally{d(!1)}},T=async e=>{e.preventDefault();try{if(!j.contacts_introduced.length)return void alert("Please select at least one contact");if(!j.introduction_rationale)return void alert("Please select a rationale");const{data:e,error:t}=await D.supabase.from("contact_introductions").insert([{intro_date:j.intro_date,contacts_introduced:j.contacts_introduced,introduction_rationale:j.introduction_rationale,introduction_note:j.introduction_note,created_by:(await D.supabase.auth.getUser()).data.user.id}]).select();if(t)throw t;o(!1),O(),A({intro_date:(0,ge.A)(new Date,"yyyy-MM-dd"),contacts_introduced:[],introduction_rationale:"",introduction_note:""}),alert("Introduction created successfully!")}catch(t){console.error("Error creating introduction:",t),alert("Error creating introduction: "+t.message)}},P=async(e,t)=>{try{console.log(`Updating introduction ${e} with new rationale: ${t}`);const o=parseInt(e,10),{data:n,error:r}=await D.supabase.from("contact_introductions").update({introduction_rationale:t}).eq("intro_id",o);if(r)throw console.error("Update error details:",r),r;console.log("Update successful, response:",n),x(null),O()}catch(o){console.error("Error updating rationale:",o),alert("Error updating rationale: "+o.message)}},I=async e=>{try{const t=parseInt(e,10),{error:o}=await D.supabase.from("contact_introductions").delete().eq("intro_id",t);if(o)throw o;O()}catch(t){console.error("Error deleting introduction:",t),alert("Error deleting introduction: "+t.message)}};(0,t.useEffect)((()=>{const e=()=>{null!==b&&x(null)};return document.addEventListener("click",e),()=>{document.removeEventListener("click",e)}}),[b]);const M=e=>(0,N.jsxs)("div",{style:{display:"flex",flexWrap:"wrap",alignItems:"center"},children:[e.contacts_introduced.map((t=>{return(0,N.jsxs)(jw,{children:[(0,N.jsx)("span",{className:"contact-name",onClick:()=>(async e=>{try{const{data:t,error:o}=await D.supabase.from("contacts").select("*").eq("id",e).single();if(o)throw o;m(t),v(!0)}catch(t){console.error("Error fetching contact details:",t),alert("Error fetching contact details")}})(t),children:(o=[t],console.log("Contact IDs to find:",o),console.log("Available contacts:",s.map((e=>e.id))),o.map((e=>{const t=s.find((t=>t.id===e));return t||console.log("Contact not found for ID:",e),t?`${t.first_name} ${t.last_name}`:"Unknown"})).join(", "))}),(0,N.jsx)("button",{onClick:()=>(async(e,t)=>{try{const o=i.find((t=>t.intro_id===e)).contacts_introduced.filter((e=>e!==t));if(o.length<2)return void alert("An introduction must have at least 2 contacts");const{error:n}=await D.supabase.from("contact_introductions").update({contacts_introduced:o}).eq("intro_id",e);if(n)throw n;O()}catch(o){console.error("Error removing contact:",o),alert("Error removing contact: "+o.message)}})(e.intro_id,t),children:"\xd7"})]},t);var o})),h===e.intro_id?(0,N.jsx)(Rw,{options:s.filter((t=>!e.contacts_introduced.includes(t.id))).map((e=>({value:e.id,label:`${e.first_name} ${e.last_name}`}))),onChange:t=>(async(e,t)=>{try{const o=[...i.find((t=>t.intro_id===e)).contacts_introduced,t],{error:n}=await D.supabase.from("contact_introductions").update({contacts_introduced:o}).eq("intro_id",e);if(n)throw n;f(null),O()}catch(o){console.error("Error adding contact:",o),alert("Error adding contact: "+o.message)}})(e.intro_id,t.value),onBlur:()=>f(null),autoFocus:!0}):(0,N.jsx)(Aw,{onClick:()=>f(e.intro_id),children:"+ Add Contact"})]}),L=e=>{if(w===e.intro_id)return(0,N.jsx)(Pw,{children:(0,N.jsx)("textarea",{value:_,onChange:e=>S(e.target.value),autoFocus:!0,onKeyDown:e=>{"Enter"!==e.key||e.shiftKey||(e.preventDefault(),(async()=>{try{const e=parseInt(w,10),{error:t}=await D.supabase.from("contact_introductions").update({introduction_note:_}).eq("intro_id",e);if(t)throw t;C(null),O()}catch(e){console.error("Error updating note:",e),alert("Error updating note: "+e.message)}})()),"Escape"===e.key&&(e.preventDefault(),C(null))}})});{const t=e.introduction_note;return(0,N.jsx)(Nw,{onClick:()=>(e=>{C(e.intro_id),S(e.introduction_note||"")})(e),children:t?(0,N.jsx)(Ow,{"data-tooltip":t,children:t}):"-"})}};return(0,N.jsxs)(mw,{children:[(0,N.jsxs)(yw,{children:[(0,N.jsx)("h1",{children:"Introductions"}),(0,N.jsx)("p",{children:"Manage your professional introductions and networking connections."})]}),(0,N.jsx)(ww,{onClick:()=>o(!0),children:"New Introduction"}),(0,N.jsxs)(vw,{children:[(0,N.jsx)(bw,{children:(0,N.jsxs)("tr",{children:[(0,N.jsx)("th",{className:"date-col",children:"Date"}),(0,N.jsx)("th",{className:"contacts-col",children:"Contacts Introduced"}),(0,N.jsx)("th",{className:"rationale-col",children:"Rationale"}),(0,N.jsx)("th",{className:"note-col",children:"Note"}),(0,N.jsx)("th",{className:"actions-col",children:"Actions"})]})}),(0,N.jsx)(xw,{children:i.map((e=>(0,N.jsxs)("tr",{children:[(0,N.jsx)("td",{children:(0,ge.A)(new Date(e.intro_date),"MM/yy")}),(0,N.jsx)("td",{children:M(e)}),(0,N.jsx)("td",{children:(0,N.jsxs)(Ew,{onClick:t=>((e,t)=>{b&&b!==e&&x(null),x(b===e?null:e),t.stopPropagation()})(e.intro_id,t),children:["Karma Points"===e.introduction_rationale&&(0,N.jsx)(N.Fragment,{children:"\ud83c\udfb0 Karma Points"}),"Dealflow Related"===e.introduction_rationale&&(0,N.jsx)(N.Fragment,{children:"\ud83c\udf08 Dealflow"}),"Portfolio Company Related"===e.introduction_rationale&&(0,N.jsx)(N.Fragment,{children:"\ud83e\udd11 Portfolio"}),b===e.intro_id&&(0,N.jsxs)(Tw,{onClick:e=>e.stopPropagation(),children:[(0,N.jsx)(Dw,{onClick:()=>P(e.intro_id,"Karma Points"),children:"\ud83c\udfb0 Karma Points"}),(0,N.jsx)(Dw,{onClick:()=>P(e.intro_id,"Dealflow Related"),children:"\ud83c\udf08 Dealflow"}),(0,N.jsx)(Dw,{onClick:()=>P(e.intro_id,"Portfolio Company Related"),children:"\ud83e\udd11 Portfolio"})]})]})}),(0,N.jsx)("td",{children:L(e)}),(0,N.jsx)("td",{children:(0,N.jsx)(Iw,{confirm:E===e.intro_id,onClick:()=>{return t=e.intro_id,void(E===t?(I(t),k(null)):(k(t),setTimeout((()=>{E===t&&k(null)}),5e3)));var t},children:E===e.intro_id?"Confirm":"Delete"})})]},e.intro_id)))})]}),(0,N.jsx)(ot(),{isOpen:e,onRequestClose:()=>o(!1),style:Sw,contentLabel:"New Introduction",children:(0,N.jsxs)(Cw,{children:[(0,N.jsx)("h2",{style:{marginBottom:"24px"},children:"New Introduction"}),(0,N.jsxs)("form",{onSubmit:T,onKeyDown:e=>{"Enter"!==e.key||"TEXTAREA"===e.target.tagName||e.shiftKey||e.ctrlKey||e.altKey||(e.preventDefault(),T(e)),"Escape"===e.key&&(e.preventDefault(),o(!1))},children:[(0,N.jsxs)(_w,{children:[(0,N.jsx)("label",{children:"Date"}),(0,N.jsx)("div",{style:{height:"38px"},children:(0,N.jsx)("input",{type:"date",value:j.intro_date,onChange:e=>A({...j,intro_date:e.target.value}),required:!0,style:{width:"100%",height:"38px",padding:"2px 8px",boxSizing:"border-box"}})})]}),(0,N.jsxs)(_w,{children:[(0,N.jsx)("label",{children:"Contacts"}),(0,N.jsx)(gw,{isMulti:!0,value:s.filter((e=>j.contacts_introduced.includes(e.id))).map((e=>({value:e.id,label:`${e.first_name} ${e.last_name}`}))),options:s.map((e=>({value:e.id,label:`${e.first_name} ${e.last_name}`}))),onChange:e=>A({...j,contacts_introduced:e?e.map((e=>e.value)):[]})})]}),(0,N.jsxs)(_w,{children:[(0,N.jsx)("label",{children:"Rationale"}),(0,N.jsx)(gw,{value:R.find((e=>e.value===j.introduction_rationale)),options:R,onChange:e=>A({...j,introduction_rationale:e?e.value:""})})]}),(0,N.jsxs)(_w,{children:[(0,N.jsx)("label",{children:"Note"}),(0,N.jsx)("textarea",{value:j.introduction_note,onChange:e=>A({...j,introduction_note:e.target.value}),placeholder:"Add any relevant notes about this introduction..."})]}),(0,N.jsxs)(kw,{children:[(0,N.jsx)(ww,{type:"button",onClick:()=>o(!1),style:{backgroundColor:"#6b7280"},children:"Cancel (Esc)"}),(0,N.jsx)(ww,{type:"submit",disabled:!j.contacts_introduced.length||!j.introduction_rationale,style:{backgroundColor:"#000000"},children:"Create Introduction (Enter)"})]}),(0,N.jsx)("div",{style:{marginTop:"15px",fontSize:"0.75rem",color:"#6b7280",textAlign:"center"},children:"Tip: Press Enter to submit, Esc to cancel"})]})]})}),(0,N.jsx)(ot(),{isOpen:n,onRequestClose:()=>r(!1),style:Sw,contentLabel:"Edit Introduction",children:(0,N.jsxs)(Cw,{children:[(0,N.jsx)("h2",{style:{marginBottom:"24px"},children:"Edit Introduction"}),(0,N.jsxs)("form",{onSubmit:async e=>{e.preventDefault();try{const{error:e}=await D.supabase.from("contact_introductions").update({intro_date:j.intro_date,contacts_introduced:j.contacts_introduced,introduction_rationale:j.introduction_rationale,introduction_note:j.introduction_note}).eq("intro_id",u.intro_id);if(e)throw e;r(!1),O(),alert("Introduction updated successfully!")}catch(t){console.error("Error updating introduction:",t),alert("Error updating introduction: "+t.message)}},children:[(0,N.jsxs)(_w,{children:[(0,N.jsx)("label",{children:"Date"}),(0,N.jsx)("input",{type:"date",value:j.intro_date,onChange:e=>A({...j,intro_date:e.target.value}),required:!0})]}),(0,N.jsxs)(_w,{children:[(0,N.jsx)("label",{children:"Contacts"}),(0,N.jsx)(gw,{isMulti:!0,value:s.filter((e=>j.contacts_introduced.includes(e.id))).map((e=>({value:e.id,label:`${e.first_name} ${e.last_name}`}))),options:s.map((e=>({value:e.id,label:`${e.first_name} ${e.last_name}`}))),onChange:e=>{const t=e?e.map((e=>e.value)):[];t.length<2?alert("An introduction must have at least 2 contacts"):A({...j,contacts_introduced:t})}})]}),(0,N.jsxs)(_w,{children:[(0,N.jsx)("label",{children:"Rationale"}),(0,N.jsx)(gw,{value:R.find((e=>e.value===j.introduction_rationale)),options:R,onChange:e=>A({...j,introduction_rationale:e?e.value:""})})]}),(0,N.jsxs)(_w,{children:[(0,N.jsx)("label",{children:"Note"}),(0,N.jsx)("textarea",{value:j.introduction_note,onChange:e=>A({...j,introduction_note:e.target.value}),placeholder:"Add any relevant notes about this introduction..."})]}),(0,N.jsxs)(kw,{children:[(0,N.jsx)(ww,{type:"button",onClick:()=>r(!1),style:{backgroundColor:"#6b7280"},children:"Cancel"}),(0,N.jsx)(ww,{type:"submit",disabled:!j.contacts_introduced.length||!j.introduction_rationale,style:{backgroundColor:"#000000"},children:"Update Introduction"})]})]})]})}),y&&g&&(0,N.jsx)(Mg,{isOpen:y,onRequestClose:()=>{v(!1),m(null),O()},contact:g})]})};var Lw=o(7694);const Fw=P.Ay.div`
  padding: 0;
  margin-top: 0; /* Reset the negative margin */
  height: 100%;
  width: 100%;
  overflow: hidden;
  box-sizing: border-box;
  max-width: 100%;
`,Gw=P.Ay.div`
  display: flex;
  background-color: #111;
  border-bottom: 1px solid #333;
  overflow-x: auto;
  scrollbar-width: thin;
  scrollbar-color: #00ff00 #222;
  padding: 8px 0;
  margin-bottom: 0;
  position: sticky;
  top: 0;
  z-index: 100;
  width: 100%;
  
  &::-webkit-scrollbar {
    height: 6px;
  }
  
  &::-webkit-scrollbar-track {
    background: #222;
  }
  
  &::-webkit-scrollbar-thumb {
    background-color: #00ff00;
    border-radius: 3px;
  }
`,zw=P.Ay.div`
  padding: 0px 0px 0px 0px;
  width: 100%;
  overflow: hidden;
  box-sizing: border-box;
  max-width: 100%;
`,Hw=P.Ay.div`
  display: flex;
  align-items: center;
  padding: 10px 20px;
  color: ${e=>e.$active?"#00ff00":"#ccc"};
  text-decoration: none;
  border-bottom: 3px solid ${e=>e.$active?"#00ff00":"transparent"};
  margin-right: 20px;
  font-family: 'Courier New', monospace;
  transition: all 0.2s ease;
  white-space: nowrap;
  cursor: pointer;
  font-size: 1rem;
  font-weight: ${e=>e.$active?"bold":"normal"};
  background-color: ${e=>e.$active?"rgba(0, 255, 0, 0.05)":"transparent"};
  border-radius: 4px 4px 0 0;
  
  &:hover {
    color: #00ff00;
    background-color: rgba(0, 255, 0, 0.05);
  }
  
  &:first-child {
    margin-left: 10px;
  }
  
  svg {
    margin-right: 10px;
    font-size: 1.1rem;
  }
`,Bw=P.Ay.div`
  width: 100%;
  overflow: hidden;
  box-sizing: border-box;
  max-width: 100%;
`,Vw=(P.Ay.h2`
  color: #00ff00;
  margin-top: 0;
  margin-bottom: 16px;
  font-family: 'Courier New', monospace;
  font-size: 1.5rem;
`,P.Ay.div`
  display: flex;
  justify-content: center;
  align-items: center;
  height: 300px;
  color: #00ff00;
  font-family: 'Courier New', monospace;
`,()=>{const[e,o]=(0,t.useState)("full-list"),n=[{id:"full-list",name:"Full List",icon:(0,N.jsx)(B.cfS,{}),category:"all-except-skip"},{id:"inbox",name:"Inbox",icon:(0,N.jsx)(B._Y7,{}),category:"Inbox"},{id:"rockstars",name:"Rockstars",icon:(0,N.jsx)(Ae.gt3,{}),category:"rockstars-score-5"},{id:"founders",name:"Founders",icon:(0,N.jsx)(B.Wm,{}),category:"Founder"},{id:"investors",name:"Professional Investors",icon:(0,N.jsx)(B.z8N,{}),category:"Professional Investor"},{id:"managers",name:"Managers",icon:(0,N.jsx)(B.qYx,{}),category:"Manager"},{id:"care",name:"People I Care",icon:(0,N.jsx)(B.icx,{}),category:"Friend and Family"}],r=n.find((t=>t.id===e))||n[0];return(0,N.jsxs)(Fw,{children:[(0,N.jsx)(Gw,{children:n.map((t=>(0,N.jsxs)(Hw,{$active:e===t.id,onClick:()=>o(t.id),children:[t.icon," ",t.name]},t.id)))}),(0,N.jsx)(zw,{children:(0,N.jsx)(Bw,{children:(0,N.jsx)(Lw.A,{category:r.category})})})]})});var $w=o(8136),Uw=o(5962);const Ww=P.Ay.div`
  width: 100%;
  max-width: 600px;
`,qw=P.Ay.div`
  display: flex;
  justify-content: space-between;
  align-items: center;
  margin-bottom: 20px;
  padding-bottom: 15px;
  border-bottom: 1px solid #333;
`,Kw=P.Ay.h2`
  color: #fff;
  font-size: 20px;
  font-weight: 500;
  margin: 0;
`,Yw=P.Ay.button`
  background: transparent;
  color: #00ff00;
  border: none;
  cursor: pointer;
  display: flex;
  align-items: center;
  justify-content: center;
  font-size: 20px;
  padding: 5px;
  border-radius: 4px;

  &:hover {
    background: #333;
  }
`,Jw=P.Ay.div`
  margin-bottom: 20px;
`,Xw=P.Ay.label`
  display: block;
  margin-bottom: 8px;
  color: #00ff00;
  font-size: 14px;
  font-weight: 500;
`,Qw=P.Ay.input`
  width: 100%;
  padding: 10px 12px;
  background: #333;
  border: 1px solid #444;
  border-radius: 4px;
  color: #fff;
  font-size: 14px;
  height: 40px;
  box-sizing: border-box;

  &:focus {
    outline: none;
    border-color: #00ff00;
  }
`,Zw=P.Ay.textarea`
  width: 100%;
  padding: 10px 12px;
  background: #333;
  border: 1px solid #444;
  border-radius: 4px;
  color: #fff;
  font-size: 14px;
  min-height: 100px;
  resize: vertical;
  box-sizing: border-box;

  &:focus {
    outline: none;
    border-color: #00ff00;
  }
`,eC=P.Ay.select`
  width: 100%;
  padding: 10px 12px;
  background: #333;
  border: 1px solid #444;
  border-radius: 4px;
  color: #fff;
  font-size: 14px;
  height: 40px;
  box-sizing: border-box;
  appearance: none;
  background-image: url("data:image/svg+xml;utf8,<svg xmlns='http://www.w3.org/2000/svg' width='10' height='6' fill='none' stroke='%23aaa' stroke-width='1.5' viewBox='0 0 10 6'><polyline points='1,1 5,5 9,1'/></svg>");
  background-repeat: no-repeat;
  background-position: right 10px center;
  padding-right: 30px;

  &:focus {
    outline: none;
    border-color: #00ff00;
  }
`,tC=P.Ay.div`
  display: flex;
  justify-content: flex-end;
  gap: 10px;
  margin-top: 30px;
`,oC=P.Ay.button`
  display: flex;
  align-items: center;
  gap: 8px;
  padding: 8px 16px;
  border-radius: 4px;
  font-size: 14px;
  cursor: pointer;
  transition: all 0.2s;
  
  &.primary {
    background: #333;
    color: #00ff00;
    border: 1px solid #00ff00;
    
    &:hover {
      background: #444;
    }
  }
  
  &.cancel {
    background: transparent;
    color: #fff;
    border: 1px solid #555;
    
    &:hover {
      background: #333;
    }
  }
`,nC=P.Ay.div`
  display: flex;
  flex-wrap: wrap;
  gap: 8px;
  margin-top: 10px;
`,rC=P.Ay.div`
  display: flex;
  align-items: center;
  gap: 5px;
  padding: 3px 8px;
  border: 1px solid #00ff00;
  border-radius: 4px;
  color: #00ff00;
  font-size: 12px;
`,iC=P.Ay.button`
  display: flex;
  align-items: center;
  justify-content: center;
  background: transparent;
  border: none;
  color: #00ff00;
  cursor: pointer;
  padding: 2px;

  &:hover {
    color: #ff5555;
  }
`,aC=P.Ay.input`
  width: 100%;
  padding: 10px 12px;
  background: #333;
  border: 1px solid #444;
  border-radius: 4px;
  color: #fff;
  font-size: 14px;
  height: 40px;
  box-sizing: border-box;
  margin-bottom: 10px;

  &:focus {
    outline: none;
    border-color: #00ff00;
  }
`,sC=P.Ay.div`
  background: #222;
  border: 1px solid #444;
  border-radius: 4px;
  max-height: 200px;
  overflow-y: auto;
  margin-top: -5px;
  margin-bottom: 10px;
  z-index: 10;
  position: relative;
`,lC=P.Ay.div`
  padding: 8px 12px;
  cursor: pointer;
  border-bottom: 1px solid #333;

  &:hover {
    background: #333;
  }

  &:last-child {
    border-bottom: none;
  }
`,cC=["Not Set","Inbox","Professional Investor","Startup","Corporate","Corporation","Advisory","SME","Institution","Media","Skip"],dC=["not_set","employee","founder","advisor","manager","investor","other"],uC=e=>{let{isOpen:o,onRequestClose:n,initialName:r="",contactId:i,onCompanyCreated:a=()=>{}}=e;const[s,l]=(0,t.useState)({name:"",website:"",linkedin:"",category:"Inbox",description:""}),[c,d]=(0,t.useState)("not_set"),[u,p]=(0,t.useState)(!1),[h,f]=(0,t.useState)([]),[g,m]=(0,t.useState)(""),[y,v]=(0,t.useState)([]),[b,x]=(0,t.useState)(!1),w=(0,t.useRef)(null);(0,t.useEffect)((()=>{o&&(l((e=>({...e,name:r}))),w.current&&setTimeout((()=>{w.current.focus()}),100))}),[o,r]);const C=(e,t)=>{l((o=>({...o,[e]:t})))},_=async e=>{try{if(h.some((t=>t.tag_id===e.tag_id)))return;f([...h,{tag_id:e.tag_id,name:e.name}]),m(""),x(!1)}catch(t){console.error("Error adding tag:",t)}},S=async()=>{if(g.trim())try{const{data:e,error:t}=await D.supabase.from("tags").select("tag_id, name").eq("name",g.trim());if(t)throw t;let o;if(e&&e.length>0)o=e[0];else{const{data:e,error:t}=await D.supabase.from("tags").insert({name:g.trim()}).select().single();if(t)throw t;o=e}_(o)}catch(e){console.error("Error creating tag:",e),nt.Ay.error("Failed to create tag")}};return(0,N.jsx)(ot(),{isOpen:o,onRequestClose:n,style:{content:{top:"50%",left:"50%",right:"auto",bottom:"auto",marginRight:"-50%",transform:"translate(-50%, -50%)",padding:"25px",border:"1px solid #444",borderRadius:"8px",backgroundColor:"#111",color:"#fff",maxWidth:"600px",width:"90%",maxHeight:"90vh",overflow:"auto",boxShadow:"0 4px 20px rgba(0, 0, 0, 0.5)"},overlay:{backgroundColor:"rgba(0, 0, 0, 0.7)",zIndex:1e3}},children:(0,N.jsxs)(Ww,{children:[(0,N.jsxs)(qw,{children:[(0,N.jsx)(Kw,{children:"Create New Company"}),(0,N.jsx)(Yw,{onClick:n,children:(0,N.jsx)(B.yGN,{size:20})})]}),(0,N.jsxs)(Jw,{children:[(0,N.jsx)(Xw,{children:"Company Name *"}),(0,N.jsx)(Qw,{ref:w,type:"text",value:s.name,onChange:e=>C("name",e.target.value),placeholder:"Enter company name"})]}),(0,N.jsxs)("div",{style:{display:"flex",gap:"15px"},children:[(0,N.jsxs)(Jw,{style:{flex:1},children:[(0,N.jsx)(Xw,{children:"Domain"}),(0,N.jsx)(Qw,{type:"text",value:s.website,onChange:e=>C("website",e.target.value),placeholder:"e.g. example.com"})]}),(0,N.jsxs)(Jw,{style:{flex:1},children:[(0,N.jsx)(Xw,{children:"LinkedIn URL"}),(0,N.jsx)(Qw,{type:"text",value:s.linkedin,onChange:e=>C("linkedin",e.target.value),placeholder:"e.g. linkedin.com/company/example"})]})]}),(0,N.jsxs)("div",{style:{display:"flex",gap:"15px"},children:[(0,N.jsxs)(Jw,{style:{flex:1},children:[(0,N.jsx)(Xw,{children:"Category"}),(0,N.jsx)(eC,{value:s.category,onChange:e=>C("category",e.target.value),children:cC.map((e=>(0,N.jsx)("option",{value:e,children:e},e)))})]}),i&&(0,N.jsxs)(Jw,{style:{flex:1},children:[(0,N.jsx)(Xw,{children:"Relationship"}),(0,N.jsx)(eC,{value:c,onChange:e=>d(e.target.value),children:dC.map((e=>(0,N.jsx)("option",{value:e,children:"not_set"===e?"Not Set":e.charAt(0).toUpperCase()+e.slice(1)},e)))})]})]}),i&&(0,N.jsx)(Jw,{children:(0,N.jsxs)("div",{style:{display:"flex",alignItems:"center"},children:[(0,N.jsx)("input",{type:"checkbox",id:"isPrimary",checked:u,onChange:e=>p(e.target.checked),style:{marginRight:"10px"}}),(0,N.jsx)("label",{htmlFor:"isPrimary",style:{color:"#fff"},children:"Set as primary company"})]})}),(0,N.jsxs)(Jw,{children:[(0,N.jsx)(Xw,{children:"Description"}),(0,N.jsx)(Zw,{value:s.description,onChange:e=>C("description",e.target.value),placeholder:"Enter company description..."})]}),(0,N.jsxs)(Jw,{children:[(0,N.jsx)(Xw,{children:"Tags"}),(0,N.jsxs)("div",{style:{position:"relative"},children:[(0,N.jsx)(aC,{type:"text",value:g,onChange:e=>(async e=>{if(m(e),e.length<2)return v([]),void x(!1);try{const{data:t,error:o}=await D.supabase.from("tags").select("tag_id, name").ilike("name",`%${e}%`).limit(10);if(o)throw o;const n=t.filter((e=>!h.some((t=>t.tag_id===e.tag_id))));v(n),x(!0)}catch(t){console.error("Error searching tags:",t)}})(e.target.value),onKeyDown:async e=>{if("Enter"===e.key){if(e.preventDefault(),g.trim().length<2)return;const t=y.find((e=>e.name.toLowerCase()===g.toLowerCase()));t?_(t):S()}},placeholder:"Search or add tags (press Enter to create)"}),b&&y.length>0&&(0,N.jsx)(sC,{children:y.map((e=>(0,N.jsx)(lC,{onClick:()=>_(e),children:e.name},e.tag_id)))}),b&&g.trim()&&!y.find((e=>e.name.toLowerCase()===g.toLowerCase()))&&(0,N.jsx)(sC,{children:(0,N.jsx)(lC,{onClick:S,children:(0,N.jsxs)("span",{style:{display:"flex",alignItems:"center",gap:"5px"},children:[(0,N.jsx)(B.GGD,{size:14}),' Create "',g,'" tag']})})})]}),h.length>0?(0,N.jsx)(nC,{children:h.map((e=>(0,N.jsxs)(rC,{children:[e.name,(0,N.jsx)(iC,{onClick:()=>{return t=e.tag_id,void f(h.filter((e=>e.tag_id!==t)));var t},children:(0,N.jsx)(B.yGN,{size:10})})]},e.tag_id)))}):(0,N.jsx)("div",{style:{color:"#999",fontSize:"14px",marginTop:"10px"},children:"No tags added"})]}),(0,N.jsxs)(tC,{children:[(0,N.jsx)(oC,{className:"cancel",onClick:n,children:"Cancel"}),(0,N.jsxs)(oC,{className:"primary",onClick:async()=>{if(s.name.trim())try{var e,t;const{data:o,error:r}=await D.supabase.from("companies").insert({name:s.name.trim(),website:s.website.trim(),linkedin:s.linkedin.trim(),category:s.category,description:s.description.trim(),created_by:"User",last_modified_by:"User"}).select().single();if(r)throw r;if(h.length>0){const e=h.map((e=>({company_id:o.company_id,tag_id:e.tag_id}))),{error:t}=await D.supabase.from("company_tags").insert(e);t&&console.error("Error adding tags:",t)}let l=null;if(i){if(l=await D.supabase.from("contact_companies").insert({contact_id:i,company_id:o.company_id,relationship:c,is_primary:u}).select(),l.error)throw l.error;console.log("Company association data:",l.data)}nt.Ay.success(`${o.name} created successfully`),a({company:o,tags:h,relationship:i?c:null,isPrimary:!!i&&u,data:i?null===(e=l)||void 0===e||null===(t=e.data)||void 0===t?void 0:t[0]:null}),n()}catch(o){console.error("Error creating company:",o),nt.Ay.error("Failed to create company")}else nt.Ay.error("Company name is required")},children:[(0,N.jsx)(B.Bc_,{size:16})," Create Company"]})]})]})})},pC=P.Ay.div`
  padding: 20px 40px 20px 20px;
  height: calc(100vh - 60px);
  width: 100%;
`,hC=(P.Ay.h1`
  color: #00ff00;
  margin-bottom: 20px;
  font-family: 'Courier New', monospace;
`,P.Ay.div`
  color: #ff3333;
  background-color: #330000;
  padding: 15px;
  border-radius: 4px;
  margin-bottom: 20px;
`),fC=P.Ay.div`
  color: #00ff00;
  text-align: center;
  padding: 40px;
  font-family: monospace;
  display: flex;
  flex-direction: column;
  align-items: center;
  justify-content: center;
  height: 400px;
`,gC=P.Ay.div`
  width: 300px;
  height: 8px;
  background-color: #111;
  margin: 20px 0;
  border-radius: 4px;
  overflow: hidden;
  position: relative;
  box-shadow: 0 0 10px rgba(0, 255, 0, 0.2);
  
  &:before {
    content: "";
    position: absolute;
    top: 0;
    left: 0;
    height: 100%;
    width: 30%;
    background-color: #00ff00;
    animation: pulse 1.5s ease-in-out infinite;
    box-shadow: 0 0 20px #00ff00;
    border-radius: 4px;
  }
  
  @keyframes pulse {
    0% {
      left: -30%;
      opacity: 0.8;
    }
    100% {
      left: 100%;
      opacity: 0.2;
    }
  }
`,mC=P.Ay.div`
  margin-top: 15px;
  color: #00ff00;
  text-shadow: 0 0 5px rgba(0, 255, 0, 0.5);
  letter-spacing: 1px;
  font-size: 16px;
  opacity: 0.9;
  animation: blink 1.5s ease-in-out infinite alternate;
  
  @keyframes blink {
    from { opacity: 0.6; }
    to { opacity: 1; }
  }
`,yC=P.Ay.div`
  font-family: 'Courier New', monospace;
  font-size: 14px;
  color: #00ff00;
  text-align: center;
  margin-top: 30px;
  height: 100px;
  width: 300px;
  overflow: hidden;
  position: relative;
  
  &:after {
    content: "01001100 01101111 01100001 01100100 01101001 01101110 01100111 00100000 01000011 01101111 01101110 01110100 01100001 01100011 01110100 01110011 00101110 00101110 00101110";
    position: absolute;
    top: 0;
    left: 0;
    height: 100%;
    width: 100%;
    background: linear-gradient(to bottom, transparent, #000 80%);
    display: flex;
    flex-wrap: wrap;
    justify-content: center;
    opacity: 0.7;
    text-shadow: 0 0 5px #00ff00;
    animation: matrix 5s linear infinite;
  }
  
  @keyframes matrix {
    0% { transform: translateY(-60px); }
    100% { transform: translateY(60px); }
  }
`,vC=(P.Ay.span`
  display: inline-block;
  background-color: ${e=>e.bg||"#222"};
  color: ${e=>e.color||"#00ff00"};
  border: 1px solid ${e=>e.borderColor||"#00ff00"};
  padding: 2px 6px;
  margin-right: 3px;
  border-radius: 4px;
  font-size: 11px;
`,e=>{const t=e.value||[];return t.length?t.map((e=>e.name)).join(", "):"-"}),bC=e=>{var o;const[n,r]=(0,t.useState)(!1),[i,a]=(0,t.useState)(!1),[s,l]=(0,t.useState)(null),c=e.value||[],d=null===(o=e.data)||void 0===o?void 0:o.contact_id,u=()=>{r(!0)};return c.length?(0,N.jsxs)("div",{children:[c.map((t=>(0,N.jsxs)("div",{style:{display:"flex",alignItems:"center",marginBottom:"3px",justifyContent:"space-between"},children:[(0,N.jsx)("span",{style:{cursor:"pointer",color:"#00ff00",textDecoration:"underline",marginRight:"5px"},onClick:e=>((e,t)=>{t.stopPropagation(),l(e),a(!0)})(t,e),title:"Edit Company",children:t.name}),(0,N.jsx)("button",{onClick:o=>(async(t,o)=>{if(o.stopPropagation(),d&&t)try{const{error:o}=await D.supabase.from("contact_companies").delete().eq("contact_id",d).eq("company_id",t);if(o)throw o;nt.Ay.success("Company association removed"),e.api&&e.api.refreshCells({force:!0})}catch(n){console.error("Error removing company association:",n),nt.Ay.error("Failed to remove company association")}})(t.id,o),style:{background:"transparent",border:"none",color:"#ff3333",cursor:"pointer",display:"flex",alignItems:"center",justifyContent:"center",width:"18px",height:"18px",padding:0,fontSize:"14px"},title:"Remove Company Association",children:(0,N.jsx)(B.yGN,{size:14})})]},t.id))),(0,N.jsx)("button",{onClick:u,style:{background:"transparent",border:"1px solid #00ff00",color:"#00ff00",borderRadius:"3px",cursor:"pointer",display:"flex",alignItems:"center",justifyContent:"center",width:"20px",height:"20px",padding:0,fontSize:"16px",marginTop:"5px"},title:"Add Company",children:(0,N.jsx)(B.GGD,{size:14})}),n&&(0,N.jsx)(uC,{isOpen:n,onRequestClose:()=>r(!1),contactId:d,onCompanyCreated:t=>{e.api&&e.api.refreshCells({force:!0})}}),i&&s&&(0,N.jsx)(Uw.A,{isOpen:i,onRequestClose:()=>a(!1),company:s,contactId:d,onCompanyUpdated:()=>{e.api&&e.api.refreshCells({force:!0})}})]}):(0,N.jsxs)("div",{style:{display:"flex",alignItems:"center"},children:[(0,N.jsx)("span",{style:{marginRight:"10px"},children:"-"}),(0,N.jsx)("button",{onClick:u,style:{background:"transparent",border:"1px solid #00ff00",color:"#00ff00",borderRadius:"3px",cursor:"pointer",display:"flex",alignItems:"center",justifyContent:"center",width:"20px",height:"20px",padding:0,fontSize:"16px"},title:"Add Company",children:(0,N.jsx)(B.GGD,{size:14})})]})},xC=e=>{const t=e.value||[];return t.length?t.map((e=>e.name)).join(", "):"-"},wC=e=>{const t=e.value;if(null===t||void 0===t)return"-";return(0,N.jsx)("span",{style:{color:(e=>e>=8?"#00cc00":e>=6?"#aacc00":e>=4?"#ccaa00":e>=2?"#cc7700":"#cc3300")(t),fontWeight:"bold",fontSize:"14px"},children:t})},CC=()=>{const[e,o]=(0,t.useState)([]),[n,r]=(0,t.useState)(!0),[a,s]=(0,t.useState)(null),[l,c]=(0,t.useState)(null),[d,u]=(0,t.useState)(!1),[p,h]=(0,t.useState)(!1),f=(0,i.Zp)(),g=(0,t.useMemo)((()=>[{headerName:"Name",field:"name",valueGetter:e=>{if(!e.data)return"";return`${e.data.first_name||""} ${e.data.last_name||""}`.trim()||"(No name)"},minWidth:150,filter:"agTextColumnFilter",floatingFilter:!0,sortable:!0,pinned:"left"},{headerName:"Last Interaction",field:"last_interaction_at",valueFormatter:e=>e.value?new Date(e.value).toLocaleDateString():"-",minWidth:140,filter:"agDateColumnFilter",floatingFilter:!0,sortable:!0},{headerName:"Category",field:"category",valueGetter:e=>e.data?e.data.category||e.data.contact_category||"-":"",minWidth:130,filter:"agTextColumnFilter",floatingFilter:!0,sortable:!0},{headerName:"Mobile",field:"mobile",valueGetter:e=>e.data?e.data.mobile||"-":"",minWidth:130,filter:"agTextColumnFilter",floatingFilter:!0,sortable:!0,cellRenderer:e=>{const t=e.value||"-";return"-"===t?t:(0,N.jsx)("span",{style:{color:"#cccccc"},children:t})}},{headerName:"Email",field:"email",valueGetter:e=>e.data?e.data.email||"-":"",minWidth:180,filter:"agTextColumnFilter",floatingFilter:!0,sortable:!0,cellRenderer:e=>{const t=e.value||"-";return"-"===t?t:(0,N.jsx)("span",{style:{color:"#cccccc"},children:t})}},{headerName:"Score",field:"score",cellRenderer:wC,width:90,filter:"agNumberColumnFilter",floatingFilter:!0,sortable:!0},{headerName:"Tags",field:"tags",cellRenderer:vC,minWidth:150,sortable:!1,filter:!1},{headerName:"Companies",field:"companies",cellRenderer:bC,minWidth:150,sortable:!1,filter:!1},{headerName:"Cities",field:"cities",cellRenderer:xC,minWidth:140,sortable:!1,filter:!1}]),[]),m=(0,t.useMemo)((()=>({resizable:!0})),[]),y=t.useCallback((e=>{console.log("Grid is ready"),c(e.api),setTimeout((()=>{e.api.sizeColumnsToFit()}),0)}),[]),v=t.useCallback((e=>{e.data&&e.data.contact_id&&f(`/contacts/integrity/${e.data.contact_id}`)}),[f]);return(0,t.useEffect)((()=>{d||(console.log("Initiating data fetch"),(async()=>{try{r(!0),s(null);const t=async function(e){let t,o=arguments.length>1&&void 0!==arguments[1]?arguments[1]:3,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1e3;for(let i=0;i<o;i++)try{return await e()}catch(r){console.log(`Attempt ${i+1} failed, retrying in ${n}ms...`,r),t=r,await new Promise((e=>setTimeout(e,n))),n*=1.5}throw t},{count:n,error:i}=await t((async()=>D.supabase.from("contacts").select("*",{count:"exact",head:!0}).not("category","eq","Skip").not("category","eq","Inbox").not("category","eq","WhatsApp Group Contact")));if(i)throw i;console.log(`Total contacts: ${n}`);const a=async(e,o)=>(console.log(`Fetching batch from ${e} to ${o}`),t((async()=>{const t=new Date;t.setDate(t.getDate()-21);const n=t.toISOString();return D.supabase.from("contacts").select("\n              contact_id, \n              first_name, \n              last_name, \n              category,\n              score, \n              last_interaction_at,\n              created_at\n            ").gte("last_interaction_at",n).not("category","eq","Skip").not("category","eq","Inbox").not("category","eq","WhatsApp Group Contact").order("last_interaction_at",{ascending:!1,nullsFirst:!1}).range(e,o)})));let l=[];const c=500;let d=0,p=0;const f=Math.min(n,4e3);for(let o=0;o<f;o+=c)try{r(`Loading contacts... ${Math.min(o+c,n)}/${n}`);const{data:e,error:t}=await a(o,o+c-1);if(t){if(console.error(`Error fetching contacts batch from ${o} to ${o+c-1}:`,t),p++,p>3)throw new Error(`Too many failed batches (${p}). Last error: ${t.message}`);continue}e&&e.length>0&&(l=[...l,...e],d+=e.length)}catch(e){if(console.error(`Error in batch fetch loop at index ${o}:`,e),0===d)throw e;break}console.log(`Successfully fetched ${d} contacts in ${Math.ceil(d/c)} batches with ${p} failed batches`);const g=l;if(!g||0===g.length)return o([]),void r(!1);const m=g.map((e=>e.contact_id)).filter(Boolean);if(0===m.length)return o(g),void r(!1);r("Loading related data (companies, tags, cities)...");const y=async function(t,o,n){let i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:100;console.log(`Fetching ${t} data for ${n.length} contacts in batches of ${i}`);let a=[];for(let s=0;s<n.length;s+=i){const l=n.slice(s,s+i);try{const{data:e,error:c}=await o.in("contact_id",l);if(c)throw c;a=[...a,...e||[]],r(`Loading ${t} data... ${Math.min(s+i,n.length)}/${n.length}`)}catch(e){console.error(`Error fetching batch of ${t} data:`,e)}}return{data:a}},v=async function(t,o,n,i,a){let s=arguments.length>5&&void 0!==arguments[5]?arguments[5]:100;console.log(`Fetching ${t} details for ${i.length} entities in batches of ${s}`);let l=[];for(let c=0;c<i.length;c+=s){const d=i.slice(c,c+s);try{const{data:e,error:u}=await D.supabase.from(o).select(a).in(n,d);if(u)throw u;l=[...l,...e||[]],r(`Loading ${t} details... ${Math.min(c+s,i.length)}/${i.length}`)}catch(e){console.error(`Error fetching batch of ${t} details:`,e)}}return{data:l}};try{const[e,t,n,i,a]=await Promise.all([y("companies",D.supabase.from("contact_companies").select("contact_id, company_id"),m),y("tags",D.supabase.from("contact_tags").select("contact_id, tag_id"),m),y("cities",D.supabase.from("contact_cities").select("contact_id, city_id"),m),y("emails",D.supabase.from("contact_emails").select("contact_id, email, is_primary"),m),y("mobiles",D.supabase.from("contact_mobiles").select("contact_id, mobile, is_primary"),m)]),s=[...new Set((e.data||[]).map((e=>e.company_id)).filter(Boolean))],l=[...new Set((t.data||[]).map((e=>e.tag_id)).filter(Boolean))],c=[...new Set((n.data||[]).map((e=>e.city_id)).filter(Boolean))];r("Loading details for related data...");const[d,p,f]=await Promise.all([s.length>0?v("companies","companies","company_id",s,"company_id, name, website"):{data:[]},l.length>0?v("tags","tags","tag_id",l,"tag_id, name"):{data:[]},c.length>0?v("cities","cities","city_id",c,"city_id, name"):{data:[]}]);r("Processing data and preparing contacts...");const b=g.map(((o,s)=>{var l,c;if(!o||!o.contact_id)return console.warn("Skipping invalid contact:",o),null;s>0&&s%1e3===0&&r(`Processing contacts... ${s}/${g.length}`);const u=(e.data||[]).filter((e=>(null===e||void 0===e?void 0:e.contact_id)===o.contact_id)),h=(t.data||[]).filter((e=>(null===e||void 0===e?void 0:e.contact_id)===o.contact_id)),m=(n.data||[]).filter((e=>(null===e||void 0===e?void 0:e.contact_id)===o.contact_id)),y=(i.data||[]).filter((e=>(null===e||void 0===e?void 0:e.contact_id)===o.contact_id)),v=(a.data||[]).filter((e=>(null===e||void 0===e?void 0:e.contact_id)===o.contact_id)),b=y.find((e=>null===e||void 0===e?void 0:e.is_primary)),x=(null===b||void 0===b?void 0:b.email)||(y.length>0?null===(l=y[0])||void 0===l?void 0:l.email:null),w=v.find((e=>null===e||void 0===e?void 0:e.is_primary)),C=(null===w||void 0===w?void 0:w.mobile)||(v.length>0?null===(c=v[0])||void 0===c?void 0:c.mobile:null),_=u.map((e=>{var t;if(null===e||void 0===e||!e.company_id)return null;const o=null===(t=d.data)||void 0===t?void 0:t.find((t=>(null===t||void 0===t?void 0:t.company_id)===e.company_id));return o?{id:o.company_id,name:o.name||"Unknown",website:o.website}:null})).filter(Boolean),S=h.map((e=>{var t;if(null===e||void 0===e||!e.tag_id)return null;const o=null===(t=p.data)||void 0===t?void 0:t.find((t=>(null===t||void 0===t?void 0:t.tag_id)===e.tag_id));return o?{id:o.tag_id,name:o.name||"Unknown Tag"}:null})).filter(Boolean),E=m.map((e=>{var t;if(null===e||void 0===e||!e.city_id)return null;const o=null===(t=f.data)||void 0===t?void 0:t.find((t=>(null===t||void 0===t?void 0:t.city_id)===e.city_id));return o?{id:o.city_id,name:o.name||"Unknown Location"}:null})).filter(Boolean);return{...o,id:o.contact_id,email:x||null,mobile:C||null,companies:_||[],tags:S||[],cities:E||[]}})).filter(Boolean);console.log(`Successfully processed ${b.length} contacts out of ${g.length} total`),o(b),r(!1),u(!0),setTimeout((()=>{h(!0)}),800)}catch(e){console.error("Error loading related data:",e);const t=g.map((e=>({...e,id:e.contact_id,companies:[],tags:[],cities:[]})));o(t),r(!1),u(!0),setTimeout((()=>{h(!0)}),800)}}catch(e){console.error("Error fetching contacts:",e),s(e.message),r(!1)}})())}),[d]),(0,t.useEffect)((()=>{if(!l)return;const e=()=>{l.sizeColumnsToFit()};return window.addEventListener("resize",e,{passive:!0}),()=>{window.removeEventListener("resize",e,{passive:!0})}}),[l]),(0,N.jsxs)(pC,{children:[a&&(0,N.jsxs)(hC,{children:["Error: ",a]}),!1!==n?(0,N.jsxs)(fC,{children:[(0,N.jsx)(mC,{children:"string"===typeof n?n.replace(/Loading .+ \d+\/\d+/,"Initializing Matrix"):"Accessing Contact Database..."}),(0,N.jsx)(gC,{}),(0,N.jsx)(yC,{})]}):p||a?0!==e.length||a?(0,N.jsx)("div",{className:"ag-theme-alpine",style:{height:"calc(100% - 60px)",width:"calc(100% - 20px)",opacity:p?1:0,transition:"opacity 0.5s ease-in-out","--ag-background-color":"#121212","--ag-odd-row-background-color":"#1a1a1a","--ag-header-background-color":"#222222","--ag-header-foreground-color":"#00ff00","--ag-foreground-color":"#e0e0e0","--ag-row-hover-color":"#2a2a2a","--ag-border-color":"#333333"},children:(0,N.jsx)($w.W,{rowData:e,columnDefs:g,defaultColDef:m,onGridReady:y,onRowClicked:v,rowSelection:"single",animateRows:!0,pagination:!0,paginationPageSize:50,suppressCellFocus:!0,enableCellTextSelection:!0})}):(0,N.jsx)("div",{style:{padding:"40px",textAlign:"center",color:"#00ff00",background:"#121212",borderRadius:"8px"},children:"No contacts found. Try refreshing the page or check database connection."}):(0,N.jsxs)(fC,{children:[(0,N.jsx)(mC,{children:"Preparing interface..."}),(0,N.jsx)(gC,{}),(0,N.jsx)(yC,{})]})]})};var _C=o(4782),SC=o(4473),EC=o(954),kC=o(7309);const jC=P.Ay.div`
  position: fixed;
  top: 0;
  left: 0;
  right: 0;
  bottom: 0;
  background-color: rgba(0, 0, 0, 0.8);
  display: flex;
  justify-content: center;
  align-items: center;
  z-index: 1001; /* Higher than MailingListsModal */
`,AC=P.Ay.div`
  background-color: #111;
  border: 2px solid #00ff00;
  border-radius: 8px;
  width: 90%;
  max-width: 1200px;
  height: 80%;
  max-height: 800px;
  display: flex;
  flex-direction: column;
  position: relative;
`,RC=P.Ay.div`
  display: flex;
  justify-content: space-between;
  align-items: center;
  padding: 20px;
  border-bottom: 1px solid #333;
  background-color: #000;
`,OC=P.Ay.h2`
  color: #00ff00;
  font-family: 'Courier New', monospace;
  font-size: 24px;
  font-weight: bold;
  margin: 0;
  text-transform: uppercase;
  letter-spacing: 2px;
`,TC=P.Ay.button`
  background: none;
  border: none;
  color: #00ff00;
  font-size: 24px;
  cursor: pointer;
  padding: 5px;
  
  &:hover {
    color: #ffffff;
  }
`,DC=P.Ay.div`
  flex: 1;
  display: flex;
  background-color: #111;
  overflow: hidden;
`,PC=P.Ay.div`
  width: 200px;
  background-color: #000;
  border-right: 1px solid #333;
  padding: 20px;
  display: flex;
  flex-direction: column;
  gap: 10px;
`,NC=P.Ay.button`
  background-color: ${e=>e.$active?"#00ff00":"#111"};
  border: 2px solid ${e=>e.$active?"#00ff00":"#333"};
  color: ${e=>e.$active?"#000":"#ffffff"};
  padding: 15px 10px;
  font-family: 'Courier New', monospace;
  font-size: 14px;
  font-weight: bold;
  text-transform: uppercase;
  letter-spacing: 1px;
  cursor: pointer;
  border-radius: 4px;
  transition: all 0.2s ease;
  text-align: center;
  
  &:hover {
    border-color: #00ff00;
    color: ${e=>e.$active?"#000":"#00ff00"};
  }
`,IC=P.Ay.div`
  flex: 1;
  padding: 20px;
  display: flex;
  flex-direction: column;
  gap: 20px;
  overflow-y: auto;
`,MC=P.Ay.div`
  display: flex;
  flex-direction: column;
  gap: 10px;
`,LC=P.Ay.label`
  color: #ffffff;
  font-family: 'Courier New', monospace;
  font-size: 16px;
  font-weight: bold;
  text-transform: uppercase;
`,FC=P.Ay.input`
  background-color: #000;
  border: 2px solid #333;
  color: #ffffff;
  padding: 12px 15px;
  font-family: 'Courier New', monospace;
  font-size: 14px;
  border-radius: 4px;
  outline: none;
  transition: all 0.2s ease;
  
  &:focus {
    border-color: #00ff00;
  }
  
  &::placeholder {
    color: #666;
  }
`,GC=P.Ay.div`
  flex: 1;
  display: flex;
  flex-direction: column;
  gap: 10px;
`,zC=P.Ay.div`
  flex: 1;
  background-color: #000;
  border: 2px solid #333;
  border-radius: 4px;
  padding: 20px;
  min-height: 300px;
  display: flex;
  align-items: center;
  justify-content: center;
  position: relative;
`,HC=P.Ay.div`
  color: #666;
  font-family: 'Courier New', monospace;
  font-size: 16px;
  text-align: center;
  text-transform: uppercase;
  letter-spacing: 1px;
`,BC=P.Ay.div`
  display: flex;
  flex-direction: column;
  gap: 15px;
`,VC=P.Ay.div`
  display: flex;
  flex-direction: column;
  gap: 10px;
`,$C=P.Ay.div`
  display: flex;
  gap: 10px;
  flex-wrap: wrap;
`,UC=P.Ay.div`
  background-color: #000;
  border: 2px solid #333;
  color: #ffffff;
  padding: 8px 12px;
  font-family: 'Courier New', monospace;
  font-size: 12px;
  border-radius: 4px;
  min-width: 80px;
  text-align: center;
  text-transform: uppercase;
  letter-spacing: 1px;
`,WC=P.Ay.div`
  margin-top: 5px;
  display: flex;
  flex-wrap: wrap;
  gap: 8px;
`,qC=P.Ay.div`
  background-color: #111;
  border: 1px solid #00ff00;
  color: #00ff00;
  padding: 6px 12px;
  font-family: 'Courier New', monospace;
  font-size: 12px;
  border-radius: 4px;
  cursor: pointer;
  transition: all 0.2s ease;
  
  &:hover {
    background-color: #00ff00;
    color: #000;
  }
`,KC=P.Ay.div`
  display: flex;
  gap: 10px;
`,YC=P.Ay.div`
  background-color: #000;
  border: 2px solid #333;
  color: #ffffff;
  padding: 8px 12px;
  font-family: 'Courier New', monospace;
  font-size: 12px;
  font-weight: bold;
  border-radius: 4px;
  width: 50px;
  height: 35px;
  display: flex;
  align-items: center;
  justify-content: center;
  cursor: pointer;
  transition: all 0.2s ease;
  
  &:hover {
    border-color: #00ff00;
    color: #00ff00;
  }
  
  &.selected {
    background-color: #00ff00;
    color: #000;
    border-color: #00ff00;
  }
`,JC=P.Ay.div`
  display: flex;
  justify-content: flex-end;
  padding: 20px;
  border-top: 1px solid #333;
  background-color: #000;
`,XC=P.Ay.button`
  background-color: #000;
  border: 2px solid #00ff00;
  color: #00ff00;
  padding: 12px 30px;
  font-family: 'Courier New', monospace;
  font-size: 16px;
  font-weight: bold;
  text-transform: uppercase;
  letter-spacing: 1px;
  cursor: pointer;
  border-radius: 4px;
  transition: all 0.2s ease;
  
  &:hover {
    background-color: #00ff00;
    color: #000;
  }
  
  &:disabled {
    opacity: 0.5;
    cursor: not-allowed;
    
    &:hover {
      background-color: #000;
      color: #00ff00;
    }
  }
`,QC=P.Ay.button`
  background-color: #000;
  border: 2px solid #ff4444;
  color: #ff4444;
  padding: 12px 20px;
  font-family: 'Courier New', monospace;
  font-size: 14px;
  font-weight: bold;
  text-transform: uppercase;
  letter-spacing: 1px;
  cursor: pointer;
  border-radius: 4px;
  transition: all 0.2s ease;
  margin-right: 15px;
  
  &:hover {
    background-color: #ff4444;
    color: #000;
  }
  
  &:disabled {
    opacity: 0.5;
    cursor: not-allowed;
    
    &:hover {
      background-color: #000;
      color: #ff4444;
    }
  }
`,ZC=P.Ay.div`
  display: grid;
  grid-template-columns: repeat(auto-fill, minmax(250px, 1fr));
  gap: 10px;
  padding: 10px;
  max-height: 300px;
  overflow-y: auto;
`,e_=P.Ay.div`
  background: #000;
  border: 1px solid #333;
  padding: 10px;
  border-radius: 4px;
  font-family: 'Courier New', monospace;
`,t_=P.Ay.div`
  color: #00ff00;
  font-weight: bold;
  font-size: 12px;
  margin-bottom: 4px;
`,o_=P.Ay.div`
  color: #ccc;
  font-size: 11px;
`,n_=P.Ay.select`
  background-color: #000;
  border: 2px solid #333;
  color: #ffffff;
  padding: 12px 15px;
  font-family: 'Courier New', monospace;
  font-size: 14px;
  border-radius: 4px;
  outline: none;
  transition: all 0.2s ease;
  cursor: pointer;
  
  &:focus {
    border-color: #00ff00;
  }
  
  option {
    background-color: #000;
    color: #ffffff;
    padding: 8px;
  }
`,r_=P.Ay.div`
  display: flex;
  gap: 10px;
  flex-wrap: wrap;
`,i_=P.Ay.div`
  max-height: 300px;
  overflow-y: auto;
  border: 2px solid #333;
  border-radius: 4px;
  background-color: #000;
`,a_=P.Ay.div`
  display: flex;
  align-items: center;
  padding: 12px 15px;
  border-bottom: 1px solid #333;
  cursor: pointer;
  transition: all 0.2s ease;
  
  &:hover {
    background-color: #222;
  }
  
  &:last-child {
    border-bottom: none;
  }
`,s_=P.Ay.input`
  margin-right: 12px;
  width: 16px;
  height: 16px;
  accent-color: #00ff00;
  cursor: pointer;
`,l_=P.Ay.div`
  flex: 1;
`,c_=P.Ay.div`
  color: #00ff00;
  font-family: 'Courier New', monospace;
  font-weight: bold;
  font-size: 14px;
  margin-bottom: 4px;
`,d_=P.Ay.div`
  color: #ccc;
  font-family: 'Courier New', monospace;
  font-size: 12px;
`,u_=P.Ay.div`
  display: flex;
  flex-wrap: wrap;
  gap: 8px;
  margin-top: 10px;
`,p_=P.Ay.div`
  background-color: #00ff00;
  color: #000;
  padding: 6px 12px;
  border-radius: 4px;
  font-family: 'Courier New', monospace;
  font-size: 12px;
  font-weight: bold;
  display: flex;
  align-items: center;
  gap: 8px;
  cursor: pointer;
  transition: all 0.2s ease;
  
  &:hover {
    background-color: #00cc00;
  }
`,h_=e=>{let{isOpen:o,onClose:n,onListCreated:r}=e;const[i,a]=(0,t.useState)("static"),[s,l]=(0,t.useState)(""),[c,d]=(0,t.useState)(""),[u,p]=(0,t.useState)(""),[h,f]=(0,t.useState)(""),[g,m]=(0,t.useState)([]),[y,v]=(0,t.useState)(""),[b,x]=(0,t.useState)([]),[w,C]=(0,t.useState)([]),[_,S]=(0,t.useState)([]),[E,k]=(0,t.useState)([]),[j,A]=(0,t.useState)([]),[R,O]=(0,t.useState)(!1),[T,P]=(0,t.useState)(null),[I,M]=(0,t.useState)([]),[L,F]=(0,t.useState)([]),[G,z]=(0,t.useState)(!1),[H,V]=(0,t.useState)(null),[$,U]=(0,t.useState)([]),[W,q]=(0,t.useState)([]),[K,Y]=(0,t.useState)(!1),[J,X]=(0,t.useState)(!1),Q=()=>{a("static"),l(""),d(""),p(""),f(""),m([]),v(""),x([]),C([]),S([]),k([]),A([]),O(!1),P(null),M([]),F([]),z(!1),V(null),U([]),q([]),Y(!1),X(!1),n()},Z=e=>{F((t=>t.find((t=>t.contact_id===e.contact_id))?t.filter((t=>t.contact_id!==e.contact_id)):[...t,e]))};(0,t.useEffect)((()=>{"dynamic"===i&&ee()}),[i,g,b,w,_,E]);const ee=async()=>{if("dynamic"===i)try{O(!0),P(null);const e={};if(w.length>0){const t=Math.min(...w),o=Math.max(...w);e.score_range=[t,o]}g.length>0&&(e.city=g),b.length>0&&(e.tags=b),_.length>0&&(e.category=_),E.length>0&&(e.keep_in_touch=E),console.log("Fetching contacts with filters:",e);const{data:t,error:o}=await D.supabase.functions.invoke("get-filtered-contacts",{body:{filters:e}});if(o)throw o;t&&t.contacts?(A(t.contacts),console.log("Filtered contacts:",t.contacts.length)):A([])}catch(e){console.error("Error fetching filtered contacts:",e),P(e.message),A([])}finally{O(!1)}},te=async e=>{if(e.trim()&&!g.includes(e.trim()))try{const{data:t,error:o}=await D.supabase.from("cities").select("name").eq("name",e.trim()).single();if(o&&"PGRST116"!==o.code)throw o;if(!t){const{error:t}=await D.supabase.from("cities").insert([{name:e.trim()}]);if(t)throw t;console.log("Created new city:",e.trim())}m((t=>[...t,e.trim()])),f(""),U([])}catch(t){console.error("Error adding city:",t),m((t=>[...t,e.trim()])),f(""),U([])}},oe=async e=>{if(e.trim()&&!b.includes(e.trim()))try{const{data:t,error:o}=await D.supabase.from("tags").select("name").eq("name",e.trim()).single();if(o&&"PGRST116"!==o.code)throw o;if(!t){const{error:t}=await D.supabase.from("tags").insert([{name:e.trim()}]);if(t)throw t;console.log("Created new tag:",e.trim())}x((t=>[...t,e.trim()])),v(""),q([])}catch(t){console.error("Error adding tag:",t),x((t=>[...t,e.trim()])),v(""),q([])}};return o?(0,N.jsx)(jC,{onClick:Q,children:(0,N.jsxs)(AC,{onClick:e=>e.stopPropagation(),children:[(0,N.jsxs)(RC,{children:[(0,N.jsxs)(OC,{children:[(0,N.jsx)(B.pHD,{style:{marginRight:"10px"}}),"Create New List"]}),(0,N.jsx)(TC,{onClick:Q,children:(0,N.jsx)(B.yGN,{})})]}),(0,N.jsxs)(DC,{children:[(0,N.jsxs)(PC,{children:[(0,N.jsx)(NC,{$active:"static"===i,onClick:()=>a("static"),children:"Create Static List"}),(0,N.jsx)(NC,{$active:"dynamic"===i,onClick:()=>a("dynamic"),children:"Create Dynamic List"})]}),(0,N.jsxs)(IC,{children:[(0,N.jsxs)(MC,{children:[(0,N.jsx)(LC,{children:"List Name:"}),(0,N.jsx)(FC,{type:"text",value:s,onChange:e=>l(e.target.value),placeholder:"Enter list name..."})]}),(0,N.jsxs)(MC,{children:[(0,N.jsx)(LC,{children:"List Description:"}),(0,N.jsx)(FC,{type:"text",value:c,onChange:e=>d(e.target.value),placeholder:"Enter list description (optional)..."})]}),"static"===i?(0,N.jsxs)(N.Fragment,{children:[(0,N.jsxs)(MC,{children:[(0,N.jsx)(LC,{children:"Search Contacts:"}),(0,N.jsx)(FC,{type:"text",value:u,onChange:e=>{const t=e.target.value;p(t),(async e=>{if(e.length<2)M([]);else{z(!0),V(null);try{const t=D.supabase.from("contacts").select("\n          contact_id,\n          first_name,\n          last_name,\n          contact_emails!inner (\n            email_id,\n            email,\n            is_primary\n          )\n        ").eq("contact_emails.is_primary",!0).or(`first_name.ilike.%${e}%,last_name.ilike.%${e}%`).limit(25),o=D.supabase.from("contacts").select("\n          contact_id,\n          first_name,\n          last_name,\n          contact_emails!inner (\n            email_id,\n            email,\n            is_primary\n          )\n        ").eq("contact_emails.is_primary",!0).filter("contact_emails.email","ilike",`%${e}%`).limit(25),[n,r]=await Promise.all([t,o]);if(n.error)throw n.error;if(r.error)throw r.error;const i=[...n.data||[],...r.data||[]].filter(((e,t,o)=>t===o.findIndex((t=>t.contact_id===e.contact_id)))).map((e=>{var t,o;return{...e,full_name:`${e.first_name||""} ${e.last_name||""}`.trim(),email:(null===(t=e.contact_emails)||void 0===t||null===(o=t[0])||void 0===o?void 0:o.email)||"No email"}}));M(i.slice(0,50))}catch(t){console.error("Error searching contacts:",t),V(t.message),M([])}finally{z(!1)}}})(t)},placeholder:"Search for contacts by name or email..."})]}),u.length>=2&&(0,N.jsxs)(MC,{children:[(0,N.jsx)(LC,{children:"Search Results:"}),(0,N.jsx)(i_,{children:G?(0,N.jsx)(a_,{children:(0,N.jsx)(HC,{children:"Searching contacts..."})}):H?(0,N.jsx)(a_,{children:(0,N.jsxs)(HC,{style:{color:"#ff4444"},children:["Error: ",H]})}):I.length>0?I.map((e=>(0,N.jsxs)(a_,{onClick:()=>Z(e),children:[(0,N.jsx)(s_,{type:"checkbox",checked:void 0!==L.find((t=>t.contact_id===e.contact_id)),onChange:()=>Z(e)}),(0,N.jsxs)(l_,{children:[(0,N.jsx)(c_,{children:e.full_name}),(0,N.jsx)(d_,{children:e.email})]})]},e.contact_id))):(0,N.jsx)(a_,{children:(0,N.jsxs)(HC,{children:['No contacts found matching "',u,'"']})})})]}),(0,N.jsxs)(GC,{children:[(0,N.jsxs)(LC,{children:["Selected Contacts (",L.length,"):"]}),(0,N.jsx)(zC,{children:L.length>0?(0,N.jsx)(u_,{children:L.map((e=>(0,N.jsxs)(p_,{onClick:()=>Z(e),children:[e.full_name," \xd7"]},e.contact_id)))}):(0,N.jsx)(HC,{children:"No contacts selected. Search and select contacts above."})})]})]}):(0,N.jsxs)(BC,{children:[(0,N.jsxs)(VC,{children:[(0,N.jsx)(LC,{children:"Search Cities:"}),(0,N.jsx)(FC,{type:"text",value:h,onChange:e=>{const t=e.target.value;f(t),(async e=>{if(e.length<1)U([]);else try{const{data:t,error:o}=await D.supabase.from("cities").select("name").ilike("name",`%${e}%`).limit(10);if(o)throw o;const n=t.map((e=>e.name)).filter((e=>e&&!g.includes(e))).slice(0,5);U(n)}catch(t){console.error("Error searching cities:",t),U([])}})(t)},onKeyPress:async e=>{"Enter"===e.key&&(e.preventDefault(),await te(h))},placeholder:"Enter city name and press Enter"}),$.length>0&&(0,N.jsx)(WC,{children:$.map(((e,t)=>(0,N.jsx)(qC,{onClick:()=>(async e=>{await te(e)})(e),children:e},t)))})]}),(0,N.jsxs)(VC,{children:[(0,N.jsx)(LC,{children:"Associated Cities:"}),(0,N.jsxs)($C,{children:[g.map(((e,t)=>(0,N.jsxs)(UC,{onClick:()=>{return t=e,void m((e=>e.filter((e=>e!==t))));var t},style:{cursor:"pointer"},children:[e," \xd7"]},t))),0===g.length&&(0,N.jsx)(UC,{style:{opacity:.5},children:"No cities selected"})]})]}),(0,N.jsxs)(VC,{children:[(0,N.jsx)(LC,{children:"Search Tags:"}),(0,N.jsx)(FC,{type:"text",value:y,onChange:e=>{const t=e.target.value;v(t),(async e=>{if(e.length<1)q([]);else try{const{data:t,error:o}=await D.supabase.from("tags").select("name").ilike("name",`%${e}%`).limit(10);if(o)throw o;const n=t.map((e=>e.name)).filter((e=>e&&!b.includes(e))).slice(0,5);q(n)}catch(t){console.error("Error searching tags:",t),q([])}})(t)},onKeyPress:async e=>{"Enter"===e.key&&(e.preventDefault(),await oe(y))},placeholder:"Enter tag name and press Enter"}),W.length>0&&(0,N.jsx)(WC,{children:W.map(((e,t)=>(0,N.jsx)(qC,{onClick:()=>(async e=>{await oe(e)})(e),children:e},t)))})]}),(0,N.jsxs)(VC,{children:[(0,N.jsx)(LC,{children:"Associated Tags:"}),(0,N.jsxs)($C,{children:[b.map(((e,t)=>(0,N.jsxs)(UC,{onClick:()=>{return t=e,void x((e=>e.filter((e=>e!==t))));var t},style:{cursor:"pointer"},children:[e," \xd7"]},t))),0===b.length&&(0,N.jsx)(UC,{style:{opacity:.5},children:"No tags selected"})]})]}),(0,N.jsxs)(VC,{children:[(0,N.jsx)(LC,{children:"Score:"}),(0,N.jsx)(KC,{children:[1,2,3,4,5].map((e=>(0,N.jsx)(YC,{className:w.includes(e)?"selected":"",onClick:()=>(e=>{C((t=>t.includes(e)?t.filter((t=>t!==e)):[...t,e]))})(e),children:e},e)))})]}),(0,N.jsxs)(VC,{children:[(0,N.jsx)(LC,{children:"Category:"}),(0,N.jsxs)(n_,{value:"",onChange:e=>{const t=e.target.value;t&&!_.includes(t)&&(S((e=>[...e,t])),e.target.value="")},children:[(0,N.jsx)("option",{value:"",children:"Select a category..."}),["Inbox","Rockstars","Professional Investor","Founder","Manager","People I Care"].map((e=>(0,N.jsx)("option",{value:e,children:e},e)))]})]}),(0,N.jsxs)(VC,{children:[(0,N.jsx)(LC,{children:"Selected Categories:"}),(0,N.jsxs)(r_,{children:[_.map(((e,t)=>(0,N.jsxs)(UC,{onClick:()=>{return t=e,void S((e=>e.filter((e=>e!==t))));var t},style:{cursor:"pointer"},children:[e," \xd7"]},t))),0===_.length&&(0,N.jsx)(UC,{style:{opacity:.5},children:"No categories selected"})]})]}),(0,N.jsxs)(VC,{children:[(0,N.jsx)(LC,{children:"Keep in Touch Frequency:"}),(0,N.jsxs)(n_,{value:"",onChange:e=>{const t=e.target.value;t&&!E.includes(t)&&(k((e=>[...e,t])),e.target.value="")},children:[(0,N.jsx)("option",{value:"",children:"Select a frequency..."}),["Weekly","Monthly","Quarterly","Twice per Year","Once per Year","Do not keep in touch","Not Set"].map((e=>(0,N.jsx)("option",{value:e,children:e},e)))]})]}),(0,N.jsxs)(VC,{children:[(0,N.jsx)(LC,{children:"Selected Frequencies:"}),(0,N.jsxs)(r_,{children:[E.map(((e,t)=>(0,N.jsxs)(UC,{onClick:()=>{return t=e,void k((e=>e.filter((e=>e!==t))));var t},style:{cursor:"pointer"},children:[e," \xd7"]},t))),0===E.length&&(0,N.jsx)(UC,{style:{opacity:.5},children:"No frequencies selected"})]})]}),(0,N.jsxs)(GC,{children:[(0,N.jsxs)(LC,{children:["Filtered Contacts (",j.length,"):"]}),(0,N.jsx)(zC,{children:R?(0,N.jsx)(HC,{children:"Loading contacts..."}):T?(0,N.jsxs)(HC,{style:{color:"#ff4444"},children:["Error: ",T]}):j.length>0?(0,N.jsx)(ZC,{children:j.map(((e,t)=>(0,N.jsxs)(e_,{children:[(0,N.jsxs)(t_,{children:[e.first_name," ",e.last_name]}),(0,N.jsx)(o_,{children:e.email||"No email"})]},t)))}):(0,N.jsx)(HC,{children:g.length>0||b.length>0||w.length>0||_.length>0||E.length>0?"No contacts match the selected criteria":"Select cities, tags, scores, categories, or frequencies to filter contacts"})})]})]})]})]}),(0,N.jsxs)(JC,{children:["dynamic"===i&&(0,N.jsx)(QC,{onClick:()=>{m([]),x([]),C([]),S([]),k([]),A([]),P(null),O(!1)},disabled:0===g.length&&0===b.length&&0===w.length&&0===_.length&&0===E.length,children:"Clear All Filters"}),(0,N.jsx)(XC,{onClick:async()=>{if(s.trim())if("dynamic"!==i||0!==j.length)if("static"!==i||0!==L.length)try{console.log("Creating email list:",{type:i,name:s.trim(),cities:g,tags:b,scores:w});const e={name:s.trim(),description:c.trim()||`${i} list with ${g.length} cities, ${b.length} tags, ${_.length} categories, ${E.length} frequencies`,listType:i,queryFilters:"dynamic"===i?{cities:g,tags:b,scores:w,categories:_,keepInTouch:E}:null};if("dynamic"===i){const t=j.map((e=>e.contact_id));e.contactIds=t,console.log("Sending contact IDs for dynamic list:",t.length)}else{const t=L.map((e=>e.contact_id));e.contactIds=t,console.log("Sending contact IDs for static list:",t.length)}const{data:t,error:o}=await D.supabase.functions.invoke("create-email-list",{body:e});if(o)throw o;const n=t.list,a=n.list_id||n.email_list_id||n.uuid||n.id;if(!a)throw new Error("No list ID returned from create-email-list function");if(console.log("Email list created with ID:",a),g.length>0){const e=g.map((e=>({list_id:a,city_name:e}))),{error:t}=await D.supabase.from("lists_cities").insert(e);t?console.error("Error creating city associations:",t):console.log("Created city associations:",e.length)}if(b.length>0){const e=b.map((e=>({list_id:a,tag_name:e}))),{error:t}=await D.supabase.from("emaillist_tags").insert(e);t?console.error("Error creating tag associations:",t):console.log("Created tag associations:",e.length)}alert(`Email list "${s.trim()}" created successfully!`),r&&r(),Q()}catch(e){console.error("Error creating email list:",e),alert(`Error creating email list: ${e.message}`)}else alert("Static list requires at least one contact. Please search and select contacts.");else alert("Dynamic list has no matching contacts. Please adjust your filters or switch to static list.");else alert("Please enter a list name")},disabled:!s.trim(),children:"Create"})]})]})}):null},f_=P.Ay.div`
  position: fixed;
  top: 0;
  left: 0;
  right: 0;
  bottom: 0;
  background-color: rgba(0, 0, 0, 0.8);
  display: flex;
  justify-content: center;
  align-items: center;
  z-index: 1002; /* Higher than other modals */
`,g_=P.Ay.div`
  background-color: #111;
  border: 2px solid #00ff00;
  border-radius: 8px;
  width: 90%;
  max-width: 1000px;
  height: 80%;
  max-height: 700px;
  display: flex;
  flex-direction: column;
  position: relative;
  box-sizing: border-box;
  overflow: hidden;
`,m_=P.Ay.div`
  display: flex;
  justify-content: space-between;
  align-items: center;
  padding: 20px;
  border-bottom: 1px solid #333;
  background-color: #000;
`,y_=P.Ay.h2`
  color: #00ff00;
  font-family: 'Courier New', monospace;
  font-size: 20px;
  font-weight: bold;
  margin: 0;
  text-transform: uppercase;
  letter-spacing: 2px;
  display: flex;
  align-items: center;
  gap: 10px;
`,v_=P.Ay.button`
  background: none;
  border: none;
  color: #00ff00;
  font-size: 24px;
  cursor: pointer;
  padding: 5px;
  
  &:hover {
    color: #ffffff;
  }
`,b_=P.Ay.div`
  flex: 1;
  padding: 20px;
  overflow-y: auto;
  background-color: #111;
  box-sizing: border-box;
  width: 100%;
`,x_=P.Ay.div`
  display: flex;
  justify-content: space-between;
  align-items: center;
  margin-bottom: 20px;
  padding-bottom: 10px;
  border-bottom: 1px solid #333;
`,w_=P.Ay.div`
  color: #00ff00;
  font-family: 'Courier New', monospace;
  font-size: 16px;
  font-weight: bold;
`,C_=P.Ay.div`
  display: grid;
  grid-template-columns: 1fr 1fr;
  gap: 10px;
  
  @media (max-width: 768px) {
    grid-template-columns: 1fr;
  }
`,__=P.Ay.div`
  display: grid;
  grid-template-columns: 1fr 1fr;
  gap: 10px;
  margin-bottom: 15px;
  padding: 10px;
  background-color: #000;
  border: 1px solid #333;
  border-radius: 4px;
  
  @media (max-width: 768px) {
    grid-template-columns: 1fr;
  }
`,S_=P.Ay.div`
  color: #00ff00;
  font-family: 'Courier New', monospace;
  font-size: 14px;
  font-weight: bold;
  text-transform: uppercase;
  letter-spacing: 1px;
`,E_=P.Ay.div`
  background-color: #000;
  border: 1px solid #333;
  border-radius: 4px;
  padding: 15px;
  transition: all 0.2s ease;
  
  &:hover {
    border-color: #00ff00;
  }
`,k_=P.Ay.div`
  display: flex;
  flex-direction: column;
  gap: 8px;
`,j_=P.Ay.div`
  color: #ffffff;
  font-family: 'Courier New', monospace;
  font-size: 16px;
  font-weight: bold;
  display: flex;
  align-items: center;
  justify-content: space-between;
  gap: 8px;
`,A_=P.Ay.div`
  display: flex;
  align-items: center;
  gap: 8px;
`,R_=P.Ay.button`
  background: none;
  border: none;
  color: #666;
  cursor: pointer;
  padding: 4px;
  border-radius: 4px;
  transition: all 0.2s ease;
  display: flex;
  align-items: center;
  
  &:hover {
    color: #ff0000;
    background-color: rgba(255, 0, 0, 0.1);
  }
`,O_=P.Ay.div`
  color: #cccccc;
  font-family: 'Courier New', monospace;
  font-size: 14px;
  display: flex;
  align-items: center;
  gap: 8px;
`,T_=P.Ay.div`
  color: #00ff00;
  font-family: 'Courier New', monospace;
  text-align: center;
  padding: 40px;
  font-size: 18px;
`,D_=P.Ay.div`
  color: #666;
  font-family: 'Courier New', monospace;
  text-align: center;
  padding: 40px;
  font-size: 16px;
`,P_=P.Ay.button`
  background-color: #000;
  border: 2px solid #00ff00;
  color: #00ff00;
  padding: 8px 16px;
  font-family: 'Courier New', monospace;
  font-size: 12px;
  font-weight: bold;
  text-transform: uppercase;
  letter-spacing: 1px;
  cursor: pointer;
  border-radius: 4px;
  transition: all 0.2s ease;
  display: flex;
  align-items: center;
  gap: 6px;
  
  &:hover {
    background-color: #00ff00;
    color: #000;
  }
`,N_=P.Ay.div`
  background-color: #000;
  border: 2px solid #333;
  border-radius: 4px;
  padding: 20px;
  margin-bottom: 20px;
  display: ${e=>e.$show?"block":"none"};
  box-sizing: border-box;
  width: 100%;
`,I_=P.Ay.input`
  background-color: #111;
  border: 2px solid #333;
  color: #ffffff;
  padding: 10px 15px;
  font-family: 'Courier New', monospace;
  font-size: 14px;
  border-radius: 4px;
  outline: none;
  transition: all 0.2s ease;
  width: 100%;
  margin-bottom: 15px;
  box-sizing: border-box;
  
  &:focus {
    border-color: #00ff00;
  }
  
  &::placeholder {
    color: #666;
  }
`,M_=P.Ay.div`
  max-height: 200px;
  overflow-y: auto;
  border: 1px solid #333;
  border-radius: 4px;
  background-color: #111;
`,L_=P.Ay.div`
  padding: 10px 15px;
  border-bottom: 1px solid #333;
  cursor: pointer;
  transition: all 0.2s ease;
  
  &:hover {
    background-color: #222;
    border-left: 3px solid #00ff00;
  }
  
  &:last-child {
    border-bottom: none;
  }
`,F_=P.Ay.div`
  color: #00ff00;
  font-family: 'Courier New', monospace;
  font-size: 14px;
  font-weight: bold;
`,G_=P.Ay.div`
  color: #ccc;
  font-family: 'Courier New', monospace;
  font-size: 12px;
`,z_=P.Ay.div`
  display: flex;
  gap: 10px;
  margin-top: 15px;
`,H_=P.Ay.button`
  background-color: #111;
  border: 2px solid #666;
  color: #ccc;
  padding: 8px 16px;
  font-family: 'Courier New', monospace;
  font-size: 12px;
  font-weight: bold;
  text-transform: uppercase;
  cursor: pointer;
  border-radius: 4px;
  transition: all 0.2s ease;
  
  &:hover {
    border-color: #999;
    color: #fff;
  }
`,B_=e=>{let{isOpen:o,onClose:n,onListUpdated:r,emailList:i}=e;const[a,s]=(0,t.useState)([]),[l,c]=(0,t.useState)(!0),[d,u]=(0,t.useState)(null),[p,h]=(0,t.useState)(!1),[f,g]=(0,t.useState)(""),[m,y]=(0,t.useState)([]),[v,b]=(0,t.useState)(!1),[x,w]=(0,t.useState)(!1);(0,t.useEffect)((()=>{o&&i&&_()}),[o,i]),(0,t.useEffect)((()=>{f.length>=2?C():y([])}),[f]);const C=async()=>{try{b(!0);const e=a.map((e=>e.contact_id));let t=D.supabase.from("contacts").select("\n          contact_id,\n          first_name,\n          last_name,\n          contact_emails!inner(email, is_primary)\n        ");if(f.includes("@"))t=t.ilike("contact_emails.email",`%${f}%`);else{const e=f.trim().split(/\s+/);if(1===e.length)t=t.or(`first_name.ilike.%${e[0]}%,last_name.ilike.%${e[0]}%`);else if(e.length>=2){const o=e[0],n=e.slice(1).join(" ");t=t.or(`and(first_name.ilike.%${o}%,last_name.ilike.%${n}%),and(first_name.ilike.%${n}%,last_name.ilike.%${o}%),first_name.ilike.%${f}%,last_name.ilike.%${f}%`)}}e.length>0&&(t=t.not("contact_id","in",`(${e.join(",")})`)),t=t.limit(10);const{data:o,error:n}=await t;if(n)throw n;const r=(null===o||void 0===o?void 0:o.map((e=>{var t,o;const n=(null===(t=e.contact_emails.find((e=>e.is_primary)))||void 0===t?void 0:t.email)||(null===(o=e.contact_emails[0])||void 0===o?void 0:o.email)||"No email";return{contact_id:e.contact_id,name:`${e.first_name||""} ${e.last_name||""}`.trim()||"Unknown Name",email:n,first_name:e.first_name,last_name:e.last_name}})))||[];y(r)}catch(e){console.error("Error searching contacts:",e),y([])}finally{b(!1)}},_=async()=>{try{var e;c(!0),u(null);const t=i.list_id||i.email_list_id||i.uuid||i.id;if(!t)throw new Error("No valid list ID found");console.log("Fetching members for list ID:",t);const{data:o,error:n}=await D.supabase.from("email_list_members").select("*").limit(1);let r,a;o&&o.length>0&&(console.log("Email list members table structure:",Object.keys(o[0])),console.log("Sample record:",o[0]));const l=await D.supabase.from("email_list_members").select("\n          *,\n          contacts!inner (\n            contact_id,\n            first_name,\n            last_name\n          )\n        ").eq("list_id",t);if(l.error&&"42703"===l.error.code){const e=await D.supabase.from("email_list_members").select("\n            *,\n            contacts!inner (\n              contact_id,\n              first_name,\n              last_name\n            )\n          ").eq("email_list_uuid",t);if(e.error&&"42703"===e.error.code){const e=await D.supabase.from("email_list_members").select("\n              *,\n              contacts!inner (\n                contact_id,\n                first_name,\n                last_name\n              )\n            ").eq("uuid",t);r=e.data,a=e.error}else r=e.data,a=e.error}else r=l.data,a=l.error;if(a)throw a;const d=(null===(e=r)||void 0===e?void 0:e.map((e=>{var t,o;return{id:e.id||e.list_member_id||e.uuid,name:`${(null===(t=e.contacts)||void 0===t?void 0:t.first_name)||""} ${(null===(o=e.contacts)||void 0===o?void 0:o.last_name)||""}`.trim()||"Unknown Name",email:e.email_address||"No email",contact_id:e.contact_id,contact:e.contacts,_originalMember:e}})))||[];s(d)}catch(t){console.error("Error fetching email list members:",t),u(t.message)}finally{c(!1)}};return o?(0,N.jsx)(f_,{onClick:n,children:(0,N.jsxs)(g_,{onClick:e=>e.stopPropagation(),children:[(0,N.jsxs)(m_,{children:[(0,N.jsxs)(y_,{children:[(0,N.jsx)(B.pHD,{}),(null===i||void 0===i?void 0:i.name)||"Email List"," - Members"]}),(0,N.jsx)(v_,{onClick:n,children:(0,N.jsx)(B.yGN,{})})]}),(0,N.jsxs)(b_,{children:[(0,N.jsxs)(x_,{children:[(0,N.jsxs)(w_,{children:["Total Contacts: ",a.length]}),(0,N.jsxs)(P_,{onClick:()=>h(!p),children:[(0,N.jsx)(B.GGD,{size:14}),"ADD NEW"]})]}),(0,N.jsxs)(N_,{$show:p,children:[(0,N.jsx)(I_,{type:"text",placeholder:"Search contacts by name or email...",value:f,onChange:e=>g(e.target.value)}),v&&(0,N.jsx)("div",{style:{color:"#00ff00",textAlign:"center",padding:"10px"},children:"Searching..."}),m.length>0&&(0,N.jsx)(M_,{children:m.map((e=>(0,N.jsxs)(L_,{onClick:()=>(async e=>{try{w(!0);const t=i.list_id||i.email_list_id||i.uuid||i.id;if(!t)throw new Error("No valid list ID found");const o={list_id:t,contact_id:e.contact_id,email_address:e.email,added_at:(new Date).toISOString()};let n;if(n=await D.supabase.from("email_list_members").insert([o]).select(),n.error&&"42703"===n.error.code){const e={...o,email_list_uuid:t};delete e.list_id,n=await D.supabase.from("email_list_members").insert([e]).select()}if(n.error&&"42703"===n.error.code){const e={...o,email_list_id:t};delete e.list_id,n=await D.supabase.from("email_list_members").insert([e]).select()}if(n.error)throw n.error;const l=a.length+1;let c;c=await D.supabase.from("email_lists").update({total_contacts:l}).eq("list_id",t),c.error&&"42703"===c.error.code&&(c=await D.supabase.from("email_lists").update({total_contacts:l}).eq("email_list_id",t)),c.error&&"42703"===c.error.code&&(c=await D.supabase.from("email_lists").update({total_contacts:l}).eq("uuid",t));const d={id:n.data[0].id||n.data[0].list_member_id,name:e.name,email:e.email,contact_id:e.contact_id,contact:{first_name:e.first_name,last_name:e.last_name}};s((e=>[...e,d])),y((t=>t.filter((t=>t.contact_id!==e.contact_id)))),g(""),h(!1),r&&r(),console.log("Contact added successfully")}catch(t){console.error("Error adding contact to list:",t),alert(`Error adding contact: ${t.message}`)}finally{w(!1)}})(e),style:{opacity:x?.5:1,cursor:x?"not-allowed":"pointer"},children:[(0,N.jsx)(F_,{children:e.name}),(0,N.jsx)(G_,{children:e.email})]},e.contact_id)))}),f.length>=2&&!v&&0===m.length&&(0,N.jsx)("div",{style:{color:"#666",textAlign:"center",padding:"20px"},children:"No contacts found or all matching contacts are already in this list"}),(0,N.jsx)(z_,{children:(0,N.jsx)(H_,{onClick:()=>{h(!1),g(""),y([])},children:"CANCEL"})})]}),(0,N.jsxs)(__,{children:[(0,N.jsx)(S_,{children:"Name"}),(0,N.jsx)(S_,{children:"Email"})]}),l?(0,N.jsx)(T_,{children:"Loading contacts..."}):d?(0,N.jsxs)(D_,{children:["Error loading contacts: ",d]}):0===a.length?(0,N.jsx)(D_,{children:"No contacts found in this email list"}):(0,N.jsx)(C_,{children:a.map((e=>(0,N.jsx)(E_,{children:(0,N.jsxs)(k_,{children:[(0,N.jsxs)(j_,{children:[(0,N.jsxs)(A_,{children:[(0,N.jsx)(B.JXP,{size:16}),e.name]}),(0,N.jsx)(R_,{onClick:()=>(async e=>{if(window.confirm(`Are you sure you want to remove "${e.name}" from this email list?`))try{var t,o,n;const l=i.list_id||i.email_list_id||i.uuid||i.id;if(!l)throw new Error("No valid list ID found");const c=e.id||(null===(t=e._originalMember)||void 0===t?void 0:t.id)||(null===(o=e._originalMember)||void 0===o?void 0:o.list_member_id)||(null===(n=e._originalMember)||void 0===n?void 0:n.uuid);if(!c)throw console.error("Member object:",e),new Error("No valid member ID found");let d;if(console.log("Attempting to delete member with ID:",c),d=await D.supabase.from("email_list_members").delete().eq("id",c),d.error&&"42703"===d.error.code&&(d=await D.supabase.from("email_list_members").delete().eq("list_member_id",c)),d.error&&"42703"===d.error.code&&(d=await D.supabase.from("email_list_members").delete().eq("uuid",c)),d.error)throw d.error;const u=a.length-1;let p;p=await D.supabase.from("email_lists").update({total_contacts:u}).eq("list_id",l),p.error&&"42703"===p.error.code&&(p=await D.supabase.from("email_lists").update({total_contacts:u}).eq("email_list_id",l)),p.error&&"42703"===p.error.code&&(p=await D.supabase.from("email_lists").update({total_contacts:u}).eq("uuid",l)),s((t=>t.filter((t=>t.id!==e.id)))),r&&r(),console.log("Contact removed successfully")}catch(l){console.error("Error removing contact from list:",l),alert(`Error removing contact: ${l.message}`)}})(e),title:`Remove ${e.name} from this list`,children:(0,N.jsx)(B.IXo,{size:16})})]}),(0,N.jsxs)(O_,{children:[(0,N.jsx)(B.pHD,{size:14}),e.email]})]})},e.id)))})]})]})}):null},V_=P.Ay.div`
  height: calc(100vh - 60px);
  width: 100%;
  padding: 0 5px 0 0;
  overflow: hidden;
  box-sizing: border-box;
  max-width: 100%;
  position: relative;
  background-color: #111;
`,$_=P.Ay.div`
  display: flex;
  justify-content: space-between;
  align-items: center;
  padding: 20px;
  background-color: #000;
  border-bottom: 1px solid #333;
`,U_=P.Ay.h2`
  color: #00ff00;
  font-family: 'Courier New', monospace;
  font-size: 24px;
  font-weight: bold;
  margin: 0;
  text-transform: uppercase;
  letter-spacing: 2px;
  display: flex;
  align-items: center;
  
  svg {
    margin-right: 10px;
  }
`,W_=P.Ay.button`
  background-color: #000;
  border: 2px solid #00ff00;
  color: #00ff00;
  padding: 10px 20px;
  font-family: 'Courier New', monospace;
  font-size: 14px;
  font-weight: bold;
  text-transform: uppercase;
  letter-spacing: 1px;
  cursor: pointer;
  border-radius: 4px;
  transition: all 0.2s ease;
  display: flex;
  align-items: center;
  gap: 8px;
  
  &:hover {
    background-color: #00ff00;
    color: #000;
  }
`,q_=P.Ay.div`
  flex: 1;
  overflow-y: auto;
  padding: 20px;
  background-color: #111;
`,K_=P.Ay.table`
  width: 100%;
  border-collapse: collapse;
  font-family: 'Courier New', monospace;
`,Y_=P.Ay.thead`
  background-color: #000;
  border-bottom: 2px solid #333;
`,J_=P.Ay.th`
  color: #00ff00;
  padding: 15px 20px;
  text-align: left;
  font-weight: bold;
  text-transform: uppercase;
  letter-spacing: 1px;
  font-size: 14px;
  border-right: 1px solid #333;
  
  &:last-child {
    border-right: none;
  }
`,X_=P.Ay.tbody``,Q_=P.Ay.tr`
  background-color: ${e=>e.$index%2===0?"#111":"#0a0a0a"};
  transition: all 0.2s ease;
  
  &:hover {
    background-color: #1a1a1a;
    border-left: 3px solid #00ff00;
  }
`,Z_=P.Ay.td`
  color: #ffffff;
  padding: 15px 20px;
  border-right: 1px solid #333;
  border-bottom: 1px solid #222;
  font-size: 14px;
  
  &:last-child {
    border-right: none;
  }
`,eS=P.Ay.td`
  color: #ffffff;
  padding: 15px 20px;
  border-right: 1px solid #333;
  border-bottom: 1px solid #222;
  font-size: 14px;
  cursor: pointer;
  transition: all 0.2s ease;
  
  &:hover {
    background-color: #1a1a1a;
    color: #00ff00;
  }
  
  &:last-child {
    border-right: none;
  }
`,tS=P.Ay.input`
  background-color: #000;
  border: 2px solid #00ff00;
  color: #00ff00;
  padding: 8px 12px;
  font-family: 'Courier New', monospace;
  font-size: 14px;
  border-radius: 4px;
  outline: none;
  width: 100%;
  box-sizing: border-box;
  
  &::placeholder {
    color: #666;
  }
`,oS=P.Ay.div`
  display: flex;
  gap: 8px;
  align-items: center;
`,nS=P.Ay.button`
  background-color: #111;
  border: 1px solid #333;
  color: #ffffff;
  padding: 6px 12px;
  font-family: 'Courier New', monospace;
  font-size: 11px;
  font-weight: bold;
  text-transform: uppercase;
  cursor: pointer;
  border-radius: 4px;
  transition: all 0.2s ease;
  display: flex;
  align-items: center;
  gap: 4px;
  
  &:hover {
    border-color: #00ff00;
    color: #00ff00;
  }
  
  &.open {
    &:hover {
      background-color: #00ff00;
      color: #000;
    }
  }
  
  &.toggle {
    &:hover {
      background-color: #00ff00;
      color: #000;
      border-color: #00ff00;
    }
  }
  
  &.delete {
    &:hover {
      background-color: #00ff00;
      color: #000;
      border-color: #00ff00;
    }
  }
`,rS=P.Ay.div`
  display: flex;
  justify-content: center;
  align-items: center;
  height: 300px;
  color: #00ff00;
  font-family: 'Courier New', monospace;
  font-size: 18px;
`,iS=P.Ay.div`
  display: flex;
  justify-content: center;
  align-items: center;
  height: 300px;
  color: #666;
  font-family: 'Courier New', monospace;
  font-size: 16px;
  text-align: center;
`,aS=P.Ay.div`
  display: flex;
  justify-content: center;
  align-items: center;
  height: 300px;
  color: #ff4444;
  font-family: 'Courier New', monospace;
  font-size: 16px;
  text-align: center;
`,sS=P.Ay.span`
  background-color: ${e=>"static"===e.$type?"#1a4d1a":"dynamic"===e.$type?"#4d1a1a":"#333"};
  color: ${e=>"static"===e.$type?"#00ff00":"dynamic"===e.$type?"#ff6666":"#ccc"};
  border: 1px solid ${e=>"static"===e.$type?"#00ff00":"dynamic"===e.$type?"#ff6666":"#666"};
  padding: 4px 8px;
  border-radius: 4px;
  font-family: 'Courier New', monospace;
  font-size: 11px;
  font-weight: bold;
  text-transform: uppercase;
  letter-spacing: 1px;
`,lS=()=>{const[e,o]=(0,t.useState)([]),[n,r]=(0,t.useState)(!0),[i,a]=(0,t.useState)(null),[s,l]=(0,t.useState)(!1),[c,d]=(0,t.useState)(!1),[u,p]=(0,t.useState)(null),[h,f]=(0,t.useState)(null),[g,m]=(0,t.useState)("");(0,t.useEffect)((()=>{y()}),[]);const y=async()=>{try{r(!0),a(null);const{data:e,error:t}=await D.supabase.from("email_lists").select("*").order("created_at",{ascending:!1});if(t)throw t;const n=await Promise.all((e||[]).map((async e=>{const t=e.list_id||e.email_list_id||e.uuid||e.id,{data:o,error:n}=await D.supabase.from("lists_cities").select("city_name").eq("list_id",t),{data:r,error:i}=await D.supabase.from("emaillist_tags").select("tag_name").eq("list_id",t);return{...e,associated_cities:n?[]:(null===o||void 0===o?void 0:o.map((e=>e.city_name)))||[],associated_tags:i?[]:(null===r||void 0===r?void 0:r.map((e=>e.tag_name)))||[]}})));o(n),n&&n.length>0&&(console.log("Email list data structure:",Object.keys(n[0])),console.log("Sample email list with associations:",n[0]))}catch(e){console.error("Error fetching email lists:",e),a(e.message)}finally{r(!1)}},v=(e,t,o)=>{f({listId:e,field:t}),m(o||"")},b=e=>{"Enter"===e.key?x():"Escape"===e.key&&w()},x=async()=>{if(h)try{const{listId:e,field:t}=h;let n;const r={[t]:g};if(n=await D.supabase.from("email_lists").update(r).eq("list_id",e),n.error&&"42703"===n.error.code&&(n=await D.supabase.from("email_lists").update(r).eq("email_list_id",e)),n.error&&"42703"===n.error.code&&(n=await D.supabase.from("email_lists").update(r).eq("uuid",e)),n.error)throw n.error;o((o=>o.map((o=>(o.list_id||o.email_list_id||o.uuid||o.id)===e?{...o,[t]:g}:o)))),f(null),m(""),console.log(`Successfully updated ${t} to: ${g}`)}catch(e){console.error("Error updating email list:",e),alert(`Error updating ${h.field}: ${e.message}`)}},w=()=>{f(null),m("")},C=async(e,t)=>{try{let t;t=await D.supabase.from("email_list_members").select("*",{count:"exact",head:!0}).eq("list_id",e),t.error&&"42703"===t.error.code&&(t=await D.supabase.from("email_list_members").select("*",{count:"exact",head:!0}).eq("email_list_uuid",e)),t.error&&"42703"===t.error.code&&(t=await D.supabase.from("email_list_members").select("*",{count:"exact",head:!0}).eq("email_list_id",e));const o=t.count||0;let n;console.log(`Found ${o} members to delete for list ${e}`),n=await D.supabase.from("email_list_members").delete().eq("list_id",e),n.error&&"42703"===n.error.code&&(n=await D.supabase.from("email_list_members").delete().eq("email_list_uuid",e)),n.error&&"42703"===n.error.code&&(n=await D.supabase.from("email_list_members").delete().eq("email_list_id",e)),n.error?console.warn("Could not delete members (might not exist):",n.error):console.log(`Successfully removed ${o} static list members`),console.log("Converted to dynamic - user will need to set up filters")}catch(o){throw console.error("Error converting static to dynamic:",o),o}},_=async(e,t)=>{try{console.log("Converted to static - list is now ready for manual contact addition")}catch(o){throw console.error("Error converting dynamic to static:",o),o}};return(0,N.jsxs)(V_,{children:[(0,N.jsxs)($_,{children:[(0,N.jsxs)(U_,{children:[(0,N.jsx)(B.pHD,{}),"Mailing Lists"]}),(0,N.jsxs)(W_,{onClick:()=>{l(!0)},children:[(0,N.jsx)(B.GGD,{size:16}),"ADD NEW"]})]}),(0,N.jsx)(q_,{children:(0,N.jsxs)(K_,{children:[(0,N.jsx)(Y_,{children:(0,N.jsxs)("tr",{children:[(0,N.jsx)(J_,{children:"Name"}),(0,N.jsx)(J_,{children:"Description"}),(0,N.jsx)(J_,{children:"Type"}),(0,N.jsx)(J_,{children:"Contacts"}),(0,N.jsx)(J_,{children:"Actions"})]})}),(0,N.jsx)(X_,{children:n?(0,N.jsx)("tr",{children:(0,N.jsx)("td",{colSpan:"5",children:(0,N.jsx)(rS,{children:"Loading mailing lists..."})})}):i?(0,N.jsx)("tr",{children:(0,N.jsx)("td",{colSpan:"5",children:(0,N.jsxs)(aS,{children:["Error loading lists: ",i]})})}):0===e.length?(0,N.jsx)("tr",{children:(0,N.jsx)("td",{colSpan:"5",children:(0,N.jsx)(iS,{children:"No mailing lists found"})})}):e.map(((t,n)=>{const r=t.list_id||t.email_list_id||t.uuid||t.id,i=(null===h||void 0===h?void 0:h.listId)===r&&"name"===(null===h||void 0===h?void 0:h.field),a=(null===h||void 0===h?void 0:h.listId)===r&&"description"===(null===h||void 0===h?void 0:h.field);return(0,N.jsxs)(Q_,{$index:n,children:[(0,N.jsx)(eS,{onDoubleClick:()=>v(r,"name",t.name),title:"Double-click to edit",children:i?(0,N.jsx)(tS,{value:g,onChange:e=>m(e.target.value),onKeyDown:b,onBlur:x,autoFocus:!0,placeholder:"Enter list name"}):t.name||"Unnamed List"}),(0,N.jsx)(eS,{onDoubleClick:()=>v(r,"description",t.description),title:"Double-click to edit",children:a?(0,N.jsx)(tS,{value:g,onChange:e=>m(e.target.value),onKeyDown:b,onBlur:x,autoFocus:!0,placeholder:"Enter description"}):t.description||"No description"}),(0,N.jsx)(Z_,{children:(0,N.jsx)(sS,{$type:t.list_type,children:"static"===t.list_type?"Static":"dynamic"===t.list_type?"Dynamic":"Unknown"})}),(0,N.jsx)(Z_,{children:t.total_contacts||0}),(0,N.jsx)(Z_,{children:(0,N.jsxs)(oS,{children:[(0,N.jsxs)(nS,{className:"open",onClick:()=>(t=>{const o=e.find((e=>e.list_id===t||e.email_list_id===t||e.uuid===t||e.id===t));o&&(p(o),d(!0))})(r),title:"View list contents",children:[(0,N.jsx)(B.Vap,{size:12}),"OPEN"]}),(0,N.jsxs)(nS,{className:"toggle",onClick:()=>(async t=>{try{const r=e.find((e=>e.list_id===t||e.email_list_id===t||e.uuid===t||e.id===t));if(!r)throw new Error("Original list not found");const i=r.list_type,a="static"===i?"dynamic":"static",s=`Are you sure you want to convert this list from ${i} to ${a}?\n\n`+("static"===i?"Converting to dynamic will remove all manually added contacts and use filters instead.":"Converting to static will save current filtered contacts as fixed members.");if(!window.confirm(s))return;console.log(`Converting list from ${i} to ${a}`),"dynamic"===a?await C(t,r):await _(t,r);let l,c=0;if("static"===a)try{let e;e=await D.supabase.from("email_list_members").select("*",{count:"exact",head:!0}).eq("list_id",t),e.error&&"42703"===e.error.code&&(e=await D.supabase.from("email_list_members").select("*",{count:"exact",head:!0}).eq("email_list_uuid",t)),e.error&&"42703"===e.error.code&&(e=await D.supabase.from("email_list_members").select("*",{count:"exact",head:!0}).eq("email_list_id",t)),c=e.count||0}catch(n){console.warn("Could not count members:",n),c=0}if(l=await D.supabase.from("email_lists").update({list_type:a,total_contacts:c,updated_at:(new Date).toISOString()}).eq("list_id",t),l.error&&"42703"===l.error.code&&(l=await D.supabase.from("email_lists").update({list_type:a,total_contacts:c,updated_at:(new Date).toISOString()}).eq("email_list_id",t)),l.error&&"42703"===l.error.code&&(l=await D.supabase.from("email_lists").update({list_type:a,total_contacts:c,updated_at:(new Date).toISOString()}).eq("uuid",t)),l.error)throw l.error;o((e=>e.map((e=>(e.list_id||e.email_list_id||e.uuid||e.id)===t?{...e,list_type:a,total_contacts:c}:e)))),console.log(`Successfully converted list to ${a}`),await y(),alert(`List successfully converted to ${a} type!`)}catch(n){console.error("Error converting list type:",n),alert(`Error converting list type: ${n.message}`)}})(r),title:`Convert to ${"static"===t.list_type?"dynamic":"static"} list`,children:[(0,N.jsx)(B.jTZ,{size:12}),"TOGGLE TYPE"]}),(0,N.jsxs)(nS,{className:"delete",onClick:()=>(async e=>{if(window.confirm("Are you sure you want to delete this email list? This action cannot be undone."))try{let t;if(console.log("Deleting junction table entries for list:",e),await D.supabase.from("lists_cities").delete().eq("list_id",e),await D.supabase.from("emaillist_tags").delete().eq("list_id",e),t=await D.supabase.from("email_lists").delete().eq("list_id",e),t.error&&"42703"===t.error.code&&(t=await D.supabase.from("email_lists").delete().eq("email_list_id",e)),t.error&&"42703"===t.error.code&&(t=await D.supabase.from("email_lists").delete().eq("uuid",e)),t.error)throw t.error;o((t=>t.filter((t=>t.list_id!==e&&t.email_list_id!==e&&t.uuid!==e&&t.id!==e)))),console.log("Email list and associations deleted successfully")}catch(t){console.error("Error deleting email list:",t),alert(`Error deleting email list: ${t.message}`)}})(r),title:"Delete this list",children:[(0,N.jsx)(B.IXo,{size:12}),"DELETE"]})]})})]},r)}))})]})}),(0,N.jsx)(h_,{isOpen:s,onClose:()=>l(!1),onListCreated:y}),(0,N.jsx)(B_,{isOpen:c,onClose:()=>{d(!1),p(null)},onListUpdated:y,emailList:u})]})},cS=(0,t.lazy)((()=>Promise.resolve().then(o.bind(o,4782)))),dS=(0,t.lazy)((()=>o.e(936).then(o.bind(o,6936)))),uS=P.Ay.div`
  padding: 0;
  margin-top: 0; /* Reset the negative margin */
  height: 100%;
  width: 100%;
  overflow: hidden;
  box-sizing: border-box;
  max-width: 100%;
`,pS=P.Ay.div`
  display: flex;
  background-color: #111;
  border-bottom: 1px solid #333;
  overflow-x: auto;
  scrollbar-width: thin;
  scrollbar-color: #00ff00 #222;
  padding: 8px 0;
  margin-bottom: 0;
  position: sticky;
  top: 0;
  z-index: 100;
  width: 100%;
  
  &::-webkit-scrollbar {
    height: 6px;
  }
  
  &::-webkit-scrollbar-track {
    background: #222;
  }
  
  &::-webkit-scrollbar-thumb {
    background-color: #00ff00;
    border-radius: 3px;
  }
`,hS=P.Ay.div`
  padding: 0px 0px 0px 0px;
  width: 100%;
  overflow: hidden;
  box-sizing: border-box;
  max-width: 100%;
`,fS=P.Ay.div`
  display: flex;
  align-items: center;
  padding: 10px 20px;
  color: ${e=>e.$active?"#00ff00":"#ccc"};
  text-decoration: none;
  border-bottom: 3px solid ${e=>e.$active?"#00ff00":"transparent"};
  margin-right: 20px;
  font-family: 'Courier New', monospace;
  transition: all 0.2s ease;
  white-space: nowrap;
  cursor: pointer;
  font-size: 1rem;
  font-weight: ${e=>e.$active?"bold":"normal"};
  background-color: ${e=>e.$active?"rgba(0, 255, 0, 0.05)":"transparent"};
  border-radius: 4px 4px 0 0;
  
  &:hover {
    color: #00ff00;
    background-color: rgba(0, 255, 0, 0.05);
  }
  
  &:first-child {
    margin-left: 10px;
  }
  
  svg {
    margin-right: 10px;
    font-size: 1.1rem;
  }
`,gS=P.Ay.div`
  width: 100%;
  overflow: hidden;
  box-sizing: border-box;
  max-width: 100%;
`,mS=P.Ay.div`
  display: flex;
  justify-content: center;
  align-items: center;
  height: 300px;
  color: #00ff00;
  font-family: 'Courier New', monospace;
`,yS=()=>{const[e,o]=(0,t.useState)("recent"),n=[{id:"recent",name:"Recent",icon:(0,N.jsx)(B.p45,{})},{id:"keepintouch",name:"Keep in Touch",icon:(0,N.jsx)(B.Ohp,{})},{id:"introductions",name:"Introductions",icon:(0,N.jsx)(B.cfS,{})},{id:"celebrations",name:"Celebrations",icon:(0,N.jsx)(B.YyZ,{})},{id:"planner",name:"Planner",icon:(0,N.jsx)(B.wIk,{})},{id:"mailinglists",name:"Mailing Lists",icon:(0,N.jsx)(B.pHD,{})}];return(0,N.jsxs)(uS,{children:[(0,N.jsx)(pS,{children:n.map((t=>(0,N.jsxs)(fS,{$active:e===t.id,onClick:()=>{return e=t.id,void o(e);var e},children:[t.icon," ",t.name]},t.id)))}),(0,N.jsx)(hS,{children:(0,N.jsx)(gS,{children:(0,N.jsx)(t.Suspense,{fallback:(0,N.jsx)(mS,{children:"Loading..."}),children:(()=>{switch(e){case"recent":return(0,N.jsx)(Lw.A,{category:"recent-30-days"});case"keepintouch":return(0,N.jsx)(cS,{});case"introductions":return(0,N.jsx)(dS,{});case"celebrations":return(0,N.jsx)("div",{style:{color:"#00ff00",textAlign:"center",paddingTop:"100px",fontSize:"20px",fontFamily:"Courier New, monospace"},children:"Celebrations - Coming Soon"});case"planner":return(0,N.jsx)("div",{style:{color:"#00ff00",textAlign:"center",paddingTop:"100px",fontSize:"20px",fontFamily:"Courier New, monospace"},children:"Planner - Coming Soon"});case"mailinglists":return(0,N.jsx)(lS,{});default:return(0,N.jsx)("div",{style:{color:"#00ff00",textAlign:"center",paddingTop:"40px"},children:"Select an interaction type from the menu above"})}})()})})})]})};var vS=o(4762),bS=o(2233);const xS=P.Ay.div`
  display: flex;
  justify-content: space-between;
  align-items: center;
  margin-bottom: 15px;
  padding-bottom: 15px;
  border-bottom: 1px solid #00ff00;

  h2 {
    margin: 0;
    font-size: 1.25rem;
    color: #00ff00;
    font-weight: 600;
  }

  button {
    background: none;
    border: none;
    cursor: pointer;
    color: #00ff00;
    padding: 4px;
    border-radius: 4px;
    
    &:hover {
      color: #fff;
      background-color: rgba(0, 255, 0, 0.2);
    }
  }
`,wS=P.Ay.div`
  margin-bottom: 15px;
`,CS=P.Ay.h3`
  font-size: 16px;
  font-weight: bold;
  color: #00ff00;
  margin-bottom: 12px;
`,_S=P.Ay.div`
  display: flex;
  flex-direction: column;
  flex-wrap: wrap;
  gap: 8px;
  margin-bottom: 16px;
  padding: 5px 0;
  min-height: 32px;
`,SS=P.Ay.div`
  display: flex;
  align-items: center;
  justify-content: space-between;
  padding: 8px 12px;
  background-color: ${e=>e.color||"#222"};
  color: ${e=>e.textColor||"#00ff00"};
  border-radius: 8px;
  font-size: 0.875rem;
  gap: 6px;
  width: 100%;
  border: 1px solid #333;
  margin-bottom: 5px;

  .email-content {
    display: flex;
    align-items: center;
    gap: 8px;
    overflow: hidden;
    flex-grow: 1;
  }

  span {
    white-space: nowrap;
    overflow: hidden;
    text-overflow: ellipsis;
  }

  .actions {
    display: flex;
    gap: 6px;
  }

  button {
    background: none;
    border: none;
    padding: 2px;
    cursor: pointer;
    color: inherit;
    opacity: 0.7;
    display: flex;
    align-items: center;
    justify-content: center;
    flex-shrink: 0;

    &:hover {
      opacity: 1;
    }
  }
`,ES=P.Ay.div`
  margin-bottom: 16px;
`,kS=P.Ay.input`
  width: 100%;
  padding: 10px 12px;
  border: 1px solid #333;
  border-radius: 6px;
  font-size: 0.875rem;
  outline: none;
  transition: border-color 0.2s;
  background-color: #222;
  color: #fff;

  &:focus {
    border-color: #00ff00;
    box-shadow: 0 0 0 3px rgba(0, 255, 0, 0.1);
  }
`,jS=P.Ay.div`
  padding: 10px;
  border-radius: 4px;
  margin-bottom: 15px;
  font-size: 0.875rem;
  border: 1px solid;

  &.success {
    background-color: rgba(0, 255, 0, 0.1);
    color: #00ff00;
    border-color: #00ff00;
  }

  &.error {
    background-color: rgba(255, 0, 0, 0.1);
    color: #ff5555;
    border-color: #ff5555;
  }

  &.info {
    background-color: rgba(0, 170, 255, 0.1);
    color: #00aaff;
    border-color: #00aaff;
  }
`,AS=P.Ay.div`
  display: flex;
  justify-content: flex-end;
  gap: 10px;
  margin-top: 20px;
`,RS=P.Ay.button`
  padding: 8px 16px;
  border-radius: 4px;
  font-size: 0.875rem;
  font-weight: 500;
  cursor: pointer;
  transition: all 0.2s;

  &.primary {
    background-color: #121212;
    color: #00ff00;
    border: 1px solid #00ff00;

    &:hover {
      background-color: rgba(0, 255, 0, 0.2);
    }
  }

  &.secondary {
    background-color: #121212;
    color: #aaa;
    border: 1px solid #333;

    &:hover {
      background-color: #222;
    }
  }

  &:disabled {
    opacity: 0.5;
    cursor: not-allowed;
  }
`,OS=P.Ay.button`
  display: flex;
  align-items: center;
  gap: 6px;
  background-color: #121212;
  color: #00ff00;
  padding: 8px 12px;
  border: 1px solid #00ff00;
  border-radius: 4px;
  font-size: 0.875rem;
  font-weight: 500;
  cursor: pointer;
  transition: all 0.2s;

  &:hover {
    background-color: rgba(0, 255, 0, 0.2);
  }

  &:disabled {
    opacity: 0.5;
    cursor: not-allowed;
  }
`,TS=e=>{let{isOpen:o,onRequestClose:n,contact:r,onUpdateEmails:i}=e;const[a,s]=(0,t.useState)([]),[l,c]=(0,t.useState)(""),[d,u]=(0,t.useState)(!1),[p,h]=(0,t.useState)({type:"",text:""});(0,t.useEffect)((()=>{if(console.log("Modal open:",o),console.log("Contact received:",r),o&&r){console.log("Contact ID:",r.contact_id);(async()=>{try{if(!r.contact_id)return void console.error("No contact_id available");console.log(`About to query contact_emails for contact_id: ${r.contact_id}`);const{data:e,error:t}=await D.supabase.from("contact_emails").select("*").eq("contact_id",r.contact_id);if(t)return void console.error("Error fetching emails:",t);console.log("Raw Supabase response:",e),e?console.log(`Found ${e.length} emails`):console.log("No email data returned"),e?(console.log(`Setting ${e.length} emails`),s(e)):(console.log("No email data returned"),s([]))}catch(e){console.error("Exception fetching emails:",e),console.error("Error details:",e.message,e.stack)}})()}}),[o,r]);return(0,t.useEffect)((()=>{p.text&&setTimeout((()=>{h({type:"",text:""})}),3e3)}),[p]),(0,N.jsx)(ot(),{isOpen:o,onRequestClose:n,style:{content:{top:"50%",left:"50%",right:"auto",bottom:"auto",marginRight:"-50%",transform:"translate(-50%, -50%)",padding:"20px",border:"1px solid #00ff00",borderRadius:"0.5rem",boxShadow:"0 4px 12px rgba(0, 255, 0, 0.2)",maxWidth:"500px",width:"90%",minHeight:"360px",backgroundColor:"#121212",color:"#ffffff"},overlay:{backgroundColor:"rgba(0, 0, 0, 0.8)",zIndex:1e3}},children:(0,N.jsxs)("div",{style:{padding:"1rem"},children:[(0,N.jsxs)(xS,{children:[(0,N.jsx)("h2",{children:"Manage Email Addresses"}),(0,N.jsx)("button",{onClick:n,"aria-label":"Close modal",children:(0,N.jsx)(B.yGN,{size:20})})]}),(0,N.jsxs)(wS,{children:[(0,N.jsx)(CS,{children:"Contact Emails"}),(0,N.jsxs)(_S,{children:[a.map(((e,t)=>{const o=function(){return arguments.length>0&&void 0!==arguments[0]&&arguments[0]?{bg:"rgba(0, 255, 0, 0.15)",text:"#00ff00"}:{bg:"#222",text:"#00ff00"}}(e.is_primary);return(0,N.jsxs)(SS,{color:o.bg,textColor:o.text,children:[(0,N.jsxs)("div",{className:"email-content",children:[(0,N.jsx)(B.pHD,{size:16}),(0,N.jsx)("span",{title:e.email,children:e.email}),e.is_primary&&(0,N.jsx)("span",{style:{fontSize:"0.75rem",backgroundColor:"rgba(0, 255, 0, 0.2)",color:"#00ff00",padding:"2px 6px",borderRadius:"4px",marginLeft:"6px",border:"1px solid #00ff00"},children:"Primary"})]}),(0,N.jsxs)("div",{className:"actions",children:[!e.is_primary&&(0,N.jsx)("button",{onClick:()=>(e=>{try{if(e.is_primary)return;const t=a.map((t=>({...t,is_primary:t.email===e.email})));s(t),h({type:"success",text:"Primary email updated successfully"}),i&&i(t)}catch(t){console.error("Error setting primary email:",t),h({type:"error",text:"Failed to set primary email"})}})(e),disabled:d,title:"Set as primary",style:{color:"#3b82f6"},children:(0,N.jsx)(B.SG1,{size:14})}),(0,N.jsx)("button",{onClick:()=>(e=>{try{const t=a.filter((t=>t.email!==e.email));e.is_primary&&t.length>0&&(t[0].is_primary=!0),s(t),h({type:"success",text:"Email removed successfully"}),i&&i(t)}catch(t){console.error("Error removing email:",t),h({type:"error",text:"Failed to remove email"})}})(e),disabled:d,title:"Remove email",children:(0,N.jsx)(B.yGN,{size:14})})]})]},t)})),0===a.length&&(0,N.jsx)("div",{style:{color:"#aaa",fontStyle:"italic",padding:"4px"},children:"No emails linked to this contact"})]})]}),(0,N.jsxs)(wS,{children:[(0,N.jsx)(CS,{children:"Add New Email"}),(0,N.jsx)(ES,{children:(0,N.jsx)(kS,{type:"email",value:l,onChange:e=>c(e.target.value),placeholder:"example@domain.com","aria-label":"New email address"})}),(0,N.jsxs)(OS,{onClick:()=>{try{if(!/^(([^<>()[\]\\.,;:\s@"]+(\.[^<>()[\]\\.,;:\s@"]+)*)|(".+"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/.test(String(l).toLowerCase()))return void h({type:"error",text:"Please enter a valid email address"});if(a.some((e=>e.email.toLowerCase()===l.toLowerCase())))return void h({type:"info",text:"This email already exists for this contact"});const e={email:l,is_primary:0===a.length},t=[...a,e];s(t),c(""),h({type:"success",text:"Email added successfully"}),i&&i(t)}catch(e){console.error("Error adding email:",e),h({type:"error",text:"Failed to add email"})}},disabled:!l.trim()||d,children:[(0,N.jsx)(B.GGD,{size:16}),"Add Email"]})]}),p.text&&(0,N.jsx)(jS,{className:p.type,children:p.text}),(0,N.jsx)(AS,{children:(0,N.jsx)(RS,{className:"primary",onClick:n,children:"Done"})}),d&&(0,N.jsx)("div",{style:{textAlign:"center",marginTop:"10px"},children:(0,N.jsx)("div",{className:"spinner",style:{width:"20px",height:"20px",border:"3px solid #f3f3f3",borderTop:"3px solid #3b82f6",borderRadius:"50%",animation:"spin 1s linear infinite"}})})]})})},DS=document.createElement("style");DS.innerHTML="\n  @keyframes spin {\n    0% { transform: rotate(0deg); }\n    100% { transform: rotate(360deg); }\n  }\n",document.head.appendChild(DS);var PS=o(9430),NS=o(4462);const IS=P.Ay.div`
  padding: 24px;
  max-height: 80vh;
  overflow-y: auto;
`,MS=P.Ay.div`
  display: flex;
  justify-content: space-between;
  align-items: center;
  margin-bottom: 24px;
  padding-bottom: 16px;
  border-bottom: 1px solid #333;
`,LS=P.Ay.h2`
  margin: 0;
  font-size: 20px;
  font-weight: 600;
  color: #00ff00;
  display: flex;
  align-items: center;
  gap: 8px;
`,FS=P.Ay.span`
  color: #ffffff;
  font-weight: 400;
`,GS=P.Ay.button`
  display: inline-flex;
  align-items: center;
  gap: 8px;
  padding: 8px 16px;
  color: white;
  background-color: ${e=>e.$secondary?"#6c757d":"#00ff00"};
  border: none;
  border-radius: 4px;
  font-size: 14px;
  cursor: pointer;
  transition: all 0.2s;

  &:hover {
    background-color: ${e=>e.$secondary?"#5a6268":"#33ff33"};
  }

  &:disabled {
    background-color: #333;
    color: #666;
    cursor: not-allowed;
  }
`,zS=P.Ay.div`
  display: flex;
  flex-direction: column;
  gap: 16px;
  margin-bottom: 20px;
`,HS=P.Ay.div`
  padding: 16px;
  border: 1px solid #333;
  border-radius: 8px;
  background-color: #1a1a1a;
`,BS=P.Ay.div`
  display: flex;
  justify-content: space-between;
  align-items: center;
  margin-bottom: 12px;
  padding-bottom: 8px;
  border-bottom: 1px solid #333;
`,VS=P.Ay.h4`
  margin: 0;
  font-size: 16px;
  font-weight: 500;
  color: #ffffff;
`,$S=P.Ay.div`
  display: flex;
  align-items: center;
  gap: 4px;
  font-size: 12px;
  color: #888;
`,US=P.Ay.div`
  font-size: 14px;
  color: #e0e0e0;
  line-height: 1.5;
  white-space: pre-wrap;
`,WS=P.Ay.div`
  display: flex;
  justify-content: flex-end;
  gap: 8px;
  margin-top: 12px;
`,qS=P.Ay.button`
  display: inline-flex;
  align-items: center;
  justify-content: center;
  padding: 4px;
  background: none;
  border: none;
  color: #888;
  cursor: pointer;
  transition: all 0.2s;
  border-radius: 4px;
  
  &:hover {
    color: #00ff00;
    background-color: #001100;
  }
`,KS=P.Ay.div`
  margin-top: 20px;
  border: 1px solid #333;
  border-radius: 8px;
  overflow: hidden;
  background-color: #1a1a1a;
`,YS=P.Ay.input`
  width: 100%;
  padding: 12px;
  background-color: #222;
  border: none;
  border-bottom: 1px solid #333;
  color: #ffffff;
  font-size: 16px;
  outline: none;
  
  &::placeholder {
    color: #666;
  }
`,JS=P.Ay.textarea`
  width: 100%;
  min-height: 150px;
  padding: 16px;
  background-color: #1a1a1a;
  border: none;
  color: #ffffff;
  font-size: 14px;
  line-height: 1.5;
  outline: none;
  resize: vertical;
  font-family: inherit;
  
  &::placeholder {
    color: #666;
  }
`,XS=P.Ay.div`
  display: flex;
  justify-content: flex-end;
  gap: 8px;
  padding: 12px;
  background-color: #222;
  border-top: 1px solid #333;
`,QS=P.Ay.div`
  text-align: center;
  padding: 40px 20px;
  color: #888;
`,ZS=e=>{let{isOpen:o,onRequestClose:n,contact:r,onNotesUpdated:i}=e;const[a,s]=(0,t.useState)([]),[l,c]=(0,t.useState)(!1),[d,u]=(0,t.useState)(!1),[p,h]=(0,t.useState)(null),[f,g]=(0,t.useState)(""),[m,y]=(0,t.useState)(""),[v,b]=(0,t.useState)(!1),[x,w]=(0,t.useState)(""),C=(null===r||void 0===r?void 0:r.bio)&&r.bio.trim().length>0,_=()=>{if(!C)return!1;const e=r.bio.trim().toLowerCase();return!["no specific information found","no information found","no bio available","bio not available","no details available","information not available","no data available","not specified","n/a","tbd","to be determined","unknown","no bio","no info"].some((t=>e===t||e.includes(t)))},S=async()=>{if(null!==r&&void 0!==r&&r.contact_id){c(!0);try{const{data:t,error:o}=await D.supabase.from("notes_contacts").select("note_id").eq("contact_id",r.contact_id);if(o)throw o;if(!t||0===t.length)return s([]),void c(!1);const n=t.map((e=>e.note_id)).filter((e=>null!==e&&void 0!==e));if(0===n.length)return s([]),void c(!1);let i=null;const{data:a,error:l}=await D.supabase.from("notes").select("*").in("note_id",n).order("created_at",{ascending:!1});if(l){const{data:e,error:t}=await D.supabase.from("notes").select("*").in("id",n).order("created_at",{ascending:!1});if(t)throw l;i=e}else i=a;const d=(i||[]).map((e=>({...e,id:e.id||e.note_id,content:e.content||e.text||""}))),u=d.map((e=>e.id)),p=n.filter((e=>!u.includes(e)));if(p.length>0){console.log(`Found ${p.length} orphaned note references for contact ${r.contact_id}, cleaning up...`);try{await D.supabase.from("notes_contacts").delete().eq("contact_id",r.contact_id).in("note_id",p)}catch(e){console.error("Error cleaning up orphaned note references:",e)}}s(d)}catch(t){console.error("Error fetching notes:",t),nt.Ay.error("Failed to load notes"),s([])}finally{c(!1)}}},E=e=>{h(e.id),g(e.title),y(e.content)},k=()=>{b(!0),w(r.bio||"")},j=e=>{if(!e)return"Unknown";return new Date(e).toLocaleDateString("en-GB",{day:"2-digit",month:"2-digit",year:"numeric",hour:"2-digit",minute:"2-digit"})};return(0,t.useEffect)((()=>{o&&null!==r&&void 0!==r&&r.contact_id&&S()}),[o,null===r||void 0===r?void 0:r.contact_id]),(0,t.useEffect)((()=>{o||(s([]),u(!1),h(null),g(""),y(""),c(!1),b(!1),w(""))}),[o]),(0,N.jsx)(ot(),{isOpen:o,onRequestClose:n,style:{content:{top:"50%",left:"50%",right:"auto",bottom:"auto",marginRight:"-50%",transform:"translate(-50%, -50%)",width:"600px",maxWidth:"90vw",maxHeight:"90vh",padding:"0",border:"1px solid #333",backgroundColor:"#121212",borderRadius:"8px"},overlay:{backgroundColor:"rgba(0, 0, 0, 0.75)",zIndex:1e3}},children:(0,N.jsxs)(IS,{children:[(0,N.jsxs)(MS,{children:[(0,N.jsxs)(LS,{children:[(0,N.jsx)(B.JXP,{}),"Notes - ",(0,N.jsxs)(FS,{children:[null===r||void 0===r?void 0:r.first_name," ",null===r||void 0===r?void 0:r.last_name]})]}),(0,N.jsxs)(GS,{onClick:()=>u(!0),disabled:d||p,children:[(0,N.jsx)(B.GGD,{size:16}),"Add Note"]})]}),l?(0,N.jsx)("div",{style:{textAlign:"center",padding:"40px 0",color:"#888"},children:"Loading notes..."}):(0,N.jsxs)(N.Fragment,{children:[_()||a.length>0?(0,N.jsxs)(zS,{children:[_()&&(0,N.jsxs)(HS,{children:[(0,N.jsxs)(BS,{children:[(0,N.jsx)(VS,{children:"Contact Bio"}),(0,N.jsxs)($S,{children:[(0,N.jsx)(B.S8s,{size:12}),"Built-in field"]})]}),v?(0,N.jsxs)(N.Fragment,{children:[(0,N.jsx)(JS,{value:x,onChange:e=>w(e.target.value),placeholder:"Enter contact bio...",style:{minHeight:"100px",marginBottom:"12px"}}),(0,N.jsxs)(WS,{children:[(0,N.jsx)(qS,{onClick:()=>{b(!1),w("")},title:"Cancel",children:(0,N.jsx)(B.yGN,{size:14})}),(0,N.jsx)(qS,{onClick:async()=>{if(null!==r&&void 0!==r&&r.contact_id)try{const{error:e}=await D.supabase.from("contacts").update({bio:x.trim()}).eq("contact_id",r.contact_id);if(e)throw e;r.bio=x.trim(),b(!1),w(""),nt.Ay.success("Contact bio updated successfully")}catch(e){console.error("Error updating contact bio:",e),nt.Ay.error("Failed to update contact bio")}},title:"Save Bio",children:(0,N.jsx)(B.Bc_,{size:14})})]})]}):(0,N.jsxs)(N.Fragment,{children:[(0,N.jsx)(US,{onClick:k,style:{cursor:"pointer",transition:"background-color 0.2s ease",padding:"8px",borderRadius:"4px"},onMouseEnter:e=>{e.target.style.backgroundColor="#2a2a2a"},onMouseLeave:e=>{e.target.style.backgroundColor="transparent"},title:"Click to edit contact bio",children:r.bio}),(0,N.jsx)(WS,{children:(0,N.jsx)(qS,{onClick:k,title:"Edit Contact Bio",children:(0,N.jsx)(B.WXf,{size:14})})})]})]}),a.map((e=>(0,N.jsxs)(HS,{children:[(0,N.jsxs)(BS,{children:[(0,N.jsx)(VS,{children:e.title}),(0,N.jsxs)($S,{children:[(0,N.jsx)(B.Ohp,{size:12}),j(e.created_at)]})]}),(0,N.jsx)(US,{onClick:()=>E(e),style:{cursor:"pointer",transition:"background-color 0.2s ease",padding:"8px",borderRadius:"4px"},onMouseEnter:e=>{e.target.style.backgroundColor="#2a2a2a"},onMouseLeave:e=>{e.target.style.backgroundColor="transparent"},title:"Click to edit this note",children:e.content}),(0,N.jsxs)(WS,{children:[(0,N.jsx)(qS,{onClick:()=>E(e),title:"Edit Note",children:(0,N.jsx)(B.WXf,{size:14})}),(0,N.jsx)(qS,{$delete:!0,onClick:()=>(async e=>{if(e&&window.confirm("Are you sure you want to delete this note?"))try{let t=!1;const{error:o}=await D.supabase.from("notes").delete().eq("note_id",e);if(o){const{error:o}=await D.supabase.from("notes").delete().eq("id",e);if(o)throw o;t=!0}else t=!0;t&&(S(),nt.Ay.success("Note deleted successfully"),i&&i())}catch(t){console.error("Error deleting note:",t),nt.Ay.error("Failed to delete note")}})(e.id),title:"Delete Note",children:(0,N.jsx)(B.IXo,{size:14})})]})]},e.id)))]}):d||p?null:(0,N.jsxs)(QS,{children:[(0,N.jsx)(B.jH2,{size:48,style:{marginBottom:"16px",opacity:.5}}),(0,N.jsx)("p",{children:"No notes found for this contact."}),(0,N.jsx)("p",{children:'Click "Add Note" to create the first note.'})]}),(d||p)&&(0,N.jsxs)(KS,{children:[(0,N.jsx)(YS,{type:"text",placeholder:"Note title...",value:f,onChange:e=>g(e.target.value)}),(0,N.jsx)(JS,{placeholder:"Write your note here...",value:m,onChange:e=>y(e.target.value)}),(0,N.jsxs)(XS,{children:[(0,N.jsxs)(GS,{$secondary:!0,onClick:()=>{u(!1),h(null),g(""),y("")},children:[(0,N.jsx)(B.yGN,{size:16}),"Cancel"]}),(0,N.jsxs)(GS,{onClick:p?async()=>{if(p&&m.trim())try{let e=!1;const{error:t}=await D.supabase.from("notes").update({title:f.trim()||"Untitled Note",text:m.trim()}).eq("note_id",p);if(t){const{error:t}=await D.supabase.from("notes").update({title:f.trim()||"Untitled Note",text:m.trim()}).eq("id",p);if(t){const{error:t}=await D.supabase.from("notes").update({title:f.trim()||"Untitled Note",content:m.trim()}).eq("note_id",p);if(t){const{error:t}=await D.supabase.from("notes").update({title:f.trim()||"Untitled Note",content:m.trim()}).eq("id",p);if(t)throw t;e=!0}else e=!0}else e=!0}else e=!0;e&&(g(""),y(""),h(null),S(),nt.Ay.success("Note updated successfully"),i&&i())}catch(e){console.error("Error updating note:",e),nt.Ay.error("Failed to update note")}}:async()=>{if(null!==r&&void 0!==r&&r.contact_id&&m.trim())try{let e=null;const{data:t,error:o}=await D.supabase.from("notes").insert({title:f.trim()||"Untitled Note",text:m.trim()}).select().single();if(o){if(!o.message.includes("text"))throw o;{const{data:t,error:o}=await D.supabase.from("notes").insert({title:f.trim()||"Untitled Note",content:m.trim()}).select().single();if(o)throw o;e=t}}else e=t;const n=e.id||e.note_id;if(!n)throw new Error("Failed to get note ID from created note");const{error:a}=await D.supabase.from("notes_contacts").insert({note_id:n,contact_id:r.contact_id});if(a)throw a;g(""),y(""),u(!1),S(),nt.Ay.success("Note created successfully"),i&&i()}catch(e){console.error("Error creating note:",e),nt.Ay.error("Failed to create note")}},children:[(0,N.jsx)(B.Bc_,{size:16}),p?"Update":"Save"," Note"]})]})]})]})]})})},eE=P.Ay.div`
  padding: 10px 30px 30px 20px;
  width: calc(100% - 50px);
  max-width: calc(100% - 50px);
  margin: 0 auto;
  box-sizing: border-box;
  overflow: hidden;
`,tE=P.Ay.div`
  display: flex;
  justify-content: space-between;
  align-items: center;
  margin-bottom: 30px;
  padding-bottom: 20px;
  border-bottom: 1px solid #333;
  width: 100%;
`,oE=P.Ay.h1`
  color: #00ff00;
  margin: 0;
  font-family: 'Courier New', monospace;
`,nE=P.Ay.button`
  background-color: #222;
  color: #00ff00;
  border: 1px solid #00ff00;
  padding: 10px 20px;
  margin-right: 15px;
  border-radius: 4px;
  cursor: pointer;
  display: flex;
  align-items: center;
  gap: 8px;
  
  &:hover {
    background-color: #333;
  }
`,rE=P.Ay.div`
  display: flex;
  width: 100%;
  gap: 35px;
  box-sizing: border-box;
  margin-top: 30px;
  
  @media (max-width: 992px) {
    flex-direction: column;
    
    > div {
      width: 100% !important;
    }
  }
`,iE=P.Ay.div`
  background-color: #1a1a1a;
  border-radius: 8px;
  border: 1px solid #333;
  padding: 20px;
  margin-bottom: 20px;
  width: 100%;
  max-width: 100%;
  box-sizing: border-box;
  overflow: hidden;
`,aE=P.Ay.h2`
  font-size: 1.2rem;
  color: #00ff00;
  margin-top: 0;
  margin-bottom: 15px;
  display: flex;
  align-items: center;
  gap: 8px;
  
  svg {
    font-size: 1.2rem;
  }
`,sE=P.Ay.div`
  margin-bottom: 12px;
  
  &:last-child {
    margin-bottom: 0;
  }
`,lE=P.Ay.div`
  color: #999;
  font-size: 0.8rem;
  margin-bottom: 2px;
`,cE=P.Ay.div`
  color: #eee;
  font-size: 0.95rem;
`,dE=(0,P.Ay)(cE)`
  font-size: 0.8rem;
  word-break: break-all;
  line-height: 1.3;
`,uE=P.Ay.input`
  background-color: #222;
  color: #eee;
  border: 1px solid #444;
  border-radius: 4px;
  padding: 4px 8px;
  font-size: 0.95rem;
  width: 60px;
  text-align: center;
  
  &:focus {
    outline: none;
    border-color: #00ff00;
  }
`,pE=P.Ay.div`
  padding: 10px;
  border-bottom: 1px solid #333;
  cursor: pointer;
  width: 100%;
  box-sizing: border-box;
  overflow-wrap: break-word;
  word-break: break-word;
  
  &:last-child {
    border-bottom: none;
  }
  
  &:hover {
    background-color: #222;
  }
`,hE=P.Ay.div`
  font-weight: bold;
  color: #eee;
  margin-bottom: 4px;
`,fE=P.Ay.div`
  font-size: 0.85rem;
  color: #999;
`,gE=P.Ay.div`
  display: flex;
  flex-wrap: wrap;
  gap: 6px;
  margin-top: 5px;
`,mE=P.Ay.span`
  background-color: #222;
  color: #00ff00;
  border: 1px solid #00ff00;
  border-radius: 12px;
  padding: 3px 8px;
  font-size: 0.7rem;
  display: inline-flex;
  align-items: center;
  gap: 4px;
`,yE=P.Ay.div`
  display: flex;
  border-bottom: 1px solid #333;
  margin-bottom: 20px;
  width: 100%;
  padding-left: 10px;
`,vE=P.Ay.div`
  padding: 10px 30px;
  margin-right: 15px;
  cursor: pointer;
  color: ${e=>e.active?"#00ff00":"#ccc"};
  border-bottom: 2px solid ${e=>e.active?"#00ff00":"transparent"};
  
  &:hover {
    color: ${e=>e.active?"#00ff00":"#eee"};
  }
`,bE=P.Ay.div`
  display: ${e=>e.active?"block":"none"};
  width: 100%;
  box-sizing: border-box;
  overflow: hidden;
`,xE=P.Ay.div`
  display: flex;
  align-items: center;
  margin-bottom: 15px;
  margin-top: -5px;
  font-size: 0.9rem;
  color: #999;
`,wE=P.Ay.div`
  display: flex;
  flex-direction: column;
  align-items: center;
  justify-content: center;
  height: 70vh;
  color: #00ff00;
`,CE=P.Ay.div`
  padding: 20px;
  background-color: #331111;
  color: #ff5555;
  border-radius: 4px;
  margin: 20px 0;
`,_E=P.Ay.div`
  display: flex;
  align-items: center;
  gap: 4px;
`,SE=P.Ay.input`
  background-color: #222;
  color: #eee;
  border: 1px solid #444;
  border-radius: 4px;
  padding: 4px 8px;
  font-size: 0.95rem;
  width: 140px;
  
  &:focus {
    outline: none;
    border-color: #00ff00;
  }
`,EE=P.Ay.button`
  background: none;
  border: none;
  color: #00ff00;
  cursor: pointer;
  padding: 2px;
  display: flex;
  align-items: center;
  
  &:hover {
    color: #00cc00;
  }
`,kE=P.Ay.button`
  background: none;
  border: none;
  color: #ff5555;
  cursor: pointer;
  padding: 2px;
  display: flex;
  align-items: center;
  
  &:hover {
    color: #ff3333;
  }
`,jE=P.Ay.div`
  display: flex;
  align-items: center;
  gap: 2px;
`,AE=(0,P.Ay)(B.usP)`
  cursor: ${e=>e.clickable?"pointer":"default"};
  color: ${e=>e.filled?"#00ff00":"#666"};
  fill: ${e=>e.filled?"#00ff00":"transparent"};
  transition: color 0.2s ease;
  
  &:hover {
    color: ${e=>e.clickable||e.filled?"#00ff00":"#666"};
  }
`,RE=P.Ay.div`
  display: flex;
  align-items: center;
  gap: 8px;
`,OE=(0,P.Ay)(B.Wjy)`
  cursor: pointer;
  color: ${e=>e.hasLink?"#00ff00":"#666"};
  transition: color 0.2s ease;
  padding: 2px;
  border-radius: 3px;
  outline: none;
  
  &:hover {
    color: ${e=>e.hasLink?"#00cc00":"#888"};
  }
  
  &:focus {
    outline: none;
  }
`,TE=P.Ay.div`
  display: flex;
  align-items: center;
  gap: 8px;
`,DE=P.Ay.button`
  background: none;
  border: none;
  color: #00ff00;
  cursor: pointer;
  padding: 2px;
  display: flex;
  align-items: center;
  font-size: 14px;
  opacity: 0.7;
  transition: all 0.2s ease;
  
  &:hover {
    color: #00cc00;
    opacity: 1;
  }
`,PE=P.Ay.button`
  background: none;
  border: none;
  color: #00ff00;
  cursor: pointer;
  padding: 2px;
  margin-left: 8px;
  display: inline-flex;
  align-items: center;
  font-size: 14px;
  
  &:hover {
    color: #00cc00;
  }
`,NE=P.Ay.input`
  background-color: #222;
  color: #eee;
  border: 1px solid #444;
  border-radius: 4px;
  padding: 4px 8px;
  font-size: 0.95rem;
  width: 100px;
  
  &:focus {
    outline: none;
    border-color: #00ff00;
  }
`,IE=P.Ay.div`
  display: flex;
  align-items: center;
  justify-content: space-between;
  margin-bottom: 2px;
`,ME=P.Ay.div`
  display: flex;
  align-items: center;
  gap: 2px;
  margin-left: 8px;
  opacity: 0;
  transition: opacity 0.2s ease;
`,LE=P.Ay.div`
  display: flex;
  align-items: center;
  justify-content: space-between;
  
  &:hover ${ME} {
    opacity: 1;
  }
`,FE=P.Ay.button`
  background: none;
  border: none;
  color: #ff5555;
  cursor: pointer;
  padding: 2px;
  display: flex;
  align-items: center;
  
  &:hover {
    color: #ff3333;
  }
`,GE=P.Ay.div`
  display: flex;
  align-items: center;
  gap: 1px;
  margin-left: 6px;
  opacity: 0;
  transition: opacity 0.2s ease;
`,zE=P.Ay.div`
  display: flex;
  align-items: center;
  justify-content: space-between;
  
  &:hover ${GE} {
    opacity: 1;
  }
`,HE=P.Ay.button`
  background: none;
  border: none;
  color: #00ff00;
  cursor: pointer;
  padding: 1px;
  display: flex;
  align-items: center;
  font-size: 10px;
  
  &:hover {
    color: #00cc00;
  }
`,BE=P.Ay.button`
  background: none;
  border: none;
  color: #ff5555;
  cursor: pointer;
  padding: 1px;
  display: flex;
  align-items: center;
  font-size: 10px;
  
  &:hover {
    color: #ff3333;
  }
`,VE=(P.Ay.input`
  background-color: #222;
  color: #eee;
  border: 1px solid #444;
  border-radius: 4px;
  padding: 4px 8px;
  font-size: 0.8rem;
  width: 140px;
  
  &:focus {
    outline: none;
    border-color: #00ff00;
  }
`,P.Ay.select`
  background-color: #222;
  color: #eee;
  border: 1px solid #444;
  border-radius: 4px;
  padding: 4px 8px;
  font-size: 0.95rem;
  width: auto;
  min-width: 120px;
  max-width: 100%;
  
  &:focus {
    outline: none;
    border-color: #00ff00;
  }
  
  option {
    background-color: #222;
    color: #eee;
  }
`),$E=(P.Ay.input`
  background-color: #222;
  color: #eee;
  border: 1px solid #444;
  border-radius: 4px;
  padding: 4px 8px;
  font-size: 0.8rem;
  width: 100px;
  
  &:focus {
    outline: none;
    border-color: #00ff00;
  }
`,P.Ay.div`
  background-color: #222;
  color: #00ff00;
  border: 1px solid #00ff00;
  border-radius: 8px;
  padding: 5px;
  font-size: 0.7rem;
  line-height: 1;
  display: inline-flex;
  align-items: center;
  cursor: pointer;
  position: relative;
  width: fit-content;
  white-space: nowrap;
  box-sizing: border-box;
`,P.Ay.div`
  display: flex;
  align-items: center;
  gap: 2px;
  margin-left: 4px;
  opacity: 0;
  transition: opacity 0.2s ease;
`,P.Ay.button`
  background: none;
  border: none;
  color: #00ff00;
  cursor: pointer;
  padding: 1px;
  display: flex;
  align-items: center;
  font-size: 10px;
  
  &:hover {
    color: #00cc00;
  }
`,P.Ay.button`
  background: none;
  border: none;
  color: #ff5555;
  cursor: pointer;
  padding: 1px;
  display: flex;
  align-items: center;
  font-size: 10px;
  
  &:hover {
    color: #ff3333;
  }
`,P.Ay.div`
  display: flex;
  align-items: center;
  justify-content: space-between;
  margin-bottom: 15px;
`),UE=(P.Ay.div`
  display: flex;
  align-items: center;
  gap: 4px;
  margin: 2px;
`,P.Ay.div`
  display: inline-flex;
  align-items: center;
  position: relative;
  margin: 2px;
  
  &:hover .tag-actions {
    opacity: 1;
  }
`,P.Ay.div`
  background-color: #222;
  border: 1px solid #333;
  border-radius: 8px;
  padding: 16px;
  margin-bottom: 12px;
  transition: all 0.2s ease;
  
  &:hover {
    border-color: #555;
    background-color: #252525;
  }
`),WE=P.Ay.div`
  display: flex;
  justify-content: space-between;
  align-items: flex-start;
  margin-bottom: 12px;
`,qE=P.Ay.div`
  color: #00ff00;
  font-size: 0.9rem;
  font-weight: bold;
`,KE=P.Ay.div`
  background-color: ${e=>{var t;switch(null===(t=e.status)||void 0===t?void 0:t.toLowerCase()){case"completed":return"#004d00";case"in progress":return"#4d4d00";case"cancelled":return"#4d0000";default:return"#002d4d"}}};
  color: ${e=>{var t;switch(null===(t=e.status)||void 0===t?void 0:t.toLowerCase()){case"completed":return"#00ff00";case"in progress":return"#ffff00";case"cancelled":return"#ff5555";default:return"#00aaff"}}};
  border: 1px solid currentColor;
  border-radius: 12px;
  padding: 4px 8px;
  font-size: 0.75rem;
  font-weight: bold;
`,YE=P.Ay.div`
  margin-bottom: 8px;
`,JE=P.Ay.div`
  color: #999;
  font-size: 0.8rem;
  margin-bottom: 4px;
`,XE=P.Ay.div`
  color: #eee;
  font-size: 0.95rem;
  font-weight: 500;
`,QE=P.Ay.div`
  margin-bottom: 12px;
`,ZE=P.Ay.div`
  color: #999;
  font-size: 0.8rem;
  margin-bottom: 4px;
`,ek=P.Ay.div`
  color: #ccc;
  font-size: 0.85rem;
`,tk=P.Ay.div`
  color: #ddd;
  font-size: 0.9rem;
  line-height: 1.4;
  margin-bottom: 8px;
`,ok=P.Ay.div`
  display: inline-block;
  background-color: rgba(0, 255, 0, 0.1);
  color: #00ff00;
  border: 1px solid rgba(0, 255, 0, 0.3);
  border-radius: 4px;
  padding: 2px 6px;
  font-size: 0.75rem;
  font-weight: bold;
`,nk=P.Ay.div`
  max-height: 600px;
  overflow-y: auto;
  padding-right: 8px;
  
  &::-webkit-scrollbar {
    width: 6px;
  }
  
  &::-webkit-scrollbar-track {
    background: #222;
  }
  
  &::-webkit-scrollbar-thumb {
    background-color: #00ff00;
    border-radius: 3px;
  }
`,rk=P.Ay.button`
  background-color: #222;
  color: #00ff00;
  border: 1px solid #00ff00;
  padding: 8px 12px;
  border-radius: 4px;
  cursor: pointer;
  display: flex;
  align-items: center;
  gap: 6px;
  font-size: 0.85rem;
  font-weight: 500;
  transition: all 0.2s ease;
  
  &:hover {
    background-color: #00ff00;
    color: #000;
  }
  
  &:focus {
    outline: none;
    box-shadow: 0 0 0 2px rgba(0, 255, 0, 0.3);
  }
`,ik=P.Ay.div`
  display: flex;
  justify-content: space-between;
  align-items: center;
  margin-bottom: 16px;
  padding-bottom: 12px;
  border-bottom: 1px solid #333;
`,ak=P.Ay.div`
  position: fixed;
  top: 0;
  left: 0;
  right: 0;
  bottom: 0;
  background-color: rgba(0, 0, 0, 0.7);
  display: flex;
  align-items: center;
  justify-content: center;
  z-index: 1000;
`,sk=P.Ay.div`
  background-color: #1a1a1a;
  border-radius: 8px;
  border: 1px solid #333;
  width: 80%;
  max-width: 1000px;
  height: 70%;
  max-height: 600px;
  display: flex;
  overflow: hidden;
`,lk=P.Ay.div`
  width: 200px;
  background-color: #222;
  border-right: 1px solid #333;
  padding: 20px;
  display: flex;
  flex-direction: column;
  gap: 10px;
`,ck=P.Ay.div`
  flex: 1;
  padding: 20px;
  display: flex;
  flex-direction: column;
`,dk=P.Ay.div`
  display: flex;
  justify-content: space-between;
  align-items: center;
  margin-bottom: 20px;
`,uk=P.Ay.h2`
  color: #00ff00;
  margin: 0;
  font-size: 1.5rem;
`,pk=P.Ay.button`
  background: none;
  border: none;
  color: #999;
  cursor: pointer;
  padding: 5px;
  
  &:hover {
    color: #fff;
  }
`,hk=P.Ay.button`
  background-color: ${e=>e.active?"#00ff00":"#333"};
  color: ${e=>e.active?"#000":"#fff"};
  border: 1px solid ${e=>e.active?"#00ff00":"#555"};
  padding: 10px 15px;
  border-radius: 4px;
  cursor: pointer;
  font-size: 0.9rem;
  transition: all 0.2s ease;
  
  &:hover {
    background-color: ${e=>e.active?"#00cc00":"#444"};
  }
`,fk=(P.Ay.div`
  flex: 1;
  border: 2px solid #333;
  border-radius: 4px;
  position: relative;
  background-color: #111;
`,P.Ay.div`
  position: absolute;
  top: 20px;
  left: 20px;
  right: 20px;
  bottom: 20px;
  border: 1px solid #555;
  border-radius: 4px;
  background-color: #1a1a1a;
`,P.Ay.div`
  background-color: ${e=>e.selected?"#00ff00":"#222"};
  color: ${e=>e.selected?"#000":"#00ff00"};
  border: 1px solid #00ff00;
  border-radius: 8px;
  padding: 4px 8px;
  font-size: 0.7rem;
  display: inline-flex;
  align-items: center;
  width: fit-content;
  white-space: nowrap;
  box-sizing: border-box;
  cursor: pointer;
  transition: all 0.2s ease;
  
  &:hover {
    background-color: ${e=>e.selected?"#00cc00":"#333"};
  }
`),gk=P.Ay.div`
  padding: 12px;
  border-bottom: 1px solid #333;
  cursor: pointer;
  
  &:last-child {
    border-bottom: none;
  }
  
  &:hover {
    background-color: #222;
  }
`,mk=P.Ay.div`
  font-weight: bold;
  color: #eee;
  margin-bottom: 4px;
`,yk=P.Ay.div`
  font-size: 0.85rem;
  color: #999;
`,vk=P.Ay.div`
  display: flex;
  align-items: center;
  justify-content: center;
  padding: 40px;
  color: #00ff00;
`,bk=P.Ay.div`
  flex: 1;
  overflow-y: auto;
  max-height: 400px;
`,xk=()=>{const{id:e}=(0,i.g)(),o=(0,i.Zp)(),[n,r]=(0,t.useState)(null),[a,s]=(0,t.useState)([]),[l,c]=(0,t.useState)([]),[d,u]=(0,t.useState)([]),[p,h]=(0,t.useState)([]),[f,g]=(0,t.useState)([]),[m,y]=(0,t.useState)([]),[v,b]=(0,t.useState)(null),[x,w]=(0,t.useState)([]),[C,_]=(0,t.useState)(!0),[S,E]=(0,t.useState)(null),[k,j]=(0,t.useState)("interactions"),[A,R]=(0,t.useState)("emails"),[O,T]=(0,t.useState)([]),[P,I]=(0,t.useState)(!1),[M,L]=(0,t.useState)(!1),[F,G]=(0,t.useState)(""),[z,H]=(0,t.useState)(!1),[V,$]=(0,t.useState)(!1),[U,W]=(0,t.useState)(0),[q,K]=(0,t.useState)(!1),[Y,J]=(0,t.useState)(!1),[X,Q]=(0,t.useState)(""),[Z,ee]=(0,t.useState)(!1),[te,oe]=(0,t.useState)(null),[ne,re]=(0,t.useState)(""),[ie,ae]=(0,t.useState)(!1),[se,le]=(0,t.useState)(!1),[ce,de]=(0,t.useState)(0),[ue,pe]=(0,t.useState)(!1),[he,fe]=(0,t.useState)(!1),[ge,me]=(0,t.useState)(""),[ye,ve]=(0,t.useState)(!1),[be,xe]=(0,t.useState)(null),[we,Ce]=(0,t.useState)(""),[_e,Se]=(0,t.useState)(!1),[Ee,ke]=(0,t.useState)(!1),[je,Ae]=(0,t.useState)(""),[Re,Oe]=(0,t.useState)(!1),[Te,De]=(0,t.useState)(!1),[Pe,Ne]=(0,t.useState)(null),[Ie,Me]=(0,t.useState)(""),[Le,Fe]=(0,t.useState)(!1),[Ge,ze]=(0,t.useState)(""),[He,Be]=(0,t.useState)(!1),[Ve,$e]=(0,t.useState)([]),[Ue,We]=(0,t.useState)(!1),[qe,Ke]=(0,t.useState)("contacts"),[Ye,Je]=(0,t.useState)(!1),[Xe,Qe]=(0,t.useState)("contacts"),[Ze,et]=(0,t.useState)([]),[tt,ot]=(0,t.useState)([]),[nt,rt]=(0,t.useState)(!1),[it,at]=(0,t.useState)(!1),[st,lt]=(0,t.useState)(!1),[ct,dt]=(0,t.useState)([]),[ut,ht]=(0,t.useState)([]),[ft,gt]=(0,t.useState)(!1),[mt,yt]=(0,t.useState)(!1),[vt,bt]=(0,t.useState)(!1),[xt,wt]=(0,t.useState)(!1),[Ct,_t]=(0,t.useState)({showWhatsApp:!0,showEmail:!0,showMeetings:!0}),[St,Et]=(0,t.useState)(!1),[kt,jt]=(0,t.useState)(!1),[At,Rt]=(0,t.useState)(!1),[Ot,Tt]=(0,t.useState)(null),Dt=(0,t.useRef)(null),Pt=(0,t.useRef)(null),Nt=(0,t.useRef)(null),It=(0,t.useRef)(null),Mt=(0,t.useRef)(null),Lt=(0,t.useRef)(null),[Ft,Gt]=(0,t.useState)([]),[zt,Ht]=(0,t.useState)(!1);(0,t.useEffect)((()=>{const e=e=>{Y&&Dt.current&&!Dt.current.contains(e.target)&&(X.trim()?eo():to())};return Y&&document.addEventListener("mousedown",e),()=>{document.removeEventListener("mousedown",e)}}),[Y,X]),(0,t.useEffect)((()=>{const e=e=>{he&&Pt.current&&!Pt.current.contains(e.target)&&(ge.trim()?ao():so())};return he&&document.addEventListener("mousedown",e),()=>{document.removeEventListener("mousedown",e)}}),[he,ge]),(0,t.useEffect)((()=>{const e=e=>{be&&Nt.current&&!Nt.current.contains(e.target)&&(we.trim()?lo():co())};return be&&document.addEventListener("mousedown",e),()=>{document.removeEventListener("mousedown",e)}}),[be,we]),(0,t.useEffect)((()=>{const e=e=>{M&&It.current&&!It.current.contains(e.target)&&(F.trim()?Vt():$t())};return M&&document.addEventListener("mousedown",e),()=>{document.removeEventListener("mousedown",e)}}),[M,F]),(0,t.useEffect)((()=>{const e=e=>{Pe&&Mt.current&&!Mt.current.contains(e.target)&&(Ie.trim()?uo():ho())};return Pe&&document.addEventListener("mousedown",e),()=>{document.removeEventListener("mousedown",e)}}),[Pe,Ie]),(0,t.useEffect)((()=>{const e=e=>{Le&&Lt.current&&!Lt.current.contains(e.target)&&(Ge.trim()?po():ho())};return Le&&document.addEventListener("mousedown",e),()=>{document.removeEventListener("mousedown",e)}}),[Le,Ge]),(0,t.useEffect)((()=>{if(!e)return;(async()=>{_(!0),E(null);try{var t,o,n;const{data:i,error:a}=await D.supabase.from("contacts").select("*").eq("contact_id",e).single();if(a)throw a;if(!i)throw new Error("Contact not found");r(i);const[l,d,p,f,m,v,x,C]=await Promise.all([D.supabase.from("interactions").select("*").eq("contact_id",e).order("interaction_date",{ascending:!1}),D.supabase.from("contact_tags").select("\n              entry_id,\n              tags (\n                tag_id,\n                name\n              )\n            ").eq("contact_id",e),D.supabase.from("contact_cities").select("\n              entry_id,\n              cities (\n                city_id,\n                name,\n                country\n              )\n            ").eq("contact_id",e),D.supabase.from("contact_companies").select("\n              contact_companies_id,\n              relationship,\n              is_primary,\n              companies (\n                company_id,\n                name,\n                website,\n                category\n              )\n            ").eq("contact_id",e),D.supabase.from("contact_emails").select("*").eq("contact_id",e),D.supabase.from("contact_mobiles").select("*").eq("contact_id",e),D.supabase.from("notes_contacts").select("\n              note_contact_id,\n              notes (\n                note_id,\n                title,\n                text,\n                created_at\n              )\n            ").eq("contact_id",e).order("created_at",{foreignTable:"notes",ascending:!1}),D.supabase.from("mv_keep_in_touch").select("*").eq("contact_id",e).single()]);s(l.data||[]),c((null===(t=d.data)||void 0===t?void 0:t.map((e=>e.tags)))||[]),u((null===(o=p.data)||void 0===o?void 0:o.map((e=>e.cities)))||[]),h(f.data||[]),g(m.data||[]),y(v.data||[]),w((null===(n=x.data)||void 0===n?void 0:n.map((e=>e.notes)))||[]),b(C.data||null)}catch(i){console.error("Error fetching contact data:",i),E(i.message||"Error loading contact data")}finally{_(!1)}})()}),[e]),(0,t.useEffect)((()=>{console.log("\ud83d\ude80 useEffect running for deals and introductions - id:",e),e?(console.log("\u2705 id exists, calling fetchDeals and fetchIntroductions"),Jt(),Xt()):console.log("\u274c no id in useEffect")}),[e]);const Bt=e=>{if(!e)return"-";const t=new Date(e);return`${t.toLocaleDateString()} ${t.toLocaleTimeString()}`},Vt=async()=>{if(!z){H(!0);try{const{error:t}=await D.supabase.from("contacts").update({birthday:F||null,last_modified_at:(new Date).toISOString()}).eq("contact_id",e);if(t)throw t;r((e=>({...e,birthday:F||null,last_modified_at:(new Date).toISOString()}))),L(!1),Pm.oR.success("Birthday updated successfully")}catch(t){console.error("Error updating birthday:",t),Pm.oR.error("Failed to update birthday")}finally{H(!1)}}},$t=()=>{L(!1),G("")},Ut=async()=>{if(!q){K(!0);try{const{error:t}=await D.supabase.from("contacts").update({score:U,last_modified_at:(new Date).toISOString()}).eq("contact_id",e);if(t)throw t;r((e=>({...e,score:U,last_modified_at:(new Date).toISOString()}))),$(!1),Pm.oR.success("Score updated successfully")}catch(t){console.error("Error updating score:",t),Pm.oR.error("Failed to update score")}finally{K(!1)}}},Wt=()=>{$(!1),W(0)},qt=()=>{try{if(n.linkedin&&n.linkedin.trim()){const e=n.linkedin.startsWith("http")?n.linkedin:`https://${n.linkedin}`;window.open(e,"_blank","noopener,noreferrer")}else{const e=`${n.first_name||""} ${n.last_name||""}`.trim();if(e){const t=`https://www.linkedin.com/search/results/people/?keywords=${encodeURIComponent(e)}`;window.open(t,"_blank","noopener,noreferrer")}else Pm.oR.info("No name available to search on LinkedIn")}}catch(S){console.error("Error opening LinkedIn:",S),Pm.oR.error("Failed to open LinkedIn")}},Kt=e=>{e.stopPropagation(),yt(!0)},Yt=()=>{bt(!0)},Jt=async()=>{if(e){Ht(!0);try{const{data:t,error:o}=await D.supabase.from("deals_contacts").select("\n          deals_contacts_id,\n          relationship,\n          deals:deal_id (\n            deal_id,\n            opportunity,\n            total_investment,\n            category,\n            stage,\n            description,\n            created_at,\n            updated_at\n          )\n        ").eq("contact_id",e);if(o)throw o;const n=(null===t||void 0===t?void 0:t.map((e=>({...e.deals,relationship:e.relationship,deals_contacts_id:e.deals_contacts_id}))))||[];Gt(n)}catch(t){console.error("Error fetching associated deals:",t),Gt([])}finally{Ht(!1)}}},Xt=async()=>{if(console.log("\ud83d\udd25 fetchIntroductions CALLED - id:",e,"type:",typeof e),e){I(!0),console.log("Fetching introductions for contact ID:",e);try{const{data:t,error:o}=await D.supabase.from("introductions").select("*").order("introduction_date",{ascending:!1});if(console.log("Introductions query result:",t,"Error:",o),o)throw o;const n=(null===t||void 0===t?void 0:t.filter((t=>t.contact_ids&&Array.isArray(t.contact_ids)&&t.contact_ids.includes(e))))||[];if(console.log("Filtered introductions for contact:",n),0===n.length)return console.log("No introductions found for this contact"),void T([]);console.log("Found",n.length,"introductions");const r=new Set;n.forEach((t=>{console.log("Processing introduction:",t.introduction_id,"contact_ids:",t.contact_ids),t.contact_ids&&Array.isArray(t.contact_ids)&&t.contact_ids.forEach((t=>{t!==e&&r.add(t)}))})),console.log("Other contact IDs found:",Array.from(r));let i={},a={};if(r.size>0){const{data:e,error:t}=await D.supabase.from("contacts").select("contact_id, first_name, last_name").in("contact_id",Array.from(r));if(console.log("Contacts data:",e,"Error:",t),t)console.error("Error fetching contacts for introductions:",t);else{null===e||void 0===e||e.forEach((e=>{const t=`${e.first_name||""} ${e.last_name||""}`.trim();i[e.contact_id]=t||"Unknown Contact"})),console.log("Contacts map:",i);const{data:t,error:o}=await D.supabase.from("contact_companies").select("\n              contact_id,\n              company_id,\n              companies!inner(\n                company_id,\n                name\n              )\n            ").in("contact_id",Array.from(r));console.log("Contact companies data:",t,"Error:",o),o?console.error("Error fetching contact companies for introductions:",o):(null===t||void 0===t||t.forEach((e=>{var t;const o=e.contact_id,n=null===(t=e.companies)||void 0===t?void 0:t.name;n&&(a[o]||(a[o]=[]),a[o].push(n))})),console.log("Companies map:",a))}}const s=n.map((t=>{var o;const n=(null===(o=t.contact_ids)||void 0===o?void 0:o.filter((t=>t!==e)))||[],r=n.map((e=>i[e]||"\ud83d\udeab Deleted Contact")),s=new Set;n.forEach((e=>{a[e]&&a[e].forEach((e=>{s.add(e)}))}));const l={id:t.introduction_id,date:t.introduction_date||t.created_at,otherContacts:r,relatedCompanies:Array.from(s),description:t.text||"",category:t.category||"",status:t.status||"Requested",created_at:t.created_at};return console.log("Transformed introduction:",l),l}));console.log("Final transformed introductions:",s),T(s)}catch(t){console.error("Error fetching introductions:",t),T([])}finally{I(!1)}}else console.log("\u274c No id provided, returning early")},Qt=()=>{jt(!0)},Zt=async()=>{if(e)try{const{data:t,error:o}=await D.supabase.from("notes_contacts").select("\n          note_contact_id,\n          notes (\n            note_id,\n            title,\n            text,\n            created_at\n          )\n        ").eq("contact_id",e).order("created_at",{foreignTable:"notes",ascending:!1});if(o)throw o;w((null===t||void 0===t?void 0:t.map((e=>e.notes)))||[])}catch(t){console.error("Error fetching notes:",t)}},eo=async()=>{if(!Z&&X.trim()){ee(!0);try{const{data:t,error:o}=await D.supabase.from("contact_mobiles").insert({contact_id:e,mobile:X.trim(),is_primary:0===m.length}).select().single();if(o)throw o;y((e=>[...e,t])),J(!1),Q(""),Pm.oR.success("Mobile number added successfully")}catch(t){console.error("Error adding mobile number:",t),Pm.oR.error("Failed to add mobile number")}finally{ee(!1)}}},to=()=>{J(!1),Q("")},oo=async()=>{if(!ie&&ne.trim()){ae(!0);try{const{error:e}=await D.supabase.from("contact_mobiles").update({mobile:ne.trim()}).eq("mobile_id",te);if(e)throw e;y((e=>e.map((e=>e.mobile_id===te?{...e,mobile:ne.trim()}:e)))),oe(null),re(""),Pm.oR.success("Mobile number updated successfully")}catch(e){console.error("Error updating mobile number:",e),Pm.oR.error("Failed to update mobile number")}finally{ae(!1)}}},no=()=>{oe(null),re("")},ro=async()=>{if(!ue){pe(!0);try{const{error:t}=await D.supabase.from("keep_in_touch").update({snooze_days:parseInt(ce)||0}).eq("contact_id",e);if(t)throw t;b((e=>({...e,snooze_days:parseInt(ce)||0}))),le(!1),Pm.oR.success("Snooze days updated successfully")}catch(t){console.error("Error updating snooze days:",t),Pm.oR.error("Failed to update snooze days")}finally{pe(!1)}}},io=()=>{le(!1),de(0)},ao=async()=>{if(!ye&&ge.trim()){ve(!0);try{const{data:t,error:o}=await D.supabase.from("contact_emails").insert({contact_id:e,email:ge.trim(),is_primary:0===f.length}).select().single();if(o)throw o;g((e=>[...e,t])),fe(!1),me(""),Pm.oR.success("Email added successfully")}catch(t){console.error("Error adding email:",t),Pm.oR.error("Failed to add email")}finally{ve(!1)}}},so=()=>{fe(!1),me("")},lo=async()=>{if(!_e&&we.trim()){Se(!0);try{const{error:e}=await D.supabase.from("contact_emails").update({email:we.trim()}).eq("email_id",be);if(e)throw e;g((e=>e.map((e=>e.email_id===be?{...e,email:we.trim()}:e)))),xe(null),Ce(""),Pm.oR.success("Email updated successfully")}catch(e){console.error("Error updating email:",e),Pm.oR.error("Failed to update email")}finally{Se(!1)}}},co=()=>{xe(null),Ce("")},uo=async()=>{if(!He&&Ie.trim()){Be(!0);try{const{error:e}=await D.supabase.from("tags").update({name:Ie.trim()}).eq("tag_id",Pe);if(e)throw e;c((e=>e.map((e=>e.tag_id===Pe?{...e,name:Ie.trim()}:e)))),Ne(null),Me(""),Pm.oR.success("Tag updated successfully")}catch(e){console.error("Error updating tag:",e),Pm.oR.error("Failed to update tag")}finally{Be(!1)}}},po=async()=>{if(!He&&Ge.trim()){Be(!0);try{let t;const o=Ve.find((e=>e.name.toLowerCase()===Ge.trim().toLowerCase()));if(o)t=o.tag_id;else{const{data:e,error:o}=await D.supabase.from("tags").insert({name:Ge.trim()}).select().single();if(o)throw o;t=e.tag_id}const{data:n}=await D.supabase.from("contact_tags").select("entry_id").eq("contact_id",e).eq("tag_id",t).single();if(n)return Pm.oR.info("Tag is already associated with this contact"),Fe(!1),void ze("");const{error:r}=await D.supabase.from("contact_tags").insert({contact_id:e,tag_id:t});if(r)throw r;const i=o||{tag_id:t,name:Ge.trim()};c((e=>[...e,i])),Fe(!1),ze(""),Pm.oR.success("Tag added successfully")}catch(t){console.error("Error adding tag:",t),Pm.oR.error("Failed to add tag")}finally{Be(!1)}}},ho=()=>{Fe(!1),ze(""),Ne(null),Me("")},fo=()=>{at(!0)},go=()=>{lt(!0)},mo=()=>{Je(!1),et([]),ot([])},yo=e=>{Qe(e),Ze.length>0&&vo(Ze,e)},vo=async(e,t)=>{if(0!==e.length){rt(!0);try{let o,n,r,i;if("contacts"===t)o="contact_id",n="contact_cities",r="contacts",i="\n          contact_id,\n          first_name,\n          last_name,\n          job_role,\n          score,\n          category\n        ";else if("companies"===t)o="company_id",n="company_cities",r="companies",i="\n          company_id,\n          name,\n          website,\n          category,\n          description\n        ";else if("deals"===t)return ot([]),void rt(!1);const{data:a,error:s}=await D.supabase.from(n).select(`${o}, city_id`).in("city_id",e);if(s)throw s;const l={};a.forEach((e=>{const t=e[o];l[t]||(l[t]=0),l[t]++}));const c=Object.keys(l).filter((t=>l[t]===e.length));if(0===c.length)return void ot([]);const{data:d,error:u}=await D.supabase.from(r).select(i).in(o,c);if(u)throw u;ot(d||[])}catch(o){console.error("Error fetching filtered results:",o),Pm.oR.error("Failed to fetch filtered results"),ot([])}finally{rt(!1)}}else ot([])};return C?(0,N.jsx)(eE,{children:(0,N.jsx)(wE,{children:(0,N.jsx)("div",{children:"Loading Contact Data..."})})}):S?(0,N.jsx)(eE,{children:(0,N.jsxs)(CE,{children:[(0,N.jsx)("h2",{children:"Error Loading Contact"}),(0,N.jsx)("p",{children:S}),(0,N.jsx)("button",{onClick:()=>o("/contacts/simple"),children:"Back to Contacts"})]})}):n?(0,N.jsxs)(eE,{children:[(0,N.jsxs)(xE,{children:[(0,N.jsx)("span",{onClick:()=>o("/contacts/lists"),style:{cursor:"pointer"},children:"Lists"}),(0,N.jsx)("span",{style:{margin:"0 8px"},children:"/"}),(0,N.jsx)("span",{onClick:()=>o(`/contacts/lists?category=${encodeURIComponent(n.category||"Uncategorized")}`),style:{cursor:"pointer"},children:n.category||"Uncategorized"}),(0,N.jsx)("span",{style:{margin:"0 8px"},children:"/"}),(0,N.jsxs)("span",{style:{color:"#ccc"},children:[n.first_name," ",n.last_name]})]}),(0,N.jsxs)(tE,{children:[(0,N.jsxs)("div",{children:[(0,N.jsxs)(oE,{children:[n.first_name," ",n.last_name]}),(0,N.jsxs)("div",{style:{display:"flex",alignItems:"center",marginTop:"10px",color:"#999",fontSize:"0.85rem"},children:[(0,N.jsxs)("div",{style:{marginRight:"20px"},children:[(0,N.jsx)("span",{children:"Created: "}),(0,N.jsx)("span",{style:{color:"#eee"},children:Bt(n.created_at)})]}),(0,N.jsxs)("div",{children:[(0,N.jsx)("span",{children:"Last modified: "}),(0,N.jsx)("span",{style:{color:"#eee"},children:Bt(n.last_modified_at)})]})]})]}),(0,N.jsxs)("div",{style:{display:"flex",gap:"10px"},children:[m.length>0&&(0,N.jsxs)("a",{href:`https://wa.me/${m[0].mobile.replace(/\D/g,"")}`,target:"_blank",rel:"noopener noreferrer",style:{backgroundColor:"#25D366",color:"white",border:"none",padding:"10px",borderRadius:"4px",cursor:"pointer",display:"flex",alignItems:"center",justifyContent:"center",textDecoration:"none"},children:[(0,N.jsx)(B.QFc,{style:{marginRight:"5px"}})," WhatsApp"]}),f.length>0&&(0,N.jsxs)("a",{href:`mailto:${f[0].email}`,style:{backgroundColor:"#4285F4",color:"white",border:"none",padding:"10px",borderRadius:"4px",cursor:"pointer",display:"flex",alignItems:"center",justifyContent:"center",textDecoration:"none"},children:[(0,N.jsx)(B.pHD,{style:{marginRight:"5px"}})," Email"]}),n.linkedin&&(0,N.jsxs)(TE,{children:[(0,N.jsx)(OE,{size:20,hasLink:!(!n.linkedin||!n.linkedin.trim()),onClick:qt,onKeyDown:e=>{"Enter"!==e.key&&" "!==e.key||(e.preventDefault(),qt())},tabIndex:0,title:n.linkedin&&n.linkedin.trim()?"Click to open LinkedIn profile":`Click to search for ${n.first_name} ${n.last_name} on LinkedIn`}),(0,N.jsx)(DE,{onClick:Kt,children:"Edit LinkedIn"})]}),(0,N.jsxs)(nE,{onClick:()=>{o(`/contacts/workflow/${e}`)},children:[(0,N.jsx)(B.SG1,{})," Edit"]})]})]}),(0,N.jsxs)(rE,{children:[(0,N.jsxs)("div",{style:{width:"20%",flexShrink:0},children:[(0,N.jsxs)(iE,{children:[(0,N.jsxs)(aE,{children:[(0,N.jsx)(B.pHD,{})," Contact Information"]}),(0,N.jsxs)(sE,{children:[(0,N.jsx)(IE,{children:(0,N.jsx)(lE,{children:"Emails"})}),f.length>0&&f.map(((e,t)=>(0,N.jsxs)(zE,{children:[(0,N.jsx)(dE,{onClick:()=>{window.open(`mailto:${e.email}`,"_self")},style:{cursor:"pointer"},title:"Click to send email",children:e.email}),(0,N.jsxs)(GE,{children:[(0,N.jsx)(HE,{onClick:Yt,title:"Manage emails",children:(0,N.jsx)(B.SG1,{size:10})}),(0,N.jsx)(BE,{onClick:()=>(async e=>{try{const{error:t}=await D.supabase.from("contact_emails").delete().eq("email_id",e);if(t)throw t;g((t=>t.filter((t=>t.email_id!==e)))),Pm.oR.success("Email deleted successfully")}catch(t){console.error("Error deleting email:",t),Pm.oR.error("Failed to delete email")}})(e.email_id),title:"Delete email",children:(0,N.jsx)(B.Q_v,{size:10})})]})]},e.email_id))),0===f.length&&(0,N.jsx)(cE,{onClick:Yt,style:{color:"#00ff00",fontStyle:"italic",cursor:"pointer"},title:"Click to add emails",children:"Add emails"})]}),(0,N.jsxs)(sE,{children:[(0,N.jsxs)(IE,{children:[(0,N.jsx)(lE,{children:"Mobile Numbers"}),(0,N.jsx)(PE,{onClick:()=>{Q(""),J(!0)},title:"Add mobile number",children:(0,N.jsx)(B.GGD,{size:14})})]}),m.length>0&&m.map(((e,t)=>(0,N.jsx)(LE,{children:te===e.mobile_id?(0,N.jsxs)(_E,{children:[(0,N.jsx)(NE,{type:"tel",value:ne,onChange:e=>re(e.target.value),disabled:ie,onKeyDown:e=>{"Enter"===e.key?oo():"Escape"===e.key&&no()},autoFocus:!0}),(0,N.jsx)(EE,{onClick:oo,disabled:ie||!ne.trim(),title:"Save changes",children:(0,N.jsx)(B.YrT,{size:14})}),(0,N.jsx)(kE,{onClick:no,disabled:ie,title:"Cancel",children:(0,N.jsx)(B.yGN,{size:14})})]}):(0,N.jsxs)(N.Fragment,{children:[(0,N.jsx)(cE,{onClick:()=>{try{const t=e.mobile.replace(/\D/g,"");t?window.open(`https://wa.me/${t}`,"_blank","noopener,noreferrer"):Pm.oR.error("Invalid phone number format")}catch(S){console.error("Error opening WhatsApp:",S),Pm.oR.error("Failed to open WhatsApp")}},onKeyDown:t=>{if("Enter"===t.key||" "===t.key){t.preventDefault();try{const t=e.mobile.replace(/\D/g,"");t?window.open(`https://wa.me/${t}`,"_blank","noopener,noreferrer"):Pm.oR.error("Invalid phone number format")}catch(S){console.error("Error opening WhatsApp:",S),Pm.oR.error("Failed to open WhatsApp")}}},tabIndex:0,style:{cursor:"pointer"},title:"Click to open WhatsApp chat",children:e.mobile}),(0,N.jsxs)(ME,{children:[(0,N.jsx)(EE,{onClick:()=>(e=>{oe(e.mobile_id),re(e.mobile)})(e),title:"Edit mobile number",children:(0,N.jsx)(B.SG1,{size:12})}),(0,N.jsx)(FE,{onClick:()=>(async e=>{try{const{error:t}=await D.supabase.from("contact_mobiles").delete().eq("mobile_id",e);if(t)throw t;y((t=>t.filter((t=>t.mobile_id!==e)))),Pm.oR.success("Mobile number deleted successfully")}catch(t){console.error("Error deleting mobile number:",t),Pm.oR.error("Failed to delete mobile number")}})(e.mobile_id),title:"Delete mobile number",children:(0,N.jsx)(B.Q_v,{size:12})})]})]})},e.mobile_id))),0===m.length&&!Y&&(0,N.jsx)(cE,{style:{color:"#666",fontStyle:"italic"},children:"No mobile numbers"}),Y&&(0,N.jsxs)(_E,{ref:Dt,style:{marginTop:"8px"},children:[(0,N.jsx)(NE,{type:"tel",value:X,onChange:e=>Q(e.target.value),disabled:Z,onKeyDown:e=>{"Enter"===e.key&&X.trim()?eo():"Escape"===e.key&&to()},onBlur:()=>{X.trim()?eo():to()},autoFocus:!0}),(0,N.jsx)(kE,{onClick:to,disabled:Z,title:"Cancel",children:(0,N.jsx)(B.yGN,{size:14})})]})]}),(0,N.jsxs)(sE,{children:[(0,N.jsx)(lE,{children:"LinkedIn"}),(0,N.jsxs)(TE,{children:[(0,N.jsx)(OE,{size:20,hasLink:!(!n.linkedin||!n.linkedin.trim()),onClick:qt,onKeyDown:e=>{"Enter"!==e.key&&" "!==e.key||(e.preventDefault(),qt())},tabIndex:0,title:n.linkedin&&n.linkedin.trim()?"Click to open LinkedIn profile":`Click to search for ${n.first_name} ${n.last_name} on LinkedIn`}),(0,N.jsx)(DE,{onClick:Kt,children:(0,N.jsx)(B.WXf,{size:14})})]})]}),(0,N.jsxs)(sE,{children:[(0,N.jsx)(lE,{children:"Job Role"}),(0,N.jsx)(cE,{children:n.job_role||"-"})]}),(0,N.jsxs)(sE,{children:[(0,N.jsx)(lE,{children:"Score"}),V?(0,N.jsxs)(RE,{tabIndex:0,onKeyDown:e=>{if(e.key>="1"&&e.key<="5"){const t=parseInt(e.key);W(t)}else"Enter"===e.key?Ut():"Escape"===e.key&&Wt()},autoFocus:!0,children:[(0,N.jsx)(jE,{children:[1,2,3,4,5].map((e=>(0,N.jsx)(AE,{size:16,clickable:!0,filled:e<=U,onClick:()=>(e=>{W(e)})(e)},e)))}),(0,N.jsx)(EE,{onClick:Ut,disabled:q,title:"Save score",children:(0,N.jsx)(B.YrT,{size:14})}),(0,N.jsx)(kE,{onClick:Wt,disabled:q,title:"Cancel",children:(0,N.jsx)(B.yGN,{size:14})})]}):(0,N.jsx)(jE,{onClick:()=>{W(n.score||0),$(!0)},style:{cursor:"pointer"},title:"Click to edit score",tabIndex:0,onKeyDown:e=>{if(e.key>="1"&&e.key<="5"){const t=parseInt(e.key);W(t),$(!0)}},children:[1,2,3,4,5].map((e=>(0,N.jsx)(AE,{size:16,clickable:!1,filled:e<=(n.score||0)},e)))})]}),(0,N.jsxs)(sE,{children:[(0,N.jsx)(lE,{children:"Birthday"}),M?(0,N.jsx)(_E,{ref:It,children:(0,N.jsx)(SE,{type:"date",value:F,onChange:e=>G(e.target.value),disabled:z,onKeyDown:e=>{"Enter"===e.key?Vt():"Escape"===e.key&&$t()},autoFocus:!0})}):(0,N.jsx)(cE,{onClick:()=>{const e=n.birthday?new Date(n.birthday).toISOString().split("T")[0]:"";G(e),L(!0)},style:{cursor:"pointer"},title:"Click to edit birthday",children:n.birthday?(bo=n.birthday,bo?new Date(bo).toLocaleDateString():"-"):"-"})]})]}),v&&(0,N.jsxs)(iE,{children:[(0,N.jsxs)(aE,{children:[(0,N.jsx)(B.Ohp,{})," Keep in Touch"]}),(0,N.jsxs)(sE,{children:[(0,N.jsx)(lE,{children:"Frequency"}),Ee?(0,N.jsx)(_E,{children:(0,N.jsx)(VE,{value:je,onChange:t=>(async t=>{if(!Re){Oe(!0);try{const{error:o}=await D.supabase.from("contacts").update({keep_in_touch_frequency:t}).eq("contact_id",e);if(o)throw o;b((e=>({...e,frequency:t}))),ke(!1),Pm.oR.success("Frequency updated successfully")}catch(o){console.error("Error updating frequency:",o),Pm.oR.error("Failed to update frequency")}finally{Oe(!1)}}})(t.target.value),disabled:Re,onKeyDown:e=>{"Escape"===e.key&&(ke(!1),Ae(""))},autoFocus:!0,children:[{value:"Do not keep in touch",label:"Do not keep in touch"},{value:"Weekly",label:"Weekly"},{value:"Monthly",label:"Monthly"},{value:"Quarterly",label:"Quarterly"},{value:"Twice per Year",label:"Twice per Year"},{value:"Once per Year",label:"Once per Year"}].map((e=>(0,N.jsx)("option",{value:e.value,children:e.label},e.value)))})}):(0,N.jsx)(cE,{onClick:()=>{Ae((null===v||void 0===v?void 0:v.frequency)||""),ke(!0)},style:{cursor:"pointer"},title:"Click to edit frequency",children:v.frequency||"Not set"})]}),(0,N.jsxs)(sE,{children:[(0,N.jsx)(lE,{children:"Last Interaction"}),(0,N.jsx)(cE,{children:(e=>{if(!e)return"-";const t=new Date(e);return`${String(t.getMonth()+1).padStart(2,"0")}/${String(t.getFullYear()).slice(-2)}`})(n.last_interaction_at||"-")})]}),(0,N.jsxs)(sE,{children:[(0,N.jsx)(lE,{children:"Next Interaction Due"}),(0,N.jsxs)(cE,{style:{color:v.next_interaction_date&&new Date(v.next_interaction_date)<new Date?"#ff5555":void 0},children:[Bt(v.next_interaction_date||"-"),v.days_until_next&&(0,N.jsxs)("span",{style:{marginLeft:"8px",color:v.days_until_next<0?"#ff5555":"#00ff00"},children:["(",v.days_until_next>0?`in ${v.days_until_next} days`:`${Math.abs(v.days_until_next)} days overdue`,")"]})]})]}),v.why_keeping_in_touch&&(0,N.jsxs)(sE,{children:[(0,N.jsx)(lE,{children:"Why Keeping in Touch"}),(0,N.jsx)(cE,{children:v.why_keeping_in_touch})]}),v.next_follow_up_notes&&(0,N.jsxs)(sE,{children:[(0,N.jsx)(lE,{children:"Follow-up Notes"}),(0,N.jsx)(cE,{children:v.next_follow_up_notes})]}),(0,N.jsxs)(sE,{children:[(0,N.jsx)(lE,{children:"Snooze Days"}),se?(0,N.jsxs)(_E,{children:[(0,N.jsx)(uE,{type:"number",min:"0",value:ce,onChange:e=>de(e.target.value),disabled:ue,onKeyDown:e=>{"Enter"===e.key?ro():"Escape"===e.key&&io()},autoFocus:!0}),(0,N.jsx)(EE,{onClick:ro,disabled:ue,title:"Save snooze days",children:(0,N.jsx)(B.YrT,{size:14})}),(0,N.jsx)(kE,{onClick:io,disabled:ue,title:"Cancel",children:(0,N.jsx)(B.yGN,{size:14})})]}):(0,N.jsx)(cE,{onClick:()=>{de((null===v||void 0===v?void 0:v.snooze_days)||0),le(!0)},style:{cursor:"pointer"},title:"Click to edit snooze days",children:v.snooze_days||0})]})]}),(0,N.jsxs)(iE,{children:[(0,N.jsx)($E,{children:(0,N.jsxs)(aE,{onClick:()=>{We(!0),dt([]),ht([]),Ke("contacts")},style:{cursor:"pointer"},title:"Click to view tag relationships",children:[(0,N.jsx)(B.cnX,{})," Tags"]})}),(0,N.jsx)(gE,{children:l.length>0?l.map((e=>(0,N.jsx)(mE,{onClick:fo,style:{cursor:"pointer"},title:"Click to manage tags",children:e.name},e.tag_id))):(0,N.jsx)("span",{style:{color:"#00ff00",cursor:"pointer",fontSize:"0.9rem"},onClick:fo,title:"Click to add tags",children:"Add Tags"})})]}),(0,N.jsxs)(iE,{children:[(0,N.jsxs)(aE,{onClick:()=>{Je(!0),et([]),ot([]),Qe("contacts")},style:{cursor:"pointer"},title:"Click to view location relationships",children:[(0,N.jsx)(B.HzC,{})," Locations"]}),(0,N.jsx)(gE,{children:d.length>0?d.map((e=>(0,N.jsxs)(mE,{onClick:go,style:{cursor:"pointer"},title:"Click to manage locations",children:[e.name,", ",e.country]},e.city_id))):(0,N.jsx)("span",{style:{color:"#00ff00",cursor:"pointer",fontSize:"0.9rem"},onClick:go,title:"Click to add locations",children:"Add Location"})})]}),p.length>0&&(0,N.jsxs)(iE,{children:[(0,N.jsxs)(aE,{children:[(0,N.jsx)(B.qYx,{})," Companies"]}),p.map((e=>(0,N.jsxs)(sE,{children:[(0,N.jsx)(cE,{onClick:()=>(e=>{const t={...e.companies,company_id:e.companies.company_id,contact_companies_id:e.contact_companies_id,relationship:e.relationship};Tt(t),Rt(!0)})(e),style:{cursor:"pointer",color:"#00ff00"},title:"Click to edit company",children:e.companies.name}),(0,N.jsxs)(lE,{children:[e.relationship||"Associated",e.companies.website&&` \xb7 ${e.companies.website}`]})]},e.contact_companies_id)))]})]}),(0,N.jsxs)("div",{style:{width:"80%",flexGrow:1,boxSizing:"border-box",overflow:"hidden",paddingRight:"5px"},children:[(0,N.jsxs)(yE,{children:[(0,N.jsx)(vE,{active:"interactions"===k,onClick:()=>j("interactions"),children:"Interactions"}),(0,N.jsx)(vE,{active:"opportunities"===k,onClick:()=>j("opportunities"),children:"Deals"}),(0,N.jsx)(vE,{active:"introductions"===k,onClick:()=>j("introductions"),children:"Introductions"}),(0,N.jsx)(vE,{active:"notes"===k,onClick:()=>j("notes"),children:"Notes"}),(0,N.jsx)(vE,{active:"related"===k,onClick:()=>j("related"),children:"Related"})]}),(0,N.jsx)(bE,{active:"interactions"===k,children:(0,N.jsxs)(iE,{children:[(0,N.jsxs)(yE,{style:{borderBottom:"1px solid #222",marginTop:"-10px",paddingLeft:"0"},children:[(0,N.jsx)(vE,{active:"emails"===A,onClick:()=>R("emails"),style:{fontSize:"0.9rem",padding:"8px 20px",cursor:"pointer"},title:"View email interactions",children:"Emails"}),(0,N.jsx)(vE,{active:"whatsapp"===A,onClick:()=>R("whatsapp"),style:{fontSize:"0.9rem",padding:"8px 20px",cursor:"pointer"},title:"View WhatsApp interactions",children:"WhatsApp"}),(0,N.jsx)(vE,{active:!1,onClick:()=>{},style:{fontSize:"0.9rem",padding:"8px 20px",opacity:.5,cursor:"not-allowed"},title:"Meetings section - coming soon",children:"Meetings"})]}),"emails"===A&&(0,N.jsx)(PS.A,{isOpen:!0,onRequestClose:()=>{},contact:n,showWhatsApp:!1,showEmail:!0,showMeetings:!1,inline:!0}),"whatsapp"===A&&(0,N.jsx)(PS.A,{isOpen:!0,onRequestClose:()=>{},contact:n,showWhatsApp:!0,showEmail:!1,showMeetings:!1,inline:!0}),"meetings"===A&&(0,N.jsx)("div",{style:{padding:"30px 0",color:"#999",textAlign:"center"},children:"Meetings functionality coming soon"})]})}),(0,N.jsx)(bE,{active:"opportunities"===k,children:(0,N.jsx)(vS.A,{isOpen:!0,onClose:()=>{},contactData:n,showOnlyCreateTab:!1,onSave:()=>{Jt()},inline:!0})}),(0,N.jsx)(bE,{active:"introductions"===k,children:(0,N.jsxs)(iE,{children:[(0,N.jsxs)(ik,{children:[(0,N.jsx)("div",{style:{color:"#00ff00",fontSize:"1.1rem",fontWeight:"bold"},children:P?"Loading...":0===O.length?"No Introductions":`${O.length} Introduction${1!==O.length?"s":""} Found`}),(0,N.jsxs)(rk,{onClick:()=>{Et(!0)},children:[(0,N.jsx)(B.GGD,{size:16}),"ADD NEW"]})]}),P?(0,N.jsx)("div",{style:{padding:"30px 0",color:"#00ff00",textAlign:"center"},children:"Loading introductions..."}):0===O.length?(0,N.jsx)("div",{style:{padding:"30px 0",color:"#999",textAlign:"center"},children:"No introductions found for this contact"}):(0,N.jsx)(nk,{children:O.map((e=>(0,N.jsxs)(UE,{children:[(0,N.jsxs)(WE,{children:[(0,N.jsx)(qE,{children:e.date?new Date(e.date).toLocaleDateString():"No date"}),(0,N.jsx)(KE,{status:e.status,children:e.status})]}),(0,N.jsxs)(YE,{children:[(0,N.jsx)(JE,{children:"Introduced to:"}),(0,N.jsx)(XE,{children:e.otherContacts.length>0?e.otherContacts.join(" \u2022 "):"No other contacts found"})]}),e.relatedCompanies.length>0&&(0,N.jsxs)(QE,{children:[(0,N.jsx)(ZE,{children:"Related Companies:"}),(0,N.jsx)(ek,{children:e.relatedCompanies.join(", ")})]}),e.description&&(0,N.jsx)(tk,{children:e.description}),e.category&&(0,N.jsx)(ok,{children:e.category})]},e.id)))})]})}),(0,N.jsx)(bE,{active:"notes"===k,children:(0,N.jsxs)(iE,{children:[(0,N.jsxs)(ik,{children:[(0,N.jsx)("div",{style:{color:"#00ff00",fontSize:"1.1rem",fontWeight:"bold"},children:0===x.length?"No Notes":`${x.length} Note${1!==x.length?"s":""} Found`}),(0,N.jsxs)(rk,{onClick:Qt,children:[(0,N.jsx)(B.GGD,{size:16}),"ADD NEW"]})]}),0===x.length?(0,N.jsx)("div",{style:{padding:"30px 0",color:"#999",textAlign:"center"},children:"No notes found for this contact"}):(0,N.jsx)("div",{children:x.map((e=>(0,N.jsxs)(pE,{onClick:Qt,style:{cursor:"pointer"},children:[(0,N.jsx)(hE,{children:e.title}),(0,N.jsx)(fE,{children:Bt(e.created_at)}),(0,N.jsx)("div",{style:{marginTop:"10px",fontSize:"0.9rem",color:"#ddd"},children:e.text})]},e.note_id)))})]})}),(0,N.jsx)(bE,{active:"related"===k,children:(0,N.jsx)(iE,{children:(0,N.jsx)("div",{style:{padding:"30px 0",color:"#999",textAlign:"center"},children:"Coming soon"})})})]})]}),it&&(0,N.jsx)(pt.A,{isOpen:it,onRequestClose:()=>{at(!1)},contact:n,onTagAdded:e=>{c((t=>t.some((t=>t.tag_id===e.tag_id))?t:[...t,e]))},onTagRemoved:e=>{c((t=>t.filter((t=>t.tag_id!==e.tag_id))))}}),st&&(0,N.jsx)(Lo.A,{isOpen:st,onRequestClose:()=>{lt(!1)},contact:n,onCityAdded:e=>{u((t=>t.some((t=>t.city_id===e.id))?t:[...t,{city_id:e.id,name:e.name,country:e.country}]))},onCityRemoved:e=>{u((t=>t.filter((t=>t.city_id!==e.id))))}}),Ye&&(0,N.jsx)(ak,{onClick:mo,children:(0,N.jsxs)(sk,{onClick:e=>e.stopPropagation(),children:[(0,N.jsxs)(lk,{children:[(0,N.jsx)(hk,{active:"contacts"===Xe,onClick:()=>yo("contacts"),children:"Related contacts"}),(0,N.jsx)(hk,{active:"companies"===Xe,onClick:()=>yo("companies"),children:"Related Companies"}),(0,N.jsx)(hk,{active:!1,onClick:()=>{},style:{opacity:.5,cursor:"not-allowed"},title:"Coming soon - no deal_cities table yet",children:"Related Deals"}),(0,N.jsxs)("div",{style:{marginTop:"20px"},children:[(0,N.jsxs)("div",{style:{color:"#00ff00",marginBottom:"10px",fontSize:"0.9rem",fontWeight:"bold"},children:["Filter by Cities",Ze.length>0&&(0,N.jsxs)("span",{style:{color:"#999",fontSize:"0.8rem",marginLeft:"8px"},children:["(",Ze.length," selected)"]})]}),(0,N.jsx)("div",{style:{display:"flex",flexDirection:"column",gap:"6px"},children:d.length>0?d.map((e=>(0,N.jsx)(fk,{selected:Ze.includes(e.city_id),onClick:()=>{return t=e.city_id,void et((e=>{const o=e.includes(t)?e.filter((e=>e!==t)):[...e,t];return o.length>0?vo(o,Xe):ot([]),o}));var t},children:e.name},e.city_id))):(0,N.jsx)("span",{style:{color:"#666",fontStyle:"italic",fontSize:"0.8rem"},children:"No cities"})})]})]}),(0,N.jsxs)(ck,{children:[(0,N.jsxs)(dk,{children:[(0,N.jsx)(uk,{children:"City Relationships"}),(0,N.jsx)(pk,{onClick:mo,children:(0,N.jsx)(B.yGN,{size:20})})]}),(0,N.jsx)(bk,{children:0===Ze.length?(0,N.jsxs)("div",{style:{display:"flex",alignItems:"center",justifyContent:"center",height:"200px",color:"#999",textAlign:"center"},children:["Select one or more cities to see related ",Xe]}):nt?(0,N.jsxs)(vk,{children:["Loading ",Xe,"..."]}):0===tt.length?(0,N.jsxs)("div",{style:{display:"flex",alignItems:"center",justifyContent:"center",height:"200px",color:"#999",textAlign:"center"},children:["No ",Xe," found with selected cities"]}):(0,N.jsxs)("div",{children:[(0,N.jsxs)("div",{style:{padding:"15px 20px 10px 20px",borderBottom:"1px solid #333",color:"#00ff00",fontSize:"1.1rem",fontWeight:"bold"},children:[tt.length," ",Xe," found"]}),tt.map((t=>"contacts"===Xe?(0,N.jsxs)(gk,{onClick:()=>{t.contact_id!==e&&(o(`/contacts/${t.contact_id}`),mo())},children:[(0,N.jsxs)(mk,{children:[t.first_name," ",t.last_name]}),(0,N.jsxs)(yk,{children:[t.job_role&&`${t.job_role} \u2022 `,t.category||"Uncategorized",t.score&&` \u2022 Score: ${t.score}/5`]})]},t.contact_id):"companies"===Xe?(0,N.jsxs)(gk,{onClick:()=>{o(`/companies?search=${encodeURIComponent(t.name)}`),mo()},children:[(0,N.jsx)(mk,{children:t.name}),(0,N.jsxs)(yk,{children:[t.category&&`${t.category} \u2022 `,t.website&&`${t.website} \u2022 `,t.description||"No description"]})]},t.company_id):"deals"===Xe?(0,N.jsxs)(gk,{onClick:()=>{j("opportunities"),mo()},children:[(0,N.jsx)(mk,{children:t.opportunity}),(0,N.jsxs)(yk,{children:[t.total_investment&&`$${t.total_investment.toLocaleString()} \u2022 `,t.category&&`${t.category} \u2022 `,t.stage]})]},t.deal_id):void 0))]})})]})]})}),mt&&n&&(0,N.jsx)(bS.A,{isOpen:mt,onClose:()=>{yt(!1)},linkedInUrl:n.linkedin||"",contactName:`${n.first_name||""} ${n.last_name||""}`.trim(),firstName:n.first_name||"",lastName:n.last_name||"",email:f.length>0?f[0].email:"",jobRole:n.job_role||"",onSaveData:async t=>{try{const o={};if(t.jobRole&&(o.job_role=t.jobRole),t.city,Object.keys(o).length>0){const{error:t}=await D.supabase.from("contacts").update(o).eq("contact_id",e);if(t)throw t;r((e=>({...e,...o}))),Pm.oR.success("LinkedIn information updated successfully")}t.company&&Pm.oR.info("Company information extracted. You may need to manually associate the company.")}catch(S){console.error("Error saving LinkedIn data:",S),Pm.oR.error("Failed to save LinkedIn information")}}}),vt&&(0,N.jsx)(TS,{isOpen:vt,onRequestClose:()=>{bt(!1)},contact:n,onUpdateEmails:()=>{(async()=>{try{const{data:t,error:o}=await D.supabase.from("contact_emails").select("*").eq("contact_id",e);if(o)throw o;g(t||[])}catch(t){console.error("Error refreshing emails:",t)}})()}}),xt&&n&&(0,N.jsx)(PS.A,{isOpen:xt,onRequestClose:()=>{wt(!1),_t({showWhatsApp:!0,showEmail:!0,showMeetings:!0})},contact:n,showWhatsApp:Ct.showWhatsApp,showEmail:Ct.showEmail,showMeetings:Ct.showMeetings}),St&&(0,N.jsx)(NS.A,{isOpen:St,onClose:()=>{Et(!1)},onSave:()=>{Xt(),Et(!1)},preselectedContact:n}),kt&&(0,N.jsx)(ZS,{isOpen:kt,onRequestClose:()=>{jt(!1)},contact:n,onNotesUpdated:()=>{Zt()}}),At&&Ot&&(0,N.jsx)(Uw.A,{isOpen:At,onRequestClose:()=>{Rt(!1),Tt(null)},company:Ot,contactId:null===n||void 0===n?void 0:n.contact_id,onCompanyUpdated:()=>{(async()=>{if(e)try{const{data:t,error:o}=await D.supabase.from("contact_companies").select("\n          contact_companies_id,\n          relationship,\n          is_primary,\n          companies (\n            company_id,\n            name,\n            website,\n            category\n          )\n        ").eq("contact_id",e);if(o)throw o;h(t||[])}catch(t){console.error("Error fetching companies:",t)}})(),Rt(!1),Tt(null)}})]}):(0,N.jsx)(eE,{children:(0,N.jsxs)(CE,{children:[(0,N.jsx)("h2",{children:"Contact Not Found"}),(0,N.jsx)("p",{children:"The requested contact could not be found."}),(0,N.jsx)("button",{onClick:()=>o("/contacts/simple"),children:"Back to Contacts"})]})});var bo},wk=P.Ay.div`
  background: white;
  border-radius: 8px;
  box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
  padding: 2rem;
  max-width: 800px;
  margin: 0 auto;
`,Ck=P.Ay.form`
  display: grid;
  grid-template-columns: 1fr 1fr;
  gap: 1.5rem;
`,_k=P.Ay.div`
  display: flex;
  flex-direction: column;
`,Sk=P.Ay.label`
  margin-bottom: 0.5rem;
  font-weight: 500;
`,Ek=P.Ay.input`
  padding: 0.75rem;
  border: 1px solid #ddd;
  border-radius: 4px;
  font-size: 1rem;
`,kk=P.Ay.select`
  padding: 0.75rem;
  border: 1px solid #ddd;
  border-radius: 4px;
  font-size: 1rem;
`,jk=P.Ay.div`
  grid-column: span 2;
  display: flex;
  justify-content: flex-end;
  gap: 1rem;
  margin-top: 1rem;
`,Ak=P.Ay.button`
  padding: 0.75rem 1.5rem;
  border-radius: 4px;
  font-size: 1rem;
  cursor: pointer;
`,Rk=(0,P.Ay)(Ak)`
  background-color: #0070f3;
  color: white;
  border: none;
  
  &:hover {
    background-color: #0060df;
  }
`,Ok=(0,P.Ay)(Ak)`
  background-color: white;
  color: #333;
  border: 1px solid #ddd;
  
  &:hover {
    background-color: #f8f9fa;
  }
`,Tk=()=>{const{id:e}=(0,i.g)(),o=(0,i.Zp)(),[n,r]=(0,t.useState)({first_name:"",last_name:"",email:"",email2:"",email3:"",mobile:"",contact_category:""}),[a,s]=(0,t.useState)(!0),[l,c]=(0,t.useState)(!1);function d(e){const{name:t,value:o}=e.target;r((e=>({...e,[t]:o})))}return(0,t.useEffect)((()=>{e?async function(e){s(!0);try{const{data:t,error:o}=await D.supabase.from("contacts").select("*").eq("id",e).single();o?console.error("Error fetching contact:",o):r(t||{})}catch(t){console.error("Exception fetching contact:",t)}finally{s(!1)}}(e):s(!1)}),[e]),a?(0,N.jsxs)(fe,{children:[(0,N.jsx)("h1",{children:"Edit Contact"}),(0,N.jsx)("p",{children:"Loading contact details..."})]}):(0,N.jsxs)(fe,{children:[(0,N.jsx)("h1",{children:"Edit Contact"}),(0,N.jsx)(wk,{children:(0,N.jsxs)(Ck,{onSubmit:async function(t){t.preventDefault(),c(!0);try{const{error:t}=await D.supabase.from("contacts").update(n).eq("id",e);t?(console.error("Error updating contact:",t),alert("Error updating contact")):o("/contacts")}catch(r){console.error("Exception updating contact:",r),alert("Error updating contact")}finally{c(!1)}},children:[(0,N.jsxs)(_k,{children:[(0,N.jsx)(Sk,{htmlFor:"first_name",children:"First Name"}),(0,N.jsx)(Ek,{id:"first_name",name:"first_name",value:n.first_name||"",onChange:d})]}),(0,N.jsxs)(_k,{children:[(0,N.jsx)(Sk,{htmlFor:"last_name",children:"Last Name"}),(0,N.jsx)(Ek,{id:"last_name",name:"last_name",value:n.last_name||"",onChange:d})]}),(0,N.jsxs)(_k,{children:[(0,N.jsx)(Sk,{htmlFor:"email",children:"Primary Email"}),(0,N.jsx)(Ek,{id:"email",name:"email",type:"email",value:n.email||"",onChange:d})]}),(0,N.jsxs)(_k,{children:[(0,N.jsx)(Sk,{htmlFor:"email2",children:"Secondary Email"}),(0,N.jsx)(Ek,{id:"email2",name:"email2",type:"email",value:n.email2||"",onChange:d})]}),(0,N.jsxs)(_k,{children:[(0,N.jsx)(Sk,{htmlFor:"email3",children:"Additional Email"}),(0,N.jsx)(Ek,{id:"email3",name:"email3",type:"email",value:n.email3||"",onChange:d})]}),(0,N.jsxs)(_k,{children:[(0,N.jsx)(Sk,{htmlFor:"mobile",children:"Mobile"}),(0,N.jsx)(Ek,{id:"mobile",name:"mobile",value:n.mobile||"",onChange:d})]}),(0,N.jsxs)(_k,{children:[(0,N.jsx)(Sk,{htmlFor:"contact_category",children:"Category"}),(0,N.jsxs)(kk,{id:"contact_category",name:"contact_category",value:n.contact_category||"",onChange:d,children:[(0,N.jsx)("option",{value:"",children:"Select a category"}),(0,N.jsx)("option",{value:"Customer",children:"Customer"}),(0,N.jsx)("option",{value:"Lead",children:"Lead"}),(0,N.jsx)("option",{value:"Partner",children:"Partner"}),(0,N.jsx)("option",{value:"Vendor",children:"Vendor"}),(0,N.jsx)("option",{value:"Skip",children:"Skip"})]})]}),(0,N.jsxs)(jk,{children:[(0,N.jsx)(Ok,{type:"button",onClick:()=>o("/contacts"),children:"Cancel"}),(0,N.jsx)(Rk,{type:"submit",disabled:l,children:l?"Saving...":"Save Changes"})]})]})})]})};var Dk=o(5852);const Pk=P.Ay.div`
  padding: 20px;
  max-width: 1200px;
  margin: 0 auto;
`,Nk=P.Ay.div`
  display: flex;
  justify-content: space-between;
  align-items: center;
  margin-bottom: 20px;
  padding-bottom: 20px;
  border-bottom: 1px solid #333;
`,Ik=P.Ay.h1`
  color: #00ff00;
  margin: 0;
  font-family: 'Courier New', monospace;
`,Mk=P.Ay.button`
  background-color: #222;
  color: ${e=>e.danger?"#ff5555":"#00ff00"};
  border: 1px solid ${e=>e.danger?"#ff5555":"#00ff00"};
  padding: 8px 12px;
  border-radius: 4px;
  cursor: pointer;
  display: inline-flex;
  align-items: center;
  gap: 6px;
  margin-left: 8px;
  
  &:hover {
    background-color: #333;
  }
  
  &:disabled {
    opacity: 0.5;
    cursor: not-allowed;
  }
`,Lk=(P.Ay.div`
  display: grid;
  grid-template-columns: 1fr 1fr;
  gap: 20px;
  
  @media (max-width: 992px) {
    grid-template-columns: 1fr;
  }
`,P.Ay.div`
  background-color: #1a1a1a;
  border-radius: 8px;
  border: 1px solid #333;
  padding: 20px;
  margin-bottom: 20px;
`),Fk=P.Ay.div`
  display: grid;
  grid-template-columns: 1fr 1fr;
  gap: 16px;
  
  @media (max-width: 768px) {
    grid-template-columns: 1fr;
  }
`,Gk=P.Ay.div`
  margin-bottom: 20px;
`,zk=P.Ay.h3`
  color: #00ff00;
  margin: 0 0 15px 0;
  font-size: 1rem;
  display: flex;
  align-items: center;
  gap: 8px;
  padding-bottom: 6px;
  border-bottom: 1px solid #333;
`,Hk=P.Ay.div`
  margin-bottom: 15px;
`,Bk=P.Ay.label`
  color: #999;
  display: block;
  margin-bottom: 5px;
  font-size: 0.8rem;
`,Vk=P.Ay.input`
  background-color: #222;
  border: 1px solid #444;
  border-radius: 4px;
  color: #eee;
  padding: 8px 10px;
  width: 100%;
  font-size: 0.9rem;
  
  &:focus {
    outline: none;
    border-color: #00ff00;
  }
`,$k=P.Ay.select`
  background-color: #222;
  border: 1px solid #444;
  border-radius: 4px;
  color: #eee;
  padding: 8px 10px;
  width: 100%;
  font-size: 0.9rem;
  
  &:focus {
    outline: none;
    border-color: #00ff00;
  }
`,Uk=P.Ay.textarea`
  background-color: #222;
  border: 1px solid #444;
  border-radius: 4px;
  color: #eee;
  padding: 8px 10px;
  width: 100%;
  min-height: 100px;
  font-size: 0.9rem;
  resize: vertical;
  
  &:focus {
    outline: none;
    border-color: #00ff00;
  }
`,Wk=P.Ay.div`
  margin-bottom: 20px;
`,qk=P.Ay.div`
  display: flex;
  border-bottom: 1px solid #333;
`,Kk=P.Ay.div`
  padding: 10px 15px;
  cursor: pointer;
  color: ${e=>e.active?"#00ff00":"#999"};
  border-bottom: 2px solid ${e=>e.active?"#00ff00":"transparent"};
  
  &:hover {
    color: ${e=>e.active?"#00ff00":"#ddd"};
  }
`,Yk=P.Ay.div`
  display: ${e=>e.active?"block":"none"};
  padding: 20px 0;
`,Jk=P.Ay.div`
  display: flex;
  flex-direction: column;
  align-items: center;
  justify-content: center;
  height: 70vh;
  color: #00ff00;
`,Xk=P.Ay.div`
  background-color: rgba(255, 70, 70, 0.2);
  border: 1px solid #ff4646;
  color: #ff9999;
  padding: 12px;
  border-radius: 4px;
  margin-bottom: 20px;
  display: flex;
  align-items: center;
  gap: 10px;
`,Qk=P.Ay.div`
  margin-bottom: 20px;
`,Zk=P.Ay.div`
  padding: 12px;
  border: 1px solid #444;
  border-radius: 4px;
  margin-bottom: 10px;
  cursor: pointer;
  
  &:hover {
    background-color: #222;
  }
`,ej=P.Ay.div`
  font-weight: bold;
  margin-bottom: 5px;
  color: #eee;
`,tj=P.Ay.div`
  font-size: 0.85rem;
  color: #999;
`,oj=P.Ay.span`
  background-color: #222;
  color: #00ff00;
  border: 1px solid #00ff00;
  border-radius: 12px;
  padding: 2px 6px;
  font-size: 0.65rem;
  margin-right: 4px;
  white-space: nowrap;
`,nj=P.Ay.div`
  margin-top: 8px;
`,rj=P.Ay.div`
  display: flex;
  align-items: center;
  margin-bottom: 8px;
  gap: 8px;
`,ij=P.Ay.table`
  width: 100%;
  border-collapse: collapse;
  margin-bottom: 20px;
  
  th, td {
    padding: 8px 12px;
    text-align: left;
    border-bottom: 1px solid #333;
  }
  
  th {
    color: #999;
    font-weight: normal;
    font-size: 0.85rem;
  }
  
  td {
    color: #eee;
  }
  
  tr:hover td {
    background-color: #222;
  }
`,aj=P.Ay.label`
  display: flex;
  align-items: center;
  gap: 8px;
  padding: 8px;
  border-radius: 4px;
  cursor: pointer;
  
  &:hover {
    background-color: #222;
  }
`,sj=P.Ay.input`
  appearance: none;
  width: 16px;
  height: 16px;
  border: 1px solid #00ff00;
  border-radius: 50%;
  position: relative;
  
  &:checked {
    &:after {
      content: '';
      position: absolute;
      top: 3px;
      left: 3px;
      width: 8px;
      height: 8px;
      background-color: #00ff00;
      border-radius: 50%;
    }
  }
`,lj=()=>{const{id:e}=(0,i.g)(),o=(0,i.Zp)(),[n,r]=(0,t.useState)({first_name:"",last_name:"",category:"Inbox",job_role:"",linkedin:"",description:"",score:null,birthday:null}),[a,s]=(0,t.useState)([{email:"",type:"personal",is_primary:!1}]),[l,c]=(0,t.useState)([{mobile:"",type:"personal",is_primary:!1}]),[d,u]=(0,t.useState)([]),[p,h]=(0,t.useState)([]),[f,g]=(0,t.useState)([]),[m,y]=(0,t.useState)(!0),[v,b]=(0,t.useState)(!1),[x,w]=(0,t.useState)(null),[C,_]=(0,t.useState)("basic"),[S,E]=(0,t.useState)([]),[k,j]=(0,t.useState)(null),[A,R]=(0,t.useState)({}),[O,T]=(0,t.useState)([]),[P,I]=(0,t.useState)([]),[M,L]=(0,t.useState)([]),[F,G]=(0,t.useState)(!1),[z,H]=(0,t.useState)([]),[V,$]=(0,t.useState)([]),[U,W]=(0,t.useState)([]),q=["personal","work","other"];(0,t.useEffect)((()=>{(async()=>{y(!0),w(null);try{await K(),e?await Y(e):y(!1)}catch(t){console.error("Error loading data:",t),w(t.message||"Failed to load data"),y(!1)}})()}),[e]);const K=async()=>{const[e,t,o]=await Promise.all([D.supabase.from("tags").select("*").order("name"),D.supabase.from("cities").select("*").order("name"),D.supabase.from("companies").select("*").order("name")]);if(e.error)throw e.error;if(t.error)throw t.error;if(o.error)throw o.error;H(e.data||[]),$(t.data||[]),W(o.data||[])},Y=async e=>{try{var t,o,n,i;const{data:a,error:l}=await D.supabase.from("contacts").select("*").eq("contact_id",e).single();if(l)throw l;if(!a)throw new Error("Contact not found");r(a);const[d,p,f,m,y,v]=await Promise.all([D.supabase.from("contact_emails").select("*").eq("contact_id",e).order("is_primary",{ascending:!1}),D.supabase.from("contact_mobiles").select("*").eq("contact_id",e).order("is_primary",{ascending:!1}),D.supabase.from("contact_tags").select("tag_id").eq("contact_id",e),D.supabase.from("contact_cities").select("city_id").eq("contact_id",e),D.supabase.from("contact_companies").select("company_id, relationship, is_primary").eq("contact_id",e),D.supabase.from("interactions").select("*").eq("contact_id",e).order("interaction_date",{ascending:!1}).limit(10)]);s(null!==(t=d.data)&&void 0!==t&&t.length?d.data:[{email:"",type:"personal",is_primary:!1}]),c(null!==(o=p.data)&&void 0!==o&&o.length?p.data:[{mobile:"",type:"personal",is_primary:!1}]),u((null===(n=f.data)||void 0===n?void 0:n.map((e=>e.tag_id)))||[]),h((null===(i=m.data)||void 0===i?void 0:i.map((e=>e.city_id)))||[]),g(y.data||[]),T(v.data||[])}catch(a){throw console.error("Error loading contact:",a),a}finally{y(!1)}},J=e=>{const{name:t,value:o}=e.target;r((e=>({...e,[t]:o})))},X=(e,t,o)=>{const n=[...a];n[e]={...n[e],[t]:o},s(n)},Q=(e,t,o)=>{const n=[...l];n[e]={...n[e],[t]:o},c(n)},Z=(e,t,o)=>{const n=[...f];n[e]={...n[e],[t]:o},g(n)},ee=(e,t)=>{if(!e||!t)return 0;const o=e.toLowerCase(),n=t.toLowerCase();if(o===n)return 1;if(0===o.length||0===n.length)return 0;const r=Array(o.length+1).fill().map((()=>Array(n.length+1).fill(0)));for(let a=0;a<=o.length;a++)r[a][0]=a;for(let a=0;a<=n.length;a++)r[0][a]=a;for(let a=1;a<=o.length;a++)for(let e=1;e<=n.length;e++){const t=o[a-1]===n[e-1]?0:1;r[a][e]=Math.min(r[a-1][e]+1,r[a][e-1]+1,r[a-1][e-1]+t)}const i=Math.max(o.length,n.length);return i>0?1-r[o.length][n.length]/i:1},te=e=>{const t={first_name:"current",last_name:"current",category:"current",job_role:"current",linkedin:"current",description:"current",score:"current",birthday:"current",keep_in_touch_frequency:"current",emails:"combine",mobiles:"combine",tags:"combine",cities:"combine",companies:"combine"};!n.first_name&&e.first_name&&(t.first_name="duplicate"),!n.last_name&&e.last_name&&(t.last_name="duplicate"),"Inbox"===n.category&&"Inbox"!==e.category&&(t.category="duplicate"),!n.job_role&&e.job_role&&(t.job_role="duplicate"),!n.linkedin&&e.linkedin&&(t.linkedin="duplicate"),!n.description&&e.description&&(t.description="duplicate"),null!==n.score&&void 0!==n.score||null===e.score||(t.score="duplicate"),!n.birthday&&e.birthday&&(t.birthday="duplicate"),!n.keep_in_touch_frequency&&e.keep_in_touch_frequency&&(t.keep_in_touch_frequency="duplicate"),R(t)},oe=(e,t)=>{R((o=>({...o,[e]:t})))};return m&&!n.contact_id?(0,N.jsx)(Pk,{children:(0,N.jsx)(Jk,{children:(0,N.jsx)("div",{children:"Loading Data..."})})}):(0,N.jsxs)(Pk,{children:[(0,N.jsxs)(Nk,{children:[(0,N.jsx)(Ik,{children:e?"Edit Contact":"New Contact"}),(0,N.jsx)("div",{children:(0,N.jsxs)(Mk,{onClick:()=>{o(e?`/contacts/${e}`:"/contacts/simple")},danger:!0,children:[(0,N.jsx)(B.yGN,{})," Cancel"]})})]}),x&&(0,N.jsxs)(Xk,{children:[(0,N.jsx)(B.eHT,{}),(0,N.jsx)("div",{children:x})]}),(0,N.jsxs)(Wk,{children:[(0,N.jsxs)(qk,{children:[(0,N.jsx)(Kk,{active:"basic"===C,onClick:()=>_("basic"),children:"Basic Information"}),(0,N.jsx)(Kk,{active:"connections"===C,onClick:()=>_("connections"),children:"Connections"}),(0,N.jsx)(Kk,{active:"duplicates"===C,onClick:()=>_("duplicates"),children:"Find Duplicates"}),(0,N.jsx)(Kk,{active:"lastInteractions"===C,onClick:()=>_("lastInteractions"),children:"Last Interactions"})]}),(0,N.jsx)(Yk,{active:"basic"===C,children:(0,N.jsxs)(Lk,{children:[(0,N.jsxs)(Fk,{children:[(0,N.jsxs)(Hk,{style:{width:"97%"},children:[(0,N.jsx)(Bk,{htmlFor:"first_name",children:"First Name"}),(0,N.jsx)(Vk,{id:"first_name",name:"first_name",value:n.first_name||"",onChange:J,placeholder:"First Name"})]}),(0,N.jsxs)(Hk,{style:{width:"97%"},children:[(0,N.jsx)(Bk,{htmlFor:"last_name",children:"Last Name"}),(0,N.jsx)(Vk,{id:"last_name",name:"last_name",value:n.last_name||"",onChange:J,placeholder:"Last Name"})]}),(0,N.jsxs)(Hk,{children:[(0,N.jsx)(Bk,{htmlFor:"category",children:"Category"}),(0,N.jsxs)($k,{id:"category",name:"category",value:n.category||"Not Set",onChange:J,children:[(0,N.jsx)("option",{value:"Not Set",children:"Not Set"}),(0,N.jsx)("option",{value:"Inbox",children:"Inbox"}),(0,N.jsx)("option",{value:"Founder",children:"Founder"}),(0,N.jsx)("option",{value:"Professional Investor",children:"Professional Investor"}),(0,N.jsx)("option",{value:"Manager",children:"Manager"}),(0,N.jsx)("option",{value:"Team",children:"Team"}),(0,N.jsx)("option",{value:"Advisor",children:"Advisor"}),(0,N.jsx)("option",{value:"Supplier",children:"Supplier"}),(0,N.jsx)("option",{value:"Friend and Family",children:"Friend and Family"}),(0,N.jsx)("option",{value:"Institution",children:"Institution"}),(0,N.jsx)("option",{value:"Media",children:"Media"}),(0,N.jsx)("option",{value:"Student",children:"Student"}),(0,N.jsx)("option",{value:"Skip",children:"Skip"}),(0,N.jsx)("option",{value:"WhatsApp Group Contact",children:"WhatsApp Group Contact"}),(0,N.jsx)("option",{value:"SUBSCRIBER NEWSLETTER",children:"Subscriber Newsletter"}),(0,N.jsx)("option",{value:"Other",children:"Other"})]})]}),(0,N.jsxs)(Hk,{style:{width:"97%"},children:[(0,N.jsx)(Bk,{htmlFor:"job_role",children:"Job Role"}),(0,N.jsx)(Vk,{id:"job_role",name:"job_role",value:n.job_role||"",onChange:J,placeholder:"Job Role"})]}),(0,N.jsxs)(Hk,{style:{width:"97%"},children:[(0,N.jsx)(Bk,{htmlFor:"linkedin",children:"LinkedIn URL"}),(0,N.jsxs)("div",{style:{display:"flex",gap:"8px"},children:[(0,N.jsx)(Vk,{id:"linkedin",name:"linkedin",value:n.linkedin||"",onChange:J,placeholder:"https://linkedin.com/in/...",style:{flex:1}}),!n.linkedin&&(0,N.jsx)(Mk,{onClick:()=>(async()=>{if(!n.first_name&&!n.last_name)return void nt.Ay.error("Please enter a name first");const t=nt.Ay.loading("Searching for LinkedIn profile...");try{var o,i,s;let l=[];if(e){const{data:t,error:o}=await D.supabase.from("contact_emails").select("email").eq("contact_id",e).order("is_primary",{ascending:!1});t&&t.length>0&&(l=t.map((e=>e.email)))}const c=a.filter((e=>e.email.trim())).map((e=>e.email.trim())),d=[...new Set([...l,...c])];if(0===d.length)return nt.Ay.dismiss(t),void nt.Ay.error("Please add at least one email address");const u=d[0],p=await fetch("/.netlify/functions/apollo-enrich",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({contactId:e||"",first_name:n.first_name,last_name:n.last_name,email:u})}),h=await p.json();if(nt.Ay.dismiss(t),h.error)return nt.Ay.error("Failed to find LinkedIn profile"),void console.error("Apollo API error:",h.error);const f=(null===(o=h.data)||void 0===o?void 0:o.linkedin)||(null===(i=h.data)||void 0===i?void 0:i.linkedin_url)||(null===(s=h.person)||void 0===s?void 0:s.linkedin_url)||null;f?(r({...n,linkedin:f}),nt.Ay.success("LinkedIn profile found!")):nt.Ay.error("No LinkedIn profile found for this contact")}catch(x){nt.Ay.dismiss(t),nt.Ay.error("Error finding LinkedIn profile"),console.error("Error finding LinkedIn profile:",x)}})(),style:{padding:"4px 8px",minWidth:"auto",height:"40px"},title:"Find LinkedIn with Apollo",children:(0,N.jsx)(B.ayE,{})})]})]}),(0,N.jsxs)(Hk,{style:{width:"97%"},children:[(0,N.jsx)(Bk,{htmlFor:"score",children:"Score (1-5)"}),(0,N.jsx)(Vk,{id:"score",name:"score",type:"number",value:n.score||"",onChange:J,placeholder:"Score (1-5)",min:"1",max:"5"})]}),(0,N.jsxs)(Hk,{style:{width:"97%"},children:[(0,N.jsx)(Bk,{htmlFor:"birthday",children:"Birthday"}),(0,N.jsx)(Vk,{id:"birthday",name:"birthday",type:"date",value:n.birthday||"",onChange:J})]}),(0,N.jsxs)(Hk,{children:[(0,N.jsx)(Bk,{htmlFor:"keep_in_touch_frequency",children:"Last Interaction Frequency"}),(0,N.jsxs)($k,{id:"keep_in_touch_frequency",name:"keep_in_touch_frequency",value:n.keep_in_touch_frequency||"",onChange:J,children:[(0,N.jsx)("option",{value:"Not Set",children:"Not Set"}),(0,N.jsx)("option",{value:"Weekly",children:"Weekly"}),(0,N.jsx)("option",{value:"Monthly",children:"Monthly"}),(0,N.jsx)("option",{value:"Quarterly",children:"Quarterly"}),(0,N.jsx)("option",{value:"Twice per Year",children:"Twice per Year"}),(0,N.jsx)("option",{value:"Once per Year",children:"Once per Year"}),(0,N.jsx)("option",{value:"Do not keep in touch",children:"Do not keep in touch"})]})]})]}),(0,N.jsxs)(Gk,{style:{width:"98%"},children:[(0,N.jsx)(Bk,{htmlFor:"description",children:"Description / Notes"}),(0,N.jsx)(Uk,{id:"description",name:"description",value:n.description||"",onChange:J,placeholder:"Add notes about this contact..."})]}),(0,N.jsx)("div",{style:{display:"flex",justifyContent:"flex-end",marginTop:"20px"},children:(0,N.jsxs)(Mk,{onClick:async()=>{if(n.first_name||n.last_name){b(!0);try{let t=e;if(e){const{error:t}=await D.supabase.from("contacts").update({first_name:n.first_name,last_name:n.last_name,category:n.category,job_role:n.job_role,linkedin:n.linkedin,description:n.description,score:n.score,birthday:n.birthday,keep_in_touch_frequency:n.keep_in_touch_frequency,last_modified_at:(new Date).toISOString()}).eq("contact_id",e);if(t)throw t;nt.Ay.success("Basic information updated successfully")}else{const{data:e,error:r}=await D.supabase.from("contacts").insert({first_name:n.first_name,last_name:n.last_name,category:n.category,job_role:n.job_role,linkedin:n.linkedin,description:n.description,score:n.score,birthday:n.birthday,keep_in_touch_frequency:n.keep_in_touch_frequency,created_at:(new Date).toISOString(),last_modified_at:(new Date).toISOString()}).select("contact_id").single();if(r)throw r;t=e.contact_id,nt.Ay.success("Contact created successfully"),o(`/contact-integrity/${t}`)}}catch(t){console.error("Error saving basic info:",t),nt.Ay.error(`Failed to ${e?"update":"create"} contact`)}finally{b(!1)}}else nt.Ay.error("Please enter a first or last name")},disabled:v,children:[(0,N.jsx)(B.Bc_,{})," ",v?"Saving...":"Save Basic Information"]})})]})}),(0,N.jsxs)(Yk,{active:"connections"===C,children:[(0,N.jsxs)(Lk,{children:[(0,N.jsxs)(zk,{children:[(0,N.jsx)(B.pHD,{})," Email Addresses"]}),(0,N.jsxs)(nj,{children:[a.map(((e,t)=>(0,N.jsxs)(rj,{children:[(0,N.jsx)("div",{style:{flex:2},children:(0,N.jsx)(Vk,{value:e.email,onChange:e=>X(t,"email",e.target.value),placeholder:"Email address"})}),(0,N.jsx)("div",{style:{flex:1},children:(0,N.jsx)($k,{value:e.type,onChange:e=>X(t,"type",e.target.value),children:q.map((e=>(0,N.jsx)("option",{value:e,children:e},e)))})}),(0,N.jsx)(Mk,{onClick:()=>(e=>{s(a.map(((t,o)=>({...t,is_primary:o===e}))))})(t),disabled:e.is_primary,style:{padding:"4px",minWidth:"32px"},children:(0,N.jsx)(B.YrT,{})}),(0,N.jsx)(Mk,{onClick:()=>(e=>{a.length<=1||s(a.filter(((t,o)=>o!==e)))})(t),danger:!0,style:{padding:"4px",minWidth:"32px"},children:(0,N.jsx)(B.IXo,{})})]},t))),(0,N.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",marginTop:"8px"},children:[(0,N.jsxs)(Mk,{onClick:()=>{s([...a,{email:"",type:"personal",is_primary:!1}])},children:[(0,N.jsx)(B.GGD,{})," Add Email"]}),(0,N.jsxs)(Mk,{onClick:()=>(async()=>{if(!e)return nt.Ay.error("Please save basic information first"),void _("basic");b(!0);try{const{error:t}=await D.supabase.from("contact_emails").delete().eq("contact_id",e);if(t)throw t;const o=a.filter((e=>e.email.trim()));if(o.length>0){const{error:t}=await D.supabase.from("contact_emails").insert(o.map((t=>({contact_id:e,email:t.email.trim(),type:t.type,is_primary:t.is_primary}))));if(t)throw t}nt.Ay.success("Email addresses updated successfully")}catch(t){console.error("Error saving emails:",t),nt.Ay.error("Failed to update email addresses")}finally{b(!1)}})(),disabled:v||!e,children:[(0,N.jsx)(B.Bc_,{})," ",v?"Saving...":"Save Emails"]})]})]})]}),(0,N.jsxs)(Lk,{children:[(0,N.jsxs)(zk,{children:[(0,N.jsx)(B.QFc,{})," Mobile Numbers"]}),(0,N.jsxs)(nj,{children:[l.map(((e,t)=>(0,N.jsxs)(rj,{children:[(0,N.jsx)("div",{style:{flex:2},children:(0,N.jsx)(Vk,{value:e.mobile,onChange:e=>Q(t,"mobile",e.target.value),placeholder:"Mobile number"})}),(0,N.jsx)("div",{style:{flex:1},children:(0,N.jsx)($k,{value:e.type,onChange:e=>Q(t,"type",e.target.value),children:q.map((e=>(0,N.jsx)("option",{value:e,children:e},e)))})}),(0,N.jsx)(Mk,{onClick:()=>(e=>{c(l.map(((t,o)=>({...t,is_primary:o===e}))))})(t),disabled:e.is_primary,style:{padding:"4px",minWidth:"32px"},children:(0,N.jsx)(B.YrT,{})}),(0,N.jsx)(Mk,{onClick:()=>(e=>{c(l.filter(((t,o)=>o!==e)))})(t),danger:!0,style:{padding:"4px",minWidth:"32px"},children:(0,N.jsx)(B.IXo,{})})]},t))),(0,N.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",marginTop:"8px"},children:[(0,N.jsxs)(Mk,{onClick:()=>{c([...l,{mobile:"",type:"personal",is_primary:!1}])},children:[(0,N.jsx)(B.GGD,{})," Add Mobile"]}),(0,N.jsxs)(Mk,{onClick:()=>(async()=>{if(!e)return nt.Ay.error("Please save basic information first"),void _("basic");b(!0);try{const{error:t}=await D.supabase.from("contact_mobiles").delete().eq("contact_id",e);if(t)throw t;const o=l.filter((e=>e.mobile.trim()));if(o.length>0){const{error:t}=await D.supabase.from("contact_mobiles").insert(o.map((t=>({contact_id:e,mobile:t.mobile.trim(),type:t.type,is_primary:t.is_primary}))));if(t)throw t}nt.Ay.success("Mobile numbers updated successfully")}catch(t){console.error("Error saving mobiles:",t),nt.Ay.error("Failed to update mobile numbers")}finally{b(!1)}})(),disabled:v||!e,children:[(0,N.jsx)(B.Bc_,{})," ",v?"Saving...":"Save Mobiles"]})]})]})]}),(0,N.jsxs)(Lk,{children:[(0,N.jsxs)(zk,{children:[(0,N.jsx)(B.cnX,{})," Tags"]}),(0,N.jsxs)(nj,{children:[d.map(((e,t)=>(0,N.jsxs)(rj,{children:[(0,N.jsx)("div",{style:{flex:1},children:(0,N.jsxs)($k,{value:"object"===typeof e?e.id||"":e||"",onChange:e=>{const o=[...d];if("new_tag"===e.target.value){const e=prompt("Enter a name for the new tag:");if(e&&e.trim()){const n=async()=>{try{const{data:n,error:r}=await D.supabase.from("tags").insert({name:e.trim()}).select().single();if(r)throw r;H([...z,n]),o[t]=n.tag_id,nt.Ay.success(`Tag "${e}" created successfully`)}catch(n){console.error("Error creating tag:",n),nt.Ay.error("Failed to create new tag")}};n()}}else o[t]=e.target.value;u(o)},children:[(0,N.jsx)("option",{value:"",children:"Select a tag"}),z.map((e=>(0,N.jsx)("option",{value:e.tag_id,children:e.name},e.tag_id))),(0,N.jsx)("option",{value:"new_tag",style:{fontStyle:"italic",color:"#00ff00"},children:"+ Create new tag..."})]})}),(0,N.jsx)(Mk,{onClick:()=>{const e=[...d];e.splice(t,1),u(e)},danger:!0,style:{padding:"4px",minWidth:"32px"},children:(0,N.jsx)(B.IXo,{})})]},t))),(0,N.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",marginTop:"8px"},children:[(0,N.jsxs)(Mk,{onClick:()=>u([...d,""]),children:[(0,N.jsx)(B.GGD,{})," Add Tag"]}),(0,N.jsxs)(Mk,{onClick:()=>(async()=>{if(!e)return nt.Ay.error("Please save basic information first"),void _("basic");b(!0);try{const{error:t}=await D.supabase.from("contact_tags").delete().eq("contact_id",e);if(t)throw t;if(d.length>0){const{error:t}=await D.supabase.from("contact_tags").insert(d.map((t=>({contact_id:e,tag_id:t}))));if(t)throw t}nt.Ay.success("Tags updated successfully")}catch(t){console.error("Error saving tags:",t),nt.Ay.error("Failed to update tags")}finally{b(!1)}})(),disabled:v||!e,children:[(0,N.jsx)(B.Bc_,{})," ",v?"Saving...":"Save Tags"]})]})]})]}),(0,N.jsxs)(Lk,{children:[(0,N.jsxs)(zk,{children:[(0,N.jsx)(B.HzC,{})," Cities"]}),(0,N.jsxs)(nj,{children:[p.map(((e,t)=>(0,N.jsxs)(rj,{children:[(0,N.jsx)("div",{style:{flex:1},children:(0,N.jsxs)($k,{value:"object"===typeof e?e.id||"":e||"",onChange:e=>{const o=[...p];if("new_city"===e.target.value){const e=prompt("Enter city name:");if(e&&e.trim()){const n=prompt("Enter country:");if(n&&n.trim()){const r=async()=>{try{const{data:r,error:i}=await D.supabase.from("cities").insert({name:e.trim(),country:n.trim()}).select().single();if(i)throw i;$([...V,r]),o[t]=r.city_id,nt.Ay.success(`City "${e}, ${n}" created successfully`)}catch(r){console.error("Error creating city:",r),nt.Ay.error("Failed to create new city")}};r()}}}else o[t]=e.target.value;h(o)},children:[(0,N.jsx)("option",{value:"",children:"Select a city"}),V.map((e=>(0,N.jsxs)("option",{value:e.city_id,children:[e.name,", ",e.country]},e.city_id))),(0,N.jsx)("option",{value:"new_city",style:{fontStyle:"italic",color:"#00ff00"},children:"+ Create new city..."})]})}),(0,N.jsx)(Mk,{onClick:()=>{const e=[...p];e.splice(t,1),h(e)},danger:!0,style:{padding:"4px",minWidth:"32px"},children:(0,N.jsx)(B.IXo,{})})]},t))),(0,N.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",marginTop:"8px"},children:[(0,N.jsxs)(Mk,{onClick:()=>h([...p,""]),children:[(0,N.jsx)(B.GGD,{})," Add City"]}),(0,N.jsxs)(Mk,{onClick:()=>(async()=>{if(!e)return nt.Ay.error("Please save basic information first"),void _("basic");b(!0);try{const{error:t}=await D.supabase.from("contact_cities").delete().eq("contact_id",e);if(t)throw t;if(p.length>0){const{error:t}=await D.supabase.from("contact_cities").insert(p.map((t=>({contact_id:e,city_id:t}))));if(t)throw t}nt.Ay.success("Cities updated successfully")}catch(t){console.error("Error saving cities:",t),nt.Ay.error("Failed to update cities")}finally{b(!1)}})(),disabled:v||!e,children:[(0,N.jsx)(B.Bc_,{})," ",v?"Saving...":"Save Cities"]})]})]})]}),(0,N.jsxs)(Lk,{children:[(0,N.jsxs)(zk,{children:[(0,N.jsx)(B.qYx,{})," Companies"]}),(0,N.jsxs)(nj,{children:[f.map(((e,t)=>(0,N.jsxs)(rj,{children:[(0,N.jsx)("div",{style:{flex:2},children:(0,N.jsxs)($k,{value:e.company_id||"",onChange:e=>{if("new_company"===e.target.value){const e=prompt("Enter company name:");if(e&&e.trim()){const o=prompt("Enter company website (optional):"),n=async()=>{try{const n={name:e.trim(),category:"Inbox"};o&&o.trim()&&(n.website=o.trim());const{data:r,error:i}=await D.supabase.from("companies").insert(n).select().single();if(i)throw i;W([...U,r]),Z(t,"company_id",r.company_id),nt.Ay.success(`Company "${e}" created successfully`)}catch(n){console.error("Error creating company:",n),nt.Ay.error("Failed to create new company")}};n()}}else Z(t,"company_id",e.target.value)},children:[(0,N.jsx)("option",{value:"",children:"Select a company"}),U.map((e=>(0,N.jsx)("option",{value:e.company_id,children:e.name},e.company_id))),(0,N.jsx)("option",{value:"new_company",style:{fontStyle:"italic",color:"#00ff00"},children:"+ Create new company..."})]})}),(0,N.jsx)("div",{style:{flex:1},children:(0,N.jsxs)($k,{value:e.relationship||"not_set",onChange:e=>Z(t,"relationship",e.target.value),children:[(0,N.jsx)("option",{value:"not_set",children:"Relationship"}),(0,N.jsx)("option",{value:"employee",children:"Employee"}),(0,N.jsx)("option",{value:"founder",children:"Founder"}),(0,N.jsx)("option",{value:"investor",children:"Investor"}),(0,N.jsx)("option",{value:"advisor",children:"Advisor"}),(0,N.jsx)("option",{value:"board_member",children:"Board Member"}),(0,N.jsx)("option",{value:"customer",children:"Customer"}),(0,N.jsx)("option",{value:"partner",children:"Partner"})]})}),(0,N.jsx)(Mk,{onClick:()=>(e=>{g(f.map(((t,o)=>({...t,is_primary:o===e}))))})(t),disabled:e.is_primary,style:{padding:"4px",minWidth:"32px"},children:(0,N.jsx)(B.YrT,{})}),(0,N.jsx)(Mk,{onClick:()=>(e=>{f.length<=0||g(f.filter(((t,o)=>o!==e)))})(t),danger:!0,style:{padding:"4px",minWidth:"32px"},children:(0,N.jsx)(B.IXo,{})})]},t))),(0,N.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",marginTop:"8px"},children:[(0,N.jsxs)(Mk,{onClick:()=>{g([...f,{company_id:"",relationship:"not_set",is_primary:!1}])},children:[(0,N.jsx)(B.GGD,{})," Add Company"]}),(0,N.jsxs)(Mk,{onClick:()=>(async()=>{if(!e)return nt.Ay.error("Please save basic information first"),void _("basic");b(!0);try{const{error:t}=await D.supabase.from("contact_companies").delete().eq("contact_id",e);if(t)throw t;const o=f.filter((e=>e.company_id));if(o.length>0){const{error:t}=await D.supabase.from("contact_companies").insert(o.map((t=>({contact_id:e,company_id:t.company_id,relationship:t.relationship,is_primary:t.is_primary}))));if(t)throw t}nt.Ay.success("Companies updated successfully")}catch(t){console.error("Error saving companies:",t),nt.Ay.error("Failed to update companies")}finally{b(!1)}})(),disabled:v||!e,children:[(0,N.jsx)(B.Bc_,{})," ",v?"Saving...":"Save Companies"]})]})]})]})]}),(0,N.jsx)(Yk,{active:"duplicates"===C,children:(0,N.jsxs)(Lk,{children:[(0,N.jsxs)(zk,{children:[(0,N.jsx)(B.CKj,{})," Find Duplicate Contacts"]}),(0,N.jsxs)("div",{style:{display:"flex",gap:"10px",margin:"15px 0"},children:[(0,N.jsxs)("div",{children:[(0,N.jsx)("h4",{style:{color:"#00ff00",margin:"0 0 8px 0",fontSize:"0.9rem"},children:"By Name"}),(0,N.jsx)("p",{style:{color:"#999",marginBottom:"10px",fontSize:"0.8rem"},children:"Uses 80% name similarity threshold for more precise matching"}),(0,N.jsxs)(Mk,{onClick:async()=>{if(E([]),j(null),n.first_name||n.last_name){y(!0);try{let t=[],o=D.supabase.from("contacts").select("*");n.first_name&&n.last_name?o=o.or(`first_name.ilike.%${n.first_name}%,last_name.ilike.%${n.last_name}%`):n.first_name?o=o.ilike("first_name",`%${n.first_name}%`):n.last_name&&(o=o.ilike("last_name",`%${n.last_name}%`)),e&&(o=o.neq("contact_id",e));const{data:r,error:i}=await o;if(i)throw i;t=r||[];const a=t.filter((e=>{const t=ee(n.first_name||"",e.first_name||""),o=ee(n.last_name||"",e.last_name||""),r=.8;return n.first_name&&n.last_name&&e.first_name&&e.last_name?t>=r&&o>=r:(n.first_name&&e.first_name&&!n.last_name||!n.first_name&&n.last_name&&e.last_name,t>=r||o>=r)})).map((e=>({...e,matched_on:"Name similarity"})));E(a)}catch(t){console.error("Error searching by name:",t),nt.Ay.error("Failed to search by name")}finally{y(!1)}}else nt.Ay.error("Please enter a first name and/or last name to search")},disabled:m,children:[(0,N.jsx)(B.CKj,{})," ",m?"Searching...":"Search by Name"]})]}),(0,N.jsxs)("div",{children:[(0,N.jsx)("h4",{style:{color:"#00ff00",margin:"0 0 8px 0",fontSize:"0.9rem"},children:"By Email"}),(0,N.jsx)("p",{style:{color:"#999",marginBottom:"10px",fontSize:"0.8rem"},children:"Searches for contacts with matching email addresses"}),(0,N.jsxs)(Mk,{onClick:async()=>{E([]),j(null);const t=a.filter((e=>e.email.trim())).map((e=>e.email.trim()));if(0!==t.length){y(!0);try{const o=t.map((t=>D.supabase.from("contact_emails").select("\n            email,\n            contact_id,\n            contacts (*)\n          ").ilike("email",t).neq("contact_id",e||"0"))),n=await Promise.all(o),r=[],i=new Set;n.forEach(((e,t)=>{e.data&&e.data.forEach((e=>{e.contacts&&e.contact_id&&!i.has(e.contact_id)&&(i.add(e.contact_id),r.push({...e.contacts,matched_on:`Email: ${e.email}`}))}))})),E(r)}catch(o){console.error("Error searching by email:",o),nt.Ay.error("Failed to search by email")}finally{y(!1)}}else nt.Ay.error("Please add at least one email address to search")},disabled:m,children:[(0,N.jsx)(B.pHD,{})," ",m?"Searching...":"Search by Email"]})]}),(0,N.jsxs)("div",{children:[(0,N.jsx)("h4",{style:{color:"#00ff00",margin:"0 0 8px 0",fontSize:"0.9rem"},children:"By Mobile"}),(0,N.jsx)("p",{style:{color:"#999",marginBottom:"10px",fontSize:"0.8rem"},children:"Searches for contacts with matching mobile numbers"}),(0,N.jsxs)(Mk,{onClick:async()=>{E([]),j(null);const t=l.filter((e=>e.mobile.trim())).map((e=>e.mobile.trim()));if(0!==t.length){y(!0);try{const o=t.map((t=>D.supabase.from("contact_mobiles").select("\n            mobile,\n            contact_id,\n            contacts (*)\n          ").ilike("mobile",t).neq("contact_id",e||"0"))),n=await Promise.all(o),r=[],i=new Set;n.forEach(((e,t)=>{e.data&&e.data.forEach((e=>{e.contacts&&e.contact_id&&!i.has(e.contact_id)&&(i.add(e.contact_id),r.push({...e.contacts,matched_on:`Mobile: ${e.mobile}`}))}))})),E(r)}catch(o){console.error("Error searching by mobile:",o),nt.Ay.error("Failed to search by mobile")}finally{y(!1)}}else nt.Ay.error("Please add at least one mobile number to search")},disabled:m,children:[(0,N.jsx)(B.QFc,{})," ",m?"Searching...":"Search by Mobile"]})]})]}),S.length>0&&(0,N.jsxs)(Qk,{children:[(0,N.jsxs)("h3",{style:{color:"#00ff00",marginTop:"20px"},children:["Potential Duplicates Found (",S.length,")"]}),S.map((e=>(0,N.jsxs)(Zk,{onClick:()=>(async e=>{j(null),y(!0);try{var t,o;const{data:n,error:r}=await D.supabase.from("contacts").select("*").eq("contact_id",e.contact_id).single();if(r)throw r;const[i,a,s,l,c]=await Promise.all([D.supabase.from("contact_emails").select("*").eq("contact_id",e.contact_id),D.supabase.from("contact_mobiles").select("*").eq("contact_id",e.contact_id),D.supabase.from("contact_tags").select("tags (*)").eq("contact_id",e.contact_id),D.supabase.from("contact_cities").select("cities (*)").eq("contact_id",e.contact_id),D.supabase.from("contact_companies").select("companies (*), relationship, is_primary").eq("contact_id",e.contact_id)]),d={...n,emails:i.data||[],mobiles:a.data||[],tags:(null===(t=s.data)||void 0===t?void 0:t.map((e=>e.tags)))||[],cities:(null===(o=l.data)||void 0===o?void 0:o.map((e=>e.cities)))||[],companies:c.data||[]};j(d),te(d)}catch(n){console.error("Error loading duplicate details:",n),nt.Ay.error("Failed to load duplicate details")}finally{y(!1)}})(e),children:[(0,N.jsxs)(ej,{children:[e.first_name," ",e.last_name]}),(0,N.jsxs)(tj,{children:[e.category&&(0,N.jsx)(oj,{children:e.category}),e.job_role&&(0,N.jsx)("span",{style:{marginRight:"10px"},children:e.job_role}),e.last_interaction_at&&(0,N.jsxs)("span",{children:["Last interaction: ",new Date(e.last_interaction_at).toLocaleDateString()]})]})]},e.contact_id)))]}),k&&(0,N.jsxs)("div",{style:{marginTop:"20px"},children:[(0,N.jsxs)(zk,{children:[(0,N.jsx)(B.EPw,{})," Merge Contact Data"]}),(0,N.jsx)("p",{style:{color:"#999",marginBottom:"15px"},children:"Select which data to keep from each record."}),(0,N.jsxs)(ij,{children:[(0,N.jsx)("thead",{children:(0,N.jsxs)("tr",{children:[(0,N.jsx)("th",{children:"Field"}),(0,N.jsx)("th",{children:"Current Contact"}),(0,N.jsx)("th",{children:"Duplicate Contact"}),(0,N.jsx)("th",{children:"Selection"})]})}),(0,N.jsxs)("tbody",{children:[(0,N.jsxs)("tr",{children:[(0,N.jsx)("td",{children:"Name"}),(0,N.jsxs)("td",{children:[n.first_name," ",n.last_name]}),(0,N.jsxs)("td",{children:[k.first_name," ",k.last_name]}),(0,N.jsx)("td",{children:(0,N.jsxs)("div",{style:{display:"flex",flexDirection:"column",gap:"4px"},children:[(0,N.jsxs)(aj,{children:[(0,N.jsx)(sj,{type:"radio",name:"merge_name",value:"current",checked:"current"===A.first_name&&"current"===A.last_name,onChange:()=>{oe("first_name","current"),oe("last_name","current")}}),(0,N.jsx)("span",{children:"Current"})]}),(0,N.jsxs)(aj,{children:[(0,N.jsx)(sj,{type:"radio",name:"merge_name",value:"duplicate",checked:"duplicate"===A.first_name&&"duplicate"===A.last_name,onChange:()=>{oe("first_name","duplicate"),oe("last_name","duplicate")}}),(0,N.jsx)("span",{children:"Duplicate"})]})]})})]}),(0,N.jsxs)("tr",{children:[(0,N.jsx)("td",{children:"Category"}),(0,N.jsx)("td",{children:n.category}),(0,N.jsx)("td",{children:k.category}),(0,N.jsx)("td",{children:(0,N.jsxs)("div",{style:{display:"flex",flexDirection:"column",gap:"4px"},children:[(0,N.jsxs)(aj,{children:[(0,N.jsx)(sj,{type:"radio",name:"merge_category",value:"current",checked:"current"===A.category,onChange:()=>oe("category","current")}),(0,N.jsx)("span",{children:"Current"})]}),(0,N.jsxs)(aj,{children:[(0,N.jsx)(sj,{type:"radio",name:"merge_category",value:"duplicate",checked:"duplicate"===A.category,onChange:()=>oe("category","duplicate")}),(0,N.jsx)("span",{children:"Duplicate"})]})]})})]}),(0,N.jsxs)("tr",{children:[(0,N.jsx)("td",{children:"Job Role"}),(0,N.jsx)("td",{children:n.job_role||"-"}),(0,N.jsx)("td",{children:k.job_role||"-"}),(0,N.jsx)("td",{children:(0,N.jsxs)("div",{style:{display:"flex",flexDirection:"column",gap:"4px"},children:[(0,N.jsxs)(aj,{children:[(0,N.jsx)(sj,{type:"radio",name:"merge_job_role",value:"current",checked:"current"===A.job_role,onChange:()=>oe("job_role","current")}),(0,N.jsx)("span",{children:"Current"})]}),(0,N.jsxs)(aj,{children:[(0,N.jsx)(sj,{type:"radio",name:"merge_job_role",value:"duplicate",checked:"duplicate"===A.job_role,onChange:()=>oe("job_role","duplicate")}),(0,N.jsx)("span",{children:"Duplicate"})]})]})})]}),(0,N.jsxs)("tr",{children:[(0,N.jsx)("td",{children:"Emails"}),(0,N.jsx)("td",{children:a.filter((e=>e.email)).map((e=>e.email)).join(", ")||"-"}),(0,N.jsx)("td",{children:k.emails.map((e=>e.email)).join(", ")||"-"}),(0,N.jsx)("td",{children:(0,N.jsxs)("div",{style:{display:"flex",flexDirection:"column",gap:"4px"},children:[(0,N.jsxs)(aj,{children:[(0,N.jsx)(sj,{type:"radio",name:"merge_emails",value:"current",checked:"current"===A.emails,onChange:()=>oe("emails","current")}),(0,N.jsx)("span",{children:"Current"})]}),(0,N.jsxs)(aj,{children:[(0,N.jsx)(sj,{type:"radio",name:"merge_emails",value:"duplicate",checked:"duplicate"===A.emails,onChange:()=>oe("emails","duplicate")}),(0,N.jsx)("span",{children:"Duplicate"})]}),(0,N.jsxs)(aj,{children:[(0,N.jsx)(sj,{type:"radio",name:"merge_emails",value:"combine",checked:"combine"===A.emails,onChange:()=>oe("emails","combine")}),(0,N.jsx)("span",{children:"Combine"})]})]})})]}),(0,N.jsxs)("tr",{children:[(0,N.jsx)("td",{children:"Mobiles"}),(0,N.jsx)("td",{children:l.filter((e=>e.mobile)).map((e=>e.mobile)).join(", ")||"-"}),(0,N.jsx)("td",{children:k.mobiles.map((e=>e.mobile)).join(", ")||"-"}),(0,N.jsx)("td",{children:(0,N.jsxs)("div",{style:{display:"flex",flexDirection:"column",gap:"4px"},children:[(0,N.jsxs)(aj,{children:[(0,N.jsx)(sj,{type:"radio",name:"merge_mobiles",value:"current",checked:"current"===A.mobiles,onChange:()=>oe("mobiles","current")}),(0,N.jsx)("span",{children:"Current"})]}),(0,N.jsxs)(aj,{children:[(0,N.jsx)(sj,{type:"radio",name:"merge_mobiles",value:"duplicate",checked:"duplicate"===A.mobiles,onChange:()=>oe("mobiles","duplicate")}),(0,N.jsx)("span",{children:"Duplicate"})]}),(0,N.jsxs)(aj,{children:[(0,N.jsx)(sj,{type:"radio",name:"merge_mobiles",value:"combine",checked:"combine"===A.mobiles,onChange:()=>oe("mobiles","combine")}),(0,N.jsx)("span",{children:"Combine"})]})]})})]}),(0,N.jsxs)("tr",{children:[(0,N.jsx)("td",{children:"Tags"}),(0,N.jsx)("td",{children:d.length>0?d.length+" tags":"-"}),(0,N.jsx)("td",{children:k.tags.length>0?k.tags.length+" tags":"-"}),(0,N.jsx)("td",{children:(0,N.jsxs)("div",{style:{display:"flex",flexDirection:"column",gap:"4px"},children:[(0,N.jsxs)(aj,{children:[(0,N.jsx)(sj,{type:"radio",name:"merge_tags",value:"current",checked:"current"===A.tags,onChange:()=>oe("tags","current")}),(0,N.jsx)("span",{children:"Current"})]}),(0,N.jsxs)(aj,{children:[(0,N.jsx)(sj,{type:"radio",name:"merge_tags",value:"duplicate",checked:"duplicate"===A.tags,onChange:()=>oe("tags","duplicate")}),(0,N.jsx)("span",{children:"Duplicate"})]}),(0,N.jsxs)(aj,{children:[(0,N.jsx)(sj,{type:"radio",name:"merge_tags",value:"combine",checked:"combine"===A.tags,onChange:()=>oe("tags","combine")}),(0,N.jsx)("span",{children:"Combine"})]})]})})]}),(0,N.jsxs)("tr",{children:[(0,N.jsx)("td",{children:"Cities"}),(0,N.jsx)("td",{children:p.length>0?p.length+" cities":"-"}),(0,N.jsx)("td",{children:k.cities.length>0?k.cities.length+" cities":"-"}),(0,N.jsx)("td",{children:(0,N.jsxs)("div",{style:{display:"flex",flexDirection:"column",gap:"4px"},children:[(0,N.jsxs)(aj,{children:[(0,N.jsx)(sj,{type:"radio",name:"merge_cities",value:"current",checked:"current"===A.cities,onChange:()=>oe("cities","current")}),(0,N.jsx)("span",{children:"Current"})]}),(0,N.jsxs)(aj,{children:[(0,N.jsx)(sj,{type:"radio",name:"merge_cities",value:"duplicate",checked:"duplicate"===A.cities,onChange:()=>oe("cities","duplicate")}),(0,N.jsx)("span",{children:"Duplicate"})]}),(0,N.jsxs)(aj,{children:[(0,N.jsx)(sj,{type:"radio",name:"merge_cities",value:"combine",checked:"combine"===A.cities,onChange:()=>oe("cities","combine")}),(0,N.jsx)("span",{children:"Combine"})]})]})})]}),(0,N.jsxs)("tr",{children:[(0,N.jsx)("td",{children:"Companies"}),(0,N.jsx)("td",{children:f.length>0?f.length+" companies":"-"}),(0,N.jsx)("td",{children:k.companies.length>0?k.companies.length+" companies":"-"}),(0,N.jsx)("td",{children:(0,N.jsxs)("div",{style:{display:"flex",flexDirection:"column",gap:"4px"},children:[(0,N.jsxs)(aj,{children:[(0,N.jsx)(sj,{type:"radio",name:"merge_companies",value:"current",checked:"current"===A.companies,onChange:()=>oe("companies","current")}),(0,N.jsx)("span",{children:"Current"})]}),(0,N.jsxs)(aj,{children:[(0,N.jsx)(sj,{type:"radio",name:"merge_companies",value:"duplicate",checked:"duplicate"===A.companies,onChange:()=>oe("companies","duplicate")}),(0,N.jsx)("span",{children:"Duplicate"})]}),(0,N.jsxs)(aj,{children:[(0,N.jsx)(sj,{type:"radio",name:"merge_companies",value:"combine",checked:"combine"===A.companies,onChange:()=>oe("companies","combine")}),(0,N.jsx)("span",{children:"Combine"})]})]})})]}),(0,N.jsxs)("tr",{children:[(0,N.jsx)("td",{children:"LinkedIn"}),(0,N.jsx)("td",{children:n.linkedin||"-"}),(0,N.jsx)("td",{children:k.linkedin||"-"}),(0,N.jsx)("td",{children:(0,N.jsxs)("div",{style:{display:"flex",flexDirection:"column",gap:"4px"},children:[(0,N.jsxs)(aj,{children:[(0,N.jsx)(sj,{type:"radio",name:"merge_linkedin",value:"current",checked:"current"===A.linkedin,onChange:()=>oe("linkedin","current")}),(0,N.jsx)("span",{children:"Current"})]}),(0,N.jsxs)(aj,{children:[(0,N.jsx)(sj,{type:"radio",name:"merge_linkedin",value:"duplicate",checked:"duplicate"===A.linkedin,onChange:()=>oe("linkedin","duplicate")}),(0,N.jsx)("span",{children:"Duplicate"})]})]})})]}),(0,N.jsxs)("tr",{children:[(0,N.jsx)("td",{children:"Score"}),(0,N.jsx)("td",{children:n.score||"-"}),(0,N.jsx)("td",{children:k.score||"-"}),(0,N.jsx)("td",{children:(0,N.jsxs)("div",{style:{display:"flex",flexDirection:"column",gap:"4px"},children:[(0,N.jsxs)(aj,{children:[(0,N.jsx)(sj,{type:"radio",name:"merge_score",value:"current",checked:"current"===A.score,onChange:()=>oe("score","current")}),(0,N.jsx)("span",{children:"Current"})]}),(0,N.jsxs)(aj,{children:[(0,N.jsx)(sj,{type:"radio",name:"merge_score",value:"duplicate",checked:"duplicate"===A.score,onChange:()=>oe("score","duplicate")}),(0,N.jsx)("span",{children:"Duplicate"})]})]})})]}),(0,N.jsxs)("tr",{children:[(0,N.jsx)("td",{children:"Keep In Touch Frequency"}),(0,N.jsx)("td",{children:n.keep_in_touch_frequency||"-"}),(0,N.jsx)("td",{children:k.keep_in_touch_frequency||"-"}),(0,N.jsx)("td",{children:(0,N.jsxs)("div",{style:{display:"flex",flexDirection:"column",gap:"4px"},children:[(0,N.jsxs)(aj,{children:[(0,N.jsx)(sj,{type:"radio",name:"merge_keep_in_touch_frequency",value:"current",checked:"current"===A.keep_in_touch_frequency,onChange:()=>oe("keep_in_touch_frequency","current")}),(0,N.jsx)("span",{children:"Current"})]}),(0,N.jsxs)(aj,{children:[(0,N.jsx)(sj,{type:"radio",name:"merge_keep_in_touch_frequency",value:"duplicate",checked:"duplicate"===A.keep_in_touch_frequency,onChange:()=>oe("keep_in_touch_frequency","duplicate")}),(0,N.jsx)("span",{children:"Duplicate"})]})]})})]})]})]}),(0,N.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",marginTop:"20px"},children:[(0,N.jsxs)(Mk,{onClick:()=>j(null),children:[(0,N.jsx)(B.yGN,{})," Cancel"]}),(0,N.jsxs)(Mk,{onClick:async()=>{if(k){b(!0);try{var t,o,n,r,i,a,s,l;const c={contact:k,emails:k.emails||[],mobiles:k.mobiles||[],tags:k.tags||[],cities:k.cities||[],companies:k.companies||[]},d=(null===(t=k.mobiles)||void 0===t||null===(o=t.find((e=>e.is_primary)))||void 0===o?void 0:o.mobile)||(null===(n=k.mobiles)||void 0===n||null===(r=n[0])||void 0===r?void 0:r.mobile)||"",u=(null===(i=k.emails)||void 0===i||null===(a=i.find((e=>e.is_primary)))||void 0===a?void 0:a.email)||(null===(s=k.emails)||void 0===s||null===(l=s[0])||void 0===l?void 0:l.email)||"",{data:p,error:h}=await D.supabase.from("contact_duplicates").select("duplicate_id, status").eq("primary_contact_id",e).eq("duplicate_contact_id",k.contact_id).maybeSingle();if(h)throw h;let f;if(p){const{data:e,error:t}=await D.supabase.from("contact_duplicates").update({status:"pending",notes:"Manually merged via Contact Integrity page - Updated",merge_selections:A,duplicate_data:c,start_trigger:!0,detected_at:(new Date).toISOString(),resolved_at:null,error_message:null}).eq("duplicate_id",p.duplicate_id).select().single();if(t)throw t;f=e,nt.Ay.success("Updated existing merge settings. The system will process it shortly.")}else{const{data:t,error:o}=await D.supabase.from("contact_duplicates").insert({duplicate_id:(0,Dk.A)(),primary_contact_id:e,duplicate_contact_id:k.contact_id,mobile_number:d,email:u,detected_at:(new Date).toISOString(),status:"pending",notes:"Manually merged via Contact Integrity page",merge_selections:A,duplicate_data:c,start_trigger:!0}).select().single();if(o)throw o;f=t,nt.Ay.success("Merge request submitted. The system will process it shortly.")}if(!f)throw new Error("Failed to create or update merge record");const g=async t=>{await new Promise((e=>setTimeout(e,2e3)));const{data:o,error:n}=await D.supabase.from("contact_duplicates").select("status, error_message").eq("duplicate_id",t).single();n?console.error("Error checking merge status:",n):"completed"===o.status?(nt.Ay.success("Contacts successfully merged!"),e&&Y(e)):"failed"===o.status?nt.Ay.error(`Merge failed: ${o.error_message||"Unknown error"}`):["pending","processing"].includes(o.status)&&setTimeout((()=>g(t)),2e3)};g(f.duplicate_id),j(null),E([])}catch(c){console.error("Error initiating merge:",c),nt.Ay.error("Failed to initiate merge: "+(c.message||"Unknown error"))}finally{b(!1)}}},disabled:v,children:[(0,N.jsx)(B.EPw,{})," ",v?"Merging...":"Merge Contacts"]})]})]})]})}),(0,N.jsxs)(Yk,{active:"lastInteractions"===C,children:[(0,N.jsxs)(Lk,{children:[(0,N.jsxs)(zk,{children:[(0,N.jsx)(B.mEP,{})," Last Interactions"]}),0===O.length?(0,N.jsx)("div",{style:{padding:"20px",textAlign:"center",color:"#999"},children:"No recent interactions found for this contact"}):(0,N.jsx)("div",{children:O.map((e=>(0,N.jsxs)("div",{style:{borderBottom:"1px solid #333",padding:"15px 10px",marginBottom:"10px"},children:[(0,N.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",marginBottom:"8px"},children:[(0,N.jsxs)("div",{style:{fontWeight:"bold",color:"#00ff00"},children:[e.interaction_type," (",e.direction,")"]}),(0,N.jsx)("div",{style:{color:"#999",fontSize:"0.85rem"},children:new Date(e.interaction_date).toLocaleString()})]}),(0,N.jsx)("div",{style:{padding:"12px",color:"#eee",backgroundColor:"#222",borderRadius:"4px",whiteSpace:"pre-wrap",maxHeight:"300px",overflow:"auto",fontSize:"0.95rem",lineHeight:"1.4"},children:e.summary||"No summary available"})]},e.interaction_id)))})]}),(0,N.jsxs)(Lk,{children:[(0,N.jsxs)(zk,{children:[(0,N.jsx)(B.pHD,{})," Email Communications"]}),(0,N.jsxs)("div",{style:{padding:"15px 10px"},children:[(0,N.jsxs)(Mk,{onClick:async()=>{var e,t;if(!a||0===a.length)return void alert("No email available for this contact");const o=(null===(e=a.find((e=>e.is_primary)))||void 0===e?void 0:e.email)||(null===(t=a[0])||void 0===t?void 0:t.email);if(o){G(!0);try{const{data:e,error:t}=await D.supabase.from("email_inbox").select("*").or(`from_email.ilike.${o},to_email.ilike.${o}`).order("message_timestamp",{ascending:!1}).limit(10);if(t)throw t;I(e||[])}catch(n){console.error("Error loading emails:",n)}finally{G(!1)}}else alert("No email available for this contact")},disabled:F,children:[(0,N.jsx)(B.jTZ,{})," ",F?"Loading...":"Load Recent Emails"]}),P.length>0?(0,N.jsx)("div",{style:{marginTop:"15px"},children:P.map((e=>(0,N.jsxs)("div",{style:{border:"1px solid #333",borderRadius:"4px",padding:"15px",marginBottom:"15px",backgroundColor:"#1a1a1a"},children:[(0,N.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",marginBottom:"10px",borderBottom:"1px solid #333",paddingBottom:"8px"},children:[(0,N.jsxs)("div",{children:[(0,N.jsxs)("div",{style:{fontWeight:"bold",color:"#eee"},children:["From: ",e.from_name||e.from_email]}),(0,N.jsxs)("div",{style:{color:"#ccc",fontSize:"0.9rem"},children:["To: ",e.to_name||e.to_email]}),e.cc_email&&(0,N.jsxs)("div",{style:{color:"#999",fontSize:"0.85rem"},children:["CC: ",e.cc_name||e.cc_email]})]}),(0,N.jsx)("div",{style:{color:"#999",fontSize:"0.85rem",textAlign:"right"},children:new Date(e.message_timestamp).toLocaleString()})]}),(0,N.jsx)("div",{style:{fontWeight:"bold",marginBottom:"8px",color:"#00ff00"},children:e.subject||"(No Subject)"}),(0,N.jsx)("div",{style:{maxHeight:"300px",overflow:"auto",backgroundColor:"#222",padding:"10px",borderRadius:"4px",whiteSpace:"pre-wrap"},children:e.message_text||"(No content)"})]},e.id)))}):(0,N.jsx)("div",{style:{padding:"20px",textAlign:"center",color:"#999",marginTop:"15px"},children:"Click 'Load Recent Emails' to fetch email communication for this contact"})]})]}),(0,N.jsxs)(Lk,{children:[(0,N.jsxs)(zk,{children:[(0,N.jsx)(B.mEP,{})," WhatsApp Messages"]}),(0,N.jsxs)("div",{style:{padding:"15px 10px"},children:[(0,N.jsxs)(Mk,{onClick:async()=>{var e,t;if(!l||0===l.length)return void alert("No mobile number available for this contact");const o=(null===(e=l.find((e=>e.is_primary)))||void 0===e?void 0:e.mobile)||(null===(t=l[0])||void 0===t?void 0:t.mobile);if(o){G(!0);try{const{data:e,error:t}=await D.supabase.from("whatsapp_inbox").select("*").eq("contact_number",o).order("message_timestamp",{ascending:!1}).limit(10);if(t)throw t;L(e||[])}catch(n){console.error("Error loading WhatsApp messages:",n)}finally{G(!1)}}else alert("No mobile number available for this contact")},disabled:F,children:[(0,N.jsx)(B.jTZ,{})," ",F?"Loading...":"Load WhatsApp Messages"]}),M.length>0?(0,N.jsx)("div",{style:{marginTop:"15px"},children:M.map((e=>(0,N.jsxs)("div",{style:{border:"1px solid #333",borderRadius:"4px",padding:"15px",marginBottom:"15px",backgroundColor:"inbound"===e.direction?"#1a2a1a":"#2a1a1a"},children:[(0,N.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",marginBottom:"10px"},children:[(0,N.jsxs)("div",{style:{fontWeight:"bold",color:"inbound"===e.direction?"#00cc00":"#cc9900"},children:["inbound"===e.direction?"Received from":"Sent to",": ",e.first_name," ",e.last_name]}),(0,N.jsx)("div",{style:{color:"#999",fontSize:"0.85rem"},children:new Date(e.message_timestamp).toLocaleString()})]}),(0,N.jsxs)("div",{style:{padding:"10px",backgroundColor:"#222",borderRadius:"4px",whiteSpace:"pre-wrap"},children:[e.message_text||"(No text content)",e.attachment_url&&(0,N.jsxs)("div",{style:{marginTop:"10px"},children:[(0,N.jsxs)("div",{style:{color:"#00ff00",fontSize:"0.9rem",marginBottom:"5px"},children:["Attachment: ",e.attachment_filename||"File"]}),(0,N.jsx)("a",{href:e.attachment_url,target:"_blank",rel:"noopener noreferrer",style:{color:"#4d94ff"},children:"View Attachment"})]})]})]},e.id)))}):(0,N.jsx)("div",{style:{padding:"20px",textAlign:"center",color:"#999",marginTop:"15px"},children:"Click 'Load WhatsApp Messages' to fetch WhatsApp communication for this contact"})]})]})]})]})]})};var cj=o(933);const dj=P.Ay.div`
  display: flex;
  justify-content: space-between;
  align-items: center;
  margin-bottom: 15px;
  padding-bottom: 15px;
  border-bottom: 1px solid #333;

  h2 {
    margin: 0;
    font-size: 1.25rem;
    color: #fff;
    font-weight: 600;
  }

  button {
    background: none;
    border: none;
    cursor: pointer;
    color: #00ff00;
    padding: 4px;
    border-radius: 4px;
    
    &:hover {
      color: #33ff33;
      background-color: #333;
    }
  }
`,uj=P.Ay.div`
  margin-bottom: 15px;
`,pj=P.Ay.h3`
  font-size: 14px;
  font-weight: bold;
  color: #00ff00;
  margin-bottom: 12px;
`,hj=P.Ay.div`
  display: flex;
  flex-wrap: wrap;
  gap: 5px;
  margin-bottom: 16px;
  padding: 5px 0;
  min-height: 32px;
  background: #222;
  border-radius: 4px;
  padding: 10px;
`,fj=P.Ay.div`
  display: inline-flex;
  align-items: center;
  padding: 2px 5px;
  font-size: 0.7rem;
  border-radius: 3px;
  background-color: #333;
  color: #00ff00;
  font-weight: 500;
  margin-right: 0.25rem;
  margin-bottom: 0.25rem;
  border: 1px solid #00ff00;
  gap: 3px;
  max-width: 200px;

  span {
    white-space: nowrap;
    overflow: hidden;
    text-overflow: ellipsis;
    max-width: 150px;
  }

  button {
    background: none;
    border: none;
    padding: 0;
    display: inline-flex;
    align-items: center;
    justify-content: center;
    margin-left: 0.25rem;
    color: #00ff00;
    cursor: pointer;
    
    &:hover { 
      color: #ff3333; 
    }
  }
`,gj=P.Ay.div`
  position: relative;
  margin-bottom: 16px;
  width: 90%;
`,mj=P.Ay.input`
  width: 100%;
  padding: 10px;
  padding-left: 36px;
  border: 1px solid #444;
  border-radius: 4px;
  font-size: 13px;
  color: #fff;
  background-color: #222;
  transition: all 0.2s;

  &:focus {
    outline: none;
    border-color: #00ff00;
    box-shadow: 0 0 0 2px rgba(0, 255, 0, 0.1);
  }

  &:hover {
    background-color: #333;
  }
`,yj=P.Ay.div`
  position: absolute;
  left: 12px;
  top: 50%;
  transform: translateY(-50%);
  color: #00ff00;
`,vj=P.Ay.div`
  margin-top: 8px;
  border: 1px solid #444;
  border-radius: 4px;
  max-height: 200px;
  overflow-y: auto;
  background-color: #222;
`,bj=P.Ay.button`
  width: 100%;
  text-align: left;
  padding: 8px 12px;
  background: none;
  border: none;
  border-bottom: 1px solid #333;
  cursor: pointer;
  font-size: 0.8rem;
  color: #fff;
  transition: background-color 0.2s;
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;

  &:last-child {
    border-bottom: none;
  }

  &:hover {
    background-color: #333;
    color: #00ff00;
  }
`,xj=P.Ay.button`
  display: inline-flex;
  align-items: center;
  gap: 6px;
  padding: 6px 12px;
  background-color: #333;
  color: #00ff00;
  border: 1px solid #00ff00;
  border-radius: 4px;
  font-size: 0.8rem;
  cursor: pointer;
  transition: all 0.2s;

  &:hover {
    background-color: #444;
  }

  &:disabled {
    background-color: #222;
    color: #666;
    border-color: #666;
    cursor: not-allowed;
  }
`,wj=P.Ay.div`
  padding: 8px 12px;
  border-radius: 4px;
  font-size: 12px;
  margin-top: 12px;
  
  &.success {
    background-color: #223322;
    color: #00ff00;
  }
  
  &.error {
    background-color: #332222;
    color: #ff5555;
  }
`,Cj=P.Ay.div`
  display: flex;
  justify-content: flex-end;
  gap: 10px;
  margin-top: 15px;
`,_j=P.Ay.button`
  padding: 6px 14px;
  border-radius: 4px;
  font-size: 0.8rem;
  font-weight: 500;
  cursor: pointer;
  transition: all 0.2s;
  
  &.primary {
    background-color: #333;
    color: #00ff00;
    border: 1px solid #00ff00;
    
    &:hover {
      background-color: #444;
    }

    &:disabled {
      background-color: #222;
      color: #666;
      border-color: #666;
      cursor: not-allowed;
    }
  }
  
  &.secondary {
    background-color: #333;
    color: #999;
    border: 1px solid #666;
    
    &:hover {
      background-color: #444;
    }
  }
`,Sj=e=>{let{isOpen:o,onRequestClose:n,company:r}=e;const[i,a]=(0,t.useState)([]),[s,l]=(0,t.useState)(""),[c,d]=(0,t.useState)([]),[u,p]=(0,t.useState)(!1),[h,f]=(0,t.useState)({type:"",text:""}),[g,m]=(0,t.useState)(!1),y=null===r||void 0===r?void 0:r.id,v=async()=>{try{console.log(`Fetching tags for company with ID: ${y}`);const e="company_tags",t="company_id";console.log(`Querying table: ${e}, idField: ${t}, id: ${y}`);let{data:o,error:n}=await D.supabase.from(e).select("*").eq(t,y);if(console.log("Raw tag connections data:",o),n)throw console.error("Error fetching raw tags:",n),n;if(o&&o.length>0){const e=o.map((e=>e.tag_id));console.log("Found tag IDs:",e);const{data:t,error:n}=await D.supabase.from("tags").select("tag_id, name").in("tag_id",e);if(n)throw console.error("Error fetching tag details:",n),n;console.log("Tags details:",t);const r=o.map((e=>{const o=t.find((t=>t.tag_id===e.tag_id));return{id:e.entry_id,tag_id:e.tag_id,name:(null===o||void 0===o?void 0:o.name)||"Unknown tag"}}));console.log("Setting currentTags to:",r),a(r)}else console.log("No tags found, clearing currentTags"),a([])}catch(e){console.error("Error fetching tags:",e),f({type:"error",text:"Failed to load tags"})}};(0,t.useEffect)((()=>{o&&y&&v()}),[o,y]),(0,t.useEffect)((()=>{s.length>=2?((async e=>{try{let t=D.supabase.from("tags").select("tag_id, name");e&&(t=t.ilike("name",`%${e}%`));const{data:o,error:n}=await t.limit(10);if(n)throw n;const r=o.filter((e=>!i.some((t=>t.tag_id===e.tag_id))));d(r)}catch(t){console.error("Error fetching suggestions:",t)}})(s),m(!0)):(d([]),m(!1))}),[s]);return(0,N.jsx)(ot(),{isOpen:o,onRequestClose:n,style:{content:{top:"50%",left:"50%",right:"auto",bottom:"auto",marginRight:"-50%",transform:"translate(-50%, -50%)",padding:"20px",border:"1px solid #444",borderRadius:"8px",backgroundColor:"#111",color:"#fff",boxShadow:"0 4px 20px rgba(0, 0, 0, 0.5)",maxWidth:"500px",width:"90%",minHeight:"360px"},overlay:{backgroundColor:"rgba(0, 0, 0, 0.7)",zIndex:1e3}},children:(0,N.jsxs)("div",{style:{padding:"1rem"},children:[(0,N.jsxs)(dj,{children:[(0,N.jsx)("h2",{children:"Manage Company Tags"}),(0,N.jsx)("button",{onClick:n,"aria-label":"Close modal",children:(0,N.jsx)(B.yGN,{size:20})})]}),(0,N.jsxs)(uj,{children:[(0,N.jsx)(pj,{children:"Current Tags"}),(0,N.jsxs)(hj,{children:[i.map((e=>{e.name;return(0,N.jsxs)(fj,{children:[(0,N.jsx)("span",{title:e.name,children:e.name.length>25?`${e.name.substring(0,25)}...`:e.name}),(0,N.jsx)("button",{onClick:()=>(async e=>{try{p(!0),console.log(`Removing tag ID ${e.tag_id} from company ${y}`);const t="company_tags",o="company_id",{error:n}=await D.supabase.from(t).delete().eq(o,y).eq("tag_id",e.tag_id);if(n)throw console.error("Delete error:",n),n;await v(),f({type:"success",text:"Tag removed successfully"})}catch(t){console.error("Error removing tag:",t),f({type:"error",text:"Failed to remove tag"})}finally{p(!1)}})(e),disabled:u,children:(0,N.jsx)(B.yGN,{size:14})})]},e.id)})),0===i.length&&(0,N.jsx)("span",{style:{color:"#6c757d",fontStyle:"italic",padding:"4px"},children:"No tags assigned"})]})]}),(0,N.jsxs)(uj,{children:[(0,N.jsx)(pj,{children:"Add Tags"}),(0,N.jsxs)(gj,{children:[(0,N.jsx)(yj,{children:(0,N.jsx)(B.CKj,{size:16})}),(0,N.jsx)(mj,{type:"text",value:s,onChange:e=>l(e.target.value),placeholder:"Search or create new tag..."})]}),g&&(0,N.jsxs)(vj,{children:[c.map((e=>(0,N.jsx)(bj,{onClick:()=>(async e=>{try{if(p(!0),console.log(`Adding tag ${e.tag_id} to company ${y}`),!y)throw console.error("Missing company ID. Cannot add tag."),new Error("Missing company ID");const t="company_tags",o="company_id",n={tag_id:e.tag_id,company_id:y};console.log("Inserting data:",n,"into table:",t),console.log(`Checking if tag ${e.tag_id} is already associated with ${o}=${y}`);const{data:r,error:i}=await D.supabase.from(t).select("*").eq(o,y).eq("tag_id",e.tag_id);if(i)throw console.error("Error checking existing tag:",i),i;if(console.log("Existing tag check result:",r),r&&r.length>0)return console.log("Tag already exists for this company, skipping insertion"),f({type:"success",text:"Tag already exists"}),await v(),l(""),void m(!1);console.log("About to insert tag connection with data:",{tableName:t,idFieldName:o,entityId:y,tagId:e.tag_id,fullInsertData:n});const{data:a,error:s}=await D.supabase.from(t).insert(n).select();if(s)throw console.error("Insert error:",s),s;console.log("Insert successful, result:",a),await v(),l(""),m(!1),f({type:"success",text:"Tag added successfully"})}catch(t){console.error("Error adding tag:",t),console.error("Error details:",t.message,t.code,t.details),f({type:"error",text:`Failed to add tag: ${t.message||"Unknown error"}`})}finally{p(!1)}})(e),disabled:u,children:e.name},e.id))),s.trim()&&!c.find((e=>e.name.toLowerCase()===s.toLowerCase()))&&(0,N.jsx)("div",{style:{padding:"8px 12px"},children:(0,N.jsxs)(xj,{onClick:async()=>{if(s.trim())try{if(p(!0),console.log(`Creating new tag "${s}" for company`),!y)throw console.error("Missing company ID. Cannot add tag."),new Error("Missing company ID");const{data:e,error:t}=await D.supabase.from("tags").select("tag_id, name").ilike("name",s.trim());if(t)throw console.error("Error searching for existing tags:",t),t;let o;if(e&&e.length>0)console.log("Tag with this name already exists, using existing tag"),o=e[0];else{const{data:e,error:t}=await D.supabase.from("tags").insert({name:s.trim()}).select().single();if(t)throw console.error("Error creating tag:",t),t;console.log("New tag created:",e),o=e}const n="company_tags",r="company_id",{data:i,error:a}=await D.supabase.from(n).select("*").eq(r,y).eq("tag_id",o.tag_id);if(a)throw console.error("Error checking existing connection:",a),a;if(i&&i.length>0)return console.log("Tag already associated with this company"),f({type:"success",text:"Tag already exists"}),await v(),l(""),void m(!1);const c={tag_id:o.tag_id,company_id:y};console.log("Connecting tag:",c);const{error:d}=await D.supabase.from(n).insert(c);if(d)throw console.error("Error connecting tag:",d),d;await v(),l(""),m(!1),f({type:"success",text:o===e?"Existing tag added successfully":"New tag created and added successfully"})}catch(e){console.error("Error creating tag:",e),f({type:"error",text:"Failed to create tag"})}finally{p(!1)}},disabled:u,children:[(0,N.jsx)(B.GGD,{size:12}),'Create "',s,'"']})})]})]}),h.text&&(0,N.jsx)(wj,{className:h.type,children:h.text}),(0,N.jsx)(Cj,{children:(0,N.jsx)(_j,{className:"primary",onClick:n,children:"Done"})}),u&&(0,N.jsx)("div",{style:{textAlign:"center",marginTop:"10px"},children:(0,N.jsx)("div",{className:"spinner",style:{width:"20px",height:"20px",border:"3px solid #f3f3f3",borderTop:"3px solid #000000",borderRadius:"50%",animation:"spin 1s linear infinite"}})})]})})},Ej=document.createElement("style");Ej.innerHTML="\n  @keyframes spin {\n    0% { transform: rotate(0deg); }\n    100% { transform: rotate(360deg); }\n  }\n",document.head.appendChild(Ej);var kj=o(5546);const jj=P.Ay.div`
  display: flex;
  justify-content: space-between;
  align-items: center;
  margin-bottom: 15px;
  padding-bottom: 15px;
  border-bottom: 1px solid #00ff00;

  h2 {
    margin: 0;
    font-size: 1.25rem;
    color: #00ff00;
    font-weight: 600;
  }

  button {
    background: none;
    border: none;
    cursor: pointer;
    color: #00ff00;
    padding: 4px;
    border-radius: 4px;
    
    &:hover {
      color: #fff;
      background-color: rgba(0, 255, 0, 0.2);
    }
  }
`,Aj=P.Ay.div`
  margin-bottom: 15px;
`,Rj=P.Ay.h3`
  font-size: 16px;
  font-weight: bold;
  color: #00ff00;
  margin-bottom: 12px;
`,Oj=P.Ay.div`
  display: flex;
  flex-direction: column;
  flex-wrap: wrap;
  gap: 8px;
  margin-bottom: 16px;
  padding: 5px 0;
  min-height: 32px;
`,Tj=P.Ay.div`
  display: flex;
  align-items: center;
  justify-content: space-between;
  padding: 8px 12px;
  background-color: ${e=>e.color||"#222"};
  color: ${e=>e.textColor||"#00ff00"};
  border-radius: 8px;
  font-size: 0.875rem;
  gap: 6px;
  width: 100%;
  border: 1px solid #333;
  margin-bottom: 5px;

  .mobile-content {
    display: flex;
    align-items: center;
    gap: 8px;
    overflow: hidden;
    flex-grow: 1;
  }

  span {
    white-space: nowrap;
    overflow: hidden;
    text-overflow: ellipsis;
  }

  .actions {
    display: flex;
    gap: 6px;
  }

  button {
    background: none;
    border: none;
    padding: 2px;
    cursor: pointer;
    color: inherit;
    opacity: 0.7;
    display: flex;
    align-items: center;
    justify-content: center;
    flex-shrink: 0;

    &:hover {
      opacity: 1;
    }
  }
`,Dj=P.Ay.div`
  margin-bottom: 16px;
`,Pj=P.Ay.input`
  width: 100%;
  padding: 10px 12px;
  border: 1px solid #333;
  border-radius: 6px;
  font-size: 0.875rem;
  outline: none;
  transition: border-color 0.2s;
  background-color: #222;
  color: #fff;

  &:focus {
    border-color: #00ff00;
    box-shadow: 0 0 0 3px rgba(0, 255, 0, 0.1);
  }
`,Nj=P.Ay.div`
  padding: 10px;
  border-radius: 4px;
  margin-bottom: 15px;
  font-size: 0.875rem;
  border: 1px solid;

  &.success {
    background-color: rgba(0, 255, 0, 0.1);
    color: #00ff00;
    border-color: #00ff00;
  }

  &.error {
    background-color: rgba(255, 0, 0, 0.1);
    color: #ff5555;
    border-color: #ff5555;
  }

  &.info {
    background-color: rgba(0, 170, 255, 0.1);
    color: #00aaff;
    border-color: #00aaff;
  }
`,Ij=P.Ay.div`
  display: flex;
  justify-content: flex-end;
  gap: 10px;
  margin-top: 20px;
`,Mj=P.Ay.button`
  padding: 8px 16px;
  border-radius: 4px;
  font-size: 0.875rem;
  font-weight: 500;
  cursor: pointer;
  transition: all 0.2s;

  &.primary {
    background-color: #121212;
    color: #00ff00;
    border: 1px solid #00ff00;

    &:hover {
      background-color: rgba(0, 255, 0, 0.2);
    }
  }

  &.secondary {
    background-color: #121212;
    color: #aaa;
    border: 1px solid #333;

    &:hover {
      background-color: #222;
    }
  }

  &:disabled {
    opacity: 0.5;
    cursor: not-allowed;
  }
`,Lj=P.Ay.button`
  display: flex;
  align-items: center;
  gap: 6px;
  background-color: #121212;
  color: #00ff00;
  padding: 8px 12px;
  border: 1px solid #00ff00;
  border-radius: 4px;
  font-size: 0.875rem;
  font-weight: 500;
  cursor: pointer;
  transition: all 0.2s;

  &:hover {
    background-color: rgba(0, 255, 0, 0.2);
  }

  &:disabled {
    opacity: 0.5;
    cursor: not-allowed;
  }
`,Fj=e=>{let{isOpen:o,onRequestClose:n,contact:r,onUpdateMobiles:i}=e;const[a,s]=(0,t.useState)([]),[l,c]=(0,t.useState)(""),[d,u]=(0,t.useState)(!1),[p,h]=(0,t.useState)({type:"",text:""});(0,t.useEffect)((()=>{if(o&&r)if(console.log("Contact data for mobiles:",r),r.mobiles)console.log("Mobiles data:",r.mobiles),s(Array.isArray(r.mobiles)?[...r.mobiles]:[]);else{(async()=>{try{const{data:e,error:t}=await D.supabase.from("contact_mobiles").select("*").eq("contact_id",r.contact_id);if(t)return void console.error("Error fetching mobiles:",t);console.log("Fetched mobiles:",e),e&&e.length>0&&s(e)}catch(e){console.error("Exception fetching mobiles:",e)}})()}}),[o,r]);return(0,t.useEffect)((()=>{p.text&&setTimeout((()=>{h({type:"",text:""})}),3e3)}),[p]),(0,N.jsx)(ot(),{isOpen:o,onRequestClose:n,style:{content:{top:"50%",left:"50%",right:"auto",bottom:"auto",marginRight:"-50%",transform:"translate(-50%, -50%)",padding:"20px",border:"1px solid #00ff00",borderRadius:"0.5rem",boxShadow:"0 4px 12px rgba(0, 255, 0, 0.2)",maxWidth:"500px",width:"90%",minHeight:"360px",backgroundColor:"#121212",color:"#ffffff"},overlay:{backgroundColor:"rgba(0, 0, 0, 0.8)",zIndex:1e3}},children:(0,N.jsxs)("div",{style:{padding:"1rem"},children:[(0,N.jsxs)(jj,{children:[(0,N.jsx)("h2",{children:"Manage Phone Numbers"}),(0,N.jsx)("button",{onClick:n,"aria-label":"Close modal",children:(0,N.jsx)(B.yGN,{size:20})})]}),(0,N.jsxs)(Aj,{children:[(0,N.jsx)(Rj,{children:"Contact Phone Numbers"}),(0,N.jsxs)(Oj,{children:[a.map(((e,t)=>{const o=function(){return arguments.length>0&&void 0!==arguments[0]&&arguments[0]?{bg:"rgba(0, 255, 0, 0.15)",text:"#00ff00"}:{bg:"#222",text:"#00ff00"}}(e.is_primary);return(0,N.jsxs)(Tj,{color:o.bg,textColor:o.text,children:[(0,N.jsxs)("div",{className:"mobile-content",children:[(0,N.jsx)(B.QFc,{size:16}),(0,N.jsx)("span",{title:e.mobile,children:e.mobile}),e.is_primary&&(0,N.jsx)("span",{style:{fontSize:"0.75rem",backgroundColor:"rgba(0, 255, 0, 0.2)",color:"#00ff00",padding:"2px 6px",borderRadius:"4px",marginLeft:"6px",border:"1px solid #00ff00"},children:"Primary"})]}),(0,N.jsxs)("div",{className:"actions",children:[!e.is_primary&&(0,N.jsx)("button",{onClick:()=>(e=>{try{if(e.is_primary)return;const t=a.map((t=>({...t,is_primary:t.mobile===e.mobile})));s(t),h({type:"success",text:"Primary phone number updated successfully"}),i&&i(t)}catch(t){console.error("Error setting primary phone number:",t),h({type:"error",text:"Failed to set primary phone number"})}})(e),disabled:d,title:"Set as primary",style:{color:"#166534"},children:(0,N.jsx)(B.SG1,{size:14})}),(0,N.jsx)("button",{onClick:()=>(e=>{try{const t=a.filter((t=>t.mobile!==e.mobile));e.is_primary&&t.length>0&&(t[0].is_primary=!0),s(t),h({type:"success",text:"Phone number removed successfully"}),i&&i(t)}catch(t){console.error("Error removing phone number:",t),h({type:"error",text:"Failed to remove phone number"})}})(e),disabled:d,title:"Remove phone number",children:(0,N.jsx)(B.yGN,{size:14})})]})]},t)})),0===a.length&&(0,N.jsx)("div",{style:{color:"#aaa",fontStyle:"italic",padding:"4px"},children:"No phone numbers linked to this contact"})]})]}),(0,N.jsxs)(Aj,{children:[(0,N.jsx)(Rj,{children:"Add New Phone Number"}),(0,N.jsx)(Dj,{children:(0,N.jsx)(Pj,{type:"tel",value:l,onChange:e=>c(e.target.value),placeholder:"+1 (123) 456-7890","aria-label":"New phone number"})}),(0,N.jsxs)(Lj,{onClick:()=>{try{if(!(l.trim().length>=6))return void h({type:"error",text:"Please enter a valid phone number"});if(a.some((e=>e.mobile===l)))return void h({type:"info",text:"This phone number already exists for this contact"});const e={mobile:l,is_primary:0===a.length},t=[...a,e];s(t),c(""),h({type:"success",text:"Phone number added successfully"}),i&&i(t)}catch(e){console.error("Error adding phone number:",e),h({type:"error",text:"Failed to add phone number"})}},disabled:!l.trim()||d,children:[(0,N.jsx)(B.GGD,{size:16}),"Add Phone Number"]})]}),p.text&&(0,N.jsx)(Nj,{className:p.type,children:p.text}),(0,N.jsx)(Ij,{children:(0,N.jsx)(Mj,{className:"primary",onClick:n,children:"Done"})}),d&&(0,N.jsx)("div",{style:{textAlign:"center",marginTop:"10px"},children:(0,N.jsx)("div",{className:"spinner",style:{width:"20px",height:"20px",border:"3px solid #f3f3f3",borderTop:"3px solid #3b82f6",borderRadius:"50%",animation:"spin 1s linear infinite"}})})]})})},Gj=document.createElement("style");Gj.innerHTML="\n  @keyframes spin {\n    0% { transform: rotate(0deg); }\n    100% { transform: rotate(360deg); }\n  }\n",document.head.appendChild(Gj);const zj=P.Ay.div`
  display: flex;
  justify-content: space-between;
  align-items: center;
  margin-bottom: 15px;
  padding-bottom: 15px;
  border-bottom: 1px solid #e5e7eb;

  h2 {
    margin: 0;
    font-size: 1.25rem;
    color: #111827;
    font-weight: 600;
  }

  button {
    background: none;
    border: none;
    cursor: pointer;
    color: #6b7280;
    padding: 4px;
    border-radius: 4px;
    
    &:hover {
      color: #1f2937;
      background-color: #f3f4f6;
    }
  }
`,Hj=P.Ay.div`
  margin-bottom: 15px;
`,Bj=P.Ay.h3`
  font-size: 16px;
  font-weight: bold;
  color: #374151;
  margin-bottom: 12px;
`,Vj=P.Ay.div`
  display: flex;
  flex-wrap: wrap;
  gap: 8px;
  margin-bottom: 16px;
  padding: 5px 0;
  min-height: 32px;
`,$j=P.Ay.div`
  display: inline-flex;
  align-items: center;
  padding: 4px 8px;
  background-color: ${e=>e.color||"#f3f4f6"};
  color: #4b5563;
  border-radius: 16px;
  font-size: 0.875rem;
  gap: 6px;
  max-width: 200px;

  span {
    white-space: nowrap;
    overflow: hidden;
    text-overflow: ellipsis;
    max-width: 150px;
  }

  button {
    background: none;
    border: none;
    padding: 2px;
    cursor: pointer;
    color: inherit;
    opacity: 0.7;
    display: flex;
    align-items: center;
    justify-content: center;
    flex-shrink: 0;

    &:hover {
      opacity: 1;
    }
  }
`,Uj=P.Ay.div`
  position: relative;
  margin-bottom: 16px;
  width: 90%;
`,Wj=P.Ay.div`
  position: absolute;
  left: 10px;
  top: 50%;
  transform: translateY(-50%);
  color: #6b7280;
`,qj=P.Ay.input`
  width: 100%;
  padding: 10px 10px 10px 35px;
  border: 1px solid #d1d5db;
  border-radius: 6px;
  font-size: 0.875rem;
  outline: none;
  transition: border-color 0.2s;

  &:focus {
    border-color: #3b82f6;
    box-shadow: 0 0 0 3px rgba(59, 130, 246, 0.1);
  }
`,Kj=P.Ay.div`
  position: relative;
  margin-top: 5px;
  border: 1px solid #e5e7eb;
  border-radius: 6px;
  max-height: 200px;
  overflow-y: auto;
  background-color: white;
  box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
  z-index: 10;
`,Yj=P.Ay.button`
  width: 100%;
  text-align: left;
  padding: 8px 12px;
  border: none;
  background: none;
  cursor: pointer;
  font-size: 0.875rem;
  color: #374151;
  transition: background-color 0.2s;
  display: flex;
  align-items: center;
  justify-content: space-between;

  &:hover {
    background-color: #f3f4f6;
  }

  &:not(:last-child) {
    border-bottom: 1px solid #f3f4f6;
  }
`,Jj=P.Ay.div`
  padding: 10px;
  border-radius: 4px;
  margin-bottom: 15px;
  font-size: 0.875rem;

  &.success {
    background-color: #d1fae5;
    color: #065f46;
  }

  &.error {
    background-color: #fee2e2;
    color: #b91c1c;
  }
  
  &.info {
    background-color: #e0f2fe;
    color: #0369a1;
  }
`,Xj=P.Ay.div`
  display: flex;
  justify-content: flex-end;
  gap: 10px;
  margin-top: 20px;
`,Qj=P.Ay.button`
  padding: 8px 16px;
  border-radius: 4px;
  font-size: 0.875rem;
  font-weight: 500;
  cursor: pointer;
  transition: all 0.2s;

  &.primary {
    background-color: black;
    color: white;
    border: none;

    &:hover {
      background-color: #333;
    }
  }

  &.secondary {
    background-color: white;
    color: #4b5563;
    border: 1px solid #d1d5db;

    &:hover {
      background-color: #f9fafb;
    }
  }

  &:disabled {
    opacity: 0.5;
    cursor: not-allowed;
  }
`,Zj=e=>e?`${e.first_name||""} ${e.last_name||""}`.trim():"",eA=e=>{let{isOpen:o,onRequestClose:n,company:r,onContactClick:i}=e;const[a,s]=(0,t.useState)([]),[l,c]=(0,t.useState)(""),[d,u]=(0,t.useState)([]),[p,h]=(0,t.useState)(!1),[f,g]=(0,t.useState)({type:"",text:""}),[m,y]=(0,t.useState)(!1),v=async()=>{try{console.log("Fetching related contacts for company ID:",r.id);const{data:e,error:t}=await D.supabase.from("contact_companies").select("\n          contact_id,\n          contacts:contact_id(id, first_name, last_name, email)\n        ").eq("company_id",r.id);if(t)throw t;const o=e.map((e=>({id:e.contact_id,first_name:e.contacts.first_name,last_name:e.contacts.last_name,email:e.contacts.email})));console.log("Fetched contacts:",o),s(o)}catch(e){console.error("Error fetching related contacts:",e),g({type:"error",text:"Failed to load contacts"})}};(0,t.useEffect)((()=>{o&&r&&v()}),[o,r]),(0,t.useEffect)((()=>{l.length>=2?((async e=>{try{if(e.length<2)return void u([]);const{data:t,error:o}=await D.supabase.from("contacts").select("*").or(`first_name.ilike.%${e}%,last_name.ilike.%${e}%,email.ilike.%${e}%`).limit(10);if(o)throw o;const n=t.filter((e=>!a.some((t=>t.id===e.id))));u(n)}catch(t){console.error("Error fetching contact suggestions:",t)}})(l),y(!0)):(u([]),y(!1))}),[l]);(0,t.useEffect)((()=>{f.text&&setTimeout((()=>{g({type:"",text:""})}),3e3)}),[f]);return(0,N.jsx)(ot(),{isOpen:o,onRequestClose:n,style:{content:{top:"50%",left:"50%",right:"auto",bottom:"auto",marginRight:"-50%",transform:"translate(-50%, -50%)",padding:"20px",border:"none",borderRadius:"0.5rem",boxShadow:"0 4px 6px rgba(0, 0, 0, 0.1)",maxWidth:"500px",width:"90%",minHeight:"360px"},overlay:{backgroundColor:"rgba(0, 0, 0, 0.5)",zIndex:1e3}},children:(0,N.jsxs)("div",{style:{padding:"1rem"},children:[(0,N.jsxs)(zj,{children:[(0,N.jsx)("h2",{children:"Manage Company Contacts"}),(0,N.jsx)("button",{onClick:n,"aria-label":"Close modal",children:(0,N.jsx)(B.yGN,{size:20})})]}),(0,N.jsxs)(Hj,{children:[(0,N.jsx)(Bj,{children:"Company Contacts"}),(0,N.jsxs)(Vj,{children:[a.map((e=>(0,N.jsxs)($j,{style:{cursor:"pointer"},onClick:()=>(async e=>{if(e)try{const{data:t,error:o}=await D.supabase.from("contacts").select("*").eq("id",e).single();if(o)throw o;n(),window.dispatchEvent(new CustomEvent("openContactModal",{detail:t}))}catch(t){console.error("Error fetching contact details:",t)}})(e.id),children:[(0,N.jsx)("span",{title:Zj(e),children:Zj(e)}),(0,N.jsx)("button",{onClick:t=>{t.stopPropagation(),(async e=>{try{h(!0);const{error:t}=await D.supabase.from("contact_companies").delete().eq("company_id",r.id).eq("contact_id",e.id);if(t)throw t;s(a.filter((t=>t.id!==e.id))),g({type:"success",text:"Contact unlinked successfully"})}catch(t){console.error("Error unlinking contact:",t),g({type:"error",text:"Failed to unlink contact"})}finally{h(!1)}})(e)},disabled:p,title:"Unlink contact",children:(0,N.jsx)(B.yGN,{size:14})})]},e.id))),0===a.length&&(0,N.jsx)("span",{style:{color:"#6c757d",fontStyle:"italic",padding:"4px"},children:"No contacts linked"})]})]}),(0,N.jsxs)(Hj,{children:[(0,N.jsx)(Bj,{children:"Add Contacts"}),(0,N.jsxs)(Uj,{children:[(0,N.jsx)(Wj,{children:(0,N.jsx)(B.CKj,{size:16})}),(0,N.jsx)(qj,{type:"text",value:l,onChange:e=>c(e.target.value),placeholder:"Search for a contact (name or email)..."})]}),m&&(0,N.jsxs)(Kj,{children:[d.map((e=>(0,N.jsxs)(Yj,{onClick:()=>(async e=>{try{if(h(!0),console.log("Adding contact:",e),console.log("Company:",r),!r.id)throw new Error("Missing company ID");const{data:t,error:o}=await D.supabase.from("contact_companies").select("company_id, contact_id").eq("company_id",r.id).eq("contact_id",e.id);if(o)throw console.error("Error checking existing contact association:",o),o;if(console.log("Existing check result:",t),t&&t.length>0)return console.log("Contact already linked:",t),void g({type:"info",text:"This contact is already linked to the company"});const n={company_id:r.id,contact_id:e.id,created_at:(new Date).toISOString()};console.log("Creating new association:",n);const{data:i,error:a}=await D.supabase.from("contact_companies").insert(n).select();if(a)throw console.error("Error inserting contact association:",a),a;console.log("Successfully added contact:",i),await v(),c(""),y(!1),g({type:"success",text:"Contact linked successfully"})}catch(t){console.error("Error linking contact:",t),g({type:"error",text:`Failed to link contact: ${t.message}`})}finally{h(!1)}})(e),disabled:p,children:[Zj(e),e.email&&(0,N.jsx)("span",{style:{fontSize:"0.75rem",color:"#6b7280"},children:e.email})]},e.id))),0===d.length&&l.length>=2&&(0,N.jsx)("div",{style:{padding:"8px 12px",color:"#6c757d",fontSize:"0.875rem"},children:"No contacts found"})]})]}),f.text&&(0,N.jsx)(Jj,{className:f.type,children:f.text}),(0,N.jsx)(Xj,{children:(0,N.jsx)(Qj,{className:"primary",onClick:n,children:"Done"})}),p&&(0,N.jsx)("div",{style:{textAlign:"center",marginTop:"10px"},children:(0,N.jsx)("div",{className:"spinner",style:{width:"20px",height:"20px",border:"3px solid #f3f3f3",borderTop:"3px solid #000000",borderRadius:"50%",animation:"spin 1s linear infinite"}})})]})})},tA=document.createElement("style");tA.innerHTML="\n  @keyframes spin {\n    0% { transform: rotate(0deg); }\n    100% { transform: rotate(360deg); }\n  }\n",document.head.appendChild(tA);var oA=o(2509);P.Ay.div`
  display: flex;
  justify-content: space-between;
  align-items: center;
  margin-bottom: 20px;
  padding-bottom: 15px;
  border-bottom: 1px solid #333;
`,P.Ay.h2`
  color: #fff;
  margin: 0;
  padding: 0;
  font-size: 1.3rem;
  display: flex;
  align-items: center;
  gap: 10px;
`,P.Ay.button`
  background: transparent;
  border: none;
  color: #999;
  font-size: 1.5rem;
  cursor: pointer;
  display: flex;
  align-items: center;
  justify-content: center;
  padding: 0;
  width: 32px;
  height: 32px;
  border-radius: 4px;
  
  &:hover {
    background: #333;
    color: #fff;
  }
`,P.Ay.div`
  color: #ccc;
  margin-bottom: 20px;
  overflow-y: auto;
  max-height: calc(90vh - 150px);
`,P.Ay.div`
  display: flex;
  justify-content: flex-end;
  gap: 10px;
  padding-top: 15px;
  border-top: 1px solid #333;
`,P.Ay.button`
  background-color: ${e=>"primary"===e.variant?"#00ff00":"transparent"};
  color: ${e=>"primary"===e.variant?"#000":"#ccc"};
  border: ${e=>"primary"===e.variant?"none":"1px solid #555"};
  padding: 8px 16px;
  border-radius: 4px;
  cursor: pointer;
  display: flex;
  align-items: center;
  gap: 8px;
  font-size: 0.9rem;
  
  &:hover {
    background-color: ${e=>"primary"===e.variant?"#00dd00":"#333"};
  }
  
  &:disabled {
    opacity: 0.5;
    cursor: not-allowed;
  }
`,P.Ay.div`
  margin-bottom: 20px;
`,P.Ay.h3`
  font-size: 1rem;
  color: #00ff00;
  margin-bottom: 10px;
  display: flex;
  align-items: center;
  gap: 5px;
`,P.Ay.div`
  margin-bottom: 15px;
`,P.Ay.label`
  display: block;
  margin-bottom: 5px;
  color: #999;
  font-size: 0.8rem;
`,P.Ay.input`
  width: 100%;
  padding: 8px 10px;
  border: 1px solid #444;
  border-radius: 4px;
  background-color: #333;
  color: #fff;
  font-size: 0.9rem;
  
  &:focus {
    outline: none;
    border-color: #00ff00;
  }
  
  &:disabled {
    opacity: 0.7;
    cursor: not-allowed;
  }
`,P.Ay.textarea`
  width: 100%;
  padding: 8px 10px;
  border: 1px solid #444;
  border-radius: 4px;
  background-color: #333;
  color: #fff;
  font-size: 0.9rem;
  min-height: 100px;
  resize: vertical;
  
  &:focus {
    outline: none;
    border-color: #00ff00;
  }
  
  &:disabled {
    opacity: 0.7;
    cursor: not-allowed;
  }
`,P.Ay.select`
  width: 100%;
  padding: 8px 10px;
  border: 1px solid #444;
  border-radius: 4px;
  background-color: #333;
  color: #fff;
  font-size: 0.9rem;
  
  &:focus {
    outline: none;
    border-color: #00ff00;
  }
  
  &:disabled {
    opacity: 0.7;
    cursor: not-allowed;
  }
`,P.Ay.div`
  display: flex;
  gap: 15px;
  
  @media (max-width: 600px) {
    flex-direction: column;
  }
`,P.Ay.span`
  display: inline-block;
  padding: 3px 8px;
  border-radius: 4px;
  font-size: 0.8rem;
  background-color: ${e=>e.bg||"rgba(0, 255, 0, 0.1)"};
  color: ${e=>e.color||"#00ff00"};
  border: 1px solid ${e=>e.borderColor||"#00ff00"};
  margin-right: 5px;
  margin-bottom: 5px;
`,P.Ay.div`
  display: flex;
  flex-wrap: wrap;
  gap: 5px;
  margin-top: 10px;
`,P.Ay.div`
  display: inline-flex;
  align-items: center;
  gap: 5px;
  padding: 3px 8px;
  background-color: #333;
  border: 1px solid #00ff00;
  border-radius: 4px;
  color: #00ff00;
  font-size: 0.8rem;

  .remove {
    cursor: pointer;
    opacity: 0.8;
    &:hover {
      opacity: 1;
    }
  }
`,P.Ay.div`
  margin-top: 10px;
`,P.Ay.div`
  display: flex;
  justify-content: space-between;
  align-items: center;
  padding: 8px 10px;
  border: 1px solid #444;
  border-radius: 4px;
  margin-bottom: 8px;
  background-color: #2a2a2a;

  &:hover {
    background-color: #333;
  }
`,P.Ay.div`
  display: flex;
  align-items: center;
  gap: 10px;
`,P.Ay.div`
  width: 32px;
  height: 32px;
  border-radius: 4px;
  background-color: rgba(0, 170, 255, 0.1);
  display: flex;
  align-items: center;
  justify-content: center;
  color: #00aaff;
`,P.Ay.div`
  display: flex;
  flex-direction: column;
`,P.Ay.div`
  font-size: 0.9rem;
  color: #fff;
`,P.Ay.div`
  font-size: 0.8rem;
  color: #999;
`,P.Ay.div`
  display: flex;
  gap: 5px;
`,P.Ay.button`
  background-color: transparent;
  border: none;
  color: #00ff00;
  cursor: pointer;
  padding: 5px;
  display: flex;
  align-items: center;
  justify-content: center;
  border-radius: 4px;
  
  &:hover {
    background-color: #333;
  }
`,P.Ay.button`
  background-color: #333;
  color: #00ff00;
  border: 1px solid #00ff00;
  border-radius: 4px;
  padding: 8px 12px;
  cursor: pointer;
  display: flex;
  align-items: center;
  gap: 5px;
  font-size: 0.9rem;
  
  &:hover {
    background-color: rgba(0, 255, 0, 0.1);
  }
`,P.Ay.div`
  position: relative;
  margin-bottom: 10px;
`,P.Ay.div`
  position: absolute;
  top: 100%;
  left: 0;
  width: 100%;
  max-height: 200px;
  overflow-y: auto;
  background-color: #333;
  border: 1px solid #444;
  border-radius: 4px;
  z-index: 5;
`,P.Ay.div`
  padding: 8px 10px;
  cursor: pointer;
  
  &:hover {
    background-color: #444;
  }
`;ot().setAppElement("#root");const nA=P.Ay.div`
  padding: 0 0 0 20px;
  max-width: 1200px;
  margin: 0;
`,rA=(P.Ay.div`
  display: none;
`,P.Ay.h1`
  display: none;
`,P.Ay.div`
  display: flex;
  align-items: center;
  margin-bottom: 20px;
  font-size: 0.9rem;
  color: #999;
`),iA=P.Ay.div`
  display: flex;
  align-items: center;
  margin-right: 5px;
  
  a {
    color: ${e=>e.active?"#00ff00":"#999"};
    text-decoration: none;
    padding: 5px 8px;
    border-radius: 4px;
    cursor: ${e=>e.active?"default":"pointer"};
    font-weight: ${e=>e.active?"bold":"normal"};
    
    &:hover {
      color: ${e=>e.active?"#00ff00":"#ccc"};
      background-color: ${e=>e.active?"transparent":"#333"};
    }
  }
`,aA=P.Ay.div`
  display: flex;
  margin: 10px 0;
  border-radius: 4px;
  overflow: hidden;
  background-color: #1a1a1a;
  height: 4px;
`,sA=P.Ay.div`
  flex: 1;
  height: 100%;
  background-color: ${e=>e.$active?"#00ff00":e.$completed?"#00aa00":"#333"};
  transition: background-color 0.3s ease;
`,lA=P.Ay.div`
  display: flex;
  margin-bottom: 15px;
  justify-content: space-between;
`,cA=P.Ay.div`
  display: flex;
  align-items: center;
  flex: 1;
  cursor: ${e=>e.$clickable?"pointer":"default"};
  padding: 0 5px;
  
  &:hover .step-number {
    background-color: ${e=>e.$clickable&&!e.$active?"#444":e.$active?"#00ff00":e.$completed?"#00aa00":"#333"};
  }
  
  &:hover .step-label {
    color: ${e=>e.$clickable&&!e.$active?"#ccc":e.$active?"#00ff00":e.$completed?"#00aa00":"#999"};
  }
  
  .step-number {
    width: 24px;
    height: 24px;
    border-radius: 50%;
    background-color: ${e=>e.$active?"#00ff00":e.$completed?"#00aa00":"#333"};
    color: #000;
    display: flex;
    align-items: center;
    justify-content: center;
    font-weight: bold;
    font-size: 12px;
    margin-right: 8px;
    transition: background-color 0.3s ease;
    flex-shrink: 0;
  }
  
  .step-label {
    font-size: 0.8rem;
    color: ${e=>e.$active?"#00ff00":e.$completed?"#00aa00":"#999"};
    transition: color 0.3s ease;
    white-space: nowrap;
  }
`,dA=P.Ay.div`
  background-color: #1a1a1a;
  border-radius: 8px;
  border: 1px solid #333;
  padding: 20px;
  margin-bottom: 20px;
`,uA=P.Ay.h3`
  color: #00ff00;
  margin: 0 0 15px 0;
  font-size: 1.2rem;
  display: flex;
  align-items: center;
  gap: 8px;
  padding-bottom: 10px;
  border-bottom: 1px solid #333;
`,pA=P.Ay.button`
  background-color: ${e=>"primary"===e.variant?"#00ff00":"danger"===e.variant?"#ff5555":"warning"===e.variant?"#ff9900":"transparent"};
  color: ${e=>"primary"===e.variant||"warning"===e.variant?"#000":"danger"===e.variant?"#fff":"#ccc"};
  border: ${e=>e.variant?"none":"1px solid #555"};
  padding: 10px 20px;
  border-radius: 4px;
  cursor: pointer;
  display: inline-flex;
  align-items: center;
  gap: 8px;
  font-size: 0.9rem;
  
  &:hover {
    background-color: ${e=>"primary"===e.variant?"#00dd00":"danger"===e.variant?"#ff3333":"warning"===e.variant?"#ff8800":"#333"};
  }
  
  &:disabled {
    opacity: 0.5;
    cursor: not-allowed;
  }
`,hA=P.Ay.div`
  display: flex;
  justify-content: space-between;
  margin-top: 30px;
`,fA=P.Ay.div`
  display: flex;
  height: 525px; /* Added 5% more (500px to 525px) */
  border: 1px solid #333;
  border-radius: 6px;
  overflow: hidden;
  background-color: #1a1a1a;
`,gA=P.Ay.div`
  flex: 0 0 15%;
  border-right: 1px solid #333;
  background-color: #111;
  overflow-y: auto;
`,mA=(P.Ay.div`
  padding: 12px 15px;
  cursor: pointer;
  border-bottom: 1px solid #222;
  transition: all 0.2s;
  display: flex;
  align-items: center;
  gap: 8px;
  background-color: ${e=>e.active?"#222":"transparent"};
  
  .channel-name {
    font-weight: ${e=>e.active?"bold":"normal"};
    color: ${e=>{if(!e.active)return"#aaa";switch(e.channel){case"Email":return"#4a9eff";case"Meeting":return"#ff9900";case"Phone":return"#00ff00";case"Slack":return"#9000ff";case"WhatsApp":return"#25d366";default:return"#ccc"}}};
  }
  
  .channel-count {
    background-color: ${e=>e.active?"#333":"#222"};
    color: ${e=>e.active?"#fff":"#888"};
    padding: 1px 6px;
    border-radius: 10px;
    font-size: 0.7rem;
    margin-left: auto;
  }
  
  
  &:hover {
    background-color: #1e1e1e;
  }
`,P.Ay.div`
  flex: 0 0 90%;
  padding: 0 0 0 0;
  overflow-y: auto;
  background-color: #1a1a1a;
`),yA=(P.Ay.div`
  padding: 15px;
  border-bottom: 1px solid #333;
  
  &:last-child {
    border-bottom: none;
  }
`,P.Ay.div`
  display: flex;
  justify-content: space-between;
  margin-bottom: 10px;
  align-items: center;
  
  .interaction-direction {
    font-size: 0.75rem;
    background-color: ${e=>"Outbound"===e.direction?"#2d562d":"#333"};
    color: ${e=>"Outbound"===e.direction?"#8aff8a":"#ccc"};
    padding: 2px 6px;
    border-radius: 4px;
  }
  
  .interaction-date {
    color: #888;
    font-size: 0.8rem;
    display: flex;
    flex-direction: column;
    align-items: flex-end;
    
    .date {
      color: #999;
    }
    
    .time {
      color: #777;
      font-size: 0.7rem;
    }
  }
`,P.Ay.div`
  color: #eee;
  white-space: pre-wrap;
  font-size: 0.9rem;
  line-height: 1.5;
  background-color: ${e=>"whatsapp"===e.type?"transparent":"#222"};
  padding: ${e=>"whatsapp"===e.type?"0":"12px"};
  border-radius: 4px;
  
  .summary-title {
    font-weight: bold;
    color: #ccc;
    margin-bottom: 5px;
    font-size: 0.8rem;
  }
`,P.Ay.div`
  max-width: 70%;
  padding: 8px 12px;
  border-radius: 8px;
  margin-bottom: 8px;
  position: relative;
  font-size: 0.9rem;
  line-height: 1.4;
  word-break: break-word;
  
  /* Messages colors */
  background-color: ${e=>"Outbound"===e.direction?"#056162":"#262d31"};
  color: #e5e5e5;
  
  .time {
    font-size: 0.7rem;
    color: rgba(255, 255, 255, 0.6);
    text-align: right;
    margin-top: 4px;
  }
`,P.Ay.div`
  display: flex;
  width: 100%;
  padding: 4px 0;
  justify-content: ${e=>"Outbound"===e.direction?"flex-end":"flex-start"};
`,P.Ay.div`
  display: flex;
  flex-direction: column;
  height: 100%;
  background-color: #1e1e1e;
  position: relative;
  border-radius: 4px;
  overflow: hidden;
`),vA=P.Ay.div`
  background-color: #2a2a2a;
  color: white;
  padding: 16px;
  border-bottom: 1px solid #444;
`,bA=P.Ay.div`
  font-size: 1.2rem;
  font-weight: bold;
  margin-bottom: 8px;
  color: #e0e0e0;
`,xA=(P.Ay.div`
  font-size: 0.8rem;
  color: #aaa;
`,P.Ay.div`
  flex: 1;
  overflow-y: auto;
  max-height: calc(100vh - 280px);
`),wA=P.Ay.div`
  border-bottom: 1px solid #333;
  padding: 6px 64px 16px 0px;
  background-color: #1a1a1a;
  transition: background-color 0.2s;

  &:hover {
    background-color: #222;
  }
  
  ${e=>e.$expanded&&"\n    background-color: #222;\n  "}
`,CA=P.Ay.div`
  padding: 16px;
  cursor: pointer;
`,_A=P.Ay.div`
  display: flex;
  justify-content: space-between;
  margin-bottom: 8px;
`,SA=P.Ay.div`
  font-weight: bold;
  color: #e0e0e0;
`,EA=P.Ay.div`
  color: #999;
  font-size: 0.8rem;
`,kA=P.Ay.div`
  color: #aaa;
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
  font-size: 0.9rem;
`,jA=P.Ay.div`
  padding: 0 0 16px 16px;
  color: #e0e0e0;
  font-size: 0.9rem;
  line-height: 1.5;
  
  p {
    margin-bottom: 8px;
  }
  
  a {
    color: #4a9eff;
    text-decoration: none;
    
    &:hover {
      text-decoration: underline;
    }
  }
`,AA=P.Ay.div`
  margin-top: 12px;
  padding-top: 12px;
  border-top: 1px solid #333;
`,RA=P.Ay.div`
  display: flex;
  align-items: center;
  padding: 8px;
  background-color: #252525;
  border-radius: 4px;
  margin-top: 8px;
  
  svg {
    margin-right: 8px;
    color: #999;
  }
`,OA=P.Ay.div`
  display: flex;
  flex-direction: column;
  height: 100%;
  background-color: #0b1a1a; /* Dark WhatsApp background */
  position: relative;
  border-radius: 4px;
  overflow: hidden;
`,TA=P.Ay.div`
  background-color: #075e54; /* WhatsApp green */
  color: white;
  padding: 12px 16px;
  display: flex;
  align-items: center;
  gap: 12px;
`,DA=P.Ay.div`
  width: 36px;
  height: 36px;
  border-radius: 50%;
  background-color: #128c7e; /* WhatsApp secondary green */
  display: flex;
  align-items: center;
  justify-content: center;
  color: white;
  font-weight: bold;
`,PA=P.Ay.div`
  flex: 1;
`,NA=P.Ay.div`
  font-weight: bold;
  font-size: 1rem;
`,IA=P.Ay.div`
  font-size: 0.75rem;
`,MA=(P.Ay.button`
  background: none;
  border: none;
  color: white;
  opacity: 0.8;
  cursor: pointer;
  display: flex;
  align-items: center;
  justify-content: center;
  padding: 4px;
  margin-left: 8px;
  
  &:hover {
    opacity: 1;
  }
`,P.Ay.div`
  display: flex;
  align-items: center;
`,P.Ay.div`
  display: flex;
  align-items: center;
  width: 100%;
`,P.Ay.input`
  background-color: #000;
  border: none;
  border-bottom: 1px solid #fff;
  color: white;
  font-size: 1rem;
  font-weight: bold;
  padding: 4px;
  outline: none;
  flex: 1;
`),LA=(P.Ay.div`
  display: flex;
  align-items: center;
`,P.Ay.button`
  background: none;
  border: none;
  color: white;
  cursor: pointer;
  padding: 4px;
  
  &:hover {
    color: #4CAF50;
  }
`,P.Ay.button`
  background: none;
  border: none;
  color: white;
  cursor: pointer;
  padding: 4px;
  
  &:hover {
    color: #F44336;
  }
  opacity: 0.8;
`),FA=P.Ay.div`
  flex: 1;
  overflow-y: auto;
  /* Try generous right padding, e.g., 32px or more */
  padding: 16px 64px 16px 16px; /* (top, right, bottom, left) */
  box-sizing: border-box; /* Explicitly add this just in case */
  display: flex;
  flex-direction: column;
  gap: 12px;
  max-height: calc(100vh - 280px);
  background-image: url("..."); // Keep background
`,GA=P.Ay.div`
  max-width: 50%;
  padding: 10px 14px;
  border-radius: 12px;
  position: relative;
  word-wrap: break-word;
  line-height: 1.4;
  font-size: 0.95rem;
  box-shadow: 0 1px 1px rgba(0, 0, 0, 0.1);
  align-self: ${e=>"sent"===e.$direction?"flex-end":"flex-start"};
  background-color: ${e=>"sent"===e.$direction?"#055e54":"#202c33"};
  color: ${e=>(e.$direction,"#e9e9e9")};
  
  &:before {
    content: '';
    position: absolute;
    top: 0;
    ${e=>"sent"===e.$direction?"right: -8px;":"left: -8px;"}
    width: 0;
    height: 0;
    border-top: 8px solid ${e=>"sent"===e.$direction?"#055e54":"#202c33"};
    border-right: ${e=>"sent"===e.$direction?"8px solid transparent":"none"};
    border-left: ${e=>"sent"!==e.$direction?"8px solid transparent":"none"};
  }
`,zA=P.Ay.div`
  font-size: 0.65rem;
  opacity: 0.7;
  margin-top: 4px;
  text-align: right;
  padding-right: 4px;
`,HA=P.Ay.div`
  display: flex;
  flex-direction: column;
  align-items: center;
  justify-content: center;
  height: 100%;
  color: #777;
  text-align: center;
  padding: 20px;
  
  svg {
    font-size: 3rem;
    margin-bottom: 16px;
    opacity: 0.5;
  }
  
  h3 {
    font-weight: normal;
    margin-bottom: 8px;
  }
  
  p {
    font-size: 0.9rem;
    max-width: 300px;
  }
`,BA=P.Ay.div`
  display: flex;
  justify-content: space-between;
  align-items: center;
  padding-bottom: 15px;
  margin-bottom: 20px;
  border-bottom: 1px solid #333;

  h2 {
    color: #00ff00;
    margin: 0;
  }
`,VA=P.Ay.div`
  display: flex;
  border-bottom: 1px solid #333;
  margin-bottom: 20px;
`,$A=P.Ay.div`
  padding: 10px 20px;
  cursor: pointer;
  color: ${e=>e.active?"#00ff00":"#ccc"};
  border-bottom: 2px solid ${e=>e.active?"#00ff00":"transparent"};
  font-family: 'Courier New', monospace;
  
  &:hover {
    color: ${e=>e.active?"#00ff00":"#eee"};
  }
`,UA=P.Ay.div`
  display: ${e=>e.active?"block":"none"};
`,WA=P.Ay.button`
  background: none;
  border: none;
  color: #ff5555;
  font-size: 1.2rem;
  cursor: pointer;
  display: flex;
  align-items: center;
  justify-content: center;
  
  &:hover {
    color: #ff0000;
  }
`,qA=P.Ay.div`
  margin-bottom: 20px;
  color: #cccccc;
  font-size: 0.9rem;
`,KA=P.Ay.div`
  margin-bottom: 25px;
`,YA=P.Ay.div`
  display: grid;
  grid-template-columns: repeat(3, 1fr);
  gap: 10px;
  margin-top: 10px;
  
  @media (max-width: 768px) {
    grid-template-columns: repeat(2, 1fr);
  }
  
  @media (max-width: 480px) {
    grid-template-columns: 1fr;
  }
`,JA=P.Ay.div`
  display: flex;
  align-items: center;
  color: #cccccc;
`,XA=P.Ay.input`
  margin-right: 8px;
  cursor: pointer;
  width: 16px;
  height: 16px;
  appearance: none;
  border: 1px solid #00ff00;
  background: #222;
  border-radius: 3px;
  position: relative;
  
  &:checked {
    background: #00ff00;
    
    &:after {
      content: '';
      position: absolute;
      left: 5px;
      top: 2px;
      width: 4px;
      height: 8px;
      border: solid #000;
      border-width: 0 2px 2px 0;
      transform: rotate(45deg);
    }
  }
`,QA=P.Ay.div`
  background-color: #1a1a1a;
  padding: 15px;
  border-radius: 4px;
  margin-bottom: 20px;
  border: 1px solid #333;
`,ZA=P.Ay.div`
  margin-bottom: 10px;
  
  &:last-child {
    margin-bottom: 0;
  }
`,eR=P.Ay.span`
  color: #999;
  margin-right: 10px;
  font-size: 0.8rem;
`,tR=P.Ay.span`
  color: #cccccc;
  font-weight: normal;
`,oR=P.Ay.button`
  background-color: #ff5555;
  color: white;
  border: none;
  padding: 10px 20px;
  border-radius: 4px;
  font-weight: bold;
  cursor: pointer;
  display: flex;
  align-items: center;
  gap: 8px;
  
  &:hover {
    background-color: #ff3333;
  }
  
  &:disabled {
    background-color: #772727;
    cursor: not-allowed;
    opacity: 0.7;
  }
`,nR=(P.Ay.button`
  background-color: transparent;
  color: #cccccc;
  border: 1px solid #555;
  padding: 10px 20px;
  border-radius: 4px;
  cursor: pointer;
  display: flex;
  align-items: center;
  gap: 8px;
  
  &:hover {
    background-color: #333;
  }
`,P.Ay.div`
  max-height: 500px;
  overflow-y: auto;
  margin-top: 15px;
`,P.Ay.div`
  border: 1px solid ${e=>e.selected?"#00ff00":"#333"};
  border-radius: 8px;
  padding: 15px;
  background-color: ${e=>e.selected?"rgba(0, 255, 0, 0.1)":"#222"};
  margin-bottom: 15px;
  cursor: pointer;
  transition: all 0.2s;
  
  &:hover {
    background-color: ${e=>e.selected?"rgba(0, 255, 0, 0.15)":"#333"};
  }
`,P.Ay.h4`
  margin: 0 0 8px 0;
  color: #00ff00;
  font-size: 1rem;
`,P.Ay.div`
  font-size: 0.9rem;
  color: #ccc;
  display: flex;
  flex-wrap: wrap;
  gap: 10px;
`,P.Ay.table`
  width: 100%;
  border-collapse: collapse;
  margin-bottom: 20px;
  
  th, td {
    padding: 10px;
    text-align: left;
    border-bottom: 1px solid #333;
  }
  
  th {
    color: #00ff00;
    font-weight: bold;
    font-size: 0.9rem;
  }
  
  td {
    color: #ccc;
    font-size: 0.9rem;
  }
`),rR=P.Ay.label`
  display: flex;
  align-items: center;
  gap: 8px;
  cursor: pointer;
  padding: 5px 0;
  
  &:hover {
    color: #00ff00;
  }
`,iR=P.Ay.input`
  appearance: none;
  width: 16px;
  height: 16px;
  border: 2px solid #555;
  border-radius: 50%;
  margin: 0;
  cursor: pointer;
  
  &:checked {
    border-color: #00ff00;
    background-color: #00ff00;
    box-shadow: inset 0 0 0 3px #222;
  }
  
  &:hover {
    border-color: #00ff00;
  }
`,aR=P.Ay.div`
  display: grid;
  grid-template-columns: 1fr 1fr;
  gap: 20px;
  
  @media (max-width: 768px) {
    grid-template-columns: 1fr;
  }
`,sR=P.Ay.div`
  display: flex;
  align-items: center;
  gap: 8px;
  margin-bottom: 15px;
  padding-bottom: 10px;
  border-bottom: 1px solid #333;
  color: #00ff00;
`,lR=(P.Ay.span`
  display: flex;
  align-items: center;
  justify-content: center;
  width: 24px;
  height: 24px;
  background: rgba(0, 255, 0, 0.1);
  border-radius: 50%;
  padding: 5px;
`,P.Ay.span`
  font-size: 1rem;
  font-weight: bold;
  letter-spacing: 0.5px;
`,P.Ay.div`
  color: #999;
  font-size: 0.8rem;
  margin-bottom: 5px;
`),cR=P.Ay.div`
  margin-bottom: 20px;
  
  &:last-child {
    margin-bottom: 0;
  }
`,dR=P.Ay.label`
  color: #999;
  display: block;
  margin-bottom: 8px;
  font-size: 0.9rem;
`,uR=P.Ay.input`
  background-color: #222;
  border: 1px solid #444;
  border-radius: 4px;
  color: #eee;
  padding: 10px 12px;
  width: 100%;
  font-size: 0.9rem;
  box-sizing: border-box;
  
  &:focus {
    outline: none;
    border-color: #00ff00;
  }
`,pR=P.Ay.select`
  background-color: #222;
  border: 1px solid #444;
  border-radius: 4px;
  color: #eee;
  padding: 10px 12px;
  width: 100%;
  font-size: 0.9rem;
  
  &:focus {
    outline: none;
    border-color: #00ff00;
  }
`,hR=P.Ay.textarea`
  background-color: #222;
  border: 1px solid #444;
  border-radius: 4px;
  color: #eee;
  padding: 10px 12px;
  width: 100%;
  min-height: 120px;
  font-size: 0.9rem;
  resize: vertical;
  
  &:focus {
    outline: none;
    border-color: #00ff00;
  }
`,fR=(P.Ay.div`
  margin-top: 10px;
  padding: 10px;
  background-color: #222;
  border-radius: 4px;
  border-left: 3px solid ${e=>e.color||"#666"};
  font-size: 0.85rem;
  color: #ccc;
  
  .source-label {
    font-size: 0.75rem;
    color: ${e=>e.color||"#999"};
    text-transform: uppercase;
    margin-bottom: 3px;
    font-weight: bold;
  }
  
  .source-value {
    word-break: break-word;
  }
`,P.Ay.div`
  display: flex;
  flex-wrap: wrap;
  gap: 10px;
  margin-bottom: 15px;
`,P.Ay.button`
  background-color: ${e=>e.active?"rgba(0, 255, 0, 0.2)":"#222"};
  border: 1px solid ${e=>e.active?"#00ff00":"#444"};
  color: ${e=>e.active?"#00ff00":"#999"};
  padding: 5px 10px;
  border-radius: 4px;
  font-size: 0.8rem;
  cursor: pointer;
  
  &:hover {
    background-color: ${e=>e.active?"rgba(0, 255, 0, 0.3)":"#333"};
  }
`,P.Ay.div`
  display: flex;
  flex-wrap: wrap;
  gap: 8px;
  margin-top: 10px;
`),gR=P.Ay.div`
  background-color: #222;
  color: #00ff00;
  border: 1px solid #00ff00;
  border-radius: 4px;
  padding: 4px 8px;
  font-size: 0.8rem;
  display: flex;
  align-items: center;
  gap: 5px;
  
  .remove {
    cursor: pointer;
    &:hover {
      color: #ff5555;
    }
  }
`,mR=(P.Ay.div`
  text-align: center;
  padding: 30px;
  color: #999;
  font-style: italic;
`,P.Ay.div`
  display: flex;
  flex-direction: column;
  align-items: center;
  justify-content: center;
  min-height: 400px;
  color: #00ff00;
`),yR=P.Ay.span`
  display: inline-block;
  background-color: ${e=>e.bg||"#222"};
  color: ${e=>e.color||"#00ff00"};
  border: 1px solid ${e=>e.borderColor||"#00ff00"};
  padding: 3px 8px;
  border-radius: 4px;
  font-size: 12px;
`,vR=(P.Ay.input`
  background-color: transparent;
  border: none;
  border-bottom: 1px dashed #00ff00;
  color: #fff;
  font-size: 1.5rem;
  font-weight: bold;
  padding: 2px 4px;
  margin: 0 5px 0 0;
  outline: none;
  width: ${e=>e.width||"150px"};
  
  &:focus {
    background-color: #111;
    border-bottom: 1px solid #00ff00;
  }
`,P.Ay.span`
  opacity: 0;
  margin-left: 8px;
  cursor: pointer;
  transition: opacity 0.2s;
  display: inline-flex;
  align-items: center;
`),bR=P.Ay.div`
  margin-bottom: 20px;
  
  h2 {
    color: #fff;
    margin: 0 0 5px 0;
    display: flex;
    align-items: center;
    
    &:hover ${vR} {
      opacity: 0.8;
    }
    font-size: 1.5rem;
  }
  
  .contact-details {
    color: #aaa;
    display: flex;
    flex-wrap: wrap;
    gap: 15px;
    font-size: 0.9rem;
    
    .detail-item {
      display: flex;
      align-items: center;
      gap: 5px;
    }
  }
`,xR=P.Ay.div`
  background-color: rgba(255, 70, 70, 0.2);
  border: 1px solid #ff4646;
  color: #ff9999;
  padding: 15px;
  border-radius: 4px;
  margin-bottom: 20px;
  display: flex;
  align-items: center;
  gap: 10px;
`,wR=(P.Ay.div`
  display: flex;
  align-items: center;
  gap: 8px;
  font-size: 15px;
  font-weight: 500;
  margin-bottom: 15px;
  color: #eee;
  border-bottom: 1px solid #333;
  padding-bottom: 10px;
`,()=>{var e,o,n;const{id:r}=(0,i.g)(),a=(0,i.Zp)(),s=(0,i.zy)(),l=new URLSearchParams(s.search).get("step"),[c,d]=(0,t.useState)(null),[u,p]=(0,t.useState)(null),[h,f]=(0,t.useState)(""),[g,m]=(0,t.useState)([]),[y,v]=(0,t.useState)(parseInt(l)||1),[b,x]=(0,t.useState)(!0),[w,C]=(0,t.useState)([]),[_,S]=(0,t.useState)(!1),[E,k]=(0,t.useState)(!1),[j,A]=(0,t.useState)(!1),[R,O]=(0,t.useState)(!1),[T,P]=(0,t.useState)("list"),[I,M]=(0,t.useState)({}),[L,F]=(0,t.useState)({}),[G,z]=(0,t.useState)([]),[H,V]=(0,t.useState)(!1),[$,U]=(0,t.useState)(!1),[W,q]=(0,t.useState)(null),[K]=(0,t.useState)(["Email","Meeting","Phone","Video Call","Other"]),[Y]=(0,t.useState)(["Business","Personal","Investment","Other"]),[J]=(0,t.useState)(["Requested","Completed","Declined","Pending"]),[X,Q]=(0,t.useState)(null),[Z,ee]=(0,t.useState)(""),[te,oe]=(0,t.useState)(""),[ne,re]=(0,t.useState)([]),[ie,ae]=(0,t.useState)([]),[se,le]=(0,t.useState)(!1),[ce,de]=(0,t.useState)(null),[ue,pe]=(0,t.useState)(0),[he]=(0,t.useState)(["Lead","Evaluating","Closing","Invested","Monitoring","Passed"]),[fe]=(0,t.useState)(["Inbox","Startup","Fund","Real Estate","Private Debt","Private Equity","Other"]),[ge]=(0,t.useState)(["Inbox","Startup","Fund","Real Estate","Private Debt","Private Equity","Other"]),[me]=(0,t.useState)(["Not Set","Cold Contacting","Introduction"]),[ye]=(0,t.useState)(["Introducer","Co-Investor","Advisor","Other"]),[ve]=(0,t.useState)(["introducer","co-investor","advisor","other"]),be={Introducer:"introducer","Co-Investor":"co-investor",Advisor:"advisor",Other:"other"},[xe,we]=(0,t.useState)(!1),[Ce,_e]=(0,t.useState)(""),[Se,Ee]=(0,t.useState)(""),[ke,je]=(0,t.useState)(null),[Ae,Re]=(0,t.useState)(null),[Oe,Te]=(0,t.useState)(!1),[De,Pe]=(0,t.useState)(!1),[Ne,Ie]=(0,t.useState)(!1),[Me,Le]=(0,t.useState)(null),[Fe,Ge]=(0,t.useState)(!1),[ze,He]=(0,t.useState)(!1),[Be,Ve]=(0,t.useState)(!1),[$e,Ue]=(0,t.useState)(!1),[We,qe]=(0,t.useState)(!1),[Ke,Ye]=(0,t.useState)(!1),[Je,Xe]=(0,t.useState)(!1),[Qe,Ze]=(0,t.useState)(!1),[et,tt]=(0,t.useState)(""),[rt,it]=(0,t.useState)({name:"",category:"",website:"",description:"",linkedin:"",tags:[]}),[at,st]=(0,t.useState)(null),[lt,ct]=(0,t.useState)({whatsapp:[],email:[],other:[]}),[dt,ut]=(0,t.useState)([]),[ht,ft]=(0,t.useState)(null),[gt,mt]=(0,t.useState)(!1),[yt,vt]=(0,t.useState)({first_name:"current",last_name:"current",category:"current",job_role:"current",emails:"current",mobiles:"current",tags:"current",cities:"current",companies:"current",linkedin:"current",score:"current",keep_in_touch_frequency:"current"}),[bt,xt]=(0,t.useState)([]),[wt,Ct]=(0,t.useState)(""),[_t,St]=(0,t.useState)("name"),[Et,kt]=(0,t.useState)([]),[jt,At]=(0,t.useState)(!1),[Rt,Ot]=(0,t.useState)(null),[Tt,Dt]=(0,t.useState)({keepInTouch:null,category:null,notes:"",city:null,tags:[],mobiles:[],emails:[],linkedIn:"",company:null,dealInfo:"",selectedTag:"",newCustomTag:"",tagSuggestions:[]}),[Pt,Nt]=(0,t.useState)({hubspot:{email:"",mobile:"",company:null,tags:[],notes:"",keepInTouch:null,category:null},supabase:{email:"",mobile:"",company:null,tags:[],notes:"",keepInTouch:null,category:null},airtable:{email:"",mobile:"",company:null,tags:[],notes:"",keepInTouch:null,category:null}}),[It,Mt]=(0,t.useState)({hubspot:!1,supabase:!1,airtable:!1}),[Lt,Ft]=(0,t.useState)([]),[Gt,zt]=(0,t.useState)([]),[Ht,Bt]=(0,t.useState)(null),[Vt,$t]=(0,t.useState)([]),[Ut,Wt]=(0,t.useState)(!1),[qt,Kt]=(0,t.useState)(null),[Yt,Jt]=(0,t.useState)([]),[Xt,Qt]=(0,t.useState)(!1),[Zt,eo]=(0,t.useState)({}),[to,oo]=(0,t.useState)([]);(0,t.useEffect)((()=>{console.log("contactCompanies state changed:",to)}),[to]);const[no,ro]=(0,t.useState)(!1),[io,ao]=(0,t.useState)(null),[so,lo]=(0,t.useState)(!1),[co,uo]=(0,t.useState)(!1),[po,ho]=(0,t.useState)(null),[fo,go]=(0,t.useState)(""),mo=async()=>{try{if(console.log("Loading contact companies for contact ID:",r,"Type:",typeof r),!r)return console.warn("Cannot load companies: Missing contact ID"),oo([]),void uo(!0);const{data:e,error:t}=await D.supabase.from("contact_companies").select("\n          contact_companies_id,\n          company_id,\n          relationship,\n          is_primary,\n          companies:company_id(\n            company_id,\n            name,\n            website,\n            category,\n            description,\n            linkedin\n          )\n        ").eq("contact_id",r);if(t)return void console.error("Supabase error when loading companies:",t);if(console.log("Contact companies data from Supabase:",e),e&&e.length>0){const t=e.map((e=>{var t,o,n,r,i;return{contact_companies_id:e.contact_companies_id,company_id:e.company_id,relationship:e.relationship,is_primary:e.is_primary,name:(null===(t=e.companies)||void 0===t?void 0:t.name)||"Unknown Company",website:(null===(o=e.companies)||void 0===o?void 0:o.website)||"",category:(null===(n=e.companies)||void 0===n?void 0:n.category)||"Inbox",description:(null===(r=e.companies)||void 0===r?void 0:r.description)||"",linkedin:(null===(i=e.companies)||void 0===i?void 0:i.linkedin)||"",tags:[]}}));console.log("Formatted companies:",t),oo(t),uo(!0),d((e=>({...e,companies:t}))),Dt((e=>({...e,companies:t}))),setTimeout((()=>xo()),100)}else console.log("No companies found for this contact"),oo([]),uo(!0),d((e=>({...e,companies:[]}))),Dt((e=>({...e,companies:[]})))}catch(e){console.error("Error in loadContactCompanies:",e)}},yo=async(e,t,o)=>{try{if(console.log(`Handling change for ${t}:`,{contactCompaniesId:e,value:o}),oo((n=>n.map((n=>n.contact_companies_id===e?{...n,[t]:o}:n)))),["relationship","is_primary"].includes(t)){console.log(`Updating ${t} in contact_companies table to:`,o);const{data:n,error:r}=await D.supabase.from("contact_companies").update({[t]:o}).eq("contact_companies_id",e).select();if(r)throw console.error("Error updating contact_companies:",r),r;console.log("Update successful:",n)}else{const n=to.find((t=>t.contact_companies_id===e));if(!n||!n.company_id)throw new Error("Company ID not found");console.log(`Updating ${t} in companies table for company_id:`,n.company_id);const{data:r,error:i}=await D.supabase.from("companies").update({[t]:o,last_modified_at:new Date,last_modified_by:"User"}).eq("company_id",n.company_id).select();if(i)throw console.error("Error updating companies:",i),i;console.log("Update successful:",r)}nt.Ay.success(`Company ${t} updated successfully`)}catch(n){console.error(`Error updating company ${t}:`,n),nt.Ay.error(`Failed to update company ${t}`),mo()}},vo=async()=>{if(po)try{if(!to.find((e=>e.contact_companies_id===po)))return;await yo(po,"name",fo),ho(null),go("")}catch(e){console.error("Error saving company name:",e),nt.Ay.error("Failed to save company name")}},bo=(e,t)=>{"Enter"===e.key?(e.preventDefault(),vo()):"Escape"===e.key&&(e.preventDefault(),ho(null),go(""))},xo=async()=>{try{if(!to||0===to.length)return void console.warn("No companies available when trying to load company tags");const e=[...to];await Promise.all(e.map((async(t,o)=>{if(t.company_id){const n=await on(t.company_id);e[o].tags=n}}))),to&&to.length>0?oo(e):console.warn("Companies were cleared during tag loading - not updating tags")}catch(e){console.error("Error loading company tags:",e)}},wo=e=>{ao(e),lo(!0)},[Co,_o]=(0,t.useState)((()=>sessionStorage.getItem(`enrichment_section_${r}`)||"basics")),[So,Eo]=(0,t.useState)(!1);(0,t.useEffect)((()=>{Co&&sessionStorage.setItem(`enrichment_section_${r}`,Co)}),[Co,r]);const[ko,jo]=(0,t.useState)(!1),[Ao,Ro]=(0,t.useState)(null),[Oo,To]=(0,t.useState)({chatCount:0,contactChatsCount:0,interactionsCount:0,emailsCount:0,emailParticipantsCount:0,emailThreadsCount:0,tagsCount:0,citiesCount:0,companiesCount:0,notesCount:0,attachmentsCount:0,contactEmailsCount:0,contactMobilesCount:0,dealsCount:0,meetingsCount:0,investmentsCount:0,kitCount:0,lastInteraction:null}),[Do,Po]=(0,t.useState)({deleteChat:!0,deleteContactChats:!0,deleteInteractions:!0,deleteEmails:!0,deleteEmailParticipants:!0,deleteEmailThreads:!0,deleteTags:!0,deleteCities:!0,deleteCompanies:!0,deleteNotes:!0,deleteAttachments:!0,deleteContactEmails:!0,deleteContactMobiles:!0,deleteDeals:!0,deleteMeetings:!0,deleteInvestments:!0,deleteKit:!0,addToSpam:!0,addMobileToSpam:!0}),[No,Io]=(0,t.useState)(!1),Mo=(0,t.useCallback)((async()=>{try{if(V(!0),console.log("Loading introductions for contact ID:",r),!r)return console.warn("Cannot load introductions: Missing contact ID"),z([]),void V(!1);const{data:e,error:t}=await D.supabase.from("introductions").select("*").contains("contact_ids",[r]).order("introduction_date",{ascending:!1});if(t)return console.error("Error loading introductions:",t),nt.Ay.error("Failed to load introductions"),void V(!1);const o=await Promise.all((e||[]).map((async e=>{const t=e.contact_ids||[];if(!t||0===t.length)return{intro_id:e.introduction_id,contacts_introduced:[],contact_details:[],contact_names:"No contacts specified",intro_date:e.introduction_date,introduction_rationale:e.category,introduction_note:e.text,created_by:e.created_by,created_at:e.created_at};const{data:o,error:n}=await D.supabase.from("contacts").select("contact_id, first_name, last_name").in("contact_id",t);if(n)return console.error("Error fetching contacts for introduction:",n),{intro_id:e.introduction_id,contacts_introduced:e.contact_ids,contact_details:[],contact_names:"Error loading contacts",intro_date:e.introduction_date,introduction_rationale:e.category,introduction_note:e.text,created_by:e.created_by,created_at:e.created_at};const r=o&&o.length>0?o.map((e=>`${e.first_name} ${e.last_name}`.trim())).join(" and "):"Unknown contacts";return{intro_id:e.introduction_id,contacts_introduced:e.contact_ids,contact_details:o||[],contact_names:r,intro_date:e.introduction_date,introduction_rationale:e.category,introduction_note:e.text,created_by:e.created_by,created_at:e.created_at}})));console.log("Fetched and enhanced introductions:",o),z(o||[])}catch(e){console.error("Error in loadContactIntroductions:",e),nt.Ay.error("Error loading introductions")}finally{V(!1)}}),[r,D.supabase]),Go=(0,t.useCallback)((async e=>{if(e&&0!==e.length)try{const{data:t,error:o}=await D.supabase.from("deal_tags").select("\n          entry_id,\n          deal_id,\n          tag_id,\n          tags:tag_id (\n            tag_id,\n            name\n          )\n        ").in("deal_id",e);if(o)return void console.error("Error loading deal tags:",o);const n={};t.forEach((e=>{n[e.deal_id]||(n[e.deal_id]=[]),e.tags&&n[e.deal_id].push({entry_id:e.entry_id,tag_id:e.tag_id,name:e.tags.name,color:"#00ffff"})})),M(n),console.log("Loaded deal tags:",n)}catch(at){console.error("Error in loadDealTags:",at)}}),[D.supabase]),zo=(0,t.useCallback)((async e=>{if(e&&0!==e.length)try{const t={};for(const o of e){const{count:e,error:n}=await D.supabase.from("deal_attachments").select("*",{count:"exact",head:!0}).eq("deal_id",o);n?(console.error(`Error counting attachments for deal ${o}:`,n),t[o]=0):t[o]=e||0}F(t),console.log("Loaded deal attachment counts:",t)}catch(at){console.error("Error in loadDealAttachments:",at)}}),[D.supabase]),Ho=(0,t.useCallback)((async()=>{try{if(S(!0),console.log("Loading deals for contact ID:",r),!r)return console.warn("Cannot load deals: Missing contact ID"),C([]),void S(!1);const{data:e,error:t}=await D.supabase.from("deals_contacts").select("\n          deals_contacts_id,\n          relationship,\n          deals:deal_id (\n            deal_id,\n            opportunity,\n            stage,\n            category,\n            source_category,\n            description,\n            total_investment,\n            created_at,\n            last_modified_at\n          )\n        ").eq("contact_id",r);if(t)return console.error("Error loading deals:",t),nt.Ay.error("Failed to load deals"),void S(!1);console.log("Fetched deal relationships:",e);const o=e.map((e=>({deals_contacts_id:e.deals_contacts_id,relationship:e.relationship||"Not set",...e.deals})));if(console.log("Formatted deals:",o),C(o),o.length>0){const e=o.map((e=>e.deal_id));Go(e),zo(e)}}catch(e){console.error("Error in loadContactDeals:",e),nt.Ay.error("Error loading deals")}finally{S(!1)}}),[r,C,S,D.supabase,Go,zo]),Bo=((0,t.useCallback)((async e=>{try{if(!e)return Ho();S(!0),console.log(`Searching for deals with query: "${e}"`);const{data:t,error:o}=await D.supabase.from("deals").select("*").limit(200);if(o)throw o;if(!t||0===t.length)return console.log("No deals found in database"),(0,nt.Ay)("No deals found in the database"),C([]),void S(!1);console.log(`Found ${t.length} total deals in database`);const n=e.toLowerCase().split(" "),i=t.filter((e=>{const t=(e.opportunity||"").toLowerCase(),o=(e.description||"").toLowerCase();return n.some((e=>t.includes(e)||o.includes(e)))}));if(console.log(`Found ${i.length} deals matching search terms: "${n.join(", ")}"`),0===i.length)return(0,nt.Ay)("No deals found matching your search"),C([]),void S(!1);const a=i.map((e=>e.deal_id));console.log("Matching deal IDs:",a);const{data:s,error:l}=await D.supabase.from("deals_contacts").select("\n          deals_contacts_id,\n          relationship,\n          deals:deal_id (*)\n        ").eq("contact_id",r).in("deal_id",a);if(l)throw console.error("Error getting contact deals:",l),l;let c;console.log("Contact deals found:",s),c=s&&0!==s.length?s.map((e=>({deals_contacts_id:e.deals_contacts_id,relationship:e.relationship||"Not set",...e.deals}))):i.map((e=>({deal_id:e.deal_id,opportunity:e.opportunity,stage:e.stage,category:e.category,source_category:e.source_category,description:e.description,total_investment:e.total_investment,created_at:e.created_at,last_modified_at:e.last_modified_at}))),console.log("Formatted deals to display:",c),C(c),0===c.length?(0,nt.Ay)(`No deals found matching "${e}"`):nt.Ay.success(`Found ${c.length} matching deals`)}catch(t){console.error("Error searching deals:",t),nt.Ay.error("Error searching deals")}finally{S(!1)}}),[r,Ho,C,S,D.supabase,nt.Ay]),(0,t.useCallback)((async function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";try{if(0===ie.length){console.log("Loading all deals...");const{data:t,error:o}=await D.supabase.from("deals").select("\n            deal_id,\n            opportunity,\n            stage,\n            total_investment,\n            category,\n            description,\n            created_at,\n            last_modified_at\n          ").order("last_modified_at",{ascending:!1}).limit(100);if(o)return void console.error("Error loading deals:",o);if(t&&t.length>0){if(ae(t),!e)return void re(t);const o=t.filter((t=>t.opportunity.toLowerCase().includes(e.toLowerCase())));return void re(o)}return console.log("No deals found"),void re([])}if(e){const t=ie.filter((t=>t.opportunity.toLowerCase().includes(e.toLowerCase())));re(t)}else re(ie)}catch(at){console.error("Error in searchDealSuggestions:",at),re([])}}),[D.supabase,ie]));let Vo;const $o=(0,t.useCallback)((async e=>{try{if(console.log("Processing deal with data:",e),S(!0),!e||!e.name)return console.error("Missing required deal data:",e),nt.Ay.error("Deal name is required"),void S(!1);let t;if(ce&&ce.deal_id){if(console.log("Using existing deal with ID:",ce.deal_id),t=ce.deal_id,e.name!==ce.opportunity||e.stage!==ce.stage||e.value!==ce.total_investment||e.category!==ce.category||e.source!==ce.source_category||e.description!==ce.description){console.log("Updating existing deal with new data"),console.log("Deal data received for update:",{name:e.name,stage:e.stage,value:e.value,category:e.category,source:e.source,description:e.description});let o=e.category||"Inbox";["Inbox","Startup","Fund","Real Estate","Private Debt","Private Equity","Other"].includes(o)||(console.warn(`Category "${o}" is not valid, defaulting to "Inbox"`),o="Inbox");let n=e.stage||"Lead";["Lead","Evaluating","Closing","Invested","Monitoring","Passed"].includes(n)||(console.warn(`Stage "${n}" is not valid, defaulting to "Lead"`),n="Lead");let r=e.source||"Not Set";["Not Set","Cold Contacting","Introduction"].includes(r)||(console.warn(`Source "${r}" is not valid, defaulting to "Not Set"`),r="Not Set");const i={opportunity:e.name,stage:n,total_investment:e.value,category:o,source_category:r,description:e.description||"",last_modified_at:(new Date).toISOString(),last_modified_by:"User"};console.log("Deal data to update after validation:",i);const{error:a}=await D.supabase.from("deals").update(i).eq("deal_id",t);if(a)throw console.error("Error updating deal:",a),a;console.log("Deal updated successfully")}}else{console.log("Creating new deal in database..."),console.log("Deal data received from form:",{name:e.name,stage:e.stage,value:e.value,category:e.category,source:e.source,description:e.description});let o=e.category||"Inbox";["Inbox","Startup","Fund","Real Estate","Private Debt","Private Equity","Other"].includes(o)||(console.warn(`Category "${o}" is not valid, defaulting to "Inbox"`),o="Inbox");let n=e.stage||"Lead";["Lead","Evaluating","Closing","Invested","Monitoring","Passed"].includes(n)||(console.warn(`Stage "${n}" is not valid, defaulting to "Lead"`),n="Lead");let r=e.source||"Not Set";["Not Set","Cold Contacting","Introduction"].includes(r)||(console.warn(`Source "${r}" is not valid, defaulting to "Not Set"`),r="Not Set");const i={opportunity:e.name,stage:n,total_investment:e.value,category:o,source_category:r,description:e.description||""};console.log("Deal data to insert after validation:",i);const{data:a,error:s}=await D.supabase.from("deals").insert([i]).select("deal_id").single();if(s)throw console.error("Error creating deal:",s),s;if(!a||!a.deal_id)throw console.error("No deal ID returned from insert operation:",a),new Error("Failed to create deal: No deal ID returned");console.log("New deal created with ID:",a.deal_id),t=a.deal_id}const{data:o,error:n}=await D.supabase.from("deals_contacts").select("deals_contacts_id").eq("deal_id",t).eq("contact_id",r);if(n)throw console.error("Error checking for existing association:",n),n;if(o&&0!==o.length)console.log("Deal association already exists, skipping creation"),nt.Ay.success("Deal updated successfully");else{console.log("Creating deal-contact association...");const o={deal_id:t,contact_id:r,relationship:be[e.relationship]||"introducer"};console.log("Association data:",o);const{data:n,error:i}=await D.supabase.from("deals_contacts").insert([o]).select("*");if(i)throw console.error("Error creating deal-contact association:",i),i;console.log("Deal-contact association created:",n),nt.Ay.success(ce?"Existing deal associated successfully":"New deal created successfully")}de(null),oe(""),k(!1),console.log("Reloading deals list..."),await Ho(),P("list"),k(!1),console.log("Deals list reloaded")}catch(t){console.error("Error processing deal:",t),nt.Ay.error("Failed to process deal: "+(t.message||"Unknown error"))}finally{S(!1)}}),[r,Ho,S,k,P,D.supabase,nt.Ay,ce,de,oe]),Uo=(0,t.useCallback)((async(e,t)=>{try{if(S(!0),console.log("Associating deal with the following data:",{dealId:e,contactId:r,relationship:t,dealIdType:typeof e,contactIdType:typeof r}),!e)return nt.Ay.error("Deal ID is missing"),void S(!1);if(!r)return nt.Ay.error("Contact ID is missing"),void S(!1);t||(console.warn("Relationship not specified, using default"),t="Primary Contact");const{data:o,error:n}=await D.supabase.from("deals_contacts").select("deals_contacts_id").eq("deal_id",e).eq("contact_id",r);if(n)throw console.error("Error checking existing association:",n),n;if(o&&o.length>0)return nt.Ay.error("This deal is already associated with this contact"),void S(!1);const i=["introducer","co-investor","advisor","other"].includes(t)?t:"introducer",a={deal_id:e,contact_id:r,relationship:i};console.log("Inserting deals_contacts record:",a);const{data:s,error:l}=await D.supabase.from("deals_contacts").insert([a]).select();if(l)throw console.error("Error inserting association:",l),l;console.log("Deal association successful:",s),nt.Ay.success("Deal associated successfully"),A(!1),Ho()}catch(o){console.error("Error associating deal:",o),nt.Ay.error("Failed to associate deal: "+(o.message||"Unknown error"))}finally{S(!1)}}),[r,Ho,S,A,D.supabase,nt.Ay]);Vo=(0,t.useCallback)((e=>{if(console.log("Deal suggestion selected:",e),oe(e.opportunity),de(e),le(!1),"list"===T){const t="introducer";console.log(`Associating deal ID ${e.deal_id} with relationship "${t}"`),Uo(e.deal_id,t),k(!1)}}),[T,Uo,k,oe,de,le]);(0,t.useCallback)((async(e,t)=>{try{S(!0);const{error:o}=await D.supabase.from("deals").update({opportunity:t.name,stage:t.stage,total_investment:t.value,category:t.category,source_category:t.source,description:t.description,last_modified_at:(new Date).toISOString(),last_modified_by:"User"}).eq("deal_id",e);if(o)throw o;if(t.deals_contacts_id&&t.relationship){const{error:e}=await D.supabase.from("deals_contacts").update({relationship:t.relationship}).eq("deals_contacts_id",t.deals_contacts_id);if(e)throw e}nt.Ay.success("Deal updated successfully"),O(!1),Q(null),Ho()}catch(o){console.error("Error updating deal:",o),nt.Ay.error("Failed to update deal")}finally{S(!1)}}),[Ho,S,Q,O,D.supabase,nt.Ay]),(0,t.useCallback)((async e=>{try{if(!window.confirm("Are you sure you want to remove this deal association?"))return;S(!0);const{error:t}=await D.supabase.from("deals_contacts").delete().eq("deals_contacts_id",e);if(t)throw t;nt.Ay.success("Deal association removed"),Ho()}catch(t){console.error("Error removing deal association:",t),nt.Ay.error("Failed to remove deal association")}finally{S(!1)}}),[Ho,S,D.supabase,nt.Ay]);const Wo=(0,t.useCallback)((async()=>{if(c&&c.contact_id){x(!0),xt([]);try{console.log("Loading duplicates for contact ID:",c.contact_id),console.log("Loading non-false-positive duplicates for contact:",c.contact_id);const{data:e,error:t}=await D.supabase.from("contact_duplicates").select("duplicate_id, primary_contact_id, duplicate_contact_id, status, false_positive, mobile_number, email").or(`primary_contact_id.eq.${c.contact_id},duplicate_contact_id.eq.${c.contact_id}`),o=e?e.filter((e=>{const t=!0===e.false_positive;return t&&console.log("Filtering out false positive record:",e.duplicate_id),!t})):[];if(t)return console.error("Error loading duplicate records:",t),st("Failed to load duplicate contacts"),void x(!1);if(console.log(`Found ${(null===o||void 0===o?void 0:o.length)||0} potential duplicates`),!o||0===o.length)return void x(!1);const n=[];for(const r of o){const e=r.primary_contact_id===c.contact_id?r.duplicate_contact_id:r.primary_contact_id,{data:t,error:o}=await D.supabase.from("contacts").select("contact_id, first_name, last_name, email, mobile, linkedin, job_role, category").eq("contact_id",e).single();if(o)console.warn(`Error loading contact details for ID ${e}:`,o);else if(t){const e={...t,duplicate_id:r.duplicate_id,matched_on:r.email?"Email match":r.mobile_number?"Mobile match":"Name match"};if(!e.email&&r.email&&(e.email=r.email),!e.mobile&&r.mobile_number&&(e.mobile=r.mobile_number),!e.email){const{data:t}=await D.supabase.from("contact_emails").select("email").eq("contact_id",e.contact_id).eq("is_primary",!0).limit(1);t&&t.length>0&&(e.email=t[0].email)}if(!e.mobile){const{data:t}=await D.supabase.from("contact_mobiles").select("mobile").eq("contact_id",e.contact_id).eq("is_primary",!0).limit(1);t&&t.length>0&&(e.mobile=t[0].mobile)}n.push(e)}}xt(n),console.log("Successfully loaded and formatted duplicates:",n)}catch(e){console.error("Error in loadSupabaseDuplicates:",e),st("Failed to load duplicate contacts")}finally{x(!1)}}}),[c,st,x,xt,D.supabase]);(0,t.useEffect)((()=>{if(r){console.log("Loading data for contact ID:",r);const e=async()=>{try{console.log("Loading contact companies first to prevent race conditions"),await mo(),qo(),(async e=>{try{console.log("Loading WhatsApp chats for contact ID:",e);const{data:t,error:o}=await D.supabase.from("interactions").select("\n          interaction_id,\n          chat_id,\n          interaction_date\n        ").eq("contact_id",e).eq("interaction_type","whatsapp").order("interaction_date",{ascending:!1});if(o)return void console.error("Error loading WhatsApp interactions:",o);if(console.log("Found WhatsApp interactions:",t),!t||0===t.length)return;const n=[...new Set(t.map((e=>e.chat_id)))].filter(Boolean);if(0===n.length)return;const{data:r,error:i}=await D.supabase.from("chats").select("\n          id,\n          chat_name,\n          is_group_chat,\n          external_chat_id\n        ").in("id",n);if(i)return void console.error("Error loading chats:",i);if(console.log("Found chats:",r),r&&r.length>0){const e=r.map((e=>({chat_id:e.id,chat_name:e.chat_name||"Unnamed Chat",is_group_chat:e.is_group_chat||!1,external_chat_id:e.external_chat_id,unread_count:0})));console.log("Setting WhatsApp chats:",e),Ft(e)}}catch(t){console.error("Error loading WhatsApp chats:",t)}})(r),(async e=>{try{console.log("Loading email threads from contact_email_threads for contact ID:",e);const{data:t,error:o}=await D.supabase.from("contact_email_threads").select("\n          email_thread_id,\n          email_threads:email_thread_id (\n            email_thread_id, \n            subject,\n            thread_id,\n            last_message_timestamp,\n            updated_at\n          )\n        ").eq("contact_id",e).order("created_at",{ascending:!1});if(o)return void console.error("Error loading email threads from contact_email_threads:",o);if(!t||0===t.length)return console.log("No email threads found for contact ID:",e),void zt([]);console.log("Found email threads:",t);const n=t.filter((e=>e.email_threads)).map((e=>({thread_id:e.email_thread_id,title:e.email_threads.subject||"No Subject",date:e.email_threads.last_message_timestamp,updated_at:e.email_threads.updated_at,gmail_thread_id:e.email_threads.thread_id}))).sort(((e,t)=>new Date(t.date||t.updated_at)-new Date(e.date||e.updated_at)));if(console.log("Setting email threads:",n),zt(n),0===n.length){console.log("Trying alternate method to find email threads...");const{data:t,error:o}=await D.supabase.from("interactions").select("\n            interaction_id,\n            email_thread_id,\n            summary\n          ").eq("contact_id",e).eq("interaction_type","email").order("interaction_date",{ascending:!1});if(o)return void console.error("Error loading email interactions:",o);if(t&&t.length>0){console.log("Found email interactions:",t);const e=[...new Set(t.map((e=>e.email_thread_id)))].filter(Boolean);if(e.length>0){const{data:t,error:o}=await D.supabase.from("email_threads").select("*").in("email_thread_id",e);if(o)return void console.error("Error loading email threads details:",o);if(t&&t.length>0){const e=t.map((e=>({thread_id:e.email_thread_id,title:e.subject||"No Subject",date:e.last_message_timestamp,updated_at:e.updated_at,gmail_thread_id:e.thread_id})));console.log("Setting alternate email threads:",e),zt(e)}}}}}catch(t){console.error("Error loading email threads:",t)}})(r),Ho(),2===y&&Wo(),Mt({hubspot:!0,supabase:!0,airtable:!0})}catch(e){console.error("Error in initial data loading:",e)}};e()}}),[r,y]),(0,t.useEffect)((()=>{r&&"supabase_duplicates"===Co&&Wo(),r&&"deals"===Co&&Ho(),r&&"introductions"===Co&&Mo()}),[r,Co,Wo,Ho,Mo]);(0,t.useEffect)((()=>{const e=new URLSearchParams(s.search);e.set("step",y),a(`/contacts/workflow/${r}?${e.toString()}`,{replace:!0}),window.scrollTo(0,0)}),[y,r,a,s.search]);const qo=async()=>{console.log("Loading contact data, preserving existing company data if available",to.length>0?`(${to.length} companies)`:""),x(!0),st(null);try{const{data:e,error:t}=await D.supabase.from("contacts").select("\n          contact_id,\n          first_name,\n          last_name,\n          category,\n          score,\n          description,\n          birthday,\n          last_interaction_at,\n          linkedin,\n          job_role,\n          keep_in_touch_frequency,\n          airtable_id\n        ").eq("contact_id",r).single();if(t)throw t;if(!e)throw new Error("Contact not found");if(d(e),e.airtable_id&&Xo(e.airtable_id),Dt({firstName:e.first_name,lastName:e.last_name,keepInTouch:e.keep_in_touch_frequency,category:e.category,score:e.score,description:e.description||"",editingDescription:!1,birthday:e.birthday||"",notes:"",city:null,tags:[],mobiles:[],emails:[],linkedIn:e.linkedin||"",jobRole:e.job_role||"",company:null,dealInfo:"",newEmail:"",newEmailType:"personal",newMobile:"",newMobileType:"personal",newCustomTag:""}),await Promise.all([Ko(e.contact_id),Qo(e.contact_id),Yo(e.contact_id),Zo(e)]),await nn(),2===y||!y){console.log("Automatically searching for duplicates");const e=await an(),t=c&&c.email?await sn():[],o=c&&c.mobile?await ln():[],n=[...e,...t,...o].filter(((e,t,o)=>t===o.findIndex((t=>t.contact_id===e.contact_id))));ut(n)}x(!1)}catch(e){console.error("Error loading contact data:",e),st(`Failed to load contact data: ${e.message}`),x(!1)}},Ko=async e=>{try{const{data:t,error:o}=await D.supabase.from("contact_email_threads").select("\n          email_thread_id,\n          email_threads!inner (\n            email_thread_id,\n            thread_id,\n            subject,\n            last_message_timestamp\n          )\n        ").eq("contact_id",e);if(o)throw o;const n=[];for(const e of t||[]){const{data:t,error:o}=await D.supabase.from("emails").select("\n            email_id,\n            subject,\n            body_plain,\n            body_html,\n            message_timestamp,\n            direction,\n            sender_contact_id,\n            email_participants!inner (\n              participant_id,\n              contact_id,\n              participant_type,\n              contacts!inner (\n                first_name,\n                last_name,\n                contact_emails!inner (\n                  email\n                )\n              )\n            )\n          ").eq("email_thread_id",e.email_thread_id).order("message_timestamp",{ascending:!1});if(o)throw o;if(t&&t.length>0){const o=t.map((e=>{var t;const o=e.email_participants.find((e=>"sender"===e.participant_type)),n=e.email_participants.filter((e=>"to"===e.participant_type)).map((e=>{var t;return`${e.contacts.first_name} ${e.contacts.last_name} <${null===(t=e.contacts.contact_emails[0])||void 0===t?void 0:t.email}>`})),r=e.email_participants.filter((e=>"cc"===e.participant_type)).map((e=>{var t;return`${e.contacts.first_name} ${e.contacts.last_name} <${null===(t=e.contacts.contact_emails[0])||void 0===t?void 0:t.email}>`}));return{email_id:e.email_id,subject:e.subject,content:e.body_html||e.body_plain,interaction_date:e.message_timestamp,direction:e.direction,sender_name:o?`${o.contacts.first_name} ${o.contacts.last_name}`:"Unknown",sender_email:(null===o||void 0===o||null===(t=o.contacts.contact_emails[0])||void 0===t?void 0:t.email)||"",to_participants:n,cc_participants:r}}));n.push({thread_id:e.email_threads.thread_id,subject:e.email_threads.subject||"No Subject",last_message_timestamp:e.email_threads.last_message_timestamp,emails:o})}}ct({whatsapp:[],email:n,other:[]})}catch(t){console.error("Error loading interactions:",t),st("Failed to load interactions")}},Yo=async e=>{try{const{data:t,error:o}=await D.supabase.from("contact_emails").select("email_id, email, type, is_primary").eq("contact_id",e).order("is_primary",{ascending:!1});if(!o&&t){Dt((e=>({...e,emails:t.map((e=>({email_id:e.email_id,email:e.email,type:e.type||"personal",is_primary:e.is_primary}))),email:t.length>0?t[0].email:""})));const e=t.find((e=>e.is_primary))||t[0];e&&d((t=>({...t,email:e.email})))}else o&&console.error("Error loading emails:",o);const{data:n,error:r}=await D.supabase.from("contact_mobiles").select("mobile_id, mobile, type, is_primary").eq("contact_id",e).order("is_primary",{ascending:!1});if(!r&&n){Dt((e=>({...e,mobiles:n.map((e=>({mobile_id:e.mobile_id,mobile:e.mobile,type:e.type||"personal",is_primary:e.is_primary}))),mobile:n.length>0?n[0].mobile:""})));const e=n.find((e=>e.is_primary))||n[0];e&&d((t=>({...t,mobile:e.mobile})))}else r&&console.error("Error loading mobiles:",r)}catch(t){console.error("Error loading email and mobile data:",t)}},Jo=async e=>{if(!e||e.trim().length<2)m([]);else try{const{data:t,error:o}=await D.supabase.from("airtable_contacts").select("*").or(`full_name.ilike.%${e}%,primary_email.ilike.%${e}%,phone_number_1.ilike.%${e}%`).limit(10);if(o)return void console.error("Error searching Airtable contacts:",o);const n=t.filter((e=>e.airtable_id!==(null===c||void 0===c?void 0:c.airtable_id)));m(n)}catch(t){console.error("Error in searchAirtableContacts:",t)}},Xo=async e=>{if(e)try{const{data:t,error:o}=await D.supabase.from("airtable_contacts").select("*").eq("airtable_id",e).single();if(o)return void console.error("Error loading Airtable contact:",o);t&&p(t)}catch(t){console.error("Error in loadAirtableContact:",t)}},Qo=async e=>{try{const{data:t,error:o}=await D.supabase.from("contact_tags").select("\n          entry_id,\n          tag_id,\n          tags:tag_id(tag_id, name)\n        ").eq("contact_id",e);if(!o&&t){const e=t.map((e=>({tag_id:e.tags.tag_id,name:e.tags.name,entry_id:e.entry_id}))).filter((e=>e.tag_id&&e.name));Dt((t=>({...t,tags:e})))}const{data:n,error:r}=await D.supabase.from("contact_cities").select("\n          entry_id,\n          city_id,\n          cities:city_id(city_id, name, country)\n        ").eq("contact_id",e);if(!r&&n&&n.length>0){const e=n.map((e=>({city_id:e.cities.city_id,name:e.cities.name,country:e.cities.country,entry_id:e.entry_id}))).filter((e=>e.city_id&&e.name)),t={id:n[0].cities.city_id,name:n[0].cities.name,country:n[0].cities.country};Dt((o=>({...o,city:t,cities:e})))}const{data:i,error:a}=await D.supabase.from("contact_companies").select("\n          contact_companies_id,\n          company_id,\n          relationship,\n          is_primary,\n          companies:company_id(\n            company_id,\n            name,\n            website,\n            category,\n            description,\n            linkedin\n          )\n        ").eq("contact_id",e);if(!a&&i&&i.length>0){const e=i.map((e=>({contact_companies_id:e.contact_companies_id,company_id:e.company_id,relationship:e.relationship,is_primary:e.is_primary,name:e.companies.name,website:e.companies.website,category:e.companies.category,description:e.companies.description,linkedin:e.companies.linkedin,tags:[],newTag:"",tagSuggestions:[]}))).filter((e=>e.company_id)),t={id:i[0].companies.company_id,name:i[0].companies.name,website:i[0].companies.website};Dt((o=>({...o,company:t,associatedCompanies:e})));const o=async()=>{try{const t=[...e],o=t.map((async(e,t)=>{if(e.company_id){return{index:t,tags:await on(e.company_id)}}return{index:t,tags:[]}}));(await Promise.all(o)).forEach((e=>{t[e.index].tags=e.tags})),Dt((e=>({...e,associatedCompanies:t})))}catch(t){console.error("Error fetching company tags:",t)}};o()}else Dt((e=>({...e,associatedCompanies:[]})))}catch(t){console.error("Error loading contact details:",t)}},Zo=async e=>{try{if(!e)return void console.error("fetchExternalData called with null contactData");console.log("Contact data in fetchExternalData:",e);const t={hubspot:{email:"",mobile:"",company:null,tags:[],notes:"",keepInTouch:null,category:null},supabase:{email:e&&e.email||"",mobile:e&&e.mobile||"",company:null,tags:[],notes:"",keepInTouch:e&&e.keep_in_touch_frequency||null,category:e&&e.category||null},airtable:{email:"",mobile:"",company:null,tags:[],notes:"",keepInTouch:null,category:null,firstName:"",lastName:""}};t.airtable={email:"test@airtable.com",mobile:"+1234567890",company:{id:"at1",name:"Test Airtable Company"},tags:["Tag1","Tag2"],notes:"Test notes from Airtable",keepInTouch:"weekly",category:"VIP",firstName:"Test",lastName:"User"},Nt(t),Mt((e=>({...e,airtable:!0}))),console.log("Updated externalSources with:",t)}catch(at){console.error("Error in fetchExternalData:",at)}},en=e=>{3===y&&3!==e&&(sessionStorage.removeItem(`enrichment_section_${r}`),_o("basics")),e<y||e===y?v(e):2===e&&1===y?(v(2),cn()):e<=y+1&&v(e)},tn=(e,t)=>{Dt((o=>({...o,[e]:t})))},on=async e=>{if(!e)return[];try{const{data:t,error:o}=await D.supabase.from("company_tags").select("\n          entry_id,\n          tag_id,\n          tags (\n            tag_id,\n            name\n          )\n        ").eq("company_id",e);return o?(console.error("Error fetching company tags:",o),[]):(t||[]).map((e=>{var t;return{entry_id:e.entry_id,tag_id:e.tag_id,name:(null===(t=e.tags)||void 0===t?void 0:t.name)||"Unknown"}}))}catch(t){return console.error("Error in fetchCompanyTags:",t),[]}},nn=async()=>{try{if(!Tt||!Tt.emails||0===Tt.emails.length)return void console.log("No email data available for domain matching");const e=Tt.emails.map((e=>{const t=(e.email||"").match(/@([^@]+)$/);return t?t[1]:null})).filter((e=>e)).filter(((e,t,o)=>o.indexOf(e)===t));if(0===e.length)return;const{data:t,error:o}=await D.supabase.from("companies").select("company_id, name, website, category").order("name");if(o)return void console.error("Error searching for companies by domain:",o);const n=t.filter((t=>{var o;if(!t.website)return!1;let n=t.website;return n=n.replace(/^https?:\/\//,""),n=n.replace(/^www\./,""),n=n.split("/")[0],e.some((e=>n.includes(e)||e.includes(n)))&&!(null!==(o=Tt.associatedCompanies)&&void 0!==o&&o.some((e=>e.company_id===t.company_id)))})),r=e.filter((e=>!t.some((t=>{if(!t.website)return!1;let o=t.website;return o=o.replace(/^https?:\/\//,""),o=o.replace(/^www\./,""),o=o.split("/")[0],o.includes(e)||e.includes(o)})))),i=["gmail.com","yahoo.com","hotmail.com","outlook.com","icloud.com","aol.com","protonmail.com","mail.com","zoho.com","yandex.com","gmx.com","live.com","me.com","inbox.com","fastmail.com"],a=r.filter((e=>!i.includes(e))).map((e=>({domain:e,suggestedName:e.split(".")[0].charAt(0).toUpperCase()+e.split(".")[0].slice(1),suggestedWebsite:`https://www.${e}`})));tn("domainMatchedCompanies",n),tn("newCompanySuggestions",a)}catch(e){console.error("Error finding companies by email domains:",e)}},rn=(e,t)=>{if(e===t)return 1;if(!e||!t)return 0;const o=e.toLowerCase(),n=t.toLowerCase();return o===n?1:o.length<3||n.length<3?o.includes(n)||n.includes(o)?.9:0:((e,t)=>{if(e===t)return 1;if(!e||!t)return 0;const o=e.length,n=t.length;if(0===o||0===n)return 0;if(o<3||n<3)return e.includes(t)||t.includes(e)?.9:0;let r=Math.max(o,n),i=0;for(let a=0;a<Math.min(o,n);a++)e[a]!==t[a]&&i++;return i+=Math.abs(o-n),1-i/r})(o,n)},an=async()=>{if(!c||!c.first_name&&!c.last_name)return[];try{let e=[],t=D.supabase.from("contacts").select("*");c.first_name&&c.last_name?t=t.or(`first_name.ilike.%${c.first_name}%,last_name.ilike.%${c.last_name}%`):c.first_name?t=t.ilike("first_name",`%${c.first_name}%`):c.last_name&&(t=t.ilike("last_name",`%${c.last_name}%`)),t=t.neq("contact_id",c.contact_id);const{data:o,error:n}=await t;if(n)throw n;e=o||[];let r=e.filter((e=>{const t=rn(c.first_name||"",e.first_name||""),o=rn(c.last_name||"",e.last_name||""),n=.8;return c.first_name&&c.last_name&&e.first_name&&e.last_name?t>=n&&o>=n:(c.first_name&&e.first_name&&!c.last_name||!c.first_name&&c.last_name&&e.last_name,t>=n||o>=n)})).map((e=>({...e,matched_on:"Name similarity"})));for(const i of r){if(!i.email){const{data:e}=await D.supabase.from("contact_emails").select("email").eq("contact_id",i.contact_id).eq("is_primary",!0).limit(1);e&&e.length>0&&(i.email=e[0].email)}if(!i.mobile){const{data:e}=await D.supabase.from("contact_mobiles").select("mobile").eq("contact_id",i.contact_id).eq("is_primary",!0).limit(1);e&&e.length>0&&(i.mobile=e[0].mobile)}}return r}catch(e){return console.error("Error searching by name:",e),[]}},sn=async()=>{if(!c||null===c||!c.email||"string"!==typeof c.email)return console.log("No valid email found for duplicate search"),[];try{const{data:e,error:t}=await D.supabase.from("contact_emails").select("\n          email,\n          contact_id,\n          contacts (*)\n        ").eq("email",c.email).neq("contact_id",c.contact_id);if(t)throw t;const o=[],n=new Set;e&&e.forEach((e=>{e.contacts&&e.contact_id&&!n.has(e.contact_id)&&(n.add(e.contact_id),o.push({...e.contacts,matched_on:`Email: ${e.email}`}))}));for(const r of o)if(r.email||(r.email=c.email),!r.mobile){const{data:e}=await D.supabase.from("contact_mobiles").select("mobile").eq("contact_id",r.contact_id).eq("is_primary",!0).limit(1);e&&e.length>0&&(r.mobile=e[0].mobile)}return o}catch(e){return console.error("Error searching by email:",e),[]}},ln=async()=>{if(!c||null===c||!c.mobile||"string"!==typeof c.mobile)return console.log("No valid mobile found for duplicate search"),[];try{const{data:e,error:t}=await D.supabase.from("contact_mobiles").select("\n          mobile,\n          contact_id,\n          contacts (*)\n        ").eq("mobile",c.mobile).neq("contact_id",c.contact_id);if(t)throw t;const o=[],n=new Set;e&&e.forEach((e=>{e.contacts&&e.contact_id&&!n.has(e.contact_id)&&(n.add(e.contact_id),o.push({...e.contacts,matched_on:`Mobile: ${e.mobile}`}))}));for(const r of o)if(r.mobile||(r.mobile=c.mobile),!r.email){const{data:e}=await D.supabase.from("contact_emails").select("email").eq("contact_id",r.contact_id).eq("is_primary",!0).limit(1);e&&e.length>0&&(r.email=e[0].email)}return o}catch(e){return console.error("Error searching by mobile:",e),[]}},cn=async()=>{if(c){ut([]),ft(null),x(!0);try{let e=[];if(c.email){const{data:t,error:o}=await D.supabase.from("contact_emails").select("\n            email,\n            contact_id,\n            contacts (*)\n          ").eq("email",c.email).neq("contact_id",c.contact_id);if(!o&&t){const o=new Set;t.forEach((t=>{t.contacts&&t.contact_id&&!o.has(t.contact_id)&&(o.add(t.contact_id),e.push({...t.contacts,matched_on:`Email: ${t.email}`}))}))}}let t=[];if(c.mobile){const{data:e,error:o}=await D.supabase.from("contact_mobiles").select("\n            mobile,\n            contact_id,\n            contacts (*)\n          ").eq("mobile",c.mobile).neq("contact_id",c.contact_id);if(!o&&e){const o=new Set;e.forEach((e=>{e.contacts&&e.contact_id&&!o.has(e.contact_id)&&(o.add(e.contact_id),t.push({...e.contacts,matched_on:`Mobile: ${e.mobile}`}))}))}}let o=[];if(c.first_name||c.last_name){let e=D.supabase.from("contacts").select("*");c.first_name&&c.last_name?e=e.or(`first_name.ilike.%${c.first_name}%,last_name.ilike.%${c.last_name}%`):c.first_name?e=e.ilike("first_name",`%${c.first_name}%`):c.last_name&&(e=e.ilike("last_name",`%${c.last_name}%`)),e=e.neq("contact_id",c.contact_id);const{data:t,error:n}=await e;if(!n&&t){const e=.8;o=t.filter((t=>{const o=rn(c.first_name||"",t.first_name||""),n=rn(c.last_name||"",t.last_name||"");return c.first_name&&c.last_name&&t.first_name&&t.last_name?o>=e&&n>=e:o>=e||n>=e})).map((e=>({...e,matched_on:"Name similarity"})))}}const n=[...e,...t,...o],r=[],i=new Set;n.forEach((e=>{i.has(e.contact_id)||(i.add(e.contact_id),r.push(e))}));const{data:a}=await D.supabase.from("contact_duplicates").select("primary_contact_id, duplicate_contact_id").eq("false_positive",!0).or(`primary_contact_id.eq.${c.contact_id},duplicate_contact_id.eq.${c.contact_id}`),s=new Set;a&&a.length>0&&(console.log("Found false positive records:",a.length),a.forEach((e=>{const t=e.primary_contact_id===c.contact_id?e.duplicate_contact_id:e.primary_contact_id;s.add(t),console.log("Adding to false positive set:",t)})));const l=r.filter((e=>{const t=s.has(e.contact_id);return t&&console.log("Filtering out false positive contact:",e.contact_id,e.first_name,e.last_name),!t}));for(const c of l){if(!c.email){const{data:e}=await D.supabase.from("contact_emails").select("email").eq("contact_id",c.contact_id).eq("is_primary",!0).limit(1);e&&e.length>0&&(c.email=e[0].email)}if(!c.mobile){const{data:e}=await D.supabase.from("contact_mobiles").select("mobile").eq("contact_id",c.contact_id).eq("is_primary",!0).limit(1);e&&e.length>0&&(c.mobile=e[0].mobile)}}ut(l),xt(l)}catch(e){console.error("Error searching for duplicates:",e),st("Failed to search for duplicates. Please try again.")}finally{x(!1)}}},dn=async function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"name";if(console.log("Searching for contacts with query:",e,"type:",t),!e||e.length<2)return console.log("Search query too short, skipping search"),void kt([]);try{let o;x(!0),kt([]),"name"===t?(console.log("Searching by name for:",e),o=D.supabase.from("contacts").select("\n            contact_id,\n            first_name,\n            last_name,\n            description,\n            contact_emails(email_id, email, is_primary),\n            contact_mobiles(mobile_id, mobile, is_primary),\n            contact_companies(\n              contact_companies_id,\n              company_id,\n              relationship,\n              is_primary,\n              companies(company_id, name)\n            )\n          ").or(`first_name.ilike.%${e}%,last_name.ilike.%${e}%`).limit(50)):"email"===t?(console.log("Searching by email for:",e),o=D.supabase.from("contacts").select("\n            contact_id,\n            first_name,\n            last_name,\n            description,\n            contact_emails!inner(email_id, email, is_primary)\n          ").filter("contact_emails.email","ilike",`%${e}%`).limit(50)):"mobile"===t&&(console.log("Searching by mobile for:",e),o=D.supabase.from("contacts").select("\n            contact_id,\n            first_name,\n            last_name,\n            description,\n            contact_mobiles!inner(mobile_id, mobile, is_primary)\n          ").filter("contact_mobiles.mobile","ilike",`%${e}%`).limit(50));const{data:n,error:i}=await o;if(i)return console.error("Error searching contacts:",i),(0,nt.Ay)("Error searching for potential duplicates",{style:{background:"#222",color:"#ff4444",border:"1px solid #ff4444",fontWeight:"bold"},icon:"\u2717"}),void x(!1);if(console.log("Search returned data:",n),!n||0===n.length)return(0,nt.Ay)(`No potential duplicates found matching "${e}"`,{style:{background:"#222",color:"#00ff00",border:"1px solid #00ff00",fontWeight:"bold"}}),void x(!1);let a=n.filter((e=>null!=e&&e.contact_id!==r));if(console.log(`Found ${a.length} contacts matching ${t} query "${e}"`),0===a.length)return(0,nt.Ay)(`No potential duplicates found matching "${e}"`,{style:{background:"#222",color:"#00ff00",border:"1px solid #00ff00",fontWeight:"bold"}}),void x(!1);const s=a.map((o=>{let n="Manual search";if("name"===t)o.first_name&&o.first_name.toLowerCase().includes(e.toLowerCase())?n=`First name: ${o.first_name}`:o.last_name&&o.last_name.toLowerCase().includes(e.toLowerCase())&&(n=`Last name: ${o.last_name}`);else if("email"===t){const t=o.contact_emails.find((t=>t.email&&t.email.toLowerCase().includes(e.toLowerCase())));t&&(n=`Email: ${t.email}`)}else if("mobile"===t){const t=o.contact_mobiles.find((t=>t.mobile&&t.mobile.toLowerCase().includes(e.toLowerCase())));t&&(n=`Mobile: ${t.mobile}`)}if(o.contact_emails&&o.contact_emails.length>0){const e=o.contact_emails.find((e=>e.is_primary))||o.contact_emails[0];o.email=e.email}if(o.contact_mobiles&&o.contact_mobiles.length>0){const e=o.contact_mobiles.find((e=>e.is_primary))||o.contact_mobiles[0];o.mobile=e.mobile}let r="";if(o.contact_companies&&o.contact_companies.length>0){const e=o.contact_companies.find((e=>e.is_primary))||o.contact_companies[0];e&&e.companies&&(r=e.companies.name||"")}return{...o,company:r,matched_on:n}}));kt(s),(0,nt.Ay)(`Found ${s.length} potential duplicates matching "${e}"`,{style:{background:"#222",color:"#00ff00",border:"1px solid #00ff00",fontWeight:"bold"},icon:"\u2713"})}catch(o){console.error("Error in searchContacts:",o),(0,nt.Ay)("Error while searching for potential duplicates",{style:{background:"#222",color:"#ff4444",border:"1px solid #ff4444",fontWeight:"bold"},icon:"\u2717"})}finally{x(!1)}},un=(e,t)=>{vt((o=>({...o,[e]:t})))},pn=async()=>{if(c&&ht){x(!0);try{var e,t,o,n;const r={contact:ht,emails:[],mobiles:[],tags:[],cities:[],companies:[]};if(ht.email)r.emails=[{email:ht.email,is_primary:!0,type:"personal"}];else{const{data:e}=await D.supabase.from("contact_emails").select("email_id, email, is_primary, type").eq("contact_id",ht.contact_id);e&&e.length>0&&(r.emails=e)}if(ht.mobile)r.mobiles=[{mobile:ht.mobile,is_primary:!0,type:"personal"}];else{const{data:e}=await D.supabase.from("contact_mobiles").select("mobile_id, mobile, is_primary, type").eq("contact_id",ht.contact_id);e&&e.length>0&&(r.mobiles=e)}const[i,s,l]=await Promise.all([D.supabase.from("contact_tags").select("tags:tag_id(tag_id, name)").eq("contact_id",ht.contact_id),D.supabase.from("contact_cities").select("cities:city_id(city_id, name, country)").eq("contact_id",ht.contact_id),D.supabase.from("contact_companies").select("companies:company_id(company_id, name, website), relationship, is_primary").eq("contact_id",ht.contact_id)]);i.data&&(r.tags=i.data.map((e=>e.tags)).filter(Boolean)),s.data&&(r.cities=s.data.map((e=>e.cities)).filter(Boolean)),l.data&&(r.companies=l.data);const d=(e=>{if(!e)return;const t={first_name:"current",last_name:"current",category:"current",job_role:"current",linkedin:"current",description:"current",score:"current",keep_in_touch_frequency:"current",emails:"combine",mobiles:"combine",tags:"combine",cities:"combine",companies:"combine"};return!c.first_name&&e.first_name&&(t.first_name="duplicate"),!c.last_name&&e.last_name&&(t.last_name="duplicate"),"Inbox"===c.category&&"Inbox"!==e.category&&(t.category="duplicate"),!c.job_role&&e.job_role&&(t.job_role="duplicate"),!c.linkedin&&e.linkedin&&(t.linkedin="duplicate"),!c.description&&e.description&&(t.description="duplicate"),null!==c.score&&void 0!==c.score||null===e.score||(t.score="duplicate"),!c.keep_in_touch_frequency&&e.keep_in_touch_frequency&&(t.keep_in_touch_frequency="duplicate"),t})(ht),u=(null===(e=r.emails.find((e=>e.is_primary)))||void 0===e?void 0:e.email)||(null===(t=r.emails[0])||void 0===t?void 0:t.email)||ht.email||"",p=(null===(o=r.mobiles.find((e=>e.is_primary)))||void 0===o?void 0:o.mobile)||(null===(n=r.mobiles[0])||void 0===n?void 0:n.mobile)||ht.mobile||"",{data:h,error:f}=await D.supabase.from("contact_duplicates").insert({primary_contact_id:ht.contact_id,duplicate_contact_id:c.contact_id,mobile_number:p,email:u,detected_at:(new Date).toISOString(),status:"pending",notes:"Manually merged via Contact CRM workflow",merge_selections:d,duplicate_data:r,start_trigger:!0}).select().single();if(f)throw f;if(!h)throw new Error("Failed to create merge record");nt.Ay.success("Merge request submitted. The system will process it shortly.");const g=async e=>{await new Promise((e=>setTimeout(e,2e3)));const{data:t,error:o}=await D.supabase.from("contact_duplicates").select("status, error_message").eq("duplicate_id",e).single();o?console.error("Error checking merge status:",o):"completed"===t.status?nt.Ay.success("Contacts successfully merged!"):"failed"===t.status?nt.Ay.error(`Merge failed: ${t.error_message||"Unknown error"}`):["pending","processing"].includes(t.status)&&setTimeout((()=>g(e)),2e3)};await D.supabase.from("contacts").update({category:"Merged"}).eq("contact_id",c.contact_id),g(h.duplicate_id),a("/contacts/inbox")}catch(r){console.error("Error merging contacts:",r),st(`Failed to merge contacts: ${r.message||"Unknown error"}`),x(!1)}}},hn=e=>{const{name:t,checked:o}=e.target;Po((e=>({...e,[t]:o})))},fn=async e=>{if(c)if("Spam"===e){Ro(c);try{const[e,t,o,n,r,i,a,s,l,d,u,p,h,f,g,m,y,v]=await Promise.all([D.supabase.from("chat").select("id",{count:"exact",head:!0}).eq("contact_id",c.contact_id),D.supabase.from("contact_chats").select("id",{count:"exact",head:!0}).eq("contact_id",c.contact_id),D.supabase.from("interactions").select("interaction_id",{count:"exact",head:!0}).eq("contact_id",c.contact_id),D.supabase.from("emails").select("email_id",{count:"exact",head:!0}).eq("sender_contact_id",c.contact_id),D.supabase.from("email_participants").select("participant_id",{count:"exact",head:!0}).eq("contact_id",c.contact_id),D.supabase.from("contact_email_threads").select("email_thread_id",{count:"exact",head:!0}).eq("contact_id",c.contact_id),D.supabase.from("contact_tags").select("entry_id",{count:"exact",head:!0}).eq("contact_id",c.contact_id),D.supabase.from("contact_cities").select("entry_id",{count:"exact",head:!0}).eq("contact_id",c.contact_id),D.supabase.from("contact_companies").select("contact_companies_id",{count:"exact",head:!0}).eq("contact_id",c.contact_id),D.supabase.from("notes_contacts").select("note_contact_id",{count:"exact",head:!0}).eq("contact_id",c.contact_id),D.supabase.from("attachments").select("attachment_id",{count:"exact",head:!0}).eq("contact_id",c.contact_id),D.supabase.from("contact_emails").select("email_id",{count:"exact",head:!0}).eq("contact_id",c.contact_id),D.supabase.from("contact_mobiles").select("mobile_id",{count:"exact",head:!0}).eq("contact_id",c.contact_id),D.supabase.from("deals_contacts").select("deals_contacts_id",{count:"exact",head:!0}).eq("contact_id",c.contact_id),D.supabase.from("meeting_contacts").select("meeting_contact_id",{count:"exact",head:!0}).eq("contact_id",c.contact_id),D.supabase.from("investments_contacts").select("investments_contacts_id",{count:"exact",head:!0}).eq("contact_id",c.contact_id),D.supabase.from("keep_in_touch").select("id",{count:"exact",head:!0}).eq("contact_id",c.contact_id),D.supabase.from("interactions").select("interaction_id, interaction_type, direction, interaction_date, summary").eq("contact_id",c.contact_id).order("interaction_date",{ascending:!1}).limit(1)]);To({chatCount:e.count||0,contactChatsCount:t.count||0,interactionsCount:o.count||0,emailsCount:n.count||0,emailParticipantsCount:r.count||0,emailThreadsCount:i.count||0,tagsCount:a.count||0,citiesCount:s.count||0,companiesCount:l.count||0,notesCount:d.count||0,attachmentsCount:u.count||0,contactEmailsCount:p.count||0,contactMobilesCount:h.count||0,dealsCount:f.count||0,meetingsCount:g.count||0,investmentsCount:m.count||0,kitCount:y.count||0,lastInteraction:v.data&&v.data.length>0?v.data[0]:null}),jo(!0)}catch(t){console.error("Error fetching associated data counts:",t),st(`Failed to get related record counts: ${t.message||"Unknown error"}`)}}else if("Skip"===e){x(!0);try{const{error:t}=await D.supabase.from("contacts").update({category:e}).eq("contact_id",c.contact_id);if(t)throw t;nt.Ay.success(`Contact marked as ${e}`),a("/contacts/inbox")}catch(t){console.error(`Error marking contact as ${e}:`,t),st(`Failed to mark contact as ${e}: ${t.message||"Unknown error"}`),x(!1)}}},gn=async()=>{if(c){x(!0);try{const{error:e}=await D.supabase.from("contacts").update({category:Tt.category||null,linkedin:Tt.linkedIn||null,description:Tt.notes||null,keep_in_touch_frequency:Tt.keepInTouch||null}).eq("contact_id",c.contact_id);if(e)throw e;if(Tt.mobile&&Tt.mobile!==c.mobile){const{data:e}=await D.supabase.from("contact_mobiles").select("mobile_id").eq("contact_id",c.contact_id).eq("is_primary",!0);e&&e.length>0?await D.supabase.from("contact_mobiles").update({mobile:Tt.mobile}).eq("mobile_id",e[0].mobile_id):await D.supabase.from("contact_mobiles").insert([{contact_id:c.contact_id,mobile:Tt.mobile,is_primary:!0}])}if(Tt.email&&Tt.email!==c.email){const{data:e}=await D.supabase.from("contact_emails").select("email_id").eq("contact_id",c.contact_id).eq("is_primary",!0);e&&e.length>0?await D.supabase.from("contact_emails").update({email:Tt.email}).eq("email_id",e[0].email_id):await D.supabase.from("contact_emails").insert([{contact_id:c.contact_id,email:Tt.email,is_primary:!0}])}if(Tt.city&&Tt.city.id){const{data:e}=await D.supabase.from("contact_cities").select("entry_id").eq("contact_id",c.contact_id).eq("city_id",Tt.city.id);e&&0!==e.length||await D.supabase.from("contact_cities").insert([{contact_id:c.contact_id,city_id:Tt.city.id}])}if(Tt.tags&&Tt.tags.length>0){const{data:e}=await D.supabase.from("contact_tags").select("entry_id, tag_id").eq("contact_id",c.contact_id),t=(e||[]).map((e=>e.tag_id)),o=Tt.tags.filter((e=>!t.includes(e.id))).map((e=>({contact_id:c.contact_id,tag_id:e.id})));o.length>0&&await D.supabase.from("contact_tags").insert(o)}if(Tt.company&&Tt.company.id){const{data:e}=await D.supabase.from("contact_companies").select("contact_companies_id").eq("contact_id",c.contact_id).eq("company_id",Tt.company.id);e&&0!==e.length||await D.supabase.from("contact_companies").insert([{contact_id:c.contact_id,company_id:Tt.company.id}])}if(Tt.notes&&""!==Tt.notes.trim()){const{data:e,error:t}=await D.supabase.from("notes").insert([{note_text:Tt.notes,created_at:(new Date).toISOString()}]).select("note_id");if(t)throw t;e&&e.length>0&&await D.supabase.from("notes_contacts").insert([{note_id:e[0].note_id,contact_id:c.contact_id}])}const{error:t}=await D.supabase.from("contacts").update({category:null}).eq("contact_id",c.contact_id);if(t)throw t;nt.Ay.success("Contact successfully added to CRM"),a("/contacts/inbox")}catch(e){console.error("Error saving contact to CRM:",e),st(`Failed to save contact to CRM: ${e.message||"Unknown error"}`),x(!1)}}},mn=()=>{a("/inbox?source=category")};return b&&!c?(0,N.jsx)(nA,{children:(0,N.jsx)(mR,{children:(0,N.jsx)("div",{children:"Loading contact data..."})})}):at&&!c?(0,N.jsxs)(nA,{children:[(0,N.jsxs)(xR,{children:[(0,N.jsx)(B.eHT,{size:20}),(0,N.jsx)("div",{children:at})]}),(0,N.jsx)(pA,{onClick:mn,children:"Return to Inbox"})]}):(0,N.jsxs)(nA,{children:[(0,N.jsxs)(rA,{children:[(0,N.jsx)(iA,{children:(0,N.jsx)("a",{onClick:()=>a("/inbox"),children:(0,N.jsx)(B.V5Y,{})})}),(0,N.jsx)(iA,{children:(0,N.jsx)(B.fOo,{})}),(0,N.jsx)(iA,{children:(0,N.jsx)("a",{onClick:()=>a("/inbox?source=category"),children:"Processing"})}),(0,N.jsx)(iA,{children:(0,N.jsx)(B.fOo,{})}),(0,N.jsx)(iA,{active:!0,children:(0,N.jsxs)("a",{children:["Edit: ",null===c||void 0===c?void 0:c.first_name," ",null===c||void 0===c?void 0:c.last_name]})})]}),c&&(0,N.jsxs)(bR,{children:[(0,N.jsx)("h2",{children:xe?(0,N.jsxs)(N.Fragment,{children:[(0,N.jsx)(MA,{type:"text",value:Ce,onChange:e=>_e(e.target.value),width:"120px",placeholder:"First name",autoFocus:!0}),(0,N.jsx)(MA,{type:"text",value:Se,onChange:e=>Ee(e.target.value),width:"120px",placeholder:"Last name"}),(0,N.jsx)(pA,{variant:"primary",onClick:async()=>{try{const{error:e}=await D.supabase.from("contacts").update({first_name:Ce,last_name:Se}).eq("contact_id",r);if(e)throw e;d({...c,first_name:Ce,last_name:Se}),we(!1),nt.Ay.success("Name updated successfully")}catch(e){console.error("Error updating name:",e),nt.Ay.error("Failed to update name")}},style:{padding:"0px 8px",margin:"0 4px",fontSize:"0.8rem",height:"26px"},children:(0,N.jsx)(B.YrT,{size:14})}),(0,N.jsx)(pA,{onClick:()=>{we(!1)},style:{padding:"0px 8px",margin:"0",fontSize:"0.8rem",height:"26px"},children:(0,N.jsx)(B.yGN,{size:14})})]}):(0,N.jsxs)(N.Fragment,{children:[c.first_name," ",c.last_name,(0,N.jsx)(vR,{onClick:()=>{_e((null===c||void 0===c?void 0:c.first_name)||""),Ee((null===c||void 0===c?void 0:c.last_name)||""),we(!0)},children:(0,N.jsx)(B.SG1,{size:16,color:"#00ff00"})})]})}),(0,N.jsxs)("div",{className:"contact-details",children:[c.email?(0,N.jsxs)("div",{className:"detail-item",children:[(0,N.jsx)(B.pHD,{})," ",(0,N.jsx)("a",{href:`https://mail.superhuman.com/search/${encodeURIComponent(c.first_name)}%20${encodeURIComponent(c.last_name)}`,target:"_blank",rel:"noopener noreferrer",style:{color:"inherit",textDecoration:"none"},children:c.email})]}):(0,N.jsxs)("div",{className:"detail-item",children:[(0,N.jsx)(B.pHD,{})," ",(0,N.jsx)("a",{href:`https://mail.superhuman.com/search/${encodeURIComponent(c.first_name)}%20${encodeURIComponent(c.last_name)}`,target:"_blank",rel:"noopener noreferrer",style:{color:"inherit",textDecoration:"none"},children:"Search Email"})]}),c.mobile&&(0,N.jsxs)("div",{className:"detail-item",children:[(0,N.jsx)(B.QFc,{})," ",(0,N.jsx)("a",{href:`https://wa.me/${c.mobile?c.mobile.replace(/\D/g,""):""}`,target:"_blank",rel:"noopener noreferrer",style:{color:"inherit",textDecoration:"none"},children:c.mobile})]}),(0,N.jsxs)("div",{className:"detail-item",children:[(0,N.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",viewBox:"0 0 24 24",fill:"currentColor",style:{marginRight:"5px"},children:(0,N.jsx)("path",{d:"M19 0h-14c-2.761 0-5 2.239-5 5v14c0 2.761 2.239 5 5 5h14c2.762 0 5-2.239 5-5v-14c0-2.761-2.238-5-5-5zm-11 19h-3v-11h3v11zm-1.5-12.268c-.966 0-1.75-.79-1.75-1.764s.784-1.764 1.75-1.764 1.75.79 1.75 1.764-.783 1.764-1.75 1.764zm13.5 12.268h-3v-5.604c0-3.368-4-3.113-4 0v5.604h-3v-11h3v1.765c1.396-2.586 7-2.777 7 2.476v6.759z"})})," ",c.linkedin?(0,N.jsx)("a",{href:c.linkedin,target:"_blank",rel:"noopener noreferrer",style:{color:"inherit",textDecoration:"none"},children:"LinkedIn Profile"}):(0,N.jsx)("a",{href:`https://www.linkedin.com/search/results/people/?keywords=${c.first_name||""}%20${c.last_name||""}&sid=Avh`,target:"_blank",rel:"noopener noreferrer",style:{color:"inherit",textDecoration:"none"},children:"Search LinkedIn"})]}),c.category&&(0,N.jsx)(yR,{children:c.category}),c.last_interaction_at&&(0,N.jsxs)("div",{className:"detail-item",children:["Last interaction: ",new Date(c.last_interaction_at).toLocaleDateString()]})]})]}),(0,N.jsxs)(lA,{children:[(0,N.jsxs)(cA,{$active:1===y,$completed:y>1,$clickable:!0,onClick:()=>en(1),children:[(0,N.jsx)("div",{className:"step-number",children:"1"}),(0,N.jsx)("div",{className:"step-label",children:"Interactions"})]}),(0,N.jsxs)(cA,{$active:2===y,$completed:y>2,$clickable:y>=2||1===y,onClick:()=>y>=2||1===y?en(2):null,children:[(0,N.jsx)("div",{className:"step-number",children:"2"}),(0,N.jsx)("div",{className:"step-label",children:"Duplicates"})]}),(0,N.jsxs)(cA,{$active:3===y,$completed:y>3,$clickable:y>=3||2===y,onClick:()=>y>=3||2===y?en(3):null,children:[(0,N.jsx)("div",{className:"step-number",children:"3"}),(0,N.jsx)("div",{className:"step-label",children:"Enrichment"})]})]}),(0,N.jsxs)(aA,{children:[(0,N.jsx)(sA,{$active:1===y,$completed:y>1}),(0,N.jsx)(sA,{$active:2===y,$completed:y>2}),(0,N.jsx)(sA,{$active:3===y,$completed:y>3})]}),at&&(0,N.jsxs)(xR,{children:[(0,N.jsx)(B.eHT,{size:20}),(0,N.jsx)("div",{children:at})]}),1===y&&(0,N.jsxs)(N.Fragment,{children:[(0,N.jsxs)(dA,{children:[(0,N.jsxs)(uA,{children:[(0,N.jsx)(B.mEP,{})," Recent Interactions"]}),b?(0,N.jsx)(mR,{style:{minHeight:"200px"},children:"Loading interactions..."}):(0,N.jsxs)(fA,{children:[(0,N.jsxs)(gA,{children:[(0,N.jsx)("div",{style:{padding:"10px 15px",color:"#999",fontSize:"0.8rem",borderBottom:"1px solid #333",fontWeight:"bold"},children:"WHATSAPP"}),Lt.map(((e,t)=>(0,N.jsxs)("div",{style:{padding:"12px 15px",cursor:"pointer",borderBottom:"1px solid #222",display:"flex",alignItems:"center",gap:"8px"},onClick:()=>(async e=>{Bt(e),Kt(null),Wt(!0),$t([]);try{console.log("Loading messages for chat ID:",e);const{data:t,error:o}=await D.supabase.from("interactions").select("\n          interaction_id,\n          contact_id,\n          interaction_type,\n          direction,\n          interaction_date,\n          chat_id,\n          summary,\n          created_at,\n          external_interaction_id,\n          special_case_tag\n        ").eq("chat_id",e).eq("interaction_type","whatsapp").order("interaction_date",{ascending:!1});if(o)return void console.error("Error loading chat messages:",o);if(console.log("Loaded chat messages:",t),t&&t.length>0){const e=t.map((e=>({id:e.interaction_id,content:e.summary||"No content",direction:"sent"===e.direction?"sent":"received",timestamp:e.interaction_date,formattedTime:new Date(e.interaction_date).toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"})})));$t(e)}}catch(t){console.error("Error in handleSelectChat:",t)}finally{Wt(!1)}})(e.chat_id),children:[e.is_group_chat?(0,N.jsx)(B.cfS,{size:16,color:"#25d366"}):(0,N.jsx)(B.mEP,{size:16,color:"#25d366"}),(0,N.jsx)("span",{style:{color:"#25d366"},children:e.chat_name}),e.unread_count>0&&(0,N.jsx)("span",{style:{backgroundColor:"#222",color:"#888",padding:"1px 6px",borderRadius:"10px",fontSize:"0.7rem",marginLeft:"auto"},children:e.unread_count})]},e.chat_id||t))),(0,N.jsx)("div",{style:{padding:"10px 15px",color:"#999",fontSize:"0.8rem",borderBottom:"1px solid #333",fontWeight:"bold"},children:"EMAIL"}),Gt.map((e=>(0,N.jsxs)("div",{style:{padding:"12px 15px",cursor:"pointer",borderBottom:"1px solid #222",display:"flex",alignItems:"center",gap:"8px",backgroundColor:qt===e.thread_id?"#2a2a2a":"transparent"},onClick:()=>(async e=>{Kt(e),Bt(null),Qt(!0),Jt([]),eo({});try{console.log("Loading emails for thread ID:",e);const{data:t,error:o}=await D.supabase.from("emails").select("\n        email_id,\n        thread_id,\n        email_thread_id,\n        subject,\n        body_plain,\n        body_html,\n        message_timestamp,\n        is_read,\n        direction,\n        has_attachments,\n        attachment_count,\n        email_participants!inner (\n          participant_id,\n          participant_type,\n          contacts:contact_id (\n            contact_id,\n            first_name,\n            last_name,\n            contact_emails (\n              email\n            )\n          )\n        )\n      ").eq("email_thread_id",e).order("message_timestamp",{ascending:!1});if(o)console.error("Error loading emails with participants:",o);else{if(t&&t.length>0){console.log("Found emails with participants:",t);const e=t.map((e=>{var t,o;const n=e.email_participants.find((e=>"sender"===e.participant_type)),r=e.email_participants.filter((e=>"to"===e.participant_type)),i=e.email_participants.filter((e=>"cc"===e.participant_type)),a=e.email_participants.filter((e=>"bcc"===e.participant_type));return{email_id:e.email_id,thread_id:e.thread_id,email_thread_id:e.email_thread_id,subject:e.subject,body_plain:e.body_plain,body_html:e.body_html,message_timestamp:e.message_timestamp,is_read:e.is_read,direction:e.direction,has_attachments:e.has_attachments,attachment_count:e.attachment_count,sender:n?{contact_id:n.contacts.contact_id,name:`${n.contacts.first_name} ${n.contacts.last_name}`.trim(),email:(null===(t=n.contacts.contact_emails)||void 0===t||null===(o=t[0])||void 0===o?void 0:o.email)||""}:null,to:r.map((e=>{var t,o;return{contact_id:e.contacts.contact_id,name:`${e.contacts.first_name} ${e.contacts.last_name}`.trim(),email:(null===(t=e.contacts.contact_emails)||void 0===t||null===(o=t[0])||void 0===o?void 0:o.email)||""}})),cc:i.map((e=>{var t,o;return{contact_id:e.contacts.contact_id,name:`${e.contacts.first_name} ${e.contacts.last_name}`.trim(),email:(null===(t=e.contacts.contact_emails)||void 0===t||null===(o=t[0])||void 0===o?void 0:o.email)||""}})),bcc:a.map((e=>{var t,o;return{contact_id:e.contacts.contact_id,name:`${e.contacts.first_name} ${e.contacts.last_name}`.trim(),email:(null===(t=e.contacts.contact_emails)||void 0===t||null===(o=t[0])||void 0===o?void 0:o.email)||""}}))}}));return Jt(e),e.length>0&&eo({[e[0].email_id]:!0}),void Qt(!1)}console.log("No emails with participants found for thread ID:",e)}const{data:n,error:r}=await D.supabase.from("emails").select("\n        email_id,\n        thread_id,\n        email_thread_id,\n        sender_contact_id,\n        subject,\n        body_plain,\n        body_html,\n        message_timestamp,\n        is_read,\n        direction,\n        has_attachments,\n        attachment_count,\n        contacts:sender_contact_id (\n          contact_id,\n          first_name,\n          last_name,\n          contact_emails (\n            email\n          )\n        )\n      ").eq("email_thread_id",e).order("message_timestamp",{ascending:!1});if(r)console.error("Error loading basic emails:",r);else{if(n&&n.length>0){console.log("Found basic emails:",n);const e=n.map((e=>{var t,o;return{email_id:e.email_id,thread_id:e.thread_id,email_thread_id:e.email_thread_id,subject:e.subject,body_plain:e.body_plain,body_html:e.body_html,message_timestamp:e.message_timestamp,is_read:e.is_read,direction:e.direction,has_attachments:e.has_attachments,attachment_count:e.attachment_count,sender:e.contacts?{contact_id:e.contacts.contact_id,name:`${e.contacts.first_name} ${e.contacts.last_name}`.trim(),email:(null===(t=e.contacts.contact_emails)||void 0===t||null===(o=t[0])||void 0===o?void 0:o.email)||""}:null,to:[],cc:[],bcc:[]}}));return Jt(e),e.length>0&&eo({[e[0].email_id]:!0}),void Qt(!1)}console.log("No basic emails found for thread ID:",e)}const{data:i,error:a}=await D.supabase.from("email_threads").select("subject").eq("email_thread_id",e).single();if(a)console.error("Error getting thread details:",a);else if(i&&i.subject){const e=i.subject;console.log("Trying to find emails by subject:",e);const{data:t,error:o}=await D.supabase.from("emails").select("\n          email_id,\n          thread_id,\n          email_thread_id,\n          sender_contact_id,\n          subject,\n          body_plain,\n          body_html,\n          message_timestamp,\n          is_read,\n          direction,\n          has_attachments,\n          attachment_count,\n          contacts:sender_contact_id (\n            contact_id,\n            first_name,\n            last_name,\n            contact_emails (\n              email\n            )\n          )\n        ").or(`subject.eq.${e},subject.ilike.%${e}%,subject.ilike.%Re: ${e}%`).order("message_timestamp",{ascending:!1});if(o)console.error("Error in subject search:",o);else{if(t&&t.length>0){console.log("Found emails by subject:",t);const e=t.map((e=>{var t,o;return{email_id:e.email_id,thread_id:e.thread_id,email_thread_id:e.email_thread_id,subject:e.subject,body_plain:e.body_plain,body_html:e.body_html,message_timestamp:e.message_timestamp,is_read:e.is_read,direction:e.direction,has_attachments:e.has_attachments,attachment_count:e.attachment_count,sender:e.contacts?{contact_id:e.contacts.contact_id,name:`${e.contacts.first_name} ${e.contacts.last_name}`.trim(),email:(null===(t=e.contacts.contact_emails)||void 0===t||null===(o=t[0])||void 0===o?void 0:o.email)||""}:null,to:[],cc:[],bcc:[]}}));return Jt(e),e.length>0&&eo({[e[0].email_id]:!0}),void Qt(!1)}console.log("No emails found with subject:",e)}}console.log("No emails found for this thread with any method")}catch(t){console.error("Error in handleSelectEmailThread:",t)}finally{Qt(!1)}})(e.thread_id),children:[(0,N.jsx)(B.pHD,{size:16,color:"#4a9eff"}),(0,N.jsx)("span",{style:{color:"#4a9eff",overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"},children:e.title})]},e.thread_id))),(0,N.jsx)("div",{style:{padding:"10px 15px",color:"#999",fontSize:"0.8rem",borderBottom:"1px solid #333",fontWeight:"bold"},children:"MEETINGS"})]}),(0,N.jsx)(mA,{children:Ht?(0,N.jsxs)(OA,{children:[(0,N.jsxs)(TA,{children:[(0,N.jsx)(DA,{children:((null===(e=Lt.find((e=>e.chat_id===Ht)))||void 0===e?void 0:e.chat_name)||"").charAt(0).toUpperCase()}),(0,N.jsxs)(PA,{children:[(0,N.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:"8px"},children:[(0,N.jsx)(NA,{children:(null===(o=Lt.find((e=>e.chat_id===Ht)))||void 0===o?void 0:o.chat_name)||"Chat"}),(0,N.jsx)("div",{style:{cursor:"pointer",display:"flex",alignItems:"center",color:"#00ff00",opacity:"0.7",marginLeft:"5px"},onClick:()=>{if(c){var e;const o=((null===(e=Lt.find((e=>e.chat_id===Ht)))||void 0===e?void 0:e.chat_name)||"").split(" "),n=o[0]||"",i=o.length>1?o.slice(1).join(" "):"";_e(n),Ee(i);try{D.supabase.from("contacts").update({first_name:n,last_name:i}).eq("contact_id",r).then((e=>{let{error:t}=e;t?(console.error("Error updating name:",t),nt.Ay.error("Failed to update name")):(d({...c,first_name:n,last_name:i}),nt.Ay.success("Contact name updated from chat"))}))}catch(t){console.error("Error updating name:",t),nt.Ay.error("Failed to update name")}}},children:(0,N.jsx)(B.dyV,{size:16})}),(0,N.jsxs)("button",{title:"Open in WhatsApp",onClick:()=>{if(Tt.mobiles&&Tt.mobiles.length>0){var e;let t=null===(e=Tt.mobiles.find((e=>e.is_primary)))||void 0===e?void 0:e.mobile;if(!t&&Tt.mobiles.length>0&&(t=Tt.mobiles[0].mobile),t){const e=t.replace(/\D/g,"");window.open(`https://wa.me/${e}`,"_blank")}else nt.Ay.error("No mobile number available for this contact")}else nt.Ay.error("No mobile number available for this contact")},style:{display:"inline-flex",alignItems:"center",backgroundColor:"#1a1a1a",color:"#25d366",borderRadius:"4px",padding:"4px 8px",fontSize:"0.7rem",fontWeight:"bold",border:"1px solid #25d366",cursor:"pointer",marginLeft:"10px"},children:[(0,N.jsx)(B.QFc,{size:12,style:{marginRight:"3px"}}),"WhatsApp"]})]}),(0,N.jsxs)(IA,{children:[Vt.length," messages"]})]})]}),(0,N.jsx)(FA,{children:Ut?(0,N.jsx)("div",{style:{padding:"20px",textAlign:"center",color:"#999"},children:"Loading messages..."}):0===Vt.length?(0,N.jsxs)(HA,{children:[(0,N.jsx)(B.mEP,{size:40}),(0,N.jsx)("h3",{children:"No Messages"}),(0,N.jsx)("p",{children:"There are no messages in this conversation yet."})]}):Vt.map((e=>(0,N.jsxs)(GA,{$direction:e.direction,children:[e.content,(0,N.jsx)(zA,{children:e.formattedTime})]},e.id)))})]}):qt?(0,N.jsxs)(yA,{children:[(0,N.jsx)(vA,{children:(0,N.jsxs)("div",{style:{display:"flex",flexDirection:"column"},children:[(0,N.jsx)(bA,{style:{marginBottom:"10px"},children:(null===(n=Gt.find((e=>e.thread_id===qt)))||void 0===n?void 0:n.title)||"No Subject"}),(0,N.jsxs)("button",{onClick:()=>window.open(`https://mail.superhuman.com/search/${c.first_name||""}%20${c.last_name||""}`,"_blank"),style:{display:"inline-flex",alignItems:"center",alignSelf:"flex-start",backgroundColor:"#1a1a1a",color:"#00ff00",borderRadius:"4px",padding:"5px 10px",fontSize:"0.8rem",fontWeight:"bold",border:"1px solid #00ff00",cursor:"pointer"},children:[(0,N.jsx)(B.HaR,{size:14,style:{marginRight:"5px"}}),"Open in Superhuman"]})]})}),(0,N.jsx)(xA,{children:Xt?(0,N.jsx)("div",{style:{padding:"20px",textAlign:"center",color:"#999"},children:"Loading emails..."}):0===Yt.length?(0,N.jsxs)(HA,{children:[(0,N.jsx)(B.pHD,{size:40}),(0,N.jsx)("h3",{children:"No Emails"}),(0,N.jsx)("p",{children:"There are no emails in this thread."})]}):Yt.map((e=>{var t,o;return(0,N.jsxs)(wA,{$expanded:Zt[e.email_id],children:[(0,N.jsxs)(CA,{onClick:()=>{return t=e.email_id,void eo((e=>({...e,[t]:!e[t]})));var t},children:[(0,N.jsxs)(_A,{children:[(0,N.jsx)(SA,{children:e.sender?e.sender.name:null!==(t=e.contacts)&&void 0!==t&&t.first_name&&null!==(o=e.contacts)&&void 0!==o&&o.last_name?`${e.contacts.first_name} ${e.contacts.last_name}`:"Unknown Sender"}),(0,N.jsx)(EA,{children:new Date(e.message_timestamp).toLocaleString()})]}),(0,N.jsx)(kA,{children:e.body_plain?e.body_plain.substring(0,100):"No content"})]}),Zt[e.email_id]&&(0,N.jsxs)(jA,{children:[(0,N.jsxs)("div",{style:{marginBottom:"15px",paddingBottom:"15px",borderBottom:"1px solid #333"},children:[(0,N.jsxs)("div",{style:{display:"flex",marginBottom:"6px"},children:[(0,N.jsx)("strong",{style:{minWidth:"60px",color:"#999"},children:"From:"}),(0,N.jsx)("span",{style:{color:"#ccc"},children:e.sender?`${e.sender.name} ${e.sender.email?`<${e.sender.email}>`:""}`:"Unknown Sender"})]}),e.to&&e.to.length>0&&(0,N.jsxs)("div",{style:{display:"flex",marginBottom:"6px"},children:[(0,N.jsx)("strong",{style:{minWidth:"60px",color:"#999"},children:"To:"}),(0,N.jsx)("span",{style:{color:"#ccc"},children:e.to.map((e=>`${e.name}${e.email?` <${e.email}>`:""}`)).join(", ")})]}),e.cc&&e.cc.length>0&&(0,N.jsxs)("div",{style:{display:"flex",marginBottom:"6px"},children:[(0,N.jsx)("strong",{style:{minWidth:"60px",color:"#999"},children:"CC:"}),(0,N.jsx)("span",{style:{color:"#ccc"},children:e.cc.map((e=>`${e.name}${e.email?` <${e.email}>`:""}`)).join(", ")})]}),(0,N.jsxs)("div",{style:{display:"flex",marginBottom:"6px"},children:[(0,N.jsx)("strong",{style:{minWidth:"60px",color:"#999"},children:"Subject:"}),(0,N.jsx)("span",{style:{color:"#ccc"},children:e.subject||"No Subject"})]})]}),(0,N.jsx)("div",{style:{marginBottom:"15px",color:"#ddd"},children:e.body_html?(0,N.jsx)("div",{dangerouslySetInnerHTML:{__html:e.body_html}}):e.body_plain.split("\n").map(((e,t)=>(0,N.jsx)("p",{children:e},t)))}),e.has_attachments&&e.attachment_count>0&&(0,N.jsxs)(AA,{children:[(0,N.jsxs)("div",{style:{fontSize:"0.8rem",color:"#aaa",marginBottom:"8px"},children:[e.attachment_count," attachment",1!==e.attachment_count?"s":""]}),(0,N.jsxs)(RA,{children:[(0,N.jsx)(B.QuH,{size:20}),(0,N.jsx)("span",{children:"Attachment"})]})]})]})]},e.email_id)}))})]}):(0,N.jsxs)("div",{style:{display:"flex",alignItems:"center",justifyContent:"center",height:"100%",color:"#666",flexDirection:"column",gap:"15px"},children:[(0,N.jsx)(B.mEP,{size:40,color:"#333"}),(0,N.jsx)("div",{children:"Select a conversation to view messages"})]})})]})]}),(0,N.jsxs)(hA,{children:[(0,N.jsxs)("div",{children:[(0,N.jsxs)(pA,{variant:"danger",onClick:()=>fn("Spam"),disabled:b,children:[(0,N.jsx)(B.IXo,{})," Mark as Spam"]}),(0,N.jsxs)(pA,{variant:"warning",onClick:()=>fn("Skip"),disabled:b,style:{marginLeft:"10px"},children:[(0,N.jsx)(B.yGN,{})," Skip Contact"]})]}),(0,N.jsxs)(pA,{variant:"primary",onClick:()=>en(2),disabled:b,children:["Continue ",(0,N.jsx)(B.dyV,{})]})]})]}),2===y&&(0,N.jsxs)(N.Fragment,{children:[(0,N.jsxs)(dA,{children:[(0,N.jsxs)(uA,{children:[(0,N.jsx)(B.CKj,{})," Check for Duplicate Contacts"]}),b?(0,N.jsx)(mR,{style:{minHeight:"200px"},children:"Searching for duplicates..."}):(0,N.jsxs)(fA,{children:[(0,N.jsxs)(gA,{children:[(0,N.jsx)("div",{style:{padding:"10px 15px",color:"#999",fontSize:"0.8rem",borderBottom:"1px solid #333",fontWeight:"bold"},children:"DUPLICATES"}),(0,N.jsxs)("div",{onClick:()=>{_o("duplicates_find"),ft(null),Ct(""),cn()},style:{padding:"12px 15px",cursor:"pointer",borderBottom:"1px solid #222",display:"flex",alignItems:"center",gap:"8px",background:"duplicates_find"===Co?"#222":"transparent"},children:[(0,N.jsx)(B.CKj,{size:16}),(0,N.jsx)("span",{children:"Find"})]}),(0,N.jsx)("div",{style:{padding:"10px 15px",color:"#999",fontSize:"0.8rem",borderBottom:"1px solid #333",fontWeight:"bold",marginTop:"10px"},children:"AIRTABLE"}),(0,N.jsxs)("div",{onClick:()=>{_o("airtable"),ft(null)},style:{padding:"12px 15px",cursor:"pointer",borderBottom:"1px solid #222",display:"flex",alignItems:"center",gap:"8px",background:"airtable"===Co?"#222":"transparent"},children:[(0,N.jsx)(B.Hbo,{size:16}),(0,N.jsx)("span",{children:"Matching"})]}),(0,N.jsxs)("div",{onClick:()=>{_o("airtable_combining"),ft(null)},style:{padding:"12px 15px",cursor:"pointer",borderBottom:"1px solid #222",display:"flex",alignItems:"center",gap:"8px",background:"airtable_combining"===Co?"#222":"transparent"},children:[(0,N.jsx)(B.EPw,{size:16}),(0,N.jsx)("span",{children:"Combining"})]})]}),(0,N.jsx)(mA,{style:{paddingRight:"airtable"===Co||"airtable_combining"===Co||"supabase_duplicates"===Co||"duplicates_find"===Co?"20px":"0"},children:"duplicates_find"===Co?(0,N.jsx)("div",{style:{padding:"0 0 20px 20px",width:"90%"},children:(0,N.jsxs)(cR,{children:[(0,N.jsx)("h3",{style:{fontSize:"16px",marginBottom:"8px"},children:"Find Potential Duplicates"}),(0,N.jsx)(lR,{children:"Suggested search"}),(0,N.jsx)("div",{style:{padding:"10px",background:"#333",borderRadius:"4px",marginBottom:"15px"},children:(0,N.jsxs)("div",{style:{display:"flex",gap:"8px",flexWrap:"wrap"},children:[(null===c||void 0===c?void 0:c.last_name)&&(0,N.jsxs)("div",{onClick:()=>{St("name"),Ct(c.last_name),dn(c.last_name,"name")},style:{background:"#444",color:"#00ff00",padding:"5px 10px",borderRadius:"4px",cursor:"pointer",fontSize:"13px",border:"1px solid #555",display:"flex",alignItems:"center",gap:"5px"},children:[(0,N.jsx)(B.JXP,{size:12}),c.last_name]}),(null===c||void 0===c?void 0:c.first_name)&&(0,N.jsxs)("div",{onClick:()=>{St("name"),Ct(c.first_name),dn(c.first_name,"name")},style:{background:"#444",color:"#ccc",padding:"5px 10px",borderRadius:"4px",cursor:"pointer",fontSize:"13px",border:"1px solid #555",display:"flex",alignItems:"center",gap:"5px"},children:[(0,N.jsx)(B.JXP,{size:12}),c.first_name]}),(null===c||void 0===c?void 0:c.email)&&(0,N.jsxs)("div",{onClick:()=>{St("email"),Ct(c.email),dn(c.email,"email")},style:{background:"#444",color:"#ffcc00",padding:"5px 10px",borderRadius:"4px",cursor:"pointer",fontSize:"13px",border:"1px solid #555",display:"flex",alignItems:"center",gap:"5px"},children:[(0,N.jsx)(B.pHD,{size:12}),c.email]}),(null===c||void 0===c?void 0:c.mobile)&&(0,N.jsxs)("div",{onClick:()=>{St("mobile"),Ct(c.mobile),dn(c.mobile,"mobile")},style:{background:"#444",color:"#00ccff",padding:"5px 10px",borderRadius:"4px",cursor:"pointer",fontSize:"13px",border:"1px solid #555",display:"flex",alignItems:"center",gap:"5px"},children:[(0,N.jsx)(B.QFc,{size:12}),c.mobile]})]})}),(0,N.jsx)(lR,{children:"Search for potential duplicates"}),(0,N.jsxs)("div",{style:{position:"relative",marginBottom:"15px"},children:[(0,N.jsxs)("div",{style:{display:"flex",gap:"8px",marginBottom:"10px"},children:[(0,N.jsxs)("select",{value:_t||"name",onChange:e=>St(e.target.value),style:{padding:"8px 10px",borderRadius:"4px",background:"#333",color:"#fff",border:"1px solid #444",width:"110px"},children:[(0,N.jsx)("option",{value:"name",children:"Name"}),(0,N.jsx)("option",{value:"email",children:"Email"}),(0,N.jsx)("option",{value:"mobile",children:"Mobile"})]}),(0,N.jsx)(uR,{type:"text",value:wt,onChange:e=>{Ct(e.target.value),e.target.value.trim()||kt([])},onClick:e=>{e.target.focus()},onFocus:e=>{e.target.select()},onKeyDown:e=>{"Escape"===e.key?(Ct(""),kt([])):"Enter"===e.key&&(e.preventDefault(),console.log("Enter key pressed with query:",wt),wt.trim().length>=2?dn(wt.trim(),_t||"name"):wt.trim().length>0&&nt.Ay.info("Please enter at least 2 characters to search")),e.stopPropagation()},placeholder:`Search by ${_t||"name"}... (ESC to clear, Enter to search)`,style:{flex:1},autoComplete:"off"}),(0,N.jsx)("button",{onClick:e=>{e.preventDefault(),e.stopPropagation(),console.log("Search button clicked with query:",wt),wt.trim().length>=2?dn(wt.trim(),_t||"name"):nt.Ay.info("Please enter at least 2 characters to search")},disabled:wt.trim().length<2,style:{background:wt.trim().length>=2?"#00ff00":"#444",border:"none",borderRadius:"4px",padding:"0 15px",color:wt.trim().length>=2?"black":"#999",cursor:wt.trim().length>=2?"pointer":"not-allowed"},children:"Search"})]}),Et.length>0&&(0,N.jsx)("div",{style:{position:"absolute",zIndex:10,background:"#333",width:"100%",maxHeight:"250px",overflowY:"auto",borderRadius:"4px",boxShadow:"0 4px 8px rgba(0,0,0,0.3)"},children:Et.map((e=>(0,N.jsx)("div",{onClick:()=>(e=>{Ot(e),At(!0)})(e),style:{padding:"10px 15px",borderBottom:"1px solid #444",cursor:"pointer",display:"flex",flexDirection:"column",gap:"3px"},onMouseOver:e=>e.currentTarget.style.background="#444",onMouseOut:e=>e.currentTarget.style.background="transparent",children:(0,N.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[(0,N.jsxs)("div",{children:[(0,N.jsxs)("div",{style:{fontSize:"14px",fontWeight:"bold"},children:[e.first_name," ",e.last_name,e.company&&(0,N.jsxs)("span",{style:{fontSize:"12px",fontWeight:"normal",color:"#00aa00",marginLeft:"8px"},children:["@ ",e.company]})]}),(0,N.jsxs)("div",{style:{fontSize:"12px",color:"#ccc"},children:[e.email&&(0,N.jsxs)("div",{style:{marginBottom:"3px"},children:[(0,N.jsx)(B.pHD,{size:12,style:{marginRight:"5px"}}),e.email]}),e.mobile&&(0,N.jsxs)("div",{style:{marginBottom:"3px"},children:[(0,N.jsx)(B.QFc,{size:12,style:{marginRight:"5px"}}),e.mobile]}),e.description&&(0,N.jsxs)("div",{style:{marginTop:"3px",color:"#aaa"},children:[e.description.substring(0,100),e.description.length>100?"...":""]})]})]}),(0,N.jsx)("div",{style:{display:"flex",gap:"5px"},children:(0,N.jsx)("button",{onClick:t=>{t.stopPropagation(),async function(e){if(c&&c.contact_id&&e)try{const{data:t,error:o}=await D.supabase.from("contact_duplicates").select("duplicate_id").or(`and(primary_contact_id.eq.${c.contact_id},duplicate_contact_id.eq.${e}),and(primary_contact_id.eq.${e},duplicate_contact_id.eq.${c.contact_id})`).eq("false_positive",!1);if(o)return console.error("Error checking for existing duplicate pairs:",o),void nt.Ay.error("Failed to check for existing duplicates");if(t&&t.length>0)return void nt.Ay.info("This contact is already marked as a potential duplicate");let n=null,r=null;if(c.email){const{data:t}=await D.supabase.from("contact_emails").select("email").eq("contact_id",e).eq("email",c.email).limit(1);t&&t.length>0&&(n=c.email)}if(c.mobile){const{data:t}=await D.supabase.from("contact_mobiles").select("mobile").eq("contact_id",e).eq("mobile",c.mobile).limit(1);t&&t.length>0&&(r=c.mobile)}const{data:i,error:a}=await D.supabase.from("contact_duplicates").insert({primary_contact_id:c.contact_id,duplicate_contact_id:e,status:"pending",false_positive:!1,email:n,mobile_number:r,detected_at:(new Date).toISOString(),notes:"Manually added as potential duplicate"}).select("*");if(a)return console.error("Error adding duplicate pair:",a),void nt.Ay.error("Failed to add duplicate pair");Wo(),nt.Ay.success("Duplicate pair added")}catch(t){console.error("Error in addDuplicatePair:",t),nt.Ay.error("Failed to add duplicate pair")}}(e.contact_id).then((()=>{ft(e),Ze(!0)}))},title:"Mark as duplicate and merge",style:{background:"#00ff00",color:"black",border:"none",borderRadius:"4px",padding:"2px 7px",cursor:"pointer",fontSize:"12px",display:"flex",alignItems:"center",justifyContent:"center",minWidth:"25px",minHeight:"25px"},children:(0,N.jsx)(B.EPw,{size:14})})})]})},e.contact_id)))})]})]})}):"airtable"===Co?(0,N.jsxs)("div",{style:{padding:"20px 0 20px 20px",width:"90%"},children:[(0,N.jsxs)(cR,{children:[(0,N.jsx)("h3",{style:{fontSize:"16px",marginBottom:"15px"},children:"Airtable Integration"}),(0,N.jsx)(lR,{children:"Search & Link Airtable Contact"}),(0,N.jsxs)("div",{style:{position:"relative",marginBottom:"15px"},children:[(0,N.jsxs)("div",{style:{display:"flex",gap:"8px",marginBottom:"10px"},children:[(0,N.jsx)(uR,{type:"text",value:h,onChange:e=>{f(e.target.value),e.target.value.trim().length>=2?Jo(e.target.value):m([])},onKeyDown:e=>{"Escape"===e.key&&(f(""),m([]))},placeholder:"Search by name, email or phone number... (ESC to clear)",style:{flex:1}}),(0,N.jsx)("button",{onClick:()=>Jo(h),disabled:h.trim().length<2,style:{background:h.trim().length>=2?"#00ff00":"#444",border:"none",borderRadius:"4px",padding:"0 15px",color:h.trim().length>=2?"black":"#999",cursor:h.trim().length>=2?"pointer":"not-allowed"},children:"Search"})]}),g.length>0&&(0,N.jsx)("div",{style:{position:"absolute",zIndex:10,background:"#333",width:"100%",maxHeight:"250px",overflowY:"auto",borderRadius:"4px",boxShadow:"0 4px 8px rgba(0,0,0,0.3)"},children:g.map((e=>(0,N.jsxs)("div",{onClick:()=>(async e=>{if(c)try{const{error:t}=await D.supabase.from("contacts").update({airtable_id:e}).eq("contact_id",c.contact_id);return t?(console.error("Error associating Airtable contact:",t),!1):(d((t=>({...t,airtable_id:e}))),Xo(e),f(""),m([]),!0)}catch(t){return console.error("Error in associateAirtableContact:",t),!1}})(e.airtable_id),style:{padding:"10px 15px",borderBottom:"1px solid #444",cursor:"pointer",display:"flex",flexDirection:"column",gap:"3px"},onMouseOver:e=>e.currentTarget.style.background="#444",onMouseOut:e=>e.currentTarget.style.background="transparent",children:[(0,N.jsx)("div",{style:{fontSize:"14px",fontWeight:"bold"},children:e.full_name}),(0,N.jsxs)("div",{style:{fontSize:"12px",color:"#ccc"},children:[e.primary_email&&(0,N.jsxs)("div",{style:{marginBottom:"3px"},children:[(0,N.jsx)(B.pHD,{size:12,style:{marginRight:"5px"}}),e.primary_email]}),e.phone_number_1&&(0,N.jsxs)("div",{children:[(0,N.jsx)(B.QFc,{size:12,style:{marginRight:"5px"}}),e.phone_number_1]})]})]},e.airtable_id)))})]}),(0,N.jsx)("div",{style:{background:"#222",padding:"15px",borderRadius:"4px",marginBottom:"15px",maxWidth:"100%",boxSizing:"border-box"},children:null!==c&&void 0!==c&&c.airtable_id?(0,N.jsxs)(N.Fragment,{children:[(0,N.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",marginBottom:"15px",alignItems:"center"},children:[(0,N.jsx)("div",{style:{fontSize:"16px",fontWeight:"bold"},children:"Linked Airtable Contact"}),(0,N.jsxs)("button",{onClick:async()=>{if(c&&c.airtable_id)try{const{error:e}=await D.supabase.from("contacts").update({airtable_id:null}).eq("contact_id",c.contact_id);return e?(console.error("Error disassociating Airtable contact:",e),!1):(d((e=>({...e,airtable_id:null}))),p(null),!0)}catch(e){return console.error("Error in disassociateAirtableContact:",e),!1}},style:{background:"#ff4444",color:"white",border:"none",borderRadius:"4px",padding:"5px 10px",fontSize:"12px",cursor:"pointer",display:"flex",alignItems:"center",gap:"5px"},children:[(0,N.jsx)(B.yx1,{size:14})," Unlink"]})]}),u?(0,N.jsxs)("div",{style:{background:"#333",padding:"12px",borderRadius:"4px",display:"flex",flexDirection:"column",gap:"10px",maxWidth:"100%",boxSizing:"border-box",overflow:"hidden"},children:[(0,N.jsxs)("div",{style:{display:"flex",justifyContent:"space-between"},children:[(0,N.jsx)("div",{style:{color:"#999"},children:"Airtable ID:"}),(0,N.jsx)("div",{style:{color:"#4a9eff",fontWeight:"bold"},children:c.airtable_id})]}),(0,N.jsxs)("div",{style:{display:"flex",justifyContent:"space-between"},children:[(0,N.jsx)("div",{style:{color:"#999"},children:"Name:"}),(0,N.jsx)("div",{children:u.full_name})]}),u.primary_email&&(0,N.jsxs)("div",{style:{display:"flex",justifyContent:"space-between"},children:[(0,N.jsx)("div",{style:{color:"#999"},children:"Email:"}),(0,N.jsx)("div",{children:u.primary_email})]}),u.phone_number_1&&(0,N.jsxs)("div",{style:{display:"flex",justifyContent:"space-between"},children:[(0,N.jsx)("div",{style:{color:"#999"},children:"Phone 1:"}),(0,N.jsx)("div",{children:u.phone_number_1})]}),u.phone_number_2&&(0,N.jsxs)("div",{style:{display:"flex",justifyContent:"space-between"},children:[(0,N.jsx)("div",{style:{color:"#999"},children:"Phone 2:"}),(0,N.jsx)("div",{children:u.phone_number_2})]}),u.company&&(0,N.jsxs)("div",{style:{display:"flex",justifyContent:"space-between"},children:[(0,N.jsx)("div",{style:{color:"#999"},children:"Company:"}),(0,N.jsx)("div",{children:u.company})]}),u.linkedin&&(0,N.jsxs)("div",{style:{display:"flex",justifyContent:"space-between"},children:[(0,N.jsx)("div",{style:{color:"#999"},children:"LinkedIn:"}),(0,N.jsx)("div",{children:(0,N.jsx)("a",{href:u.linkedin,target:"_blank",rel:"noopener noreferrer",style:{color:"#4a9eff"},children:u.linkedin})})]})]}):(0,N.jsx)("div",{style:{textAlign:"center",color:"#999",padding:"10px",background:"#333",borderRadius:"4px"},children:"Loading Airtable data..."})]}):(0,N.jsx)("div",{style:{color:"#999",textAlign:"center",padding:"15px 0"},children:"No Airtable record associated with this contact. Use the search above to link one."})})]}),(0,N.jsx)(hA,{style:{marginTop:"30px",marginBottom:"20px",width:"calc(100% - 20px)",justifyContent:"flex-end"},children:(0,N.jsxs)(pA,{variant:"success",onClick:()=>_o("airtable_combining"),children:[(0,N.jsx)(B.YrT,{})," Save & Continue"]})})]}):"airtable_combining"===Co?(0,N.jsx)("div",{style:{padding:"0",width:"95%"},children:null!==c&&void 0!==c&&c.airtable_id&&u?(0,N.jsxs)(cR,{style:{width:"100%",padding:0,margin:0},children:[(0,N.jsx)("div",{style:{width:"100%"},children:(0,N.jsxs)("table",{style:{width:"100%",borderCollapse:"collapse",overflow:"hidden",marginTop:0},children:[(0,N.jsx)("thead",{children:(0,N.jsxs)("tr",{style:{background:"#333"},children:[(0,N.jsx)("th",{style:{padding:"9px 15px",textAlign:"left",borderBottom:"1px solid #444",width:"15%"},children:"Field Name"}),(0,N.jsx)("th",{style:{padding:"9px 15px",textAlign:"left",borderBottom:"1px solid #444",width:"28%"},children:"Supabase Now"}),(0,N.jsx)("th",{style:{padding:"9px 15px",textAlign:"left",borderBottom:"1px solid #444",width:"25%"},children:"Airtable"}),(0,N.jsx)("th",{style:{padding:"9px 15px",textAlign:"left",borderBottom:"1px solid #444",width:"32%"},children:"Supabase Final"})]})}),(0,N.jsxs)("tbody",{children:[(0,N.jsxs)("tr",{style:{borderBottom:"1px solid #333"},children:[(0,N.jsx)("td",{style:{padding:"12px 15px",color:"#999"},children:"Name"}),(0,N.jsx)("td",{style:{padding:"12px 15px"},children:c.isEditingFirstName?(0,N.jsx)(uR,{type:"text",value:c.first_name||"",onChange:e=>{const t={...c,first_name:e.target.value};d(t)},onKeyDown:e=>{if("Enter"===e.key){const e={...c,isEditingFirstName:!1};d(e)}},onBlur:()=>{const e={...c,isEditingFirstName:!1};d(e)},autoFocus:!0,style:{width:"100%",background:"transparent",border:"none",padding:"8px 12px",color:"#fff"}}):(0,N.jsx)("div",{onClick:()=>{const e={...c,isEditingFirstName:!0};d(e)},style:{cursor:"pointer",padding:"8px 12px",display:"flex",alignItems:"center"},children:(0,N.jsx)("span",{children:c.first_name||"-"})})}),(0,N.jsx)("td",{style:{padding:"12px 15px"},children:(0,N.jsxs)("div",{onClick:async()=>{if(u&&u.full_name){const t=u.full_name.split(" ")[0]||"";tn("firstName",t);try{const{error:e}=await D.supabase.from("contacts").update({first_name:t}).eq("contact_id",c.contact_id);e?(console.error("Error updating contact first name:",e),nt.Ay.error("Failed to update first name")):(nt.Ay.success("First name updated"),d({...c,first_name:t}))}catch(e){console.error("Exception updating contact first name:",e),nt.Ay.error("Failed to update first name")}}},style:{cursor:"pointer",padding:"8px 12px",display:"flex",alignItems:"center",justifyContent:"space-between"},children:[(0,N.jsx)("span",{children:u&&u.full_name&&u.full_name.split(" ")[0]||"-"}),(0,N.jsx)("span",{style:{color:"#00ff00",fontSize:"12px",marginLeft:"10px"},children:"\u2192"})]})}),(0,N.jsx)("td",{style:{padding:"12px 15px"},children:Tt.isEditingFirstName?(0,N.jsx)(uR,{type:"text",value:void 0!==Tt.firstName?Tt.firstName:c.first_name||"",onChange:e=>tn("firstName",e.target.value),onKeyDown:async e=>{if("Enter"===e.key){const e={...Tt,isEditingFirstName:!1};Dt(e);const o=Tt.firstName||c.first_name||"",n={...c,first_name:o};d(n);try{const{error:e}=await D.supabase.from("contacts").update({first_name:o}).eq("contact_id",c.contact_id);e?(console.error("Error updating contact first name:",e),nt.Ay.error("Failed to update first name")):nt.Ay.success("First name updated")}catch(t){console.error("Exception updating contact first name:",t),nt.Ay.error("Failed to update first name")}}},onBlur:()=>{const e={...Tt,isEditingFirstName:!1};Dt(e)},autoFocus:!0,style:{width:"100%",background:"transparent",border:"none",padding:"8px 12px",color:"#fff"}}):(0,N.jsxs)("div",{onClick:()=>{const e={...Tt,isEditingFirstName:!0};Dt(e)},style:{cursor:"pointer",padding:"8px 12px",display:"flex",justifyContent:"space-between",alignItems:"center"},children:[(0,N.jsx)("span",{children:void 0!==Tt.firstName?Tt.firstName:c.first_name||"-"}),void 0===Tt.firstName&&(0,N.jsx)("span",{style:{fontSize:"0.7rem",color:"#999",fontStyle:"italic",marginLeft:"auto"},children:"Same as Supabase Now"})]})})]}),(0,N.jsxs)("tr",{style:{borderBottom:"1px solid #333"},children:[(0,N.jsx)("td",{style:{padding:"12px 15px",color:"#999"},children:"Surname"}),(0,N.jsx)("td",{style:{padding:"12px 15px"},children:c.isEditingLastName?(0,N.jsx)(uR,{type:"text",value:c.last_name||"",onChange:e=>{const t={...c,last_name:e.target.value};d(t)},onKeyDown:e=>{if("Enter"===e.key){const e={...c,isEditingLastName:!1};d(e)}},onBlur:()=>{const e={...c,isEditingLastName:!1};d(e)},autoFocus:!0,style:{width:"100%",background:"transparent",border:"none",padding:"8px 12px",color:"#fff"}}):(0,N.jsx)("div",{onClick:()=>{const e={...c,isEditingLastName:!0};d(e)},style:{cursor:"pointer",padding:"8px 12px",display:"flex",alignItems:"center"},children:(0,N.jsx)("span",{children:c.last_name||"-"})})}),(0,N.jsx)("td",{style:{padding:"12px 15px"},children:(0,N.jsxs)("div",{onClick:async()=>{if(u&&u.full_name){const t=u.full_name.split(" "),o=t.length>1?t.slice(1).join(" "):"";tn("lastName",o);try{const{error:e}=await D.supabase.from("contacts").update({last_name:o}).eq("contact_id",c.contact_id);e?(console.error("Error updating contact last name:",e),nt.Ay.error("Failed to update last name")):(nt.Ay.success("Last name updated"),d({...c,last_name:o}))}catch(e){console.error("Exception updating contact last name:",e),nt.Ay.error("Failed to update last name")}}},style:{cursor:"pointer",padding:"8px 12px",display:"flex",alignItems:"center",justifyContent:"space-between"},children:[(0,N.jsx)("span",{children:u&&u.full_name&&u.full_name.split(" ").length>1&&u.full_name.split(" ").slice(1).join(" ")||"-"}),(0,N.jsx)("span",{style:{color:"#00ff00",fontSize:"12px",marginLeft:"10px"},children:"\u2192"})]})}),(0,N.jsx)("td",{style:{padding:"12px 15px"},children:Tt.isEditingLastName?(0,N.jsx)(uR,{type:"text",value:void 0!==Tt.lastName?Tt.lastName:c.last_name||"",onChange:e=>tn("lastName",e.target.value),onKeyDown:async e=>{if("Enter"===e.key){const e={...Tt,isEditingLastName:!1};Dt(e);const o=Tt.lastName||c.last_name||"",n={...c,last_name:o};d(n);try{const{error:e}=await D.supabase.from("contacts").update({last_name:o}).eq("contact_id",c.contact_id);e?(console.error("Error updating contact last name:",e),nt.Ay.error("Failed to update last name")):nt.Ay.success("Last name updated")}catch(t){console.error("Exception updating contact last name:",t),nt.Ay.error("Failed to update last name")}}},onBlur:()=>{const e={...Tt,isEditingLastName:!1};Dt(e)},autoFocus:!0,style:{width:"100%",background:"transparent",border:"none",padding:"8px 12px",color:"#fff"}}):(0,N.jsxs)("div",{onClick:()=>{const e={...Tt,isEditingLastName:!0};Dt(e)},style:{cursor:"pointer",padding:"8px 12px",display:"flex",justifyContent:"space-between",alignItems:"center"},children:[(0,N.jsx)("span",{children:void 0!==Tt.lastName?Tt.lastName:c.last_name||"-"}),void 0===Tt.lastName&&(0,N.jsx)("span",{style:{fontSize:"0.7rem",color:"#999",fontStyle:"italic",marginLeft:"auto"},children:"Same as Supabase Now"})]})})]}),(0,N.jsxs)("tr",{style:{borderBottom:"1px solid #333"},children:[(0,N.jsx)("td",{style:{padding:"12px 15px",color:"#999"},children:(0,N.jsxs)("a",{href:`https://mail.superhuman.com/search/${c.first_name||""}%20${c.last_name||""}`,target:"_blank",rel:"noopener noreferrer",style:{color:"#999",textDecoration:"none",display:"flex",alignItems:"center"},children:[(0,N.jsx)("span",{children:"Email"}),(0,N.jsx)("span",{style:{marginLeft:"5px",fontSize:"10px"},children:"\u2197"})]})}),(0,N.jsx)("td",{style:{padding:"12px 15px",minHeight:"50px",verticalAlign:"top"},children:(0,N.jsx)(fR,{children:c.emails&&c.emails.length>0?c.emails.map(((e,t)=>(0,N.jsx)(gR,{style:{cursor:"default",background:"transparent",display:"block",marginBottom:"8px"},children:e.email&&(0,N.jsxs)(N.Fragment,{children:[(0,N.jsx)("span",{children:e.email}),e.is_primary&&(0,N.jsx)("span",{title:"Primary Email",style:{fontSize:"10px",marginLeft:"3px"},children:"\u2605"}),e.type&&(0,N.jsxs)("span",{style:{fontSize:"0.8em",opacity:.8,marginLeft:"3px"},children:["(",e.type,")"]})]})},t))):c.email?(0,N.jsx)(gR,{style:{background:"transparent",cursor:"default"},children:c.email}):"-"})}),(0,N.jsx)("td",{style:{padding:"12px 15px",minHeight:"50px",verticalAlign:"top"},children:(0,N.jsx)(fR,{children:null!==u&&void 0!==u&&u.emails&&u.emails.length>0?u.emails.map(((e,t)=>{const o="string"===typeof e?e:e&&"object"===typeof e&&e.email?e.email:null;return o?(0,N.jsxs)(gR,{style:{cursor:"default",background:"transparent",display:"block",marginBottom:"8px"},children:[(0,N.jsx)("span",{children:o}),e&&"object"===typeof e&&e.is_primary&&(0,N.jsx)("span",{title:"Primary Email",style:{fontSize:"10px",marginLeft:"3px"},children:"\u2605"})]},t):null})):null!==u&&void 0!==u&&u.primary_email?(0,N.jsx)(gR,{style:{background:"transparent",cursor:"default"},children:u.primary_email}):"-"})}),(0,N.jsx)("td",{style:{padding:"12px 15px",minHeight:"50px",verticalAlign:"top"},children:(0,N.jsxs)(fR,{children:[c.emails&&c.emails.length>0?c.emails.map(((e,t)=>(0,N.jsxs)(gR,{style:{background:"transparent",cursor:"default",display:"block",marginBottom:"8px"},children:[(0,N.jsx)("span",{children:e.email}),e.is_primary&&(0,N.jsx)("span",{title:"Primary Email",style:{fontSize:"10px",marginLeft:"3px"},children:"\u2605"}),e.type&&(0,N.jsxs)("span",{style:{fontSize:"0.8em",opacity:.8,marginLeft:"3px"},children:["(",e.type,")"]})]},`contact-${t}`))):c.email?(0,N.jsxs)(gR,{style:{background:"transparent",cursor:"default",display:"block",marginBottom:"8px"},children:[(0,N.jsx)("span",{children:c.email}),(0,N.jsx)("span",{title:"Primary Email",style:{fontSize:"10px",marginLeft:"3px"},children:"\u2605"})]}):null,Tt.contactEmails&&Tt.contactEmails.length>0&&Tt.contactEmails.map(((e,t)=>{var o;return(null===(o=c.emails)||void 0===o?void 0:o.some((t=>t.email===e.email)))?null:(0,N.jsxs)(gR,{style:{background:"transparent",cursor:"default",display:"block",marginBottom:"8px"},children:[(0,N.jsx)("span",{children:e.email}),e.is_primary&&(0,N.jsx)("span",{title:"Primary Email",style:{fontSize:"10px",marginLeft:"3px"},children:"\u2605"}),e.type&&(0,N.jsxs)("span",{style:{fontSize:"0.8em",opacity:.8,marginLeft:"3px"},children:["(",e.type,")"]}),(0,N.jsx)("span",{onClick:()=>{const e=[...Tt.contactEmails];e.splice(t,1),tn("contactEmails",e)},title:"Remove email",style:{fontSize:"12px",marginLeft:"5px",color:"#00ff00",cursor:"pointer"},children:"\u2715"})]},`new-${t}`)})),!c.emails&&Tt.primaryEmail&&!c.email&&(0,N.jsxs)(gR,{style:{background:"transparent",cursor:"default",display:"block",marginBottom:"8px"},children:[(0,N.jsx)("span",{children:Tt.primaryEmail}),(0,N.jsx)("span",{title:"Primary Email",style:{fontSize:"10px",marginLeft:"3px"},children:"\u2605"}),(0,N.jsx)("span",{onClick:()=>tn("primaryEmail",null),title:"Remove email",style:{fontSize:"12px",marginLeft:"5px",color:"#00ff00",cursor:"pointer"},children:"\u2715"})]}),Tt.additionalEmails&&Tt.additionalEmails.length>0&&Tt.additionalEmails.map(((e,t)=>(0,N.jsxs)(gR,{style:{background:"transparent",cursor:"default",display:"block",marginBottom:"8px"},children:[(0,N.jsx)("span",{children:e}),(0,N.jsx)("span",{onClick:()=>{const e=[...Tt.additionalEmails];e.splice(t,1),tn("additionalEmails",e)},title:"Remove email",style:{fontSize:"12px",marginLeft:"5px",color:"#00ff00",cursor:"pointer"},children:"\u2715"})]},`additional-${t}`))),(0,N.jsx)(gR,{onClick:()=>Ve(!0),style:{background:"transparent",color:"#00ff00",cursor:"pointer",border:"none"},children:(0,N.jsx)("span",{style:{fontSize:"14px"},children:"+ Add Email"})})]})})]}),(0,N.jsxs)("tr",{style:{borderBottom:"1px solid #333"},children:[(0,N.jsx)("td",{style:{padding:"12px 15px",color:"#999"},children:(0,N.jsxs)("a",{href:`https://app.timelines.ai/?q=${c.last_name||""}%20${c.first_name||""}`,target:"_blank",rel:"noopener noreferrer",style:{color:"#999",textDecoration:"none",display:"flex",alignItems:"center"},children:[(0,N.jsx)("span",{children:"Mobiles"}),(0,N.jsx)("span",{style:{marginLeft:"5px",fontSize:"10px"},children:"\u2197"})]})}),(0,N.jsx)("td",{style:{padding:"12px 15px",minHeight:"50px",verticalAlign:"top"},children:(0,N.jsx)(fR,{children:c.mobiles&&c.mobiles.length>0?c.mobiles.map(((e,t)=>(0,N.jsxs)(gR,{style:{cursor:"default",background:"transparent",display:"block",marginBottom:"4px"},children:[(0,N.jsx)("span",{children:e.mobile}),e.is_primary&&(0,N.jsx)("span",{title:"Primary Mobile",style:{fontSize:"10px",marginLeft:"3px"},children:"\u2605"}),e.type&&(0,N.jsxs)("span",{style:{fontSize:"0.8em",opacity:.8,marginLeft:"3px"},children:["(",e.type,")"]})]},e.mobile_id||t))):c.mobile?(0,N.jsx)(gR,{style:{background:"transparent",cursor:"default",display:"block"},children:c.mobile}):"-"})}),(0,N.jsx)("td",{style:{padding:"12px 15px",minHeight:"50px",verticalAlign:"top"},children:(0,N.jsx)(fR,{children:null!==u&&void 0!==u&&u.phone_numbers&&u.phone_numbers.length>0?u.phone_numbers.map(((e,t)=>{const o="string"===typeof e?e:e&&"object"===typeof e&&e.number?e.number:null;return o?(0,N.jsxs)(gR,{style:{cursor:"default",background:"transparent",display:"block",marginBottom:"4px"},children:[(0,N.jsx)("span",{children:o}),e&&"object"===typeof e&&e.is_primary&&(0,N.jsx)("span",{title:"Primary Phone",style:{fontSize:"10px",marginLeft:"3px"},children:"\u2605"})]},t):null})):null!==u&&void 0!==u&&u.phone_number_1?(0,N.jsx)(gR,{style:{background:"transparent",cursor:"default",display:"block",marginBottom:"4px"},children:(0,N.jsx)("span",{children:u.phone_number_1})}):"-"})}),(0,N.jsx)("td",{style:{padding:"12px 15px",minHeight:"50px",verticalAlign:"top"},children:(0,N.jsxs)(fR,{children:[c.mobiles&&c.mobiles.length>0?c.mobiles.map(((e,t)=>(0,N.jsxs)(gR,{style:{background:"transparent",cursor:"default",display:"block",marginBottom:"4px"},children:[(0,N.jsx)("span",{children:e.mobile}),e.is_primary&&(0,N.jsx)("span",{title:"Primary Mobile",style:{fontSize:"10px",marginLeft:"3px"},children:"\u2605"}),e.type&&(0,N.jsxs)("span",{style:{fontSize:"0.8em",opacity:.8,marginLeft:"3px"},children:["(",e.type,")"]})]},`contact-${t}`))):c.mobile?(0,N.jsxs)(gR,{style:{background:"transparent",cursor:"default",display:"block"},children:[(0,N.jsx)("span",{children:c.mobile}),(0,N.jsx)("span",{title:"Primary Mobile",style:{fontSize:"10px",marginLeft:"3px"},children:"\u2605"})]}):null,Tt.contactMobiles&&Tt.contactMobiles.length>0&&Tt.contactMobiles.map(((e,t)=>{var o;return(null===(o=c.mobiles)||void 0===o?void 0:o.some((t=>t.mobile===e.mobile)))?null:(0,N.jsxs)(gR,{style:{background:"transparent",cursor:"default",display:"block",marginBottom:"4px"},children:[(0,N.jsx)("span",{children:e.mobile}),e.is_primary&&(0,N.jsx)("span",{title:"Primary Mobile",style:{fontSize:"10px",marginLeft:"3px"},children:"\u2605"}),e.type&&(0,N.jsxs)("span",{style:{fontSize:"0.8em",opacity:.8,marginLeft:"3px"},children:["(",e.type,")"]}),(0,N.jsx)("span",{onClick:()=>{const e=[...Tt.contactMobiles];e.splice(t,1),tn("contactMobiles",e)},title:"Remove mobile",style:{fontSize:"12px",marginLeft:"5px",color:"#00ff00",cursor:"pointer"},children:"\u2715"})]},`new-${t}`)})),!c.mobiles&&Tt.primaryPhone&&!c.mobile&&(0,N.jsxs)(gR,{style:{background:"transparent",cursor:"default",display:"block",marginBottom:"4px"},children:[(0,N.jsx)("span",{children:Tt.primaryPhone}),(0,N.jsx)("span",{title:"Primary Mobile",style:{fontSize:"10px",marginLeft:"3px"},children:"\u2605"}),(0,N.jsx)("span",{onClick:()=>tn("primaryPhone",null),title:"Remove mobile",style:{fontSize:"12px",marginLeft:"5px",color:"#00ff00",cursor:"pointer"},children:"\u2715"})]}),(0,N.jsx)(gR,{onClick:()=>Ue(!0),style:{background:"transparent",color:"#00ff00",cursor:"pointer",border:"none"},children:(0,N.jsx)("span",{style:{fontSize:"14px"},children:"+ Add Mobile"})})]})})]}),(0,N.jsxs)("tr",{style:{borderBottom:"1px solid #333"},children:[(0,N.jsx)("td",{style:{padding:"12px 15px",color:"#999"},children:"Keep in Touch"}),(0,N.jsx)("td",{style:{padding:"12px 15px"},children:(0,N.jsx)("div",{style:{cursor:"default",padding:"8px 12px"},children:c.keep_in_touch_frequency||"-"})}),(0,N.jsx)("td",{style:{padding:"12px 15px"},children:(0,N.jsxs)("div",{onClick:async()=>{if(u&&u.keep_in_touch){const t=u.keep_in_touch;tn("keepInTouch",t);const o={...c,keep_in_touch_frequency:t};d(o);try{const{error:e}=await D.supabase.from("contacts").update({keep_in_touch_frequency:t}).eq("contact_id",c.contact_id);e?(console.error("Error updating keep_in_touch_frequency:",e),nt.Ay.error("Failed to update keep in touch frequency")):nt.Ay.success("Keep in touch frequency updated")}catch(e){console.error("Exception updating keep_in_touch_frequency:",e),nt.Ay.error("Failed to update keep in touch frequency")}}},style:{cursor:"pointer",padding:"8px 12px",display:"flex",alignItems:"center",justifyContent:"space-between"},children:[(0,N.jsx)("span",{children:(null===u||void 0===u?void 0:u.keep_in_touch)||"-"}),(0,N.jsx)("span",{style:{color:"#00ff00",fontSize:"12px",marginLeft:"10px"},children:"\u2192"})]})}),(0,N.jsx)("td",{style:{padding:"12px 15px"},children:(0,N.jsx)("div",{style:{padding:"8px 12px"},children:(0,N.jsxs)(pR,{value:Tt.keepInTouch||c.keep_in_touch_frequency||"Not Set",onChange:async e=>{const t="Not Set"===e.target.value?null:e.target.value;tn("keepInTouch",t);const o={...c,keep_in_touch_frequency:t};d(o);try{console.log("Updating keep_in_touch_frequency to:",t),console.log("Contact ID:",c.contact_id),console.log("Current contact data:",c);const{data:e,error:o}=await D.supabase.from("contacts").update({keep_in_touch_frequency:t}).eq("contact_id",c.contact_id).select();o?(console.error("Error updating keep_in_touch_frequency:",o),nt.Ay.error("Failed to update keep in touch frequency")):(console.log("Successfully updated keep_in_touch_frequency, response:",e),nt.Ay.success("Keep in touch frequency updated"))}catch(n){console.error("Exception updating keep_in_touch_frequency:",n),nt.Ay.error("Failed to update keep in touch frequency")}},style:{background:"transparent",border:"none",color:"#fff",cursor:"pointer",width:"100%",padding:"0",fontSize:"14px"},children:[(0,N.jsx)("option",{value:"Not Set",children:"Not Set"}),(0,N.jsx)("option",{value:"Monthly",children:"Monthly"}),(0,N.jsx)("option",{value:"Quarterly",children:"Quarterly"}),(0,N.jsx)("option",{value:"Twice per Year",children:"Twice per Year"}),(0,N.jsx)("option",{value:"Once per Year",children:"Once per Year"}),(0,N.jsx)("option",{value:"Weekly",children:"Weekly"}),(0,N.jsx)("option",{value:"Do not keep in touch",children:"Do not keep in touch"})]})})})]}),(0,N.jsxs)("tr",{style:{borderBottom:"1px solid #333"},children:[(0,N.jsx)("td",{style:{padding:"12px 15px",color:"#999"},children:"Category"}),(0,N.jsx)("td",{style:{padding:"12px 15px"},children:(0,N.jsx)("div",{style:{cursor:"default",padding:"8px 12px"},children:c.category||"-"})}),(0,N.jsx)("td",{style:{padding:"12px 15px"},children:(0,N.jsxs)("div",{onClick:async()=>{if(u&&u.category){const t=u.category;tn("category",t);const o={...c,category:t};d(o);try{const{error:e}=await D.supabase.from("contacts").update({category:t}).eq("contact_id",c.contact_id);e?(console.error("Error updating category:",e),nt.Ay.error("Failed to update category")):nt.Ay.success("Category updated")}catch(e){console.error("Exception updating category:",e),nt.Ay.error("Failed to update category")}}},style:{cursor:"pointer",padding:"8px 12px",display:"flex",alignItems:"center",justifyContent:"space-between"},children:[(0,N.jsx)("span",{children:(null===u||void 0===u?void 0:u.category)||"-"}),(0,N.jsx)("span",{style:{color:"#00ff00",fontSize:"12px",marginLeft:"10px"},children:"\u2192"})]})}),(0,N.jsx)("td",{style:{padding:"12px 15px"},children:(0,N.jsx)("div",{style:{padding:"8px 12px"},children:(0,N.jsxs)(pR,{value:Tt.category||c.category||"",onChange:async e=>{const t=""===e.target.value?null:e.target.value;tn("category",t);const o={...c,category:t};d(o);try{console.log("Updating category to:",t),console.log("Contact ID:",c.contact_id);const{data:e,error:o}=await D.supabase.from("contacts").update({category:t}).eq("contact_id",c.contact_id).select();o?(console.error("Error updating category:",o),nt.Ay.error("Failed to update category")):(console.log("Successfully updated category, response:",e),nt.Ay.success("Category updated"))}catch(n){console.error("Exception updating category:",n),nt.Ay.error("Failed to update category")}},style:{background:"transparent",border:"none",color:"#fff",cursor:"pointer",width:"100%",padding:"0",fontSize:"14px"},children:[(0,N.jsx)("option",{value:"Inbox",children:"Inbox"}),(0,N.jsx)("option",{value:"Professional Investor",children:"Professional Investor"}),(0,N.jsx)("option",{value:"Team",children:"Team"}),(0,N.jsx)("option",{value:"Advisor",children:"Advisor"}),(0,N.jsx)("option",{value:"Supplier",children:"Supplier"}),(0,N.jsx)("option",{value:"System",children:"System"}),(0,N.jsx)("option",{value:"Founder",children:"Founder"}),(0,N.jsx)("option",{value:"Manager",children:"Manager"}),(0,N.jsx)("option",{value:"Friend and Family",children:"Friend and Family"}),(0,N.jsx)("option",{value:"Other",children:"Other"}),(0,N.jsx)("option",{value:"Student",children:"Student"}),(0,N.jsx)("option",{value:"Media",children:"Media"}),(0,N.jsx)("option",{value:"Institution",children:"Institution"})]})})})]}),(0,N.jsxs)("tr",{style:{borderBottom:"1px solid #333"},children:[(0,N.jsx)("td",{style:{padding:"12px 15px",color:"#999"},children:"Cities"}),(0,N.jsx)("td",{style:{padding:"12px 15px"},children:(0,N.jsx)(fR,{children:Tt.cities&&Tt.cities.length>0?Tt.cities.map(((e,t)=>(0,N.jsx)(gR,{style:{background:"transparent",border:"1px solid #00ff00",borderRadius:"4px",padding:"4px 8px",margin:"2px",display:"inline-flex",alignItems:"center"},children:(0,N.jsx)("span",{children:e.name})},`formdata-city-${t}`))):c.cities&&c.cities.length>0?c.cities.map(((e,t)=>(0,N.jsx)(gR,{style:{background:"transparent",border:"1px solid #00ff00",borderRadius:"4px",padding:"4px 8px",margin:"2px",display:"inline-flex",alignItems:"center"},children:(0,N.jsx)("span",{children:e.name})},`contact-city-${t}`))):"-"})}),(0,N.jsx)("td",{style:{padding:"12px 15px"},children:(0,N.jsx)(fR,{children:null!==u&&void 0!==u&&u.city?u.city.split(",").map(((e,t)=>{const o=e.trim();return o?(0,N.jsxs)(gR,{style:{background:"transparent",border:"1px solid #00ff00",borderRadius:"4px",padding:"4px 8px",margin:"2px",display:"inline-flex",alignItems:"center",cursor:"pointer"},onClick:async()=>{try{const{data:e,error:t}=await D.supabase.from("cities").select("city_id").ilike("name",o).maybeSingle();if(t)return console.error("Error searching for city:",t),void nt.Ay.error("Failed to search for city");let n;if(e)n=e.city_id;else{const{data:e,error:t}=await D.supabase.from("cities").insert({name:o}).select("city_id").single();if(t)return console.error("Error creating city:",t),void nt.Ay.error("Failed to create city");n=e.city_id}const{data:r,error:i}=await D.supabase.from("contact_cities").select("entry_id").eq("contact_id",c.contact_id).eq("city_id",n).maybeSingle();if(i)return console.error("Error checking contact city:",i),void nt.Ay.error("Failed to check city link");if(r)nt.Ay.info(`City "${o}" already exists on contact`);else{const{error:e}=await D.supabase.from("contact_cities").insert({contact_id:c.contact_id,city_id:n});if(e)return console.error("Error linking city to contact:",e),void nt.Ay.error("Failed to add city");const t={...c};t.cities||(t.cities=[]),t.cities.push({city_id:n,name:o}),d(t),Tt.cities&&Dt({...Tt,cities:[...Tt.cities,{city_id:n,name:o}]}),nt.Ay.success(`City "${o}" added`)}}catch(e){console.error("Exception handling city:",e),nt.Ay.error("Failed to process city")}},children:[(0,N.jsx)("span",{children:o}),(0,N.jsx)("span",{style:{color:"#00ff00",fontSize:"12px",marginLeft:"5px"},children:"\u2192"})]},`airtable-city-${t}`):null})).filter(Boolean):"-"})}),(0,N.jsx)("td",{style:{padding:"12px 15px"},children:(0,N.jsxs)(fR,{children:[Tt.cities&&Tt.cities.length>0?Tt.cities.map(((e,t)=>(0,N.jsxs)(gR,{style:{background:"transparent",border:"1px solid #00ff00",borderRadius:"4px",padding:"4px 8px",margin:"2px",display:"inline-flex",alignItems:"center"},children:[(0,N.jsx)("span",{children:e.name}),(0,N.jsx)("span",{onClick:async()=>{try{const o=Tt.cities.filter(((e,o)=>o!==t));tn("cities",o);const{error:n}=await D.supabase.from("contact_cities").delete().eq("contact_id",c.contact_id).eq("city_id",e.city_id);if(n)console.error("Error removing city from contact:",n),nt.Ay.error("Failed to remove city");else{const t={...c};t.cities&&(t.cities=t.cities.filter((t=>t.city_id!==e.city_id)),d(t)),nt.Ay.success(`City "${e.name}" removed`)}}catch(o){console.error("Exception removing city:",o),nt.Ay.error("Failed to remove city")}},title:"Remove city",style:{fontSize:"12px",marginLeft:"5px",color:"#00ff00",cursor:"pointer"},children:"\u2715"})]},`formdata-city-edit-${t}`))):c.cities&&c.cities.length>0?c.cities.map(((e,t)=>(0,N.jsxs)(gR,{style:{background:"transparent",border:"1px solid #00ff00",borderRadius:"4px",padding:"4px 8px",margin:"2px",display:"inline-flex",alignItems:"center"},children:[(0,N.jsx)("span",{children:e.name}),(0,N.jsx)("span",{onClick:async()=>{try{const{error:t}=await D.supabase.from("contact_cities").delete().eq("contact_id",c.contact_id).eq("city_id",e.city_id);if(t)console.error("Error removing city from contact:",t),nt.Ay.error("Failed to remove city");else{const t={...c};t.cities=t.cities.filter((t=>t.city_id!==e.city_id)),d(t),nt.Ay.success(`City "${e.name}" removed`)}}catch(t){console.error("Exception removing city:",t),nt.Ay.error("Failed to remove city")}},title:"Remove city",style:{fontSize:"12px",marginLeft:"5px",color:"#00ff00",cursor:"pointer"},children:"\u2715"})]},`contact-city-edit-${t}`))):"-",(0,N.jsxs)(gR,{style:{background:"transparent",color:"#00ff00",cursor:"pointer",border:"none",padding:"4px 8px"},onClick:async()=>{const e=prompt("Enter new city:");if(!e||!e.trim())return;const t=e.trim();try{const{data:e,error:o}=await D.supabase.from("cities").select("city_id").ilike("name",t).maybeSingle();if(o)return console.error("Error searching for city:",o),void nt.Ay.error("Failed to search for city");let n;if(e)n=e.city_id;else{const{data:e,error:o}=await D.supabase.from("cities").insert({name:t}).select("city_id").single();if(o)return console.error("Error creating city:",o),void nt.Ay.error("Failed to create city");n=e.city_id}const{data:r,error:i}=await D.supabase.from("contact_cities").select("entry_id").eq("contact_id",c.contact_id).eq("city_id",n).maybeSingle();if(i)return console.error("Error checking contact city:",i),void nt.Ay.error("Failed to check city link");if(r)nt.Ay.info(`City "${t}" already exists on contact`);else{const{error:e}=await D.supabase.from("contact_cities").insert({contact_id:c.contact_id,city_id:n});if(e)return console.error("Error linking city to contact:",e),void nt.Ay.error("Failed to add city");const o={...c};o.cities||(o.cities=[]),o.cities.push({city_id:n,name:t}),d(o),nt.Ay.success(`City "${t}" added`)}}catch(o){console.error("Exception handling city:",o),nt.Ay.error("Failed to process city")}},onClick:()=>qe(!0),children:[(0,N.jsx)("span",{style:{fontSize:"16px"},children:"+"})," Add City"]})]})})]}),(0,N.jsxs)("tr",{style:{borderBottom:"1px solid #333"},children:[console.log("FULL CONTACT OBJECT:",c),(0,N.jsx)("td",{style:{padding:"12px 15px",color:"#999"},children:"Tags"}),(0,N.jsx)("td",{style:{padding:"12px 15px"},children:(0,N.jsx)(fR,{children:Tt.tags&&Tt.tags.length>0?Tt.tags.map(((e,t)=>(0,N.jsx)(gR,{style:{background:"transparent",border:"1px solid #00ff00",borderRadius:"4px",padding:"4px 8px",margin:"2px",display:"inline-flex",alignItems:"center"},children:(0,N.jsx)("span",{children:e.name})},`formdata-tag-${t}`))):c.tags&&c.tags.length>0?c.tags.map(((e,t)=>(0,N.jsx)(gR,{style:{background:"transparent",border:"1px solid #00ff00",borderRadius:"4px",padding:"4px 8px",margin:"2px",display:"inline-flex",alignItems:"center"},children:(0,N.jsx)("span",{children:e.name})},`contact-tag-${t}`))):"-"})}),(0,N.jsx)("td",{style:{padding:"12px 15px"},children:(0,N.jsx)(fR,{children:null!==u&&void 0!==u&&u.keywords?u.keywords.split(",").map(((e,t)=>{const o=e.trim();return o?(0,N.jsxs)(gR,{style:{background:"transparent",border:"1px solid #00ff00",borderRadius:"4px",padding:"4px 8px",margin:"2px",display:"inline-flex",alignItems:"center",cursor:"pointer"},onClick:async()=>{try{const{data:e,error:t}=await D.supabase.from("tags").select("tag_id").eq("name",o).maybeSingle();if(t)return console.error("Error searching for tag:",t),void nt.Ay.error("Failed to search for tag");let n;if(e)n=e.tag_id;else{const{data:e,error:t}=await D.supabase.from("tags").insert({name:o}).select("tag_id").single();if(t)return console.error("Error creating tag:",t),void nt.Ay.error("Failed to create tag");n=e.tag_id}const{data:r,error:i}=await D.supabase.from("contact_tags").select("entry_id").eq("contact_id",c.contact_id).eq("tag_id",n).maybeSingle();if(i)return console.error("Error checking contact tag:",i),void nt.Ay.error("Failed to check if tag exists");if(r)nt.Ay.info(`Tag "${o}" already exists on contact`);else{const{error:e}=await D.supabase.from("contact_tags").insert({contact_id:c.contact_id,tag_id:n});if(e)return console.error("Error linking tag to contact:",e),void nt.Ay.error("Failed to add tag to contact");const t={...c};if(t.tags||(t.tags=[]),t.tags.push({tag_id:n,name:o}),d(t),Tt.tags){const e={...Tt};e.tags=[...Tt.tags,{tag_id:n,name:o}],Dt(e)}nt.Ay.success(`Tag "${o}" added to contact`),setTimeout((()=>{const e={...t};d(e)}),100)}}catch(e){console.error("Exception handling tag:",e),nt.Ay.error("Failed to process tag")}},children:[(0,N.jsx)("span",{children:o}),(0,N.jsx)("span",{style:{color:"#00ff00",fontSize:"12px",marginLeft:"5px"},children:"\u2192"})]},`airtable-tag-${t}`):null})).filter(Boolean):"-"})}),(0,N.jsx)("td",{style:{padding:"12px 15px"},children:(0,N.jsxs)(fR,{children:[Tt.tags&&Tt.tags.length>0?Tt.tags.map(((e,t)=>(0,N.jsxs)(gR,{style:{background:"transparent",border:"1px solid #00ff00",borderRadius:"4px",padding:"4px 8px",margin:"2px",display:"inline-flex",alignItems:"center"},children:[(0,N.jsx)("span",{children:e.name}),(0,N.jsx)("span",{onClick:async()=>{try{const o=Tt.tags.filter(((e,o)=>o!==t));tn("tags",o);const{error:n}=await D.supabase.from("contact_tags").delete().eq("contact_id",c.contact_id).eq("tag_id",e.tag_id);if(n)console.error("Error removing tag from contact:",n),nt.Ay.error("Failed to remove tag");else{const t={...c};t.tags&&(t.tags=t.tags.filter((t=>t.tag_id!==e.tag_id)),d(t)),nt.Ay.success(`Tag "${e.name}" removed`)}}catch(o){console.error("Exception removing tag:",o),nt.Ay.error("Failed to remove tag")}},title:"Remove tag",style:{fontSize:"12px",marginLeft:"5px",color:"#00ff00",cursor:"pointer"},children:"\u2715"})]},`formdata-tag-${t}`))):c.tags&&c.tags.length>0?c.tags.map(((e,t)=>(0,N.jsxs)(gR,{style:{background:"transparent",border:"1px solid #00ff00",borderRadius:"4px",padding:"4px 8px",margin:"2px",display:"inline-flex",alignItems:"center"},children:[(0,N.jsx)("span",{children:e.name}),(0,N.jsx)("span",{onClick:async()=>{try{const{error:t}=await D.supabase.from("contact_tags").delete().eq("contact_id",c.contact_id).eq("tag_id",e.tag_id);if(t)console.error("Error removing tag from contact:",t),nt.Ay.error("Failed to remove tag");else{const t={...c};t.tags=t.tags.filter((t=>t.tag_id!==e.tag_id)),d(t),nt.Ay.success(`Tag "${e.name}" removed`)}}catch(t){console.error("Exception removing tag:",t),nt.Ay.error("Failed to remove tag")}},title:"Remove tag",style:{fontSize:"12px",marginLeft:"5px",color:"#00ff00",cursor:"pointer"},children:"\u2715"})]},`contact-tag-${t}`))):"-",(0,N.jsxs)(gR,{style:{background:"transparent",color:"#00ff00",cursor:"pointer",border:"none",padding:"4px 8px"},onClick:async()=>{const e=prompt("Enter new tag:");if(!e||!e.trim())return;const t=e.trim();try{const{data:e,error:o}=await D.supabase.from("tags").select("tag_id").eq("name",t).maybeSingle();if(o)return console.error("Error searching for tag:",o),void nt.Ay.error("Failed to search for tag");let n;if(e)n=e.tag_id;else{const{data:e,error:o}=await D.supabase.from("tags").insert({name:t}).select("tag_id").single();if(o)return console.error("Error creating tag:",o),void nt.Ay.error("Failed to create tag");n=e.tag_id}const{data:r,error:i}=await D.supabase.from("contact_tags").select("entry_id").eq("contact_id",c.contact_id).eq("tag_id",n).maybeSingle();if(i)return console.error("Error checking contact tag:",i),void nt.Ay.error("Failed to check if tag exists");if(r)nt.Ay.info(`Tag "${t}" already exists on contact`);else{const{error:e}=await D.supabase.from("contact_tags").insert({contact_id:c.contact_id,tag_id:n});if(e)return console.error("Error linking tag to contact:",e),void nt.Ay.error("Failed to add tag to contact");const o={...c};o.tags||(o.tags=[]),o.tags.push({tag_id:n,name:t}),d(o),nt.Ay.success(`Tag "${t}" added to contact`)}}catch(o){console.error("Exception handling tag:",o),nt.Ay.error("Failed to process tag")}},onClick:()=>Ye(!0),children:[(0,N.jsx)("span",{style:{fontSize:"16px"},children:"+"})," Add Tag"]})]})})]}),(0,N.jsxs)("tr",{style:{borderBottom:"1px solid #333"},children:[(0,N.jsx)("td",{style:{padding:"12px 15px",color:"#999"},children:"Rating"}),(0,N.jsx)("td",{style:{padding:"12px 15px"},children:(0,N.jsx)("div",{style:{padding:"8px 12px",display:"flex",alignItems:"center"},children:[1,2,3,4,5].map((e=>(0,N.jsx)("span",{style:{color:(c.score||0)>=e?"#00ff00":"#333",fontSize:"16px",marginRight:"3px",cursor:"default",WebkitTextStroke:(c.score||0)>=e?"none":"1px #555",textShadow:"none"},children:"\u2605"},e)))})}),(0,N.jsx)("td",{style:{padding:"12px 15px"},children:(0,N.jsxs)("div",{onClick:async()=>{if(u&&u.rating){const t=u.rating;tn("score",t);try{const{error:e}=await D.supabase.from("contacts").update({score:t}).eq("contact_id",c.contact_id);e?(console.error("Error updating rating:",e),nt.Ay.error("Failed to update rating")):(nt.Ay.success("Rating updated"),d({...c,score:t}))}catch(e){console.error("Exception updating rating:",e),nt.Ay.error("Failed to update rating")}}},style:{cursor:"pointer",padding:"8px 12px",display:"flex",alignItems:"center",justifyContent:"space-between"},children:[(0,N.jsx)("div",{style:{display:"flex",alignItems:"center"},children:[1,2,3,4,5].map((e=>(0,N.jsx)("span",{style:{color:((null===u||void 0===u?void 0:u.rating)||0)>=e?"#00ff00":"#333",fontSize:"16px",marginRight:"3px",WebkitTextStroke:((null===u||void 0===u?void 0:u.rating)||0)>=e?"none":"1px #555",textShadow:"none"},children:"\u2605"},e)))}),(null===u||void 0===u?void 0:u.rating)&&(0,N.jsx)("span",{style:{color:"#00ff00",fontSize:"12px",marginLeft:"10px"},children:"\u2192"})]})}),(0,N.jsx)("td",{style:{padding:"12px 15px"},children:(0,N.jsx)("div",{style:{padding:"8px 12px",display:"flex",alignItems:"center"},children:[1,2,3,4,5].map((e=>(0,N.jsx)("span",{onClick:async()=>{let t;t=e===(Tt.score||c.score)?null:e,tn("score",t);try{const{data:e,error:o}=await D.supabase.from("contacts").update({score:t}).eq("contact_id",c.contact_id);o?(console.error("Error saving rating:",o),nt.Ay.error("Failed to save rating"),tn("score",c.score)):(nt.Ay.success("Rating "+(t?`set to ${t}`:"cleared")),d((e=>({...e,score:t}))))}catch(o){console.error("Exception saving rating:",o),nt.Ay.error("Failed to save rating"),tn("score",c.score)}},style:{color:(void 0!==Tt.score?Tt.score:c.score||0)>=e?"#00ff00":"#333",fontSize:"16px",marginRight:"3px",cursor:"pointer",WebkitTextStroke:(void 0!==Tt.score?Tt.score:c.score||0)>=e?"none":"1px #555",textShadow:"none"},children:"\u2605"},e)))})})]}),(0,N.jsxs)("tr",{style:{borderBottom:"1px solid #333"},children:[(0,N.jsx)("td",{style:{padding:"12px 15px",color:"#999"},children:"Description"}),(0,N.jsx)("td",{style:{padding:"12px 15px"},children:(0,N.jsx)("div",{style:{padding:"8px 12px",display:"flex",alignItems:"flex-start"},children:(0,N.jsx)("div",{children:c.description?c.isDescriptionExpanded?c.description:`${c.description.substring(0,50)}${c.description.length>50?"...":""}`:"-"})})}),(0,N.jsx)("td",{style:{padding:"12px 15px"},children:(0,N.jsxs)("div",{onClick:async()=>{if(u&&u.description){const t=u.description;tn("description",t);try{const{error:e}=await D.supabase.from("contacts").update({description:t}).eq("contact_id",c.contact_id);e?(console.error("Error updating description:",e),nt.Ay.error("Failed to update description")):(nt.Ay.success("Description updated"),d({...c,description:t}))}catch(e){console.error("Exception updating description:",e),nt.Ay.error("Failed to update description")}}},style:{cursor:"pointer",padding:"8px 12px",display:"flex",alignItems:"flex-start",justifyContent:"space-between"},children:[(0,N.jsx)("div",{children:null!==u&&void 0!==u&&u.description?u.isDescriptionExpanded?u.description:`${u.description.substring(0,50)}${u.description.length>50?"...":""}`:"-"}),(0,N.jsx)("span",{style:{color:"#00ff00",fontSize:"12px",marginLeft:"10px"},children:"\u2192"})]})}),(0,N.jsx)("td",{style:{padding:"12px 15px"},children:Tt.isEditingDescription?(0,N.jsx)("textarea",{value:void 0!==Tt.description?Tt.description:c.description||"",onChange:e=>tn("description",e.target.value),onKeyDown:async e=>{if("Enter"===e.key&&e.ctrlKey){const e={...Tt,isEditingDescription:!1};Dt(e);try{const e=void 0!==Tt.description?Tt.description:c.description||"",{data:t,error:o}=await D.supabase.from("contacts").update({description:e}).eq("contact_id",c.contact_id);o?(console.error("Error saving description (final):",o),nt.Ay.error("Failed to save description")):(nt.Ay.success("Description saved successfully"),d((t=>({...t,description:e}))))}catch(t){console.error("Exception saving description (final):",t),nt.Ay.error("Failed to save description")}}},onBlur:async()=>{const e={...Tt,isEditingDescription:!1};Dt(e);try{const e=void 0!==Tt.description?Tt.description:c.description||"",{data:t,error:o}=await D.supabase.from("contacts").update({description:e}).eq("contact_id",c.contact_id);o?(console.error("Error saving description (final):",o),nt.Ay.error("Failed to save description")):(nt.Ay.success("Description saved successfully"),d((t=>({...t,description:e}))))}catch(t){console.error("Exception saving description (final):",t),nt.Ay.error("Failed to save description")}},autoFocus:!0,style:{width:"100%",background:"transparent",border:"none",padding:"8px 12px",color:"#fff",minHeight:"80px",resize:"vertical"}}):(0,N.jsxs)("div",{onClick:()=>{const e={...Tt,isEditingDescription:!0};Dt(e)},style:{cursor:"pointer",padding:"8px 12px",display:"flex",justifyContent:"space-between",alignItems:"flex-start"},children:[(0,N.jsx)("div",{children:void 0!==Tt.description||c.description?Tt.isDescriptionExpanded?Tt.description||c.description:`${(Tt.description||c.description||"").substring(0,50)}${(Tt.description||c.description||"").length>50?"...":""}`:"-"}),void 0===Tt.description&&(0,N.jsx)("span",{style:{fontSize:"0.7rem",color:"#999",fontStyle:"italic",marginLeft:"auto"},children:"Same as Supabase Now"})]})})]}),(0,N.jsxs)("tr",{style:{borderBottom:"1px solid #333"},children:[(0,N.jsx)("td",{style:{padding:"12px 15px",color:"#999"},children:"Birthday"}),(0,N.jsx)("td",{style:{padding:"12px 15px"},children:(0,N.jsx)("div",{style:{padding:"8px 12px"},children:c.birthday||"-"})}),(0,N.jsx)("td",{style:{padding:"12px 15px"},children:(0,N.jsxs)("div",{onClick:()=>{u&&u.next_birthday&&tn("birthday",u.next_birthday)},style:{cursor:null!==u&&void 0!==u&&u.next_birthday?"pointer":"default",padding:"8px 12px",display:"flex",alignItems:"center",justifyContent:"space-between"},children:[(0,N.jsx)("div",{children:(null===u||void 0===u?void 0:u.next_birthday)||"-"}),(null===u||void 0===u?void 0:u.next_birthday)&&(0,N.jsx)("span",{style:{color:"#00ff00",fontSize:"12px",marginLeft:"10px"},title:"Transfer to Supabase Final",children:"\u2192"})]})}),(0,N.jsx)("td",{style:{padding:"12px 15px"},children:(0,N.jsx)("div",{style:{padding:"8px 12px",display:"flex",alignItems:"center",gap:"10px"},children:Tt.isEditingBirthday?(0,N.jsxs)("div",{style:{display:"flex",flexDirection:"column",gap:"8px"},children:[(0,N.jsx)("input",{type:"date",value:Tt.birthday||"",onChange:async e=>{const t=e.target.value;tn("birthday",t);try{const{data:e,error:o}=await D.supabase.from("contacts").update({birthday:t}).eq("contact_id",c.contact_id);o?(console.error("Error saving birthday:",o),nt.Ay.error("Failed to save birthday")):(nt.Ay.success("Birthday saved successfully"),d((e=>({...e,birthday:t}))))}catch(o){console.error("Exception saving birthday:",o),nt.Ay.error("Failed to save birthday")}},style:{padding:"4px 8px",background:"#222",border:"1px solid #444",borderRadius:"4px",color:"#fff",fontSize:"14px"}}),(0,N.jsxs)("div",{style:{display:"flex",gap:"8px"},children:[(0,N.jsx)("button",{onClick:()=>{Dt((e=>({...e,isEditingBirthday:!1})))},style:{padding:"4px 8px",background:"transparent",border:"1px solid #444",borderRadius:"4px",color:"#ccc",cursor:"pointer",fontSize:"12px"},children:"Done"}),(0,N.jsx)("button",{onClick:async()=>{tn("birthday",null);try{const{data:e,error:t}=await D.supabase.from("contacts").update({birthday:null}).eq("contact_id",c.contact_id);t?(console.error("Error clearing birthday:",t),nt.Ay.error("Failed to clear birthday")):(nt.Ay.success("Birthday cleared successfully"),d((e=>({...e,birthday:null}))),Dt((e=>({...e,isEditingBirthday:!1}))))}catch(e){console.error("Exception clearing birthday:",e),nt.Ay.error("Failed to clear birthday")}},style:{padding:"4px 8px",background:"rgba(255, 50, 50, 0.2)",border:"1px solid #933",borderRadius:"4px",color:"#f99",cursor:"pointer",fontSize:"12px"},children:"Clear"})]})]}):(0,N.jsxs)(N.Fragment,{children:[(0,N.jsx)("div",{onClick:()=>{Dt((e=>({...e,isEditingBirthday:!0})))},style:{cursor:"pointer",flex:1},children:Tt.birthday||c.birthday||"-"}),(Tt.birthday||c.birthday)&&(0,N.jsx)("button",{onClick:async()=>{tn("birthday",null);try{const{data:e,error:t}=await D.supabase.from("contacts").update({birthday:null}).eq("contact_id",c.contact_id);t?(console.error("Error clearing birthday:",t),nt.Ay.error("Failed to clear birthday")):(nt.Ay.success("Birthday cleared successfully"),d((e=>({...e,birthday:null}))))}catch(e){console.error("Exception clearing birthday:",e),nt.Ay.error("Failed to clear birthday")}},style:{background:"transparent",border:"none",color:"#f77",cursor:"pointer",fontSize:"14px",padding:"2px 6px"},title:"Clear birthday",children:"\xd7"})]})})})]}),(0,N.jsxs)("tr",{style:{borderBottom:"1px solid #333"},children:[(0,N.jsx)("td",{style:{padding:"12px 15px",color:"#999"},children:(0,N.jsxs)("a",{href:`https://www.linkedin.com/search/results/people/?keywords=${c.first_name||""}%20${c.last_name||""}&sid=Avh`,target:"_blank",rel:"noopener noreferrer",style:{color:"#999",textDecoration:"none",display:"flex",alignItems:"center"},children:[(0,N.jsx)("span",{children:"LinkedIn"}),(0,N.jsx)("span",{style:{marginLeft:"5px",fontSize:"10px"},children:"\u2197"})]})}),(0,N.jsx)("td",{style:{padding:"12px 15px"},children:(0,N.jsx)("div",{style:{padding:"8px 12px"},children:c.linkedin?(0,N.jsxs)("a",{href:c.linkedin,target:"_blank",rel:"noopener noreferrer",style:{color:"#00a3ff",textDecoration:"none",display:"flex",alignItems:"center"},children:["Link",(0,N.jsx)("span",{style:{marginLeft:"5px",fontSize:"10px"},children:"\u2197"})]}):"-"})}),(0,N.jsx)("td",{style:{padding:"12px 15px"},children:(0,N.jsx)("div",{style:{cursor:"pointer",padding:"8px 12px",display:"flex",alignItems:"center",justifyContent:"space-between"},children:null!==u&&void 0!==u&&u.linkedin||null!==u&&void 0!==u&&u.linkedin_normalised?(0,N.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",width:"100%"},children:[(0,N.jsxs)("div",{children:[null!==u&&void 0!==u&&u.linkedin?(0,N.jsxs)("a",{href:u.linkedin,target:"_blank",rel:"noopener noreferrer",style:{color:"#00a3ff",textDecoration:"none",display:"flex",alignItems:"center"},onClick:e=>e.stopPropagation(),children:["Link",(0,N.jsx)("span",{style:{marginLeft:"5px",fontSize:"10px"},children:"\u2197"})]}):"-",(null===u||void 0===u?void 0:u.linkedin_normalised)&&(0,N.jsxs)("div",{style:{color:"#777",fontSize:"11px",marginTop:"4px"},children:["Normalized: ",u.linkedin_normalised]})]}),(0,N.jsx)("span",{style:{color:"#00ff00",fontSize:"12px",marginLeft:"10px",cursor:"pointer"},onClick:async()=>{const e=u.linkedin||u.linkedin_normalised||"";tn("linkedin",e);try{const{error:t}=await D.supabase.from("contacts").update({linkedin:e}).eq("contact_id",c.contact_id);t?(console.error("Error updating LinkedIn:",t),nt.Ay.error("Failed to update LinkedIn")):(nt.Ay.success("LinkedIn updated"),d({...c,linkedin:e}))}catch(t){console.error("Exception updating LinkedIn:",t),nt.Ay.error("Failed to update LinkedIn")}},children:"\u2192"})]}):"-"})}),(0,N.jsx)("td",{style:{padding:"12px 15px"},children:Tt.isEditingLinkedin?(0,N.jsx)("div",{style:{padding:"8px 12px"},children:(0,N.jsx)(uR,{type:"text",value:void 0!==Tt.linkedin?Tt.linkedin:c.linkedin||"",onChange:e=>tn("linkedin",e.target.value),onKeyDown:async e=>{if("Enter"===e.key){const e=void 0!==Tt.linkedin?Tt.linkedin:c.linkedin||"",o={...Tt,isEditingLinkedin:!1};Dt(o);try{const{error:t}=await D.supabase.from("contacts").update({linkedin:e}).eq("contact_id",c.contact_id);t?(console.error("Error updating LinkedIn:",t),nt.Ay.error("Failed to update LinkedIn")):(nt.Ay.success("LinkedIn updated"),d({...c,linkedin:e}))}catch(t){console.error("Exception updating LinkedIn:",t),nt.Ay.error("Failed to update LinkedIn")}}},onBlur:async()=>{const e=void 0!==Tt.linkedin?Tt.linkedin:c.linkedin||"",t={...Tt,isEditingLinkedin:!1};Dt(t);try{const{error:t}=await D.supabase.from("contacts").update({linkedin:e}).eq("contact_id",c.contact_id);t?(console.error("Error updating LinkedIn:",t),nt.Ay.error("Failed to update LinkedIn")):(nt.Ay.success("LinkedIn updated"),d({...c,linkedin:e}))}catch(o){console.error("Exception updating LinkedIn:",o),nt.Ay.error("Failed to update LinkedIn")}},autoFocus:!0,style:{width:"100%",background:"transparent",border:"none",color:"#fff",padding:"0"},placeholder:"Enter LinkedIn URL"})}):(0,N.jsx)("div",{style:{padding:"8px 12px",display:"flex",alignItems:"center",justifyContent:"space-between"},children:Tt.linkedin||c.linkedin?(0,N.jsxs)(N.Fragment,{children:[(0,N.jsxs)("a",{href:Tt.linkedin||c.linkedin,target:"_blank",rel:"noopener noreferrer",style:{color:"#00a3ff",textDecoration:"none",display:"flex",alignItems:"center"},onClick:e=>e.stopPropagation(),children:["Link",(0,N.jsx)("span",{style:{marginLeft:"5px",fontSize:"10px"},children:"\u2197"})]}),(0,N.jsx)("span",{style:{cursor:"pointer",fontSize:"14px",color:"#999",marginLeft:"10px"},onClick:()=>{const e={...Tt,isEditingLinkedin:!0};Dt(e)},title:"Edit",children:"\u270e"})]}):(0,N.jsx)("span",{style:{cursor:"pointer",color:"#999"},onClick:()=>{const e={...Tt,isEditingLinkedin:!0};Dt(e)},children:"Click to add LinkedIn URL"})})})]}),(0,N.jsxs)("tr",{style:{borderBottom:"1px solid #333"},children:[(0,N.jsx)("td",{style:{padding:"12px 15px",color:"#999"},children:(0,N.jsxs)("a",{onClick:()=>Pe(!0),style:{color:"#999",textDecoration:"none",display:"flex",alignItems:"center",cursor:"pointer"},children:[(0,N.jsx)("span",{children:"Job Role"}),(0,N.jsx)("span",{style:{marginLeft:"5px",fontSize:"10px"},children:"\u2197"})]})}),(0,N.jsx)("td",{style:{padding:"12px 15px"},children:(0,N.jsx)("div",{style:{padding:"8px 12px",display:"flex",alignItems:"center"},children:(0,N.jsx)("span",{children:c.job_role||"-"})})}),(0,N.jsx)("td",{style:{padding:"12px 15px"},children:(0,N.jsxs)("div",{onClick:async()=>{if(u&&u.job_role){tn("jobRole",u.job_role);try{const{error:e}=await D.supabase.from("contacts").update({job_role:u.job_role}).eq("contact_id",c.contact_id);e?(console.error("Error updating job role:",e),nt.Ay.error("Failed to update job role")):(nt.Ay.success("Job role updated from Airtable"),d((e=>({...e,job_role:u.job_role}))))}catch(e){console.error("Exception updating job role:",e),nt.Ay.error("An error occurred while updating job role")}}},style:{cursor:"pointer",padding:"8px 12px",display:"flex",alignItems:"center",justifyContent:"space-between"},children:[(0,N.jsx)("span",{children:(null===u||void 0===u?void 0:u.job_role)||"-"}),(0,N.jsx)("span",{style:{color:"#00ff00",fontSize:"12px",marginLeft:"10px"},children:"\u2192"})]})}),(0,N.jsx)("td",{style:{padding:"12px 15px"},children:Tt.isEditingJobRole?(0,N.jsx)(uR,{type:"text",value:void 0!==Tt.jobRole?Tt.jobRole:c.job_role||"",onChange:e=>tn("jobRole",e.target.value),onKeyDown:async e=>{if("Enter"===e.key){try{const{error:e}=await D.supabase.from("contacts").update({job_role:Tt.jobRole}).eq("contact_id",c.contact_id);e?(console.error("Error updating job role:",e),nt.Ay.error("Failed to update job role")):(nt.Ay.success("Job role updated successfully"),d((e=>({...e,job_role:Tt.jobRole}))))}catch(t){console.error("Exception updating job role:",t),nt.Ay.error("An error occurred while updating job role")}const e={...Tt,isEditingJobRole:!1};Dt(e)}},onBlur:async()=>{try{const{error:e}=await D.supabase.from("contacts").update({job_role:Tt.jobRole}).eq("contact_id",c.contact_id);e?(console.error("Error updating job role:",e),nt.Ay.error("Failed to update job role")):(nt.Ay.success("Job role updated successfully"),d((e=>({...e,job_role:Tt.jobRole}))))}catch(t){console.error("Exception updating job role:",t),nt.Ay.error("An error occurred while updating job role")}const e={...Tt,isEditingJobRole:!1};Dt(e)},autoFocus:!0,style:{width:"100%",background:"transparent",border:"none",padding:"8px 12px",color:"#fff"}}):(0,N.jsx)("div",{onClick:()=>{const e={...Tt,isEditingJobRole:!0};Dt(e)},style:{cursor:"pointer",padding:"8px 12px",display:"flex",justifyContent:"space-between",alignItems:"center"},children:(0,N.jsx)("span",{children:void 0!==Tt.jobRole?Tt.jobRole:c.job_role||"-"})})})]}),(0,N.jsxs)("tr",{style:{borderBottom:"1px solid #333"},children:[(0,N.jsx)("td",{style:{padding:"12px 15px",color:"#999"},children:"Companies"}),(0,N.jsx)("td",{style:{padding:"12px 15px"},children:(0,N.jsx)(fR,{children:to&&to.length>0?to.map(((e,t)=>(0,N.jsx)(gR,{style:{background:"transparent",border:"1px solid #00ff00",borderRadius:"4px",padding:"4px 8px",margin:"2px",display:"inline-flex",alignItems:"center"},children:(0,N.jsx)("span",{children:e.name})},`contact-company-${t}`))):"-"})}),(0,N.jsx)("td",{style:{padding:"12px 15px"},children:(0,N.jsx)(fR,{children:null!==u&&void 0!==u&&u.company?u.company.split(",").map(((e,t)=>{const o=e.trim();return o?(0,N.jsxs)(gR,{style:{background:"transparent",border:"1px solid #00ff00",borderRadius:"4px",padding:"4px 8px",margin:"2px",display:"inline-flex",alignItems:"center",cursor:"pointer"},onClick:async()=>{try{const{data:e,error:t}=await D.supabase.from("companies").select("company_id").ilike("name",o).maybeSingle();if(t)return console.error("Error searching for company:",t),void nt.Ay.error("Failed to search for company");let n;if(e)n=e.company_id;else{const{data:e,error:t}=await D.supabase.from("companies").insert({name:o,category:"Inbox"}).select("company_id").single();if(t)return console.error("Error creating company:",t),void nt.Ay.error("Failed to create company");n=e.company_id}const{data:r,error:i}=await D.supabase.from("contact_companies").select("contact_companies_id").eq("contact_id",c.contact_id).eq("company_id",n).maybeSingle();if(i)return console.error("Error checking contact company:",i),void nt.Ay.error("Failed to check company link");if(r)nt.Ay.info(`Company "${o}" already linked`);else{const{error:e}=await D.supabase.from("contact_companies").insert({contact_id:c.contact_id,company_id:n});if(e)return console.error("Error linking company to contact:",e),void nt.Ay.error("Failed to add company");const t={...c};t.companies||(t.companies=[]),t.companies.push({company_id:n,name:o}),d(t),Tt.companies&&Dt({...Tt,companies:[...Tt.companies,{company_id:n,name:o}]}),nt.Ay.success(`Company "${o}" added`)}}catch(e){console.error("Exception handling company:",e),nt.Ay.error("Failed to process company")}},children:[(0,N.jsx)("span",{children:o}),(0,N.jsx)("span",{style:{color:"#00ff00",fontSize:"12px",marginLeft:"5px"},children:"\u2192"})]},`airtable-company-${t}`):null})).filter(Boolean):"-"})}),(0,N.jsx)("td",{style:{padding:"12px 15px"},children:(0,N.jsxs)(fR,{children:[to&&to.length>0?to.map(((e,t)=>(0,N.jsxs)(gR,{style:{background:"transparent",border:"1px solid #00ff00",borderRadius:"4px",padding:"4px 8px",margin:"2px",display:"inline-flex",alignItems:"center"},children:[(0,N.jsx)("span",{children:e.name}),(0,N.jsx)("span",{onClick:async()=>{try{const{error:t}=await D.supabase.from("contact_companies").delete().eq("contact_id",c.contact_id).eq("company_id",e.company_id);t?(console.error("Error removing company from contact:",t),nt.Ay.error("Failed to remove company")):(oo((t=>t.filter((t=>t.company_id!==e.company_id)))),nt.Ay.success(`Company "${e.name}" removed`),setTimeout((()=>mo()),300))}catch(t){console.error("Exception removing company:",t),nt.Ay.error("Failed to remove company")}},title:"Remove company",style:{fontSize:"12px",marginLeft:"5px",color:"#00ff00",cursor:"pointer"},children:"\u2715"})]},`contact-company-edit-${t}`))):c.companies&&c.companies.length>0?c.companies.map(((e,t)=>(0,N.jsxs)(gR,{style:{background:"transparent",border:"1px solid #00ff00",borderRadius:"4px",padding:"4px 8px",margin:"2px",display:"inline-flex",alignItems:"center"},children:[(0,N.jsx)("span",{children:e.name}),(0,N.jsx)("span",{onClick:async()=>{try{const{error:t}=await D.supabase.from("contact_companies").delete().eq("contact_id",c.contact_id).eq("company_id",e.company_id);if(t)console.error("Error removing company from contact:",t),nt.Ay.error("Failed to remove company");else{const t={...c};t.companies=t.companies.filter((t=>t.company_id!==e.company_id)),d(t),nt.Ay.success(`Company "${e.name}" removed`)}}catch(t){console.error("Exception removing company:",t),nt.Ay.error("Failed to remove company")}},title:"Remove company",style:{fontSize:"12px",marginLeft:"5px",color:"#00ff00",cursor:"pointer"},children:"\u2715"})]},`contact-company-edit-${t}`))):"-",(0,N.jsxs)(gR,{style:{background:"transparent",color:"#00ff00",cursor:"pointer",border:"none",padding:"4px 8px"},onClick:async()=>{const e=prompt("Enter new company:");if(!e||!e.trim())return;const t=e.trim();try{const{data:e,error:o}=await D.supabase.from("companies").select("company_id").ilike("name",t).maybeSingle();if(o)return console.error("Error searching for company:",o),void nt.Ay.error("Failed to search for company");let n;if(e)n=e.company_id;else{const{data:e,error:o}=await D.supabase.from("companies").insert({name:t}).select("company_id").single();if(o)return console.error("Error creating company:",o),void nt.Ay.error("Failed to create company");n=e.company_id}const{data:r,error:i}=await D.supabase.from("contact_companies").select("contact_companies_id").eq("contact_id",c.contact_id).eq("company_id",n).maybeSingle();if(i)return console.error("Error checking contact company:",i),void nt.Ay.error("Failed to check company link");if(r)nt.Ay.info(`Company "${t}" already linked`);else{const{error:e}=await D.supabase.from("contact_companies").insert({contact_id:c.contact_id,company_id:n});if(e)return console.error("Error linking company to contact:",e),void nt.Ay.error("Failed to add company");const o={...c};o.companies||(o.companies=[]),o.companies.push({company_id:n,name:t}),d(o),nt.Ay.success(`Company "${t}" added`)}}catch(o){console.error("Exception handling company:",o),nt.Ay.error("Failed to process company")}},onClick:()=>Xe(!0),children:[(0,N.jsx)("span",{style:{fontSize:"16px"},children:"+"})," Add\xa0Company"]})]})})]})]})]})}),(0,N.jsxs)(hA,{style:{marginTop:"30px",marginBottom:"20px",width:"calc(100% - 20px)",justifyContent:"flex-end"},children:[(0,N.jsxs)(pA,{onClick:()=>_o("airtable"),style:{marginRight:"10px"},children:[(0,N.jsx)(B.kRp,{})," Back to Matching"]}),(0,N.jsxs)(pA,{variant:"primary",onClick:()=>{en(3)},children:["Save & Continue ",(0,N.jsx)(B.YrT,{})]})]})]}):(0,N.jsxs)("div",{style:{color:"#999",textAlign:"center",padding:"20px",background:"#222",borderRadius:"4px",marginBottom:"20px"},children:[(0,N.jsx)(B.y3G,{size:24,style:{marginBottom:"10px"}}),(0,N.jsx)("div",{children:null!==c&&void 0!==c&&c.airtable_id?"Loading Airtable data...":"No Airtable record linked to this contact. Please go to the Matching tab first to link an Airtable contact."})]})}):ht?(0,N.jsxs)("div",{style:{padding:"0 20px 20px 20px",height:"100%",overflowY:"auto"},children:[(0,N.jsxs)(nR,{children:[(0,N.jsx)("thead",{children:(0,N.jsxs)("tr",{children:[(0,N.jsx)("th",{children:"Field"}),(0,N.jsx)("th",{children:"Current Contact"}),(0,N.jsx)("th",{children:"Duplicate Contact"}),(0,N.jsx)("th",{children:"Selection"})]})}),(0,N.jsxs)("tbody",{children:[(0,N.jsxs)("tr",{children:[(0,N.jsx)("td",{children:"Name"}),(0,N.jsxs)("td",{children:[c.first_name," ",c.last_name]}),(0,N.jsxs)("td",{children:[ht.first_name," ",ht.last_name]}),(0,N.jsx)("td",{children:(0,N.jsxs)("div",{style:{display:"flex",flexDirection:"column",gap:"4px"},children:[(0,N.jsxs)(rR,{children:[(0,N.jsx)(iR,{type:"radio",name:"merge_name",value:"current",checked:"current"===yt.first_name,onChange:()=>{un("first_name","current"),un("last_name","current")}}),(0,N.jsx)("span",{children:"Current"})]}),(0,N.jsxs)(rR,{children:[(0,N.jsx)(iR,{type:"radio",name:"merge_name",value:"duplicate",checked:"duplicate"===yt.first_name,onChange:()=>{un("first_name","duplicate"),un("last_name","duplicate")}}),(0,N.jsx)("span",{children:"Duplicate"})]})]})})]}),(0,N.jsxs)("tr",{children:[(0,N.jsx)("td",{children:"Category"}),(0,N.jsx)("td",{children:c.category||"-"}),(0,N.jsx)("td",{children:ht.category||"-"}),(0,N.jsx)("td",{children:(0,N.jsxs)("div",{style:{display:"flex",flexDirection:"column",gap:"4px"},children:[(0,N.jsxs)(rR,{children:[(0,N.jsx)(iR,{type:"radio",name:"merge_category",value:"current",checked:"current"===yt.category,onChange:()=>un("category","current")}),(0,N.jsx)("span",{children:"Current"})]}),(0,N.jsxs)(rR,{children:[(0,N.jsx)(iR,{type:"radio",name:"merge_category",value:"duplicate",checked:"duplicate"===yt.category,onChange:()=>un("category","duplicate")}),(0,N.jsx)("span",{children:"Duplicate"})]})]})})]}),(0,N.jsxs)("tr",{children:[(0,N.jsx)("td",{children:"Job Role"}),(0,N.jsx)("td",{children:c.job_role||"-"}),(0,N.jsx)("td",{children:ht.job_role||"-"}),(0,N.jsx)("td",{children:(0,N.jsxs)("div",{style:{display:"flex",flexDirection:"column",gap:"4px"},children:[(0,N.jsxs)(rR,{children:[(0,N.jsx)(iR,{type:"radio",name:"merge_job_role",value:"current",checked:"current"===yt.job_role,onChange:()=>un("job_role","current")}),(0,N.jsx)("span",{children:"Current"})]}),(0,N.jsxs)(rR,{children:[(0,N.jsx)(iR,{type:"radio",name:"merge_job_role",value:"duplicate",checked:"duplicate"===yt.job_role,onChange:()=>un("job_role","duplicate")}),(0,N.jsx)("span",{children:"Duplicate"})]})]})})]}),(0,N.jsxs)("tr",{children:[(0,N.jsx)("td",{children:"Email"}),(0,N.jsx)("td",{children:c.email?(0,N.jsx)("div",{style:{display:"inline-flex",alignItems:"center",background:"#333",borderRadius:"4px",padding:"4px 8px",margin:"2px",fontSize:"13px"},children:c.email}):"-"}),(0,N.jsx)("td",{children:ht.email||"-"}),(0,N.jsx)("td",{children:(0,N.jsxs)("div",{style:{display:"flex",flexWrap:"wrap",gap:"8px",alignItems:"center"},children:["current"===yt.emails&&c.email&&(0,N.jsxs)("div",{style:{display:"inline-flex",alignItems:"center",background:"#333",borderRadius:"4px",padding:"4px 8px",fontSize:"13px",marginBottom:"5px"},children:[c.email,(0,N.jsx)("button",{style:{background:"none",border:"none",color:"#ff5555",cursor:"pointer",marginLeft:"5px",padding:"0 5px",fontSize:"14px"},onClick:()=>{console.log("Remove email:",c.email)},children:(0,N.jsx)(B.yGN,{size:14})})]}),"duplicate"===yt.emails&&ht.email&&(0,N.jsxs)("div",{style:{display:"inline-flex",alignItems:"center",background:"#333",borderRadius:"4px",padding:"4px 8px",fontSize:"13px",marginBottom:"5px"},children:[ht.email,(0,N.jsx)("button",{style:{background:"none",border:"none",color:"#ff5555",cursor:"pointer",marginLeft:"5px",padding:"0 5px",fontSize:"14px"},onClick:()=>{console.log("Remove email:",ht.email)},children:(0,N.jsx)(B.yGN,{size:14})})]}),"combine"===yt.emails&&(0,N.jsxs)(N.Fragment,{children:[c.email&&(0,N.jsxs)("div",{style:{display:"inline-flex",alignItems:"center",background:"#333",borderRadius:"4px",padding:"4px 8px",fontSize:"13px",marginBottom:"5px"},children:[c.email,(0,N.jsx)("button",{style:{background:"none",border:"none",color:"#ff5555",cursor:"pointer",marginLeft:"5px",padding:"0 5px",fontSize:"14px"},onClick:()=>{console.log("Remove email:",c.email)},children:(0,N.jsx)(B.yGN,{size:14})})]}),ht.email&&c.email!==ht.email&&(0,N.jsxs)("div",{style:{display:"inline-flex",alignItems:"center",background:"#333",borderRadius:"4px",padding:"4px 8px",fontSize:"13px",marginBottom:"5px"},children:[ht.email,(0,N.jsx)("button",{style:{background:"none",border:"none",color:"#ff5555",cursor:"pointer",marginLeft:"5px",padding:"0 5px",fontSize:"14px"},onClick:()=>{console.log("Remove email:",ht.email)},children:(0,N.jsx)(B.yGN,{size:14})})]})]}),(0,N.jsxs)("button",{style:{display:"inline-flex",alignItems:"center",justifyContent:"center",background:"#222",border:"1px dashed #555",borderRadius:"4px",color:"#00ff00",cursor:"pointer",padding:"3px 8px",fontSize:"13px"},onClick:()=>{console.log("Add new email")},children:[(0,N.jsx)(B.GGD,{size:14,style:{marginRight:"5px"}}),"Add Email"]}),(0,N.jsxs)("div",{style:{display:"flex",flexDirection:"column",gap:"4px",marginTop:"10px",width:"100%"},children:[(0,N.jsxs)(rR,{children:[(0,N.jsx)(iR,{type:"radio",name:"merge_emails",value:"current",checked:"current"===yt.emails,onChange:()=>un("emails","current")}),(0,N.jsx)("span",{children:"Current"})]}),(0,N.jsxs)(rR,{children:[(0,N.jsx)(iR,{type:"radio",name:"merge_emails",value:"duplicate",checked:"duplicate"===yt.emails,onChange:()=>un("emails","duplicate")}),(0,N.jsx)("span",{children:"Duplicate"})]}),(0,N.jsxs)(rR,{children:[(0,N.jsx)(iR,{type:"radio",name:"merge_emails",value:"combine",checked:"combine"===yt.emails,onChange:()=>un("emails","combine")}),(0,N.jsx)("span",{children:"Combine"})]})]})]})})]}),(0,N.jsxs)("tr",{children:[(0,N.jsx)("td",{children:"Mobile"}),(0,N.jsx)("td",{children:c.mobile||"-"}),(0,N.jsx)("td",{children:ht.mobile||"-"}),(0,N.jsx)("td",{children:(0,N.jsxs)("div",{style:{display:"flex",flexDirection:"column",gap:"4px"},children:[(0,N.jsxs)(rR,{children:[(0,N.jsx)(iR,{type:"radio",name:"merge_mobiles",value:"current",checked:"current"===yt.mobiles,onChange:()=>un("mobiles","current")}),(0,N.jsx)("span",{children:"Current"})]}),(0,N.jsxs)(rR,{children:[(0,N.jsx)(iR,{type:"radio",name:"merge_mobiles",value:"duplicate",checked:"duplicate"===yt.mobiles,onChange:()=>un("mobiles","duplicate")}),(0,N.jsx)("span",{children:"Duplicate"})]}),(0,N.jsxs)(rR,{children:[(0,N.jsx)(iR,{type:"radio",name:"merge_mobiles",value:"combine",checked:"combine"===yt.mobiles,onChange:()=>un("mobiles","combine")}),(0,N.jsx)("span",{children:"Combine"})]})]})})]}),(0,N.jsxs)("tr",{children:[(0,N.jsx)("td",{children:"LinkedIn"}),(0,N.jsx)("td",{children:c.linkedin||"-"}),(0,N.jsx)("td",{children:ht.linkedin||"-"}),(0,N.jsx)("td",{children:(0,N.jsxs)("div",{style:{display:"flex",flexDirection:"column",gap:"4px"},children:[(0,N.jsxs)(rR,{children:[(0,N.jsx)(iR,{type:"radio",name:"merge_linkedin",value:"current",checked:"current"===yt.linkedin,onChange:()=>un("linkedin","current")}),(0,N.jsx)("span",{children:"Current"})]}),(0,N.jsxs)(rR,{children:[(0,N.jsx)(iR,{type:"radio",name:"merge_linkedin",value:"duplicate",checked:"duplicate"===yt.linkedin,onChange:()=>un("linkedin","duplicate")}),(0,N.jsx)("span",{children:"Duplicate"})]})]})})]}),(0,N.jsxs)("tr",{children:[(0,N.jsx)("td",{children:"Keep In Touch"}),(0,N.jsx)("td",{children:c.keep_in_touch_frequency||"Not Set"}),(0,N.jsx)("td",{children:ht.keep_in_touch_frequency||"Not Set"}),(0,N.jsx)("td",{children:(0,N.jsxs)("div",{style:{display:"flex",flexDirection:"column",gap:"4px"},children:[(0,N.jsxs)(rR,{children:[(0,N.jsx)(iR,{type:"radio",name:"merge_keep_in_touch",value:"current",checked:"current"===yt.keep_in_touch_frequency,onChange:()=>un("keep_in_touch_frequency","current")}),(0,N.jsx)("span",{children:"Current"})]}),(0,N.jsxs)(rR,{children:[(0,N.jsx)(iR,{type:"radio",name:"merge_keep_in_touch",value:"duplicate",checked:"duplicate"===yt.keep_in_touch_frequency,onChange:()=>un("keep_in_touch_frequency","duplicate")}),(0,N.jsx)("span",{children:"Duplicate"})]})]})})]})]})]}),(0,N.jsxs)("div",{style:{display:"flex",justifyContent:"flex-end",marginTop:"20px"},children:[(0,N.jsx)(pA,{onClick:()=>ft(null),style:{marginRight:"10px"},children:"Cancel"}),(0,N.jsxs)(pA,{variant:"primary",onClick:()=>pn(),style:{marginRight:"32px"},disabled:b,children:[(0,N.jsx)(B.EPw,{})," Merge Contacts"]})]})]}):(0,N.jsxs)("div",{style:{display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",height:"100%",padding:"40px 0",textAlign:"center",color:"#666"},children:[(0,N.jsx)(B.EPw,{size:40,style:{marginBottom:"15px",opacity:.5}}),(0,N.jsx)("h4",{style:{margin:"0 0 10px 0",color:"#999"},children:"Select a Duplicate"}),(0,N.jsx)("p",{style:{margin:0,fontSize:"0.9rem"},children:"Select a potential match from the list to view details"})]})})]})]}),(0,N.jsxs)(hA,{children:[(0,N.jsxs)(pA,{onClick:()=>en(1),disabled:b,children:[(0,N.jsx)(B.kRp,{})," Back"]}),(0,N.jsx)("div",{children:(0,N.jsxs)(pA,{variant:"primary",onClick:()=>en(3),disabled:b,children:["Continue as New ",(0,N.jsx)(B.dyV,{})]})})]})]}),3===y&&(0,N.jsx)(N.Fragment,{children:(0,N.jsxs)(dA,{children:[(0,N.jsxs)(uA,{children:[(0,N.jsx)(B.S8s,{})," Contact Enrichment"]}),(0,N.jsxs)(fA,{style:{paddingRight:0},children:[(0,N.jsxs)(gA,{style:{flex:"0 0 17%"},children:[(0,N.jsx)("div",{style:{padding:"10px 15px",color:"#999",fontSize:"0.8rem",borderBottom:"1px solid #333",fontWeight:"bold"},children:"INFORMATION"}),(0,N.jsxs)("div",{onClick:()=>_o("basics"),style:{padding:"12px 15px",cursor:"pointer",borderBottom:"1px solid #222",display:"flex",alignItems:"center",gap:"8px",background:"basics"===Co?"#222":"transparent"},children:[(0,N.jsx)(B.JXP,{size:16}),(0,N.jsx)("span",{children:"Basics"})]}),(0,N.jsxs)("div",{onClick:()=>_o("tags"),style:{padding:"12px 15px",cursor:"pointer",borderBottom:"1px solid #222",display:"flex",alignItems:"center",gap:"8px",background:"tags"===Co?"#222":"transparent"},children:[(0,N.jsx)(B.cnX,{size:16}),(0,N.jsx)("span",{children:"Tags"})]}),(0,N.jsxs)("div",{onClick:()=>{_o("notes"),Tt.description||tn("editingDescription",!0)},style:{padding:"12px 15px",cursor:"pointer",borderBottom:"1px solid #222",display:"flex",alignItems:"center",gap:"8px",background:"notes"===Co?"#222":"transparent"},children:[(0,N.jsx)(B.mEP,{size:16}),(0,N.jsx)("span",{children:"Notes"})]}),(0,N.jsx)("div",{style:{padding:"10px 15px",color:"#999",fontSize:"0.8rem",borderBottom:"1px solid #333",fontWeight:"bold",marginTop:"10px"},children:"RELATIONS"}),(0,N.jsxs)("div",{onClick:()=>_o("companies"),style:{padding:"12px 15px",cursor:"pointer",borderBottom:"1px solid #222",display:"flex",alignItems:"center",gap:"8px",background:"companies"===Co?"#222":"transparent"},children:[(0,N.jsx)(B.qYx,{size:16}),(0,N.jsx)("span",{children:"Companies"})]}),(0,N.jsxs)("div",{onClick:()=>_o("deals"),style:{padding:"12px 15px",cursor:"pointer",borderBottom:"1px solid #222",display:"flex",alignItems:"center",gap:"8px",background:"deals"===Co?"#222":"transparent"},children:[(0,N.jsx)(B.z8N,{size:16}),(0,N.jsx)("span",{children:"Deals"})]}),(0,N.jsxs)("div",{onClick:()=>_o("introductions"),style:{padding:"12px 15px",cursor:"pointer",borderBottom:"1px solid #222",display:"flex",alignItems:"center",gap:"8px",background:"introductions"===Co?"#222":"transparent"},children:[(0,N.jsx)(B.cfS,{size:16}),(0,N.jsx)("span",{children:"Introductions"})]})]}),(0,N.jsxs)(mA,{style:{flex:"0 0 83%"},children:[(0,N.jsxs)("div",{style:{padding:"20px 15px 0 20px"},children:["basics"===Co&&(0,N.jsxs)(N.Fragment,{children:[(0,N.jsxs)(cR,{children:[(0,N.jsxs)(lR,{children:["Name ",u&&u.full_name&&(0,N.jsxs)("span",{children:["- Airtable: ",u.full_name,(0,N.jsx)(B.dyV,{size:12,color:"#00ff00",style:{marginLeft:"5px",cursor:"pointer"},onClick:()=>{const e=u.full_name.split(" "),t=e[0]||"",o=e.slice(1).join(" ")||"",n=document.querySelector('input[placeholder="First Name"]');n&&(n.value=t,n.dispatchEvent(new Event("input",{bubbles:!0})));const r=document.querySelector('input[placeholder="Last Name"]');r&&(r.value=o,r.dispatchEvent(new Event("input",{bubbles:!0})))}})]})]}),(0,N.jsxs)("div",{style:{display:"flex",gap:"10px",marginBottom:"15px",background:"#222",padding:"12px",borderRadius:"4px"},children:[(0,N.jsx)(uR,{type:"text",value:Tt.firstName||(null===c||void 0===c?void 0:c.first_name)||"",onChange:e=>tn("firstName",e.target.value),placeholder:"First Name",style:{flex:1}}),(0,N.jsx)(uR,{type:"text",value:Tt.lastName||(null===c||void 0===c?void 0:c.last_name)||"",onChange:e=>tn("lastName",e.target.value),placeholder:"Last Name",style:{flex:1}})]})]}),(0,N.jsxs)(cR,{children:[(0,N.jsxs)(lR,{children:[(0,N.jsxs)("a",{href:`https://mail.superhuman.com/search/${c.first_name||""}%20${c.last_name||""}`,target:"_blank",rel:"noopener noreferrer",style:{color:"#fff",textDecoration:"none",display:"flex",alignItems:"center"},children:[(0,N.jsx)("span",{children:"Email Addresses"}),(0,N.jsx)("span",{style:{marginLeft:"5px",fontSize:"10px"},children:"\u2197"})]}),u&&u.primary_email&&(0,N.jsxs)("span",{children:["- Airtable: ",u.primary_email,(0,N.jsx)(B.dyV,{size:12,color:"#00ff00",style:{marginLeft:"5px",cursor:"pointer"},onClick:async()=>{try{const{data:e}=await D.supabase.from("contact_emails").select("*").eq("contact_id",c.contact_id).eq("email",u.primary_email);if(e&&e.length>0)return void nt.Ay.info("This email already exists for this contact");const{data:t,error:o}=await D.supabase.from("contact_emails").insert({contact_id:c.contact_id,email:u.primary_email,type:"personal",is_primary:!1});if(o)throw o;nt.Ay.success("Email added successfully"),qo();const n=document.querySelector('input[placeholder="Add new email address"]');n&&(n.value=u.primary_email,n.dispatchEvent(new Event("input",{bubbles:!0})))}catch(e){console.error("Error adding email:",e),nt.Ay.error("Failed to add email")}}})]})]}),(0,N.jsxs)("div",{style:{border:"1px solid #333",borderRadius:"4px",padding:"12px",marginBottom:"15px",background:"#1e1e1e"},children:[Tt.emails&&Tt.emails.length>0?Tt.emails.map(((e,t)=>(0,N.jsxs)("div",{style:{display:"flex",gap:"10px",marginBottom:t<Tt.emails.length-1?"15px":"0",alignItems:"center",padding:"8px",background:"#222",borderRadius:"4px"},children:[(0,N.jsx)("div",{style:{flex:2},children:(0,N.jsx)(uR,{type:"email",value:e.email||"",onChange:e=>{const o=[...Tt.emails];o[t].email=e.target.value,tn("emails",o)},placeholder:"Email address"})}),(0,N.jsx)("div",{style:{flex:1},children:(0,N.jsxs)(pR,{value:e.type||"personal",onChange:async o=>{try{const n=[...Tt.emails];if(n[t].type=o.target.value,tn("emails",n),e.email_id){const{error:t}=await D.supabase.from("contact_emails").update({type:o.target.value,last_modified_at:(new Date).toISOString()}).eq("email_id",e.email_id);if(t)throw t;nt.Ay.success("Email type updated")}}catch(n){console.error("Error updating email type:",n),nt.Ay.error("Failed to update email type")}},children:[(0,N.jsx)("option",{value:"personal",children:"Personal"}),(0,N.jsx)("option",{value:"work",children:"Work"}),(0,N.jsx)("option",{value:"other",children:"Other"})]})}),(0,N.jsx)("div",{style:{display:"flex",alignItems:"center",gap:"5px",fontSize:"0.85rem",padding:"0 5px",borderRadius:"4px",background:e.is_primary?"#444444":"transparent",cursor:"pointer"},onClick:async()=>{if(!e.is_primary)try{const o=Tt.emails.map(((e,o)=>({...e,is_primary:o===t})));if(tn("emails",o),e.email_id){const{error:t}=await D.supabase.from("contact_emails").update({is_primary:!1,last_modified_at:(new Date).toISOString()}).eq("contact_id",c.contact_id);if(t)throw t;const{error:o}=await D.supabase.from("contact_emails").update({is_primary:!0,last_modified_at:(new Date).toISOString()}).eq("email_id",e.email_id);if(o)throw o;nt.Ay.success("Primary email updated")}}catch(o){console.error("Error updating primary email:",o),nt.Ay.error("Failed to update primary email")}},children:e.is_primary?(0,N.jsxs)(N.Fragment,{children:[(0,N.jsx)(B.YrT,{size:14})," Primary"]}):"Set Primary"}),(0,N.jsx)("button",{onClick:async()=>{try{if(e.email_id&&!e.email_id.toString().startsWith("temp-")){if(!window.confirm(`Are you sure you want to delete this email: ${e.email}?`))return;const{error:o}=await D.supabase.from("contact_emails").delete().eq("email_id",e.email_id);if(o)throw o;if(nt.Ay.success("Email deleted successfully"),e.is_primary){const e=Tt.emails.filter(((e,o)=>o!==t));if(e.length>0&&e[0].email_id){const{error:t}=await D.supabase.from("contact_emails").update({is_primary:!0,last_modified_at:(new Date).toISOString()}).eq("email_id",e[0].email_id);t&&console.error("Error updating new primary:",t)}}qo()}else{let o=Tt.emails.filter(((e,o)=>o!==t));e.is_primary&&o.length>0&&(o[0].is_primary=!0),tn("emails",o)}}catch(o){console.error("Error deleting email:",o),nt.Ay.error("Failed to delete email")}},style:{background:"none",border:"none",color:"#ff6b6b",cursor:"pointer",padding:"5px"},title:"Remove email",children:(0,N.jsx)(B.IXo,{size:16})})]},e.email_id||t))):(0,N.jsx)("div",{style:{color:"#999",textAlign:"center",padding:"10px 0"},children:"No email addresses added"}),(0,N.jsxs)("div",{style:{display:"flex",gap:"10px",marginTop:"15px"},children:[(0,N.jsx)(uR,{type:"email",placeholder:"Add new email address",value:Tt.newEmail||"",onChange:e=>tn("newEmail",e.target.value),style:{flex:2}}),(0,N.jsxs)(pR,{value:Tt.newEmailType||"personal",onChange:e=>tn("newEmailType",e.target.value),style:{flex:1},children:[(0,N.jsx)("option",{value:"personal",children:"Personal"}),(0,N.jsx)("option",{value:"work",children:"Work"}),(0,N.jsx)("option",{value:"other",children:"Other"})]}),(0,N.jsx)("button",{onClick:()=>{if(!Tt.newEmail)return;const e={email_id:`temp-${Date.now()}`,email:Tt.newEmail,type:Tt.newEmailType||"personal",is_primary:0===Tt.emails.length};tn("emails",[...Tt.emails||[],e]),tn("newEmail","")},disabled:!Tt.newEmail,style:{background:Tt.newEmail?"#00ff00":"#444",border:"none",borderRadius:"4px",padding:"0 15px",minWidth:"60px",color:Tt.newEmail?"black":"#999",cursor:Tt.newEmail?"pointer":"not-allowed"},children:"Add"})]})]})]}),(0,N.jsxs)(cR,{children:[(0,N.jsxs)(lR,{children:[(0,N.jsxs)("a",{href:`https://app.timelines.ai/search/?s=${c.first_name||""}%20${c.last_name||""}`,target:"_blank",rel:"noopener noreferrer",style:{color:"#fff",textDecoration:"none",display:"flex",alignItems:"center"},children:[(0,N.jsx)("span",{children:"Mobile Numbers"}),(0,N.jsx)("span",{style:{marginLeft:"5px",fontSize:"10px"},children:"\u2197"})]}),u&&(u.phone_number_1||u.phone_number_2)&&(0,N.jsxs)("span",{children:["- Airtable: ",u.phone_number_1||"",u.phone_number_1&&(0,N.jsx)(B.dyV,{size:12,color:"#00ff00",style:{marginLeft:"5px",cursor:"pointer"},onClick:async()=>{try{const{data:e}=await D.supabase.from("contact_mobiles").select("*").eq("contact_id",c.contact_id).eq("mobile",u.phone_number_1);if(e&&e.length>0)return void nt.Ay.info("This mobile number already exists for this contact");const{data:t,error:o}=await D.supabase.from("contact_mobiles").insert({contact_id:c.contact_id,mobile:u.phone_number_1,type:"personal",is_primary:!1});if(o)throw o;nt.Ay.success("Mobile number added successfully"),qo();const n=document.querySelector('input[placeholder="Add new mobile number"]');n&&(n.value=u.phone_number_1,n.dispatchEvent(new Event("input",{bubbles:!0})))}catch(e){console.error("Error adding mobile number:",e),nt.Ay.error("Failed to add mobile number")}}}),u.phone_number_1&&u.phone_number_2?" - ":"",u.phone_number_2||"",u.phone_number_2&&(0,N.jsx)(B.dyV,{size:12,color:"#00ff00",style:{marginLeft:"5px",cursor:"pointer"},onClick:async()=>{try{const{data:e}=await D.supabase.from("contact_mobiles").select("*").eq("contact_id",c.contact_id).eq("mobile",u.phone_number_2);if(e&&e.length>0)return void nt.Ay.info("This mobile number already exists for this contact");const{data:t,error:o}=await D.supabase.from("contact_mobiles").insert({contact_id:c.contact_id,mobile:u.phone_number_2,type:"personal",is_primary:!1});if(o)throw o;nt.Ay.success("Mobile number added successfully"),qo();const n=document.querySelector('input[placeholder="Add new mobile number"]');n&&(n.value=u.phone_number_2,n.dispatchEvent(new Event("input",{bubbles:!0})))}catch(e){console.error("Error adding mobile number:",e),nt.Ay.error("Failed to add mobile number")}}})]})]}),(0,N.jsxs)("div",{style:{border:"1px solid #333",borderRadius:"4px",padding:"12px",marginBottom:"15px",background:"#1e1e1e"},children:[Tt.mobiles&&Tt.mobiles.length>0?Tt.mobiles.map(((e,t)=>(0,N.jsxs)("div",{style:{display:"flex",gap:"10px",marginBottom:t<Tt.mobiles.length-1?"15px":"0",alignItems:"center",padding:"8px",background:"#222",borderRadius:"4px"},children:[(0,N.jsx)("div",{style:{flex:2},children:(0,N.jsx)(uR,{type:"text",value:e.mobile||"",onChange:e=>{const o=[...Tt.mobiles];o[t].mobile=e.target.value,tn("mobiles",o)},placeholder:"Phone number"})}),(0,N.jsx)("div",{style:{flex:1},children:(0,N.jsxs)(pR,{value:e.type||"personal",onChange:async o=>{try{const n=[...Tt.mobiles];if(n[t].type=o.target.value,tn("mobiles",n),e.mobile_id){const{error:t}=await D.supabase.from("contact_mobiles").update({type:o.target.value,last_modified_at:(new Date).toISOString()}).eq("mobile_id",e.mobile_id);if(t)throw t;nt.Ay.success("Mobile type updated")}}catch(n){console.error("Error updating mobile type:",n),nt.Ay.error("Failed to update mobile type")}},children:[(0,N.jsx)("option",{value:"personal",children:"Personal"}),(0,N.jsx)("option",{value:"work",children:"Work"}),(0,N.jsx)("option",{value:"other",children:"Other"})]})}),(0,N.jsx)("div",{style:{display:"flex",alignItems:"center",gap:"5px",fontSize:"0.85rem",padding:"0 5px",borderRadius:"4px",background:e.is_primary?"#444444":"transparent",cursor:"pointer"},onClick:async()=>{if(!e.is_primary)try{const o=Tt.mobiles.map(((e,o)=>({...e,is_primary:o===t})));if(tn("mobiles",o),e.mobile_id){const{error:t}=await D.supabase.from("contact_mobiles").update({is_primary:!1,last_modified_at:(new Date).toISOString()}).eq("contact_id",c.contact_id);if(t)throw t;const{error:o}=await D.supabase.from("contact_mobiles").update({is_primary:!0,last_modified_at:(new Date).toISOString()}).eq("mobile_id",e.mobile_id);if(o)throw o;nt.Ay.success("Primary mobile updated")}}catch(o){console.error("Error updating primary mobile:",o),nt.Ay.error("Failed to update primary mobile")}},children:e.is_primary?(0,N.jsxs)(N.Fragment,{children:[(0,N.jsx)(B.YrT,{size:14})," Primary"]}):"Set Primary"}),(0,N.jsx)("button",{onClick:async()=>{try{if(e.mobile_id&&!e.mobile_id.toString().startsWith("temp-")){if(!window.confirm(`Are you sure you want to delete this mobile number: ${e.mobile}?`))return;const{error:o}=await D.supabase.from("contact_mobiles").delete().eq("mobile_id",e.mobile_id);if(o)throw o;if(nt.Ay.success("Mobile number deleted successfully"),e.is_primary){const e=Tt.mobiles.filter(((e,o)=>o!==t));if(e.length>0&&e[0].mobile_id){const{error:t}=await D.supabase.from("contact_mobiles").update({is_primary:!0,last_modified_at:(new Date).toISOString()}).eq("mobile_id",e[0].mobile_id);t&&console.error("Error updating new primary:",t)}}qo()}else{let o=Tt.mobiles.filter(((e,o)=>o!==t));e.is_primary&&o.length>0&&(o[0].is_primary=!0),tn("mobiles",o)}}catch(o){console.error("Error deleting mobile number:",o),nt.Ay.error("Failed to delete mobile number")}},style:{background:"none",border:"none",color:"#ff6b6b",cursor:"pointer",padding:"5px"},title:"Remove mobile",children:(0,N.jsx)(B.IXo,{size:16})})]},e.mobile_id||t))):(0,N.jsx)("div",{style:{color:"#999",textAlign:"center",padding:"10px 0"},children:"No mobile numbers added"}),(0,N.jsxs)("div",{style:{display:"flex",gap:"10px",marginTop:"15px"},children:[(0,N.jsx)(uR,{type:"text",placeholder:"Add new mobile number",value:Tt.newMobile||"",onChange:e=>tn("newMobile",e.target.value),style:{flex:2}}),(0,N.jsxs)(pR,{value:Tt.newMobileType||"personal",onChange:e=>tn("newMobileType",e.target.value),style:{flex:1},children:[(0,N.jsx)("option",{value:"personal",children:"Personal"}),(0,N.jsx)("option",{value:"work",children:"Work"}),(0,N.jsx)("option",{value:"other",children:"Other"})]}),(0,N.jsx)("button",{onClick:()=>{if(!Tt.newMobile)return;const e={mobile_id:`temp-${Date.now()}`,mobile:Tt.newMobile,type:Tt.newMobileType||"personal",is_primary:0===Tt.mobiles.length};tn("mobiles",[...Tt.mobiles||[],e]),tn("newMobile","")},disabled:!Tt.newMobile,style:{background:Tt.newMobile?"#00ff00":"#444",border:"none",borderRadius:"4px",padding:"0 15px",minWidth:"60px",color:Tt.newMobile?"black":"#999",cursor:Tt.newMobile?"pointer":"not-allowed"},children:"Add"})]})]})]})]}),"tags"===Co&&(0,N.jsxs)(N.Fragment,{children:[(0,N.jsxs)(cR,{style:{marginBottom:"15px"},children:[(0,N.jsxs)(lR,{children:["Keep in Touch & Category",u&&(0,N.jsxs)("span",{children:[u.keep_in_touch&&` - Airtable Keep in Touch: ${u.keep_in_touch}`,u.category&&` - Airtable Category: ${u.category}`]})]}),(0,N.jsxs)("div",{style:{display:"flex",gap:"15px",background:"#222",padding:"12px",borderRadius:"4px"},children:[(0,N.jsx)("div",{style:{flex:1},children:(0,N.jsxs)(pR,{value:Tt.keepInTouch||"",onChange:e=>tn("keepInTouch",""===e.target.value?null:e.target.value),children:[(0,N.jsx)("option",{value:"Not Set",children:"Not Set"}),(0,N.jsx)("option",{value:"Monthly",children:"Monthly"}),(0,N.jsx)("option",{value:"Quarterly",children:"Quarterly"}),(0,N.jsx)("option",{value:"Twice per Year",children:"Twice per Year"}),(0,N.jsx)("option",{value:"Once per Year",children:"Once per Year"}),(0,N.jsx)("option",{value:"Weekly",children:"Weekly"}),(0,N.jsx)("option",{value:"Do not keep in touch",children:"Do not keep in touch"})]})}),(0,N.jsx)("div",{style:{flex:1},children:(0,N.jsxs)(pR,{value:Tt.category||"",onChange:e=>tn("category",""===e.target.value?null:e.target.value),children:[(0,N.jsx)("option",{value:"Inbox",children:"Inbox"}),(0,N.jsx)("option",{value:"Professional Investor",children:"Professional Investor"}),(0,N.jsx)("option",{value:"Team",children:"Team"}),(0,N.jsx)("option",{value:"Advisor",children:"Advisor"}),(0,N.jsx)("option",{value:"Supplier",children:"Supplier"}),(0,N.jsx)("option",{value:"Founder",children:"Founder"}),(0,N.jsx)("option",{value:"Manager",children:"Manager"}),(0,N.jsx)("option",{value:"Friend and Family",children:"Friend and Family"}),(0,N.jsx)("option",{value:"Other",children:"Other"}),(0,N.jsx)("option",{value:"Student",children:"Student"}),(0,N.jsx)("option",{value:"Media",children:"Media"}),(0,N.jsx)("option",{value:"Institution",children:"Institution"})]})})]})]}),(0,N.jsxs)(cR,{children:[(0,N.jsxs)(lR,{children:["Cities",u&&u.city&&` - Airtable: ${u.city}`]}),(0,N.jsx)("div",{style:{background:"#222",padding:"12px",borderRadius:"4px",marginBottom:"15px"},children:(0,N.jsx)(fR,{style:{marginBottom:Tt.cities&&Tt.cities.length>0?"8px":"0"},children:Tt.cities&&Tt.cities.length>0?Tt.cities.map((e=>(0,N.jsxs)(gR,{children:[e.name,(0,N.jsx)(B.yGN,{className:"remove",size:14,onClick:()=>tn("cities",Tt.cities.filter((t=>(t.city_id||t.entry_id)!==(e.city_id||e.entry_id))))})]},e.city_id||e.entry_id))):(0,N.jsx)("div",{style:{color:"#999",textAlign:"center",padding:"8px 0"},children:"No cities added"})})}),(0,N.jsxs)("div",{style:{position:"relative",marginBottom:"15px"},children:[(0,N.jsx)("div",{style:{background:"#222",padding:"12px",borderRadius:"4px"},children:(0,N.jsx)(uR,{type:"text",placeholder:"Type to add a new city (min 2 characters)",value:Tt.newCity||"",style:{boxSizing:"border-box",width:"100%"},onChange:e=>{const t=e.target.value;tn("newCity",t),t&&t.length>=2?(async e=>{if(e&&!(e.length<2))try{const{data:t,error:o}=await D.supabase.from("cities").select("city_id, name, country").ilike("name",`%${e}%`).order("name").limit(10);if(o)return void console.error("Error searching for city suggestions:",o);const n=t.filter((e=>{var t;return!(null!==(t=Tt.cities)&&void 0!==t&&t.some((t=>t.city_id===e.city_id)))}));tn("citySuggestions",n)}catch(t){console.error("Error in searchCities:",t)}})(t):tn("citySuggestions",[])},onKeyDown:e=>{var t;if("Enter"===e.key&&null!==(t=Tt.newCity)&&void 0!==t&&t.trim()){const e={city_id:`temp-${Date.now()}`,name:Tt.newCity.trim()};tn("cities",[...Tt.cities||[],e]),tn("newCity",""),tn("citySuggestions",[])}else"Escape"===e.key&&(tn("newCity",""),tn("citySuggestions",[]))}})}),Tt.citySuggestions&&Tt.citySuggestions.length>0&&(0,N.jsx)("div",{style:{position:"absolute",top:"100%",left:0,width:"100%",zIndex:10,background:"#222",boxShadow:"0 4px 8px rgba(0,0,0,0.2)",border:"1px solid #444",borderRadius:"4px",maxHeight:"200px",overflowY:"auto"},children:Tt.citySuggestions.map((e=>(0,N.jsx)("div",{onClick:()=>{var t;null!==(t=Tt.cities)&&void 0!==t&&t.some((t=>t.city_id===e.city_id||t.name.toLowerCase()===e.name.toLowerCase()))||(tn("cities",[...Tt.cities||[],e]),tn("newCity",""),tn("citySuggestions",[]))},style:{padding:"8px 12px",cursor:"pointer",borderBottom:"1px solid #444"},onMouseEnter:e=>e.currentTarget.style.backgroundColor="#444",onMouseLeave:e=>e.currentTarget.style.backgroundColor="transparent",children:e.name},e.city_id)))})]})]}),(0,N.jsxs)(cR,{children:[(0,N.jsxs)(lR,{children:["Tags",u&&u.keywords&&` - Airtable Keywords: ${u.keywords}`]}),(0,N.jsx)("div",{style:{background:"#222",padding:"12px",borderRadius:"4px",marginBottom:"15px"},children:(0,N.jsx)(fR,{style:{marginBottom:Tt.tags&&Tt.tags.length>0?"8px":"0"},children:Tt.tags&&Tt.tags.length>0?Tt.tags.map((e=>(0,N.jsxs)(gR,{children:[e.name,(0,N.jsx)(B.yGN,{className:"remove",size:14,onClick:()=>tn("tags",Tt.tags.filter((t=>(t.tag_id||t.entry_id)!==(e.tag_id||e.entry_id))))})]},e.tag_id||e.entry_id))):(0,N.jsx)("div",{style:{color:"#999",textAlign:"center",padding:"8px 0"},children:"No tags added"})})}),(0,N.jsxs)("div",{style:{position:"relative",marginBottom:"15px"},children:[(0,N.jsx)("div",{style:{background:"#222",padding:"12px",borderRadius:"4px"},children:(0,N.jsx)(uR,{type:"text",placeholder:"Type to add a new tag (min 2 characters)",value:Tt.newCustomTag||"",style:{boxSizing:"border-box",width:"100%"},onChange:e=>{const t=e.target.value;tn("newCustomTag",t),t&&t.length>=2?(async e=>{if(e&&!(e.length<2))try{const{data:t,error:o}=await D.supabase.from("tags").select("tag_id, name").ilike("name",`%${e}%`).order("name").limit(10);if(o)return void console.error("Error searching for tag suggestions:",o);const n=t.filter((e=>{var t;return!(null!==(t=Tt.tags)&&void 0!==t&&t.some((t=>t.tag_id===e.tag_id)))}));tn("tagSuggestions",n)}catch(t){console.error("Error in searchTagSuggestions:",t)}})(t):tn("tagSuggestions",[])},onKeyDown:e=>{var t;if("Enter"===e.key&&null!==(t=Tt.newCustomTag)&&void 0!==t&&t.trim()){const e={tag_id:`temp-${Date.now()}`,name:Tt.newCustomTag.trim()};tn("tags",[...Tt.tags||[],e]),tn("newCustomTag",""),tn("tagSuggestions",[])}else"Escape"===e.key&&(tn("newCustomTag",""),tn("tagSuggestions",[]))}})}),Tt.tagSuggestions&&Tt.tagSuggestions.length>0&&(0,N.jsx)("div",{style:{position:"absolute",top:"100%",left:0,width:"100%",zIndex:10,background:"#222",boxShadow:"0 4px 8px rgba(0,0,0,0.2)",border:"1px solid #444",borderRadius:"4px",maxHeight:"200px",overflowY:"auto"},children:Tt.tagSuggestions.map((e=>(0,N.jsx)("div",{onClick:()=>{var t;null!==(t=Tt.tags)&&void 0!==t&&t.some((t=>t.tag_id===e.tag_id||t.name.toLowerCase()===e.name.toLowerCase()))||(tn("tags",[...Tt.tags||[],e]),tn("newCustomTag",""),tn("tagSuggestions",[]))},style:{padding:"8px 12px",cursor:"pointer",borderBottom:"1px solid #444"},onMouseEnter:e=>e.currentTarget.style.backgroundColor="#444",onMouseLeave:e=>e.currentTarget.style.backgroundColor="transparent",children:e.name},e.tag_id)))})]})]})]}),"companies"===Co&&(0,N.jsxs)(N.Fragment,{children:[(0,N.jsxs)(cR,{children:[(0,N.jsxs)(lR,{children:[(0,N.jsx)("a",{href:Tt.linkedIn?Tt.linkedIn.startsWith("http")?Tt.linkedIn:`https://${Tt.linkedIn}`:`https://www.linkedin.com/search/results/people/?keywords=${c.first_name||""}%20${c.last_name||""}&sid=Avh`,target:"_blank",rel:"noopener noreferrer",style:{color:"#fff",textDecoration:"none",display:"flex",alignItems:"center"},children:(0,N.jsx)("span",{children:"LinkedIn Profile"})}),u&&u.linkedin_normalised&&` - Airtable: ${u.linkedin_normalised}`]}),(0,N.jsxs)("div",{style:{background:"#222",padding:"12px",borderRadius:"4px",marginBottom:"20px",display:"flex",alignItems:"center",gap:"10px"},children:[(0,N.jsx)(uR,{type:"text",value:Tt.linkedIn||"",onChange:e=>tn("linkedIn",e.target.value),placeholder:"LinkedIn URL",style:{flex:1}}),!c.linkedin&&(0,N.jsxs)("button",{onClick:async()=>{try{x(!0);const{error:e}=await D.supabase.from("contacts").update({linkedin:Tt.linkedIn,last_modified_at:new Date}).eq("contact_id",r);if(e)throw e;nt.Ay.success("LinkedIn profile saved"),x(!1)}catch(e){console.error("Error saving LinkedIn:",e),nt.Ay.error("Failed to save LinkedIn profile"),x(!1)}},style:{background:"#00ff00",color:"#000",border:"none",borderRadius:"4px",padding:"8px 12px",cursor:"pointer",display:"flex",alignItems:"center",gap:"5px"},children:[(0,N.jsx)(B.YrT,{size:14})," Save"]}),(0,N.jsx)("button",{onClick:()=>Pe(!0),style:{background:"#00ff00",color:"#000",border:"none",borderRadius:"4px",padding:"8px 12px",cursor:"pointer"},children:"Preview"})]})]}),(0,N.jsxs)(cR,{children:[(0,N.jsxs)(lR,{children:["Job Role",u&&u.job_title&&` - Airtable: ${u.job_title}`]}),(0,N.jsxs)("div",{style:{background:"#222",padding:"15px",borderRadius:"4px",marginBottom:"20px",display:"flex",alignItems:"center",gap:"10px"},children:[(0,N.jsx)(uR,{type:"text",value:Tt.jobRole||"",onChange:e=>tn("jobRole",e.target.value),placeholder:"Job Role",style:{flex:1}}),(0,N.jsxs)("button",{onClick:async()=>{try{x(!0);const{error:e}=await D.supabase.from("contacts").update({job_role:Tt.jobRole,last_modified_at:new Date}).eq("contact_id",r);if(e)throw e;nt.Ay.success("Job role saved"),x(!1)}catch(e){console.error("Error saving job role:",e),nt.Ay.error("Failed to save job role"),x(!1)}},style:{background:"#00ff00",color:"#000",border:"none",borderRadius:"4px",padding:"8px 12px",cursor:"pointer",display:"flex",alignItems:"center",gap:"5px"},children:[(0,N.jsx)(B.YrT,{size:14})," Save"]})]})]}),(0,N.jsxs)("div",{style:{marginTop:"20px",paddingRight:"20px"},children:[(0,N.jsxs)("div",{style:{display:"flex",alignItems:"center",marginBottom:"10px"},children:[(0,N.jsx)(lR,{children:"Associated Companies"}),(0,N.jsx)("button",{onClick:async()=>{try{if(nt.Ay.loading("Refreshing company data...",{id:"refresh-companies"}),console.log("Directly querying company data for contact ID:",r),!r)return console.warn("Cannot refresh companies: Missing contact ID"),void nt.Ay.error("Cannot refresh: Missing contact ID",{id:"refresh-companies"});const{data:e,error:t}=await D.supabase.from("contact_companies").select("\n          contact_companies_id,\n          company_id,\n          relationship,\n          is_primary,\n          companies:company_id(\n            company_id,\n            name,\n            website,\n            category,\n            description,\n            linkedin\n          )\n        ").eq("contact_id",r);if(t)return console.error("Supabase error when refreshing companies:",t),void nt.Ay.error("Database error when refreshing",{id:"refresh-companies"});if(console.log("Refreshed contact companies data from Supabase:",e),e&&e.length>0){const t=e.map((e=>{var t,o,n,r,i;return{contact_companies_id:e.contact_companies_id,company_id:e.company_id,relationship:e.relationship,is_primary:e.is_primary,name:(null===(t=e.companies)||void 0===t?void 0:t.name)||"Unknown Company",website:(null===(o=e.companies)||void 0===o?void 0:o.website)||"",category:(null===(n=e.companies)||void 0===n?void 0:n.category)||"Inbox",description:(null===(r=e.companies)||void 0===r?void 0:r.description)||"",linkedin:(null===(i=e.companies)||void 0===i?void 0:i.linkedin)||"",tags:[]}}));console.log("Formatted companies from refresh:",t),oo(t),uo(!0),nt.Ay.success("Company data refreshed successfully",{id:"refresh-companies"})}else console.log("No companies found for this contact during refresh"),nt.Ay.success("No companies found for this contact",{id:"refresh-companies"})}catch(e){console.error("Error refreshing company data:",e),nt.Ay.error("Failed to refresh company data: "+e.message,{id:"refresh-companies"})}},style:{background:"transparent",color:"#00ff00",border:"none",borderRadius:"4px",padding:"2px 6px",cursor:"pointer",display:"flex",alignItems:"center",fontSize:"0.7rem",marginLeft:"10px",height:"20px"},title:"Refresh Company Data",children:(0,N.jsx)(B.jTZ,{size:14})}),(0,N.jsx)("button",{onClick:()=>Ge(!0),style:{background:"transparent",color:"#00ff00",border:"1px solid #00ff00",borderRadius:"4px",padding:"2px 6px",cursor:"pointer",display:"flex",alignItems:"center",fontSize:"0.7rem",marginLeft:"10px",height:"20px"},title:"Associate Company",children:(0,N.jsx)(B.GGD,{size:10})})]}),(0,N.jsx)("div",{style:{background:"#222",padding:"12px",borderRadius:"4px",minHeight:"100px",width:"100%"},children:(0,N.jsxs)("div",{style:{width:"100%"},children:[console.log("Current enrichment section:",Co),(0,N.jsxs)("table",{style:{width:"100%",borderCollapse:"collapse",overflow:"hidden",marginTop:0},children:[(0,N.jsx)("thead",{children:(0,N.jsxs)("tr",{style:{background:"#333"},children:[(0,N.jsx)("th",{style:{padding:"10px 15px",textAlign:"left",borderBottom:"1px solid #444",width:"20%"},children:"Company"}),(0,N.jsx)("th",{style:{padding:"10px 15px",textAlign:"left",borderBottom:"1px solid #444",width:"30%"},children:"Tags"}),(0,N.jsx)("th",{style:{padding:"10px 15px",textAlign:"left",borderBottom:"1px solid #444",width:"25%"},children:"Category"}),(0,N.jsx)("th",{style:{padding:"10px 15px",textAlign:"left",borderBottom:"1px solid #444",width:"15%"},children:"Relationship"}),(0,N.jsx)("th",{style:{padding:"10px 15px",textAlign:"center",borderBottom:"1px solid #444",width:"10%"},children:"Actions"})]})}),(0,N.jsxs)("tbody",{children:[console.log("Rendering companies table. contactCompanies:",to,"Loaded:",co),co&&to&&to.length>0?to.map((e=>(0,N.jsxs)("tr",{style:{borderBottom:"1px solid #333"},children:[(0,N.jsx)("td",{style:{padding:"12px 15px"},children:(0,N.jsx)("div",{style:{display:"flex",alignItems:"center"},children:po===e.contact_companies_id?(0,N.jsx)("input",{type:"text",value:fo,onChange:e=>go(e.target.value),onKeyDown:e=>bo(e),onBlur:vo,autoFocus:!0,style:{background:"transparent",border:"none",borderBottom:"1px solid #00ff00",color:"#fff",width:"100%",padding:"8px 0",outline:"none"}}):(0,N.jsx)("div",{onClick:()=>(e=>{ho(e.contact_companies_id),go(e.name||"")})(e),style:{width:"100%",padding:"8px 0",cursor:"pointer",color:"#fff"},children:e.name||"Unnamed Company"})})}),(0,N.jsx)("td",{style:{padding:"12px 15px"},children:(0,N.jsx)("div",{style:{display:"flex",flexWrap:"wrap",gap:"5px",minHeight:"32px"},children:e.tags&&e.tags.length>0?(0,N.jsxs)(N.Fragment,{children:[e.tags.map((t=>(0,N.jsxs)("div",{style:{background:"#333",color:"#00ff00",border:"1px solid #00ff00",borderRadius:"3px",padding:"2px 5px",fontSize:"0.7rem",display:"flex",alignItems:"center",gap:"3px"},children:[t.name,(0,N.jsx)("span",{onClick:()=>(async(e,t)=>{try{if(!e||!t)return;const{error:o}=await D.supabase.from("company_tags").delete().eq("company_id",e).eq("tag_id",t);if(o)throw o;oo((o=>o.map((o=>{var n;return o.company_id===e?{...o,tags:(null===(n=o.tags)||void 0===n?void 0:n.filter((e=>e.tag_id!==t)))||[]}:o})))),nt.Ay.success("Tag removed")}catch(o){console.error("Error removing company tag:",o),nt.Ay.error("Failed to remove tag")}})(e.company_id,t.tag_id),style:{cursor:"pointer",display:"flex",alignItems:"center"},children:(0,N.jsx)(B.yGN,{size:10})})]},t.tag_id||t.entry_id))),(0,N.jsx)("button",{onClick:()=>wo(e.company_id),style:{background:"transparent",color:"#00ff00",border:"none",borderRadius:"3px",padding:"2px 4px",fontSize:"0.7rem",cursor:"pointer",display:"flex",alignItems:"center"},children:(0,N.jsx)(B.GGD,{size:10})})]}):(0,N.jsxs)("button",{onClick:()=>wo(e.company_id),style:{background:"#333",color:"#00ff00",border:"1px solid #00ff00",borderRadius:"3px",padding:"0px 5px",fontSize:"0.7rem",cursor:"pointer",display:"flex",alignItems:"center",gap:"3px"},children:[(0,N.jsx)(B.GGD,{size:10})," Add"]})})}),(0,N.jsx)("td",{style:{padding:"12px 15px"},children:(0,N.jsxs)("select",{value:e.category||"",onChange:t=>yo(e.contact_companies_id,"category",t.target.value),style:{background:"transparent",border:"none",color:"#fff",padding:"8px 0",width:"100%",WebkitAppearance:"none",MozAppearance:"none",appearance:"none",backgroundImage:"url(\"data:image/svg+xml;utf8,<svg xmlns='http://www.w3.org/2000/svg' width='10' height='6' fill='none' stroke='%23aaa' stroke-width='1.5' viewBox='0 0 10 6'><polyline points='1,1 5,5 9,1'/></svg>\")",backgroundRepeat:"no-repeat",backgroundPosition:"right center",paddingRight:"20px"},children:[(0,N.jsx)("option",{value:"Not Set",children:"Not Set"}),(0,N.jsx)("option",{value:"Inbox",children:"Inbox"}),(0,N.jsx)("option",{value:"Professional Investor",children:"Professional Investor"}),(0,N.jsx)("option",{value:"Startup",children:"Startup"}),(0,N.jsx)("option",{value:"Corporate",children:"Corporate"}),(0,N.jsx)("option",{value:"Corporation",children:"Corporation"}),(0,N.jsx)("option",{value:"Advisory",children:"Advisory"}),(0,N.jsx)("option",{value:"SME",children:"SME"}),(0,N.jsx)("option",{value:"Institution",children:"Institution"}),(0,N.jsx)("option",{value:"Media",children:"Media"}),(0,N.jsx)("option",{value:"Skip",children:"Skip"})]})}),(0,N.jsx)("td",{style:{padding:"12px 15px"},children:(0,N.jsxs)("select",{value:e.relationship||"not_set",onChange:t=>yo(e.contact_companies_id,"relationship",t.target.value),style:{background:"transparent",border:"none",color:"#fff",padding:"8px 0",width:"100%",WebkitAppearance:"none",MozAppearance:"none",appearance:"none",backgroundImage:"url(\"data:image/svg+xml;utf8,<svg xmlns='http://www.w3.org/2000/svg' width='10' height='6' fill='none' stroke='%23aaa' stroke-width='1.5' viewBox='0 0 10 6'><polyline points='1,1 5,5 9,1'/></svg>\")",backgroundRepeat:"no-repeat",backgroundPosition:"right center",paddingRight:"20px"},children:[(0,N.jsx)("option",{value:"not_set",children:"Not Set"}),(0,N.jsx)("option",{value:"employee",children:"Employee"}),(0,N.jsx)("option",{value:"founder",children:"Founder"}),(0,N.jsx)("option",{value:"advisor",children:"Advisor"}),(0,N.jsx)("option",{value:"manager",children:"Manager"}),(0,N.jsx)("option",{value:"investor",children:"Investor"}),(0,N.jsx)("option",{value:"other",children:"Other"})]})}),(0,N.jsx)("td",{style:{padding:"12px 15px",textAlign:"center"},children:(0,N.jsxs)("div",{style:{display:"flex",justifyContent:"center",gap:"10px"},children:[(0,N.jsx)("button",{onClick:()=>(e=>{Le(e),Ie(!0)})(e),title:"Edit company",style:{background:"transparent",color:"#00ff00",border:"none",padding:"4px",cursor:"pointer",display:"flex",alignItems:"center"},children:(0,N.jsx)(B.SG1,{size:16})}),(0,N.jsx)("button",{onClick:()=>(async e=>{try{if(!e)throw new Error("Contact company ID is required");nt.Ay.loading("Removing company association...",{id:"remove-company"});const{error:t}=await D.supabase.from("contact_companies").delete().eq("contact_companies_id",e);if(t)throw console.error("Error deleting company association:",t),t;oo((t=>t.filter((t=>t.contact_companies_id!==e)))),nt.Ay.dismiss("remove-company"),nt.Ay.success("Company association removed successfully")}catch(t){console.error("Error removing company association:",t),nt.Ay.dismiss("remove-company"),nt.Ay.error("Failed to remove company association"),mo()}})(e.contact_companies_id),title:"Remove association",style:{background:"transparent",color:"#00ff00",border:"none",padding:"4px",cursor:"pointer",display:"flex",alignItems:"center"},children:(0,N.jsx)(B.yGN,{size:16})})]})})]},e.contact_companies_id))):co?(0,N.jsx)("tr",{children:(0,N.jsxs)("td",{colSpan:"5",style:{padding:"20px",textAlign:"center",color:"#999",height:"80px"},children:["No companies associated with this contact."," ",(0,N.jsx)("span",{onClick:()=>Ge(!0),style:{color:"#00ff00",cursor:"pointer",textDecoration:"underline"},children:"Associate a company"})]})}):(0,N.jsx)("tr",{children:(0,N.jsx)("td",{colSpan:"5",style:{padding:"20px",textAlign:"center",color:"#999",height:"80px"},children:"Loading companies..."})})]})]})]})})]})]}),"deals"===Co&&(0,N.jsx)(N.Fragment,{children:(0,N.jsxs)("div",{style:{marginBottom:"20px"},children:[(0,N.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"15px"},children:[(0,N.jsx)("h3",{style:{margin:0,color:"#00ff00"},children:"Deals"}),(0,N.jsxs)("button",{type:"button",style:{backgroundColor:"rgba(0, 255, 0, 0.1)",border:"1px solid rgba(0, 255, 0, 0.3)",borderRadius:"4px",display:"flex",alignItems:"center",justifyContent:"center",cursor:"pointer",padding:"8px 12px",gap:"5px"},onClick:()=>{P("list"),k(!0),Bo("")},children:[(0,N.jsx)(B.GGD,{size:16,color:"#00ff00"}),(0,N.jsx)("span",{style:{color:"#00ff00"},children:"Add Deal"})]})]}),(0,N.jsx)(sR,{style:{marginBottom:"15px"}}),(0,N.jsx)("div",{style:{position:"relative",minHeight:"200px",padding:"10px 0",marginBottom:"20px"},children:_?(0,N.jsx)("div",{style:{display:"flex",justifyContent:"center",alignItems:"center",height:"200px",color:"#999"},children:"Loading deals..."}):(0,N.jsx)("div",{children:(0,N.jsx)("div",{style:{display:"flex",flexDirection:"column",gap:"16px",marginBottom:"20px"},children:w&&w.length>0?w.map((e=>(0,N.jsxs)("div",{style:{position:"relative",backgroundColor:"#1a1a1a",borderRadius:"8px",border:"1px solid #333",padding:"15px",height:"auto",minHeight:"180px",display:"flex",flexDirection:"column",transition:"all 0.2s ease"},onMouseEnter:e=>{e.currentTarget.style.backgroundColor="#222",e.currentTarget.style.borderColor="#444"},onMouseLeave:e=>{e.currentTarget.style.backgroundColor="#1a1a1a",e.currentTarget.style.borderColor="#333"},children:[(0,N.jsx)("div",{style:{position:"absolute",top:"10px",right:"10px",width:"24px",height:"24px",borderRadius:"50%",backgroundColor:"rgba(255, 0, 0, 0.1)",display:"flex",justifyContent:"center",alignItems:"center",cursor:"pointer",zIndex:2,transition:"all 0.2s ease"},onClick:t=>{if(t.stopPropagation(),window.confirm(`Are you sure you want to remove association with "${e.opportunity}"?`))try{D.supabase.from("deals_contacts").delete().eq("deals_contacts_id",e.deals_contacts_id).then((e=>{let{error:t}=e;if(t)throw t;nt.Ay.success("Deal association removed"),Ho()})).catch((e=>{console.error("Error removing deal association:",e),nt.Ay.error("Failed to remove deal association")}))}catch(o){console.error("Error removing deal association:",o),nt.Ay.error("Failed to remove deal association")}},onMouseEnter:e=>{e.currentTarget.style.backgroundColor="rgba(255, 0, 0, 0.3)"},onMouseLeave:e=>{e.currentTarget.style.backgroundColor="rgba(255, 0, 0, 0.1)"},children:(0,N.jsx)(B.yGN,{size:14,color:"#ff5555"})}),(0,N.jsx)("div",{style:{marginBottom:"15px",display:"flex",alignItems:"center",padding:"0 0 10px 0",borderBottom:"1px solid #333"},children:(0,N.jsx)("div",{style:{flex:1,overflow:"hidden",paddingLeft:"0"},children:(0,N.jsx)("div",{contentEditable:!0,suppressContentEditableWarning:!0,style:{fontWeight:"bold",color:"#eee",fontSize:"1.2rem",padding:"0",overflow:"hidden",textOverflow:"ellipsis",outline:"none",marginLeft:"0"},onFocus:e=>{e.currentTarget.style.borderBottom="1px dashed #00ffff",e.stopPropagation()},onBlur:e=>{e.currentTarget.style.borderBottom="none",console.log("Deal name edited:",e.currentTarget.textContent)},onClick:e=>{e.stopPropagation()},children:e.opportunity})})}),(0,N.jsxs)("div",{style:{flex:1,display:"flex",flexDirection:"column"},children:[(0,N.jsxs)("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr 2fr",gap:"12px",marginBottom:"15px",fontSize:"0.9rem"},children:[(0,N.jsxs)("div",{className:"deal-attribute",children:[(0,N.jsx)("div",{style:{color:"#999",fontSize:"0.85rem",marginBottom:"3px"},children:"Value"}),(0,N.jsx)("div",{style:{color:"#00ff00",fontWeight:"bold"},children:e.total_investment?`$${e.total_investment.toLocaleString()}`:"Not set"})]}),(0,N.jsxs)("div",{className:"deal-attribute",children:[(0,N.jsx)("div",{style:{color:"#999",fontSize:"0.85rem",marginBottom:"3px"},children:"Category"}),(0,N.jsx)("div",{style:{color:"#eee",backgroundColor:"rgba(0, 255, 255, 0.1)",padding:"2px 8px",borderRadius:"4px",fontSize:"0.85rem",display:"inline-block"},children:e.category||"Not set"})]}),(0,N.jsxs)("div",{className:"deal-attribute",children:[(0,N.jsx)("div",{style:{color:"#999",fontSize:"0.85rem",marginBottom:"3px"},children:"Role"}),(0,N.jsx)("div",{style:{color:"#eee"},children:e.relationship||"Not specified"})]}),(0,N.jsxs)("div",{className:"deal-attribute",children:[(0,N.jsx)("div",{style:{color:"#999",fontSize:"0.85rem",marginBottom:"3px"},children:"Source"}),(0,N.jsx)("div",{style:{color:"#eee",backgroundColor:"rgba(255, 165, 0, 0.1)",padding:"2px 8px",borderRadius:"4px",fontSize:"0.85rem",display:"inline-block"},children:e.source_category||"Not set"})]}),(0,N.jsxs)("div",{className:"deal-attribute",children:[(0,N.jsx)("div",{style:{color:"#999",fontSize:"0.85rem",marginBottom:"3px"},children:"Created"}),(0,N.jsxs)("div",{style:{color:"#eee",display:"flex",alignItems:"center",gap:"4px"},children:[(0,N.jsx)(B.wIk,{size:12}),new Date(e.created_at).toLocaleDateString()]})]}),(0,N.jsxs)("div",{className:"deal-attribute",children:[(0,N.jsx)("div",{style:{color:"#999",fontSize:"0.85rem",marginBottom:"3px"},children:"Last Updated"}),(0,N.jsxs)("div",{style:{color:"#eee",display:"flex",alignItems:"center",gap:"4px"},children:[(0,N.jsx)(B.wIk,{size:12}),new Date(e.last_modified_at).toLocaleDateString()]})]}),(0,N.jsxs)("div",{className:"deal-attribute",children:[(0,N.jsx)("div",{style:{color:"#999",fontSize:"0.85rem",marginBottom:"3px"},children:"Attachments"}),(0,N.jsxs)("div",{style:{color:"#eee",display:"flex",alignItems:"center",gap:"4px"},children:[(0,N.jsx)(B.QuH,{size:12}),L[e.deal_id]?`${L[e.deal_id]} attachment${1!==L[e.deal_id]?"s":""}`:"0 attachments"]})]}),(0,N.jsxs)("div",{className:"deal-attribute",children:[(0,N.jsx)("div",{style:{color:"#999",fontSize:"0.85rem",marginBottom:"3px"},children:"Stage"}),(0,N.jsx)(yR,{bg:"Closed Won"===e.stage?"rgba(0, 255, 0, 0.2)":"Closed Lost"===e.stage?"rgba(255, 0, 0, 0.2)":"rgba(255, 165, 0, 0.2)",color:"Closed Won"===e.stage?"#00ff00":"Closed Lost"===e.stage?"#ff5555":"#ffaa00",borderColor:"Closed Won"===e.stage?"#00ff00":"Closed Lost"===e.stage?"#ff5555":"#ffaa00",children:e.stage})]}),(0,N.jsxs)("div",{className:"deal-attribute",style:{gridColumn:"3 / 4",gridRow:"1 / 5",display:"flex",flexDirection:"column",width:"100%"},children:[(0,N.jsx)("div",{style:{color:"#999",fontSize:"0.85rem",marginBottom:"3px"},children:"Description"}),(0,N.jsx)("div",{style:{flex:1,color:"#bbb",fontSize:"0.9rem",backgroundColor:"rgba(0, 0, 0, 0.2)",borderRadius:"4px",padding:"12px",height:"100%",minHeight:"120px",overflow:"auto",lineHeight:"1.5"},children:e.description||"No description provided for this deal."})]})]}),(0,N.jsxs)("div",{style:{marginBottom:"15px"},children:[(0,N.jsx)("div",{style:{color:"#999",fontSize:"0.85rem",marginBottom:"3px"},children:"Tags"}),(0,N.jsx)("div",{style:{display:"flex",flexWrap:"wrap",gap:"4px"},children:I[e.deal_id]&&I[e.deal_id].length>0?I[e.deal_id].map((e=>(0,N.jsx)("span",{style:{backgroundColor:`rgba(${e.color?e.color:"0, 255, 255"}, 0.1)`,padding:"2px 6px",borderRadius:"4px",fontSize:"0.8rem",color:e.color||"#00ffff",border:`1px solid rgba(${e.color?e.color:"0, 255, 255"}, 0.3)`},children:e.name},e.entry_id))):(0,N.jsx)("span",{style:{color:"#777",fontStyle:"italic",fontSize:"0.8rem"},children:"No tags"})})]}),(0,N.jsx)("div",{style:{margin:"auto 0 15px 0"}}),(0,N.jsxs)("button",{type:"button",style:{backgroundColor:"rgba(0, 255, 0, 0.1)",border:"1px solid rgba(0, 255, 0, 0.3)",borderRadius:"4px",display:"flex",alignItems:"center",justifyContent:"center",cursor:"pointer",padding:"5px 10px",gap:"5px",margin:"5px 0",width:"100%",position:"relative",zIndex:5},onClick:t=>{t.preventDefault(),t.stopPropagation();try{!function(){const t=document.createElement("div");t.id="direct-edit-deal-modal-container",document.body.appendChild(t);const o=JSON.parse(JSON.stringify(e));console.log("Directly opening edit modal for deal:",e.deal_id);const n=()=>{console.log("Direct modal closed");try{document.body.contains(t)&&document.body.removeChild(t)}catch(at){console.error("Error closing modal:",at)}},r=document.createElement("dialog");r.id="edit-deal-dialog",r.style.border="1px solid #444",r.style.borderRadius="8px",r.style.padding="20px",r.style.backgroundColor="#222",r.style.color="#fff",r.style.maxWidth="600px",r.style.width="90%",r.innerHTML=`\n                                                <div style="display: flex; justify-content: space-between; margin-bottom: 20px; border-bottom: 1px solid #333; padding-bottom: 10px;">\n                                                  <h2 style="color: #00ff00; margin: 0;">Edit Deal</h2>\n                                                  <button id="close-modal-btn" style="background: none; border: none; color: #fff; cursor: pointer; font-size: 20px;">\xd7</button>\n                                                </div>\n                                                \n                                                <form id="edit-deal-form">\n                                                  <div style="margin-bottom: 15px;">\n                                                    <label style="display: block; margin-bottom: 5px; color: #aaa;">Name</label>\n                                                    <input id="deal-name" type="text" value="${o.opportunity||""}" style="width: 100%; padding: 8px; background: #333; color: #fff; border: 1px solid #444; border-radius: 4px;">\n                                                  </div>\n                                                  \n                                                  <div style="margin-bottom: 15px;">\n                                                    <label style="display: block; margin-bottom: 5px; color: #aaa;">Stage</label>\n                                                    <select id="deal-stage" style="width: 100%; padding: 8px; background: #333; color: #fff; border: 1px solid #444; border-radius: 4px;">\n                                                      <option value="Lead" ${"Lead"===o.stage?"selected":""}>Lead</option>\n                                                      <option value="Evaluating" ${"Evaluating"===o.stage?"selected":""}>Evaluating</option>\n                                                      <option value="Closing" ${"Closing"===o.stage?"selected":""}>Closing</option>\n                                                      <option value="Invested" ${"Invested"===o.stage?"selected":""}>Invested</option>\n                                                      <option value="Monitoring" ${"Monitoring"===o.stage?"selected":""}>Monitoring</option>\n                                                      <option value="Passed" ${"Passed"===o.stage?"selected":""}>Passed</option>\n                                                    </select>\n                                                  </div>\n                                                  \n                                                  <div style="margin-bottom: 15px;">\n                                                    <label style="display: block; margin-bottom: 5px; color: #aaa;">Description</label>\n                                                    <textarea id="deal-description" style="width: 100%; padding: 8px; background: #333; color: #fff; border: 1px solid #444; border-radius: 4px; min-height: 100px;">${o.description||""}</textarea>\n                                                  </div>\n                                                  \n                                                  <div style="display: flex; justify-content: flex-end; gap: 10px; margin-top: 20px;">\n                                                    <button id="cancel-modal-btn" type="button" style="padding: 8px 16px; background: #333; color: #fff; border: none; border-radius: 4px; cursor: pointer;">Cancel</button>\n                                                    <button id="save-modal-btn" type="button" style="padding: 8px 16px; background: #00ff00; color: #000; border: none; border-radius: 4px; cursor: pointer;">Save Changes</button>\n                                                  </div>\n                                                </form>\n                                              `,t.appendChild(r),r.showModal(),document.getElementById("close-modal-btn").addEventListener("click",n),document.getElementById("cancel-modal-btn").addEventListener("click",n),document.getElementById("save-modal-btn").addEventListener("click",(async()=>{try{const e=document.getElementById("deal-name").value,t={opportunity:e,stage:document.getElementById("deal-stage").value,description:document.getElementById("deal-description").value,last_modified_at:(new Date).toISOString()};console.log("Updating deal with:",t);const{data:r,error:i}=await D.supabase.from("deals").update(t).eq("deal_id",o.deal_id).select();if(i)throw i;console.log("Deal updated successfully:",r),nt.Ay.success("Deal updated successfully"),n(),Ho()}catch(e){console.error("Error updating deal:",e),nt.Ay.error("Failed to update: "+e.message)}}))}()}catch(at){console.error("Error opening edit deal modal:",at),alert("Failed to open edit modal. Please check console for details.")}},title:"Edit deal",children:[(0,N.jsx)(B.SG1,{size:14,color:"#00ff00"}),(0,N.jsx)("span",{style:{color:"#00ff00",fontSize:"0.85rem"},children:"Edit Deal"})]})]})]},e.deal_id))):null})})})]})}),"introductions"===Co&&(0,N.jsxs)(N.Fragment,{children:[(0,N.jsxs)("div",{style:{marginBottom:"20px"},children:[(0,N.jsx)(sR,{style:{marginBottom:"15px"}}),(0,N.jsx)("div",{style:{position:"relative",minHeight:"200px",padding:"10px 0",marginBottom:"20px"},children:H?(0,N.jsx)("div",{style:{display:"flex",justifyContent:"center",alignItems:"center",height:"200px",color:"#999"},children:"Loading introductions..."}):(0,N.jsxs)("div",{children:[(0,N.jsx)("div",{style:{display:"flex",justifyContent:"flex-end",marginBottom:"20px"},children:(0,N.jsxs)("button",{onClick:()=>{console.log("Opening introduction modal from main button"),U(!0)},style:{backgroundColor:"#00ff00",color:"#000",border:"none",borderRadius:"4px",padding:"10px 16px",cursor:"pointer",display:"flex",alignItems:"center",gap:"8px",fontWeight:"500"},children:[(0,N.jsx)(B.GGD,{size:16}),"Add Introduction"]})}),(0,N.jsx)("div",{style:{backgroundColor:"#111",borderRadius:"8px",border:"1px solid #333",overflow:"hidden"},children:0===G.length?(0,N.jsxs)("div",{style:{padding:"40px 20px",textAlign:"center",color:"#777"},children:[(0,N.jsx)("div",{style:{marginBottom:"15px"},children:(0,N.jsx)(B.cfS,{size:30,color:"#444"})}),(0,N.jsx)("p",{children:"No introductions found for this contact."}),(0,N.jsxs)("button",{onClick:()=>{console.log("Opening introduction modal from main button"),U(!0)},style:{backgroundColor:"transparent",color:"#00ff00",border:"1px solid #00ff00",borderRadius:"4px",padding:"8px 16px",marginTop:"15px",cursor:"pointer",display:"inline-flex",alignItems:"center",gap:"8px",fontSize:"0.9rem"},children:[(0,N.jsx)(B.GGD,{size:14}),"Add Introduction"]})]}):(0,N.jsxs)(N.Fragment,{children:[(0,N.jsxs)("div",{style:{display:"grid",gridTemplateColumns:"150px 1fr 200px",padding:"12px 16px",borderBottom:"1px solid #333",backgroundColor:"#222",fontWeight:"500",color:"#aaa",fontSize:"0.9rem"},children:[(0,N.jsx)("div",{children:"Date"}),(0,N.jsx)("div",{children:"Contacts"}),(0,N.jsx)("div",{children:"Rationale"})]}),G.map((e=>(0,N.jsxs)("div",{style:{display:"grid",gridTemplateColumns:"150px 1fr 200px",padding:"16px",borderBottom:"1px solid #222",alignItems:"center",cursor:"pointer",transition:"background-color 0.2s",backgroundColor:"transparent","&:hover":{backgroundColor:"#1a1a1a"}},onClick:()=>{q(e),U(!0)},onMouseEnter:e=>e.currentTarget.style.backgroundColor="#1a1a1a",onMouseLeave:e=>e.currentTarget.style.backgroundColor="transparent",children:[(0,N.jsxs)("div",{style:{color:"#ccc",display:"flex",alignItems:"center",gap:"5px"},children:[(0,N.jsx)("span",{style:{color:"#999"},children:(0,N.jsx)(B.wIk,{size:14})}),new Date(e.intro_date).toLocaleDateString()]}),(0,N.jsxs)("div",{children:[(0,N.jsx)("span",{style:{color:"#00ff00"},children:e.contact_names||(e.contact_ids?`${e.contact_ids.length} contacts`:"No contacts")}),e.introduction_note&&(0,N.jsx)("div",{style:{fontSize:"0.85rem",color:"#999",marginTop:"5px",maxWidth:"500px",overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"},children:e.introduction_note})]}),(0,N.jsx)("div",{children:(0,N.jsx)("span",{style:{display:"inline-block",padding:"4px 10px",borderRadius:"12px",fontSize:"0.8rem",backgroundColor:"Karma Points"===e.introduction_rationale?"#143601":"Dealflow"===e.introduction_rationale?"#2C1A00":"Portfolio Company"===e.introduction_rationale?"#0A1C2E":"#2a2a2a",color:"Karma Points"===e.introduction_rationale?"#00ff00":"Dealflow"===e.introduction_rationale?"#FFBB00":"Portfolio Company"===e.introduction_rationale?"#47A3FF":"#ccc"},children:e.introduction_rationale||"Other"})})]},e.intro_id)))]})})]})})]}),$&&(0,N.jsx)(Fo.A,{isOpen:$,onRequestClose:()=>{console.log("Closing introduction modal, selected intro:",W),U(!1),q(null),Mo()},preSelectedContact:c,editingIntro:W})]}),"notes"===Co&&(0,N.jsxs)(N.Fragment,{children:[(0,N.jsxs)(cR,{children:[(0,N.jsxs)(lR,{children:["Rating",u&&u.rating&&` - Airtable Rating: ${u.rating}`]}),(0,N.jsx)("div",{style:{background:"#222",padding:"12px",borderRadius:"4px",marginBottom:"20px"},children:(0,N.jsxs)("div",{style:{display:"flex",gap:"8px"},children:[[1,2,3,4,5].map((e=>(0,N.jsx)("div",{onClick:()=>tn("score",e===Tt.score?null:e),style:{cursor:"pointer",color:Tt.score>=e?"#ffbb00":"#555",fontSize:"24px",display:"flex",alignItems:"center",justifyContent:"center",width:"30px",height:"30px"},children:"\u2605"},e))),(0,N.jsxs)("div",{style:{marginLeft:"10px",color:"#999",fontSize:"14px",alignSelf:"center"},children:[Tt.score?`${Tt.score} of 5`:"Not rated",Tt.score&&(0,N.jsx)("span",{style:{marginLeft:"5px",cursor:"pointer",color:"#777"},onClick:()=>tn("score",null),children:"(clear)"})]})]})})]}),(0,N.jsxs)(cR,{children:[(0,N.jsxs)(lR,{children:["Description",u&&u.description&&` - Airtable: ${u.description}`]}),(0,N.jsx)("div",{style:{background:"#222",padding:"12px",borderRadius:"4px",marginBottom:"20px"},children:Tt.editingDescription?(0,N.jsxs)(N.Fragment,{children:[(0,N.jsx)(hR,{value:Tt.description||"",onChange:e=>tn("description",e.target.value),placeholder:"Add notes or description about this contact...",style:{minHeight:"120px",boxSizing:"border-box",width:"100%"}}),(0,N.jsxs)("div",{style:{fontSize:"12px",color:"#999",marginTop:"8px",display:"flex",justifyContent:"space-between"},children:[(0,N.jsx)("div",{children:Tt.description?`${Tt.description.length} characters`:"No description added"}),(0,N.jsx)("div",{onClick:()=>tn("editingDescription",!1),style:{cursor:"pointer",color:"#00ff00"},children:"Done editing"})]})]}):(0,N.jsxs)(N.Fragment,{children:[(0,N.jsx)("div",{style:{whiteSpace:"pre-wrap",marginBottom:"10px",minHeight:"50px"},children:Tt.description||"No description added"}),(0,N.jsxs)("div",{style:{display:"flex",justifyContent:"flex-end",gap:"10px"},children:[(0,N.jsxs)("div",{onClick:()=>tn("editingDescription",!0),style:{cursor:"pointer",color:"#00ff00",display:"flex",alignItems:"center",gap:"4px"},children:[(0,N.jsx)(B.SG1,{size:14})," Edit"]}),Tt.description&&(0,N.jsxs)("div",{onClick:()=>tn("description",""),style:{cursor:"pointer",color:"#777",display:"flex",alignItems:"center",gap:"4px"},children:[(0,N.jsx)(B.yGN,{size:14})," Clear"]})]})]})})]}),(0,N.jsxs)(cR,{children:[(0,N.jsxs)(lR,{children:["Birthday",u&&u.next_birthday&&` - Airtable Next Birthday: ${u.next_birthday}`]}),(0,N.jsxs)("div",{style:{background:"#222",padding:"12px",borderRadius:"4px",marginBottom:"20px"},children:[(0,N.jsxs)("div",{style:{display:"flex",gap:"10px",alignItems:"center"},children:[(0,N.jsx)(uR,{type:"date",value:Tt.birthday||"",onChange:e=>tn("birthday",e.target.value),style:{flex:1}}),Tt.birthday&&(0,N.jsx)("div",{onClick:()=>tn("birthday",null),style:{cursor:"pointer",color:"#777",fontSize:"14px"},children:"Clear"})]}),(0,N.jsxs)("div",{style:{fontSize:"12px",color:"#999",marginTop:"8px",display:"flex",justifyContent:"space-between"},children:[(0,N.jsx)("div",{children:Tt.birthday?`Birthday: ${new Date(Tt.birthday).toLocaleDateString()}`:"No birthday set"}),Tt.birthday&&(0,N.jsx)("div",{children:(()=>{const e=new Date,t=new Date(Tt.birthday);return`Age: ~${e.getFullYear()-t.getFullYear()} years`})()})]})]})]})]})]}),(0,N.jsxs)(hA,{style:{marginTop:"20px",marginBottom:"20px",width:"calc(100% - 40px)",padding:"0 0 0 20px",justifyContent:"space-between"},children:[(0,N.jsxs)(pA,{onClick:()=>en(2),disabled:b,children:[(0,N.jsx)(B.kRp,{})," Back"]}),(0,N.jsxs)("div",{children:[(0,N.jsxs)(pA,{onClick:gn,disabled:b,style:{marginRight:"10px"},children:["Save to CRM ",(0,N.jsx)(B.YrT,{})]}),(0,N.jsxs)(pA,{variant:"success",onClick:async()=>{if(await(async()=>{try{x(!0);const{error:e}=await D.supabase.from("contacts").update({first_name:Tt.firstName,last_name:Tt.lastName,keep_in_touch_frequency:Tt.keepInTouch,category:Tt.category,linkedin:Tt.linkedIn,job_role:Tt.jobRole||null,description:Tt.description||null,score:Tt.score||null,birthday:Tt.birthday||null,last_modified_at:new Date}).eq("contact_id",r);if(e)throw e;const{data:t,error:o}=await D.supabase.from("contact_emails").select("*").eq("contact_id",r);if(o)throw o;const n=Tt.emails.filter((e=>{var t;return null===(t=e.email_id)||void 0===t?void 0:t.toString().startsWith("temp-")})),i=Tt.emails.filter((e=>{var t;return!(null!==(t=e.email_id)&&void 0!==t&&t.toString().startsWith("temp-"))})),a=i.map((e=>e.email_id)),s=(null===t||void 0===t?void 0:t.filter((e=>!a.includes(e.email_id))))||[];for(const x of n)await D.supabase.from("contact_emails").insert({contact_id:r,email:x.email,type:x.type,is_primary:x.is_primary});for(const r of i)await D.supabase.from("contact_emails").update({email:r.email,type:r.type,is_primary:r.is_primary}).eq("email_id",r.email_id);for(const r of s)await D.supabase.from("contact_emails").delete().eq("email_id",r.email_id);const{data:l,error:c}=await D.supabase.from("contact_mobiles").select("*").eq("contact_id",r);if(c)throw c;const d=Tt.mobiles.filter((e=>{var t;return null===(t=e.mobile_id)||void 0===t?void 0:t.toString().startsWith("temp-")})),u=Tt.mobiles.filter((e=>{var t;return!(null!==(t=e.mobile_id)&&void 0!==t&&t.toString().startsWith("temp-"))})),p=u.map((e=>e.mobile_id)),h=(null===l||void 0===l?void 0:l.filter((e=>!p.includes(e.mobile_id))))||[];for(const x of d)await D.supabase.from("contact_mobiles").insert({contact_id:r,mobile:x.mobile,type:x.type,is_primary:x.is_primary});for(const r of u)await D.supabase.from("contact_mobiles").update({mobile:r.mobile,type:r.type,is_primary:r.is_primary}).eq("mobile_id",r.mobile_id);for(const r of h)await D.supabase.from("contact_mobiles").delete().eq("mobile_id",r.mobile_id);const{data:f,error:g}=await D.supabase.from("contact_tags").select("entry_id, tag_id").eq("contact_id",r);if(g)throw g;const m=(null===f||void 0===f?void 0:f.map((e=>e.tag_id)))||[],y=Tt.tags.filter((e=>{var t;return!m.includes(e.tag_id)&&!(null!==(t=e.tag_id)&&void 0!==t&&t.toString().startsWith("temp-"))})),v=Tt.tags.filter((e=>{var t;return null===(t=e.tag_id)||void 0===t?void 0:t.toString().startsWith("temp-")})),b=Tt.tags.filter((e=>{var t;return!(null!==(t=e.tag_id)&&void 0!==t&&t.toString().startsWith("temp-"))})).map((e=>e.tag_id)),w=(null===f||void 0===f?void 0:f.filter((e=>!b.includes(e.tag_id))))||[];for(const x of v){const{data:e,error:t}=await D.supabase.from("tags").select("tag_id").eq("name",x.name).maybeSingle();let o;if(t)throw t;if(e)o=e.tag_id;else{const{data:e,error:t}=await D.supabase.from("tags").insert({name:x.name}).select("tag_id").single();if(t)throw t;o=e.tag_id}const{error:n}=await D.supabase.from("contact_tags").insert({contact_id:r,tag_id:o});if(n)throw n}for(const x of y){const{error:e}=await D.supabase.from("contact_tags").insert({contact_id:r,tag_id:x.tag_id});if(e)throw e}for(const r of w){const{error:e}=await D.supabase.from("contact_tags").delete().eq("entry_id",r.entry_id);if(e)throw e}const{data:C,error:_}=await D.supabase.from("contact_cities").select("entry_id, city_id").eq("contact_id",r);if(_)throw _;if(Tt.cities&&Tt.cities.length>0){const e=(null===C||void 0===C?void 0:C.map((e=>e.city_id)))||[],t=Tt.cities.filter((t=>{var o;return!e.includes(t.city_id)&&!(null!==(o=t.city_id)&&void 0!==o&&o.toString().startsWith("temp-"))})),o=Tt.cities.filter((e=>{var t;return null===(t=e.city_id)||void 0===t?void 0:t.toString().startsWith("temp-")})),n=Tt.cities.filter((e=>{var t;return!(null!==(t=e.city_id)&&void 0!==t&&t.toString().startsWith("temp-"))})).map((e=>e.city_id)),i=(null===C||void 0===C?void 0:C.filter((e=>!n.includes(e.city_id))))||[];for(const a of o){const{data:e,error:t}=await D.supabase.from("cities").select("city_id").eq("name",a.name).maybeSingle();let o;if(t)throw t;if(e)o=e.city_id;else{const{data:e,error:t}=await D.supabase.from("cities").insert({name:a.name,country:a.country||"Unknown"}).select("city_id").single();if(t)throw t;o=e.city_id}const{error:n}=await D.supabase.from("contact_cities").insert({contact_id:r,city_id:o});if(n)throw n}for(const a of t){const{error:e}=await D.supabase.from("contact_cities").insert({contact_id:r,city_id:a.city_id});if(e)throw e}for(const r of i){const{error:e}=await D.supabase.from("contact_cities").delete().eq("entry_id",r.entry_id);if(e)throw e}}else for(const r of C||[]){const{error:e}=await D.supabase.from("contact_cities").delete().eq("entry_id",r.entry_id);if(e)throw e}const{data:S,error:E}=await D.supabase.from("contact_companies").select("contact_companies_id, company_id, relationship, is_primary").eq("contact_id",r);if(E)throw E;if(Tt.associatedCompanies&&Tt.associatedCompanies.length>0){const e=(null===S||void 0===S?void 0:S.map((e=>e.company_id)))||[],t=Tt.associatedCompanies.filter((t=>!e.includes(t.company_id)&&t.company_id)),o=Tt.associatedCompanies.filter((t=>e.includes(t.company_id)&&S.some((e=>e.company_id===t.company_id&&(e.relationship!==t.relationship||e.is_primary!==t.is_primary))))),n=Tt.associatedCompanies.filter((e=>e.company_id)).map((e=>e.company_id)),i=(null===S||void 0===S?void 0:S.filter((e=>!n.includes(e.company_id))))||[];for(const a of t){const e=["employee","founder","advisor","manager","investor","other","not_set"].includes(a.relationship)?a.relationship:"not_set",{error:t}=await D.supabase.from("contact_companies").insert({contact_id:r,company_id:a.company_id,relationship:e,is_primary:a.is_primary||!1});if(t)throw t}for(const r of o){const e=S.find((e=>e.company_id===r.company_id));if(e){const t=["employee","founder","advisor","manager","investor","other","not_set"].includes(r.relationship)?r.relationship:"not_set",{error:o}=await D.supabase.from("contact_companies").update({relationship:t,is_primary:r.is_primary||!1}).eq("contact_companies_id",e.contact_companies_id);if(o)throw o}}for(const r of i){const{error:e}=await D.supabase.from("contact_companies").delete().eq("contact_companies_id",r.contact_companies_id);if(e)throw e}}else for(const r of S||[]){const{error:e}=await D.supabase.from("contact_companies").delete().eq("contact_companies_id",r.contact_companies_id);if(e)throw e}return await qo(),nt.Ay.success("Contact information saved successfully"),x(!1),!0}catch(e){return console.error("Error saving contact enrichment:",e),nt.Ay.error("Failed to save contact information"),x(!1),!1}})()){const e=["basics","tags","notes","companies","deals","airtable"],t=e.indexOf(Co);t<e.length-1?_o(e[t+1]):gn()}},disabled:b,children:[(0,N.jsx)(B.YrT,{})," Save & Continue"]})]})]})]})]})]})}),(0,N.jsxs)(ot(),{isOpen:ko,onRequestClose:()=>jo(!1),shouldCloseOnOverlayClick:!1,style:{content:{top:"50%",left:"50%",right:"auto",bottom:"auto",marginRight:"-50%",transform:"translate(-50%, -50%)",padding:"25px",maxWidth:"600px",width:"90%",backgroundColor:"#121212",border:"1px solid #333",borderRadius:"8px",boxShadow:"0 4px 20px rgba(0, 0, 0, 0.6)",color:"#e0e0e0",zIndex:1001},overlay:{backgroundColor:"rgba(0, 0, 0, 0.75)",zIndex:1e3}},children:[(0,N.jsxs)(BA,{children:[(0,N.jsx)("h2",{children:"Delete Contact and Associated Data"}),(0,N.jsx)(WA,{onClick:()=>jo(!1),disabled:No,children:(0,N.jsx)(B.yGN,{})})]}),Ao&&(0,N.jsxs)(N.Fragment,{children:[(0,N.jsx)(QA,{children:(0,N.jsx)(ZA,{children:(0,N.jsxs)(tR,{children:[Ao.first_name," ",Ao.last_name,Ao.email?` (${Ao.email})`:Ao.mobile?` (${Ao.mobile})`:""]})})}),(0,N.jsxs)(ZA,{style:{marginTop:"15px",marginBottom:"15px"},children:[(0,N.jsx)(eR,{children:"Last Interaction:"}),(0,N.jsx)(tR,{children:Oo.lastInteraction?Oo.lastInteraction.summary:"None"})]}),(0,N.jsx)(qA,{children:"Select which items to delete:"}),(0,N.jsx)(KA,{children:(0,N.jsxs)(YA,{children:[Oo.interactionsCount>0&&(0,N.jsxs)(JA,{children:[(0,N.jsx)(XA,{type:"checkbox",id:"deleteInteractions",name:"deleteInteractions",checked:Do.deleteInteractions,onChange:hn,disabled:No}),(0,N.jsxs)("label",{htmlFor:"deleteInteractions",children:["Interactions (",Oo.interactionsCount,")"]})]}),Oo.emailsCount>0&&(0,N.jsxs)(JA,{children:[(0,N.jsx)(XA,{type:"checkbox",id:"deleteEmails",name:"deleteEmails",checked:Do.deleteEmails,onChange:hn,disabled:No}),(0,N.jsxs)("label",{htmlFor:"deleteEmails",children:["Emails (",Oo.emailsCount,")"]})]}),Oo.emailParticipantsCount>0&&(0,N.jsxs)(JA,{children:[(0,N.jsx)(XA,{type:"checkbox",id:"deleteEmailParticipants",name:"deleteEmailParticipants",checked:Do.deleteEmailParticipants,onChange:hn,disabled:No}),(0,N.jsxs)("label",{htmlFor:"deleteEmailParticipants",children:["Email Participants (",Oo.emailParticipantsCount,")"]})]}),Oo.emailThreadsCount>0&&(0,N.jsxs)(JA,{children:[(0,N.jsx)(XA,{type:"checkbox",id:"deleteEmailThreads",name:"deleteEmailThreads",checked:Do.deleteEmailThreads,onChange:hn,disabled:No}),(0,N.jsxs)("label",{htmlFor:"deleteEmailThreads",children:["Email Threads (",Oo.emailThreadsCount,")"]})]}),Oo.contactEmailsCount>0&&(0,N.jsxs)(JA,{children:[(0,N.jsx)(XA,{type:"checkbox",id:"deleteContactEmails",name:"deleteContactEmails",checked:Do.deleteContactEmails,onChange:hn,disabled:No}),(0,N.jsxs)("label",{htmlFor:"deleteContactEmails",children:["Email Addresses (",Oo.contactEmailsCount,")"]})]}),Oo.contactMobilesCount>0&&(0,N.jsxs)(JA,{children:[(0,N.jsx)(XA,{type:"checkbox",id:"deleteContactMobiles",name:"deleteContactMobiles",checked:Do.deleteContactMobiles,onChange:hn,disabled:No}),(0,N.jsxs)("label",{htmlFor:"deleteContactMobiles",children:["Mobile Numbers (",Oo.contactMobilesCount,")"]})]}),Oo.chatCount>0&&(0,N.jsxs)(JA,{children:[(0,N.jsx)(XA,{type:"checkbox",id:"deleteChat",name:"deleteChat",checked:Do.deleteChat,onChange:hn,disabled:No}),(0,N.jsxs)("label",{htmlFor:"deleteChat",children:["Chat messages (",Oo.chatCount,")"]})]}),Oo.contactChatsCount>0&&(0,N.jsxs)(JA,{children:[(0,N.jsx)(XA,{type:"checkbox",id:"deleteContactChats",name:"deleteContactChats",checked:Do.deleteContactChats,onChange:hn,disabled:No}),(0,N.jsxs)("label",{htmlFor:"deleteContactChats",children:["Chat Links (",Oo.contactChatsCount,")"]})]}),Oo.notesCount>0&&(0,N.jsxs)(JA,{children:[(0,N.jsx)(XA,{type:"checkbox",id:"deleteNotes",name:"deleteNotes",checked:Do.deleteNotes,onChange:hn,disabled:No}),(0,N.jsxs)("label",{htmlFor:"deleteNotes",children:["Notes (",Oo.notesCount,")"]})]}),Oo.attachmentsCount>0&&(0,N.jsxs)(JA,{children:[(0,N.jsx)(XA,{type:"checkbox",id:"deleteAttachments",name:"deleteAttachments",checked:Do.deleteAttachments,onChange:hn,disabled:No}),(0,N.jsxs)("label",{htmlFor:"deleteAttachments",children:["Attachments (",Oo.attachmentsCount,")"]})]}),Oo.tagsCount>0&&(0,N.jsxs)(JA,{children:[(0,N.jsx)(XA,{type:"checkbox",id:"deleteTags",name:"deleteTags",checked:Do.deleteTags,onChange:hn,disabled:No}),(0,N.jsxs)("label",{htmlFor:"deleteTags",children:["Tags (",Oo.tagsCount,")"]})]}),Oo.citiesCount>0&&(0,N.jsxs)(JA,{children:[(0,N.jsx)(XA,{type:"checkbox",id:"deleteCities",name:"deleteCities",checked:Do.deleteCities,onChange:hn,disabled:No}),(0,N.jsxs)("label",{htmlFor:"deleteCities",children:["Cities (",Oo.citiesCount,")"]})]}),Oo.companiesCount>0&&(0,N.jsxs)(JA,{children:[(0,N.jsx)(XA,{type:"checkbox",id:"deleteCompanies",name:"deleteCompanies",checked:Do.deleteCompanies,onChange:hn,disabled:No}),(0,N.jsxs)("label",{htmlFor:"deleteCompanies",children:["Companies (",Oo.companiesCount,")"]})]}),Oo.dealsCount>0&&(0,N.jsxs)(JA,{children:[(0,N.jsx)(XA,{type:"checkbox",id:"deleteDeals",name:"deleteDeals",checked:Do.deleteDeals,onChange:hn,disabled:No}),(0,N.jsxs)("label",{htmlFor:"deleteDeals",children:["Deals (",Oo.dealsCount,")"]})]}),Oo.meetingsCount>0&&(0,N.jsxs)(JA,{children:[(0,N.jsx)(XA,{type:"checkbox",id:"deleteMeetings",name:"deleteMeetings",checked:Do.deleteMeetings,onChange:hn,disabled:No}),(0,N.jsxs)("label",{htmlFor:"deleteMeetings",children:["Meetings (",Oo.meetingsCount,")"]})]}),Oo.investmentsCount>0&&(0,N.jsxs)(JA,{children:[(0,N.jsx)(XA,{type:"checkbox",id:"deleteInvestments",name:"deleteInvestments",checked:Do.deleteInvestments,onChange:hn,disabled:No}),(0,N.jsxs)("label",{htmlFor:"deleteInvestments",children:["Investments (",Oo.investmentsCount,")"]})]}),Oo.kitCount>0&&(0,N.jsxs)(JA,{children:[(0,N.jsx)(XA,{type:"checkbox",id:"deleteKit",name:"deleteKit",checked:Do.deleteKit,onChange:hn,disabled:No}),(0,N.jsxs)("label",{htmlFor:"deleteKit",children:["Keep In Touch (",Oo.kitCount,")"]})]}),Ao.email&&(0,N.jsxs)(JA,{children:[(0,N.jsx)(XA,{type:"checkbox",id:"addToSpam",name:"addToSpam",checked:Do.addToSpam,onChange:hn,disabled:No}),(0,N.jsx)("label",{htmlFor:"addToSpam",children:"Add email to spam list"})]}),Ao.mobile&&(0,N.jsxs)(JA,{children:[(0,N.jsx)(XA,{type:"checkbox",id:"addMobileToSpam",name:"addMobileToSpam",checked:Do.addMobileToSpam,onChange:hn,disabled:No}),(0,N.jsx)("label",{htmlFor:"addMobileToSpam",children:"Add mobile to WhatsApp spam list"})]})]})}),(0,N.jsxs)(hA,{children:[(0,N.jsxs)(LA,{onClick:()=>jo(!1),disabled:No,children:[(0,N.jsx)(B.yGN,{})," Cancel"]}),(0,N.jsx)(oR,{onClick:async()=>{if(Ao)try{if(Io(!0),Do.addToSpam&&Ao.email){const{error:e}=await D.supabase.from("emails_spam").insert([{email:Ao.email,counter:1}]);e&&console.error("Error adding to spam list:",e)}if(Do.addMobileToSpam&&Ao.mobile){const{error:e}=await D.supabase.from("whatsapp_spam").insert([{mobile_number:Ao.mobile,counter:1,created_at:(new Date).toISOString(),last_modified_at:(new Date).toISOString()}]);e&&console.error("Error adding to WhatsApp spam list:",e)}const e=[];if(Do.deleteChat&&Oo.chatCount>0&&e.push(D.supabase.from("chat").delete().eq("contact_id",Ao.contact_id)),Do.deleteInteractions&&Oo.interactionsCount>0&&e.push(D.supabase.from("interactions").delete().eq("contact_id",Ao.contact_id)),Do.deleteEmails&&Oo.emailsCount>0){const{data:t}=await D.supabase.from("emails").select("email_id").eq("sender_contact_id",Ao.contact_id);if(t&&t.length>0){const o=t.map((e=>e.email_id));e.push(D.supabase.from("email_participants").delete().in("email_id",o)),e.push(D.supabase.from("emails").delete().eq("sender_contact_id",Ao.contact_id))}}Do.deleteEmailThreads&&Oo.emailThreadsCount>0&&e.push(D.supabase.from("contact_email_threads").delete().eq("contact_id",Ao.contact_id)),Do.deleteContactEmails&&Oo.contactEmailsCount>0&&e.push(D.supabase.from("contact_emails").delete().eq("contact_id",Ao.contact_id)),Do.deleteContactMobiles&&Oo.contactMobilesCount>0&&e.push(D.supabase.from("contact_mobiles").delete().eq("contact_id",Ao.contact_id)),Do.deleteNotes&&Oo.notesCount>0&&e.push(D.supabase.from("notes_contacts").delete().eq("contact_id",Ao.contact_id)),Do.deleteAttachments&&Oo.attachmentsCount>0&&e.push(D.supabase.from("attachments").delete().eq("contact_id",Ao.contact_id)),Do.deleteTags&&Oo.tagsCount>0&&e.push(D.supabase.from("contact_tags").delete().eq("contact_id",Ao.contact_id)),Do.deleteCities&&Oo.citiesCount>0&&e.push(D.supabase.from("contact_cities").delete().eq("contact_id",Ao.contact_id)),Do.deleteCompanies&&Oo.companiesCount>0&&e.push(D.supabase.from("contact_companies").delete().eq("contact_id",Ao.contact_id)),Do.deleteContactChats&&Oo.contactChatsCount>0&&e.push(D.supabase.from("contact_chats").delete().eq("contact_id",Ao.contact_id)),Do.deleteDeals&&Oo.dealsCount>0&&e.push(D.supabase.from("deals_contacts").delete().eq("contact_id",Ao.contact_id)),Do.deleteMeetings&&Oo.meetingsCount>0&&e.push(D.supabase.from("meeting_contacts").delete().eq("contact_id",Ao.contact_id)),Do.deleteInvestments&&Oo.investmentsCount>0&&e.push(D.supabase.from("investments_contacts").delete().eq("contact_id",Ao.contact_id)),Do.deleteKit&&Oo.kitCount>0&&e.push(D.supabase.from("keep_in_touch").delete().eq("contact_id",Ao.contact_id)),await Promise.all(e);const{error:t}=await D.supabase.from("contacts").delete().eq("contact_id",Ao.contact_id);if(t)throw t;jo(!1),Ro(null),Io(!1),nt.Ay.success("Contact successfully deleted"),a("/contacts/inbox")}catch(e){console.error("Error deleting contact:",e),st(`Failed to delete contact: ${e.message||"Unknown error"}`),Io(!1)}},disabled:No,children:No?"Deleting...":(0,N.jsxs)(N.Fragment,{children:[(0,N.jsx)(B.IXo,{})," Delete Contact"]})})]})]})]}),(0,N.jsxs)(ot(),{isOpen:Oe,onRequestClose:()=>{Te(!1),it({name:"",category:"",website:"",description:"",linkedin:""})},style:{content:{top:"50%",left:"50%",right:"auto",bottom:"auto",marginRight:"-50%",transform:"translate(-50%, -50%)",padding:"25px",maxWidth:"500px",width:"90%",backgroundColor:"#121212",border:"1px solid #333",borderRadius:"8px",boxShadow:"0 4px 20px rgba(0, 0, 0, 0.6)",color:"#e0e0e0",zIndex:1001},overlay:{backgroundColor:"rgba(0, 0, 0, 0.75)",zIndex:1e3}},children:[(0,N.jsxs)(BA,{children:[(0,N.jsx)("h2",{children:"Add New Company"}),(0,N.jsx)(WA,{onClick:()=>{Te(!1),it({name:"",category:"",website:"",description:"",linkedin:""})},children:(0,N.jsx)(B.yGN,{})})]}),(0,N.jsxs)("div",{style:{marginBottom:"20px"},children:[(0,N.jsxs)(cR,{children:[(0,N.jsx)(lR,{children:"Company Name*"}),(0,N.jsx)(uR,{type:"text",value:rt.name,onChange:e=>it({...rt,name:e.target.value}),placeholder:"Enter company name",style:{width:"100%"}})]}),(0,N.jsxs)(cR,{children:[(0,N.jsx)(lR,{children:"Category*"}),(0,N.jsxs)(pR,{value:rt.category,onChange:e=>it({...rt,category:e.target.value}),style:{width:"100%",padding:"10px",backgroundColor:"#222",borderColor:"#444",color:"#eee"},children:[(0,N.jsx)("option",{value:"",children:"Select a category"}),(0,N.jsx)("option",{value:"Advisory",children:"Advisory"}),(0,N.jsx)("option",{value:"Corporation",children:"Corporation"}),(0,N.jsx)("option",{value:"Institution",children:"Institution"}),(0,N.jsx)("option",{value:"Media",children:"Media"}),(0,N.jsx)("option",{value:"Professional Investor",children:"Professional Investor"}),(0,N.jsx)("option",{value:"Skip",children:"Skip"}),(0,N.jsx)("option",{value:"SME",children:"SME"}),(0,N.jsx)("option",{value:"Startup",children:"Startup"})]})]}),(0,N.jsxs)(cR,{children:[(0,N.jsx)(lR,{children:"Website"}),(0,N.jsx)(uR,{type:"text",value:rt.website,onChange:e=>it({...rt,website:e.target.value}),placeholder:"Enter company website",style:{width:"100%"}})]}),(0,N.jsxs)(cR,{children:[(0,N.jsx)(lR,{children:"LinkedIn"}),(0,N.jsx)(uR,{type:"text",value:rt.linkedin,onChange:e=>it({...rt,linkedin:e.target.value}),placeholder:"Enter company LinkedIn URL",style:{width:"100%"}})]}),(0,N.jsxs)(cR,{children:[(0,N.jsx)(lR,{children:"Description"}),(0,N.jsx)(hR,{value:rt.description,onChange:e=>it({...rt,description:e.target.value}),placeholder:"Enter company description",style:{width:"100%",minHeight:"100px"}})]})]}),(0,N.jsxs)(hA,{style:{justifyContent:"flex-end",marginTop:"20px"},children:[(0,N.jsx)(pA,{variant:"secondary",onClick:()=>{Te(!1),it({name:"",category:"",website:"",description:"",linkedin:""})},style:{marginRight:"10px"},children:"Cancel"}),(0,N.jsx)(pA,{variant:"success",onClick:async()=>{if(rt.name)if(rt.category)try{var e,t;x(!0);const{data:o,error:n}=await D.supabase.from("companies").insert({name:rt.name,category:rt.category,website:rt.website||null,linkedin:rt.linkedin||null,description:rt.description||null}).select("*").single();if(n)throw n;const{error:i}=await D.supabase.from("contact_companies").insert({contact_id:r,company_id:o.company_id,relationship:"not_set",is_primary:0===(null===(e=Tt.associatedCompanies)||void 0===e?void 0:e.length)});if(i)throw i;const a={company_id:o.company_id,name:o.name,website:o.website,category:o.category,description:o.description,linkedin:o.linkedin,relationship:"not_set",is_primary:0===(null===(t=Tt.associatedCompanies)||void 0===t?void 0:t.length)};tn("associatedCompanies",[...Tt.associatedCompanies||[],a]),it({name:"",category:"",website:"",description:"",linkedin:""}),Te(!1),nt.Ay.success(`Company ${o.name} created and added`),x(!1)}catch(o){console.error("Error creating company:",o),nt.Ay.error("Failed to create company"),x(!1)}else nt.Ay.error("Category is required");else nt.Ay.error("Company name is required")},disabled:b,children:b?"Creating...":"Create Company"})]})]}),(0,N.jsx)(bS.A,{isOpen:De,onClose:()=>Pe(!1),linkedInUrl:Tt.linkedIn||(null===c||void 0===c?void 0:c.linkedin),contactName:`${(null===c||void 0===c?void 0:c.first_name)||""} ${(null===c||void 0===c?void 0:c.last_name)||""}`.trim(),firstName:null===c||void 0===c?void 0:c.first_name,lastName:null===c||void 0===c?void 0:c.last_name,email:null===c||void 0===c?void 0:c.email,jobRole:Tt.jobRole||(null===c||void 0===c?void 0:c.job_role),onSaveData:async e=>{e.jobRole&&tn("jobRole",e.jobRole);try{const t={job_role:e.jobRole||null},{error:o}=await D.supabase.from("contacts").update(t).eq("contact_id",c.contact_id);if(o)return console.error("Error updating contact data:",o),void nt.Ay.error("Failed to update contact information");if(d((t=>({...t,job_role:e.jobRole||t.job_role}))),e.company){let t=null;if(e.companyWebsite)try{t=new URL(e.companyWebsite).hostname.replace("www.","")}catch(SM){console.log("Invalid URL format, using raw website value"),t=e.companyWebsite}const o=t?D.supabase.from("companies").select("*").ilike("website",`%${t}%`):D.supabase.from("companies").select("*").ilike("name",e.company),{data:n,error:r}=await o;if(r)return console.error("Error searching for company:",r),void nt.Ay.error("Error checking for existing company");let i;if(n&&n.length>0){const t=n[0];i=t.company_id;const o={};if(e.companyDescription&&!t.description&&(o.description=e.companyDescription),e.companyWebsite&&!t.website&&(o.website=e.companyWebsite),Object.keys(o).length>0){const{error:e}=await D.supabase.from("companies").update(o).eq("company_id",i);if(e)return console.error("Error updating company:",e),void nt.Ay.error("Failed to update company information");nt.Ay.success(`Updated company: ${t.name}`)}console.log("Updated existing company:",t.name)}else{const t={name:e.company,website:e.companyWebsite||null,description:e.companyDescription||null,category:"Inbox"},{data:o,error:n}=await D.supabase.from("companies").insert(t).select();if(n)return console.error("Error creating company:",n),void nt.Ay.error("Failed to create company");if(!(o&&o.length>0))return void console.error("Failed to get company ID after creation");i=o[0].company_id,console.log("Created new company:",e.company),nt.Ay.success(`Created new company: ${e.company}`)}if(e.city){const{data:t,error:o}=await D.supabase.from("cities").select("*").ilike("name",e.city);let n;if(o&&console.error("Error searching for city:",o),t&&t.length>0)n=t[0].id;else{const{data:t,error:o}=await D.supabase.from("cities").insert({name:e.city}).select();o?console.error("Error creating city:",o):t&&t.length>0&&(n=t[0].id)}if(n&&i){const{data:t,error:o}=await D.supabase.from("company_cities").select("*").eq("company_id",i).eq("city_id",n);if(o&&console.error("Error checking company-city link:",o),!t||0===t.length){const{error:t}=await D.supabase.from("company_cities").insert({company_id:i,city_id:n});t?(console.error("Error linking company to city:",t),nt.Ay.error("Failed to link company to city")):(console.log("Successfully linked company to city:",e.city),nt.Ay.success(`Linked company to city: ${e.city}`))}}if(n){const{data:t,error:o}=await D.supabase.from("contact_cities").select("*").eq("contact_id",c.contact_id).eq("city_id",n);if(o&&console.error("Error checking contact-city link:",o),!t||0===t.length){const{error:t}=await D.supabase.from("contact_cities").insert({contact_id:c.contact_id,city_id:n});t?(console.error("Error linking contact to city:",t),nt.Ay.error("Failed to link contact to city")):(console.log("Successfully linked contact to city:",e.city),nt.Ay.success(`Linked contact to city: ${e.city}`))}}}if(i){const{data:t,error:o}=await D.supabase.from("contact_companies").select("*").eq("contact_id",c.contact_id).eq("company_id",i);if(o&&console.error("Error checking contact-company relationship:",o),!t||0===t.length){const{error:t}=await D.supabase.from("contact_companies").insert({contact_id:c.contact_id,company_id:i,relationship:"not_set",is_primary:!0});t?(console.error("Error creating contact-company relationship:",t),nt.Ay.error("Failed to link contact to company")):(console.log("Successfully linked contact to company"),nt.Ay.success(`Linked contact to company: ${e.company}`))}}nt.Ay.success(`Job information updated: ${e.jobRole} at ${e.company}`)}else nt.Ay.success("Contact information updated");e.keywords&&e.keywords.length>0&&console.log("Tags available for adding:",e.keywords),nt.Ay.success("Refreshing contact data..."),await qo(),e.company&&await mo(c.contact_id),nt.Ay.success("All data updated and refreshed successfully")}catch(t){console.error("Exception processing LinkedIn data:",t),nt.Ay.error("An error occurred while processing the data")}}}),(0,N.jsx)(Sj,{isOpen:so,onRequestClose:()=>{lo(!1),setTimeout((()=>xo()),500)},company:{id:io}}),(0,N.jsx)(Uw.A,{isOpen:Ne,onRequestClose:()=>{Ie(!1),mo(),xo()},company:Me,contactId:r,onCompanyUpdated:()=>{mo(),xo()}}),(0,N.jsx)(kj.A,{isOpen:Fe,onRequestClose:()=>Ge(!1),contactId:r,onCompanyAssociated:e=>{"create_new"===e.action?(tt(e.name),He(!0)):"associated"===e.action&&(console.log("Company successfully associated, reloading data from Supabase"),setTimeout((()=>{mo()}),500))}}),(0,N.jsx)(uC,{isOpen:ze,onRequestClose:()=>{He(!1),tt("")},initialName:et,contactId:r,onCompanyCreated:e=>{var t;const o={contact_companies_id:null===(t=e.data)||void 0===t?void 0:t.contact_companies_id,company_id:e.company.company_id,relationship:e.relationship||"not_set",is_primary:e.isPrimary||!1,name:e.company.name||"Unknown Company",website:e.company.website||"",category:e.company.category||"Inbox",description:e.company.description||"",linkedin:e.company.linkedin||"",tags:e.tags||[]};console.log("Adding newly created company to state:",o),oo((e=>[...e,o])),uo(!0),setTimeout((()=>xo()),300)}}),(0,N.jsx)(TS,{isOpen:Be,onRequestClose:()=>Ve(!1),contact:c,onUpdateEmails:async e=>{const t={...c,emails:e};d(t),Tt&&Dt((t=>({...t,emails:e})));try{const t=c.contact_id,{data:o}=await D.supabase.from("contact_emails").select("*").eq("contact_id",t),n=(null===o||void 0===o?void 0:o.map((e=>e.email)))||[],r=e.filter((e=>!n.includes(e.email)));if(r.length>0){const e=r.map((e=>({contact_id:t,email:e.email,is_primary:e.is_primary,type:"personal"})));await D.supabase.from("contact_emails").insert(e),nt.Ay.success(`${r.length} new email${r.length>1?"s":""} added`)}const{data:i}=await D.supabase.from("contacts").select("*, emails:contact_emails(*)").eq("contact_id",t).single();i&&d(i)}catch(at){console.error("Error saving emails:",at),nt.Ay.error("Failed to save email changes")}}}),(0,N.jsx)(Fj,{isOpen:$e,onRequestClose:()=>Ue(!1),contact:c,onUpdateMobiles:async e=>{const t={...c,mobiles:e};d(t),Tt&&Dt((t=>({...t,mobiles:e})));try{const t=c.contact_id,{data:o}=await D.supabase.from("contact_mobiles").select("*").eq("contact_id",t),n=(null===o||void 0===o?void 0:o.map((e=>e.mobile)))||[],r=e.filter((e=>!n.includes(e.mobile)));if(r.length>0){const e=r.map((e=>({contact_id:t,mobile:e.mobile,is_primary:e.is_primary,type:"personal"})));await D.supabase.from("contact_mobiles").insert(e),nt.Ay.success(`${r.length} new phone number${r.length>1?"s":""} added`)}const{data:i}=await D.supabase.from("contacts").select("*, mobiles:contact_mobiles(*)").eq("contact_id",t).single();i&&d(i)}catch(at){console.error("Error saving mobile numbers:",at),nt.Ay.error("Failed to save phone number changes")}}}),(0,N.jsx)(Lo.A,{isOpen:We,onRequestClose:()=>qe(!1),contact:c,onCityAdded:e=>{console.log("City added from modal:",e);const t={...Tt};t.cities||(t.cities=[]),t.cities.some((t=>t.city_id===e.city_id))||(t.cities.push(e),Dt(t));const o={...c};o.cities||(o.cities=[]),o.cities.some((t=>t.city_id===e.city_id))||(o.cities.push(e),d(o)),nt.Ay.success(`City "${e.name}" added`)},onCityRemoved:e=>{console.log("City removed from modal:",e);const t={...Tt};t.cities&&t.cities.length>0&&(t.cities=t.cities.filter((t=>t.city_id!==e.id&&t.id!==e.id)),Dt(t));const o={...c};o.cities&&o.cities.length>0&&(o.cities=o.cities.filter((t=>t.city_id!==e.id&&t.id!==e.id)),d(o)),nt.Ay.success(`City "${e.name}" removed`)}}),(0,N.jsx)(pt.A,{isOpen:Ke,onRequestClose:()=>Ye(!1),contact:c,onTagAdded:e=>{console.log("Tag added from modal:",e);const t={...Tt};t.tags||(t.tags=[]),t.tags.some((t=>t.tag_id===e.tag_id||t.id===e.tag_id))||(t.tags.push({id:e.tag_id,tag_id:e.tag_id,name:e.name}),Dt(t));const o={...c};o.tags||(o.tags=[]),o.tags.some((t=>t.tag_id===e.tag_id||t.id===e.tag_id))||(o.tags.push({id:e.tag_id,tag_id:e.tag_id,name:e.name}),d(o)),nt.Ay.success(`Tag "${e.name}" added`)},onTagRemoved:e=>{console.log("Tag removed from modal:",e);const t={...Tt};t.tags&&t.tags.length>0&&(t.tags=t.tags.filter((t=>t.tag_id!==e.tag_id&&t.id!==e.tag_id)),Dt(t));const o={...c};o.tags&&o.tags.length>0&&(o.tags=o.tags.filter((t=>t.tag_id!==e.tag_id&&t.id!==e.tag_id)),d(o)),nt.Ay.success(`Tag "${e.name}" removed`)}}),(0,N.jsx)(eA,{isOpen:Je,onRequestClose:()=>Xe(!1),contact:c}),(0,N.jsx)(oA.A,{isOpen:Qe,onClose:()=>Ze(!1),primaryContactId:r,duplicateContactId:null===ht||void 0===ht?void 0:ht.contact_id,onComplete:(e,t)=>{if("merged"===e){Ze(!1),nt.Ay.success("Contacts successfully merged! Moving to enrichment...",{duration:3e3});(async()=>{try{await mo(),await qo(),v(3),_o("basic_info")}catch(e){console.error("Error refreshing data after merge:",e),nt.Ay.error("Error refreshing data. Please reload the page.")}})()}else Ze(!1)}}),(0,N.jsxs)(ot(),{isOpen:E,onRequestClose:()=>{k(!1),oe(""),de(null),setTimeout((()=>P("list")),300)},style:{content:{width:"650px",maxWidth:"90%",margin:"auto",backgroundColor:"#1a1a1a",border:"1px solid #333",borderRadius:"8px",padding:"20px"},overlay:{backgroundColor:"rgba(0, 0, 0, 0.75)",zIndex:1050}},children:[(0,N.jsx)(BA,{children:(0,N.jsx)(WA,{onClick:()=>{k(!1),oe(""),de(null),setTimeout((()=>P("list")),300)},children:(0,N.jsx)(B.yGN,{})})}),(0,N.jsxs)(VA,{children:[(0,N.jsx)($A,{active:"list"===T,onClick:()=>P("list"),children:"List"}),(0,N.jsx)($A,{active:"new"===T,onClick:()=>P("new"),children:"New"})]}),(0,N.jsxs)(UA,{active:"list"===T,children:[(0,N.jsx)("div",{style:{marginBottom:"20px"},children:(0,N.jsxs)(cR,{children:[(0,N.jsx)(dR,{children:"Search Deals"}),(0,N.jsx)(uR,{type:"text",value:Z,onChange:e=>{ee(e.target.value),Bo(e.target.value)},placeholder:"Search deals by name...",autoFocus:!0})]})}),(0,N.jsx)("div",{style:{maxHeight:"350px",overflowY:"auto",border:"1px solid #333",borderRadius:"4px",marginBottom:"20px"},children:ne.length>0?ne.map((e=>(0,N.jsxs)("div",{style:{padding:"12px",borderBottom:"1px solid #333",cursor:"pointer",transition:"background-color 0.2s"},onClick:()=>{Vo(e)},onMouseEnter:e=>{e.currentTarget.style.backgroundColor="#222"},onMouseLeave:e=>{e.currentTarget.style.backgroundColor="transparent"},children:[(0,N.jsx)("div",{style:{fontWeight:"bold",marginBottom:"4px",color:"#00ff00"},children:e.opportunity}),(0,N.jsxs)("div",{style:{display:"flex",flexWrap:"wrap",gap:"15px",fontSize:"0.85rem",color:"#bbb"},children:[(0,N.jsxs)("span",{children:["Stage: ",e.stage]}),(0,N.jsxs)("span",{children:["Category: ",e.category]}),e.total_investment&&(0,N.jsxs)("span",{children:["Value: $",e.total_investment.toLocaleString()]})]})]},e.deal_id))):(0,N.jsx)("div",{style:{padding:"20px",textAlign:"center",color:"#888"},children:Z.length>0?"No matching deals found. Try a different search or create a new deal.":"Type to search for existing deals or switch to the New tab to create one."})}),(0,N.jsxs)("div",{style:{display:"flex",justifyContent:"space-between"},children:[(0,N.jsx)(pA,{onClick:()=>k(!1),type:"button",children:"Cancel"}),(0,N.jsxs)(pA,{onClick:()=>P("new"),variant:"primary",children:[(0,N.jsx)(B.GGD,{})," Create New Deal"]})]})]}),(0,N.jsx)(UA,{active:"new"===T,children:(0,N.jsxs)("form",{onSubmit:e=>{e.preventDefault();const t=te,o=new FormData(e.target),n={name:t,stage:o.get("dealStage")||"Lead",value:parseFloat(o.get("dealValue"))||null,category:o.get("dealCategory")||"Inbox",source:o.get("dealSource")||"Not Set",description:o.get("dealDescription")||"",relationship:o.get("dealRelationship")||"introducer"};ce?console.log("Using selected deal for edit/association:",ce.deal_id):console.log("Creating new deal with name:",t),$o(n)},children:[(0,N.jsxs)(cR,{children:[(0,N.jsx)(dR,{children:"Deal Name *"}),(0,N.jsx)(uR,{type:"text",name:"dealName",value:te,onChange:e=>{oe(e.target.value)},placeholder:"Enter deal name",autoFocus:!0,required:!0})]}),(0,N.jsxs)(aR,{children:[(0,N.jsxs)(cR,{children:[(0,N.jsx)(dR,{children:"Stage *"}),(0,N.jsx)(pR,{name:"dealStage",defaultValue:"Lead",required:!0,children:he.map((e=>(0,N.jsx)("option",{value:e,children:e},e)))})]}),(0,N.jsxs)(cR,{children:[(0,N.jsx)(dR,{children:"Value"}),(0,N.jsx)(uR,{type:"number",name:"dealValue",placeholder:"Enter deal value",min:"0",step:"0.01"})]})]}),(0,N.jsxs)(aR,{children:[(0,N.jsxs)(cR,{children:[(0,N.jsx)(dR,{children:"Category"}),(0,N.jsx)(pR,{name:"dealCategory",defaultValue:"Inbox",children:ge.map(((e,t)=>(0,N.jsx)("option",{value:e,children:fe[t]},e)))})]}),(0,N.jsxs)(cR,{children:[(0,N.jsx)(dR,{children:"Source"}),(0,N.jsx)(pR,{name:"dealSource",defaultValue:"Not Set",children:me.map((e=>(0,N.jsx)("option",{value:e,children:e},e)))})]})]}),(0,N.jsxs)(cR,{children:[(0,N.jsx)(dR,{children:"Contact Relationship *"}),(0,N.jsx)(pR,{name:"dealRelationship",defaultValue:"introducer",required:!0,children:ve.map(((e,t)=>(0,N.jsx)("option",{value:e,children:ye[t]},e)))})]}),(0,N.jsxs)(cR,{children:[(0,N.jsx)(dR,{children:"Description"}),(0,N.jsx)(hR,{name:"dealDescription",placeholder:"Enter deal description (optional)",rows:3})]}),(0,N.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",gap:"10px",marginTop:"20px"},children:[(0,N.jsx)(pA,{onClick:()=>P("list"),type:"button",children:"Back to List"}),(0,N.jsxs)(pA,{variant:"primary",type:"submit",children:[(0,N.jsx)(B.GGD,{})," Create Deal"]})]})]})})]})]})});o(3915);P.Ay.div`
  display: flex;
  justify-content: space-between;
  align-items: center;
  margin-bottom: 15px;
  padding-bottom: 15px;
  border-bottom: 1px solid #e5e7eb;

  h2 {
    margin: 0;
    font-size: 1.25rem;
    color: #111827;
    font-weight: 600;
  }

  button {
    background: none;
    border: none;
    cursor: pointer;
    color: #6b7280;
    padding: 4px;
    border-radius: 4px;
    
    &:hover {
      color: #1f2937;
      background-color: #f3f4f6;
    }
  }
`,P.Ay.div`
  margin-bottom: 15px;
`,P.Ay.h3`
  font-size: 16px;
  font-weight: bold;
  color: #374151;
  margin-bottom: 12px;
`,P.Ay.div`
  display: flex;
  flex-wrap: wrap;
  gap: 8px;
  margin-bottom: 16px;
  padding: 5px 0;
  min-height: 32px;
`,P.Ay.div`
  display: inline-flex;
  align-items: center;
  padding: 4px 8px;
  background-color: ${e=>e.color||"#e0f2fe"};
  color: ${e=>e.textColor||"#0369a1"};
  border-radius: 16px;
  font-size: 0.875rem;
  gap: 6px;
  max-width: 200px;

  span {
    white-space: nowrap;
    overflow: hidden;
    text-overflow: ellipsis;
    max-width: 150px;
  }

  button {
    background: none;
    border: none;
    padding: 2px;
    cursor: pointer;
    color: inherit;
    opacity: 0.7;
    display: flex;
    align-items: center;
    justify-content: center;
    flex-shrink: 0;

    &:hover {
      opacity: 1;
    }
  }
`,P.Ay.div`
  position: relative;
  margin-bottom: 16px;
  width: 90%;
`,P.Ay.div`
  position: absolute;
  left: 10px;
  top: 50%;
  transform: translateY(-50%);
  color: #6b7280;
`,P.Ay.input`
  width: 100%;
  padding: 10px 10px 10px 35px;
  border: 1px solid #d1d5db;
  border-radius: 6px;
  font-size: 0.875rem;
  outline: none;
  transition: border-color 0.2s;

  &:focus {
    border-color: #3b82f6;
    box-shadow: 0 0 0 3px rgba(59, 130, 246, 0.1);
  }
`,P.Ay.div`
  position: relative;
  margin-top: 5px;
  border: 1px solid #e5e7eb;
  border-radius: 6px;
  max-height: 200px;
  overflow-y: auto;
  background-color: white;
  box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
  z-index: 10;
`,P.Ay.button`
  width: 100%;
  text-align: left;
  padding: 8px 12px;
  border: none;
  background: none;
  cursor: pointer;
  font-size: 0.875rem;
  color: #374151;
  transition: background-color 0.2s;
  display: flex;
  align-items: center;
  justify-content: space-between;

  &:hover {
    background-color: #f3f4f6;
  }

  &:not(:last-child) {
    border-bottom: 1px solid #f3f4f6;
  }
`,P.Ay.button`
  width: 100%;
  text-align: left;
  padding: 8px 12px;
  border: none;
  background-color: #f3f4f6;
  cursor: pointer;
  font-size: 0.875rem;
  color: #1f2937;
  display: flex;
  align-items: center;
  gap: 5px;
  transition: background-color 0.2s;

  &:hover {
    background-color: #e5e7eb;
  }
`,P.Ay.div`
  padding: 10px;
  border-radius: 4px;
  margin-bottom: 15px;
  font-size: 0.875rem;

  &.success {
    background-color: #d1fae5;
    color: #065f46;
  }

  &.error {
    background-color: #fee2e2;
    color: #b91c1c;
  }
  
  &.info {
    background-color: #e0f2fe;
    color: #0369a1;
  }
`,P.Ay.div`
  display: flex;
  justify-content: flex-end;
  gap: 10px;
  margin-top: 20px;
`,P.Ay.button`
  padding: 8px 16px;
  border-radius: 4px;
  font-size: 0.875rem;
  font-weight: 500;
  cursor: pointer;
  transition: all 0.2s;

  &.primary {
    background-color: black;
    color: white;
    border: none;

    &:hover {
      background-color: #333;
    }
  }

  &.secondary {
    background-color: white;
    color: #4b5563;
    border: 1px solid #d1d5db;

    &:hover {
      background-color: #f9fafb;
    }
  }

  &:disabled {
    opacity: 0.5;
    cursor: not-allowed;
  }
`;const CR=document.createElement("style");CR.innerHTML="\n  @keyframes spin {\n    0% { transform: rotate(0deg); }\n    100% { transform: rotate(360deg); }\n  }\n",document.head.appendChild(CR);P.Ay.div`
  display: flex;
  justify-content: space-between;
  align-items: center;
  margin-bottom: 15px;
  padding-bottom: 15px;
  border-bottom: 1px solid #e5e7eb;

  h2 {
    margin: 0;
    font-size: 1.25rem;
    color: #111827;
    font-weight: 600;
  }

  button {
    background: none;
    border: none;
    cursor: pointer;
    color: #6b7280;
    padding: 4px;
    border-radius: 4px;
    
    &:hover {
      color: #1f2937;
      background-color: #f3f4f6;
    }
  }
`,P.Ay.div`
  margin-bottom: 15px;
`,P.Ay.h3`
  font-size: 16px;
  font-weight: bold;
  color: #374151;
  margin-bottom: 12px;
`,P.Ay.p`
  color: #4b5563;
  font-size: 0.875rem;
  margin-bottom: 16px;
`,P.Ay.div`
  display: flex;
  align-items: center;
  width: 100%;
  background-color: white;
  border: 1px solid black;
  border-radius: 0.375rem;
  overflow: visible;
  margin-bottom: 16px;
  box-shadow: none;
  position: relative;
  z-index: 1;
`,P.Ay.input`
  flex: 1;
  padding: 0.625rem 1rem;
  font-size: 0.875rem;
  color: black;
  border: none;
  outline: none;
  
  &::placeholder {
    color: #555555;
  }
`,P.Ay.div`
  display: flex;
  align-items: center;
  justify-content: center;
  padding: 0 1rem;
  color: black;
`,P.Ay.div`
  border: 1px solid #e5e7eb;
  border-radius: 6px;
  overflow: hidden;
  margin-bottom: 20px;
`,P.Ay.div`
  display: grid;
  grid-template-columns: 3fr 2fr 1fr;
  background-color: #f9fafb;
  padding: 12px;
  border-bottom: 1px solid #e5e7eb;
  font-weight: 600;
  color: #374151;
  font-size: 0.875rem;
`,P.Ay.div`
  display: grid;
  grid-template-columns: 3fr 2fr 1fr;
  padding: 12px;
  border-bottom: 1px solid #e5e7eb;
  font-size: 0.875rem;
  color: #4b5563;
  align-items: center;

  &:last-child {
    border-bottom: none;
  }

  &:hover {
    background-color: #f9fafb;
  }
`,P.Ay.div`
  font-weight: 500;
  color: #111827;
`,P.Ay.div`
  color: #6b7280;
  font-size: 0.875rem;
`;const _R=P.Ay.button`
  background: ${e=>e.primary?"black":"#f3f4f6"};
  color: ${e=>e.primary?"white":"#4b5563"};
  border: none;
  border-radius: 4px;
  padding: 6px 10px;
  font-size: 0.75rem;
  font-weight: 500;
  cursor: pointer;
  transition: all 0.2s;
  display: flex;
  align-items: center;
  gap: 4px;
  justify-content: center;
  
  &:hover {
    background-color: ${e=>e.primary?"#333333":"#e5e7eb"};
  }
  
  &:disabled {
    opacity: 0.5;
    cursor: not-allowed;
  }

  &.delete {
    background-color: white;
    color: #ef4444;
    border: 1px solid #ef4444;
    
    &:hover {
      background-color: #fee2e2;
    }
  }
`;(0,P.Ay)(_R)`
  margin-top: 10px;
  padding: 8px 16px;
  width: 100%;
`,P.Ay.div`
  display: flex;
  justify-content: flex-end;
  gap: 10px;
  margin-top: 20px;
`,P.Ay.button`
  padding: 8px 16px;
  border-radius: 4px;
  font-size: 0.875rem;
  font-weight: 500;
  cursor: pointer;
  transition: all 0.2s;

  &.primary {
    background-color: black;
    color: white;
    border: none;

    &:hover {
      background-color: #333333;
    }
  }

  &.secondary {
    background-color: white;
    color: #4b5563;
    border: 1px solid #d1d5db;

    &:hover {
      background-color: #f9fafb;
    }
  }

  &:disabled {
    opacity: 0.5;
    cursor: not-allowed;
  }
`,P.Ay.div`
  padding: 10px;
  border-radius: 4px;
  margin-bottom: 15px;
  font-size: 0.875rem;

  &.success {
    background-color: #d1fae5;
    color: #065f46;
  }

  &.error {
    background-color: #fee2e2;
    color: #b91c1c;
  }
`,P.Ay.div`
  text-align: center;
  padding: 20px;
  color: #6b7280;
  font-style: italic;
`,P.Ay.div`
  width: 20px;
  height: 20px;
  border: 3px solid #f3f3f3;
  border-top: 3px solid #000000;
  border-radius: 50%;
  animation: spin 1s linear infinite;
  margin: 0 auto;
  
  @keyframes spin {
    0% { transform: rotate(0deg); }
    100% { transform: rotate(360deg); }
  }
`,P.Ay.div`
  display: flex;
  justify-content: space-between;
  align-items: center;
  margin-bottom: 15px;
  padding-bottom: 15px;
  border-bottom: 1px solid #e5e7eb;

  h2 {
    margin: 0;
    font-size: 1.25rem;
    color: #111827;
    font-weight: 600;
  }

  button {
    background: none;
    border: none;
    cursor: pointer;
    color: #6b7280;
    padding: 4px;
    border-radius: 4px;
    
    &:hover {
      color: #1f2937;
      background-color: #f3f4f6;
    }
  }
`,P.Ay.div`
  margin-bottom: 20px;
`,P.Ay.label`
  display: block;
  margin-bottom: 6px;
  font-size: 0.875rem;
  font-weight: 500;
  color: #374151;
`,P.Ay.input`
  width: 100%;
  padding: 10px;
  border: 1px solid #d1d5db;
  border-radius: 0.375rem;
  font-size: 0.875rem;
  transition: border-color 0.2s;
  
  &:focus {
    outline: none;
    border-color: #3b82f6;
    box-shadow: 0 0 0 3px rgba(59, 130, 246, 0.1);
  }
`,P.Ay.textarea`
  width: 100%;
  padding: 10px;
  border: 1px solid #d1d5db;
  border-radius: 0.375rem;
  font-size: 0.875rem;
  min-height: 100px;
  resize: vertical;
  transition: border-color 0.2s;
  
  &:focus {
    outline: none;
    border-color: #3b82f6;
    box-shadow: 0 0 0 3px rgba(59, 130, 246, 0.1);
  }
`,P.Ay.select`
  width: 100%;
  padding: 10px;
  border: 1px solid #d1d5db;
  border-radius: 0.375rem;
  font-size: 0.875rem;
  background-color: white;
  transition: border-color 0.2s;
  
  &:focus {
    outline: none;
    border-color: #3b82f6;
    box-shadow: 0 0 0 3px rgba(59, 130, 246, 0.1);
  }
`,P.Ay.div`
  color: #ef4444;
  font-size: 0.875rem;
  margin-top: 6px;
`,P.Ay.div`
  display: flex;
  justify-content: flex-end;
  gap: 10px;
  margin-top: 20px;
`,P.Ay.button`
  padding: 8px 16px;
  border-radius: 4px;
  font-size: 0.875rem;
  font-weight: 500;
  cursor: pointer;
  transition: all 0.2s;

  &.primary {
    background-color: black;
    color: white;
    border: none;

    &:hover {
      background-color: #333333;
    }
  }

  &.secondary {
    background-color: white;
    color: #4b5563;
    border: 1px solid #d1d5db;

    &:hover {
      background-color: #f9fafb;
    }
  }

  &:disabled {
    opacity: 0.5;
    cursor: not-allowed;
  }
`,P.Ay.div`
  margin-bottom: 20px;
`,P.Ay.h3`
  font-size: 1rem;
  font-weight: 600;
  color: #111827;
  margin-bottom: 12px;
`,P.Ay.div`
  display: flex;
  flex-wrap: wrap;
  gap: 6px;
  margin-top: 10px;
`,P.Ay.span`
  display: inline-flex;
  align-items: center;
  padding: 4px 8px;
  font-size: 0.75rem;
  border-radius: 9999px;
  background-color: ${e=>e.color||"#f3f4f6"};
  color: ${e=>e.textColor||"#4b5563"};
  font-weight: 500;
`,P.Ay.button`
  background: none;
  border: none;
  cursor: pointer;
  color: inherit;
  font-size: 1rem;
  line-height: 1;
  padding: 0;
  margin-left: 4px;
  display: flex;
  align-items: center;
`,P.Ay.div`
  position: relative;
  margin-top: 8px;
`,P.Ay.div`
  position: absolute;
  top: 100%;
  left: 0;
  right: 0;
  z-index: 10;
  background-color: white;
  border: 1px solid #d1d5db;
  border-radius: 0.375rem;
  box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1);
  max-height: 200px;
  overflow-y: auto;
`,P.Ay.div`
  padding: 8px 12px;
  font-size: 0.875rem;
  cursor: pointer;
  
  &:hover {
    background-color: #f3f4f6;
  }
`,P.Ay.div`
  padding: 8px 12px;
  font-size: 0.875rem;
  color: #3b82f6;
  font-weight: 500;
  cursor: pointer;
  display: flex;
  align-items: center;
  gap: 6px;
  
  &:hover {
    background-color: #f3f4f6;
  }
`,P.Ay.div`
  padding: 10px;
  border-radius: 4px;
  margin-bottom: 15px;
  font-size: 0.875rem;

  &.success {
    background-color: #d1fae5;
    color: #065f46;
  }

  &.error {
    background-color: #fee2e2;
    color: #b91c1c;
  }
`,P.Ay.div`
  margin-top: 10px;
  border: 1px solid #e5e7eb;
  border-radius: 4px;
  max-height: 150px;
  overflow-y: auto;
`,P.Ay.div`
  display: flex;
  justify-content: space-between;
  align-items: center;
  padding: 8px 12px;
  border-bottom: 1px solid #e5e7eb;
  
  &:last-child {
    border-bottom: none;
  }
  
  &:hover {
    background-color: #f9fafb;
  }
`,P.Ay.div`
  font-size: 0.875rem;
  color: #1f2937;
`,P.Ay.button`
  background: none;
  border: none;
  cursor: pointer;
  color: #ef4444;
  padding: 4px;
  border-radius: 4px;
  
  &:hover {
    background-color: #fee2e2;
  }
`;o(446);P.Ay.div`
  display: flex;
  justify-content: space-between;
  align-items: flex-start;
  margin-bottom: 24px;
  padding-bottom: 16px;
  border-bottom: 1px solid #e5e7eb;
`,P.Ay.div`
  flex: 1;
`,P.Ay.div`
  display: flex;
  align-items: center;
  flex-wrap: wrap;
  margin-bottom: 8px;
`,P.Ay.h2`
  margin: 0;
  font-size: 1.5rem;
  font-weight: 600;
  color: #111827;
`,P.Ay.div`
  display: flex;
  flex-wrap: wrap;
  gap: 4px;
`,P.Ay.span`
  display: inline-flex;
  align-items: center;
  padding: 4px 8px;
  background-color: #000000;
  color: white;
  border-radius: 4px;
  margin-left: 8px;
  font-size: 0.75rem;
  font-weight: 500;
  gap: 4px;
  
  button {
    background: none;
    border: none;
    color: white;
    display: flex;
    align-items: center;
    justify-content: center;
    cursor: pointer;
    padding: 0;
    margin-left: 4px;
    opacity: 0.7;
    
    &:hover {
      opacity: 1;
    }
  }
`,P.Ay.button`
  display: inline-flex;
  align-items: center;
  padding: 4px 8px;
  background-color: transparent;
  border: none;
  color: #4b5563;
  font-size: 0.75rem;
  font-weight: 500;
  cursor: pointer;
  margin-left: 8px;
  gap: 4px;
  
  &:hover {
    color: #000000;
  }
`,P.Ay.div`
  font-size: 0.75rem;
  color: #6b7280;
`,P.Ay.button`
  background: none;
  border: none;
  font-size: 1.25rem;
  cursor: pointer;
  padding: 4px;
  color: #6b7280;
  &:hover {
    color: #000;
  }
`,P.Ay.div`
  display: flex;
  border-bottom: 1px solid #e5e7eb;
  margin-bottom: 24px;
`,P.Ay.button`
  background: none;
  border: none;
  font-size: 0.875rem;
  padding: 12px 16px;
  cursor: pointer;
  color: ${e=>e.active?"#000000":"#6b7280"};
  border-bottom: ${e=>e.active?"2px solid #000000":"2px solid transparent"};
  margin-right: 8px;
  &:hover {
    color: #000000;
  }
`,P.Ay.div`
  flex: 1;
  overflow-y: auto;
  padding: 0 24px 24px;
  scrollbar-width: thin;
  scrollbar-color: rgba(200, 200, 200, 0.5) transparent;
  
  &::-webkit-scrollbar {
    width: 4px;
  }
  
  &::-webkit-scrollbar-track {
    background: transparent;
  }
  
  &::-webkit-scrollbar-thumb {
    background-color: rgba(200, 200, 200, 0.5);
    border-radius: 10px;
    border: none;
  }
  
  &::-webkit-scrollbar-thumb:hover {
    background-color: rgba(180, 180, 180, 0.8);
  }
`,P.Ay.div`
  width: 90%;
  margin: 0 auto;
`,P.Ay.div`
  display: grid;
  grid-template-columns: repeat(3, 1fr);
  gap: 32px;
  margin-bottom: 40px;
`,P.Ay.h3`
  font-size: 1.125rem;
  color: #111827;
  margin: 32px 0 20px;
  padding-bottom: 8px;
  border-bottom: 1px solid #f3f4f6;
`,P.Ay.div`
  display: flex;
  flex-direction: column;
  position: relative;
  
  &.full-width {
    grid-column: span 3;
  }
`,P.Ay.button`
  display: flex;
  align-items: center;
  justify-content: space-between;
  width: 102%; /* 5% smaller than previous 107% */
  height: 52px; /* Increased by 30% from original 40px */
  padding: 8px 12px;
  background-color: white;
  border: 1px solid #d1d5db;
  border-radius: 0.25rem;
  font-size: 0.875rem;
  text-align: left;
  cursor: pointer;
  
  &:hover {
    border-color: #9ca3af;
  }
  
  &:focus {
    border-color: #9ca3af;
    outline: none;
    box-shadow: 0 0 0 2px rgba(59, 130, 246, 0.25);
  }
`,P.Ay.div`
  position: absolute;
  top: 100%;
  left: 0;
  width: 105%; /* Matched to dropdown button width */
  max-height: 200px;
  overflow-y: auto;
  background-color: white;
  border: 1px solid #d1d5db;
  border-radius: 0.25rem;
  box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
  z-index: 10;
`,P.Ay.button`
  display: block;
  width: 100%;
  padding: 8px 12px;
  text-align: left;
  border: none;
  background-color: ${e=>e.active?"#f3f4f6":"white"};
  font-size: 0.875rem;
  color: #111827;
  cursor: pointer;
  
  &:hover {
    background-color: #f9fafb;
  }
`,P.Ay.label`
  display: block;
  margin-bottom: 10px;
  font-size: 0.875rem;
  color: #4b5563;
  font-weight: 500;
`,P.Ay.input`
  width: 95%;
  height: 34px; /* Set to 34px */
  padding: 8px 12px; /* Standard padding */
  border: 1px solid #d1d5db;
  border-radius: 0.25rem;
  font-size: 0.875rem;
  &:focus {
    border-color: #9ca3af;
    outline: none;
    box-shadow: 0 0 0 2px rgba(59, 130, 246, 0.25);
  }
`,P.Ay.textarea`
  width: 100%;
  padding: 8px 12px;
  border: 1px solid #d1d5db;
  border-radius: 0.25rem;
  font-size: 0.875rem;
  resize: vertical;
  min-height: 100px;
  &:focus {
    border-color: #9ca3af;
    outline: none;
    box-shadow: 0 0 0 2px rgba(59, 130, 246, 0.25);
  }
`,P.Ay.div`
  display: flex;
  justify-content: flex-end;
  padding: 16px 24px;
  border-top: 1px solid #e5e7eb;
  gap: 12px;
`,P.Ay.div`
  position: relative;
`,P.Ay.div`
  display: flex;
  flex-wrap: wrap;
  gap: 8px;
  margin-bottom: 16px;
  padding: 5px 0;
  min-height: 32px;
`,P.Ay.div`
  display: inline-flex;
  align-items: center;
  padding: 0.25rem 0.5rem;
  font-size: 0.75rem;
  border-radius: 1rem;
  background-color: ${e=>e.color||"#f3f4f6"};
  color: ${e=>e.textColor||"#4b5563"};
  font-weight: 500;
  margin-right: 0.25rem;
  margin-bottom: 0.25rem;
  border: 1px solid black;
  gap: 6px;
  max-width: 200px;

  span {
    white-space: nowrap;
    overflow: hidden;
    text-overflow: ellipsis;
    max-width: 150px;
  }

  button {
    background: none;
    border: none;
    padding: 0;
    display: inline-flex;
    align-items: center;
    justify-content: center;
    margin-left: 0.25rem;
    color: #6b7280;
    cursor: pointer;
    
    &:hover { 
      color: #ef4444; 
    }
  }
`,P.Ay.button`
  display: inline-flex;
  align-items: center;
  gap: 8px;
  padding: 6px 12px;
  background-color: transparent;
  border: 1px solid #d1d5db;
  border-radius: 4px;
  font-size: 0.75rem;
  color: #4b5563;
  cursor: pointer;
  
  &:hover {
    background-color: #f9fafb;
  }
  
  svg {
    font-size: 12px;
  }
`,P.Ay.button`
  display: inline-flex;
  align-items: center;
  gap: 8px;
  padding: 6px 12px;
  background-color: #f3f4f6;
  border: none;
  border-radius: 4px;
  font-size: 0.75rem;
  color: #4b5563;
  cursor: pointer;
  
  &:hover {
    background-color: #e5e7eb;
  }
`,P.Ay.div`
  display: inline-flex;
  align-items: center;
  background-color: #f3f4f6;
  padding: 0.25rem 0.5rem;
  border-radius: 0.375rem;
  font-size: 0.75rem;
  color: #4b5563;
  font-weight: 500;
  margin-right: 8px;
  margin-bottom: 8px;
  border: 1px solid #d1d5db;
  
  button {
    background: none;
    border: none;
    display: inline-flex;
    align-items: center;
    justify-content: center;
    margin-left: 4px;
    cursor: pointer;
    padding: 0 2px;
    color: #4b5563;
    font-size: 14px;
    
    &:hover {
      color: #ef4444;
    }
  }
`,P.Ay.div`
  display: flex;
  flex-wrap: wrap;
  margin-top: 8px;
`,P.Ay.div`
  display: flex;
  align-items: center;
  font-size: 0.875rem;
  margin-bottom: 8px;
  color: #4b5563;
  
  svg {
    margin-right: 8px;
    min-width: 16px;
  }
  
  a {
    color: #4b5563;
    text-decoration: none;
    &:hover {
      text-decoration: underline;
    }
  }
`,P.Ay.div`
  margin-top: 16px;
`,P.Ay.div`
  display: flex;
  justify-content: space-between;
  align-items: center;
  margin-bottom: 8px;
`,P.Ay.h3`
  font-size: 0.875rem;
  font-weight: 600;
  margin-bottom: 4px;
  display: flex;
  align-items: center;
  gap: 6px;
`,P.Ay.div`
  margin-top: 16px;
`;ot().setAppElement("#root");P.Ay.div`
  background-color: white;
  border-radius: 16px;
  box-shadow: 0 1px 3px rgba(0, 0, 0, 0.05);
  overflow: hidden;
`,P.Ay.div`
  padding: 1.5rem 1.5rem 0 1.5rem;
`,P.Ay.div`
  display: flex;
  justify-content: space-between;
  align-items: flex-start;
  margin-bottom: 1rem;
`,P.Ay.div`
  flex: 1;
`,P.Ay.h1`
  font-size: 1.5rem;
  font-weight: 600;
  color: black;
  margin: 0;
  display: flex;
  align-items: center;
  gap: 0.5rem;
`,P.Ay.span`
  font-size: 1rem;
  font-weight: 400;
  color: black;
`,P.Ay.div`
  display: flex;
  gap: 0.75rem;
`;const SR=P.Ay.button`
  display: flex;
  align-items: center;
  gap: 0.5rem;
  padding: 0.5rem 1rem;
  border-radius: 0.375rem;
  font-size: 0.875rem;
  font-weight: 500;
  cursor: pointer;
  transition: all 0.2s;
  
  &:hover {
    opacity: 0.9;
  }
`;(0,P.Ay)(SR)`
  background-color: black;
  color: white;
  border: none;
  
  &:hover {
    background-color: #333;
  }
`,(0,P.Ay)(SR)`
  background-color: transparent;
  color: black;
  border: 1px solid black;
  
  &:hover {
    background-color: rgba(0, 0, 0, 0.05);
  }
`,P.Ay.div`
  display: flex;
  align-items: center;
  width: 100%;
  background-color: white;
  border: 1px solid black;
  border-radius: 0.375rem;
  overflow: visible;
  margin-top: 2rem;
  box-shadow: none;
  position: relative;
  z-index: 1;
`,P.Ay.input`
  flex: 1;
  padding: 0.625rem 1rem;
  font-size: 0.875rem;
  color: black;
  border: none;
  outline: none;
  
  &::placeholder {
    color: #555555;
  }
`,P.Ay.div`
  display: flex;
  align-items: center;
  justify-content: center;
  padding: 0 1rem;
  color: black;
`,P.Ay.div`
  padding: 0 1.5rem 1.5rem 1.5rem;
`,P.Ay.div`
  display: flex;
  background-color: #111;
  border-bottom: 1px solid #333;
  overflow-x: auto;
  scrollbar-width: thin;
  scrollbar-color: #00ff00 #222;
  padding: 8px 0;
  margin-bottom: 0;
  position: sticky;
  top: 0;
  z-index: 100;
  width: 100%;
  height: 48px;
  align-items: center;
  
  &::-webkit-scrollbar {
    height: 6px;
  }
  
  &::-webkit-scrollbar-track {
    background: #222;
  }
  
  &::-webkit-scrollbar-thumb {
    background-color: #00ff00;
    border-radius: 3px;
  }
`,P.Ay.div`
  display: flex;
  align-items: center;
  padding: 10px 15px;
  color: ${e=>e.$active?"#00ff00":"#ccc"};
  text-decoration: none;
  border-bottom: ${e=>e.$active?"2px solid #00ff00":"none"};
  margin-right: 10px;
  font-family: 'Courier New', monospace;
  transition: all 0.2s ease;
  white-space: nowrap;
  cursor: pointer;
  font-size: 0.9rem;
  font-weight: ${e=>e.$active?"bold":"normal"};
  
  &:hover {
    color: #00ff00;
    background-color: rgba(0, 255, 0, 0.05);
  }
  
  &:first-child {
    margin-left: 10px;
  }
  
  svg {
    margin-right: 8px;
    font-size: 1rem;
  }
`,P.Ay.div`
  display: grid;
  grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));
  gap: 24px;
  margin-top: 24px;
`,P.Ay.div`
  background-color: white;
  border-radius: 8px;
  padding: 20px;
  box-shadow: 0 1px 3px rgba(0, 0, 0, 0.1);
  border: 1px solid #e5e7eb;
  transition: transform 0.2s ease, box-shadow 0.2s ease;
  position: relative;
  height: 360px;
  display: flex;
  flex-direction: column;
  cursor: pointer;
  
  &:hover {
    transform: translateY(-4px);
    box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
  }
`,P.Ay.div`
  display: flex;
  justify-content: space-between;
  align-items: flex-start;
  margin-bottom: 12px;
`,P.Ay.h3`
  font-size: 1.1rem;
  font-weight: 600;
  color: #111827;
  margin: 0 0 8px 0;
  cursor: pointer;
  
  &:hover {
    text-decoration: underline;
    color: black;
  }
`,P.Ay.div`
  position: relative;
`,P.Ay.button`
  background: none;
  border: none;
  cursor: pointer;
  padding: 4px;
  color: #6b7280;
  
  &:hover {
    color: #111827;
  }
`,P.Ay.div`
  position: absolute;
  top: 100%;
  right: 0;
  width: 160px;
  background-color: white;
  border: 1px solid #e5e7eb;
  border-radius: 4px;
  box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
  z-index: 10;
  display: ${e=>e.isOpen?"block":"none"};
`,P.Ay.button`
  display: flex;
  align-items: center;
  gap: 8px;
  width: 100%;
  text-align: left;
  padding: 8px 12px;
  font-size: 0.875rem;
  color: #4b5563;
  background: none;
  border: none;
  cursor: pointer;
  position: relative;
  
  &:hover {
    background-color: black;
    color: white;
  }
  
  &:hover::after {
    content: ">";
    position: absolute;
    right: 12px;
    font-weight: bold;
  }
`,P.Ay.button`
  background-color: black;
  color: white;
  border: none;
  border-radius: 4px;
  padding: 4px 8px;
  font-size: 0.75rem;
  font-weight: 500;
  cursor: pointer;
  transition: background-color 0.2s;
  margin-left: 5px;
  
  &:hover {
    background-color: #333;
  }
  
  &.confirm {
    background-color: #ef4444;
    
    &:hover {
      background-color: #dc2626;
    }
  }
`,P.Ay.button`
  background-color: #6B7280;
  color: white;
  border: none;
  border-radius: 4px;
  padding: 4px 8px;
  font-size: 0.75rem;
  font-weight: 500;
  cursor: pointer;
  transition: background-color 0.2s;
  margin-left: 5px;
  
  &:hover {
    background-color: #4B5563;
  }
  
  &.confirm {
    background-color: #9CA3AF;
    
    &:hover {
      background-color: #6B7280;
    }
  }
`,P.Ay.div`
  display: inline-flex;
  align-items: center;
  padding: 4px 8px;
  font-size: 0.75rem;
  font-weight: 500;
  border-radius: 4px;
  margin-right: 8px;
  margin-bottom: 12px;
  background-color: #f3f4f6;
  color: #4b5563;
  cursor: pointer;
  
  &:hover {
    background-color: #e5e7eb;
  }
`,P.Ay.p`
  color: #4b5563;
  font-size: 0.875rem;
  margin-bottom: 16px;
  display: -webkit-box;
  -webkit-line-clamp: 3;
  -webkit-box-orient: vertical;
  overflow: hidden;
  text-overflow: ellipsis;
  flex: 0 0 auto;
  cursor: pointer;
  
  &:hover {
    background-color: #f9fafb;
    border-radius: 4px;
    padding: 4px;
    margin: -4px;
    margin-bottom: 12px;
  }
`,P.Ay.div`
  display: flex;
  flex-wrap: wrap;
  gap: 6px;
  margin-bottom: 16px;
`,P.Ay.span`
  display: inline-flex;
  align-items: center;
  padding: 0.25rem 0.5rem;
  font-size: 0.75rem;
  border-radius: 1rem;
  background-color: ${e=>e.color||"#f3f4f6"};
  color: ${e=>e.textColor||"#4b5563"};
  font-weight: 500;
  border: 1px solid ${e=>e.textColor||"#4b5563"};
`,P.Ay.div`
  display: flex;
  flex-wrap: wrap;
  gap: 6px;
  margin-bottom: 0;
`,P.Ay.span`
  display: inline-flex;
  align-items: center;
  gap: 4px;
  padding: 0.25rem 0.5rem;
  font-size: 0.75rem;
  border-radius: 0.375rem;
  background-color: white;
  color: #4b5563;
  font-weight: 500;
  border: 1px solid #d1d5db;
  
  .flag {
    margin-right: 4px;
  }
`,P.Ay.div`
  display: flex;
  align-items: center;
  gap: 12px;
  min-height: 24px;
`,P.Ay.a`
  display: inline-flex;
  align-items: center;
  color: black;
  text-decoration: none;
  font-size: 0.875rem;
  
  &:hover {
    text-decoration: underline;
  }
`,P.Ay.div`
  padding: 0;
`,P.Ay.div`
  display: flex;
  justify-content: space-between;
  align-items: center;
  margin-bottom: 8px;
  
  h4 {
    font-size: 0.875rem;
    font-weight: 500;
    color: #4b5563;
    margin: 0;
  }
`,P.Ay.div`
  display: flex;
  flex-wrap: wrap;
  gap: 6px;
`,P.Ay.span`
  display: inline-flex;
  align-items: center;
  padding: 0.25rem 0.5rem;
  font-size: 0.75rem;
  border-radius: 0.375rem;
  background-color: #f3f4f6;
  color: #4b5563;
  font-weight: 500;
`,P.Ay.div`
  display: inline-block;
  position: relative;
`;var ER=o(7149);const kR=P.Ay.div`
  padding: 24px;
  max-height: 80vh;
  overflow-y: auto;
`,jR=P.Ay.div`
  display: flex;
  justify-content: space-between;
  align-items: center;
  margin-bottom: 24px;
  padding-bottom: 16px;
  border-bottom: 1px solid #333;
`,AR=P.Ay.h2`
  margin: 0;
  font-size: 20px;
  font-weight: 600;
  color: #00ff00;
  display: flex;
  align-items: center;
  gap: 8px;
`,RR=P.Ay.span`
  color: #ffffff;
  font-weight: 400;
`,OR=P.Ay.button`
  display: inline-flex;
  align-items: center;
  gap: 8px;
  padding: 8px 16px;
  color: white;
  background-color: ${e=>e.$secondary?"#6c757d":"#00ff00"};
  border: none;
  border-radius: 4px;
  font-size: 14px;
  cursor: pointer;
  transition: all 0.2s;

  &:hover {
    background-color: ${e=>e.$secondary?"#5a6268":"#33ff33"};
  }

  &:disabled {
    background-color: #333;
    color: #666;
    cursor: not-allowed;
  }
`,TR=P.Ay.div`
  display: flex;
  flex-direction: column;
  gap: 16px;
  margin-bottom: 20px;
`,DR=P.Ay.div`
  padding: 16px;
  border: 1px solid #333;
  border-radius: 8px;
  background-color: #1a1a1a;
`,PR=P.Ay.div`
  display: flex;
  justify-content: space-between;
  align-items: center;
  margin-bottom: 12px;
  padding-bottom: 8px;
  border-bottom: 1px solid #333;
`,NR=P.Ay.h4`
  margin: 0;
  font-size: 16px;
  font-weight: 500;
  color: #ffffff;
`,IR=P.Ay.div`
  display: flex;
  align-items: center;
  gap: 4px;
  font-size: 12px;
  color: #888;
`,MR=P.Ay.div`
  font-size: 14px;
  color: #e0e0e0;
  line-height: 1.5;
  white-space: pre-wrap;
`,LR=P.Ay.div`
  display: flex;
  justify-content: flex-end;
  gap: 8px;
  margin-top: 12px;
`,FR=P.Ay.button`
  display: inline-flex;
  align-items: center;
  justify-content: center;
  padding: 4px;
  background: none;
  border: none;
  color: #888;
  cursor: pointer;
  transition: all 0.2s;
  border-radius: 4px;
  
  &:hover {
    color: #00ff00;
    background-color: #001100;
  }
`,GR=P.Ay.div`
  margin-top: 20px;
  border: 1px solid #333;
  border-radius: 8px;
  overflow: hidden;
  background-color: #1a1a1a;
`,zR=P.Ay.input`
  width: 100%;
  padding: 12px;
  background-color: #222;
  border: none;
  border-bottom: 1px solid #333;
  color: #ffffff;
  font-size: 16px;
  outline: none;
  
  &::placeholder {
    color: #666;
  }
`,HR=P.Ay.textarea`
  width: 100%;
  min-height: 150px;
  padding: 16px;
  background-color: #1a1a1a;
  border: none;
  color: #ffffff;
  font-size: 14px;
  line-height: 1.5;
  outline: none;
  resize: vertical;
  font-family: inherit;
  
  &::placeholder {
    color: #666;
  }
`,BR=P.Ay.div`
  display: flex;
  justify-content: flex-end;
  gap: 8px;
  padding: 12px;
  background-color: #222;
  border-top: 1px solid #333;
`,VR=P.Ay.div`
  text-align: center;
  padding: 40px 20px;
  color: #888;
`,$R=e=>{let{isOpen:o,onRequestClose:n,company:r}=e;const[i,a]=(0,t.useState)([]),[s,l]=(0,t.useState)(!1),[c,d]=(0,t.useState)(!1),[u,p]=(0,t.useState)(null),[h,f]=(0,t.useState)(""),[g,m]=(0,t.useState)(""),[y,v]=(0,t.useState)(!1),[b,x]=(0,t.useState)(""),w=(null===r||void 0===r?void 0:r.description)&&r.description.trim().length>0,C=()=>{if(!w)return!1;const e=r.description.trim().toLowerCase();return!["no specific information found","no information found","no description available","description not available","no details available","information not available","no data available","not specified","n/a","tbd","to be determined","unknown","no description","no info"].some((t=>e===t||e.includes(t)))},_=async()=>{if(null!==r&&void 0!==r&&r.company_id){l(!0);try{const{data:t,error:o}=await D.supabase.from("notes_companies").select("note_id").eq("company_id",r.company_id);if(o)throw o;if(!t||0===t.length)return a([]),void l(!1);const n=t.map((e=>e.note_id)).filter((e=>null!==e&&void 0!==e));if(0===n.length)return a([]),void l(!1);let i=null;const{data:s,error:c}=await D.supabase.from("notes").select("*").in("note_id",n).order("created_at",{ascending:!1});if(c){const{data:e,error:t}=await D.supabase.from("notes").select("*").in("id",n).order("created_at",{ascending:!1});if(t)throw c;i=e}else i=s;const d=(i||[]).map((e=>({...e,id:e.id||e.note_id,content:e.content||e.text||""}))),u=d.map((e=>e.id)),p=n.filter((e=>!u.includes(e)));if(p.length>0){console.log(`Found ${p.length} orphaned note references for company ${r.company_id}, cleaning up...`);try{await D.supabase.from("notes_companies").delete().eq("company_id",r.company_id).in("note_id",p)}catch(e){console.error("Error cleaning up orphaned note references:",e)}}a(d)}catch(t){console.error("Error fetching notes:",t),nt.Ay.error("Failed to load notes"),a([])}finally{l(!1)}}},S=e=>{p(e.id),f(e.title),m(e.content)},E=()=>{v(!0),x(r.description||"")},k=e=>{if(!e)return"Unknown";return new Date(e).toLocaleDateString("en-GB",{day:"2-digit",month:"2-digit",year:"numeric",hour:"2-digit",minute:"2-digit"})};return(0,t.useEffect)((()=>{o&&null!==r&&void 0!==r&&r.company_id&&_()}),[o,null===r||void 0===r?void 0:r.company_id]),(0,t.useEffect)((()=>{o||(a([]),d(!1),p(null),f(""),m(""),l(!1),v(!1),x(""))}),[o]),(0,N.jsx)(ot(),{isOpen:o,onRequestClose:n,style:{content:{top:"50%",left:"50%",right:"auto",bottom:"auto",marginRight:"-50%",transform:"translate(-50%, -50%)",width:"600px",maxWidth:"90vw",maxHeight:"90vh",padding:"0",border:"1px solid #333",backgroundColor:"#121212",borderRadius:"8px"},overlay:{backgroundColor:"rgba(0, 0, 0, 0.75)",zIndex:1e3}},children:(0,N.jsxs)(kR,{children:[(0,N.jsxs)(jR,{children:[(0,N.jsxs)(AR,{children:[(0,N.jsx)(B.jH2,{}),"Notes - ",(0,N.jsx)(RR,{children:null===r||void 0===r?void 0:r.name})]}),(0,N.jsxs)(OR,{onClick:()=>d(!0),disabled:c||u,children:[(0,N.jsx)(B.GGD,{size:16}),"Add Note"]})]}),s?(0,N.jsx)("div",{style:{textAlign:"center",padding:"40px 0",color:"#888"},children:"Loading notes..."}):(0,N.jsxs)(N.Fragment,{children:[C()||i.length>0?(0,N.jsxs)(TR,{children:[C()&&(0,N.jsxs)(DR,{children:[(0,N.jsxs)(PR,{children:[(0,N.jsx)(NR,{children:"Company Description"}),(0,N.jsxs)(IR,{children:[(0,N.jsx)(B.S8s,{size:12}),"Built-in field"]})]}),y?(0,N.jsxs)(N.Fragment,{children:[(0,N.jsx)(HR,{value:b,onChange:e=>x(e.target.value),placeholder:"Enter company description...",style:{minHeight:"100px",marginBottom:"12px"}}),(0,N.jsxs)(LR,{children:[(0,N.jsx)(FR,{onClick:()=>{v(!1),x("")},title:"Cancel",children:(0,N.jsx)(B.yGN,{size:14})}),(0,N.jsx)(FR,{onClick:async()=>{if(null!==r&&void 0!==r&&r.company_id)try{const{error:e}=await D.supabase.from("companies").update({description:b.trim()}).eq("company_id",r.company_id);if(e)throw e;r.description=b.trim(),v(!1),x(""),nt.Ay.success("Company description updated successfully")}catch(e){console.error("Error updating company description:",e),nt.Ay.error("Failed to update company description")}},title:"Save Description",children:(0,N.jsx)(B.Bc_,{size:14})})]})]}):(0,N.jsxs)(N.Fragment,{children:[(0,N.jsx)(MR,{onClick:E,style:{cursor:"pointer",transition:"background-color 0.2s ease",padding:"8px",borderRadius:"4px"},onMouseEnter:e=>{e.target.style.backgroundColor="#2a2a2a"},onMouseLeave:e=>{e.target.style.backgroundColor="transparent"},title:"Click to edit company description",children:r.description}),(0,N.jsx)(LR,{children:(0,N.jsx)(FR,{onClick:E,title:"Edit Company Description",children:(0,N.jsx)(B.WXf,{size:14})})})]})]}),i.map((e=>(0,N.jsxs)(DR,{children:[(0,N.jsxs)(PR,{children:[(0,N.jsx)(NR,{children:e.title}),(0,N.jsxs)(IR,{children:[(0,N.jsx)(B.Ohp,{size:12}),k(e.created_at)]})]}),(0,N.jsx)(MR,{onClick:()=>S(e),style:{cursor:"pointer",transition:"background-color 0.2s ease",padding:"8px",borderRadius:"4px"},onMouseEnter:e=>{e.target.style.backgroundColor="#2a2a2a"},onMouseLeave:e=>{e.target.style.backgroundColor="transparent"},title:"Click to edit this note",children:e.content}),(0,N.jsxs)(LR,{children:[(0,N.jsx)(FR,{onClick:()=>S(e),title:"Edit Note",children:(0,N.jsx)(B.WXf,{size:14})}),(0,N.jsx)(FR,{$delete:!0,onClick:()=>(async e=>{if(e&&window.confirm("Are you sure you want to delete this note?"))try{let t=!1;const{error:o}=await D.supabase.from("notes").delete().eq("note_id",e);if(o){const{error:o}=await D.supabase.from("notes").delete().eq("id",e);if(o)throw o;t=!0}else t=!0;t&&(_(),nt.Ay.success("Note deleted successfully"))}catch(t){console.error("Error deleting note:",t),nt.Ay.error("Failed to delete note")}})(e.id),title:"Delete Note",children:(0,N.jsx)(B.IXo,{size:14})})]})]},e.id)))]}):c||u?null:(0,N.jsxs)(VR,{children:[(0,N.jsx)(B.jH2,{size:48,style:{marginBottom:"16px",opacity:.5}}),(0,N.jsx)("p",{children:"No notes found for this company."}),(0,N.jsx)("p",{children:'Click "Add Note" to create the first note.'})]}),(c||u)&&(0,N.jsxs)(GR,{children:[(0,N.jsx)(zR,{type:"text",placeholder:"Note title...",value:h,onChange:e=>f(e.target.value)}),(0,N.jsx)(HR,{placeholder:"Write your note here...",value:g,onChange:e=>m(e.target.value)}),(0,N.jsxs)(BR,{children:[(0,N.jsxs)(OR,{$secondary:!0,onClick:()=>{d(!1),p(null),f(""),m("")},children:[(0,N.jsx)(B.yGN,{size:16}),"Cancel"]}),(0,N.jsxs)(OR,{onClick:u?async()=>{if(u&&g.trim())try{let e=!1;const{error:t}=await D.supabase.from("notes").update({title:h.trim()||"Untitled Note",text:g.trim()}).eq("note_id",u);if(t){const{error:t}=await D.supabase.from("notes").update({title:h.trim()||"Untitled Note",text:g.trim()}).eq("id",u);if(t){const{error:t}=await D.supabase.from("notes").update({title:h.trim()||"Untitled Note",content:g.trim()}).eq("note_id",u);if(t){const{error:t}=await D.supabase.from("notes").update({title:h.trim()||"Untitled Note",content:g.trim()}).eq("id",u);if(t)throw t;e=!0}else e=!0}else e=!0}else e=!0;e&&(f(""),m(""),p(null),_(),nt.Ay.success("Note updated successfully"))}catch(e){console.error("Error updating note:",e),nt.Ay.error("Failed to update note")}}:async()=>{if(null!==r&&void 0!==r&&r.company_id&&g.trim())try{let e=null;const{data:t,error:o}=await D.supabase.from("notes").insert({title:h.trim()||"Untitled Note",text:g.trim()}).select().single();if(o){if(!o.message.includes("text"))throw o;{const{data:t,error:o}=await D.supabase.from("notes").insert({title:h.trim()||"Untitled Note",content:g.trim()}).select().single();if(o)throw o;e=t}}else e=t;const n=e.id||e.note_id;if(!n)throw new Error("Failed to get note ID from created note");const{error:i}=await D.supabase.from("notes_companies").insert({note_id:n,company_id:r.company_id});if(i)throw i;f(""),m(""),d(!1),_(),nt.Ay.success("Note created successfully")}catch(e){console.error("Error creating note:",e),nt.Ay.error("Failed to create note")}},children:[(0,N.jsx)(B.Bc_,{size:16}),u?"Update":"Save"," Note"]})]})]})]})]})})},UR=P.Ay.div`
  display: flex;
  flex-direction: column;
  height: 100%;
`,WR=P.Ay.div`
  display: flex;
  justify-content: space-between;
  align-items: center;
  margin-bottom: 20px;
  padding-bottom: 15px;
  border-bottom: 1px solid #333;
`,qR=P.Ay.h2`
  color: #fff;
  font-size: 20px;
  font-weight: 500;
  margin: 0;
`,KR=P.Ay.button`
  background: transparent;
  color: #00ff00;
  border: none;
  cursor: pointer;
  display: flex;
  align-items: center;
  justify-content: center;
  font-size: 20px;
  padding: 5px;
  border-radius: 4px;

  &:hover {
    background: #333;
  }
`,YR=P.Ay.div`
  position: relative;
  margin-bottom: 20px;
`,JR=P.Ay.input`
  width: 100%;
  padding: 12px 40px 12px 12px;
  background: #333;
  border: 1px solid #444;
  border-radius: 4px;
  color: #fff;
  font-size: 14px;
  box-sizing: border-box;

  &:focus {
    outline: none;
    border-color: #00ff00;
  }

  &::placeholder {
    color: #999;
  }
`,XR=P.Ay.div`
  position: absolute;
  right: 12px;
  top: 50%;
  transform: translateY(-50%);
  color: #999;
  pointer-events: none;
`,QR=P.Ay.div`
  max-height: 300px;
  overflow-y: auto;
  border: 1px solid #444;
  border-radius: 4px;
  background: #222;
`,ZR=P.Ay.div`
  display: flex;
  align-items: center;
  justify-content: space-between;
  padding: 12px;
  border-bottom: 1px solid #333;
  cursor: pointer;
  transition: background-color 0.2s;

  &:hover {
    background-color: #333;
  }

  &:last-child {
    border-bottom: none;
  }
`,eO=P.Ay.div`
  flex: 1;
`,tO=P.Ay.div`
  color: #fff;
  font-weight: 500;
  margin-bottom: 4px;
`,oO=P.Ay.div`
  color: #999;
  font-size: 12px;
`,nO=P.Ay.button`
  background: transparent;
  border: none;
  color: #00ff00;
  cursor: pointer;
  padding: 4px;
  border-radius: 4px;
  display: flex;
  align-items: center;
  justify-content: center;

  &:hover {
    background: #333;
  }
`,rO=P.Ay.div`
  text-align: center;
  color: #999;
  padding: 40px 20px;
  font-size: 14px;
`,iO=P.Ay.div`
  margin-bottom: 20px;
`,aO=P.Ay.label`
  display: block;
  margin-bottom: 8px;
  color: #00ff00;
  font-size: 14px;
  font-weight: 500;
`,sO=P.Ay.select`
  width: 100%;
  padding: 10px;
  background: #333;
  border: 1px solid #444;
  border-radius: 4px;
  color: #fff;
  font-size: 14px;
  box-sizing: border-box;
  appearance: none;
  background-image: url("data:image/svg+xml;utf8,<svg xmlns='http://www.w3.org/2000/svg' width='10' height='6' fill='none' stroke='%23aaa' stroke-width='1.5' viewBox='0 0 10 6'><polyline points='1,1 5,5 9,1'/></svg>");
  background-repeat: no-repeat;
  background-position: right 10px center;
  padding-right: 30px;
  height: 40px;

  &:focus {
    outline: none;
    border-color: #00ff00;
  }
`,lO=P.Ay.div`
  display: flex;
  justify-content: flex-end;
  gap: 10px;
  margin-top: 20px;
`,cO=P.Ay.button`
  display: flex;
  align-items: center;
  gap: 8px;
  padding: 8px 16px;
  border-radius: 4px;
  font-size: 14px;
  cursor: pointer;
  transition: all 0.2s;
  
  &.primary {
    background: #333;
    color: #00ff00;
    border: 1px solid #00ff00;
    
    &:hover {
      background: #444;
    }
    
    &:disabled {
      opacity: 0.5;
      cursor: not-allowed;
    }
  }
  
  &.cancel {
    background: transparent;
    color: #fff;
    border: 1px solid #555;
    
    &:hover {
      background: #333;
    }
  }
`,dO=["not_set","employee","founder","advisor","manager","investor","other"],uO=e=>{let{isOpen:o,onRequestClose:n,companyId:r,onContactAssociated:i=()=>{}}=e;const[a,s]=(0,t.useState)(""),[l,c]=(0,t.useState)([]),[d,u]=(0,t.useState)(!1),[p,h]=(0,t.useState)(!1),[f,g]=(0,t.useState)(null),[m,y]=(0,t.useState)("not_set"),v=(0,t.useRef)(null),b=(0,t.useRef)(null);(0,t.useEffect)((()=>{o&&v.current&&setTimeout((()=>{v.current.focus()}),100),o&&(s(""),c([]),g(null),y("not_set"),h(!1),console.log("AssociateContactModal opened with companyId:",r))}),[o,r]);const x=async e=>{u(!0);try{const{data:t,error:o}=await D.supabase.from("contact_companies").select("contact_id").eq("company_id",r);if(o)throw o;const n=new Set(t.map((e=>e.contact_id))),{data:i,error:a}=await D.supabase.from("contacts").select("*").or(`first_name.ilike.%${e}%,last_name.ilike.%${e}%`).order("last_name",{ascending:!0}).limit(20);if(a)throw a;const s=i.filter((e=>!n.has(e.contact_id)));c(s),h(0===s.length)}catch(t){console.error("Error searching contacts:",t),nt.Ay.error("Failed to search contacts")}finally{u(!1)}};return(0,N.jsx)(ot(),{isOpen:o,onRequestClose:n,style:{content:{top:"50%",left:"50%",right:"auto",bottom:"auto",marginRight:"-50%",transform:"translate(-50%, -50%)",padding:"25px",border:"1px solid #444",borderRadius:"8px",backgroundColor:"#111",color:"#fff",maxWidth:"600px",width:"90%",boxShadow:"0 4px 20px rgba(0, 0, 0, 0.5)"},overlay:{backgroundColor:"rgba(0, 0, 0, 0.7)",zIndex:1e3}},children:(0,N.jsxs)(UR,{children:[(0,N.jsxs)(WR,{children:[(0,N.jsx)(qR,{children:"Associate Contact with Company"}),(0,N.jsx)(KR,{onClick:n,children:(0,N.jsx)(B.yGN,{size:20})})]}),(0,N.jsxs)(YR,{children:[(0,N.jsx)(JR,{ref:v,type:"text",value:a,onChange:e=>{const t=e.target.value;if(s(t),b.current&&clearTimeout(b.current),t.length<2)return c([]),void h(!1);b.current=setTimeout((()=>{x(t)}),300)},onKeyDown:e=>{if("Enter"===e.key){if(e.preventDefault(),a.length<2)return;b.current&&clearTimeout(b.current),x(a)}},placeholder:"Search for a contact by name..."}),(0,N.jsx)(XR,{children:(0,N.jsx)(B.CKj,{size:16})})]}),d&&(0,N.jsx)(rO,{children:"Searching..."}),!d&&a.length>=2&&(0,N.jsx)(N.Fragment,{children:l.length>0?(0,N.jsx)(QR,{children:l.map((e=>(0,N.jsxs)(ZR,{onClick:()=>(e=>{g(e),c([]),s(`${e.first_name} ${e.last_name}`)})(e),children:[(0,N.jsxs)(eO,{children:[(0,N.jsxs)(tO,{children:[e.first_name," ",e.last_name]}),(0,N.jsxs)(oO,{children:[e.job_role||"No job role"," \u2022 ",e.category||"No category"]})]}),(0,N.jsx)(nO,{title:"View details",children:(0,N.jsx)(B.HaR,{size:16})})]},e.contact_id)))}):p?(0,N.jsx)(QR,{children:(0,N.jsxs)(rO,{children:["No contacts found with that name.",(0,N.jsx)("div",{style:{marginTop:"10px"},children:(0,N.jsxs)(cO,{className:"primary",onClick:async()=>{if(!a||a.length<2)nt.Ay.error("Please enter a name for the new contact");else try{nt.Ay.loading("Creating new contact...",{id:"create-contact"});const e=a.trim().split(" "),t=e[0]||"",o=e.slice(1).join(" ")||"";console.log("Creating new contact:",{firstName:t,lastName:o,searchTerm:a});const{data:s,error:l}=await D.supabase.from("contacts").insert({first_name:t,last_name:o,category:"Inbox",created_by:"User"}).select().single();if(l)throw console.error("Error creating contact:",l),l;console.log("Contact created successfully:",s);const{data:c,error:d}=await D.supabase.from("contact_companies").insert({company_id:String(r),contact_id:s.contact_id,relationship:"not_set",is_primary:!1}).select();if(d)throw console.error("Error associating new contact:",d),d;console.log("Contact association successful:",c);const{data:u,error:p}=await D.supabase.from("contact_companies").select("\n          *,\n          contacts:contact_id(contact_id, first_name, last_name, job_role, category)\n        ").eq("contact_id",s.contact_id).eq("company_id",String(r)).single();p?console.error("Error verifying association:",p):console.log("Association verification successful:",u),nt.Ay.dismiss("create-contact"),nt.Ay.success(`${t} ${o} created and associated successfully`),i({action:"created_and_associated",contact:s,relationship:"not_set",data:null===c||void 0===c?void 0:c[0]}),n()}catch(e){console.error("Error creating and associating contact:",e),nt.Ay.dismiss("create-contact"),nt.Ay.error(`Failed to create contact: ${e.message||"Unknown error"}`)}},children:[(0,N.jsx)(B.GGD,{size:14}),' Create "',a,'" and Associate']})})]})}):null}),f&&(0,N.jsx)(N.Fragment,{children:(0,N.jsxs)(iO,{style:{marginTop:"20px"},children:[(0,N.jsx)(aO,{children:"Relationship to Company"}),(0,N.jsx)(sO,{value:m,onChange:e=>y(e.target.value),children:dO.map((e=>(0,N.jsx)("option",{value:e,children:"not_set"===e?"Not Set":e.charAt(0).toUpperCase()+e.slice(1)},e)))})]})}),(0,N.jsxs)(lO,{children:[(0,N.jsx)(cO,{className:"cancel",onClick:n,children:"Cancel"}),(0,N.jsx)(cO,{className:"primary",onClick:async()=>{if(f){if(console.log("handleAssociateContact - companyId:",r,"type:",typeof r),console.log("handleAssociateContact - selectedContact:",f),!r)return console.error("Missing company ID when trying to associate contact",{companyId:r,contactId:null===f||void 0===f?void 0:f.contact_id}),void nt.Ay.error("Cannot associate contact: Missing company ID");try{nt.Ay.loading("Associating contact...",{id:"associate-contact"}),console.log("Associating contact to company",{companyId:r,companyIdType:typeof r,contactId:f.contact_id,contactName:`${f.first_name} ${f.last_name}`,relationship:m});const{data:e,error:t}=await D.supabase.from("contact_companies").insert({company_id:String(r),contact_id:f.contact_id,relationship:m,is_primary:!1}).select();if(t)throw console.error("Database error when associating contact:",t),t;console.log("Contact association successful:",e),nt.Ay.dismiss("associate-contact"),nt.Ay.success(`${f.first_name} ${f.last_name} associated successfully`),i({action:"associated",contact:f,relationship:m,data:null===e||void 0===e?void 0:e[0]}),n()}catch(e){console.error("Error associating contact:",e),nt.Ay.dismiss("associate-contact"),nt.Ay.error(`Failed to associate contact: ${e.message||"Unknown error"}`)}}else nt.Ay.error("Please select a contact to associate")},disabled:!f,children:f?`Associate ${f.first_name} ${f.last_name}`:"Select a Contact"})]})]})})},pO=P.Ay.div`
  padding: 0 20px 20px 20px;
  height: calc(100vh - 120px);
  width: 100%;
  
  @keyframes spin {
    0% { transform: rotate(0deg); }
    100% { transform: rotate(360deg); }
  }
`,hO=(P.Ay.h1`
  color: #00ff00;
  margin-bottom: 20px;
  font-family: 'Courier New', monospace;
`,P.Ay.div`
  color: #ff3333;
  background-color: #330000;
  padding: 15px;
  border-radius: 4px;
  margin-bottom: 20px;
`),fO=P.Ay.div`
  color: #00ff00;
  text-align: center;
  padding: 40px;
  font-family: monospace;
  display: flex;
  flex-direction: column;
  align-items: center;
  justify-content: center;
  height: 400px;
`,gO=P.Ay.div`
  width: 300px;
  height: 8px;
  background-color: #111;
  margin: 20px 0;
  border-radius: 4px;
  overflow: hidden;
  position: relative;
  box-shadow: 0 0 10px rgba(0, 255, 0, 0.2);
  
  &:before {
    content: "";
    position: absolute;
    top: 0;
    left: 0;
    height: 100%;
    width: 30%;
    background-color: #00ff00;
    animation: pulse 1.5s ease-in-out infinite;
    box-shadow: 0 0 20px #00ff00;
    border-radius: 4px;
  }
  
  @keyframes pulse {
    0% {
      left: -30%;
      opacity: 0.8;
    }
    100% {
      left: 100%;
      opacity: 0.2;
    }
  }
`,mO=P.Ay.div`
  margin-top: 15px;
  color: #00ff00;
  text-shadow: 0 0 5px rgba(0, 255, 0, 0.5);
  letter-spacing: 1px;
  font-size: 16px;
  opacity: 0.9;
  animation: blink 1.5s ease-in-out infinite alternate;
  
  @keyframes blink {
    from { opacity: 0.6; }
    to { opacity: 1; }
  }
`,yO=P.Ay.div`
  font-family: 'Courier New', monospace;
  font-size: 14px;
  color: #00ff00;
  text-align: center;
  margin-top: 30px;
  height: 100px;
  width: 300px;
  overflow: hidden;
  position: relative;
  
  &:after {
    content: "01001100 01101111 01100001 01100100 01101001 01101110 01100111 00100000 01000011 01101111 01101101 01110000 01100001 01101110 01101001 01100101 01110011 00101110 00101110 00101110";
    position: absolute;
    top: 0;
    left: 0;
    height: 100%;
    width: 100%;
    background: linear-gradient(to bottom, transparent, #000 80%);
    display: flex;
    flex-wrap: wrap;
    justify-content: center;
    opacity: 0.7;
    text-shadow: 0 0 5px #00ff00;
    animation: matrix 5s linear infinite;
  }
  
  @keyframes matrix {
    0% { transform: translateY(-60px); }
    100% { transform: translateY(60px); }
  }
`,vO=P.Ay.div`
  display: flex;
  background-color: #111;
  border-bottom: 1px solid #333;
  overflow-x: auto;
  scrollbar-width: thin;
  scrollbar-color: #00ff00 #222;
  padding: 8px 0;
  margin-bottom: 0;
  position: sticky;
  top: 0;
  z-index: 100;
  width: 100%;
  height: 48px;
  align-items: center;
  
  &::-webkit-scrollbar {
    height: 6px;
  }
  
  &::-webkit-scrollbar-track {
    background: #222;
  }
  
  &::-webkit-scrollbar-thumb {
    background-color: #00ff00;
    border-radius: 3px;
  }
`,bO=P.Ay.div`
  display: flex;
  align-items: center;
  gap: 8px;
  padding: 8px 16px;
  color: ${e=>e.$active?"#00ff00":"#888"};
  background-color: ${e=>e.$active?"#1a1a1a":"transparent"};
  border: ${e=>e.$active?"1px solid #00ff00":"1px solid transparent"};
  border-radius: 4px;
  cursor: pointer;
  font-size: 14px;
  font-weight: ${e=>e.$active?"600":"400"};
  white-space: nowrap;
  margin: 0 4px;
  transition: all 0.2s ease;
  min-width: fit-content;
  
  &:hover {
    color: #00ff00;
    background-color: #1a1a1a;
    border-color: #00ff00;
  }
  
  svg {
    font-size: 16px;
    flex-shrink: 0;
  }
`,xO=P.Ay.div`
  display: flex;
  gap: 1px;
  align-items: center;
  height: 100%;
`,wO=P.Ay.div`
  display: flex;
  align-items: center;
  justify-content: center;
  background-color: #1a1a1a;
  color: #00ff00;
  padding: 0px 6px;
  border-radius: 4px;
  font-size: 11px;
  border: 1px solid #00ff00;
  box-shadow: 0 0 4px rgba(0, 255, 0, 0.4);
  white-space: nowrap;
  overflow: visible;
  line-height: 16px;
  max-width: fit-content;
  height: 18px;
  
  button {
    background: none;
    border: none;
    color: #00ff00;
    cursor: pointer;
    padding: 0;
    margin-left: 4px;
    font-size: 10px;
    display: flex;
    align-items: center;
    justify-content: center;
    
    &:hover {
      color: #33ff33;
      transform: scale(1.2);
    }
  }
`,CO=P.Ay.button`
  background: none;
  border: none;
  color: #00ff00;
  border-radius: 3px;
  width: 16px;
  height: 16px;
  padding: 0;
  display: flex;
  align-items: center;
  justify-content: center;
  cursor: pointer;
  font-size: 12px;
  
  &:hover {
    background-color: rgba(0, 255, 0, 0.1);
  }
`,_O=e=>{const[o,n]=t.useState(!1),r=e.value||[],i=e.data;if(!r.length&&!i)return"";const a=r.slice(0,2),s=r.length-2,l=0===r.length,c=e=>{e.stopPropagation(),n(!0)};return(0,N.jsx)("div",{style:{height:"100%",display:"flex",alignItems:"center",justifyContent:"center"},children:(0,N.jsxs)(xO,{onClick:e=>{e.stopPropagation()},style:{whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis",paddingRight:"0",width:"100%",height:"100%",display:"flex",alignItems:"center",gap:"6px"},children:[a.map((t=>(0,N.jsxs)(wO,{title:t.name,children:[t.name.length>15?`${t.name.substring(0,15)}...`:t.name,(0,N.jsx)("button",{onClick:o=>(async(t,o)=>{t.stopPropagation();try{const t=r.find((e=>e.id===o)),{error:n}=await D.supabase.from("company_tags").delete().eq("company_id",i.company_id).eq("tag_id",o);if(n)throw n;const a=r.filter((e=>e.id!==o));e.setValue(a),e.api&&e.api.refreshCells({force:!0,rowNodes:[e.node],columns:["tags"]}),nt.Ay.success(`Tag "${(null===t||void 0===t?void 0:t.name)||"Unknown"}" removed from ${i.name}`,{position:"top-right",autoClose:3e3,hideProgressBar:!1,closeOnClick:!0,pauseOnHover:!0,draggable:!0})}catch(n){console.error("Error removing tag:",n),nt.Ay.error(`Error removing tag: ${n.message}`,{position:"top-right",autoClose:5e3,hideProgressBar:!1,closeOnClick:!0,pauseOnHover:!0,draggable:!0})}})(o,t.id),title:"Remove tag",style:{display:"flex",alignItems:"center",justifyContent:"center",marginLeft:"5px",padding:"0",background:"none",border:"none",cursor:"pointer"},children:(0,N.jsx)(ER.Tfw,{style:{color:"#00ff00"},size:14})})]},t.id))),s>0&&(0,N.jsxs)("div",{style:{display:"inline-flex",alignItems:"center",justifyContent:"center",padding:"0px 3px",borderRadius:"3px",fontSize:"9px",color:"#999999",cursor:"pointer",height:"16px",lineHeight:"16px",backgroundColor:"#333333",marginRight:"1px"},onClick:c,children:["+",s]}),l?(0,N.jsx)("div",{onClick:c,style:{color:"#00ff00",fontSize:"11px",cursor:"pointer",display:"flex",alignItems:"center",justifyContent:"center",gap:"4px",width:"100%",height:"100%"},title:"Add or edit tags",children:"Add tags"}):(0,N.jsx)(CO,{onClick:c,title:"Add or edit tags",children:(0,N.jsx)(B.GGD,{size:10})}),o&&(0,N.jsx)(Sj,{isOpen:o,onRequestClose:()=>{n(!1),e.api&&(e.api.refreshCells({force:!0,rowNodes:[e.node],columns:["tags"]}),setTimeout((()=>{e.context&&e.context.refreshData&&e.context.refreshData()}),100))},company:{...i,id:i.company_id}})]})})},SO=e=>{const t=(e.value||[]).length;return 0===t?(0,N.jsx)("div",{style:{color:"#888",fontSize:"13px"},children:"0"}):(0,N.jsx)("div",{style:{display:"flex",alignItems:"center",justifyContent:"center",color:"#00ff00",fontSize:"13px",cursor:"pointer",width:"100%",height:"100%"},onClick:t=>{var o;t.stopPropagation(),console.log("View deals for company:",null===(o=e.data)||void 0===o?void 0:o.name)},title:`View ${t} deal${1!==t?"s":""}`,children:t})},EO=e=>{var t,o;const n=()=>{const t=e.data;if(!t)return!1;const o=t.description&&t.description.trim().length>0;if(o){const e=t.description.trim().toLowerCase();if(["no specific information found","no information found","no description available","description not available","no details available","information not available","no data available","not specified","n/a","tbd","to be determined","unknown","no description","no info"].some((t=>e===t||e.includes(t))))return!1}return o};return(0,N.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:"8px",height:"100%"},children:[(0,N.jsx)("button",{onClick:t=>{t.stopPropagation(),e.data&&e.data.company_id&&(e.context.setSelectedCompany(e.data),e.context.setShowEditModal(!0))},style:{background:"none",border:"none",color:"#00ff00",cursor:"pointer",padding:"4px",display:"flex",alignItems:"center",justifyContent:"center",opacity:"0.7",transition:"opacity 0.2s"},onMouseEnter:e=>e.currentTarget.style.opacity="1",onMouseLeave:e=>e.currentTarget.style.opacity="0.7",title:"Edit Company",children:(0,N.jsx)(B.WXf,{size:14})}),(0,N.jsx)("button",{onClick:t=>{t.stopPropagation();const o=e.data;if(o.linkedin){const e=o.linkedin.startsWith("http")?o.linkedin:`https://${o.linkedin}`;window.open(e,"_blank")}else{const e=o.name||"",t=`https://www.linkedin.com/search/results/companies/?keywords=${encodeURIComponent(e)}`;window.open(t,"_blank")}},style:{background:"none",border:"none",color:null!==(t=e.data)&&void 0!==t&&t.linkedin?"#00ff00":"#888888",cursor:"pointer",padding:"4px",display:"flex",alignItems:"center",justifyContent:"center",opacity:"0.7",transition:"opacity 0.2s"},onMouseEnter:e=>e.currentTarget.style.opacity="1",onMouseLeave:e=>e.currentTarget.style.opacity="0.7",title:null!==(o=e.data)&&void 0!==o&&o.linkedin?"Open LinkedIn page":"Search on LinkedIn",children:(0,N.jsx)(B.Wjy,{size:14})}),(0,N.jsx)("button",{onClick:t=>{t.stopPropagation();const o=e.data;o&&o.company_id&&(e.context.setSelectedCompany(o),e.context.setShowNotesModal(!0))},style:{background:"none",border:"none",color:n()?"#00ff00":"#888888",cursor:"pointer",padding:"4px",display:"flex",alignItems:"center",justifyContent:"center",opacity:"0.7",transition:"opacity 0.2s"},onMouseEnter:e=>e.currentTarget.style.opacity="1",onMouseLeave:e=>e.currentTarget.style.opacity="0.7",title:n()?"View Company Description & Notes":"Add Notes",children:(0,N.jsx)(B.jH2,{size:14})}),(0,N.jsx)("button",{onClick:async t=>{if(t.stopPropagation(),e.data&&e.data.company_id){const n=e.data.name||"this company";if(window.confirm(`Are you sure you want to delete ${n}? This action cannot be undone.`)){const r=t.currentTarget,i=r.innerHTML;r.disabled=!0,r.style.opacity="0.5",r.innerHTML='<div style="width: 14px; height: 14px; border: 2px solid #00ff00; border-top: 2px solid transparent; border-radius: 50%; animation: spin 1s linear infinite;"></div>';try{const t=e.data.company_id;console.log(`Starting deletion process for company ${t}`),console.log(`Deleting company tags for company ${t}`);const{error:o}=await D.supabase.from("company_tags").delete().eq("company_id",t);if(o)throw console.error("Error deleting company tags:",o),new Error(`Failed to delete company tags: ${o.message}`);console.log(`Deleting company cities for company ${t}`);const{error:r}=await D.supabase.from("company_cities").delete().eq("company_id",t);if(r)throw console.error("Error deleting company cities:",r),new Error(`Failed to delete company cities: ${r.message}`);console.log(`Deleting company-contact relationships for company ${t}`);const{error:i}=await D.supabase.from("contact_companies").delete().eq("company_id",t);if(i)throw console.error("Error deleting company contacts:",i),new Error(`Failed to delete company contacts: ${i.message}`);console.log(`Deleting company ${t}`);const{error:a}=await D.supabase.from("companies").delete().eq("company_id",t);if(a)throw console.error("Error deleting company record:",a),new Error(`Failed to delete company: ${a.message}`);console.log(`Company ${t} successfully deleted`),e.context&&e.context.refreshData?e.context.refreshData():e.api&&e.api.refreshInfiniteCache(),alert(`Company "${n}" has been successfully deleted.`)}catch(o){console.error("Error deleting company:",o),alert(`Failed to delete company: ${o.message}`),r.disabled=!1,r.style.opacity="0.7",r.innerHTML=i}}}},style:{background:"none",border:"none",color:"#00ff00",cursor:"pointer",padding:"4px",display:"flex",alignItems:"center",justifyContent:"center",opacity:"0.7",transition:"opacity 0.2s"},onMouseEnter:e=>e.currentTarget.style.opacity="1",onMouseLeave:e=>e.currentTarget.style.opacity="0.7",title:"Delete Company",children:(0,N.jsx)(B.IXo,{size:14})})]})},kO=e=>{var o;const[n,r]=t.useState(0),[i,a]=t.useState(!1),s=e.value||[],l=null===(o=e.data)||void 0===o?void 0:o.company_id,c=s.length>1;var d;s.length>0&&console.log(`Company ${null===(d=e.data)||void 0===d?void 0:d.name}: ${s.length} contacts, hasMultipleContacts: ${c}`);const u=e=>{null===e||void 0===e||e.stopPropagation(),a(!0)},p=t=>{console.log("handleContactAssociated called with result:",t),a(!1),e.api&&(console.log("Refreshing grid cells immediately"),e.api.refreshCells({force:!0})),e.context&&e.context.refreshData?(console.log("Calling refreshData after contact association"),setTimeout((()=>{e.context.refreshData()}),500)):console.error("refreshData not available in context:",e.context)},h=e=>{e.stopPropagation()};if(!s.length)return(0,N.jsxs)("div",{style:{display:"flex",alignItems:"center",height:"100%"},onClick:h,children:[(0,N.jsx)("div",{onClick:u,style:{color:"#ffffff",fontSize:"11px",cursor:"pointer",display:"flex",alignItems:"center",gap:"4px"},title:"Associate Contact",children:"Add contacts"}),i&&(0,N.jsx)(uO,{isOpen:i,onRequestClose:()=>a(!1),companyId:l,onContactAssociated:p})]});const f=s[n],g=[f.first_name||"",f.last_name||""].filter(Boolean).join(" ")||"Unnamed";return(0,N.jsxs)("div",{style:{display:"flex",alignItems:"center",height:"36px",minHeight:"36px",width:"100%",position:"relative"},onClick:h,children:[(0,N.jsxs)("div",{style:{display:"flex",alignItems:"center",justifyContent:"flex-start",width:"100%",gap:"2px"},children:[(0,N.jsxs)("div",{style:{display:"flex",alignItems:"center",backgroundColor:"#1a1a1a",color:"#ffffff",padding:"0px 6px",borderRadius:"4px",fontSize:"11px",border:"1px solid #ffffff",boxShadow:"0 0 4px rgba(255, 255, 255, 0.2)",whiteSpace:"nowrap",overflow:"hidden",lineHeight:"16px",width:"fit-content",maxWidth:c?"140px":"160px",height:"18px",position:"relative"},children:[(0,N.jsx)("span",{style:{cursor:"pointer",maxWidth:c?"120px":"160px",overflow:"hidden",textOverflow:"ellipsis",display:"inline-block"},onClick:e=>{e.stopPropagation(),console.log("Contact clicked:",f)},title:`${g}${f.job_role?` - ${f.job_role}`:""}`,children:g}),c&&(0,N.jsxs)("div",{style:{fontSize:"9px",color:"#cccccc",marginLeft:"4px",padding:"0 2px",borderRadius:"3px",backgroundColor:"#333333"},children:[n+1,"/",s.length]}),(0,N.jsx)("button",{onClick:t=>(async(t,o)=>{if(null===o||void 0===o||o.stopPropagation(),l&&t)try{const{error:o}=await D.supabase.from("contact_companies").delete().eq("company_id",l).eq("contact_id",t);if(o)throw o;nt.Ay.success("Contact association removed"),e.api&&e.api.refreshCells({force:!0}),setTimeout((()=>{e.context&&e.context.refreshData&&e.context.refreshData()}),100)}catch(n){console.error("Error removing contact association:",n),nt.Ay.error("Failed to remove contact association")}})(f.contact_id,t),style:{background:"none",border:"none",color:"#ffffff",cursor:"pointer",padding:"0",marginLeft:"4px",fontSize:"10px",display:"flex",alignItems:"center",justifyContent:"center"},title:"Remove Contact Association",children:(0,N.jsx)(ER.Tfw,{size:14})})]}),c&&(0,N.jsx)("button",{onClick:e=>{null===e||void 0===e||e.stopPropagation(),r((e=>(e+1)%s.length))},style:{background:"none",border:"none",color:"#ffffff",cursor:"pointer",padding:"0",display:"flex",alignItems:"center",justifyContent:"center",width:"14px",height:"14px",fontSize:"10px",opacity:"0.8"},title:"Next contact",children:"\u25b6"}),(0,N.jsx)("button",{onClick:u,style:{background:"none",border:"none",color:"#ffffff",borderRadius:"4px",width:"20px",height:"20px",padding:"0",display:"flex",alignItems:"center",justifyContent:"center",cursor:"pointer",fontSize:"14px"},title:"Associate Contact",children:(0,N.jsx)(B.GGD,{size:14})})]}),i&&(0,N.jsx)(uO,{isOpen:i,onRequestClose:()=>a(!1),companyId:l,onContactAssociated:p})]})},jO=e=>{var o;const n=e.value||(null===(o=e.data)||void 0===o?void 0:o.category)||"Not Set",[r,i]=t.useState(!1),[a,s]=t.useState(n),l=["Inbox","Professional Investor","Institution","Advisory","Startup","SME","Corporation","Media","Corporate","Not Set"],c=()=>{i(!1)};return r?(0,N.jsx)("select",{value:a,onChange:t=>(async t=>{if(t!==a)try{const{error:o}=await D.supabase.from("companies").update({category:t}).eq("company_id",e.data.company_id);if(o)throw o;s(t),e.setValue(t),e.data.category=t,e.api&&e.api.refreshCells({force:!0,rowNodes:[e.node],columns:["category"]}),i(!1),nt.Ay.success(`Category updated to "${t}" for ${e.data.name}`)}catch(o){console.error("Error updating category:",o),nt.Ay.error(`Failed to update category: ${o.message}`),i(!1)}else i(!1)})(t.target.value),onBlur:c,autoFocus:!0,style:{background:"#1a1a1a",color:"#00ff00",border:"1px solid #00ff00",borderRadius:"4px",padding:"4px",fontSize:"13px",width:"100%",height:"100%"},onClick:e=>e.stopPropagation(),children:l.map((e=>(0,N.jsx)("option",{value:e,style:{background:"#1a1a1a",color:"#00ff00"},children:e},e)))}):(0,N.jsx)("div",{onClick:e=>{e.stopPropagation(),i(!0)},style:{cursor:"pointer",padding:"4px",height:"100%",display:"flex",alignItems:"center",color:"Not Set"===a?"#888":"#e0e0e0"},title:"Click to edit category",children:a||"Not Set"})},AO=()=>{var e;const[o,n]=(0,t.useState)([]),[r,a]=(0,t.useState)(!0),[s,l]=(0,t.useState)(null),[c,d]=(0,t.useState)(null),[u,p]=(0,t.useState)(!1),[h,f]=(0,t.useState)(!1),g=(0,i.Zp)(),[m,y]=(0,t.useState)("full_list"),[v,b]=(0,t.useState)(!1),[x,w]=(0,t.useState)(!1),[C,_]=(0,t.useState)(null),S=e=>{const t=e.value;if(!t)return"-";return(0,N.jsx)("div",{style:{whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis",cursor:"pointer",width:"100%",height:"100%",display:"flex",alignItems:"center",color:"#00ff00",textDecoration:"underline"},onClick:t=>{t.preventDefault(),t.stopPropagation(),e.data&&e.data.company_id&&(console.log("Navigating to company:",e.data.company_id),g(`/companies/${e.data.company_id}`))},onMouseEnter:e=>{e.target.style.color="#00cc00"},onMouseLeave:e=>{e.target.style.color="#00ff00"},children:t})},E=[{id:"full_list",name:"Full List",icon:(0,N.jsx)(B.Wm,{})},{id:"inbox",name:"Inbox",icon:(0,N.jsx)(B._Y7,{})},{id:"startup",name:"Startup",icon:(0,N.jsx)(B.Ojn,{})},{id:"investors",name:"Investors",icon:(0,N.jsx)(B.z8N,{})},{id:"institutions",name:"Institutions",icon:(0,N.jsx)(B.qYx,{})},{id:"advisor",name:"Advisor",icon:(0,N.jsx)(B.JXP,{})},{id:"others",name:"Others",icon:(0,N.jsx)(B.est,{})}],k=(0,t.useMemo)((()=>{if("full_list"===m)return o;const e={investors:"Professional Investor",advisor:"Advisory",inbox:"Inbox",startup:"Startup",institutions:"Institution"};if("others"===m){const t=Object.values(e);return o.filter((e=>{const o=e.category;return!t.includes(o)}))}if("inbox"===m){return o.filter((e=>{const t=e.category;return"Inbox"===t||"Not Set"===t||!t}))}const t=e[m];if(t){return o.filter((e=>e.category===t))}return o}),[o,m]),j=(0,t.useMemo)((()=>[{headerName:"Company",field:"name",cellRenderer:S,minWidth:150,flex:2,filter:"agTextColumnFilter",floatingFilter:!0,sortable:!0,pinned:"left"},{headerName:"Associated Contacts",field:"contacts",cellRenderer:kO,minWidth:180,filter:"agTextColumnFilter",floatingFilter:!0,sortable:!1},{headerName:"Tags",field:"tags",cellRenderer:_O,minWidth:220,width:250,filter:"agTextColumnFilter",floatingFilter:!0,sortable:!1,cellStyle:{display:"flex",alignItems:"center",justifyContent:"center",padding:"0"}},{headerName:"Deals",field:"deals",cellRenderer:SO,minWidth:80,width:100,filter:"agTextColumnFilter",floatingFilter:!0,sortable:!1,cellStyle:{textAlign:"center",display:"flex",alignItems:"center",justifyContent:"center"}},{headerName:"Category",field:"category",cellRenderer:jO,minWidth:120,width:140,filter:"agTextColumnFilter",floatingFilter:!0,sortable:!0},{headerName:"Actions",field:"actions",cellRenderer:EO,minWidth:120,width:120,sortable:!1,filter:!1,pinned:"right"}]),[]),A=(0,t.useMemo)((()=>({resizable:!0})),[]),R=t.useCallback((e=>{console.log("Grid is ready"),d(e.api),setTimeout((()=>{e.api.sizeColumnsToFit()}),0)}),[]),O=async()=>{try{var e;a(!0),l(null);const o=async function(e){let t,o=arguments.length>1&&void 0!==arguments[1]?arguments[1]:3,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1e3;for(let i=0;i<o;i++)try{return await e()}catch(r){t=r,await new Promise((e=>setTimeout(e,n))),n*=1.5}throw t};a("Accessing Companies data...");let r=[],i=0;const s=1e3;let c=!0;for(;c;){const{data:e,error:t}=await o((async()=>(a(`Loading companies page ${i+1}...`),D.supabase.from("companies").select("*").not("category","eq","Skip").order("created_at",{ascending:!1}).range(i*s,(i+1)*s-1))));if(t)throw t;e&&e.length>0?(r=[...r,...e],i++,e.length<s&&(c=!1)):c=!1}const d=r,u=null!==(e=d[0])&&void 0!==e&&e.company_id?"company_id":"id",h=d.map((e=>e[u])),g=50,m=[];for(let e=0;e<h.length;e+=g){var t;a(`Loading companies data... ${Math.min(e+g,h.length)}/${h.length}`);const n=h.slice(e,e+g),[r,i,s]=await Promise.all([D.supabase.from("company_tags").select("company_id, tag_id, tags:tag_id(name)").in("company_id",n),D.supabase.from("contact_companies").select("company_id, contact_id").in("company_id",n),D.supabase.from("notes_companies").select("company_id, note_id").in("company_id",n)]);let l={data:[],error:null};const c=[...new Set((null===(t=i.data)||void 0===t?void 0:t.map((e=>e.contact_id)))||[])];if(c.length>0){const{data:e,error:t}=await D.supabase.from("deals_contacts").select("contact_id, deal_id").in("contact_id",c);t?console.error("Error fetching deals through contacts:",t):l={data:e||[],error:null}}r.error&&console.error("Error fetching tags:",r.error),i.error&&console.error("Error fetching contacts:",i.error),s.error&&console.error("Error fetching notes:",s.error);let p=[];if(c.length>0){const{data:e,error:t}=await o((async()=>D.supabase.from("contacts").select("contact_id, first_name, last_name, job_role, category, linkedin, description, score").in("contact_id",c)));t?console.error("Error fetching contact details:",t):p=e||[]}const f={};p.forEach((e=>{f[e.contact_id]=e}));const y=d.filter((e=>n.includes(e[u]))).map((e=>{const t=(r.data||[]).filter((t=>t.company_id===e.company_id)).map((e=>{var t;return{id:e.tag_id,name:null===(t=e.tags)||void 0===t?void 0:t.name}})).filter((e=>e.name)),o=(i.data||[]).filter((t=>t.company_id===e.company_id)).map((e=>e.contact_id)),n=o.map((e=>f[e])).filter(Boolean),a=new Set;o.forEach((e=>{(l.data||[]).filter((t=>t.contact_id===e)).forEach((e=>a.add(e.deal_id)))}));const c=Array.from(a).map((e=>({deal_id:e}))),d=(s.data||[]).filter((t=>t.company_id===e.company_id)).length;return{...e,tags:t,deals:c,contacts:n,notes_count:d}}));m.push(...y)}n(m),a(!1),p(!0),setTimeout((()=>{f(!0)}),800)}catch(o){console.error("Error fetching companies data:",o),l(o.message),a(!1)}};(0,t.useEffect)((()=>{u||O()}),[u]),(0,t.useEffect)((()=>{if(!c)return;const e=()=>{c.sizeColumnsToFit()};return window.addEventListener("resize",e,{passive:!0}),()=>{window.removeEventListener("resize",e,{passive:!0})}}),[c]);return(0,N.jsxs)(pO,{children:[(0,N.jsx)(vO,{children:E.map((e=>(0,N.jsxs)(bO,{$active:e.id===m,onClick:()=>y(e.id),children:[e.icon," ",e.name]},e.id)))}),s&&(0,N.jsxs)(hO,{children:["Error: ",s]}),!1!==r?(0,N.jsxs)(fO,{children:[(0,N.jsx)(mO,{children:"string"===typeof r?r.replace(/Loading .+ \d+\/\d+/,"Initializing Matrix"):"Accessing Companies Database..."}),(0,N.jsx)(gO,{}),(0,N.jsx)(yO,{})]}):h||s?0!==k.length||s?(0,N.jsx)("div",{className:"ag-theme-alpine",style:{height:"calc(100% - 10px)",width:"100%",opacity:h?1:0,transition:"opacity 0.5s ease-in-out","--ag-background-color":"#121212","--ag-odd-row-background-color":"#1a1a1a","--ag-header-background-color":"#222222","--ag-header-foreground-color":"#00ff00","--ag-foreground-color":"#e0e0e0","--ag-row-hover-color":"#2a2a2a","--ag-border-color":"#333333"},children:(0,N.jsx)($w.W,{rowData:k,columnDefs:j,defaultColDef:A,onGridReady:R,context:{setSelectedCompany:_,setShowEditModal:b,setShowNotesModal:w,refreshData:()=>{p(!1),O()}},rowSelection:"single",animateRows:!0,pagination:!0,paginationPageSize:50,suppressCellFocus:!0,enableCellTextSelection:!0,suppressRowClickSelection:!0})}):(0,N.jsx)("div",{style:{padding:"40px",textAlign:"center",color:"#00ff00",background:"#121212",borderRadius:"8px"},children:"full_list"===m?"No companies found. Try refreshing the page or check database connection.":`No companies found in "${null===(e=E.find((e=>e.id===m)))||void 0===e?void 0:e.name}" category.`}):(0,N.jsxs)(fO,{children:[(0,N.jsx)(mO,{children:"Preparing companies grid..."}),(0,N.jsx)(gO,{}),(0,N.jsx)(yO,{})]}),v&&C&&(0,N.jsx)(Uw.A,{isOpen:v,onRequestClose:()=>{b(!1),_(null)},company:C,onCompanyUpdated:()=>{b(!1),_(null),c&&c.refreshCells({force:!0}),setTimeout((()=>{O()}),100)}}),x&&C&&(0,N.jsx)($R,{isOpen:x,onRequestClose:()=>{w(!1),_(null)},company:C})]})},RO=P.Ay.div`
  padding: 10px 30px 30px 20px;
  width: calc(100% - 50px);
  max-width: calc(100% - 50px);
  margin: 0 auto;
  box-sizing: border-box;
  overflow: hidden;
`,OO=P.Ay.div`
  display: flex;
  justify-content: space-between;
  align-items: center;
  margin-bottom: 30px;
  padding-bottom: 20px;
  border-bottom: 1px solid #333;
  width: 100%;
`,TO=P.Ay.h1`
  color: #00ff00;
  margin: 0;
  font-family: 'Courier New', monospace;
`,DO=P.Ay.button`
  background-color: #222;
  color: #00ff00;
  border: 1px solid #00ff00;
  padding: 10px 20px;
  margin-right: 15px;
  border-radius: 4px;
  cursor: pointer;
  display: flex;
  align-items: center;
  gap: 8px;
  
  &:hover {
    background-color: #333;
  }
`,PO=P.Ay.div`
  display: flex;
  width: 100%;
  gap: 35px;
  box-sizing: border-box;
  margin-top: 30px;
  
  @media (max-width: 992px) {
    flex-direction: column;
    
    > div {
      width: 100% !important;
    }
  }
`,NO=P.Ay.div`
  background-color: #1a1a1a;
  border-radius: 8px;
  border: 1px solid #333;
  padding: 20px;
  margin-bottom: 20px;
  width: 100%;
  max-width: 100%;
  box-sizing: border-box;
  overflow: hidden;
`,IO=P.Ay.h2`
  font-size: 1.2rem;
  color: #00ff00;
  margin-top: 0;
  margin-bottom: 15px;
  display: flex;
  align-items: center;
  gap: 8px;
  
  svg {
    font-size: 1.2rem;
  }
`,MO=P.Ay.div`
  margin-bottom: 12px;
  
  &:last-child {
    margin-bottom: 0;
  }
`,LO=P.Ay.div`
  color: #999;
  font-size: 0.8rem;
  margin-bottom: 2px;
`,FO=P.Ay.div`
  color: #eee;
  font-size: 0.95rem;
`,GO=P.Ay.div`
  padding: 10px;
  border-bottom: 1px solid #333;
  cursor: pointer;
  width: 100%;
  box-sizing: border-box;
  overflow-wrap: break-word;
  word-break: break-word;
  
  &:last-child {
    border-bottom: none;
  }
  
  &:hover {
    background-color: #222;
  }
`,zO=P.Ay.div`
  font-weight: bold;
  color: #eee;
  margin-bottom: 4px;
`,HO=P.Ay.div`
  font-size: 0.85rem;
  color: #999;
`,BO=P.Ay.div`
  display: flex;
  flex-wrap: wrap;
  gap: 6px;
  margin-top: 5px;
`,VO=P.Ay.span`
  background-color: #222;
  color: #00ff00;
  border: 1px solid #00ff00;
  border-radius: 12px;
  padding: 3px 8px;
  font-size: 0.7rem;
  display: inline-flex;
  align-items: center;
  gap: 4px;
`,$O=P.Ay.div`
  display: flex;
  border-bottom: 1px solid #333;
  margin-bottom: 20px;
  width: 100%;
  padding-left: 10px;
`,UO=P.Ay.div`
  padding: 10px 30px;
  margin-right: 15px;
  cursor: pointer;
  color: ${e=>e.active?"#00ff00":"#ccc"};
  border-bottom: 2px solid ${e=>e.active?"#00ff00":"transparent"};
  
  &:hover {
    color: ${e=>e.active?"#00ff00":"#eee"};
  }
`,WO=P.Ay.div`
  display: ${e=>e.active?"block":"none"};
  width: 100%;
  box-sizing: border-box;
  overflow: hidden;
`,qO=P.Ay.div`
  display: flex;
  align-items: center;
  margin-bottom: 15px;
  margin-top: -5px;
  font-size: 0.9rem;
  color: #999;
`,KO=P.Ay.div`
  display: flex;
  flex-direction: column;
  align-items: center;
  justify-content: center;
  height: 70vh;
  color: #00ff00;
`,YO=P.Ay.div`
  padding: 20px;
  background-color: #331111;
  color: #ff5555;
  border-radius: 4px;
  margin: 20px 0;
`,JO=(0,P.Ay)(B.Wjy)`
  cursor: pointer;
  color: ${e=>e.hasLink?"#00ff00":"#666"};
  transition: color 0.2s ease;
  padding: 2px;
  border-radius: 3px;
  outline: none;
  
  &:hover {
    color: ${e=>e.hasLink?"#00cc00":"#888"};
  }
  
  &:focus {
    outline: none;
  }
`,XO=P.Ay.div`
  display: flex;
  align-items: center;
  gap: 8px;
`,QO=P.Ay.div`
  position: fixed;
  top: 0;
  left: 0;
  right: 0;
  bottom: 0;
  background-color: rgba(0, 0, 0, 0.7);
  display: flex;
  align-items: center;
  justify-content: center;
  z-index: 1000;
`,ZO=P.Ay.div`
  background-color: #1a1a1a;
  border-radius: 8px;
  border: 1px solid #333;
  width: 80%;
  max-width: 1000px;
  height: 70%;
  max-height: 600px;
  display: flex;
  overflow: hidden;
`,eT=P.Ay.div`
  width: 200px;
  background-color: #222;
  border-right: 1px solid #333;
  padding: 20px;
  display: flex;
  flex-direction: column;
  gap: 10px;
`,tT=P.Ay.div`
  flex: 1;
  padding: 20px;
  display: flex;
  flex-direction: column;
`,oT=P.Ay.div`
  display: flex;
  justify-content: space-between;
  align-items: center;
  margin-bottom: 20px;
`,nT=P.Ay.h2`
  color: #00ff00;
  margin: 0;
  font-size: 1.5rem;
`,rT=P.Ay.button`
  background: none;
  border: none;
  color: #999;
  cursor: pointer;
  padding: 5px;
  
  &:hover {
    color: #fff;
  }
`,iT=P.Ay.button`
  background-color: ${e=>e.active?"#00ff00":"#333"};
  color: ${e=>e.active?"#000":"#fff"};
  border: 1px solid ${e=>e.active?"#00ff00":"#555"};
  padding: 10px 15px;
  border-radius: 4px;
  cursor: pointer;
  font-size: 0.9rem;
  transition: all 0.2s ease;
  
  &:hover {
    background-color: ${e=>e.active?"#00cc00":"#444"};
  }
`,aT=P.Ay.div`
  background-color: ${e=>e.selected?"#00ff00":"#222"};
  color: ${e=>e.selected?"#000":"#00ff00"};
  border: 1px solid #00ff00;
  border-radius: 8px;
  padding: 4px 8px;
  font-size: 0.7rem;
  display: inline-flex;
  align-items: center;
  width: fit-content;
  white-space: nowrap;
  box-sizing: border-box;
  cursor: pointer;
  transition: all 0.2s ease;
  
  &:hover {
    background-color: ${e=>e.selected?"#00cc00":"#333"};
  }
`,sT=P.Ay.div`
  padding: 12px;
  border-bottom: 1px solid #333;
  cursor: pointer;
  
  &:last-child {
    border-bottom: none;
  }
  
  &:hover {
    background-color: #222;
  }
`,lT=P.Ay.div`
  font-weight: bold;
  color: #eee;
  margin-bottom: 4px;
`,cT=P.Ay.div`
  font-size: 0.85rem;
  color: #999;
`,dT=P.Ay.div`
  display: flex;
  align-items: center;
  justify-content: center;
  padding: 40px;
  color: #00ff00;
`,uT=P.Ay.div`
  flex: 1;
  overflow-y: auto;
  max-height: 400px;
`,pT=P.Ay.div`
  display: flex;
  align-items: center;
  justify-content: space-between;
  margin-bottom: 15px;
`,hT=()=>{const{id:e}=(0,i.g)(),o=(0,i.Zp)(),[n,r]=(0,t.useState)(null),[a,s]=(0,t.useState)([]),[l,c]=(0,t.useState)([]),[d,u]=(0,t.useState)([]),[p,h]=(0,t.useState)([]),[f,g]=(0,t.useState)([]),[m,y]=(0,t.useState)(!0),[v,b]=(0,t.useState)(null),[x,w]=(0,t.useState)("contacts"),[C,_]=(0,t.useState)(!1),[S,E]=(0,t.useState)("contacts"),[k,j]=(0,t.useState)(!1),[A,R]=(0,t.useState)([]),[O,T]=(0,t.useState)([]),[P,I]=(0,t.useState)(!1);(0,t.useEffect)((()=>{if(!e)return;(async()=>{r(null),s([]),c([]),u([]),h([]),g([]),b(null),y(!0);try{var t,o,n;const{data:i,error:a}=await D.supabase.from("companies").select("*").eq("company_id",e).single();if(a)throw a;if(!i)throw new Error("Company not found");r(i);const[l,d,p,f,m]=await Promise.all([D.supabase.from("contact_companies").select("\n              contact_companies_id,\n              relationship,\n              is_primary,\n              contacts (\n                contact_id,\n                first_name,\n                last_name,\n                job_role,\n                score,\n                category\n              )\n            ").eq("company_id",e),D.supabase.from("company_tags").select("\n              entry_id,\n              tags (\n                tag_id,\n                name\n              )\n            ").eq("company_id",e),D.supabase.from("companies_cities").select("\n              entry_id,\n              cities (\n                city_id,\n                name,\n                country\n              )\n            ").eq("company_id",e),D.supabase.from("deals_companies").select("\n              deals_companies_id,\n              relationship,\n              deals (\n                deal_id,\n                opportunity,\n                total_investment,\n                category,\n                stage,\n                description,\n                created_at,\n                updated_at\n              )\n            ").eq("company_id",e),D.supabase.from("notes_companies").select("\n              note_company_id,\n              notes (\n                note_id,\n                title,\n                text,\n                created_at\n              )\n            ").eq("company_id",e).order("created_at",{foreignTable:"notes",ascending:!1})]);s(l.data||[]),c((null===(t=d.data)||void 0===t?void 0:t.map((e=>e.tags)))||[]),u((null===(o=p.data)||void 0===o?void 0:o.map((e=>e.cities)))||[]),h(f.data||[]),g((null===(n=m.data)||void 0===n?void 0:n.map((e=>e.notes)))||[])}catch(i){console.error("Error fetching company data:",i),b(i.message||"Error loading company data")}finally{y(!1)}})()}),[e]),(0,t.useEffect)((()=>{w("contacts")}),[e]);const M=e=>{if(!e)return"-";const t=new Date(e);return`${t.toLocaleDateString()} ${t.toLocaleTimeString()}`},L=()=>{try{if(n.linkedin&&n.linkedin.trim()){const e=n.linkedin.startsWith("http")?n.linkedin:`https://${n.linkedin}`;window.open(e,"_blank","noopener,noreferrer")}else{const e=n.name||"";if(e){const t=`https://www.linkedin.com/search/results/companies/?keywords=${encodeURIComponent(e)}`;window.open(t,"_blank","noopener,noreferrer")}else Pm.oR.info("No company name available to search on LinkedIn")}}catch(v){console.error("Error opening LinkedIn:",v),Pm.oR.error("Failed to open LinkedIn")}},F=()=>{try{if(n.website&&n.website.trim()){const e=n.website.startsWith("http")?n.website:`https://${n.website}`;window.open(e,"_blank","noopener,noreferrer")}}catch(v){console.error("Error opening website:",v),Pm.oR.error("Failed to open website")}},G=()=>{j(!0)},z=()=>{_(!1),R([]),T([])},H=e=>{E(e),A.length>0&&V(A,e)},V=async(e,t)=>{if(0!==e.length){I(!0);try{let o,n,r,i;"contacts"===t?(o="contact_id",n="contact_tags",r="contacts",i="\n          contact_id,\n          first_name,\n          last_name,\n          job_role,\n          score,\n          category\n        "):"companies"===t?(o="company_id",n="company_tags",r="companies",i="\n          company_id,\n          name,\n          website,\n          category,\n          description\n        "):"deals"===t&&(o="deal_id",n="deals_tags",r="deals",i="\n          deal_id,\n          opportunity,\n          total_investment,\n          category,\n          stage,\n          description,\n          created_at\n        ");const{data:a,error:s}=await D.supabase.from(n).select(`${o}, tag_id`).in("tag_id",e);if(s)throw s;const l={};a.forEach((e=>{const t=e[o];l[t]||(l[t]=0),l[t]++}));const c=Object.keys(l).filter((t=>l[t]===e.length));if(0===c.length)return void T([]);const{data:d,error:u}=await D.supabase.from(r).select(i).in(o,c);if(u)throw u;T(d||[])}catch(o){console.error("Error fetching filtered results:",o),Pm.oR.error("Failed to fetch filtered results"),T([])}finally{I(!1)}}else T([])};return m?(0,N.jsx)(RO,{children:(0,N.jsx)(KO,{children:(0,N.jsx)("div",{children:"Loading Company Data..."})})},e):v?(0,N.jsx)(RO,{children:(0,N.jsxs)(YO,{children:[(0,N.jsx)("h2",{children:"Error Loading Company"}),(0,N.jsx)("p",{children:v}),(0,N.jsx)("button",{onClick:()=>o("/companies"),children:"Back to Companies"})]})},e):n?(0,N.jsxs)(RO,{children:[(0,N.jsxs)(qO,{children:[(0,N.jsx)("span",{onClick:()=>o("/companies"),style:{cursor:"pointer"},children:"Companies"}),(0,N.jsx)("span",{style:{margin:"0 8px"},children:"/"}),(0,N.jsx)("span",{onClick:()=>o(`/companies?category=${encodeURIComponent(n.category||"Uncategorized")}`),style:{cursor:"pointer"},children:n.category||"Uncategorized"}),(0,N.jsx)("span",{style:{margin:"0 8px"},children:"/"}),(0,N.jsx)("span",{style:{color:"#ccc"},children:n.name})]}),(0,N.jsxs)(OO,{children:[(0,N.jsxs)("div",{children:[(0,N.jsx)(TO,{children:n.name}),(0,N.jsxs)("div",{style:{display:"flex",alignItems:"center",marginTop:"10px",color:"#999",fontSize:"0.85rem"},children:[(0,N.jsxs)("div",{style:{marginRight:"20px"},children:[(0,N.jsx)("span",{children:"Created: "}),(0,N.jsx)("span",{style:{color:"#eee"},children:M(n.created_at)})]}),(0,N.jsxs)("div",{children:[(0,N.jsx)("span",{children:"Last modified: "}),(0,N.jsx)("span",{style:{color:"#eee"},children:M(n.updated_at)})]})]})]}),(0,N.jsxs)("div",{style:{display:"flex",gap:"10px"},children:[n.website&&(0,N.jsxs)("button",{onClick:F,style:{backgroundColor:"#4285F4",color:"white",border:"none",padding:"10px",borderRadius:"4px",cursor:"pointer",display:"flex",alignItems:"center",justifyContent:"center",textDecoration:"none"},children:[(0,N.jsx)(B.VeH,{style:{marginRight:"5px"}})," Website"]}),n.linkedin&&(0,N.jsx)(XO,{children:(0,N.jsx)(JO,{size:20,hasLink:!(!n.linkedin||!n.linkedin.trim()),onClick:L,onKeyDown:e=>{"Enter"!==e.key&&" "!==e.key||(e.preventDefault(),L())},tabIndex:0,title:n.linkedin&&n.linkedin.trim()?"Click to open LinkedIn profile":`Click to search for ${n.name} on LinkedIn`})}),(0,N.jsxs)(DO,{onClick:()=>{Pm.oR.info("Company editing coming soon")},children:[(0,N.jsx)(B.SG1,{})," Edit"]})]})]}),(0,N.jsxs)(PO,{children:[(0,N.jsxs)("div",{style:{width:"20%",flexShrink:0},children:[(0,N.jsxs)(NO,{children:[(0,N.jsxs)(IO,{children:[(0,N.jsx)(B.qYx,{})," Company Information"]}),(0,N.jsxs)(MO,{children:[(0,N.jsx)(LO,{children:"Website"}),n.website?(0,N.jsx)(FO,{onClick:F,style:{cursor:"pointer",color:"#00ff00"},title:"Click to open website",children:n.website}):(0,N.jsx)(FO,{children:"-"})]}),(0,N.jsxs)(MO,{children:[(0,N.jsx)(LO,{children:"LinkedIn"}),(0,N.jsx)(XO,{children:(0,N.jsx)(JO,{size:16,hasLink:!(!n.linkedin||!n.linkedin.trim()),onClick:L,onKeyDown:e=>{"Enter"!==e.key&&" "!==e.key||(e.preventDefault(),L())},tabIndex:0,title:n.linkedin&&n.linkedin.trim()?"Click to open LinkedIn profile":`Click to search for ${n.name} on LinkedIn`})})]}),(0,N.jsxs)(MO,{children:[(0,N.jsx)(LO,{children:"Category"}),(0,N.jsx)(FO,{children:n.category||"-"})]}),(0,N.jsxs)(MO,{children:[(0,N.jsx)(LO,{children:"Description"}),(0,N.jsx)(FO,{style:{fontSize:"0.85rem",lineHeight:"1.4"},children:n.description||"-"})]})]}),(0,N.jsxs)(NO,{children:[(0,N.jsx)(pT,{children:(0,N.jsxs)(IO,{onClick:()=>{_(!0),R([]),T([]),E("contacts")},style:{cursor:"pointer"},title:"Click to view tag relationships",children:[(0,N.jsx)(B.cnX,{})," Tags"]})}),(0,N.jsx)(BO,{children:l.length>0?l.map((e=>(0,N.jsx)(VO,{onClick:G,style:{cursor:"pointer"},title:"Click to manage tags",children:e.name},e.tag_id))):(0,N.jsx)("span",{style:{color:"#00ff00",cursor:"pointer",fontSize:"0.9rem"},onClick:G,title:"Click to add tags",children:"Add Tags"})})]}),d.length>0&&(0,N.jsxs)(NO,{children:[(0,N.jsxs)(IO,{children:[(0,N.jsx)(B.HzC,{})," Locations"]}),(0,N.jsx)(BO,{children:d.map((e=>(0,N.jsxs)(VO,{children:[e.name,", ",e.country]},e.city_id)))})]})]}),(0,N.jsxs)("div",{style:{width:"80%",flexGrow:1,boxSizing:"border-box",overflow:"hidden",paddingRight:"5px"},children:[(0,N.jsxs)($O,{children:[(0,N.jsxs)(UO,{active:"contacts"===x,onClick:()=>w("contacts"),children:["Contacts (",a.length,")"]}),(0,N.jsxs)(UO,{active:"deals"===x,onClick:()=>w("deals"),children:["Deals (",p.length,")"]})]}),(0,N.jsx)(WO,{active:"contacts"===x,children:(0,N.jsxs)(NO,{children:[(0,N.jsxs)(IO,{children:[(0,N.jsx)(B.cfS,{})," Associated Contacts"]}),0===a.length?(0,N.jsx)("div",{style:{padding:"30px 0",color:"#999",textAlign:"center"},children:"No contacts associated with this company"}):(0,N.jsx)("div",{children:a.map((e=>(0,N.jsxs)(GO,{onClick:()=>{return t=e.contacts,void o(`/contacts/${t.contact_id}`);var t},children:[(0,N.jsxs)(zO,{children:[e.contacts.first_name," ",e.contacts.last_name]}),(0,N.jsxs)(HO,{children:[e.contacts.job_role&&`${e.contacts.job_role} \u2022 `,e.relationship||"Associated",e.contacts.score&&` \u2022 Score: ${e.contacts.score}/5`]})]},e.contact_companies_id)))})]})}),(0,N.jsx)(WO,{active:"deals"===x,children:(0,N.jsxs)(NO,{children:[(0,N.jsxs)(IO,{children:[(0,N.jsx)(B.z8N,{})," Associated Deals"]}),0===p.length?(0,N.jsx)("div",{style:{padding:"30px 0",color:"#999",textAlign:"center"},children:"No deals associated with this company"}):(0,N.jsx)("div",{children:p.map((e=>{return(0,N.jsxs)(GO,{onClick:()=>(e.deals,void Pm.oR.info("Deal details coming soon")),children:[(0,N.jsx)(zO,{children:e.deals.opportunity}),(0,N.jsxs)(HO,{children:[e.deals.total_investment&&`$${e.deals.total_investment.toLocaleString()} \u2022 `,e.deals.stage&&`${e.deals.stage} \u2022 `,e.deals.category,(0,N.jsxs)("div",{style:{marginTop:"5px",fontSize:"0.8rem"},children:["Created: ",(t=e.deals.created_at,t?new Date(t).toLocaleDateString():"-")]})]})]},e.deals_companies_id);var t}))})]})})]})]}),k&&(0,N.jsx)(pt.A,{isOpen:k,onRequestClose:()=>{j(!1)},company:n,onTagAdded:e=>{c((t=>t.some((t=>t.tag_id===e.tag_id))?t:[...t,e]))},onTagRemoved:e=>{c((t=>t.filter((t=>t.tag_id!==e.tag_id))))}}),C&&(0,N.jsx)(QO,{onClick:z,children:(0,N.jsxs)(ZO,{onClick:e=>e.stopPropagation(),children:[(0,N.jsxs)(eT,{children:[(0,N.jsx)(iT,{active:"contacts"===S,onClick:()=>H("contacts"),children:"Related Contacts"}),(0,N.jsx)(iT,{active:"companies"===S,onClick:()=>H("companies"),children:"Related Companies"}),(0,N.jsx)(iT,{active:"deals"===S,onClick:()=>H("deals"),children:"Related Deals"}),(0,N.jsxs)("div",{style:{marginTop:"20px"},children:[(0,N.jsxs)("div",{style:{color:"#00ff00",marginBottom:"10px",fontSize:"0.9rem",fontWeight:"bold"},children:["Filter by Tags",A.length>0&&(0,N.jsxs)("span",{style:{color:"#999",fontSize:"0.8rem",marginLeft:"8px"},children:["(",A.length," selected)"]})]}),(0,N.jsx)("div",{style:{display:"flex",flexDirection:"column",gap:"6px"},children:l.length>0?l.map((e=>(0,N.jsx)(aT,{selected:A.includes(e.tag_id),onClick:()=>{return t=e.tag_id,void R((e=>{const o=e.includes(t)?e.filter((e=>e!==t)):[...e,t];return o.length>0?V(o,S):T([]),o}));var t},children:e.name},e.tag_id))):(0,N.jsx)("span",{style:{color:"#666",fontStyle:"italic",fontSize:"0.8rem"},children:"No tags"})})]})]}),(0,N.jsxs)(tT,{children:[(0,N.jsxs)(oT,{children:[(0,N.jsx)(nT,{children:"Tag Relationships"}),(0,N.jsx)(rT,{onClick:z,children:(0,N.jsx)(B.yGN,{size:20})})]}),(0,N.jsx)(uT,{children:0===A.length?(0,N.jsxs)("div",{style:{display:"flex",alignItems:"center",justifyContent:"center",height:"200px",color:"#999",textAlign:"center"},children:["Select one or more tags to see related ",S]}):P?(0,N.jsxs)(dT,{children:["Loading ",S,"..."]}):0===O.length?(0,N.jsxs)("div",{style:{display:"flex",alignItems:"center",justifyContent:"center",height:"200px",color:"#999",textAlign:"center"},children:["No ",S," found with selected tags"]}):(0,N.jsxs)("div",{children:[(0,N.jsxs)("div",{style:{padding:"15px 20px 10px 20px",borderBottom:"1px solid #333",color:"#00ff00",fontSize:"1.1rem",fontWeight:"bold"},children:[O.length," ",S," found"]}),O.map((t=>"contacts"===S?(0,N.jsxs)(sT,{onClick:()=>{o(`/contacts/${t.contact_id}`),z()},children:[(0,N.jsxs)(lT,{children:[t.first_name," ",t.last_name]}),(0,N.jsxs)(cT,{children:[t.job_role&&`${t.job_role} \u2022 `,t.category||"Uncategorized",t.score&&` \u2022 Score: ${t.score}/5`]})]},t.contact_id):"companies"===S?(0,N.jsxs)(sT,{onClick:()=>{t.company_id!==e&&(o(`/companies/${t.company_id}`),z())},children:[(0,N.jsx)(lT,{children:t.name}),(0,N.jsxs)(cT,{children:[t.category&&`${t.category} \u2022 `,t.website&&`${t.website} \u2022 `,t.description||"No description"]})]},t.company_id):"deals"===S?(0,N.jsxs)(sT,{onClick:()=>{w("deals"),z()},children:[(0,N.jsx)(lT,{children:t.opportunity}),(0,N.jsxs)(cT,{children:[t.total_investment&&`$${t.total_investment.toLocaleString()} \u2022 `,t.category&&`${t.category} \u2022 `,t.stage]})]},t.deal_id):null))]})})]})]})})]},e):(0,N.jsx)(RO,{children:(0,N.jsxs)(YO,{children:[(0,N.jsx)("h2",{children:"Company Not Found"}),(0,N.jsx)("p",{children:"The requested company could not be found."}),(0,N.jsx)("button",{onClick:()=>o("/companies"),children:"Back to Companies"})]})},e)};P.Ay.div`
  padding: 24px;
  height: calc(100vh - 120px);
`,P.Ay.div`
  margin-bottom: 24px;
  
  h1 {
    font-size: 1.5rem;
    font-weight: 600;
    color: #00ff00;
    margin-bottom: 8px;
  }
  
  p {
    color: #6b7280;
    font-size: 0.875rem;
  }
`,P.Ay.div`
  color: #ff3333;
  background-color: rgba(255, 0, 0, 0.1);
  border: 1px solid rgba(255, 0, 0, 0.3);
  padding: 12px;
  border-radius: 4px;
  margin-bottom: 20px;
`,P.Ay.div`
  color: #00ff00;
  text-align: center;
  padding: 40px;
  font-family: monospace;
  display: flex;
  flex-direction: column;
  align-items: center;
  justify-content: center;
  height: 200px;
`,P.Ay.div`
  display: flex;
  flex-wrap: wrap;
  gap: 10px;
  margin-bottom: 20px;
  background-color: #121212;
  padding: 10px;
  border-radius: 6px;
  border: 1px solid #333;
`,P.Ay.div`
  display: flex;
  align-items: center;
  padding: 8px 16px;
  cursor: pointer;
  background-color: ${e=>e.$active?"#00ff00":"transparent"};
  color: ${e=>e.$active?"#000":"#e0e0e0"};
  border-radius: 4px;
  border: 1px solid ${e=>e.$active?"#00ff00":"#333"};
  transition: all 0.2s;
  font-size: 14px;
  
  &:hover {
    background-color: ${e=>e.$active?"#00ff00":"#333"};
    border-color: #00ff00;
  }
  
  svg {
    margin-right: 8px;
  }
`;"undefined"!==typeof window&&ot().setAppElement("#root");const fT=P.Ay.div`
  display: flex;
  justify-content: space-between;
  align-items: center;
  margin-bottom: 15px;
  padding-bottom: 15px;
  border-bottom: 1px solid #333;

  h2 {
    margin: 0;
    font-size: 1.25rem;
    color: #00ff00;
    font-weight: 600;
  }

  button {
    background: none;
    border: none;
    cursor: pointer;
    color: #ffffff;
    padding: 4px;
    border-radius: 4px;
    
    &:hover {
      color: #ff5555;
    }
  }
`,gT=P.Ay.div`
  margin-bottom: 15px;
`,mT=P.Ay.h3`
  font-size: 16px;
  font-weight: bold;
  color: #00ff00;
  margin-bottom: 12px;
  display: flex;
  align-items: center;
  gap: 8px;
`,yT=P.Ay.div`
  display: flex;
  flex-wrap: wrap;
  gap: 8px;
  margin-bottom: 16px;
  padding: 5px 0;
  min-height: 32px;
`,vT=P.Ay.div`
  display: inline-flex;
  align-items: center;
  padding: 4px 8px;
  font-size: 0.75rem;
  border-radius: 4px;
  background-color: #222;
  color: #00ff00;
  font-weight: 500;
  margin-right: 0.25rem;
  margin-bottom: 0.25rem;
  border: 1px solid #00ff00;
  gap: 6px;
  max-width: 200px;
  cursor: pointer;
  transition: all 0.2s ease;

  &:hover {
    background-color: rgba(0, 255, 0, 0.1);
  }

  span {
    white-space: nowrap;
    overflow: hidden;
    text-overflow: ellipsis;
    max-width: 150px;
  }

  button {
    background: none;
    border: none;
    padding: 0;
    display: inline-flex;
    align-items: center;
    justify-content: center;
    margin-left: 0.25rem;
    color: #00ff00;
    cursor: pointer;
    
    &:hover { 
      color: #ff5555; 
    }
  }
`,bT=P.Ay.div`
  position: relative;
  margin-bottom: 16px;
  width: 90%;
`,xT=P.Ay.input`
  width: 100%;
  padding: 10px;
  padding-left: 36px;
  border: 1px solid #444;
  border-radius: 4px;
  font-size: 14px;
  color: #eee;
  background-color: #222;
  transition: all 0.2s;

  &:focus {
    outline: none;
    border-color: #00ff00;
  }

  &:hover {
    background-color: #333;
  }

  &::placeholder {
    color: #666;
  }
`,wT=P.Ay.div`
  position: absolute;
  left: 12px;
  top: 50%;
  transform: translateY(-50%);
  color: #999;
`,CT=P.Ay.div`
  margin-top: 8px;
  border: 1px solid #444;
  border-radius: 4px;
  max-height: 200px;
  overflow-y: auto;
  background-color: #222;
`,_T=P.Ay.button`
  width: 100%;
  text-align: left;
  padding: 8px 12px;
  background: none;
  border: none;
  border-bottom: 1px solid #333;
  cursor: pointer;
  font-size: 0.875rem;
  color: #eee;
  transition: background-color 0.2s;
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;

  &:last-child {
    border-bottom: none;
  }

  &:hover {
    background-color: #333;
    color: #00ff00;
  }
`,ST=P.Ay.button`
  display: inline-flex;
  align-items: center;
  gap: 6px;
  padding: 8px 16px;
  background-color: #333;
  color: #00ff00;
  border: none;
  border-radius: 4px;
  font-size: 0.875rem;
  cursor: pointer;
  transition: all 0.2s;
  width: 100%;
  text-align: left;

  &:hover {
    background-color: #444;
  }

  &:disabled {
    opacity: 0.5;
    cursor: not-allowed;
  }
`,ET=P.Ay.div`
  padding: 8px 12px;
  border-radius: 4px;
  font-size: 12px;
  margin-top: 12px;
  
  &.success {
    background-color: rgba(0, 255, 0, 0.1);
    color: #00ff00;
  }
  
  &.error {
    background-color: rgba(255, 70, 70, 0.2);
    color: #ff9999;
  }
`,kT=P.Ay.div`
  display: flex;
  justify-content: flex-end;
  gap: 10px;
  margin-top: 15px;
`,jT=P.Ay.button`
  padding: 8px 16px;
  border-radius: 4px;
  font-size: 0.875rem;
  font-weight: 500;
  cursor: pointer;
  transition: all 0.2s;
  display: flex;
  align-items: center;
  gap: 8px;
  
  &.primary {
    background-color: #00ff00;
    color: black;
    border: none;
    
    &:hover {
      background-color: #00dd00;
    }

    &:disabled {
      opacity: 0.5;
      cursor: not-allowed;
    }
  }
  
  &.secondary {
    background-color: transparent;
    color: #ccc;
    border: 1px solid #555;
    
    &:hover {
      background-color: #333;
    }
  }
`,AT=e=>{let{isOpen:o,onRequestClose:n,deal:r,onTagsUpdated:i}=e;const[a,s]=(0,t.useState)([]),[l,c]=(0,t.useState)([]),[d,u]=(0,t.useState)(""),[p,h]=(0,t.useState)([]),[f,g]=(0,t.useState)(!1),[m,y]=(0,t.useState)({type:"",text:""}),[v,b]=(0,t.useState)(!1);(0,t.useEffect)((()=>{if(o&&r){const e=r.deal_id||r.id;console.log("DealTagsModal opened with deal:",e,r.opportunity),console.log("Full deal object received:",r),e||console.error("DealTagsModal opened with deal missing ID:",r),C(),_()}else o&&!r&&(console.error("DealTagsModal opened but no deal was provided!"),console.log("isOpen:",o,"deal:",r))}),[o,r]);const[x,w]=(0,t.useState)(null);(0,t.useEffect)((()=>{if(o&&r){var e;const t=r.deal_id||r.id;console.log("Deal received in DealTagsModal:",{id:r.id,deal_id:r.deal_id,effectiveDealId:t,opportunity:r.opportunity,hasTags:!!r.tags,tagCount:null===(e=r.tags)||void 0===e?void 0:e.length});const o={...r,deal_id:t,tags:r.tags||[]};w(o),s(o.tags||[])}else o||(w(null),s([]),u(""),y({type:"",text:""}))}),[r,o]);const C=async()=>{const e=r||x,t=(null===e||void 0===e?void 0:e.deal_id)||(null===e||void 0===e?void 0:e.id);if(t)try{console.log("Fetching current tags for deal:",t);const{data:e,error:o}=await D.supabase.from("deal_tags").select("tag_id").eq("deal_id",t);if(o)throw o;if(!e||0===e.length)return void s([]);const n=e.map((e=>e.tag_id)),{data:r,error:i}=await D.supabase.from("tags").select("tag_id, name").in("tag_id",n);if(i)throw i;s(r||[])}catch(o){console.error("Error fetching current tags:",o),y({type:"error",text:"Failed to load current tags"})}else console.error("Cannot fetch current tags: No deal ID available")},_=async()=>{g(!0);try{const{data:e,error:t}=await D.supabase.from("tags").select("tag_id, name").order("name");if(t)throw t;console.log("Available tags fetched:",null===e||void 0===e?void 0:e.length);const o=(null===e||void 0===e?void 0:e.filter((e=>!!e.tag_id||(console.warn("Found tag without tag_id:",e),!1))))||[];c(o)}catch(e){console.error("Error fetching tags:",e),y({type:"error",text:"Failed to load tags"})}finally{g(!1)}};(0,t.useEffect)((()=>{d.length>=2?((async e=>{try{let t=D.supabase.from("tags").select("tag_id, name");e&&(t=t.ilike("name",`%${e}%`));const{data:o,error:n}=await t.limit(10);if(n)throw n;const r=o.filter((e=>!a.some((t=>t.tag_id===e.tag_id))));h(r)}catch(t){console.error("Error fetching suggestions:",t)}})(d),b(!0)):(h([]),b(!1))}),[d,a]);const S=e=>"string"===typeof e&&/^[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}$/i.test(e),E=async e=>{const t=r||x,o=(null===t||void 0===t?void 0:t.deal_id)||(null===t||void 0===t?void 0:t.id);if(!t||!o)return console.error("Cannot add tag: No deal object available"),y({type:"error",text:"Cannot add tag: No deal selected"}),!1;if(!S(o))return console.error("Cannot add tag: Deal ID is not a valid UUID",o),y({type:"error",text:"Cannot add tag: Invalid deal ID format"}),!1;const n=e.tag_id||e.id;if(!n)return console.error("Cannot add tag: Missing tag ID",e),y({type:"error",text:"Cannot add tag: Missing tag information"}),!1;try{g(!0),console.log(`Adding tag ${n} to deal ${o}`);const{data:t,error:r}=await D.supabase.from("deal_tags").select("*").eq("deal_id",o).eq("tag_id",n).maybeSingle();if(r)throw r;if(t)return console.log("Tag already exists on this deal"),y({type:"success",text:"This tag is already on the deal"}),!0;const{error:s}=await D.supabase.from("deal_tags").insert({deal_id:o,tag_id:n});if(s)throw s;if(y({type:"success",text:"Tag added successfully"}),await C(),i){const t=[...a,e];i(t)}return u(""),b(!1),!0}catch(s){return console.error("Error adding tag to deal:",s),y({type:"error",text:"Failed to add tag to deal"}),!1}finally{g(!1)}},k=async e=>{const t=r||x,o=(null===t||void 0===t?void 0:t.deal_id)||(null===t||void 0===t?void 0:t.id);if(!t||!o)return console.error("Cannot remove tag: No deal object available"),y({type:"error",text:"Cannot remove tag: No deal selected"}),!1;if(!S(o))return console.error("Cannot remove tag: Deal ID is not a valid UUID",o),y({type:"error",text:"Cannot remove tag: Invalid deal ID format"}),!1;const n=e.tag_id;if(!n)return console.error("Cannot remove tag: Missing tag ID",e),y({type:"error",text:"Cannot remove tag: Missing tag information"}),!1;try{g(!0),console.log(`Removing tag ${n} from deal ${o}`);const{error:e}=await D.supabase.from("deal_tags").delete().eq("deal_id",o).eq("tag_id",n);if(e)throw e;if(y({type:"success",text:"Tag removed successfully"}),await C(),i){const e=a.filter((e=>e.tag_id!==n));i(e)}return!0}catch(s){return console.error("Error removing tag from deal:",s),y({type:"error",text:"Failed to remove tag from deal"}),!1}finally{g(!1)}};return r?(0,N.jsx)(ot(),{isOpen:o,onRequestClose:()=>{console.log("Closing DealTagsModal for deal:",null===r||void 0===r?void 0:r.deal_id),n(),u(""),y({type:"",text:""})},style:{content:{top:"50%",left:"50%",right:"auto",bottom:"auto",marginRight:"-50%",transform:"translate(-50%, -50%)",padding:"20px",border:"1px solid #333",backgroundColor:"#121212",color:"#e0e0e0",borderRadius:"8px",boxShadow:"0 4px 20px rgba(0, 0, 0, 0.6)",maxWidth:"500px",width:"90%",minHeight:"360px"},overlay:{backgroundColor:"rgba(0, 0, 0, 0.75)",zIndex:1e3}},children:(0,N.jsxs)("div",{style:{padding:"1rem"},children:[(0,N.jsxs)(fT,{children:[(0,N.jsx)("h2",{children:"Manage Tags"}),(0,N.jsx)("button",{onClick:n,"aria-label":"Close modal",children:(0,N.jsx)(B.yGN,{size:20})})]}),(0,N.jsxs)(gT,{children:[(0,N.jsx)(mT,{children:"Current Tags"}),(0,N.jsxs)(yT,{children:[a.map((e=>(0,N.jsxs)(vT,{onClick:()=>k(e),children:[(0,N.jsx)("span",{title:e.name,children:e.name.length>25?`${e.name.substring(0,25)}...`:e.name}),(0,N.jsx)("button",{onClick:t=>{t.stopPropagation(),k(e)},disabled:f,children:(0,N.jsx)(B.yGN,{size:14})})]},e.tag_id))),0===a.length&&(0,N.jsx)("span",{style:{color:"#6c757d",fontStyle:"italic",padding:"4px"},children:"No tags assigned"})]})]}),(0,N.jsxs)(gT,{children:[(0,N.jsx)(mT,{children:"Add Tags"}),(0,N.jsxs)(bT,{children:[(0,N.jsx)(wT,{children:(0,N.jsx)(B.CKj,{size:16})}),(0,N.jsx)(xT,{type:"text",value:d,onChange:e=>{const t=e.target.value;u(t)},placeholder:"Search or create new tag..."})]}),v&&(0,N.jsxs)(CT,{children:[p.map((e=>(0,N.jsx)(_T,{onClick:()=>E(e),disabled:f,children:e.name},e.tag_id))),d.trim()&&!p.find((e=>e.name.toLowerCase()===d.toLowerCase()))&&(0,N.jsxs)(ST,{onClick:async()=>{if(d.trim())try{g(!0);const{data:e,error:t}=await D.supabase.from("tags").select("tag_id, name").ilike("name",d.trim());if(t)throw t;if(e&&e.length>0){const t=e[0];return console.log("Using existing tag:",t),void await E(t)}const{data:o,error:n}=await D.supabase.from("tags").insert({name:d.trim()}).select("tag_id, name").single();if(n)throw n;console.log("New tag created:",o),await E(o),_(),y({type:"success",text:`Created new tag "${d.trim()}"`})}catch(e){console.error("Error creating tag:",e),y({type:"error",text:"Failed to create tag"})}finally{g(!1)}},disabled:f,children:[(0,N.jsx)(B.GGD,{size:14}),'Create "',d,'"']})]})]}),m&&m.text&&(0,N.jsx)(ET,{className:m.type,children:m.text}),(0,N.jsx)(kT,{children:(0,N.jsx)(jT,{className:"primary",onClick:n,children:"Done"})}),f&&(0,N.jsx)("div",{style:{textAlign:"center",marginTop:"10px"},children:(0,N.jsx)("div",{className:"spinner",style:{width:"20px",height:"20px",border:"3px solid #222",borderTop:"3px solid #00ff00",borderRadius:"50%",animation:"spin 1s linear infinite"}})})]})}):(o&&console.warn("DealTagsModal received null deal"),o?(0,N.jsx)(ot(),{isOpen:o,onRequestClose:n,style:{content:{top:"50%",left:"50%",right:"auto",bottom:"auto",marginRight:"-50%",transform:"translate(-50%, -50%)",padding:"20px",border:"1px solid #333",backgroundColor:"#121212",color:"#e0e0e0",borderRadius:"8px",boxShadow:"0 4px 20px rgba(0, 0, 0, 0.6)",maxWidth:"500px",width:"90%",minHeight:"360px"},overlay:{backgroundColor:"rgba(0, 0, 0, 0.75)",zIndex:1e3}},children:(0,N.jsxs)("div",{style:{padding:"1rem"},children:[(0,N.jsxs)(fT,{children:[(0,N.jsx)("h2",{children:"Cannot Manage Tags"}),(0,N.jsx)("button",{onClick:n,children:(0,N.jsx)(B.yGN,{size:20})})]}),(0,N.jsxs)("div",{style:{padding:"20px",color:"#ff6666",textAlign:"center"},children:[(0,N.jsx)("p",{children:"No valid deal was selected. Please try again by selecting a deal first."}),(0,N.jsx)(jT,{className:"primary",onClick:n,style:{marginTop:"20px"},children:"Close"})]})]})}):null)},RT=document.createElement("style");RT.innerHTML="\n  @keyframes spin {\n    0% { transform: rotate(0deg); }\n    100% { transform: rotate(360deg); }\n  }\n",document.head.appendChild(RT);var OT=o(585);const TT=P.Ay.div`
  width: 100%;
  max-width: 600px;
`,DT=P.Ay.div`
  display: flex;
  justify-content: space-between;
  align-items: center;
  margin-bottom: 20px;
  padding-bottom: 15px;
  border-bottom: 1px solid #333;
`,PT=P.Ay.h2`
  color: #fff;
  font-size: 20px;
  font-weight: 500;
  margin: 0;
`,NT=P.Ay.button`
  background: transparent;
  color: #00ff00;
  border: none;
  cursor: pointer;
  display: flex;
  align-items: center;
  justify-content: center;
  font-size: 20px;
  padding: 5px;
  border-radius: 4px;

  &:hover {
    background: #333;
  }
`,IT=P.Ay.div`
  margin-bottom: 20px;
`,MT=P.Ay.label`
  display: block;
  margin-bottom: 8px;
  color: #00ff00;
  font-size: 14px;
  font-weight: 500;
`,LT=P.Ay.div`
  position: relative;
  margin-bottom: 20px;
`,FT=P.Ay.input`
  width: 100%;
  padding: 10px 40px 10px 12px;
  background: #333;
  border: 1px solid #444;
  border-radius: 4px;
  color: #fff;
  font-size: 14px;
  box-sizing: border-box;
  height: 40px;

  &:focus {
    outline: none;
    border-color: #00ff00;
  }
`,GT=P.Ay.div`
  position: absolute;
  right: 12px;
  top: 50%;
  transform: translateY(-50%);
  color: #aaa;
`,zT=P.Ay.div`
  background: #222;
  border: 1px solid #444;
  border-radius: 4px;
  max-height: 300px;
  overflow-y: auto;
  margin-top: 10px;
`,HT=P.Ay.div`
  padding: 10px 15px;
  border-bottom: 1px solid #333;
  cursor: pointer;
  display: flex;
  justify-content: space-between;
  align-items: center;

  &:hover {
    background: #333;
  }

  &:last-child {
    border-bottom: none;
  }
`,BT=P.Ay.div`
  flex: 1;
`,VT=P.Ay.div`
  color: #fff;
  font-weight: 500;
  margin-bottom: 4px;
`,$T=P.Ay.div`
  color: #999;
  font-size: 12px;
`,UT=P.Ay.button`
  background: transparent;
  border: none;
  color: #00ff00;
  cursor: pointer;
  display: flex;
  align-items: center;
  justify-content: center;
  padding: 5px;
  margin-left: 5px;
  border-radius: 4px;

  &:hover {
    background: #444;
  }
`,WT=P.Ay.div`
  padding: 20px;
  text-align: center;
  color: #999;
`,qT=P.Ay.div`
  display: flex;
  justify-content: flex-end;
  gap: 10px;
  margin-top: 30px;
`,KT=P.Ay.button`
  display: flex;
  align-items: center;
  gap: 8px;
  padding: 8px 16px;
  border-radius: 4px;
  font-size: 14px;
  cursor: pointer;
  transition: all 0.2s;
  
  &.primary {
    background: #333;
    color: #00ff00;
    border: 1px solid #00ff00;
    
    &:hover {
      background: #444;
    }
  }
  
  &.cancel {
    background: transparent;
    color: #fff;
    border: 1px solid #555;
    
    &:hover {
      background: #333;
    }
  }
`,YT=P.Ay.select`
  width: 100%;
  padding: 10px;
  background: #333;
  border: 1px solid #444;
  border-radius: 4px;
  color: #fff;
  font-size: 14px;
  box-sizing: border-box;
  appearance: none;
  background-image: url("data:image/svg+xml;utf8,<svg xmlns='http://www.w3.org/2000/svg' width='10' height='6' fill='none' stroke='%23aaa' stroke-width='1.5' viewBox='0 0 10 6'><polyline points='1,1 5,5 9,1'/></svg>");
  background-repeat: no-repeat;
  background-position: right 10px center;
  padding-right: 30px;
  height: 40px;

  &:focus {
    outline: none;
    border-color: #00ff00;
  }
`,JT=["introducer","co-investor","advisor","proposer","other"],XT=e=>{let{isOpen:o,onRequestClose:n,dealId:r,onContactAssociated:i=()=>{}}=e;const[a,s]=(0,t.useState)(""),[l,c]=(0,t.useState)([]),[d,u]=(0,t.useState)(!1),[p,h]=(0,t.useState)(!1),[f,g]=(0,t.useState)(null),[m,y]=(0,t.useState)("other"),v=(0,t.useRef)(null),b=(0,t.useRef)(null);(0,t.useEffect)((()=>{o&&v.current&&setTimeout((()=>{v.current.focus()}),100),o&&(s(""),c([]),g(null),y("other"),h(!1),console.log("AssociateDealContactModal opened with dealId:",r))}),[o,r]);const x=async e=>{u(!0);try{const{data:t,error:o}=await D.supabase.from("deals_contacts").select("contact_id").eq("deal_id",r);if(o)throw o;const n=new Set(t.map((e=>e.contact_id))),{data:i,error:a}=await D.supabase.from("contacts").select("*").or(`first_name.ilike.%${e}%,last_name.ilike.%${e}%`).order("last_name",{ascending:!0}).limit(20);if(a)throw a;const s=i.filter((e=>!n.has(e.contact_id)));c(s),h(0===s.length)}catch(t){console.error("Error searching contacts:",t),nt.Ay.error("Failed to search contacts")}finally{u(!1)}};return(0,N.jsx)(ot(),{isOpen:o,onRequestClose:n,style:{content:{top:"50%",left:"50%",right:"auto",bottom:"auto",marginRight:"-50%",transform:"translate(-50%, -50%)",padding:"25px",border:"1px solid #444",borderRadius:"8px",backgroundColor:"#111",color:"#fff",maxWidth:"600px",width:"90%",boxShadow:"0 4px 20px rgba(0, 0, 0, 0.5)"},overlay:{backgroundColor:"rgba(0, 0, 0, 0.7)",zIndex:1e3}},children:(0,N.jsxs)(TT,{children:[(0,N.jsxs)(DT,{children:[(0,N.jsx)(PT,{children:"Associate Contact with Deal"}),(0,N.jsx)(NT,{onClick:n,children:(0,N.jsx)(B.yGN,{size:20})})]}),(0,N.jsxs)(LT,{children:[(0,N.jsx)(FT,{ref:v,type:"text",value:a,onChange:e=>{const t=e.target.value;if(s(t),b.current&&clearTimeout(b.current),t.length<2)return c([]),void h(!1);b.current=setTimeout((()=>{x(t)}),300)},onKeyDown:e=>{if("Enter"===e.key){if(e.preventDefault(),a.length<2)return;b.current&&clearTimeout(b.current),x(a)}},placeholder:"Search for a contact by name..."}),(0,N.jsx)(GT,{children:(0,N.jsx)(B.CKj,{size:16})})]}),d&&(0,N.jsx)(WT,{children:"Searching..."}),!d&&a.length>=2&&(0,N.jsx)(N.Fragment,{children:l.length>0?(0,N.jsx)(zT,{children:l.map((e=>(0,N.jsxs)(HT,{onClick:()=>(e=>{g(e),c([]),s(`${e.first_name} ${e.last_name}`)})(e),children:[(0,N.jsxs)(BT,{children:[(0,N.jsxs)(VT,{children:[e.first_name," ",e.last_name]}),(0,N.jsxs)($T,{children:[e.job_role||"No job role"," \u2022 ",e.mobile||"No mobile"]})]}),(0,N.jsx)(UT,{title:"View details",children:(0,N.jsx)(B.HaR,{size:16})})]},e.contact_id)))}):p?(0,N.jsx)(zT,{children:(0,N.jsxs)(WT,{children:["No contacts found with that name.",(0,N.jsx)("div",{style:{marginTop:"10px"},children:(0,N.jsxs)(KT,{className:"primary",onClick:()=>{n(),i({action:"create_new",searchTerm:a})},children:[(0,N.jsx)(B.GGD,{size:14})," Create New Contact"]})})]})}):null}),f&&(0,N.jsx)(N.Fragment,{children:(0,N.jsxs)(IT,{style:{marginTop:"20px"},children:[(0,N.jsx)(MT,{children:"Relationship to Deal"}),(0,N.jsx)(YT,{value:m,onChange:e=>y(e.target.value),children:JT.map((e=>(0,N.jsx)("option",{value:e,children:e.charAt(0).toUpperCase()+e.slice(1)},e)))})]})}),(0,N.jsxs)(qT,{children:[(0,N.jsx)(KT,{className:"cancel",onClick:n,children:"Cancel"}),(0,N.jsx)(KT,{className:"primary",onClick:async()=>{if(f){if(console.log("handleAssociateContact - dealId:",r,"type:",typeof r),console.log("handleAssociateContact - selectedContact:",f),!r)return console.error("Missing deal ID when trying to associate contact",{dealId:r,contactId:null===f||void 0===f?void 0:f.contact_id}),void nt.Ay.error("Cannot associate contact: Missing deal ID");try{nt.Ay.loading("Associating contact...",{id:"associate-contact"}),console.log("Associating contact to deal",{dealId:r,dealIdType:typeof r,contactId:f.contact_id,contactName:`${f.first_name} ${f.last_name}`,relationship:m});const{data:e,error:t}=await D.supabase.from("deals_contacts").insert({deal_id:String(r),contact_id:f.contact_id,relationship:m}).select();if(t)throw console.error("Database error when associating contact:",t),t;console.log("Contact association successful:",e),nt.Ay.dismiss("associate-contact"),nt.Ay.success(`${f.first_name} ${f.last_name} associated successfully`),i({action:"associated",contact:f,relationship:m,data:null===e||void 0===e?void 0:e[0]}),n()}catch(e){console.error("Error associating contact:",e),nt.Ay.dismiss("associate-contact"),nt.Ay.error(`Failed to associate contact: ${e.message||"Unknown error"}`)}}else nt.Ay.error("Please select a contact to associate")},disabled:!f,children:f?`Associate ${f.first_name} ${f.last_name}`:"Select a Contact"})]})]})})},QT=P.Ay.div`
  padding: 0;
  height: calc(100vh - 120px);
  width: 100%;
`,ZT=(P.Ay.h1`
  color: #00ff00;
  margin: 20px;
  font-family: 'Courier New', monospace;
`,P.Ay.div`
  display: flex;
  background-color: #111;
  border-bottom: 1px solid #333;
  overflow-x: auto;
  scrollbar-width: thin;
  scrollbar-color: #00ff00 #222;
  padding: 8px 0;
  margin-bottom: 0;
  position: sticky;
  top: 0;
  z-index: 100;
  width: 100%;
  height: 48px;
  align-items: center;
  
  &::-webkit-scrollbar {
    height: 6px;
  }
  
  &::-webkit-scrollbar-track {
    background: #222;
  }
  
  &::-webkit-scrollbar-thumb {
    background-color: #00ff00;
    border-radius: 3px;
  }
`),eD=P.Ay.div`
  display: flex;
  align-items: center;
  padding: 10px 15px;
  color: ${e=>e.$active?"#00ff00":"#ccc"};
  text-decoration: none;
  border-bottom: ${e=>e.$active?"2px solid #00ff00":"none"};
  margin-right: 10px;
  font-family: 'Courier New', monospace;
  transition: all 0.2s ease;
  white-space: nowrap;
  cursor: pointer;
  font-size: 0.9rem;
  font-weight: ${e=>e.$active?"bold":"normal"};
  
  &:hover {
    color: #00ff00;
    background-color: rgba(0, 255, 0, 0.05);
  }
  
  &:first-child {
    margin-left: 10px;
  }
  
  svg {
    margin-right: 8px;
    font-size: 1rem;
  }
`,tD=P.Ay.div`
  color: #ff3333;
  background-color: #330000;
  padding: 15px;
  border-radius: 4px;
  margin-bottom: 20px;
`,oD=P.Ay.div`
  color: #00ff00;
  text-align: center;
  padding: 40px;
  font-family: monospace;
  display: flex;
  flex-direction: column;
  align-items: center;
  justify-content: center;
  height: 400px;
`,nD=P.Ay.div`
  width: 300px;
  height: 8px;
  background-color: #111;
  margin: 20px 0;
  border-radius: 4px;
  overflow: hidden;
  position: relative;
  box-shadow: 0 0 10px rgba(0, 255, 0, 0.2);
  
  &:before {
    content: "";
    position: absolute;
    top: 0;
    left: 0;
    height: 100%;
    width: 30%;
    background-color: #00ff00;
    animation: pulse 1.5s ease-in-out infinite;
    box-shadow: 0 0 20px #00ff00;
    border-radius: 4px;
  }
  
  @keyframes pulse {
    0% {
      left: -30%;
      opacity: 0.8;
    }
    100% {
      left: 100%;
      opacity: 0.2;
    }
  }
`,rD=P.Ay.div`
  margin-top: 15px;
  color: #00ff00;
  text-shadow: 0 0 5px rgba(0, 255, 0, 0.5);
  letter-spacing: 1px;
  font-size: 16px;
  opacity: 0.9;
  animation: blink 1.5s ease-in-out infinite alternate;
  
  @keyframes blink {
    from { opacity: 0.6; }
    to { opacity: 1; }
  }
`,iD=P.Ay.div`
  font-family: 'Courier New', monospace;
  font-size: 14px;
  color: #00ff00;
  text-align: center;
  margin-top: 30px;
  height: 100px;
  width: 300px;
  overflow: hidden;
  position: relative;
  
  &:after {
    content: "01001100 01101111 01100001 01100100 01101001 01101110 01100111 00100000 01000100 01100101 01100001 01101100 01110011 00101110 00101110 00101110";
    position: absolute;
    top: 0;
    left: 0;
    height: 100%;
    width: 100%;
    background: linear-gradient(to bottom, transparent, #000 80%);
    display: flex;
    flex-wrap: wrap;
    justify-content: center;
    opacity: 0.7;
    text-shadow: 0 0 5px #00ff00;
    animation: matrix 5s linear infinite;
  }
  
  @keyframes matrix {
    0% { transform: translateY(-60px); }
    100% { transform: translateY(60px); }
  }
`,aD=(P.Ay.span`
  display: inline-block;
  background-color: ${e=>e.bg||"#222"};
  color: ${e=>e.color||"#00ff00"};
  border: 1px solid ${e=>e.borderColor||"#00ff00"};
  padding: 2px 6px;
  margin-right: 3px;
  border-radius: 4px;
  font-size: 11px;
`,{content:{top:"50%",left:"50%",right:"auto",bottom:"auto",marginRight:"-50%",transform:"translate(-50%, -50%)",backgroundColor:"#121212",color:"#00ff00",border:"1px solid #00ff00",borderRadius:"4px",padding:"20px",maxWidth:"80%",maxHeight:"80%",overflow:"auto"},overlay:{backgroundColor:"rgba(0, 0, 0, 0.75)"}});"undefined"!==typeof window&&ot().setAppElement("#root");const sD=P.Ay.div`
  display: flex;
  flex-direction: column;
  gap: 15px;
`,lD=P.Ay.div`
  display: flex;
  justify-content: space-between;
  align-items: center;
  margin-bottom: 15px;
  border-bottom: 1px solid #333;
  padding-bottom: 10px;
  
  h2 {
    margin: 0;
    color: #00ff00;
    font-family: 'Courier New', monospace;
  }
  
  button {
    background: none;
    border: none;
    color: #00ff00;
    font-size: 18px;
    cursor: pointer;
    
    &:hover {
      color: #fff;
    }
  }
`,cD=P.Ay.div`
  display: flex;
  flex-direction: column;
  gap: 10px;
`,dD=P.Ay.div`
  display: flex;
  align-items: center;
  padding: 10px;
  background-color: #222;
  border-radius: 4px;
  border: 1px solid #333;
  
  &:hover {
    background-color: #333;
  }
`,uD=P.Ay.div`
  margin-right: 10px;
  font-size: 20px;
`,pD=P.Ay.div`
  flex: 1;
  
  .filename {
    font-weight: bold;
    margin-bottom: 4px;
  }
  
  .fileinfo {
    font-size: 12px;
    color: #aaa;
  }
`,hD=P.Ay.a`
  color: #00ff00;
  text-decoration: none;
  padding: 6px 12px;
  border: 1px solid #00ff00;
  border-radius: 4px;
  font-size: 12px;
  
  &:hover {
    background-color: #00ff00;
    color: #000;
  }
`,fD=P.Ay.button`
  color: #00ff00;
  background: transparent;
  padding: 6px 12px;
  border: 1px solid #00ff00;
  border-radius: 4px;
  font-size: 12px;
  cursor: pointer;
  margin-left: 8px;
  transition: all 0.2s ease;
  
  &:hover {
    background-color: #00ff00;
    color: #000;
    box-shadow: 0 0 8px rgba(0, 255, 0, 0.5);
  }
`,gD=(P.Ay.div`
  display: flex;
  flex-direction: column;
  gap: 15px;
  max-width: 600px;
`,P.Ay.div`
  display: flex;
  flex-wrap: wrap;
  gap: 10px;
  margin-top: 15px;
`,P.Ay.div`
  display: flex;
  align-items: center;
  background-color: ${e=>e.$selected?"rgba(0, 255, 0, 0.2)":"rgba(0, 255, 0, 0.1)"};
  border: 1px solid #00ff00;
  border-radius: 12px;
  padding: 6px 12px;
  font-size: 14px;
  cursor: pointer;
  transition: all 0.2s ease;
  
  &:hover {
    background-color: rgba(0, 255, 0, 0.2);
    box-shadow: 0 0 8px rgba(0, 255, 0, 0.3);
  }
`,P.Ay.button`
  display: flex;
  align-items: center;
  gap: 6px;
  background: transparent;
  color: #00ff00;
  border: 1px dashed #00ff00;
  border-radius: 12px;
  padding: 6px 12px;
  font-size: 14px;
  cursor: pointer;
  transition: all 0.2s ease;
  
  &:hover {
    background-color: rgba(0, 255, 0, 0.1);
  }
`,P.Ay.div`
  display: flex;
  flex-direction: column;
  gap: 10px;
  margin-top: 10px;
  padding-top: 15px;
  border-top: 1px solid #333;
`,P.Ay.div`
  display: flex;
  gap: 10px;
  margin-top: 15px;
`,P.Ay.input`
  flex: 1;
  background-color: #222;
  color: #fff;
  border: 1px solid #444;
  border-radius: 4px;
  padding: 8px 12px;
  font-family: 'Courier New', monospace;
  
  &:focus {
    outline: none;
    border-color: #00ff00;
    box-shadow: 0 0 5px rgba(0, 255, 0, 0.3);
  }
`,P.Ay.div`
  display: flex;
  flex-direction: column;
  gap: 8px;
  margin-bottom: 15px;
`,P.Ay.input`
  background-color: #222;
  color: #fff;
  border: 1px solid #444;
  border-radius: 4px;
  padding: 8px 12px;
  font-family: 'Courier New', monospace;
  width: 100%;
  
  &:focus {
    outline: none;
    border-color: #00ff00;
    box-shadow: 0 0 5px rgba(0, 255, 0, 0.3);
  }
  
  &::placeholder {
    color: #666;
  }
`,P.Ay.button`
  display: flex;
  align-items: center;
  gap: 8px;
  background-color: #00ff00;
  color: #000000;
  border: 1px solid #00ff00;
  border-radius: 4px;
  padding: 8px 16px;
  font-size: 14px;
  font-weight: bold;
  cursor: pointer;
  transition: all 0.2s ease;
  font-family: 'Courier New', monospace;
  box-shadow: 0 0 8px rgba(0, 255, 0, 0.3);
  margin-left: auto; /* Push to the right */
  
  &:hover {
    background-color: rgba(0, 255, 0, 0.9);
    box-shadow: 0 0 12px rgba(0, 255, 0, 0.5);
    text-shadow: 0 0 5px rgba(0, 255, 0, 0.5);
  }
  
  svg {
    font-size: 16px;
  }
`),mD=P.Ay.div`
  display: flex;
  align-items: center;
  margin: 20px;
  gap: 10px;
`,yD=P.Ay.input`
  background-color: #222;
  color: #fff;
  border: 1px solid #444;
  border-radius: 4px;
  padding: 8px 12px 8px 40px;
  font-family: 'Courier New', monospace;
  font-size: 14px;
  width: 300px;
  transition: all 0.2s ease;
  
  &:focus {
    outline: none;
    border-color: #666;
  }
  
  &::placeholder {
    color: #666;
    font-style: normal;
    text-transform: uppercase;
  }
`,vD=P.Ay.div`
  position: relative;
  display: flex;
  align-items: center;
`,bD=P.Ay.div`
  position: absolute;
  left: 12px;
  color: #00ff00;
  display: flex;
  align-items: center;
  font-size: 16px;
  pointer-events: none;
  z-index: 1;
`,xD=(P.Ay.h3`
  color: #00ff00;
  font-family: 'Courier New', monospace;
  margin: 0;
  display: flex;
  align-items: center;
  gap: 8px;
  
  svg {
    stroke: #00ff00;
  }
`,e=>{var t;const o=e.value;if(!o)return"-";const n=(null===(t=e.data)||void 0===t?void 0:t.deal_currency)||"USD";return new Intl.NumberFormat("en-US",{style:"currency",currency:n,minimumFractionDigits:0,maximumFractionDigits:0}).format(o)}),wD={Startup:{bg:"#2d4b8e",color:"#fff"},Investment:{bg:"#3a7ca5",color:"#fff"},Fund:{bg:"#4a6c6f",color:"#fff"},Partnership:{bg:"#528f65",color:"#fff"},"Real Estate":{bg:"#5d5d8c",color:"#fff"},"Private Debt":{bg:"#8c5d5d",color:"#fff"},"Private Equity":{bg:"#8c7a5d",color:"#fff"},Other:{bg:"#6b6b6b",color:"#fff"},Inbox:{bg:"#6a5acd",color:"#fff"},All:{bg:"#00ff00",color:"#000"}},CD=e=>{const[o,n]=t.useState(!1),r=e.value||[],i=e.data;if(!r.length&&!i)return"";const a=r.slice(0,2),s=r.length-2,l=0===r.length,c=e=>{e.stopPropagation(),n(!0)};return(0,N.jsx)("div",{style:{height:"100%",display:"flex",alignItems:"center",justifyContent:"center"},children:(0,N.jsxs)("div",{onClick:e=>{e.stopPropagation()},style:{whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis",paddingRight:"0",width:"100%",height:"100%",display:"flex",alignItems:"center",gap:"6px"},children:[a.map((t=>(0,N.jsxs)("div",{title:t.name,style:{display:"flex",alignItems:"center",justifyContent:"center",backgroundColor:"#1a1a1a",color:"#00ff00",padding:"0px 6px",borderRadius:"4px",fontSize:"11px",border:"1px solid #00ff00",boxShadow:"0 0 4px rgba(0, 255, 0, 0.4)",whiteSpace:"nowrap",overflow:"visible",lineHeight:"16px",maxWidth:"fit-content",height:"18px"},children:[t.name.length>15?`${t.name.substring(0,15)}...`:t.name,(0,N.jsx)("button",{onClick:o=>(async(t,o)=>{t.stopPropagation();try{const t=r.find((e=>e.tag_id===o)),{error:n}=await D.supabase.from("deal_tags").delete().eq("deal_id",i.deal_id).eq("tag_id",o);if(n)throw n;const a=r.filter((e=>e.tag_id!==o));e.setValue(a),e.api&&e.api.refreshCells({force:!0,rowNodes:[e.node],columns:["tags"]}),Pm.oR.success(`Tag "${(null===t||void 0===t?void 0:t.name)||"Unknown"}" removed from ${i.opportunity}`,{position:"top-right",autoClose:3e3,hideProgressBar:!1,closeOnClick:!0,pauseOnHover:!0,draggable:!0})}catch(n){console.error("Error removing tag:",n),Pm.oR.error(`Error removing tag: ${n.message}`,{position:"top-right",autoClose:5e3,hideProgressBar:!1,closeOnClick:!0,pauseOnHover:!0,draggable:!0})}})(o,t.tag_id),title:"Remove tag",style:{display:"flex",alignItems:"center",justifyContent:"center",marginLeft:"5px",padding:"0",background:"none",border:"none",cursor:"pointer",color:"#00ff00",fontSize:"12px",fontWeight:"bold"},children:"\u2715"})]},t.tag_id))),s>0&&(0,N.jsxs)("div",{style:{display:"inline-flex",alignItems:"center",justifyContent:"center",padding:"0px 3px",borderRadius:"3px",fontSize:"9px",color:"#999999",cursor:"pointer",height:"16px",lineHeight:"16px",backgroundColor:"#333333",marginRight:"1px"},onClick:c,children:["+",s]}),l?(0,N.jsx)("div",{onClick:c,style:{color:"#00ff00",fontSize:"11px",cursor:"pointer",display:"flex",alignItems:"center",justifyContent:"center",gap:"4px",width:"100%",height:"100%"},title:"Add or edit tags",children:"Add tags"}):(0,N.jsx)("button",{onClick:c,title:"Add or edit tags",style:{background:"none",border:"none",color:"#00ff00",borderRadius:"3px",width:"16px",height:"16px",padding:"0",display:"flex",alignItems:"center",justifyContent:"center",cursor:"pointer",fontSize:"12px"},children:"+"}),o&&(0,N.jsx)(AT,{isOpen:o,onRequestClose:()=>{n(!1),e.api&&(e.api.refreshCells({force:!0,rowNodes:[e.node],columns:["tags"]}),setTimeout((()=>{e.context&&e.context.refreshData&&e.context.refreshData()}),100))},deal:{...i,id:i.deal_id}})]})})};class _D{init(e){this.params=e,this.eGui=document.createElement("div"),this.eGui.style.width="100%",this.eGui.style.height="100%",this.eGui.style.display="flex",this.eGui.style.alignItems="center",this.eGui.style.justifyContent="center",this.eSelect=document.createElement("select"),this.eSelect.className="stage-filter-dropdown",this.eSelect.style.backgroundColor="#1a1a1a",this.eSelect.style.color="#00ff00",this.eSelect.style.border="1px solid #00ff00",this.eSelect.style.borderRadius="4px",this.eSelect.style.padding="5px",this.eSelect.style.width="95%",this.eSelect.style.fontFamily="Courier New, monospace",this.eSelect.style.fontSize="0.85rem",this.eSelect.style.cursor="pointer",this.eSelect.style.textShadow="0 0 5px rgba(0, 255, 0, 0.5)",this.eSelect.style.boxShadow="0 0 5px rgba(0, 255, 0, 0.3)",this.eSelect.style.outline="none";[{value:"",text:"All Stages"},{value:"Lead",text:"Lead"},{value:"Qualified",text:"Qualified"},{value:"Evaluating",text:"Evaluating"},{value:"Closing",text:"Closing"},{value:"Negotiation",text:"Negotiation"},{value:"Closed Won",text:"Closed Won"},{value:"Invested",text:"Invested"},{value:"Closed Lost",text:"Closed Lost"},{value:"Monitoring",text:"Monitoring"},{value:"Passed",text:"Passed"}].forEach((e=>{const t=document.createElement("option");t.value=e.value,t.text=e.text,t.style.backgroundColor="#1a1a1a",t.style.color="#00ff00",this.eSelect.appendChild(t)})),e.context&&"undefined"!==typeof e.context.stageFilter&&(this.eSelect.value=e.context.stageFilter),this.eSelect.addEventListener("change",(()=>{const t=this.eSelect.value;e.context&&"function"===typeof e.context.setStageFilter&&(e.context.setStageFilter(t),e.api&&e.api.onFilterChanged())}));const t=()=>{try{let e=document.querySelector('.ag-header-cell.ag-floating-filter[aria-colindex="5"]');if(!e){const t=document.querySelectorAll(".ag-header-cell.ag-floating-filter");t&&t.length>=5&&(e=t[4])}if(!e){const t=document.querySelector('.ag-header-cell[col-id="stage"]');if(t){const o=t.getAttribute("aria-colindex");o&&(e=document.querySelector(`.ag-header-cell.ag-floating-filter[aria-colindex="${o}"]`))}}if(console.log("Target cell found:",!!e),e){let t=e.querySelector('div[role="presentation"]');if(t||(t=e.querySelector(".ag-floating-filter-body")),t||(t=e.querySelector(".ag-floating-filter-full-body")),t||(t=e),console.log("Container found:",!!t),t)return t.innerHTML="",t.appendChild(this.eSelect),console.log("Successfully injected filter dropdown"),!0}return!1}catch(e){return console.error("Error injecting dropdown:",e),!1}},o=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:5;e>n?console.log("Max injection attempts reached, using default placement"):setTimeout((()=>{t()||(console.log(`Attempt ${e} failed, trying again...`),o(e+1,n))}),300*e)};o(),this.eGui.appendChild(this.eSelect)}getGui(){return this.eGui}onParentModelChanged(e){}destroy(){this.eSelect&&this.eSelect.removeEventListener("change")}}const SD=e=>{const[o,n]=(0,t.useState)(!1),[r,i]=(0,t.useState)(e.value||"Introduction");(0,t.useEffect)((()=>{i(e.value||"Introduction")}),[e.value]);const a=[{value:"Cold Contacting",label:"\u2744\ufe0f",emoji:"\u2744\ufe0f"},{value:"Introduction",label:"\ud83d\udd25",emoji:"\ud83d\udd25"}],s=e=>"Cold Contacting"===e?"#00ff00":"#aaaaaa";return(0,N.jsx)("div",{style:{whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis",paddingRight:"0",width:"100%",color:s(r),cursor:"pointer",height:"100%",display:"flex",alignItems:"center"},onClick:e=>{e.stopPropagation(),n(!0)},"data-source":r,children:o?(0,N.jsx)("select",{value:r,onChange:async t=>{t.stopPropagation();const o=t.target.value;i(o);try{const{error:t}=await D.supabase.from("deals").update({source_category:o}).eq("deal_id",e.data.deal_id);if(t)throw t;e.api&&(e.api.refreshCells({force:!0,rowNodes:[e.node],columns:["source_category"]}),e.context&&e.context.refreshData&&setTimeout((()=>{e.context.refreshData()}),100)),Pm.oR.success(`Source updated for deal "${e.data.opportunity}"`)}catch(r){console.error("Error updating source:",r),Pm.oR.error(`Error updating source: ${r.message}`),i(e.value||"Introduction")}n(!1)},onBlur:()=>{n(!1)},onClick:e=>{e.stopPropagation()},autoFocus:!0,style:{backgroundColor:"#222",color:s(r),border:`1px solid ${s(r)}`,borderRadius:"4px",padding:"2px",fontSize:"14px",width:"100%",cursor:"pointer"},children:a.map((e=>(0,N.jsx)("option",{value:e.value,children:e.label},e.value)))}):(0,N.jsx)("span",{children:(e=>{const t=a.find((t=>t.value===e));return t?t.emoji:e})(r)})})},ED=e=>{var t;const{data:o}=e;return(0,N.jsxs)("div",{style:{display:"flex",justifyContent:"center",alignItems:"center",gap:"5px",height:"100%"},children:[(0,N.jsxs)("button",{onClick:t=>{t.stopPropagation();const n=o.attachments;n&&0!==n.length?e.context&&e.context.setSelectedAttachments&&(e.context.setSelectedAttachments(n),e.context.setDealName(o.opportunity),e.context.setCurrentDealId(o.deal_id),e.context.setShowAttachmentsModal(!0)):(0,Pm.oR)(`No attachments for deal: ${o.opportunity}`,{style:{borderLeft:"5px solid #00ff00",color:"#ffffff",textShadow:"0 0 5px rgba(255, 255, 255, 0.5)"},progressClassName:"green-progress",className:"green-toast",icon:()=>(0,N.jsx)("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"#00ff00",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:(0,N.jsx)("path",{d:"M21.44 11.05l-9.19 9.19a6 6 0 01-8.49-8.49l9.19-9.19a4 4 0 015.66 5.66l-9.2 9.19a2 2 0 01-2.83-2.83l8.49-8.48"})})})},title:`Attachments (${(null===(t=o.attachments)||void 0===t?void 0:t.length)||0})`,style:{background:"transparent",border:"none",padding:"2px",cursor:"pointer",display:"flex",alignItems:"center",justifyContent:"center",borderRadius:"50%",transition:"background-color 0.2s",position:"relative"},onMouseOver:e=>e.currentTarget.style.backgroundColor="rgba(0, 255, 0, 0.1)",onMouseOut:e=>e.currentTarget.style.backgroundColor="transparent",children:[(0,N.jsx)("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"#00ff00",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:(0,N.jsx)("path",{d:"M21.44 11.05l-9.19 9.19a6 6 0 01-8.49-8.49l9.19-9.19a4 4 0 015.66 5.66l-9.2 9.19a2 2 0 01-2.83-2.83l8.49-8.48"})}),o.attachments&&o.attachments.length>0&&(0,N.jsx)("span",{style:{position:"absolute",top:-1,right:-3,backgroundColor:"#00ff00",color:"#000",borderRadius:"50%",width:"12px",height:"12px",fontSize:"8px",display:"flex",alignItems:"center",justifyContent:"center",fontWeight:"bold",lineHeight:"1",border:"1px solid #000"},children:o.attachments.length})]}),(0,N.jsx)("button",{onClick:t=>{t.stopPropagation(),e.context&&e.context.setDealToEdit&&e.context.setShowEditDealModal?(e.context.setDealToEdit(o),e.context.setShowEditDealModal(!0)):Pm.oR.info(`Editing deal: ${o.opportunity}`,{icon:(0,N.jsx)(B.SG1,{style:{color:"#00ff00"}})})},title:"Edit",style:{background:"transparent",border:"none",padding:"2px",cursor:"pointer",display:"flex",alignItems:"center",justifyContent:"center",borderRadius:"50%",transition:"background-color 0.2s"},onMouseOver:e=>e.currentTarget.style.backgroundColor="rgba(0, 255, 0, 0.1)",onMouseOut:e=>e.currentTarget.style.backgroundColor="transparent",children:(0,N.jsx)(B.SG1,{size:14,style:{color:"#00ff00"}})}),(0,N.jsx)("button",{onClick:t=>{t.stopPropagation();if(window.confirm(`Are you sure you want to permanently delete deal "${o.opportunity}"? This action cannot be undone and will remove all associated data.`)){(async()=>{try{console.log("\ud83d\uddd1\ufe0f Starting cascading delete for deal:",o.deal_id),console.log("\ud83d\udd17 Deleting deal attachments...");const{error:t}=await D.supabase.from("deal_attachments").delete().eq("deal_id",o.deal_id);t?console.error("Error deleting deal attachments:",t):console.log("\u2705 Deal attachments deleted"),console.log("\ud83c\udff7\ufe0f Deleting deal tags...");const{error:n}=await D.supabase.from("deal_tags").delete().eq("deal_id",o.deal_id);n?console.error("Error deleting deal tags:",n):console.log("\u2705 Deal tags deleted"),console.log("\ud83d\udc65 Deleting deal contacts...");const{error:r}=await D.supabase.from("deals_contacts").delete().eq("deal_id",o.deal_id);r?console.error("Error deleting deal contacts:",r):console.log("\u2705 Deal contacts deleted"),console.log("\ud83c\udfaf Deleting deal...");const{error:i}=await D.supabase.from("deals").delete().eq("deal_id",o.deal_id);i?(console.error("Error deleting deal:",i),Pm.oR.error(`Error deleting deal: ${i.message}`)):(console.log("\u2705 Deal deleted successfully"),Pm.oR.success(`Deal "${o.opportunity}" permanently deleted`,{icon:(0,N.jsx)(B.IXo,{style:{color:"#00ff00"}})}),e.context&&e.context.setSelectedDeal&&e.context.setSelectedDeal(null),e.context&&e.context.refreshData&&e.context.refreshData())}catch(t){console.error("Error in cascading delete:",t),Pm.oR.error(`Error deleting deal: ${t.message}`)}})()}},title:"Delete",style:{background:"transparent",border:"none",padding:"2px",cursor:"pointer",display:"flex",alignItems:"center",justifyContent:"center",borderRadius:"50%",transition:"background-color 0.2s"},onMouseOver:e=>e.currentTarget.style.backgroundColor="rgba(0, 255, 0, 0.1)",onMouseOut:e=>e.currentTarget.style.backgroundColor="transparent",children:(0,N.jsx)(B.IXo,{size:14,style:{color:"#00ff00"}})})]})},kD=e=>{var o;const[n,r]=t.useState(0),[i,a]=t.useState(!1),s=e.value||[],l=null===(o=e.data)||void 0===o?void 0:o.deal_id,c=s.length>1,d=e=>{null===e||void 0===e||e.stopPropagation(),a(!0)},u=t=>{a(!1),e.context&&e.context.refreshData&&setTimeout((()=>{e.context.refreshData()}),100)},p=e=>{e.stopPropagation()};if(!s.length)return(0,N.jsxs)("div",{style:{display:"flex",alignItems:"center",height:"100%"},onClick:p,children:[(0,N.jsx)("div",{onClick:d,style:{color:"#ffffff",fontSize:"11px",cursor:"pointer",display:"flex",alignItems:"center",gap:"4px"},title:"Associate Contact",children:"Add contacts"}),i&&(0,N.jsx)(XT,{isOpen:i,onRequestClose:()=>a(!1),dealId:l,onContactAssociated:u})]});const h=s[n],f=[h.first_name||"",h.last_name||""].filter(Boolean).join(" ")||"Unnamed";return(0,N.jsxs)("div",{style:{display:"flex",alignItems:"center",height:"36px",minHeight:"36px",width:"100%",position:"relative"},onClick:p,children:[(0,N.jsxs)("div",{style:{display:"flex",alignItems:"center",justifyContent:"space-between",width:"100%",gap:"4px"},children:[(0,N.jsxs)("div",{style:{display:"flex",alignItems:"center",backgroundColor:"#1a1a1a",color:"#ffffff",padding:"0px 6px",borderRadius:"4px",fontSize:"11px",border:"1px solid #ffffff",boxShadow:"0 0 4px rgba(255, 255, 255, 0.2)",whiteSpace:"nowrap",overflow:"hidden",lineHeight:"16px",width:"100%",maxWidth:c?"170px":"190px",height:"18px",position:"relative"},children:[(0,N.jsx)("span",{style:{cursor:"pointer",maxWidth:c?"120px":"160px",overflow:"hidden",textOverflow:"ellipsis",display:"inline-block"},onClick:t=>{t.stopPropagation(),e.context&&e.context.showDealContacts&&e.context.showDealContacts(e.data)},title:`${f}${h.job_role?` - ${h.job_role}`:""}`,children:f}),c&&(0,N.jsxs)("div",{style:{fontSize:"9px",color:"#cccccc",marginLeft:"4px",padding:"0 2px",borderRadius:"3px",backgroundColor:"#333333"},children:[n+1,"/",s.length]}),(0,N.jsx)("button",{onClick:t=>(async(t,o)=>{if(null===o||void 0===o||o.stopPropagation(),l&&t)try{const{error:o}=await D.supabase.from("deals_contacts").delete().eq("deal_id",l).eq("contact_id",t);if(o)throw o;Pm.oR.success("Contact association removed"),e.api&&e.api.refreshCells({force:!0}),setTimeout((()=>{e.context&&e.context.refreshData&&e.context.refreshData()}),100)}catch(n){console.error("Error removing contact association:",n),Pm.oR.error("Failed to remove contact association")}})(h.contact_id,t),style:{background:"none",border:"none",color:"#ffffff",cursor:"pointer",padding:"0",marginLeft:"4px",fontSize:"10px",display:"flex",alignItems:"center",justifyContent:"center"},title:"Remove Contact Association",children:"\u2715"})]}),c&&(0,N.jsx)("button",{onClick:e=>{null===e||void 0===e||e.stopPropagation(),r((e=>(e+1)%s.length))},style:{background:"none",border:"none",color:"#ffffff",cursor:"pointer",padding:"0",display:"flex",alignItems:"center",justifyContent:"center",width:"14px",height:"14px",fontSize:"10px",opacity:"0.8",marginLeft:"2px"},title:"Next contact",children:"\u25b6"}),(0,N.jsx)("button",{onClick:d,style:{background:"none",border:"none",color:"#ffffff",borderRadius:"4px",width:"20px",height:"20px",padding:"0",display:"flex",alignItems:"center",justifyContent:"center",cursor:"pointer",fontSize:"14px"},title:"Associate Contact",children:(0,N.jsx)(B.GGD,{size:14})})]}),i&&(0,N.jsx)(XT,{isOpen:i,onRequestClose:()=>a(!1),dealId:l,onContactAssociated:u})]})},jD=()=>{const[e,o]=(0,t.useState)([]),[n,r]=(0,t.useState)([]),[a,s]=(0,t.useState)(!0),[l,c]=(0,t.useState)(null),[d,u]=(0,t.useState)(null),[p,h]=(0,t.useState)(!1),[f,g]=(0,t.useState)(!1),[m,y]=(0,t.useState)(!1),[v,b]=(0,t.useState)([]),[x,w]=(0,t.useState)(""),[C,_]=(0,t.useState)("inbox"),[S,E]=(0,t.useState)(null),[k,j]=(0,t.useState)(!1),[A,R]=(0,t.useState)(!1),[O,T]=(0,t.useState)(null),[P,I]=(0,t.useState)([]),[M,L]=(0,t.useState)(""),[F,G]=(0,t.useState)(!1),[z,H]=(0,t.useState)(!1),[V,$]=(0,t.useState)(null),[U,W]=(0,t.useState)(""),[q,K]=(0,t.useState)("");(0,i.Zp)();(0,t.useEffect)((()=>{console.log("showTagsModal changed to:",A)}),[A]),(0,t.useEffect)((()=>{console.log("selectedDeal changed to:",O)}),[O]);const Y=wD,J=(0,t.useMemo)((()=>[{headerName:"Deals",field:"opportunity",minWidth:200,filter:"agTextColumnFilter",sortable:!0,pinned:"left",editable:!0,cellStyle:e=>{const t=e.value?e.value.length:0;let o;return o=t>30?"9px":t>23?"11px":"14px",{cursor:"pointer",backgroundColor:"#121212",textDecoration:"none",color:"#ffffff",fontSize:o}}},{headerName:"Contacts",field:"contacts",minWidth:220,sortable:!0,filter:!0,cellRenderer:kD},{headerName:"Tags",field:"tags",cellRenderer:CD,minWidth:140,width:150,sortable:!0,filter:!1,resizable:!0},{headerName:"Source",field:"source_category",cellRenderer:SD,minWidth:80,width:80,sortable:!0,filter:!1,editable:!1},{headerName:"Investment Amount",field:"total_investment",cellRenderer:xD,minWidth:150,filter:"agNumberColumnFilter",sortable:!0,editable:!0,cellEditor:"agNumberCellEditor"},{headerName:"Created",field:"created_at",valueFormatter:e=>{if(!e.value)return"-";const t=new Date(e.value);return`${(t.getMonth()+1).toString().padStart(2,"0")}/${t.getFullYear().toString().slice(-2)}`},minWidth:70,width:70,filter:"agDateColumnFilter",sortable:!0},{headerName:"Actions",field:"actions",cellRenderer:ED,width:120,sortable:!1,filter:!1,suppressSizeToFit:!0,cellClass:"centered-cell",headerClass:"centered-header"}]),[]),X=(0,t.useMemo)((()=>({resizable:!0,filterParams:{buttons:["apply","reset"],closeOnApply:!0}})),[]),Q=(0,t.useCallback)((e=>{o((t=>t.filter((t=>t.deal_id!==e))))}),[]),Z=(0,t.useCallback)((()=>{console.log("Refreshing deals data..."),ue()}),[]),ee=((0,t.useCallback)((async(t,n)=>{if(console.log("Tag operation called with:",{operation:t,tagId:n,selectedDeal:O}),!O||!O.deal_id)return console.error("Tag operation attempted but no deal was selected",{operation:t,tagId:n,selectedDeal:O}),void Pm.oR.error("No deal selected for tag operation. Please try clicking the tag button again.");const i={...O};console.log("Proceeding with tag operation for deal:",i.deal_id,i.opportunity);try{if("add"===t){var a;const{data:e,error:t}=await D.supabase.from("deal_tags").select("*").eq("deal_id",i.deal_id).eq("tag_id",n).maybeSingle();if(t)throw t;if(e)return void Pm.oR.info("This tag is already associated with the deal");const{error:r}=await D.supabase.from("deal_tags").insert({deal_id:i.deal_id,tag_id:n});if(r)throw r;const s=(null===(a=P.find((e=>e.tag_id===n)))||void 0===a?void 0:a.name)||"Unknown tag";Pm.oR.success(`Added tag "${s}" to deal`);const l=P.find((e=>e.tag_id===n));l&&(T((e=>({...e,tags:[...e.tags||[],l]}))),o((e=>e.map((e=>e.deal_id===i.deal_id?{...e,tags:[...e.tags||[],l]}:e)))))}else if("remove"===t){var s,l;const{error:e}=await D.supabase.from("deal_tags").delete().eq("deal_id",i.deal_id).eq("tag_id",n);if(e)throw e;const t=(null===(s=O.tags)||void 0===s||null===(l=s.find((e=>e.tag_id===n)))||void 0===l?void 0:l.name)||"Unknown tag";Pm.oR.success(`Removed tag "${t}" from deal`),T((e=>{var t;return{...e,tags:(null===(t=e.tags)||void 0===t?void 0:t.filter((e=>e.tag_id!==n)))||[]}})),o((e=>e.map((e=>{var t;return e.deal_id===i.deal_id?{...e,tags:(null===(t=e.tags)||void 0===t?void 0:t.filter((e=>e.tag_id!==n)))||[]}:e}))))}r((t=>t.map((t=>t.deal_id===i.deal_id&&e.find((e=>e.deal_id===i.deal_id))||t))));try{const{data:e,error:t}=await D.supabase.from("deal_tags").select("tag_id").eq("deal_id",i.deal_id);if(t)return void console.error("Error refreshing tag refs:",t);if(e&&e.length>0){const t=e.map((e=>e.tag_id)),{data:n,error:a}=await D.supabase.from("tags").select("tag_id, name").in("tag_id",t);if(a)return void console.error("Error refreshing tag details:",a);T((e=>({...e,tags:n||[]}))),o((e=>e.map((e=>e.deal_id===i.deal_id?{...e,tags:n||[]}:e)))),r((e=>e.map((e=>e.deal_id===i.deal_id?{...e,tags:n||[]}:e))))}else{T((e=>({...e,tags:[]})));const e=e=>e.deal_id===i.deal_id?{...e,tags:[]}:e;o((t=>t.map(e))),r((t=>t.map(e)))}}catch(c){console.error("Error refreshing tag data:",c)}}catch(c){console.error(`Error in tag operation (${t}):`,c),Pm.oR.error(`Error ${"add"===t?"adding":"removing"} tag: ${c.message}`)}}),[O,P,e]),(0,t.useCallback)((async e=>{if(e&&""!==e.trim())try{const{data:t,error:o}=await D.supabase.from("tags").select("*").ilike("name",e.trim());if(o)throw o;if(t&&t.length>0)return Pm.oR.info(`Tag "${e}" already exists`),t[0].tag_id;const{data:n,error:r}=await D.supabase.from("tags").insert({name:e.trim()}).select();if(r)throw r;if(!n||0===n.length)throw new Error("Failed to create tag: No data returned");const i=n[0];return Pm.oR.success(`Created new tag "${i.name}"`),I((e=>[...e,i])),i.tag_id}catch(t){return console.error("Error creating tag:",t),Pm.oR.error(`Error creating tag: ${t.message}`),null}else Pm.oR.error("Tag name cannot be empty")}),[]),(0,t.useCallback)((async e=>{if(e&&S)try{j(!0);const t=e.name.split(".").pop(),o=`deal-attachments/${`${Math.random().toString(36).substring(2,15)}_${Date.now()}.${t}`}`,{data:n,error:r}=await D.supabase.storage.from("attachments").upload(o,e,{cacheControl:"3600",upsert:!1});if(r)throw r;const{data:i}=await D.supabase.storage.from("attachments").getPublicUrl(o),a=i.publicUrl,{data:s,error:l}=await D.supabase.from("attachments").insert([{file_name:e.name,file_url:a,file_type:e.type,file_size:e.size,processing_status:"completed",created_by:"User"}]).select();if(l)throw l;const c=s[0].attachment_id,{error:d}=await D.supabase.from("deal_attachments").insert([{deal_id:S,attachment_id:c,created_by:"User"}]);if(d)throw d;b((e=>[...e,s[0]])),Pm.oR.success(`File "${e.name}" uploaded successfully!`,{style:{borderLeft:"5px solid #00ff00",background:"rgba(18, 18, 18, 0.95)",color:"#ffffff",boxShadow:"0 0 10px rgba(0, 255, 0, 0.3)"},progressClassName:"green-progress",className:"green-toast",icon:()=>(0,N.jsxs)("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"#00ff00",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[(0,N.jsx)("path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"}),(0,N.jsx)("polyline",{points:"17 8 12 3 7 8"}),(0,N.jsx)("line",{x1:"12",y1:"3",x2:"12",y2:"15"})]})})}catch(l){console.error("Error uploading file:",l),Pm.oR.error(`Error uploading file: ${l.message}`)}finally{j(!1)}}),[S])),te=(0,t.useCallback)((e=>{console.log("Showing contacts for deal:",e),Pm.oR.info(`Showing contacts for deal: ${e.opportunity}`,{style:{borderLeft:"5px solid #00ff00",color:"#ffffff"}})}),[]),oe=(0,t.useMemo)((()=>({setSelectedAttachments:b,setDealName:w,setCurrentDealId:E,setShowAttachmentsModal:y,setShowTagsModal:R,setSelectedDeal:T,showDealContacts:te,categoryColors:Y,removeDeal:Q,stageFilter:U,selectedDeal:O,setStageFilter:W,setDealToEdit:$,setShowEditDealModal:H,refreshData:Z})),[Y,Q,U,te,O]),[ne,re]=(0,t.useState)(!1),[ie,ae]=(0,t.useState)({top:0,left:0,width:150,height:30}),se=(0,t.useCallback)((()=>{re(!1)}),[]),le=t.useCallback((e=>{console.log("Grid is ready"),u(e.api),setTimeout((()=>{e.api.sizeColumnsToFit(),console.log("Grid API object:",e.api),e.api.refreshHeader(),se()}),300)}),[se]),ce=t.useCallback((e=>{var t,o,n;console.log("Deal clicked:",e.data),console.log("showTagsModal state:",A);const r=null===(t=e.event)||void 0===t?void 0:t.target,i=r&&(r.closest('[title*="tag"]')||r.closest('[title*="Add"]')||r.closest('[title*="Remove"]')||(null===(o=r.textContent)||void 0===o?void 0:o.includes("Add tags"))||(null===(n=r.textContent)||void 0===n?void 0:n.includes("+"))),a=r&&(r.closest('[title="Edit"]')||r.closest('[title="Delete"]')||r.closest('[title*="Attachments"]')||r.closest("button"));A||i||a?console.log("Skipping selectedDeal update - tags modal open, tag-related click, or action button click"):(console.log("Setting selectedDeal from row click"),T({contact_id:null,deal:e.data,companies:[]}))}),[A]),de=t.useCallback((async e=>{const{data:t,colDef:o,newValue:n,oldValue:r}=e;if(n!==r)if(console.log(`Editing ${o.field} from "${r}" to "${n}"`),"tags"!==o.field)if("contacts"!==o.field)if("actions"!==o.field)try{const e={[o.field]:n},{error:r}=await D.supabase.from("deals").update(e).eq("deal_id",t.deal_id);if(r)console.error("Error updating deal:",r),Pm.oR.error(`Error updating deal: ${r.message}`);else if(console.log(`Successfully updated ${o.field} for deal ${t.deal_id}`),"category"===o.field)Pm.oR.success(`Deal category updated to "${n}"`,{icon:"\ud83c\udff7\ufe0f"});else if("stage"===o.field)Pm.oR.success(`Deal stage updated to "${n}"`,{icon:"\ud83d\udccb"});else if("source_category"===o.field)Pm.oR.success(`Deal source updated to "${n}"`,{icon:"\ud83d\udcca"});else if("total_investment"===o.field){const e=new Intl.NumberFormat("en-US",{style:"currency",currency:"USD",minimumFractionDigits:0,maximumFractionDigits:0}).format(n);Pm.oR.success(`Investment amount updated to ${e}`,{icon:"\ud83d\udcb0"})}else"opportunity"===o.field&&Pm.oR.success(`Deal name updated to "${n}"`,{icon:"\u270f\ufe0f"})}catch(i){console.error("Error in update operation:",i),Pm.oR.error(`Error updating deal: ${i.message}`)}else console.log("Skipping database update for actions field - not a data field");else console.log("Skipping database update for contacts field - handled separately");else console.log("Skipping database update for tags field - handled separately")}),[]),ue=async()=>{try{s(!0),c(null);const e=async function(e){let t,o=arguments.length>1&&void 0!==arguments[1]?arguments[1]:3,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1e3;for(let i=0;i<o;i++)try{return await e()}catch(r){console.log(`Attempt ${i+1} failed, retrying in ${n}ms...`,r),t=r,await new Promise((e=>setTimeout(e,n))),n*=1.5}throw t};s("Accessing Deals data...");const{data:t,error:n}=await e((async()=>D.supabase.from("deals").select("*").order("created_at",{ascending:!1})));if(n)throw n;console.log(`Fetched ${t.length} deals`);const i=await Promise.all(t.map((async e=>{try{const{data:t,error:o}=await D.supabase.from("deal_attachments").select("attachment_id").eq("deal_id",e.deal_id);if(o)return console.error(`Error fetching attachment refs for deal ${e.deal_id}:`,o),{...e,attachments:[],tags:[],contacts:[]};let n=[];if(t&&t.length>0){const o=t.map((e=>e.attachment_id)),{data:r,error:i}=await D.supabase.from("attachments").select("attachment_id, file_name, file_url, file_type, file_size, permanent_url").in("attachment_id",o);i?console.error(`Error fetching attachment details for deal ${e.deal_id}:`,i):n=r||[]}const{data:r,error:i}=await D.supabase.from("deal_tags").select("tag_id").eq("deal_id",e.deal_id);if(i)return console.error(`Error fetching tag refs for deal ${e.deal_id}:`,i),{...e,attachments:n,tags:[],contacts:[]};let a=[];if(r&&r.length>0){const t=r.map((e=>e.tag_id)),{data:o,error:n}=await D.supabase.from("tags").select("tag_id, name").in("tag_id",t);n?console.error(`Error fetching tag details for deal ${e.deal_id}:`,n):a=o||[]}const{data:s,error:l}=await D.supabase.from("deals_contacts").select("contact_id, relationship").eq("deal_id",e.deal_id);if(l)return console.error(`Error fetching contact refs for deal ${e.deal_id}:`,l),{...e,attachments:n,tags:a,contacts:[]};let c=[];if(s&&s.length>0){const t=s.map((e=>e.contact_id)),{data:o,error:n}=await D.supabase.from("contacts").select("contact_id, first_name, last_name, job_role, profile_image_url, last_interaction_at").in("contact_id",t);n?console.error(`Error fetching contact details for deal ${e.deal_id}:`,n):c=(o||[]).map((e=>{const t=s.find((t=>t.contact_id===e.contact_id));return{...e,relationship:(null===t||void 0===t?void 0:t.relationship)||"Unknown"}}))}return{...e,attachments:n,tags:a,contacts:c}}catch(t){return console.error(`Error processing data for deal ${e.deal_id}:`,t),{...e,attachments:[],tags:[],contacts:[]}}})));o(i),r(i),s(!1),h(!0),setTimeout((()=>{g(!0)}),800)}catch(e){console.error("Error fetching deals data:",e),c(e.message),s(!1)}};(0,t.useEffect)((()=>{p||(console.log("Initiating deals data fetch"),ue(),(async()=>{try{const{data:e,error:t}=await D.supabase.from("tags").select("*").order("name");if(t)return void console.error("Error fetching tags:",t);I(e||[])}catch(e){console.error("Error fetching tags:",e)}})())}),[p]),(0,t.useEffect)((()=>{}),[ne,se]),(0,t.useEffect)((()=>{if(console.log("Filtering deals. Active tab:",C),console.log("Stage filter:",U),console.log("Search term:",q),console.log("Total deals:",e.length),e.length>0){const t={inbox:"Inbox",startup:"Startup",fund:"Fund",real_estate:"Real Estate",private_equity:"Private Equity",private_debt:"Private Debt",other:"Other"}[C];let o=e;t&&(console.log(`Filtering for category: ${t}`),o=o.filter((e=>(e.category||"").toLowerCase()===t.toLowerCase()))),U&&(o=o.filter((e=>e.stage===U))),q&&(o=o.filter((e=>(e.opportunity||"").toLowerCase().includes(q.toLowerCase())))),console.log(`Found ${o.length} deals after filtering`),r(o)}}),[C,e,U,q]),(0,t.useEffect)((()=>{if(!d)return;const e=()=>{d.sizeColumnsToFit(),setTimeout(se,100)};window.addEventListener("resize",e,{passive:!0});const t=setTimeout((()=>{se()}),500);return()=>{window.removeEventListener("resize",e,{passive:!0}),clearTimeout(t)}}),[d,se]);const pe=[{id:"inbox",name:"Inbox",icon:(0,N.jsx)(B._Y7,{})},{id:"startup",name:"Startup",icon:(0,N.jsx)(B.Ojn,{})},{id:"fund",name:"Fund",icon:(0,N.jsx)(B.z8N,{})},{id:"real_estate",name:"Real Estate",icon:(0,N.jsx)(B.V5Y,{})},{id:"private_equity",name:"Private Equity",icon:(0,N.jsx)(B.qYx,{})},{id:"private_debt",name:"Private Debt",icon:(0,N.jsx)(B.qYx,{})},{id:"other",name:"Other",icon:(0,N.jsx)(B.est,{})}];return(0,t.useEffect)((()=>{console.log("showTagsModal changed to:",A)}),[A]),(0,N.jsxs)(QT,{children:[(0,N.jsx)("style",{children:'\n  .green-toast {\n    border-color: #00ff00 !important;\n    box-shadow: 0 0 10px rgba(0, 255, 0, 0.7) !important;\n  }\n  .green-progress {\n    background-color: #00ff00 !important;\n    box-shadow: 0 0 8px #00ff00 !important;\n  }\n  .Toastify__progress-bar {\n    background-color: #00ff00 !important;\n    box-shadow: 0 0 8px #00ff00, 0 0 16px #00ff00 !important;\n    height: 4px !important;\n    opacity: 0.9 !important;\n  }\n  .Toastify__toast {\n    background-color: rgba(18, 18, 18, 0.95) !important;\n    border: 1px solid #00ff00 !important;\n  }\n  .Toastify__close-button {\n    color: #00ff00 !important;\n  }\n  \n  /* Custom styles for stage filter dropdown */\n  .stage-filter-dropdown {\n    background-color: #1a1a1a !important;\n    color: #00ff00 !important;\n    border: 2px solid #00ff00 !important;\n    border-radius: 4px !important;\n    padding: 5px !important;\n    width: 95% !important;\n    font-family: \'Courier New\', monospace !important;\n    font-size: 0.85rem !important;\n    cursor: pointer !important;\n    text-shadow: 0 0 5px rgba(0, 255, 0, 0.5) !important;\n    box-shadow: 0 0 8px rgba(0, 255, 0, 0.5) !important;\n    outline: none !important;\n    position: absolute !important;\n    top: 50% !important;\n    left: 50% !important;\n    transform: translate(-50%, -50%) !important;\n    z-index: 100 !important;\n  }\n  \n  .stage-filter-dropdown option {\n    background-color: #1a1a1a !important;\n    color: #00ff00 !important;\n    font-family: \'Courier New\', monospace !important;\n  }\n  \n  /* Target the specific filter cell */\n  .ag-header-cell.ag-floating-filter[aria-colindex="5"] {\n    position: relative !important;\n    background-color: rgba(0, 255, 0, 0.05) !important;\n  }\n\n  .centered-header .ag-header-cell-label {\n    justify-content: center;\n  }\n  \n  .centered-cell {\n    text-align: center;\n  }\n  \n  /* Ensure cells are vertically centered */\n  .ag-cell {\n    display: flex;\n    align-items: center;\n    justify-content: center;\n  }\n  \n  /* Specific styling for Actions column */\n  .ag-header-cell[col-id="actions"] .ag-header-cell-label,\n  .ag-cell[col-id="actions"] {\n    display: flex;\n    align-items: center;\n    justify-content: center;\n  }\n'}),(0,N.jsx)(Pm.N9,{position:"top-right",autoClose:3e3,hideProgressBar:!1,newestOnTop:!0,closeOnClick:!0,rtl:!1,pauseOnFocusLoss:!0,draggable:!0,pauseOnHover:!0,theme:"dark"}),(0,N.jsx)(ZT,{children:pe.map((e=>(0,N.jsxs)(eD,{$active:e.id===C,onClick:()=>_(e.id),children:[e.icon," ",e.name]},e.id)))}),(0,N.jsxs)(mD,{children:[(0,N.jsxs)(vD,{children:[(0,N.jsx)(bD,{children:(0,N.jsx)(B.CKj,{})}),(0,N.jsx)(yD,{type:"text",placeholder:"SEARCH...",value:q,onChange:e=>K(e.target.value)})]}),q&&(0,N.jsx)("button",{onClick:()=>K(""),style:{background:"transparent",border:"none",color:"#00ff00",cursor:"pointer",fontSize:"16px",padding:"4px"},title:"Clear search",children:"\u2715"})]}),(0,N.jsxs)("div",{style:{display:"flex",alignItems:"center",justifyContent:"space-between",margin:"0 20px"},children:[(0,N.jsx)("div",{style:{display:"flex",alignItems:"center",margin:"20px 0"},children:["Lead","Evaluating","Closing","Invested","Monitoring","Passed","Lost"].map(((e,t,o)=>{const n="Passed"===e||"Lost"===e,r="Invested"===e,i="Monitoring"===e,a=n?"#ff5555":"#00ff00",s=n?"rgba(255, 0, 0,":"rgba(0, 255, 0,",l=t<o.length-1&&!r&&!i&&!n&&!["Monitoring","Invested","Passed","Lost"].includes(o[t+1]),c="Closing"===e&&"Invested"===o[t+1]||"Monitoring"===e&&"Passed"===o[t+1],d="Invested"===e&&"Monitoring"===o[t+1]||"Passed"===e&&"Lost"===o[t+1];return r?(0,N.jsxs)(N.Fragment,{children:[(0,N.jsxs)("button",{onClick:()=>W(U===e?"":e),style:{display:"flex",alignItems:"center",gap:"8px",backgroundColor:U===e?"#00ff00":"rgba(0, 255, 0, 0.2)",color:U===e?"#000000":"#00ff00",border:"1px solid #00ff00",borderRadius:"4px",padding:"8px 16px",fontSize:"0.9rem",fontWeight:"bold",cursor:"pointer",transition:"all 0.2s ease",fontFamily:"Courier New, monospace",boxShadow:"0 0 8px rgba(0, 255, 0, 0.3)"},onMouseOver:t=>{U!==e&&(t.currentTarget.style.backgroundColor="rgba(0, 255, 0, 0.3)",t.currentTarget.style.boxShadow="0 0 12px rgba(0, 255, 0, 0.5)")},onMouseOut:t=>{U!==e&&(t.currentTarget.style.backgroundColor="rgba(0, 255, 0, 0.2)",t.currentTarget.style.boxShadow="0 0 8px rgba(0, 255, 0, 0.3)")},children:[(0,N.jsx)("span",{role:"img","aria-label":"Thumbs Up",style:{fontSize:"14px"},children:"\ud83d\udc4d"}),e]},e),c&&t<o.length-1&&(0,N.jsx)("div",{style:{width:"40px"}}),d&&t<o.length-1&&(0,N.jsx)("div",{style:{width:"10px"}})]}):i?(0,N.jsxs)(N.Fragment,{children:[(0,N.jsxs)("button",{onClick:()=>W(U===e?"":e),style:{display:"flex",alignItems:"center",gap:"8px",backgroundColor:U===e?"#00ff00":"rgba(0, 255, 0, 0.2)",color:U===e?"#000000":"#00ff00",border:"1px solid #00ff00",borderRadius:"4px",padding:"8px 16px",fontSize:"0.9rem",fontWeight:"bold",cursor:"pointer",transition:"all 0.2s ease",fontFamily:"Courier New, monospace",boxShadow:"0 0 8px rgba(0, 255, 0, 0.3)"},onMouseOver:t=>{U!==e&&(t.currentTarget.style.backgroundColor="rgba(0, 255, 0, 0.3)",t.currentTarget.style.boxShadow="0 0 12px rgba(0, 255, 0, 0.5)")},onMouseOut:t=>{U!==e&&(t.currentTarget.style.backgroundColor="rgba(0, 255, 0, 0.2)",t.currentTarget.style.boxShadow="0 0 8px rgba(0, 255, 0, 0.3)")},children:[(0,N.jsx)("span",{role:"img","aria-label":"Monitor",style:{fontSize:"14px"},children:"\ud83d\udcca"}),e]},e),c&&t<o.length-1&&(0,N.jsx)("div",{style:{width:"40px"}}),d&&t<o.length-1&&(0,N.jsx)("div",{style:{width:"10px"}})]}):(0,N.jsxs)(N.Fragment,{children:[(0,N.jsx)("button",{onClick:()=>W(U===e?"":e),style:{padding:"8px 12px",backgroundColor:U===e?`${s} 0.2)`:`${s} 0.05)`,color:a,border:`1px solid ${a}`,borderRadius:"4px",cursor:"pointer",fontFamily:"Courier New, monospace",fontSize:"0.9rem",transition:"all 0.2s ease",boxShadow:U===e?`0 0 10px ${s} 0.3)`:"none"},onMouseOver:t=>{U!==e&&(t.currentTarget.style.backgroundColor=`${s} 0.1)`,t.currentTarget.style.boxShadow=`0 0 5px ${s} 0.2)`)},onMouseOut:t=>{U!==e&&(t.currentTarget.style.backgroundColor=`${s} 0.05)`,t.currentTarget.style.boxShadow="none")},children:e},e),l&&(0,N.jsx)("div",{style:{margin:"0 5px",color:"#00ff00",fontSize:"14px"},children:">"}),c&&t<o.length-1&&(0,N.jsx)("div",{style:{width:"20px"}}),d&&t<o.length-1&&(0,N.jsx)("div",{style:{width:"10px"}})]})}))}),(0,N.jsxs)(gD,{onClick:()=>{T(null),G(!0)},children:[(0,N.jsx)(B.GGD,{})," ADD NEW DEAL"]})]}),l&&(0,N.jsxs)(tD,{children:["Error: ",l]}),!1!==a?(0,N.jsxs)(oD,{children:[(0,N.jsx)(rD,{children:"string"===typeof a?a.replace(/Loading .+ \d+\/\d+/,"Initializing Matrix"):"Accessing Deal Pipeline..."}),(0,N.jsx)(nD,{}),(0,N.jsx)(iD,{})]}):f||l?0!==e.length||l?(0,N.jsx)("div",{className:"ag-theme-alpine",style:{height:"calc(100% - 100px)",width:"100%",margin:"0 20px",opacity:f?1:0,transition:"opacity 0.5s ease-in-out","--ag-background-color":"#121212","--ag-odd-row-background-color":"#1a1a1a","--ag-header-background-color":"#222222","--ag-header-foreground-color":"#00ff00","--ag-foreground-color":"#e0e0e0","--ag-row-hover-color":"#2a2a2a","--ag-border-color":"#333333"},children:(0,N.jsx)($w.W,{rowData:n,columnDefs:J,defaultColDef:X,onGridReady:le,onRowClicked:ce,onCellValueChanged:de,rowSelection:"single",animateRows:!0,pagination:!0,paginationPageSize:50,suppressCellFocus:!1,enableCellTextSelection:!0,context:oe,editType:"cell",stopEditingWhenCellsLoseFocus:!0,components:{stageFloatingFilter:_D,agFloatingFilterCellRenderer:_D}})}):(0,N.jsx)("div",{style:{padding:"40px",textAlign:"center",color:"#00ff00",background:"#121212",borderRadius:"8px"},children:"No deals found. Try refreshing the page or check database connection."}):(0,N.jsxs)(oD,{children:[(0,N.jsx)(rD,{children:"Preparing deal grid..."}),(0,N.jsx)(nD,{}),(0,N.jsx)(iD,{})]}),(0,N.jsx)(ot(),{isOpen:m,onRequestClose:()=>y(!1),style:aD,contentLabel:"Attachments",children:(0,N.jsxs)(sD,{children:[(0,N.jsxs)(lD,{children:[(0,N.jsxs)("h2",{children:["Attachments for ",x]}),(0,N.jsx)("button",{onClick:()=>y(!1),children:"\u2715"})]}),(0,N.jsxs)("div",{style:{display:"flex",justifyContent:"center",marginBottom:"20px",borderBottom:"1px solid #333",paddingBottom:"20px"},children:[(0,N.jsx)("input",{type:"file",id:"file-upload",style:{display:"none"},onChange:e=>{e.target.files&&e.target.files[0]&&ee(e.target.files[0])}}),(0,N.jsx)(fD,{style:{padding:"8px 16px",fontSize:"14px",display:"flex",alignItems:"center",gap:"6px",opacity:k?.7:1,cursor:k?"not-allowed":"pointer"},onClick:()=>!k&&document.getElementById("file-upload").click(),disabled:k,children:k?(0,N.jsxs)(N.Fragment,{children:[(0,N.jsx)("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"#00ff00",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",style:{animation:"spin 1s linear infinite"},children:(0,N.jsx)("circle",{cx:"12",cy:"12",r:"10",strokeWidth:"4",stroke:"#00ff00",strokeDasharray:"32",strokeDashoffset:"32",children:(0,N.jsx)("animateTransform",{attributeName:"transform",type:"rotate",from:"0 12 12",to:"360 12 12",dur:"1s",repeatCount:"indefinite"})})}),"Uploading..."]}):(0,N.jsxs)(N.Fragment,{children:[(0,N.jsxs)("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"#00ff00",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[(0,N.jsx)("path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"}),(0,N.jsx)("polyline",{points:"17 8 12 3 7 8"}),(0,N.jsx)("line",{x1:"12",y1:"3",x2:"12",y2:"15"})]}),"Upload New Attachment"]})})]}),(0,N.jsx)(cD,{children:v.length>0?v.map((e=>{var t,o,n,r,i,a,s;return(0,N.jsxs)(dD,{children:[(0,N.jsx)(uD,{children:null!==(t=e.file_type)&&void 0!==t&&t.includes("image")?"\ud83d\uddbc\ufe0f":null!==(o=e.file_type)&&void 0!==o&&o.includes("pdf")?"\ud83d\udcc4":null!==(n=e.file_type)&&void 0!==n&&n.includes("spreadsheet")||null!==(r=e.file_type)&&void 0!==r&&r.includes("excel")?"\ud83d\udcca":null!==(i=e.file_type)&&void 0!==i&&i.includes("word")||null!==(a=e.file_type)&&void 0!==a&&a.includes("document")?"\ud83d\udcdd":null!==(s=e.file_type)&&void 0!==s&&s.includes("presentation")?"\ud83d\udcca":"\ud83d\udcce"}),(0,N.jsxs)(pD,{children:[(0,N.jsx)("div",{className:"filename",children:e.file_name}),(0,N.jsxs)("div",{className:"fileinfo",children:[e.file_type," \u2022 ",(e.file_size/1024).toFixed(0)," KB"]})]}),(0,N.jsxs)("div",{style:{display:"flex",gap:"8px"},children:[(0,N.jsx)(hD,{href:e.permanent_url||e.file_url,target:"_blank",rel:"noopener noreferrer",children:"Open"}),(0,N.jsx)(fD,{onClick:()=>{document.getElementById("file-upload").click()},children:"Upload"})]})]},e.attachment_id)})):(0,N.jsx)("div",{style:{textAlign:"center",padding:"20px",color:"#aaa"},children:"No attachments available"})})]})}),(0,N.jsx)(AT,{isOpen:A&&null!==O,onRequestClose:()=>{console.log("Closing tags modal from DealTagsModal component"),R(!1)},deal:O?(()=>{let e;if(O.deal&&"object"===typeof O.deal)e=O.deal;else{if(!O.deal_id&&!O.id)return console.warn("selectedDeal has unexpected structure:",O),null;e=O}return{id:e.id||e.deal_id,deal_id:e.deal_id||e.id,opportunity:e.opportunity||"Unnamed Deal",tags:Array.isArray(e.tags)?e.tags:[]}})():null,onTagsUpdated:e=>{let t;console.log("Tags updated:",e),null!==O&&void 0!==O&&O.deal&&"object"===typeof O.deal?t=O.deal.deal_id||O.deal.id:(null!==O&&void 0!==O&&O.deal_id||null!==O&&void 0!==O&&O.id)&&(t=O.deal_id||O.id),t?(T((o=>o?(console.log("Updating selected deal tags:",t),o.deal&&"object"===typeof o.deal?{...o,deal:{...o.deal,tags:e||[]}}:{...o,tags:e||[]}):o)),t&&(o((o=>o.map((o=>o.deal_id===t?{...o,tags:e||[]}:o)))),r((o=>o.map((o=>o.deal_id===t?{...o,tags:e||[]}:o)))))):console.error("Cannot update tags: No deal ID found in selectedDeal",O)}}),(0,N.jsx)(vS.A,{isOpen:F,onClose:()=>G(!1),contactData:O,showOnlyCreateTab:!0,onSave:e=>{e&&e.deal_id&&(o((t=>[e,...t])),r((t=>[e,...t])),console.log("New deal added to SimpleDeals state:",e))}}),(0,N.jsx)(OT.A,{isOpen:z,onClose:()=>H(!1),dealData:V,onSave:e=>{e&&e.deal_id&&(o((t=>t.map((t=>t.deal_id===e.deal_id?e:t)))),r((t=>t.map((t=>t.deal_id===e.deal_id?e:t)))),Pm.oR.success(`Deal "${e.opportunity}" updated successfully`)),H(!1)}})]})},AD=P.Ay.div`
  padding: 24px;
`,RD=P.Ay.div`
  margin-bottom: 24px;
  
  h1 {
    font-size: 1.5rem;
    font-weight: 600;
    color: #111827;
    margin-bottom: 8px;
  }
  
  p {
    color: #6b7280;
    font-size: 0.875rem;
  }
`,OD=()=>(0,N.jsx)(fe,{children:(0,N.jsxs)(AD,{children:[(0,N.jsxs)(RD,{children:[(0,N.jsx)("h1",{children:"Startups"}),(0,N.jsx)("p",{children:"Track and manage startup companies in your network."})]}),(0,N.jsx)("p",{children:"This page will display startup companies."})]})}),TD=P.Ay.div`
  padding: 24px;
`,DD=P.Ay.div`
  margin-bottom: 24px;
  
  h1 {
    font-size: 1.5rem;
    font-weight: 600;
    color: #111827;
    margin-bottom: 8px;
  }
  
  p {
    color: #6b7280;
    font-size: 0.875rem;
  }
`,PD=()=>(0,N.jsx)(fe,{children:(0,N.jsxs)(TD,{children:[(0,N.jsxs)(DD,{children:[(0,N.jsx)("h1",{children:"Investors"}),(0,N.jsx)("p",{children:"Track and manage investor relationships."})]}),(0,N.jsx)("p",{children:"This page will display investor companies and individuals."})]})}),ND=P.Ay.div`
  padding: 16px;
  overflow: hidden;
  box-sizing: border-box;
  display: flex;
  flex-direction: column;
  width: 100%;
`,ID=P.Ay.div`
  display: flex;
  justify-content: space-between;
  align-items: center;
  margin-bottom: 16px;
  padding-bottom: 12px;
  border-bottom: 1px solid #e5e7eb;
  width: 100%;
  
  h2 {
    margin: 0;
    font-size: 1.25rem;
    font-weight: 600;
    color: #111827;
  }
`,MD=P.Ay.button`
  background: none;
  border: none;
  cursor: pointer;
  color: #6b7280;
  height: 32px;
  width: 32px;
  display: flex;
  align-items: center;
  justify-content: center;
  border-radius: 4px;
  transition: all 0.2s;
  
  &:hover {
    background-color: #f3f4f6;
    color: #1f2937;
  }
`,LD=P.Ay.div`
  position: relative;
  margin-bottom: 16px;
  width: 100%;
  box-sizing: border-box;
  
  input {
    width: 100%;
    padding: 8px 12px 8px 36px;
    border: 1px solid #d1d5db;
    border-radius: 6px;
    font-size: 0.875rem;
    box-sizing: border-box;
    
    &:focus {
      outline: none;
      border-color: #2563eb;
      box-shadow: 0 0 0 2px rgba(37, 99, 235, 0.2);
    }
  }
  
  svg {
    position: absolute;
    left: 12px;
    top: 50%;
    transform: translateY(-50%);
    color: #9ca3af;
  }
`,FD=P.Ay.div`
  max-height: 370px;
  overflow-y: auto;
  margin-bottom: 16px;
  border: 1px solid #e5e7eb;
  border-radius: 8px;
  padding: 4px;
  width: 100%;
  box-sizing: border-box;
  
  /* Custom scrollbar */
  &::-webkit-scrollbar {
    width: 8px;
  }
  
  &::-webkit-scrollbar-track {
    background: #f1f1f1;
    border-radius: 4px;
  }
  
  &::-webkit-scrollbar-thumb {
    background-color: rgba(156, 163, 175, 0.7);
    border-radius: 4px;
    border: 2px solid #f1f1f1;
  }
  
  &::-webkit-scrollbar-thumb:hover {
    background-color: rgba(156, 163, 175, 0.9);
  }
`,GD=P.Ay.div`
  display: flex;
  align-items: center;
  padding: 8px 12px;
  cursor: pointer;
  border-radius: 4px;
  transition: all 0.2s;
  
  &:hover {
    background-color: #f3f4f6;
  }
  
  .checkbox {
    width: 16px;
    height: 16px;
    border: 1.5px solid #d1d5db;
    border-radius: 4px;
    margin-right: 10px;
    display: flex;
    align-items: center;
    justify-content: center;
    color: white;
    transition: all 0.2s;
    flex-shrink: 0;
    
    &.checked {
      background-color: #2563eb;
      border-color: #2563eb;
    }
  }
  
  .contact-info {
    flex: 1;
    overflow: hidden;
    
    .name {
      font-size: 0.875rem;
      color: #111827;
      font-weight: 500;
      white-space: nowrap;
      overflow: hidden;
      text-overflow: ellipsis;
    }
    
    .company {
      font-size: 0.75rem;
      color: #6b7280;
      white-space: nowrap;
      overflow: hidden;
      text-overflow: ellipsis;
    }
  }
`,zD=P.Ay.div`
  text-align: center;
  padding: 16px;
  color: #6b7280;
  font-size: 0.875rem;
  width: 100%;
  box-sizing: border-box;
  border: 1px dashed #e5e7eb;
  border-radius: 8px;
`,HD=e=>{let{isOpen:o,onRequestClose:n,meeting:r,onAddAttendee:i}=e;const[a,s]=(0,t.useState)(""),[l,c]=(0,t.useState)([]),[d,u]=(0,t.useState)([]),[p,h]=(0,t.useState)(!0);(0,t.useEffect)((()=>{o&&f()}),[o]);const f=()=>{h(!1),c([])};(0,t.useEffect)((()=>{const e=setTimeout((()=>{a.length>=3?(async e=>{if(!e||e.length<3)return c([]),void h(!1);try{h(!0),console.log("Searching for:",e);const{data:t,error:o}=await D.supabase.from("contacts").select("*").ilike("first_name",`%${e}%`).not("contact_category","eq","Skip").limit(20);if(o)throw console.error("First name search error:",o),o;const{data:n,error:r}=await D.supabase.from("contacts").select("*").ilike("last_name",`%${e}%`).not("contact_category","eq","Skip").limit(20);if(r)throw console.error("Last name search error:",r),r;const i=[...t];n.forEach((e=>{i.some((t=>t.id===e.id))||i.push(e)}));const a=i;console.log("Raw search results:",a);const s=a.map((e=>({id:e.id,name:`${e.first_name} ${e.last_name||""}`,company:e.company_name||""})));c(s),console.log("Formatted contacts:",s)}catch(t){console.error("Error searching contacts:",t),nt.oR.error("Failed to search contacts"),c([])}finally{h(!1)}})(a):c([])}),300);return()=>clearTimeout(e)}),[a]);const g=a.length>=3;return(0,N.jsx)(ot(),{isOpen:o,onRequestClose:n,style:{content:{top:"50%",left:"50%",right:"auto",bottom:"auto",marginRight:"-50%",transform:"translate(-50%, -50%)",padding:0,border:"none",borderRadius:"8px",boxShadow:"0 4px 6px rgba(0, 0, 0, 0.1)",width:"350px",maxWidth:"95%",maxHeight:"500px",overflow:"hidden"},overlay:{backgroundColor:"rgba(0, 0, 0, 0.5)",zIndex:1e3}},children:(0,N.jsxs)(ND,{children:[(0,N.jsxs)(ID,{children:[(0,N.jsx)("h2",{children:"Add Attendees"}),(0,N.jsx)(MD,{onClick:n,children:(0,N.jsx)(B.yGN,{size:20})})]}),(0,N.jsxs)(LD,{children:[(0,N.jsx)(B.CKj,{size:16}),(0,N.jsx)("input",{type:"text",placeholder:"Search by name or surname (min 3 chars)...",value:a,onChange:e=>s(e.target.value),autoFocus:!0})]}),g?(0,N.jsx)(FD,{children:p?(0,N.jsx)(zD,{children:"Loading contacts..."}):0===l.length?(0,N.jsx)(zD,{children:"No contacts found"}):l.map((e=>(0,N.jsxs)(GD,{onClick:()=>(async e=>{try{await i(e.id),n()}catch(t){console.error("Error selecting contact:",t)}})(e),children:[(0,N.jsx)("div",{className:"checkbox "+(d.includes(e.id)?"checked":""),children:d.includes(e.id)&&(0,N.jsx)(B.YrT,{size:12})}),(0,N.jsxs)("div",{className:"contact-info",children:[(0,N.jsx)("div",{className:"name",children:e.name}),e.company&&(0,N.jsx)("div",{className:"company",children:e.company})]})]},e.id)))}):(0,N.jsx)(zD,{children:"Type at least 3 characters to search"})]})})},BD=P.Ay.div`
  display: flex;
  flex-direction: column;
  height: 75vh;
  min-height: 600px;
  overflow: hidden;
`,VD=P.Ay.div`
  display: flex;
  justify-content: space-between;
  align-items: flex-start;
  margin-bottom: 24px;
  padding-bottom: 16px;
  border-bottom: 1px solid #e5e7eb;
  
  .header-content {
    flex: 1;
    
    .meeting-title {
      display: flex;
      align-items: center;
      margin-bottom: 8px;
      
      h2 {
        margin: 0;
        font-size: 1.5rem;
        font-weight: 600;
        color: #111827;
      }
    }
    
    .dates {
      display: flex;
      flex-wrap: wrap;
      gap: 16px;
      font-size: 0.875rem;
      color: #6b7280;
      
      span {
        display: inline-block;
      }
    }
  }
`,$D=P.Ay.button`
  background: none;
  border: none;
  cursor: pointer;
  color: #6b7280;
  height: 32px;
  width: 32px;
  display: flex;
  align-items: center;
  justify-content: center;
  border-radius: 4px;
  transition: all 0.2s;
  
  &:hover {
    background-color: #f3f4f6;
    color: #1f2937;
  }
`,UD=P.Ay.div`
  display: flex;
  gap: 2px;
  margin-bottom: 24px;
  border-bottom: 1px solid #e5e7eb;
`,WD=P.Ay.button`
  padding: 12px 20px;
  background: none;
  border: none;
  border-bottom: 2px solid ${e=>e.active?"#007BFF":"transparent"};
  color: ${e=>e.active?"#007BFF":"#6b7280"};
  font-weight: ${e=>e.active?"600":"500"};
  font-size: 0.938rem;
  cursor: pointer;
  transition: all 0.2s;
  
  &:hover {
    color: ${e=>e.active?"#007BFF":"#1f2937"};
  }
  
  &:disabled {
    color: #9ca3af;
    font-style: italic;
    cursor: not-allowed;
  }
`,qD=P.Ay.div`
  flex: 1;
  overflow-y: auto;
  padding: 0 24px 24px;
`,KD=P.Ay.div`
  width: 90%;
  margin: 0 auto;
  padding: 16px;
`,YD=P.Ay.div`
  display: grid;
  grid-template-columns: 1fr 1fr;
  gap: 24px;
  margin-bottom: 40px;
  
  @media (max-width: 768px) {
    grid-template-columns: 1fr;
    gap: 24px;
  }
`,JD=P.Ay.h3`
  font-size: 1.125rem;
  color: #111827;
  margin: 32px 0 24px;
  padding-bottom: 8px;
  border-bottom: 1px solid #f3f4f6;
`,XD=P.Ay.div`
  display: flex;
  flex-direction: column;
  
  &.full-width {
    grid-column: span 2;
  }
`,QD=P.Ay.label`
  display: block;
  margin: 16px 0 8px 0;
  font-size: 16px;
  color: #4b5563;
  font-weight: 500;
`,ZD=P.Ay.input`
  width: 100%;
  height: 38px;
  padding: 8px 12px;
  border: 1px solid #d1d5db;
  border-radius: 4px;
  font-size: 0.875rem;
  color: #111827;
  background-color: #fff;
  transition: border-color 0.2s, box-shadow 0.2s;

  &:focus {
    outline: 0;
    border-color: #2196F3;
    border-width: 2px;
  }

  &.error {
    border-color: #E53935;
    border-width: 2px;
  }
`,eP=P.Ay.textarea`
  width: 100%;
  min-height: 150px;
  padding: 12px;
  border: 1px solid #d1d5db;
  border-radius: 4px;
  font-size: 0.875rem;
  color: #111827;
  background-color: #fff;
  transition: border-color 0.2s, box-shadow 0.2s;
  resize: vertical;

  &:focus {
    outline: none;
    border-color: #007BFF;
    box-shadow: 0 0 0 2px rgba(0, 123, 255, 0.15);
  }
`,tP=P.Ay.select`
  width: 100%;
  height: 38px;
  padding: 8px 12px;
  border: 1px solid #d1d5db;
  border-radius: 4px;
  font-size: 0.875rem;
  color: #111827;
  background-color: #fff;
  transition: border-color 0.2s, box-shadow 0.2s;
  appearance: none;
  background-image: url("data:image/svg+xml;charset=US-ASCII,%3Csvg%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%20width%3D%22292.4%22%20height%3D%22292.4%22%3E%3Cpath%20fill%3D%22%23131313%22%20d%3D%22M287%2069.4a17.6%2017.6%200%200%200-13-5.4H18.4c-5%200-9.3%201.8-12.9%205.4A17.6%2017.6%200%200%200%200%2082.2c0%205%201.8%209.3%205.4%2012.9l128%20127.9c3.6%203.6%207.8%205.4%2012.8%205.4s9.2-1.8%2012.8-5.4L287%2095c3.5-3.5%205.4-7.8%205.4-12.8%200-5-1.9-9.2-5.5-12.8z%22%2F%3E%3C%2Fsvg%3E");
  background-repeat: no-repeat;
  background-position: right 12px top 50%;
  background-size: 8px auto;
  padding-right: 24px;
  
  &:focus {
    outline: 0;
    border-color: #2196F3;
    border-width: 2px;
  }
  
  &.error {
    border-color: #E53935;
    border-width: 2px;
  }
`,oP=P.Ay.div`
  display: flex;
  justify-content: flex-end;
  gap: 12px;
  width: 90%;
  margin: 0 auto;
  padding-top: 16px;
  border-top: 1px solid #f3f4f6;
`,nP=P.Ay.button`
  display: flex;
  align-items: center;
  gap: 6px;
  padding: 10px 16px;
  border-radius: 4px;
  font-size: 0.875rem;
  font-weight: 500;
  cursor: pointer;
  transition: all 0.2s;
`,rP=(0,P.Ay)(nP)`
  background-color: white;
  color: #4b5563;
  border: 1px solid #d1d5db;
  
  &:hover {
    background-color: #f9fafb;
    border-color: #9ca3af;
  }
`,iP=(0,P.Ay)(nP)`
  background-color: #007BFF;
  color: white;
  border: none;
  
  &:hover {
    background-color: #0069d9;
  }
`,aP=P.Ay.div`
  display: flex;
  flex-wrap: wrap;
  gap: 8px;
  margin-bottom: 16px;
  padding: 5px 0;
  min-height: 32px;
`,sP=P.Ay.div`
  display: inline-flex;
  align-items: center;
  padding: 4px 8px;
  background-color: ${e=>e.color||"#f3f4f6"};
  color: ${e=>e.textColor||"#374151"};
  border-radius: 16px;
  font-size: 0.875rem;
  gap: 6px;

  span {
    white-space: nowrap;
    overflow: hidden;
    text-overflow: ellipsis;
  }

  button {
    background: none;
    border: none;
    padding: 2px;
    cursor: pointer;
    color: inherit;
    opacity: 0.7;
    display: flex;
    align-items: center;
    justify-content: center;

    &:hover {
      opacity: 1;
    }
  }
`,lP=P.Ay.div`
  display: flex;
  gap: 4px;
  margin-top: 8px;
  
  button {
    background: none;
    border: none;
    padding: 0;
    margin-right: 4px;
    cursor: pointer;
    color: ${e=>e.active?"#f59e0b":"#d1d5db"};
    transition: color 0.2s;
    width: 22px;
    height: 22px;
    display: flex;
    align-items: center;
    justify-content: center;
    
    &:hover {
      color: #f59e0b;
    }
  }
`,cP=P.Ay.button`
  display: inline-flex;
  align-items: center;
  padding: 6px 12px;
  background-color: #f3f4f6;
  border: none;
  border-radius: 16px;
  color: #374151;
  font-size: 0.875rem;
  cursor: pointer;
  transition: all 0.2s;
  
  &:hover {
    background-color: #e5e7eb;
  }
`,dP=e=>{let{isOpen:o,onRequestClose:n,meeting:r}=e;const[i,a]=(0,t.useState)("details"),[s,l]=(0,t.useState)({meeting_name:"",meeting_date:"",meeting_note:"",meeting_record:"",meeting_score:0,meeting_category:""}),[c,d]=(0,t.useState)([]),[u,p]=(0,t.useState)([]),[h,f]=(0,t.useState)([]),[g,m]=(0,t.useState)([]),[y,v]=(0,t.useState)(!1),[b,x]=(0,t.useState)(!1),[w,C]=(0,t.useState)(!1);(0,t.useEffect)((()=>{o||C(!1)}),[o]);(0,t.useEffect)((()=>{if(r){console.log("Initializing form with meeting:",r);try{const e=(r.meeting_date?new Date(r.meeting_date):new Date).toISOString().slice(0,10);console.log("Formatted meeting date:",e),r.initialTab&&a(r.initialTab),l({meeting_name:r.meeting_name||"",meeting_date:e,meeting_note:r.meeting_note||"",meeting_record:r.meeting_record||"",meeting_score:r.meeting_score||0,meeting_category:r.meeting_category||r.meeting_rationelle||""});const t=async()=>{if(!r.id){console.log("New meeting detected, creating in database...");const t=await(async e=>{try{const t=new Date(e.meeting_date);t.setHours(12,0,0,0);const o=t.toISOString();console.log("Creating new meeting with date:",o);const n={meeting_name:e.meeting_name,meeting_date:o,meeting_note:e.meeting_note||"",meeting_record:e.meeting_record||"",meeting_score:e.meeting_score||0,meeting_category:e.meeting_category||"",created_at:(new Date).toISOString(),updated_at:(new Date).toISOString()};console.log("Creating new meeting with data:",n);const{data:r,error:i}=await D.supabase.from("meetings").insert(n).select().single();if(i)throw console.error("Error creating new meeting:",i),i;return console.log("New meeting created successfully:",r),nt.oR.success("New meeting created"),r}catch(t){return console.error("Failed to create new meeting:",t),nt.oR.error("Failed to create new meeting"),null}})({meeting_name:r.meeting_name||"New Meeting",meeting_date:e,meeting_note:r.meeting_note||"",meeting_record:r.meeting_record||"",meeting_score:r.meeting_score||0,meeting_category:r.meeting_category||""});t&&(r.id=t.id,console.log("Meeting ID updated to:",r.id))}E(),k()};t()}catch(e){console.error("Error initializing form:",e),nt.oR.error("Error initializing form data")}}}),[r]),(0,t.useEffect)((()=>{"related"===i&&r&&r.id&&(_(),S())}),[i,u,c,r]);const _=async()=>{if(r&&r.id&&0!==u.length)try{const e=u.filter((e=>!e.name.toLowerCase().includes("simone cimminelli"))).map((e=>e.id));if(0===e.length)return void f([]);const{data:t,error:o}=await D.supabase.from("meetings_contacts").select("\n          meeting_id,\n          contact_id,\n          contacts:contact_id(first_name, last_name),\n          meetings:meeting_id(\n            id, \n            meeting_name, \n            meeting_date\n          )\n        ").in("contact_id",e).neq("meeting_id",r.id);if(o)throw o;const n=t.filter((e=>!`${e.contacts.first_name} ${e.contacts.last_name}`.toLowerCase().includes("simone cimminelli"))),i={};n.forEach((e=>{const t=e.meeting_id,o=e.meetings;i[t]?i[t].commonAttendees++:i[t]={id:t,name:o.meeting_name,date:o.meeting_date,commonAttendees:1}}));const a=Object.values(i).sort(((e,t)=>t.commonAttendees-e.commonAttendees));f(a)}catch(e){console.error("Error fetching related meetings by attendees:",e)}else f([])},S=async()=>{if(r&&r.id&&0!==c.length)try{console.log("Fetching related meetings by tags for meeting ID:",r.id),console.log("Current meeting tags:",c);const e=c.map((e=>e.tag_id));if(console.log("Tag IDs for related meetings search:",e),0===e.length)return console.log("No tag IDs found, skipping related meetings query"),void m([]);const{data:t,error:o}=await D.supabase.from("meetings_tags").select("\n          meeting_id,\n          meetings:meeting_id(\n            id, \n            meeting_name, \n            meeting_date\n          )\n        ").in("tag_id",e).neq("meeting_id",r.id);if(o)throw o;console.log("Found related meetings:",t);const n={};t.forEach((e=>{const t=e.meeting_id,o=e.meetings;n[t]?n[t].commonTags++:n[t]={id:t,name:o.meeting_name,date:o.meeting_date,commonTags:1}}));const i=Object.values(n).sort(((e,t)=>t.commonTags-e.commonTags));m(i)}catch(e){console.error("Error fetching related meetings by tags:",e)}else m([])},E=async()=>{if(r)try{console.log("Fetching tags for meeting ID:",r.id);const{data:e,error:t}=await D.supabase.from("meetings_tags").select("\n          meeting_id,\n          tag_id,\n          tags:tag_id (id, name)\n        ").eq("meeting_id",r.id);if(t)throw t;if(console.log("Meeting tags raw data:",e),e&&e.length>0){const t=e.map((e=>{var t;return{id:`${e.meeting_id}-${e.tag_id}`,tag_id:e.tag_id,name:(null===(t=e.tags)||void 0===t?void 0:t.name)||"Unknown tag"}}));console.log("Formatted tags:",t),d(t)}else d([])}catch(e){console.error("Error fetching meeting tags:",e),nt.oR.error("Failed to load meeting tags")}},k=async()=>{if(r)try{const{data:e,error:t}=await D.supabase.from("meetings_contacts").select("\n          contact_id,\n          contacts:contact_id(id, first_name, last_name)\n        ").eq("meeting_id",r.id);if(t)throw t;const o=e.map((e=>({id:e.contact_id,name:`${e.contacts.first_name} ${e.contacts.last_name}`})));p(o)}catch(e){console.error("Error fetching meeting attendees:",e),nt.oR.error("Failed to load attendees")}},j=e=>{const{name:t,value:o}=e.target;if(console.log("Input change event:",{name:t,value:o,type:e.target.type}),"meeting_date"===t)try{const e=new Date(o);isNaN(e.getTime())||l((e=>({...e,[t]:o})))}catch(n){console.error("Error handling date input:",n)}else"meeting_category"===t&&console.log("Updating meeting_category to:",o),l((e=>{const n={...e,[t]:o};return console.log("Updated form data:",n),n}))},A=P.Ay.div`
    display: flex;
    padding: 12px;
    border-bottom: 1px solid #e5e7eb;
    cursor: pointer;
    transition: background-color 0.2s;
    
    &:hover {
      background-color: #f9fafb;
    }
    
    &:last-child {
      border-bottom: none;
    }
    
    .meeting-info {
      flex: 1;
      
      .meeting-name {
        font-weight: 500;
        color: #111827;
        margin-bottom: 4px;
      }
      
      .meeting-date {
        font-size: 0.75rem;
        color: #6b7280;
      }
    }
    
    .meeting-meta {
      display: flex;
      align-items: center;
      color: #6b7280;
      font-size: 0.75rem;
      
      span {
        display: flex;
        align-items: center;
        gap: 4px;
      }
    }
  `,R=P.Ay.div`
    padding: 24px;
    text-align: center;
    color: #6b7280;
    font-style: italic;
  `,O=P.Ay.div`
    border: 1px solid #e5e7eb;
    border-radius: 8px;
    overflow: hidden;
    margin-bottom: 32px;
    max-height: 300px;
    overflow-y: auto;
    
    /* Custom scrollbar */
    &::-webkit-scrollbar {
      width: 8px;
    }
    
    &::-webkit-scrollbar-track {
      background: #f1f1f1;
      border-radius: 4px;
    }
    
    &::-webkit-scrollbar-thumb {
      background-color: rgba(156, 163, 175, 0.7);
      border-radius: 4px;
      border: 2px solid #f1f1f1;
    }
    
    &::-webkit-scrollbar-thumb:hover {
      background-color: rgba(156, 163, 175, 0.9);
    }
  `;return(0,N.jsxs)(N.Fragment,{children:[(0,N.jsx)(ot(),{isOpen:o,onRequestClose:n,style:{content:{top:"50%",left:"50%",right:"auto",bottom:"auto",marginRight:"-50%",transform:"translate(-50%, -50%)",padding:"24px",border:"none",borderRadius:"8px",boxShadow:"0 4px 12px rgba(0, 0, 0, 0.15)",width:"75%",maxHeight:"85vh",overflow:"hidden"},overlay:{backgroundColor:"rgba(0, 0, 0, 0.5)",zIndex:1e3}},children:(0,N.jsxs)(BD,{children:[(0,N.jsxs)(VD,{children:[(0,N.jsxs)("div",{className:"header-content",children:[(0,N.jsx)("div",{className:"meeting-title",children:(0,N.jsx)("h2",{children:(null===r||void 0===r?void 0:r.meeting_name)||"New Meeting"})}),(0,N.jsxs)("div",{className:"dates",children:[(0,N.jsxs)("span",{children:["Created: ",(0,ge.A)(new Date((null===r||void 0===r?void 0:r.created_at)||new Date),"dd/MM/yyyy HH:mm")]}),(0,N.jsxs)("span",{children:["Last Modified: ",(0,ge.A)(new Date((null===r||void 0===r?void 0:r.updated_at)||new Date),"dd/MM/yyyy HH:mm")]})]})]}),(0,N.jsx)($D,{onClick:n,children:(0,N.jsx)(B.yGN,{size:20})})]}),(0,N.jsx)(UD,{children:(0,N.jsxs)("div",{style:{display:"flex",width:"100%",justifyContent:"space-between"},children:[(0,N.jsxs)("div",{children:[(0,N.jsx)(WD,{active:"details"===i,onClick:()=>a("details"),children:"Details"}),(0,N.jsx)(WD,{active:"notes"===i,onClick:()=>a("notes"),children:"Notes"}),(0,N.jsx)(WD,{active:"related"===i,onClick:()=>a("related"),children:"Related"})]}),(0,N.jsx)("div",{style:{display:"flex",alignItems:"center",marginRight:"16px"},children:(0,N.jsxs)(nP,{onClick:async()=>{if(r&&r.id){if(!w)return C(!0),void nt.oR.custom((e=>(0,N.jsxs)("div",{style:{padding:"8px 12px",borderRadius:"4px",background:"#f97316",color:"white",fontSize:"14px",display:"flex",alignItems:"center",boxShadow:"0 3px 10px rgba(0, 0, 0, 0.2)"},children:[(0,N.jsx)("span",{style:{marginRight:"8px"},children:"\u26a0\ufe0f"}),(0,N.jsx)("span",{children:"Click delete again to confirm deletion"})]})),{duration:5e3});try{console.log("Starting meeting deletion process for meeting ID:",r.id),console.log("Deleting associated tags from meetings_tags...");const{data:e,error:t}=await D.supabase.from("meetings_tags").delete().eq("meeting_id",r.id).select();if(t)throw console.error("Error deleting tags:",t),t;console.log("Successfully deleted tags associations:",(null===e||void 0===e?void 0:e.length)||0),console.log("Deleting associated contacts from meetings_contacts...");const{data:o,error:i}=await D.supabase.from("meetings_contacts").delete().eq("meeting_id",r.id).select();if(i)throw console.error("Error deleting contacts:",i),i;console.log("Successfully deleted contacts associations:",(null===o||void 0===o?void 0:o.length)||0),console.log("Deleting the meeting record...");const{data:a,error:s}=await D.supabase.from("meetings").select("id").eq("id",r.id).single();if(s&&"PGRST116"!==s.code)throw console.error("Error checking meeting existence:",s),s;if(!a)throw console.warn("Meeting already deleted or does not exist"),new Error("Meeting not found. It may have been already deleted.");const{data:l,error:c}=await D.supabase.from("meetings").delete().eq("id",r.id).select();if(c)throw console.error("Error deleting meeting:",c),c;console.log("Successfully deleted meeting:",l),nt.oR.success("Meeting deleted successfully"),n(),setTimeout((()=>{window.location.reload()}),500)}catch(e){console.error("Error deleting meeting:",e),nt.oR.error(`Failed to delete meeting: ${e.message}`),C(!1)}finally{C(!1)}}else nt.oR.error("Invalid meeting data")},style:{backgroundColor:w?"#b91c1c":"#ef4444",color:"white",border:"none",padding:"6px 12px",fontSize:"0.75rem",display:"flex",alignItems:"center",gap:"4px",transition:"all 0.2s ease",boxShadow:w?"0 0 0 2px rgba(239, 68, 68, 0.5)":"none"},children:[(0,N.jsx)(B.IXo,{size:14}),w?"Confirm Delete":"Delete"]})})]})}),(0,N.jsxs)(qD,{children:["details"===i&&(0,N.jsxs)(KD,{children:[(0,N.jsx)(JD,{children:"Details"}),(0,N.jsxs)(YD,{children:[(0,N.jsxs)(XD,{children:[(0,N.jsx)(QD,{htmlFor:"meeting_name",children:"Meeting Name"}),(0,N.jsx)(ZD,{id:"meeting_name",name:"meeting_name",value:s.meeting_name,onChange:j,placeholder:"Enter meeting name"})]}),(0,N.jsxs)(XD,{children:[(0,N.jsx)(QD,{htmlFor:"meeting_date",children:"Meeting Date"}),(0,N.jsx)(ZD,{id:"meeting_date",name:"meeting_date",type:"date",value:s.meeting_date?new Date(s.meeting_date).toISOString().slice(0,10):"",onChange:j})]})]}),(0,N.jsx)(JD,{children:"Attendees"}),(0,N.jsxs)(aP,{style:{maxHeight:"150px",overflowY:"auto"},children:[u.map((e=>(0,N.jsxs)(sP,{color:"#e0f2fe",textColor:"#0369a1",children:[(0,N.jsx)("span",{children:e.name}),(0,N.jsx)("button",{onClick:()=>(async e=>{try{const{error:t}=await D.supabase.from("meetings_contacts").delete().eq("meeting_id",r.id).eq("contact_id",e.id);if(t)throw t;p((t=>t.filter((t=>t.id!==e.id)))),nt.oR.success("Attendee removed successfully")}catch(t){console.error("Error removing attendee:",t),nt.oR.error("Failed to remove attendee")}})(e),children:(0,N.jsx)(B.yGN,{size:14})})]},e.id))),(0,N.jsxs)(cP,{onClick:()=>x(!0),children:[(0,N.jsx)(B.GGD,{size:14,style:{marginRight:"4px"}})," Add Attendees"]})]}),(0,N.jsx)(JD,{children:"Tags"}),(0,N.jsxs)(aP,{style:{maxHeight:"150px",overflowY:"auto"},children:[c.map((e=>(0,N.jsxs)(sP,{color:"#f3f4f6",textColor:"#374151",children:[(0,N.jsx)("span",{children:e.name}),(0,N.jsx)("button",{onClick:()=>(async e=>{try{console.log("Removing tag with name:",e.name);const{data:t,error:o}=await D.supabase.from("tags").select("id").eq("name",e.name).single();if(o)throw console.error("Error finding tag ID:",o),o;if(!t)throw console.error("Tag not found with name:",e.name),new Error("Tag not found");const n=t.id;console.log(`Found tag ID ${n} for tag name ${e.name}`),console.log(`Deleting tag connection from meetings_tags where meeting_id=${r.id} and tag_id=${n}`);const{error:i}=await D.supabase.from("meetings_tags").delete().eq("meeting_id",r.id).eq("tag_id",n);if(i)throw console.error("Delete error:",i),i;console.log("Successfully deleted from meetings_tags"),d((t=>t.filter((t=>t.name!==e.name)))),nt.oR.success("Tag removed successfully"),await S()}catch(t){console.error("Error removing tag:",t),nt.oR.error(`Failed to remove tag: ${t.message||"Unknown error"}`)}})(e),children:(0,N.jsx)(B.yGN,{size:14})})]},e.id))),(0,N.jsxs)(cP,{onClick:()=>v(!0),children:[(0,N.jsx)(B.GGD,{size:14,style:{marginRight:"4px"}})," Add Tags"]})]})]}),"notes"===i&&(0,N.jsxs)(KD,{children:[(0,N.jsxs)(XD,{className:"full-width",children:[(0,N.jsx)(QD,{htmlFor:"meeting_note",children:"Notes"}),(0,N.jsx)(eP,{name:"meeting_note",value:s.meeting_note,onChange:j,placeholder:"Enter meeting notes...",style:{minHeight:"250px"}})]}),(0,N.jsx)(JD,{children:"Meeting Details"}),(0,N.jsxs)(YD,{children:[(0,N.jsxs)("div",{children:[(0,N.jsxs)(XD,{children:[(0,N.jsx)(QD,{children:"Meeting Score"}),(0,N.jsx)(lP,{active:s.meeting_score>0,children:[1,2,3,4,5].map((e=>(0,N.jsx)("button",{onClick:()=>(async e=>{try{const{error:t}=await D.supabase.from("meetings").update({meeting_score:e}).eq("id",r.id);if(t)throw t;l((t=>({...t,meeting_score:e}))),nt.oR.success("Score updated successfully")}catch(t){console.error("Error updating score:",t),nt.oR.error("Failed to update score")}})(e),type:"button",children:(0,N.jsx)(B.usP,{size:22,style:{fill:e<=s.meeting_score?"#f59e0b":"none"}})},e)))})]}),(0,N.jsxs)(XD,{style:{marginTop:"24px"},children:[(0,N.jsx)(QD,{htmlFor:"meeting_record",children:"Meeting Record"}),(0,N.jsx)(ZD,{id:"meeting_record",name:"meeting_record",value:s.meeting_record,onChange:j,placeholder:"Enter meeting record URL"})]})]}),(0,N.jsxs)(XD,{children:[(0,N.jsx)(QD,{htmlFor:"meeting_category",children:"Meeting Category"}),(0,N.jsx)(tP,{id:"meeting_category",name:"meeting_category",value:s.meeting_category,onChange:j,children:[{value:"",label:"Select a category"},{value:"inbox",label:"Inbox"},{value:"karma_points",label:"Karma Points"},{value:"dealflow",label:"Dealflow Related"},{value:"portfolio",label:"Portfolio Company Related"}].map((e=>(0,N.jsx)("option",{value:e.value,children:e.label},e.value)))})]})]})]}),"related"===i&&(()=>{const e=e=>{window.location.href=`/meetings/${e}`};return(0,N.jsxs)(KD,{children:[(0,N.jsx)(JD,{children:"Related Meetings by Attendees"}),(0,N.jsx)(O,{children:0===h.length?(0,N.jsx)(R,{children:"No related meetings found by attendees"}):h.map((t=>(0,N.jsxs)(A,{onClick:()=>e(t.id),children:[(0,N.jsxs)("div",{className:"meeting-info",children:[(0,N.jsx)("div",{className:"meeting-name",children:t.name}),(0,N.jsx)("div",{className:"meeting-date",children:(0,ge.A)(new Date(t.date),"dd/MM/yyyy")})]}),(0,N.jsx)("div",{className:"meeting-meta",children:(0,N.jsxs)("span",{children:[(0,N.jsx)(B.cfS,{size:14}),t.commonAttendees," common ",1===t.commonAttendees?"attendee":"attendees"]})})]},t.id)))}),(0,N.jsx)(JD,{children:"Related Meetings by Tags"}),(0,N.jsx)(O,{children:0===g.length?(0,N.jsx)(R,{children:"No related meetings found by tags"}):g.map((t=>(0,N.jsxs)(A,{onClick:()=>e(t.id),children:[(0,N.jsxs)("div",{className:"meeting-info",children:[(0,N.jsx)("div",{className:"meeting-name",children:t.name}),(0,N.jsx)("div",{className:"meeting-date",children:(0,ge.A)(new Date(t.date),"dd/MM/yyyy")})]}),(0,N.jsx)("div",{className:"meeting-meta",children:(0,N.jsxs)("span",{children:[(0,N.jsx)(B.cnX,{size:14}),t.commonTags," common ",1===t.commonTags?"tag":"tags"]})})]},t.id)))})]})})()]}),(0,N.jsxs)(oP,{children:[(0,N.jsx)(rP,{onClick:n,children:"Cancel"}),(0,N.jsxs)(iP,{onClick:async()=>{try{if(console.log("Starting save process...",{formData:s,meeting:r}),console.log("Meeting ID:",null===r||void 0===r?void 0:r.id),console.log("Meeting Category value:",s.meeting_category),!s.meeting_name.trim())return void nt.oR.error("Meeting name is required");if(!s.meeting_date)return void nt.oR.error("Meeting date is required");const e=new Date(s.meeting_date);e.setHours(12,0,0,0);const t=e.toISOString();console.log("Formatted date:",t);const o={meeting_name:s.meeting_name.trim(),meeting_date:t,meeting_note:s.meeting_note||"",meeting_record:s.meeting_record||"",meeting_score:s.meeting_score||0,meeting_category:s.meeting_category||"",updated_at:(new Date).toISOString()};let i;if(console.log("Meeting data:",o),r&&r.id){console.log("Updating existing meeting with ID:",r.id);const{data:e,error:t}=await D.supabase.from("meetings").update(o).eq("id",r.id).select();if(t)throw console.error("Supabase update error:",t),t;i=e,console.log("Update successful:",e),nt.oR.success("Meeting updated successfully")}else{console.log("Creating new meeting"),o.created_at=(new Date).toISOString();const{data:e,error:t}=await D.supabase.from("meetings").insert(o).select();if(t)throw console.error("Supabase insert error:",t),t;i=e,console.log("Meeting created successfully:",e),nt.oR.success("Meeting created successfully")}n(),setTimeout((()=>{window.location.reload()}),500)}catch(e){console.error("Error saving meeting:",e),nt.oR.error(`Failed to save meeting: ${e.message}`)}},children:[(0,N.jsx)(B.Bc_,{size:16}),"Save Changes"]})]})]})}),y&&(0,N.jsx)(pt.A,{isOpen:y,onRequestClose:()=>{v(!1),E()},meeting:r}),b&&(0,N.jsx)(HD,{isOpen:b,onRequestClose:()=>{x(!1),k()},meeting:r,onAddAttendee:async e=>{try{const{error:t}=await D.supabase.from("meetings_contacts").insert({meeting_id:r.id,contact_id:e});if(t)throw t;await k(),nt.oR.success("Attendee added successfully")}catch(t){console.error("Error adding attendee:",t),nt.oR.error("Failed to add attendee")}}})]})};function uP(e){(0,Te.A)(1,arguments);var t=(0,Ve.A)(e);return t.setDate(1),t.setHours(0,0,0,0),t}var pP=o(2239);function hP(e,t){var o,n,r,i,a,s,l,c;(0,Te.A)(1,arguments);var d=(0,pP.q)(),u=(0,De.A)(null!==(o=null!==(n=null!==(r=null!==(i=null===t||void 0===t?void 0:t.weekStartsOn)&&void 0!==i?i:null===t||void 0===t||null===(a=t.locale)||void 0===a||null===(s=a.options)||void 0===s?void 0:s.weekStartsOn)&&void 0!==r?r:d.weekStartsOn)&&void 0!==n?n:null===(l=d.locale)||void 0===l||null===(c=l.options)||void 0===c?void 0:c.weekStartsOn)&&void 0!==o?o:0);if(!(u>=0&&u<=6))throw new RangeError("weekStartsOn must be between 0 and 6 inclusively");var p=(0,Ve.A)(e),h=p.getDay(),f=(h<u?7:0)+h-u;return p.setDate(p.getDate()-f),p.setHours(0,0,0,0),p}function fP(e,t){var o,n,r,i,a,s,l,c;(0,Te.A)(1,arguments);var d=(0,pP.q)(),u=(0,De.A)(null!==(o=null!==(n=null!==(r=null!==(i=null===t||void 0===t?void 0:t.weekStartsOn)&&void 0!==i?i:null===t||void 0===t||null===(a=t.locale)||void 0===a||null===(s=a.options)||void 0===s?void 0:s.weekStartsOn)&&void 0!==r?r:d.weekStartsOn)&&void 0!==n?n:null===(l=d.locale)||void 0===l||null===(c=l.options)||void 0===c?void 0:c.weekStartsOn)&&void 0!==o?o:0);if(!(u>=0&&u<=6))throw new RangeError("weekStartsOn must be between 0 and 6 inclusively");var p=(0,Ve.A)(e),h=p.getDay(),f=6+(h<u?-7:0)-(h-u);return p.setDate(p.getDate()+f),p.setHours(23,59,59,999),p}function gP(e,t){var o,n,r,i,a,s,l,c;(0,Te.A)(1,arguments);var d=(0,pP.q)(),u=(0,De.A)(null!==(o=null!==(n=null!==(r=null!==(i=null===t||void 0===t?void 0:t.firstWeekContainsDate)&&void 0!==i?i:null===t||void 0===t||null===(a=t.locale)||void 0===a||null===(s=a.options)||void 0===s?void 0:s.firstWeekContainsDate)&&void 0!==r?r:d.firstWeekContainsDate)&&void 0!==n?n:null===(l=d.locale)||void 0===l||null===(c=l.options)||void 0===c?void 0:c.firstWeekContainsDate)&&void 0!==o?o:1),p=function(e,t){var o,n,r,i,a,s,l,c;(0,Te.A)(1,arguments);var d=(0,Ve.A)(e),u=d.getFullYear(),p=(0,pP.q)(),h=(0,De.A)(null!==(o=null!==(n=null!==(r=null!==(i=null===t||void 0===t?void 0:t.firstWeekContainsDate)&&void 0!==i?i:null===t||void 0===t||null===(a=t.locale)||void 0===a||null===(s=a.options)||void 0===s?void 0:s.firstWeekContainsDate)&&void 0!==r?r:p.firstWeekContainsDate)&&void 0!==n?n:null===(l=p.locale)||void 0===l||null===(c=l.options)||void 0===c?void 0:c.firstWeekContainsDate)&&void 0!==o?o:1);if(!(h>=1&&h<=7))throw new RangeError("firstWeekContainsDate must be between 1 and 7 inclusively");var f=new Date(0);f.setFullYear(u+1,0,h),f.setHours(0,0,0,0);var g=hP(f,t),m=new Date(0);m.setFullYear(u,0,h),m.setHours(0,0,0,0);var y=hP(m,t);return d.getTime()>=g.getTime()?u+1:d.getTime()>=y.getTime()?u:u-1}(e,t),h=new Date(0);return h.setFullYear(p,0,u),h.setHours(0,0,0,0),hP(h,t)}function mP(e,t){(0,Te.A)(1,arguments);var o=(0,Ve.A)(e),n=hP(o,t).getTime()-gP(o,t).getTime();return Math.round(n/6048e5)+1}function yP(e,t){(0,Te.A)(2,arguments);var o=(0,Ve.A)(e),n=(0,Ve.A)(t);return o.getFullYear()===n.getFullYear()&&o.getMonth()===n.getMonth()}function vP(e,t){return(0,Te.A)(2,arguments),et(e,7*(0,De.A)(t))}function bP(e,t){(0,Te.A)(2,arguments);var o=(0,Ve.A)(e),n=(0,De.A)(t);if(isNaN(n))return new Date(NaN);if(!n)return o;var r=o.getDate(),i=new Date(o.getTime());return i.setMonth(o.getMonth()+n+1,0),r>=i.getDate()?i:(o.setFullYear(i.getFullYear(),i.getMonth(),r),o)}const xP=P.Ay.div`
  background-color: white;
  border-radius: 0.5rem;
  box-shadow: 0 1px 3px rgba(0, 0, 0, 0.05);
  overflow: hidden;
`,wP=P.Ay.div`
  padding: 1.5rem;
  border-bottom: 1px solid #e5e7eb;
`,CP=P.Ay.div`
  display: flex;
  justify-content: space-between;
  align-items: flex-start;
  margin-bottom: 1rem;
`,_P=P.Ay.div`
  flex: 1;
`,SP=P.Ay.h1`
  font-size: 1.5rem;
  font-weight: 600;
  color: #111827;
  margin: 0 0 0.5rem 0;
  display: flex;
  align-items: center;
  gap: 0.5rem;
`,EP=P.Ay.span`
  font-size: 1rem;
  font-weight: 400;
  color: #6b7280;
`,kP=P.Ay.p`
  color: #6b7280;
  margin: 0;
  font-size: 0.875rem;
`,jP=P.Ay.div`
  padding: 1.5rem 0 0;
`,AP=P.Ay.div`
  display: flex;
  justify-content: space-between;
  align-items: center;
  padding: 1rem 1.5rem;
  background-color: #f9fafb;
  border-bottom: 1px solid #e5e7eb;
  margin-bottom: 0.5rem;
`,RP=P.Ay.div`
  display: flex;
  align-items: center;
  gap: 0.5rem;
`,OP=P.Ay.button`
  display: flex;
  align-items: center;
  gap: 6px;
  background-color: #2563eb;
  color: white;
  border: none;
  padding: 0.375rem 0.75rem;
  border-radius: 0.375rem;
  font-size: 0.875rem;
  font-weight: 500;
  cursor: pointer;
  transition: all 0.2s;
  
  &:hover {
    background-color: #1d4ed8;
  }
`,TP=P.Ay.div`
  font-size: 1.125rem;
  font-weight: 600;
  color: #111827;
  min-width: 150px;
  text-align: center;
`,DP=P.Ay.button`
  display: flex;
  align-items: center;
  justify-content: center;
  width: 2rem;
  height: 2rem;
  border-radius: 50%;
  border: 1px solid #e5e7eb;
  background-color: white;
  color: #6b7280;
  cursor: pointer;
  transition: all 0.2s;
  
  &:hover {
    background-color: #f3f4f6;
    color: #111827;
  }
  
  &:disabled {
    opacity: 0.5;
    cursor: not-allowed;
  }
`,PP=P.Ay.div`
  font-weight: 500;
  color: #6b7280;
  font-size: 0.875rem;
`,NP=P.Ay.div`
  margin-bottom: 2rem;
  border: 1px solid #e5e7eb;
  border-radius: 0.5rem;
  overflow: hidden;
  box-shadow: 0 1px 3px rgba(0, 0, 0, 0.05);
`,IP=P.Ay.div`
  display: flex;
  justify-content: space-between;
  align-items: center;
  padding: 0.75rem 1rem;
  background-color: #f9fafb;
  border-bottom: 1px solid #e5e7eb;
`,MP=P.Ay.h2`
  font-size: 0.875rem;
  font-weight: 600;
  color: #374151;
  margin: 0;
  display: flex;
  align-items: center;
  gap: 0.5rem;
`,LP=P.Ay.button`
  display: flex;
  align-items: center;
  justify-content: center;
  gap: 4px;
  background-color: #e0f2fe;
  color: #0284c7;
  border: none;
  border-radius: 0.25rem;
  padding: 0.25rem 0.5rem;
  font-size: 0.75rem;
  font-weight: 500;
  cursor: pointer;
  transition: all 0.2s;
  
  &:hover {
    background-color: #bae6fd;
  }
`,FP=P.Ay.span`
  font-size: 0.75rem;
  color: #6b7280;
`,GP=P.Ay.div`
  text-align: center;
  padding: 2rem;
  color: #6b7280;
  font-style: italic;
`,zP=P.Ay.table`
  width: 100%;
  border-collapse: separate;
  border-spacing: 0;
  margin-bottom: 1.5rem;
  table-layout: fixed; /* Use fixed layout for better column control */
  
  /* Column width specifications - adjusted as requested */
  th:nth-child(1) { width: 6%; }   /* Date column */
  th:nth-child(2) { width: 12%; }  /* Category column */
  th:nth-child(3) { width: 12%; }  /* Meeting column */
  th:nth-child(4) { width: 15%; }  /* Attendees column */
  th:nth-child(5) { width: 15%; }  /* Tags column */
  th:nth-child(6) { width: 6%; }   /* Record column */
  th:nth-child(7) { width: 6%; }   /* Score column */
  th:nth-child(8) { width: 28%; }  /* Note column */
`,HP=P.Ay.thead`
  background-color: #f9fafb;
  
  th {
    padding: 0.875rem 1rem;
    text-align: left;
    font-weight: 600;
    font-size: 0.75rem;
    color: #4b5563;
    border-bottom: 1px solid #e5e7eb;
    position: sticky;
    top: 0;
    z-index: 10;
    white-space: nowrap;
  }
`,BP=P.Ay.tbody`
  tr {
    border-bottom: 1px solid #e5e7eb;
    transition: background-color 0.15s;
    
    &:hover {
      background-color: #f9fafb;
    }
    
    &:last-child {
      border-bottom: none;
    }
  }
`,VP=P.Ay.td`
  cursor: pointer;
  position: relative;
  transition: background-color 0.2s;
  padding: 0.875rem 1rem;
  font-size: 0.875rem;
  color: #1f2937;
  vertical-align: middle;
  overflow: hidden;
  
  .cell-content {
    display: flex;
    align-items: center;
    gap: 0.5rem;
    width: 100%;
    min-width: 0;
    padding: 0.25rem 0;
  }
  
  &:hover {
    background-color: #f3f4f6;
  }
`,$P=P.Ay.span`
  display: flex;
  align-items: center;
  justify-content: center;
  font-size: 1rem;
  color: #6b7280;
`,UP=P.Ay.td`
  padding: 0.875rem 1rem;
  font-size: 0.875rem;
  color: #1f2937;
  vertical-align: middle;
`,WP=(0,P.Ay)(UP)`
  cursor: pointer;
  transition: background-color 0.2s;
  
  &:hover {
    background-color: #f3f4f6;
  }
  
  .stars {
    color: #f59e0b;
    display: flex;
    gap: 2px;
  }
`,qP=P.Ay.div`
  display: flex;
  flex-wrap: wrap;
  gap: 0.375rem;
`,KP=P.Ay.span`
  display: inline-flex;
  align-items: center;
  background-color: ${e=>e.color||"#e5f9ee"};
  color: ${e=>e.textColor||"#065f46"};
  padding: 0.25rem 0.5rem;
  border-radius: 9999px;
  font-size: 0.75rem;
  font-weight: 500;
  max-width: 100%;
  overflow: hidden;
  text-overflow: ellipsis;
  white-space: nowrap;
  
  &.company {
    background-color: #e0f2fe;
    color: #0369a1;
  }
  
  &.more {
    background-color: #f3f4f6;
    color: #6b7280;
  }
  
  &.has-remove {
    padding-right: 0.25rem;
  }
`,YP=P.Ay.span`
  overflow: hidden;
  text-overflow: ellipsis;
`,JP=P.Ay.button`
  display: inline-flex;
  align-items: center;
  justify-content: center;
  margin-left: 0.25rem;
  padding: 0.125rem;
  border-radius: 50%;
  background: none;
  border: none;
  cursor: pointer;
  color: inherit;
  opacity: 0.7;
  
  &:hover {
    opacity: 1;
    background-color: rgba(0, 0, 0, 0.05);
  }
`,XP=(P.Ay.button`
  display: inline-flex;
  align-items: center;
  background-color: #f9fafb;
  color: #6b7280;
  padding: 0.25rem 0.5rem;
  border-radius: 9999px;
  font-size: 0.75rem;
  font-weight: 500;
  border: 1px dashed #d1d5db;
  cursor: pointer;
  
  &:hover {
    background-color: #f3f4f6;
    color: #4b5563;
  }
`,P.Ay.tr`
  td {
    text-align: center;
    padding: 2rem;
    color: #6b7280;
  }
`,P.Ay.a`
  color: #3b82f6;
  display: flex;
  align-items: center;
  justify-content: center;
  transition: color 0.2s;
  
  &:hover {
    color: #2563eb;
  }
`),QP=(P.Ay.div`
  position: fixed;
  top: 0;
  left: 0;
  right: 0;
  bottom: 0;
  background-color: rgba(0, 0, 0, 0.5);
  display: flex;
  align-items: center;
  justify-content: center;
  z-index: 50;
`,P.Ay.div`
  background-color: white;
  border-radius: 0.5rem;
  max-width: 500px;
  width: 95%;
  max-height: 90vh;
  overflow-y: auto;
  box-shadow: 0 10px 25px rgba(0, 0, 0, 0.1);
`,P.Ay.div`
  display: flex;
  align-items: center;
  justify-content: space-between;
  padding: 1rem 1.5rem;
  border-bottom: 1px solid #e5e7eb;
  
  h3 {
    font-size: 1.125rem;
    font-weight: 600;
    color: #111827;
    margin: 0;
  }
`,P.Ay.div`
  padding: 1.5rem;
`,P.Ay.div`
  display: flex;
  justify-content: flex-end;
  gap: 0.75rem;
  padding: 1rem 1.5rem;
  border-top: 1px solid #e5e7eb;
`,P.Ay.button`
  padding: 0.5rem 1rem;
  border-radius: 0.375rem;
  font-size: 0.875rem;
  font-weight: 500;
  transition: all 0.15s;
  cursor: pointer;
  
  &:focus {
    outline: none;
  }
`),ZP=((0,P.Ay)(QP)`
  background-color: #3b82f6;
  color: white;
  border: none;
  
  &:hover {
    background-color: #2563eb;
  }
  
  &:disabled {
    background-color: #93c5fd;
    cursor: not-allowed;
  }
`,(0,P.Ay)(QP)`
  background-color: white;
  color: #4b5563;
  border: 1px solid #d1d5db;
  
  &:hover {
    background-color: #f9fafb;
  }
`,P.Ay.div`
  position: relative;
  margin-bottom: 1rem;
  
  input {
    width: 100%;
    padding: 0.625rem 1rem 0.625rem 2.5rem;
    border: 1px solid #d1d5db;
    border-radius: 0.375rem;
    font-size: 0.875rem;
    transition: border-color 0.15s;
    
    &:focus {
      outline: none;
      border-color: #3b82f6;
      box-shadow: 0 0 0 2px rgba(59, 130, 246, 0.3);
    }
  }
  
  svg {
    position: absolute;
    left: 0.75rem;
    top: 50%;
    transform: translateY(-50%);
    color: #6b7280;
  }
`,P.Ay.div`
  max-height: 300px;
  overflow-y: auto;
  border: 1px solid #e5e7eb;
  border-radius: 0.375rem;
`,P.Ay.div`
  display: flex;
  align-items: center;
  padding: 0.625rem 1rem;
  cursor: pointer;
  border-bottom: 1px solid #e5e7eb;
  transition: background-color 0.15s;
  
  &:last-child {
    border-bottom: none;
  }
  
  &:hover {
    background-color: #f9fafb;
  }
  
  &.selected {
    background-color: #eff6ff;
  }
  
  .checkbox {
    display: flex;
    align-items: center;
    justify-content: center;
    width: 1.25rem;
    height: 1.25rem;
    border: 1px solid #d1d5db;
    border-radius: 0.25rem;
    margin-right: 0.75rem;
    color: white;
    transition: all 0.15s;
    
    &.checked {
      background-color: #3b82f6;
      border-color: #3b82f6;
    }
  }
  
  .item-label {
    flex: 1;
    font-size: 0.875rem;
    color: #111827;
  }
`,P.Ay.div`
  text-align: center;
  padding: 1rem;
  color: #6b7280;
  font-size: 0.875rem;
`,()=>{const[e,o]=(0,t.useState)([]),[n,r]=(0,t.useState)(!0),[i,a]=(0,t.useState)(0),[s,l]=(0,t.useState)(null),[c,d]=(0,t.useState)([]),[u,p]=(0,t.useState)([]),[h,f]=(0,t.useState)(null),[g,m]=(0,t.useState)(!1),[y,v]=(0,t.useState)(new Date),[b,x]=(0,t.useState)(new Date),[w,C]=(0,t.useState)([]),_=async()=>{try{r(!0),l(null);const{data:e,error:t}=await D.supabase.from("meetings").select("*");if(t)throw t;if(console.log("Meetings data fetched:",(null===e||void 0===e?void 0:e.length)||0,"records"),!e||0===e.length)return o([]),a(0),void r(!1);const{data:n,error:i}=await D.supabase.from("meetings_contacts").select("\n          meeting_id,\n          contact_id,\n          contacts:contact_id (id, first_name, last_name)\n        ");i&&console.error("Error fetching meetings_contacts:",i),console.log("Fetched contacts data:",(null===n||void 0===n?void 0:n.length)||0,"records");const{data:s,error:c}=await D.supabase.from("meetings_tags").select("meeting_id, tags:tag_id(id, name)");c&&console.error("Error fetching meetings_tags:",c);const u=e.map((e=>{let t=[],o=[];return n&&(t=n.filter((t=>t.meeting_id===e.id)).filter((e=>{if(!e.contacts)return!0;return!`${(e.contacts.first_name||"").toLowerCase()} ${(e.contacts.last_name||"").toLowerCase()}`.trim().includes("simone cimminelli")})).map((e=>{if(!e.contacts)return"Unknown Contact";const t=e.contacts.first_name||"",o=e.contacts.last_name||"";return t&&o?`${t} ${o}`:t||(o||`Contact #${e.contacts.id}`)}))),s&&(o=s.filter((t=>t.meeting_id===e.id)).map((e=>{var t;return(null===(t=e.tags)||void 0===t?void 0:t.name)||"Unknown tag"}))),console.log(`Meeting ${e.id} tags:`,o),{...e,meeting_contacts:t,meeting_name:e.meeting_name||"Untitled Meeting",meeting_date:e.meeting_date||(new Date).toISOString(),meeting_score:e.meeting_score||0,meeting_tags:o,meeting_note:e.meeting_note||"",meeting_record:e.meeting_record||"",meeting_category:e.meeting_category||e.meeting_rationelle||""}})).sort(((e,t)=>{const o=new Date(e.meeting_date),n=new Date(t.meeting_date);return isNaN(o)||isNaN(n)?isNaN(o)?isNaN(n)?0:1:-1:n-o}));console.log("Processed meetings:",u.length),o(u),a(u.length);try{const{data:e,error:t}=await D.supabase.from("tags").select("name");!t&&e&&d(e.map((e=>e.name)))}catch(SM){console.error("Error fetching tags:",SM)}try{const{data:e,error:t}=await D.supabase.from("contacts").select("id, first_name, last_name");!t&&e&&p(e.map((e=>({id:e.id,name:`${e.first_name} ${e.last_name}`}))))}catch(SM){console.error("Error fetching contacts:",SM)}}catch(s){console.error("Error in meeting data processing:",s),l(`Failed to load meetings: ${s.message}`)}finally{r(!1)}},S=(e,t)=>{if(!e||!t)return[];const o=JSON.parse(JSON.stringify(t));o.forEach((e=>{e.meetings=[]}));const n=new Set;return e.forEach((e=>{if(!e.id||n.has(e.id))return;const t=new Date(e.meeting_date);for(let r=0;r<o.length;r++){const i=o[r],a=new Date(i.start),s=new Date(i.end);if(t>=a&&t<=s){i.meetings.push(e),n.add(e.id);break}}})),o.forEach((e=>{e.meetings.sort(((e,t)=>new Date(t.meeting_date)-new Date(e.meeting_date)))})),o};(0,t.useEffect)((()=>{const t=(e=>{const t=uP(e),o=Ye(e),n=hP(t,{weekStartsOn:1}),r=fP(o,{weekStartsOn:1});let i=[],a=n;for(;a<=r;){const t=a,o=fP(a,{weekStartsOn:1}),n=mP(a,{weekStartsOn:1});i.push({weekNumber:n,start:t,end:o,meetings:[],isInCurrentMonth:yP(t,e)||yP(o,e)}),a=vP(a,1)}return i})(b);console.log("Month changed to:",(0,ge.A)(b,"MMMM yyyy")),C(t);uP(b),Ye(b);if(e.length>0){console.log("Filtering meetings for new month:",(0,ge.A)(b,"MMMM yyyy"));const o=e.filter((e=>{const o=new Date(e.meeting_date),n=new Date(t[0].start),r=new Date(t[t.length-1].end);return o>=n&&o<=r}));console.log(`Found ${o.length} meetings in current month's view range`);const n=S(o,t);C(n)}}),[b]),(0,t.useEffect)((()=>{if(e.length>0&&w.length>0){console.log("New meetings data received:",e.length,"meetings");const t=w[0].start,o=w[w.length-1].end,n=e.filter((e=>{if(!e.meeting_date)return!1;const n=new Date(e.meeting_date),r=new Date(t),i=new Date(o);return!isNaN(n.getTime())&&n>=r&&n<=i}));console.log(`Filtering meetings for current view: ${n.length} meetings in range`);const r=w.map((e=>({...e,meetings:[]}))),i=S(n,r);C(i)}}),[e]),(0,t.useEffect)((()=>{_()}),[]);const E=e=>{try{const t=new Date(e);return isNaN(t)?"Invalid date":t.toLocaleDateString("en-GB",{day:"2-digit",month:"2-digit",year:"2-digit"})}catch(SM){return e||"N/A"}},k=e=>{if(!e)return(0,N.jsx)("span",{style:{color:"#9ca3af",fontStyle:"italic",fontSize:"0.75rem"},children:"N/A"});const t={inbox:{label:"Inbox",color:"#3b82f6",bgColor:"#dbeafe"},karma_points:{label:"Karma Points",color:"#8b5cf6",bgColor:"#ede9fe"},dealflow:{label:"Dealflow",color:"#f59e0b",bgColor:"#fef3c7"},portfolio:{label:"Portfolio",color:"#10b981",bgColor:"#d1fae5"},sales:{label:"Sales",color:"#ef4444",bgColor:"#fee2e2"},discovery:{label:"Discovery",color:"#3b82f6",bgColor:"#dbeafe"},follow_up:{label:"Follow Up",color:"#10b981",bgColor:"#d1fae5"},intro:{label:"Introduction",color:"#8b5cf6",bgColor:"#ede9fe"},pitch:{label:"Pitch",color:"#f59e0b",bgColor:"#fef3c7"},demo:{label:"Demo",color:"#06b6d4",bgColor:"#cffafe"},closing:{label:"Closing",color:"#14b8a6",bgColor:"#ccfbf1"},check_in:{label:"Check In",color:"#0ea5e9",bgColor:"#e0f2fe"},networking:{label:"Networking",color:"#7c3aed",bgColor:"#ede9fe"},other:{label:"Other",color:"#6b7280",bgColor:"#f3f4f6"}}[e]||{label:e.charAt(0).toUpperCase()+e.slice(1).replace("_"," "),color:"#6b7280",bgColor:"#f3f4f6"};return(0,N.jsx)(KP,{color:t.bgColor,textColor:t.color,children:(0,N.jsx)(YP,{children:t.label})})},j=e=>e?(e=>{try{return new URL(e),!0}catch(t){return!1}})(e)?(0,N.jsx)(XP,{href:e,target:"_blank",rel:"noopener noreferrer",title:e,children:(0,N.jsx)(B.HaR,{size:18})}):e:(0,N.jsx)("span",{style:{color:"#9ca3af"},children:"N/A"}),A=t=>{if(!t.meeting_tags||0===t.meeting_tags.length)return(0,N.jsx)("span",{style:{color:"#9ca3af",fontStyle:"italic",fontSize:"0.75rem"},children:"No tags"});const n=t.meeting_tags.slice(0,2),r=Math.max(0,t.meeting_tags.length-2);return(0,N.jsxs)(N.Fragment,{children:[n.map(((n,r)=>{const{bg:i,text:a}=(e=>{const t=e.toLowerCase();return t.includes("founder")||t.includes("ceo")||t.includes("owner")||t.includes("compliance")||t.includes("legal")?{bg:"#e5f9ee",text:"#065f46"}:t.includes("finance")||t.includes("accounting")?{bg:"#fef3c7",text:"#92400e"}:t.includes("marketing")||t.includes("sales")?{bg:"#fee2e2",text:"#991b1b"}:t.includes("tech")||t.includes("developer")?{bg:"#dbeafe",text:"#1e40af"}:{bg:"#f3f4f6",text:"#4b5563"}})(n);return(0,N.jsxs)(KP,{color:i,textColor:a,className:"has-remove",children:[(0,N.jsx)(YP,{children:n}),(0,N.jsx)(JP,{onClick:()=>(async(t,n)=>{try{console.log(`Removing tag "${n}" from meeting ${t}`);const{data:r,error:i}=await D.supabase.from("tags").select("id").eq("name",n).single();if(i)return void console.error("Error finding tag:",i);if(!r)return void console.error("Tag not found:",n);const a=r.id;console.log(`Found tag ID ${a} for tag "${n}"`);const{error:s}=await D.supabase.from("meetings_tags").delete().eq("meeting_id",t).eq("tag_id",a);if(s)throw console.error("Error deleting tag connection:",s),s;console.log(`Successfully removed tag "${n}" from meeting ${t}`);const l=e.find((e=>e.id===t));if(l){const r=l.meeting_tags.filter((e=>e!==n));o(e.map((e=>e.id===t?{...e,meeting_tags:r}:e)))}await _()}catch(s){console.error("Error removing tag:",s)}})(t.id,n),children:(0,N.jsx)(B.yGN,{size:12})})]},r)})),r>0&&(0,N.jsxs)(KP,{className:"more",children:["+",r," more"]})]})},R=t=>{if(!t.meeting_contacts||0===t.meeting_contacts.length)return(0,N.jsx)("span",{style:{color:"#9ca3af",fontStyle:"italic",fontSize:"0.75rem"},children:"No attendees"});const n=t.meeting_contacts.slice(0,1),r=Math.max(0,t.meeting_contacts.length-1);return(0,N.jsxs)(N.Fragment,{children:[n.map(((n,r)=>(0,N.jsxs)(KP,{color:"#eef2ff",textColor:"#4338ca",className:"has-remove",children:[(0,N.jsx)(YP,{children:n}),(0,N.jsx)(JP,{onClick:()=>(async(t,n)=>{try{const r=e.find((e=>e.id===t));if(!r)return;const i=r.meeting_contacts.filter((e=>e!==n));o(e.map((e=>e.id===t?{...e,meeting_contacts:i}:e)))}catch(s){console.error("Error removing attendee:",s)}})(t.id,n),children:(0,N.jsx)(B.yGN,{size:12})})]},r))),r>0&&(0,N.jsxs)(KP,{className:"more",children:["+",r," more"]})]})},O=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:60;if(!e)return"No notes";if(e.length<=t)return e;let o=e.substring(0,t).lastIndexOf(" ");return-1===o&&(o=t),`${e.substring(0,o)}...`},T=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new Date;const t={id:null,meeting_name:"New Meeting",meeting_date:(0,ge.A)(e,"yyyy-MM-dd"),meeting_note:"",meeting_record:"",meeting_score:0,meeting_category:"",meeting_contacts:[],meeting_tags:[],created_at:(new Date).toISOString(),updated_at:(new Date).toISOString(),initialTab:"details"};f(t),m(!0)},P=e=>e&&0!==e.length?(0,N.jsxs)(zP,{children:[(0,N.jsx)(HP,{children:(0,N.jsxs)("tr",{children:[(0,N.jsx)("th",{children:"Date"}),(0,N.jsx)("th",{children:"Category"}),(0,N.jsx)("th",{children:"Meeting"}),(0,N.jsx)("th",{children:"Attendees"}),(0,N.jsx)("th",{children:"Tags"}),(0,N.jsx)("th",{children:"Record"}),(0,N.jsx)("th",{children:"Score"}),(0,N.jsx)("th",{children:"Note"})]})}),(0,N.jsx)(BP,{children:e.map(((e,t)=>{return(0,N.jsxs)("tr",{onClick:()=>(e=>{f(e),m(!0)})(e),style:{cursor:"pointer"},children:[(0,N.jsx)(VP,{children:(0,N.jsxs)("div",{className:"cell-content",children:[(0,N.jsx)($P,{children:(0,N.jsx)(B.Ohp,{})}),E(e.meeting_date)]})}),(0,N.jsx)(VP,{children:(0,N.jsx)("div",{className:"cell-content",children:k(e.meeting_category)})}),(0,N.jsx)(VP,{children:(0,N.jsx)("div",{className:"cell-content",children:e.meeting_name||"Untitled Meeting"})}),(0,N.jsx)(VP,{children:(0,N.jsxs)("div",{className:"cell-content",children:[(0,N.jsx)($P,{children:(0,N.jsx)(B.cfS,{})}),(0,N.jsx)(qP,{children:R(e)})]})}),(0,N.jsx)(VP,{children:(0,N.jsx)("div",{className:"cell-content",children:(0,N.jsx)(qP,{children:A(e)})})}),(0,N.jsx)(VP,{children:(0,N.jsxs)("div",{className:"cell-content",children:[(0,N.jsx)($P,{children:(0,N.jsx)(B.jH2,{})}),j(e.meeting_record)]})}),(0,N.jsx)(WP,{children:(o=e.meeting_score||0,(0,N.jsx)("div",{className:"stars",children:[...Array(5)].map(((e,t)=>(0,N.jsx)(B.usP,{style:{fill:t<o?"#f59e0b":"transparent",color:t<o?"#f59e0b":"#d1d5db"}},t)))}))}),(0,N.jsx)(VP,{onClick:t=>((e,t)=>{e.stopPropagation(),f({...t,initialTab:"notes"}),m(!0)})(t,e),children:(0,N.jsxs)("div",{className:"cell-content",children:[(0,N.jsx)($P,{children:(0,N.jsx)(B.mEP,{})}),(0,N.jsx)("div",{style:{whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis",maxWidth:"100%",color:e.meeting_note?"#000":"#9ca3af",fontStyle:e.meeting_note?"normal":"italic",cursor:"pointer"},title:e.meeting_note||"No notes",children:O(e.meeting_note)})]})})]},e.id||t);var o}))})]}):(0,N.jsx)(GP,{children:"No meetings scheduled for this week"});return(0,N.jsxs)(xP,{children:[(0,N.jsx)(wP,{children:(0,N.jsxs)(CP,{children:[(0,N.jsxs)(_P,{children:[(0,N.jsxs)(SP,{children:[(0,N.jsx)(B.wIk,{}),"Planner",!n&&(0,N.jsxs)(EP,{children:["(",i,")"]})]}),(0,N.jsx)(kP,{children:"Schedule and manage your meetings and follow-ups."})]}),(0,N.jsxs)(OP,{onClick:()=>T(),children:[(0,N.jsx)(B.GGD,{size:16}),"New Event"]})]})}),(0,N.jsxs)(AP,{children:[(0,N.jsxs)(RP,{children:[(0,N.jsx)(DP,{onClick:()=>{console.log("Navigating to previous month");const e=function(e,t){return(0,Te.A)(2,arguments),bP(e,-(0,De.A)(t))}(b,1);x(e)},children:(0,N.jsx)(B.irw,{})}),(0,N.jsx)(TP,{children:(0,ge.A)(b,"MMMM yyyy")}),(0,N.jsx)(DP,{onClick:()=>{console.log("Navigating to next month");const e=bP(b,1);x(e)},children:(0,N.jsx)(B.fOo,{})}),(0,N.jsx)(DP,{onClick:()=>{console.log("Navigating to current month"),x(new Date)},style:{marginLeft:"8px",fontSize:"0.75rem",width:"auto",height:"auto",padding:"0.25rem 0.5rem",borderRadius:"0.25rem",backgroundColor:yP(b,new Date)?"#f3f4f6":"#e0f2fe",color:yP(b,new Date)?"#6b7280":"#0284c7"},children:"Today"})]}),(0,N.jsxs)(PP,{children:[w.filter((e=>e.isInCurrentMonth&&e.meetings.length>0)).length," weeks with meetings"]})]}),(0,N.jsxs)(jP,{children:[n?(0,N.jsx)(GP,{children:"Loading meetings..."}):s?(0,N.jsx)(GP,{style:{color:"#ef4444"},children:s}):0===w.length?(0,N.jsx)(GP,{children:"No weeks found for this month"}):w.filter((e=>e.isInCurrentMonth)).sort(((e,t)=>t.weekNumber-e.weekNumber)).map(((e,t)=>{return(0,N.jsxs)(NP,{children:[(0,N.jsxs)(IP,{children:[(0,N.jsxs)(MP,{children:["Week #",e.weekNumber,(0,N.jsxs)(LP,{onClick:()=>(e=>{const t=new Date(e.start),o=new Date;T(t<o?o:t)})(e),children:[(0,N.jsx)(B.GGD,{size:12}),"Add Event"]})]}),(0,N.jsx)(FP,{children:(o=e.start,n=e.end,`${(0,ge.A)(new Date(o),"d/M")} - ${(0,ge.A)(new Date(n),"d/M/yyyy")}`)})]}),P(e.meetings)]},`week-${e.weekNumber}`);var o,n})),(0,N.jsx)(dP,{isOpen:g,onRequestClose:async()=>{f(null),m(!1),await _()},meeting:h})]})]})});function eN(e,t){return function(){return e.apply(t,arguments)}}const{toString:tN}=Object.prototype,{getPrototypeOf:oN}=Object,nN=(rN=Object.create(null),e=>{const t=tN.call(e);return rN[t]||(rN[t]=t.slice(8,-1).toLowerCase())});var rN;const iN=e=>(e=e.toLowerCase(),t=>nN(t)===e),aN=e=>t=>typeof t===e,{isArray:sN}=Array,lN=aN("undefined");const cN=iN("ArrayBuffer");const dN=aN("string"),uN=aN("function"),pN=aN("number"),hN=e=>null!==e&&"object"===typeof e,fN=e=>{if("object"!==nN(e))return!1;const t=oN(e);return(null===t||t===Object.prototype||null===Object.getPrototypeOf(t))&&!(Symbol.toStringTag in e)&&!(Symbol.iterator in e)},gN=iN("Date"),mN=iN("File"),yN=iN("Blob"),vN=iN("FileList"),bN=iN("URLSearchParams"),[xN,wN,CN,_N]=["ReadableStream","Request","Response","Headers"].map(iN);function SN(e,t){let o,n,{allOwnKeys:r=!1}=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};if(null!==e&&"undefined"!==typeof e)if("object"!==typeof e&&(e=[e]),sN(e))for(o=0,n=e.length;o<n;o++)t.call(null,e[o],o,e);else{const n=r?Object.getOwnPropertyNames(e):Object.keys(e),i=n.length;let a;for(o=0;o<i;o++)a=n[o],t.call(null,e[a],a,e)}}function EN(e,t){t=t.toLowerCase();const o=Object.keys(e);let n,r=o.length;for(;r-- >0;)if(n=o[r],t===n.toLowerCase())return n;return null}const kN="undefined"!==typeof globalThis?globalThis:"undefined"!==typeof self?self:"undefined"!==typeof window?window:global,jN=e=>!lN(e)&&e!==kN;const AN=(RN="undefined"!==typeof Uint8Array&&oN(Uint8Array),e=>RN&&e instanceof RN);var RN;const ON=iN("HTMLFormElement"),TN=(e=>{let{hasOwnProperty:t}=e;return(e,o)=>t.call(e,o)})(Object.prototype),DN=iN("RegExp"),PN=(e,t)=>{const o=Object.getOwnPropertyDescriptors(e),n={};SN(o,((o,r)=>{let i;!1!==(i=t(o,r,e))&&(n[r]=i||o)})),Object.defineProperties(e,n)};const NN=iN("AsyncFunction"),IN=((e,t)=>{return e?setImmediate:t?(o=`axios@${Math.random()}`,n=[],kN.addEventListener("message",(e=>{let{source:t,data:r}=e;t===kN&&r===o&&n.length&&n.shift()()}),!1),e=>{n.push(e),kN.postMessage(o,"*")}):e=>setTimeout(e);var o,n})("function"===typeof setImmediate,uN(kN.postMessage)),MN="undefined"!==typeof queueMicrotask?queueMicrotask.bind(kN):"undefined"!==typeof process&&process.nextTick||IN,LN={isArray:sN,isArrayBuffer:cN,isBuffer:function(e){return null!==e&&!lN(e)&&null!==e.constructor&&!lN(e.constructor)&&uN(e.constructor.isBuffer)&&e.constructor.isBuffer(e)},isFormData:e=>{let t;return e&&("function"===typeof FormData&&e instanceof FormData||uN(e.append)&&("formdata"===(t=nN(e))||"object"===t&&uN(e.toString)&&"[object FormData]"===e.toString()))},isArrayBufferView:function(e){let t;return t="undefined"!==typeof ArrayBuffer&&ArrayBuffer.isView?ArrayBuffer.isView(e):e&&e.buffer&&cN(e.buffer),t},isString:dN,isNumber:pN,isBoolean:e=>!0===e||!1===e,isObject:hN,isPlainObject:fN,isReadableStream:xN,isRequest:wN,isResponse:CN,isHeaders:_N,isUndefined:lN,isDate:gN,isFile:mN,isBlob:yN,isRegExp:DN,isFunction:uN,isStream:e=>hN(e)&&uN(e.pipe),isURLSearchParams:bN,isTypedArray:AN,isFileList:vN,forEach:SN,merge:function e(){const{caseless:t}=jN(this)&&this||{},o={},n=(n,r)=>{const i=t&&EN(o,r)||r;fN(o[i])&&fN(n)?o[i]=e(o[i],n):fN(n)?o[i]=e({},n):sN(n)?o[i]=n.slice():o[i]=n};for(let r=0,i=arguments.length;r<i;r++)arguments[r]&&SN(arguments[r],n);return o},extend:function(e,t,o){let{allOwnKeys:n}=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};return SN(t,((t,n)=>{o&&uN(t)?e[n]=eN(t,o):e[n]=t}),{allOwnKeys:n}),e},trim:e=>e.trim?e.trim():e.replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,""),stripBOM:e=>(65279===e.charCodeAt(0)&&(e=e.slice(1)),e),inherits:(e,t,o,n)=>{e.prototype=Object.create(t.prototype,n),e.prototype.constructor=e,Object.defineProperty(e,"super",{value:t.prototype}),o&&Object.assign(e.prototype,o)},toFlatObject:(e,t,o,n)=>{let r,i,a;const s={};if(t=t||{},null==e)return t;do{for(r=Object.getOwnPropertyNames(e),i=r.length;i-- >0;)a=r[i],n&&!n(a,e,t)||s[a]||(t[a]=e[a],s[a]=!0);e=!1!==o&&oN(e)}while(e&&(!o||o(e,t))&&e!==Object.prototype);return t},kindOf:nN,kindOfTest:iN,endsWith:(e,t,o)=>{e=String(e),(void 0===o||o>e.length)&&(o=e.length),o-=t.length;const n=e.indexOf(t,o);return-1!==n&&n===o},toArray:e=>{if(!e)return null;if(sN(e))return e;let t=e.length;if(!pN(t))return null;const o=new Array(t);for(;t-- >0;)o[t]=e[t];return o},forEachEntry:(e,t)=>{const o=(e&&e[Symbol.iterator]).call(e);let n;for(;(n=o.next())&&!n.done;){const o=n.value;t.call(e,o[0],o[1])}},matchAll:(e,t)=>{let o;const n=[];for(;null!==(o=e.exec(t));)n.push(o);return n},isHTMLForm:ON,hasOwnProperty:TN,hasOwnProp:TN,reduceDescriptors:PN,freezeMethods:e=>{PN(e,((t,o)=>{if(uN(e)&&-1!==["arguments","caller","callee"].indexOf(o))return!1;const n=e[o];uN(n)&&(t.enumerable=!1,"writable"in t?t.writable=!1:t.set||(t.set=()=>{throw Error("Can not rewrite read-only method '"+o+"'")}))}))},toObjectSet:(e,t)=>{const o={},n=e=>{e.forEach((e=>{o[e]=!0}))};return sN(e)?n(e):n(String(e).split(t)),o},toCamelCase:e=>e.toLowerCase().replace(/[-_\s]([a-z\d])(\w*)/g,(function(e,t,o){return t.toUpperCase()+o})),noop:()=>{},toFiniteNumber:(e,t)=>null!=e&&Number.isFinite(e=+e)?e:t,findKey:EN,global:kN,isContextDefined:jN,isSpecCompliantForm:function(e){return!!(e&&uN(e.append)&&"FormData"===e[Symbol.toStringTag]&&e[Symbol.iterator])},toJSONObject:e=>{const t=new Array(10),o=(e,n)=>{if(hN(e)){if(t.indexOf(e)>=0)return;if(!("toJSON"in e)){t[n]=e;const r=sN(e)?[]:{};return SN(e,((e,t)=>{const i=o(e,n+1);!lN(i)&&(r[t]=i)})),t[n]=void 0,r}}return e};return o(e,0)},isAsyncFn:NN,isThenable:e=>e&&(hN(e)||uN(e))&&uN(e.then)&&uN(e.catch),setImmediate:IN,asap:MN};function FN(e,t,o,n,r){Error.call(this),Error.captureStackTrace?Error.captureStackTrace(this,this.constructor):this.stack=(new Error).stack,this.message=e,this.name="AxiosError",t&&(this.code=t),o&&(this.config=o),n&&(this.request=n),r&&(this.response=r,this.status=r.status?r.status:null)}LN.inherits(FN,Error,{toJSON:function(){return{message:this.message,name:this.name,description:this.description,number:this.number,fileName:this.fileName,lineNumber:this.lineNumber,columnNumber:this.columnNumber,stack:this.stack,config:LN.toJSONObject(this.config),code:this.code,status:this.status}}});const GN=FN.prototype,zN={};["ERR_BAD_OPTION_VALUE","ERR_BAD_OPTION","ECONNABORTED","ETIMEDOUT","ERR_NETWORK","ERR_FR_TOO_MANY_REDIRECTS","ERR_DEPRECATED","ERR_BAD_RESPONSE","ERR_BAD_REQUEST","ERR_CANCELED","ERR_NOT_SUPPORT","ERR_INVALID_URL"].forEach((e=>{zN[e]={value:e}})),Object.defineProperties(FN,zN),Object.defineProperty(GN,"isAxiosError",{value:!0}),FN.from=(e,t,o,n,r,i)=>{const a=Object.create(GN);return LN.toFlatObject(e,a,(function(e){return e!==Error.prototype}),(e=>"isAxiosError"!==e)),FN.call(a,e.message,t,o,n,r),a.cause=e,a.name=e.name,i&&Object.assign(a,i),a};const HN=FN;function BN(e){return LN.isPlainObject(e)||LN.isArray(e)}function VN(e){return LN.endsWith(e,"[]")?e.slice(0,-2):e}function $N(e,t,o){return e?e.concat(t).map((function(e,t){return e=VN(e),!o&&t?"["+e+"]":e})).join(o?".":""):t}const UN=LN.toFlatObject(LN,{},null,(function(e){return/^is[A-Z]/.test(e)}));const WN=function(e,t,o){if(!LN.isObject(e))throw new TypeError("target must be an object");t=t||new FormData;const n=(o=LN.toFlatObject(o,{metaTokens:!0,dots:!1,indexes:!1},!1,(function(e,t){return!LN.isUndefined(t[e])}))).metaTokens,r=o.visitor||c,i=o.dots,a=o.indexes,s=(o.Blob||"undefined"!==typeof Blob&&Blob)&&LN.isSpecCompliantForm(t);if(!LN.isFunction(r))throw new TypeError("visitor must be a function");function l(e){if(null===e)return"";if(LN.isDate(e))return e.toISOString();if(!s&&LN.isBlob(e))throw new HN("Blob is not supported. Use a Buffer instead.");return LN.isArrayBuffer(e)||LN.isTypedArray(e)?s&&"function"===typeof Blob?new Blob([e]):Buffer.from(e):e}function c(e,o,r){let s=e;if(e&&!r&&"object"===typeof e)if(LN.endsWith(o,"{}"))o=n?o:o.slice(0,-2),e=JSON.stringify(e);else if(LN.isArray(e)&&function(e){return LN.isArray(e)&&!e.some(BN)}(e)||(LN.isFileList(e)||LN.endsWith(o,"[]"))&&(s=LN.toArray(e)))return o=VN(o),s.forEach((function(e,n){!LN.isUndefined(e)&&null!==e&&t.append(!0===a?$N([o],n,i):null===a?o:o+"[]",l(e))})),!1;return!!BN(e)||(t.append($N(r,o,i),l(e)),!1)}const d=[],u=Object.assign(UN,{defaultVisitor:c,convertValue:l,isVisitable:BN});if(!LN.isObject(e))throw new TypeError("data must be an object");return function e(o,n){if(!LN.isUndefined(o)){if(-1!==d.indexOf(o))throw Error("Circular reference detected in "+n.join("."));d.push(o),LN.forEach(o,(function(o,i){!0===(!(LN.isUndefined(o)||null===o)&&r.call(t,o,LN.isString(i)?i.trim():i,n,u))&&e(o,n?n.concat(i):[i])})),d.pop()}}(e),t};function qN(e){const t={"!":"%21","'":"%27","(":"%28",")":"%29","~":"%7E","%20":"+","%00":"\0"};return encodeURIComponent(e).replace(/[!'()~]|%20|%00/g,(function(e){return t[e]}))}function KN(e,t){this._pairs=[],e&&WN(e,this,t)}const YN=KN.prototype;YN.append=function(e,t){this._pairs.push([e,t])},YN.toString=function(e){const t=e?function(t){return e.call(this,t,qN)}:qN;return this._pairs.map((function(e){return t(e[0])+"="+t(e[1])}),"").join("&")};const JN=KN;function XN(e){return encodeURIComponent(e).replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",").replace(/%20/g,"+").replace(/%5B/gi,"[").replace(/%5D/gi,"]")}function QN(e,t,o){if(!t)return e;const n=o&&o.encode||XN;LN.isFunction(o)&&(o={serialize:o});const r=o&&o.serialize;let i;if(i=r?r(t,o):LN.isURLSearchParams(t)?t.toString():new JN(t,o).toString(n),i){const t=e.indexOf("#");-1!==t&&(e=e.slice(0,t)),e+=(-1===e.indexOf("?")?"?":"&")+i}return e}const ZN=class{constructor(){this.handlers=[]}use(e,t,o){return this.handlers.push({fulfilled:e,rejected:t,synchronous:!!o&&o.synchronous,runWhen:o?o.runWhen:null}),this.handlers.length-1}eject(e){this.handlers[e]&&(this.handlers[e]=null)}clear(){this.handlers&&(this.handlers=[])}forEach(e){LN.forEach(this.handlers,(function(t){null!==t&&e(t)}))}},eI={silentJSONParsing:!0,forcedJSONParsing:!0,clarifyTimeoutError:!1},tI={isBrowser:!0,classes:{URLSearchParams:"undefined"!==typeof URLSearchParams?URLSearchParams:JN,FormData:"undefined"!==typeof FormData?FormData:null,Blob:"undefined"!==typeof Blob?Blob:null},protocols:["http","https","file","blob","url","data"]},oI="undefined"!==typeof window&&"undefined"!==typeof document,nI="object"===typeof navigator&&navigator||void 0,rI=oI&&(!nI||["ReactNative","NativeScript","NS"].indexOf(nI.product)<0),iI="undefined"!==typeof WorkerGlobalScope&&self instanceof WorkerGlobalScope&&"function"===typeof self.importScripts,aI=oI&&window.location.href||"http://localhost",sI={...e,...tI};const lI=function(e){function t(e,o,n,r){let i=e[r++];if("__proto__"===i)return!0;const a=Number.isFinite(+i),s=r>=e.length;if(i=!i&&LN.isArray(n)?n.length:i,s)return LN.hasOwnProp(n,i)?n[i]=[n[i],o]:n[i]=o,!a;n[i]&&LN.isObject(n[i])||(n[i]=[]);return t(e,o,n[i],r)&&LN.isArray(n[i])&&(n[i]=function(e){const t={},o=Object.keys(e);let n;const r=o.length;let i;for(n=0;n<r;n++)i=o[n],t[i]=e[i];return t}(n[i])),!a}if(LN.isFormData(e)&&LN.isFunction(e.entries)){const o={};return LN.forEachEntry(e,((e,n)=>{t(function(e){return LN.matchAll(/\w+|\[(\w*)]/g,e).map((e=>"[]"===e[0]?"":e[1]||e[0]))}(e),n,o,0)})),o}return null};const cI={transitional:eI,adapter:["xhr","http","fetch"],transformRequest:[function(e,t){const o=t.getContentType()||"",n=o.indexOf("application/json")>-1,r=LN.isObject(e);r&&LN.isHTMLForm(e)&&(e=new FormData(e));if(LN.isFormData(e))return n?JSON.stringify(lI(e)):e;if(LN.isArrayBuffer(e)||LN.isBuffer(e)||LN.isStream(e)||LN.isFile(e)||LN.isBlob(e)||LN.isReadableStream(e))return e;if(LN.isArrayBufferView(e))return e.buffer;if(LN.isURLSearchParams(e))return t.setContentType("application/x-www-form-urlencoded;charset=utf-8",!1),e.toString();let i;if(r){if(o.indexOf("application/x-www-form-urlencoded")>-1)return function(e,t){return WN(e,new sI.classes.URLSearchParams,Object.assign({visitor:function(e,t,o,n){return sI.isNode&&LN.isBuffer(e)?(this.append(t,e.toString("base64")),!1):n.defaultVisitor.apply(this,arguments)}},t))}(e,this.formSerializer).toString();if((i=LN.isFileList(e))||o.indexOf("multipart/form-data")>-1){const t=this.env&&this.env.FormData;return WN(i?{"files[]":e}:e,t&&new t,this.formSerializer)}}return r||n?(t.setContentType("application/json",!1),function(e,t,o){if(LN.isString(e))try{return(t||JSON.parse)(e),LN.trim(e)}catch(SM){if("SyntaxError"!==SM.name)throw SM}return(o||JSON.stringify)(e)}(e)):e}],transformResponse:[function(e){const t=this.transitional||cI.transitional,o=t&&t.forcedJSONParsing,n="json"===this.responseType;if(LN.isResponse(e)||LN.isReadableStream(e))return e;if(e&&LN.isString(e)&&(o&&!this.responseType||n)){const o=!(t&&t.silentJSONParsing)&&n;try{return JSON.parse(e)}catch(SM){if(o){if("SyntaxError"===SM.name)throw HN.from(SM,HN.ERR_BAD_RESPONSE,this,null,this.response);throw SM}}}return e}],timeout:0,xsrfCookieName:"XSRF-TOKEN",xsrfHeaderName:"X-XSRF-TOKEN",maxContentLength:-1,maxBodyLength:-1,env:{FormData:sI.classes.FormData,Blob:sI.classes.Blob},validateStatus:function(e){return e>=200&&e<300},headers:{common:{Accept:"application/json, text/plain, */*","Content-Type":void 0}}};LN.forEach(["delete","get","head","post","put","patch"],(e=>{cI.headers[e]={}}));const dI=cI,uI=LN.toObjectSet(["age","authorization","content-length","content-type","etag","expires","from","host","if-modified-since","if-unmodified-since","last-modified","location","max-forwards","proxy-authorization","referer","retry-after","user-agent"]),pI=Symbol("internals");function hI(e){return e&&String(e).trim().toLowerCase()}function fI(e){return!1===e||null==e?e:LN.isArray(e)?e.map(fI):String(e)}function gI(e,t,o,n,r){return LN.isFunction(n)?n.call(this,t,o):(r&&(t=o),LN.isString(t)?LN.isString(n)?-1!==t.indexOf(n):LN.isRegExp(n)?n.test(t):void 0:void 0)}class mI{constructor(e){e&&this.set(e)}set(e,t,o){const n=this;function r(e,t,o){const r=hI(t);if(!r)throw new Error("header name must be a non-empty string");const i=LN.findKey(n,r);(!i||void 0===n[i]||!0===o||void 0===o&&!1!==n[i])&&(n[i||t]=fI(e))}const i=(e,t)=>LN.forEach(e,((e,o)=>r(e,o,t)));if(LN.isPlainObject(e)||e instanceof this.constructor)i(e,t);else if(LN.isString(e)&&(e=e.trim())&&!/^[-_a-zA-Z0-9^`|~,!#$%&'*+.]+$/.test(e.trim()))i((e=>{const t={};let o,n,r;return e&&e.split("\n").forEach((function(e){r=e.indexOf(":"),o=e.substring(0,r).trim().toLowerCase(),n=e.substring(r+1).trim(),!o||t[o]&&uI[o]||("set-cookie"===o?t[o]?t[o].push(n):t[o]=[n]:t[o]=t[o]?t[o]+", "+n:n)})),t})(e),t);else if(LN.isHeaders(e))for(const[a,s]of e.entries())r(s,a,o);else null!=e&&r(t,e,o);return this}get(e,t){if(e=hI(e)){const o=LN.findKey(this,e);if(o){const e=this[o];if(!t)return e;if(!0===t)return function(e){const t=Object.create(null),o=/([^\s,;=]+)\s*(?:=\s*([^,;]+))?/g;let n;for(;n=o.exec(e);)t[n[1]]=n[2];return t}(e);if(LN.isFunction(t))return t.call(this,e,o);if(LN.isRegExp(t))return t.exec(e);throw new TypeError("parser must be boolean|regexp|function")}}}has(e,t){if(e=hI(e)){const o=LN.findKey(this,e);return!(!o||void 0===this[o]||t&&!gI(0,this[o],o,t))}return!1}delete(e,t){const o=this;let n=!1;function r(e){if(e=hI(e)){const r=LN.findKey(o,e);!r||t&&!gI(0,o[r],r,t)||(delete o[r],n=!0)}}return LN.isArray(e)?e.forEach(r):r(e),n}clear(e){const t=Object.keys(this);let o=t.length,n=!1;for(;o--;){const r=t[o];e&&!gI(0,this[r],r,e,!0)||(delete this[r],n=!0)}return n}normalize(e){const t=this,o={};return LN.forEach(this,((n,r)=>{const i=LN.findKey(o,r);if(i)return t[i]=fI(n),void delete t[r];const a=e?function(e){return e.trim().toLowerCase().replace(/([a-z\d])(\w*)/g,((e,t,o)=>t.toUpperCase()+o))}(r):String(r).trim();a!==r&&delete t[r],t[a]=fI(n),o[a]=!0})),this}concat(){for(var e=arguments.length,t=new Array(e),o=0;o<e;o++)t[o]=arguments[o];return this.constructor.concat(this,...t)}toJSON(e){const t=Object.create(null);return LN.forEach(this,((o,n)=>{null!=o&&!1!==o&&(t[n]=e&&LN.isArray(o)?o.join(", "):o)})),t}[Symbol.iterator](){return Object.entries(this.toJSON())[Symbol.iterator]()}toString(){return Object.entries(this.toJSON()).map((e=>{let[t,o]=e;return t+": "+o})).join("\n")}get[Symbol.toStringTag](){return"AxiosHeaders"}static from(e){return e instanceof this?e:new this(e)}static concat(e){const t=new this(e);for(var o=arguments.length,n=new Array(o>1?o-1:0),r=1;r<o;r++)n[r-1]=arguments[r];return n.forEach((e=>t.set(e))),t}static accessor(e){const t=(this[pI]=this[pI]={accessors:{}}).accessors,o=this.prototype;function n(e){const n=hI(e);t[n]||(!function(e,t){const o=LN.toCamelCase(" "+t);["get","set","has"].forEach((n=>{Object.defineProperty(e,n+o,{value:function(e,o,r){return this[n].call(this,t,e,o,r)},configurable:!0})}))}(o,e),t[n]=!0)}return LN.isArray(e)?e.forEach(n):n(e),this}}mI.accessor(["Content-Type","Content-Length","Accept","Accept-Encoding","User-Agent","Authorization"]),LN.reduceDescriptors(mI.prototype,((e,t)=>{let{value:o}=e,n=t[0].toUpperCase()+t.slice(1);return{get:()=>o,set(e){this[n]=e}}})),LN.freezeMethods(mI);const yI=mI;function vI(e,t){const o=this||dI,n=t||o,r=yI.from(n.headers);let i=n.data;return LN.forEach(e,(function(e){i=e.call(o,i,r.normalize(),t?t.status:void 0)})),r.normalize(),i}function bI(e){return!(!e||!e.__CANCEL__)}function xI(e,t,o){HN.call(this,null==e?"canceled":e,HN.ERR_CANCELED,t,o),this.name="CanceledError"}LN.inherits(xI,HN,{__CANCEL__:!0});const wI=xI;function CI(e,t,o){const n=o.config.validateStatus;o.status&&n&&!n(o.status)?t(new HN("Request failed with status code "+o.status,[HN.ERR_BAD_REQUEST,HN.ERR_BAD_RESPONSE][Math.floor(o.status/100)-4],o.config,o.request,o)):e(o)}const _I=function(e,t){e=e||10;const o=new Array(e),n=new Array(e);let r,i=0,a=0;return t=void 0!==t?t:1e3,function(s){const l=Date.now(),c=n[a];r||(r=l),o[i]=s,n[i]=l;let d=a,u=0;for(;d!==i;)u+=o[d++],d%=e;if(i=(i+1)%e,i===a&&(a=(a+1)%e),l-r<t)return;const p=c&&l-c;return p?Math.round(1e3*u/p):void 0}};const SI=function(e,t){let o,n,r=0,i=1e3/t;const a=function(t){let i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Date.now();r=i,o=null,n&&(clearTimeout(n),n=null),e.apply(null,t)};return[function(){const e=Date.now(),t=e-r;for(var s=arguments.length,l=new Array(s),c=0;c<s;c++)l[c]=arguments[c];t>=i?a(l,e):(o=l,n||(n=setTimeout((()=>{n=null,a(o)}),i-t)))},()=>o&&a(o)]},EI=function(e,t){let o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:3,n=0;const r=_I(50,250);return SI((o=>{const i=o.loaded,a=o.lengthComputable?o.total:void 0,s=i-n,l=r(s);n=i;e({loaded:i,total:a,progress:a?i/a:void 0,bytes:s,rate:l||void 0,estimated:l&&a&&i<=a?(a-i)/l:void 0,event:o,lengthComputable:null!=a,[t?"download":"upload"]:!0})}),o)},kI=(e,t)=>{const o=null!=e;return[n=>t[0]({lengthComputable:o,total:e,loaded:n}),t[1]]},jI=e=>function(){for(var t=arguments.length,o=new Array(t),n=0;n<t;n++)o[n]=arguments[n];return LN.asap((()=>e(...o)))},AI=sI.hasStandardBrowserEnv?(RI=new URL(sI.origin),OI=sI.navigator&&/(msie|trident)/i.test(sI.navigator.userAgent),e=>(e=new URL(e,sI.origin),RI.protocol===e.protocol&&RI.host===e.host&&(OI||RI.port===e.port))):()=>!0;var RI,OI;const TI=sI.hasStandardBrowserEnv?{write(e,t,o,n,r,i){const a=[e+"="+encodeURIComponent(t)];LN.isNumber(o)&&a.push("expires="+new Date(o).toGMTString()),LN.isString(n)&&a.push("path="+n),LN.isString(r)&&a.push("domain="+r),!0===i&&a.push("secure"),document.cookie=a.join("; ")},read(e){const t=document.cookie.match(new RegExp("(^|;\\s*)("+e+")=([^;]*)"));return t?decodeURIComponent(t[3]):null},remove(e){this.write(e,"",Date.now()-864e5)}}:{write(){},read:()=>null,remove(){}};function DI(e,t,o){let n=!/^([a-z][a-z\d+\-.]*:)?\/\//i.test(t);return e&&(n||0==o)?function(e,t){return t?e.replace(/\/?\/$/,"")+"/"+t.replace(/^\/+/,""):e}(e,t):t}const PI=e=>e instanceof yI?{...e}:e;function NI(e,t){t=t||{};const o={};function n(e,t,o,n){return LN.isPlainObject(e)&&LN.isPlainObject(t)?LN.merge.call({caseless:n},e,t):LN.isPlainObject(t)?LN.merge({},t):LN.isArray(t)?t.slice():t}function r(e,t,o,r){return LN.isUndefined(t)?LN.isUndefined(e)?void 0:n(void 0,e,0,r):n(e,t,0,r)}function i(e,t){if(!LN.isUndefined(t))return n(void 0,t)}function a(e,t){return LN.isUndefined(t)?LN.isUndefined(e)?void 0:n(void 0,e):n(void 0,t)}function s(o,r,i){return i in t?n(o,r):i in e?n(void 0,o):void 0}const l={url:i,method:i,data:i,baseURL:a,transformRequest:a,transformResponse:a,paramsSerializer:a,timeout:a,timeoutMessage:a,withCredentials:a,withXSRFToken:a,adapter:a,responseType:a,xsrfCookieName:a,xsrfHeaderName:a,onUploadProgress:a,onDownloadProgress:a,decompress:a,maxContentLength:a,maxBodyLength:a,beforeRedirect:a,transport:a,httpAgent:a,httpsAgent:a,cancelToken:a,socketPath:a,responseEncoding:a,validateStatus:s,headers:(e,t,o)=>r(PI(e),PI(t),0,!0)};return LN.forEach(Object.keys(Object.assign({},e,t)),(function(n){const i=l[n]||r,a=i(e[n],t[n],n);LN.isUndefined(a)&&i!==s||(o[n]=a)})),o}const II=e=>{const t=NI({},e);let o,{data:n,withXSRFToken:r,xsrfHeaderName:i,xsrfCookieName:a,headers:s,auth:l}=t;if(t.headers=s=yI.from(s),t.url=QN(DI(t.baseURL,t.url,t.allowAbsoluteUrls),e.params,e.paramsSerializer),l&&s.set("Authorization","Basic "+btoa((l.username||"")+":"+(l.password?unescape(encodeURIComponent(l.password)):""))),LN.isFormData(n))if(sI.hasStandardBrowserEnv||sI.hasStandardBrowserWebWorkerEnv)s.setContentType(void 0);else if(!1!==(o=s.getContentType())){const[e,...t]=o?o.split(";").map((e=>e.trim())).filter(Boolean):[];s.setContentType([e||"multipart/form-data",...t].join("; "))}if(sI.hasStandardBrowserEnv&&(r&&LN.isFunction(r)&&(r=r(t)),r||!1!==r&&AI(t.url))){const e=i&&a&&TI.read(a);e&&s.set(i,e)}return t},MI="undefined"!==typeof XMLHttpRequest&&function(e){return new Promise((function(t,o){const n=II(e);let r=n.data;const i=yI.from(n.headers).normalize();let a,s,l,c,d,{responseType:u,onUploadProgress:p,onDownloadProgress:h}=n;function f(){c&&c(),d&&d(),n.cancelToken&&n.cancelToken.unsubscribe(a),n.signal&&n.signal.removeEventListener("abort",a)}let g=new XMLHttpRequest;function m(){if(!g)return;const n=yI.from("getAllResponseHeaders"in g&&g.getAllResponseHeaders());CI((function(e){t(e),f()}),(function(e){o(e),f()}),{data:u&&"text"!==u&&"json"!==u?g.response:g.responseText,status:g.status,statusText:g.statusText,headers:n,config:e,request:g}),g=null}g.open(n.method.toUpperCase(),n.url,!0),g.timeout=n.timeout,"onloadend"in g?g.onloadend=m:g.onreadystatechange=function(){g&&4===g.readyState&&(0!==g.status||g.responseURL&&0===g.responseURL.indexOf("file:"))&&setTimeout(m)},g.onabort=function(){g&&(o(new HN("Request aborted",HN.ECONNABORTED,e,g)),g=null)},g.onerror=function(){o(new HN("Network Error",HN.ERR_NETWORK,e,g)),g=null},g.ontimeout=function(){let t=n.timeout?"timeout of "+n.timeout+"ms exceeded":"timeout exceeded";const r=n.transitional||eI;n.timeoutErrorMessage&&(t=n.timeoutErrorMessage),o(new HN(t,r.clarifyTimeoutError?HN.ETIMEDOUT:HN.ECONNABORTED,e,g)),g=null},void 0===r&&i.setContentType(null),"setRequestHeader"in g&&LN.forEach(i.toJSON(),(function(e,t){g.setRequestHeader(t,e)})),LN.isUndefined(n.withCredentials)||(g.withCredentials=!!n.withCredentials),u&&"json"!==u&&(g.responseType=n.responseType),h&&([l,d]=EI(h,!0),g.addEventListener("progress",l)),p&&g.upload&&([s,c]=EI(p),g.upload.addEventListener("progress",s),g.upload.addEventListener("loadend",c)),(n.cancelToken||n.signal)&&(a=t=>{g&&(o(!t||t.type?new wI(null,e,g):t),g.abort(),g=null)},n.cancelToken&&n.cancelToken.subscribe(a),n.signal&&(n.signal.aborted?a():n.signal.addEventListener("abort",a)));const y=function(e){const t=/^([-+\w]{1,25})(:?\/\/|:)/.exec(e);return t&&t[1]||""}(n.url);y&&-1===sI.protocols.indexOf(y)?o(new HN("Unsupported protocol "+y+":",HN.ERR_BAD_REQUEST,e)):g.send(r||null)}))},LI=(e,t)=>{const{length:o}=e=e?e.filter(Boolean):[];if(t||o){let o,n=new AbortController;const r=function(e){if(!o){o=!0,a();const t=e instanceof Error?e:this.reason;n.abort(t instanceof HN?t:new wI(t instanceof Error?t.message:t))}};let i=t&&setTimeout((()=>{i=null,r(new HN(`timeout ${t} of ms exceeded`,HN.ETIMEDOUT))}),t);const a=()=>{e&&(i&&clearTimeout(i),i=null,e.forEach((e=>{e.unsubscribe?e.unsubscribe(r):e.removeEventListener("abort",r)})),e=null)};e.forEach((e=>e.addEventListener("abort",r)));const{signal:s}=n;return s.unsubscribe=()=>LN.asap(a),s}},FI=function*(e,t){let o=e.byteLength;if(!t||o<t)return void(yield e);let n,r=0;for(;r<o;)n=r+t,yield e.slice(r,n),r=n},GI=async function*(e){if(e[Symbol.asyncIterator])return void(yield*e);const t=e.getReader();try{for(;;){const{done:e,value:o}=await t.read();if(e)break;yield o}}finally{await t.cancel()}},zI=(e,t,o,n)=>{const r=async function*(e,t){for await(const o of GI(e))yield*FI(o,t)}(e,t);let i,a=0,s=e=>{i||(i=!0,n&&n(e))};return new ReadableStream({async pull(e){try{const{done:t,value:n}=await r.next();if(t)return s(),void e.close();let i=n.byteLength;if(o){let e=a+=i;o(e)}e.enqueue(new Uint8Array(n))}catch(t){throw s(t),t}},cancel:e=>(s(e),r.return())},{highWaterMark:2})},HI="function"===typeof fetch&&"function"===typeof Request&&"function"===typeof Response,BI=HI&&"function"===typeof ReadableStream,VI=HI&&("function"===typeof TextEncoder?($I=new TextEncoder,e=>$I.encode(e)):async e=>new Uint8Array(await new Response(e).arrayBuffer()));var $I;const UI=function(e){try{for(var t=arguments.length,o=new Array(t>1?t-1:0),n=1;n<t;n++)o[n-1]=arguments[n];return!!e(...o)}catch(SM){return!1}},WI=BI&&UI((()=>{let e=!1;const t=new Request(sI.origin,{body:new ReadableStream,method:"POST",get duplex(){return e=!0,"half"}}).headers.has("Content-Type");return e&&!t})),qI=BI&&UI((()=>LN.isReadableStream(new Response("").body))),KI={stream:qI&&(e=>e.body)};var YI;HI&&(YI=new Response,["text","arrayBuffer","blob","formData","stream"].forEach((e=>{!KI[e]&&(KI[e]=LN.isFunction(YI[e])?t=>t[e]():(t,o)=>{throw new HN(`Response type '${e}' is not supported`,HN.ERR_NOT_SUPPORT,o)})})));const JI=async(e,t)=>{const o=LN.toFiniteNumber(e.getContentLength());return null==o?(async e=>{if(null==e)return 0;if(LN.isBlob(e))return e.size;if(LN.isSpecCompliantForm(e)){const t=new Request(sI.origin,{method:"POST",body:e});return(await t.arrayBuffer()).byteLength}return LN.isArrayBufferView(e)||LN.isArrayBuffer(e)?e.byteLength:(LN.isURLSearchParams(e)&&(e+=""),LN.isString(e)?(await VI(e)).byteLength:void 0)})(t):o},XI=HI&&(async e=>{let{url:t,method:o,data:n,signal:r,cancelToken:i,timeout:a,onDownloadProgress:s,onUploadProgress:l,responseType:c,headers:d,withCredentials:u="same-origin",fetchOptions:p}=II(e);c=c?(c+"").toLowerCase():"text";let h,f=LI([r,i&&i.toAbortSignal()],a);const g=f&&f.unsubscribe&&(()=>{f.unsubscribe()});let m;try{if(l&&WI&&"get"!==o&&"head"!==o&&0!==(m=await JI(d,n))){let e,o=new Request(t,{method:"POST",body:n,duplex:"half"});if(LN.isFormData(n)&&(e=o.headers.get("content-type"))&&d.setContentType(e),o.body){const[e,t]=kI(m,EI(jI(l)));n=zI(o.body,65536,e,t)}}LN.isString(u)||(u=u?"include":"omit");const r="credentials"in Request.prototype;h=new Request(t,{...p,signal:f,method:o.toUpperCase(),headers:d.normalize().toJSON(),body:n,duplex:"half",credentials:r?u:void 0});let i=await fetch(h);const a=qI&&("stream"===c||"response"===c);if(qI&&(s||a&&g)){const e={};["status","statusText","headers"].forEach((t=>{e[t]=i[t]}));const t=LN.toFiniteNumber(i.headers.get("content-length")),[o,n]=s&&kI(t,EI(jI(s),!0))||[];i=new Response(zI(i.body,65536,o,(()=>{n&&n(),g&&g()})),e)}c=c||"text";let y=await KI[LN.findKey(KI,c)||"text"](i,e);return!a&&g&&g(),await new Promise(((t,o)=>{CI(t,o,{data:y,headers:yI.from(i.headers),status:i.status,statusText:i.statusText,config:e,request:h})}))}catch(y){if(g&&g(),y&&"TypeError"===y.name&&/fetch/i.test(y.message))throw Object.assign(new HN("Network Error",HN.ERR_NETWORK,e,h),{cause:y.cause||y});throw HN.from(y,y&&y.code,e,h)}}),QI={http:null,xhr:MI,fetch:XI};LN.forEach(QI,((e,t)=>{if(e){try{Object.defineProperty(e,"name",{value:t})}catch(SM){}Object.defineProperty(e,"adapterName",{value:t})}}));const ZI=e=>`- ${e}`,eM=e=>LN.isFunction(e)||null===e||!1===e,tM=e=>{e=LN.isArray(e)?e:[e];const{length:t}=e;let o,n;const r={};for(let i=0;i<t;i++){let t;if(o=e[i],n=o,!eM(o)&&(n=QI[(t=String(o)).toLowerCase()],void 0===n))throw new HN(`Unknown adapter '${t}'`);if(n)break;r[t||"#"+i]=n}if(!n){const e=Object.entries(r).map((e=>{let[t,o]=e;return`adapter ${t} `+(!1===o?"is not supported by the environment":"is not available in the build")}));let o=t?e.length>1?"since :\n"+e.map(ZI).join("\n"):" "+ZI(e[0]):"as no adapter specified";throw new HN("There is no suitable adapter to dispatch the request "+o,"ERR_NOT_SUPPORT")}return n};function oM(e){if(e.cancelToken&&e.cancelToken.throwIfRequested(),e.signal&&e.signal.aborted)throw new wI(null,e)}function nM(e){oM(e),e.headers=yI.from(e.headers),e.data=vI.call(e,e.transformRequest),-1!==["post","put","patch"].indexOf(e.method)&&e.headers.setContentType("application/x-www-form-urlencoded",!1);return tM(e.adapter||dI.adapter)(e).then((function(t){return oM(e),t.data=vI.call(e,e.transformResponse,t),t.headers=yI.from(t.headers),t}),(function(t){return bI(t)||(oM(e),t&&t.response&&(t.response.data=vI.call(e,e.transformResponse,t.response),t.response.headers=yI.from(t.response.headers))),Promise.reject(t)}))}const rM="1.8.4",iM={};["object","boolean","number","function","string","symbol"].forEach(((e,t)=>{iM[e]=function(o){return typeof o===e||"a"+(t<1?"n ":" ")+e}}));const aM={};iM.transitional=function(e,t,o){function n(e,t){return"[Axios v1.8.4] Transitional option '"+e+"'"+t+(o?". "+o:"")}return(o,r,i)=>{if(!1===e)throw new HN(n(r," has been removed"+(t?" in "+t:"")),HN.ERR_DEPRECATED);return t&&!aM[r]&&(aM[r]=!0,console.warn(n(r," has been deprecated since v"+t+" and will be removed in the near future"))),!e||e(o,r,i)}},iM.spelling=function(e){return(t,o)=>(console.warn(`${o} is likely a misspelling of ${e}`),!0)};const sM={assertOptions:function(e,t,o){if("object"!==typeof e)throw new HN("options must be an object",HN.ERR_BAD_OPTION_VALUE);const n=Object.keys(e);let r=n.length;for(;r-- >0;){const i=n[r],a=t[i];if(a){const t=e[i],o=void 0===t||a(t,i,e);if(!0!==o)throw new HN("option "+i+" must be "+o,HN.ERR_BAD_OPTION_VALUE)}else if(!0!==o)throw new HN("Unknown option "+i,HN.ERR_BAD_OPTION)}},validators:iM},lM=sM.validators;class cM{constructor(e){this.defaults=e,this.interceptors={request:new ZN,response:new ZN}}async request(e,t){try{return await this._request(e,t)}catch(o){if(o instanceof Error){let e={};Error.captureStackTrace?Error.captureStackTrace(e):e=new Error;const t=e.stack?e.stack.replace(/^.+\n/,""):"";try{o.stack?t&&!String(o.stack).endsWith(t.replace(/^.+\n.+\n/,""))&&(o.stack+="\n"+t):o.stack=t}catch(SM){}}throw o}}_request(e,t){"string"===typeof e?(t=t||{}).url=e:t=e||{},t=NI(this.defaults,t);const{transitional:o,paramsSerializer:n,headers:r}=t;void 0!==o&&sM.assertOptions(o,{silentJSONParsing:lM.transitional(lM.boolean),forcedJSONParsing:lM.transitional(lM.boolean),clarifyTimeoutError:lM.transitional(lM.boolean)},!1),null!=n&&(LN.isFunction(n)?t.paramsSerializer={serialize:n}:sM.assertOptions(n,{encode:lM.function,serialize:lM.function},!0)),void 0!==t.allowAbsoluteUrls||(void 0!==this.defaults.allowAbsoluteUrls?t.allowAbsoluteUrls=this.defaults.allowAbsoluteUrls:t.allowAbsoluteUrls=!0),sM.assertOptions(t,{baseUrl:lM.spelling("baseURL"),withXsrfToken:lM.spelling("withXSRFToken")},!0),t.method=(t.method||this.defaults.method||"get").toLowerCase();let i=r&&LN.merge(r.common,r[t.method]);r&&LN.forEach(["delete","get","head","post","put","patch","common"],(e=>{delete r[e]})),t.headers=yI.concat(i,r);const a=[];let s=!0;this.interceptors.request.forEach((function(e){"function"===typeof e.runWhen&&!1===e.runWhen(t)||(s=s&&e.synchronous,a.unshift(e.fulfilled,e.rejected))}));const l=[];let c;this.interceptors.response.forEach((function(e){l.push(e.fulfilled,e.rejected)}));let d,u=0;if(!s){const e=[nM.bind(this),void 0];for(e.unshift.apply(e,a),e.push.apply(e,l),d=e.length,c=Promise.resolve(t);u<d;)c=c.then(e[u++],e[u++]);return c}d=a.length;let p=t;for(u=0;u<d;){const e=a[u++],t=a[u++];try{p=e(p)}catch(h){t.call(this,h);break}}try{c=nM.call(this,p)}catch(h){return Promise.reject(h)}for(u=0,d=l.length;u<d;)c=c.then(l[u++],l[u++]);return c}getUri(e){return QN(DI((e=NI(this.defaults,e)).baseURL,e.url,e.allowAbsoluteUrls),e.params,e.paramsSerializer)}}LN.forEach(["delete","get","head","options"],(function(e){cM.prototype[e]=function(t,o){return this.request(NI(o||{},{method:e,url:t,data:(o||{}).data}))}})),LN.forEach(["post","put","patch"],(function(e){function t(t){return function(o,n,r){return this.request(NI(r||{},{method:e,headers:t?{"Content-Type":"multipart/form-data"}:{},url:o,data:n}))}}cM.prototype[e]=t(),cM.prototype[e+"Form"]=t(!0)}));const dM=cM;class uM{constructor(e){if("function"!==typeof e)throw new TypeError("executor must be a function.");let t;this.promise=new Promise((function(e){t=e}));const o=this;this.promise.then((e=>{if(!o._listeners)return;let t=o._listeners.length;for(;t-- >0;)o._listeners[t](e);o._listeners=null})),this.promise.then=e=>{let t;const n=new Promise((e=>{o.subscribe(e),t=e})).then(e);return n.cancel=function(){o.unsubscribe(t)},n},e((function(e,n,r){o.reason||(o.reason=new wI(e,n,r),t(o.reason))}))}throwIfRequested(){if(this.reason)throw this.reason}subscribe(e){this.reason?e(this.reason):this._listeners?this._listeners.push(e):this._listeners=[e]}unsubscribe(e){if(!this._listeners)return;const t=this._listeners.indexOf(e);-1!==t&&this._listeners.splice(t,1)}toAbortSignal(){const e=new AbortController,t=t=>{e.abort(t)};return this.subscribe(t),e.signal.unsubscribe=()=>this.unsubscribe(t),e.signal}static source(){let e;return{token:new uM((function(t){e=t})),cancel:e}}}const pM=uM;const hM={Continue:100,SwitchingProtocols:101,Processing:102,EarlyHints:103,Ok:200,Created:201,Accepted:202,NonAuthoritativeInformation:203,NoContent:204,ResetContent:205,PartialContent:206,MultiStatus:207,AlreadyReported:208,ImUsed:226,MultipleChoices:300,MovedPermanently:301,Found:302,SeeOther:303,NotModified:304,UseProxy:305,Unused:306,TemporaryRedirect:307,PermanentRedirect:308,BadRequest:400,Unauthorized:401,PaymentRequired:402,Forbidden:403,NotFound:404,MethodNotAllowed:405,NotAcceptable:406,ProxyAuthenticationRequired:407,RequestTimeout:408,Conflict:409,Gone:410,LengthRequired:411,PreconditionFailed:412,PayloadTooLarge:413,UriTooLong:414,UnsupportedMediaType:415,RangeNotSatisfiable:416,ExpectationFailed:417,ImATeapot:418,MisdirectedRequest:421,UnprocessableEntity:422,Locked:423,FailedDependency:424,TooEarly:425,UpgradeRequired:426,PreconditionRequired:428,TooManyRequests:429,RequestHeaderFieldsTooLarge:431,UnavailableForLegalReasons:451,InternalServerError:500,NotImplemented:501,BadGateway:502,ServiceUnavailable:503,GatewayTimeout:504,HttpVersionNotSupported:505,VariantAlsoNegotiates:506,InsufficientStorage:507,LoopDetected:508,NotExtended:510,NetworkAuthenticationRequired:511};Object.entries(hM).forEach((e=>{let[t,o]=e;hM[o]=t}));const fM=hM;const gM=function e(t){const o=new dM(t),n=eN(dM.prototype.request,o);return LN.extend(n,dM.prototype,o,{allOwnKeys:!0}),LN.extend(n,o,null,{allOwnKeys:!0}),n.create=function(o){return e(NI(t,o))},n}(dI);gM.Axios=dM,gM.CanceledError=wI,gM.CancelToken=pM,gM.isCancel=bI,gM.VERSION=rM,gM.toFormData=WN,gM.AxiosError=HN,gM.Cancel=gM.CanceledError,gM.all=function(e){return Promise.all(e)},gM.spread=function(e){return function(t){return e.apply(null,t)}},gM.isAxiosError=function(e){return LN.isObject(e)&&!0===e.isAxiosError},gM.mergeConfig=NI,gM.AxiosHeaders=yI,gM.formToJSON=e=>lI(LN.isHTMLForm(e)?new FormData(e):e),gM.getAdapter=tM,gM.HttpStatusCode=fM,gM.default=gM;const mM=gM,yM=()=>{const{id:e}=(0,i.g)(),[o,n]=(0,t.useState)(null),[r,a]=(0,t.useState)([]),[s,l]=(0,t.useState)([]),[c,d]=(0,t.useState)([]),[u,p]=(0,t.useState)(!0),[h,f]=(0,t.useState)(null),[g,m]=(0,t.useState)(null),[y,v]=(0,t.useState)(null),[b,x]=(0,t.useState)(null);(0,t.useEffect)((()=>{e&&w(e)}),[e]);const w=async e=>{p(!0);try{const{data:t,error:o}=await D.supabase.from("contacts").select("*").eq("id",e).single();if(o)throw o;n(t);const{data:r,error:i}=await D.supabase.from("contact_companies").select("companies(id, name, website, description)").eq("contact_id",e);if(i)throw i;a(r.map((e=>e.companies)));const{data:s,error:c}=await D.supabase.from("contact_cities").select("cities(id, name)").eq("contact_id",e);if(c)throw c;l(s.map((e=>e.cities)));const{data:u,error:p}=await D.supabase.from("contact_tags").select("tags(id, name)").eq("contact_id",e);if(p)throw p;d(u.map((e=>e.tags)))}catch(h){console.error("Error fetching contact data:",h),f("Failed to load contact data")}finally{p(!1)}},C=async()=>{try{if(!o.email)throw new Error("Contact has no email to search with");const d={contactEmail:o.email,apiTests:{}},h={Authorization:`Bearer ${"api_iXVeaUbmdKfQZjBrLtgN7MuGRNYwPsWk"}`,"Content-Type":"application/json"};try{var e,t;const o=await mM.get("https://app.picaos.com/api/proxy/hubspot/crm/v3/objects/contacts",{headers:h,params:{limit:5}});console.log("HubSpot contacts response via Pica:",o.data),d.apiTests.contactsList={status:"success",count:(null===(e=o.data.results)||void 0===e?void 0:e.length)||0,sample:(null===(t=o.data.results)||void 0===t?void 0:t[0])||null},d.allContacts=o.data.results||[]}catch(u){var n;console.error("HubSpot contacts endpoint error:",u),d.apiTests.contactsList={status:"error",message:u.message,code:null===(n=u.response)||void 0===n?void 0:n.status}}try{var r,i;const e=await mM.get("https://app.picaos.com/api/proxy/hubspot/crm/v3/objects/companies",{headers:h,params:{limit:5}});console.log("HubSpot companies response via Pica:",e.data),d.apiTests.companiesList={status:"success",count:(null===(r=e.data.results)||void 0===r?void 0:r.length)||0,sample:(null===(i=e.data.results)||void 0===i?void 0:i[0])||null},d.allCompanies=e.data.results||[]}catch(p){var a;console.error("HubSpot companies endpoint error:",p),d.apiTests.companiesList={status:"error",message:p.message,code:null===(a=p.response)||void 0===a?void 0:a.status}}try{var s;const e=await mM.post("https://app.picaos.com/api/proxy/hubspot/crm/v3/objects/contacts/search",{filterGroups:[{filters:[{value:o.email,propertyName:"email",operator:"EQ"}]}],properties:["email","firstname","lastname","jobtitle","company","phone","mobilephone","city","linkedin","website"]},{headers:h});d.apiTests.contactSearch={status:"success",count:(null===(s=e.data.results)||void 0===s?void 0:s.length)||0},e.data.results&&e.data.results.length>0?m({searchResults:e.data.results[0],diagnostics:d}):m({error:"No matching contact found in HubSpot",diagnostics:d})}catch(f){var l,c;console.error("Error searching HubSpot:",f),d.apiTests.contactSearch={status:"error",message:f.message,code:null===(l=f.response)||void 0===l?void 0:l.status,data:null===(c=f.response)||void 0===c?void 0:c.data},m({error:f.message||"Failed to search in HubSpot",diagnostics:d})}}catch(h){var d;console.error("Error accessing HubSpot:",h),m({error:h.message||"Failed to access HubSpot API",diagnostics:{fatalError:h.message,response:null===(d=h.response)||void 0===d?void 0:d.data}})}},_=async()=>{try{console.log("Attempting to enrich contact using Apollo via PicaOS...");const d={Authorization:`Bearer ${"api_iXVeaUbmdKfQZjBrLtgN7MuGRNYwPsWk"}`,"Content-Type":"application/json"};try{const l={api_key:"api_NzVCaFdGMHbfDtJCw9gWZg",first_name:o.first_name,last_name:o.last_name,email:o.email||o.email2||o.email3||null,phone:o.mobile||o.mobile2||null},c=await mM.post("https://app.picaos.com/api/proxy/apollo/v1/people/match",l,{headers:d});if(console.log("Apollo API response via PicaOS:",c.data),c.data.person){var e,t,n,r,i,a,s;const o={message:"Contact successfully enriched via PicaOS",data:{linkedin:(null===(e=c.data.person)||void 0===e?void 0:e.linkedin_url)||null,job_title:(null===(t=c.data.person)||void 0===t?void 0:t.title)||null,about_the_contact:(null===(n=c.data.person)||void 0===n?void 0:n.bio)||null,enrichment_date:(new Date).toISOString(),enrichment_source:"apollo via picaos",city:(null===(r=c.data.person)||void 0===r?void 0:r.city)||null,company:(null===(i=c.data.person)||void 0===i||null===(a=i.organization)||void 0===a?void 0:a.name)||null,tags:(null===(s=c.data.person)||void 0===s?void 0:s.keywords)||[]},rawResponse:c.data};v(o)}else v({error:"No person data returned from Apollo API",response:c.data})}catch(l){console.error("Error calling Apollo API via PicaOS:",l);try{console.log("Falling back to Supabase Edge Function for Apollo enrichment...");const{data:e,error:t}=await D.supabase.functions.invoke("apollo-enrich",{body:{contactId:o.id}});if(t)throw console.error("Supabase function returned error:",t),new Error(`Supabase function error: ${t.message}`);console.log("Apollo enrichment successful via Supabase:",e),v({...e,source:"supabase_edge_function_fallback"})}catch(c){console.error("Both PicaOS and Supabase Edge Functions failed:",c.message),v({error:"All Apollo API enrichment methods failed",picaError:l.message,supabaseError:c.message,diagnostics:{contactId:o.id,email:o.email,supabaseUrl:D.supabase.supabaseUrl}})}}}catch(d){console.error("Unexpected error during Apollo enrichment:",d),v({error:d.message||"Unexpected error during Apollo enrichment",stack:d.stack})}},S=async()=>{const e="appTMYAU4N43eJdxG",t="tblzOon59xoKHt8da",n="viwWxnEEc6dFtffn9",r="tblUx9VGA0rxLmidU",i="viwx7ZW3VoWGHP3yH",a=`https://api.airtable.com/v0/${e}/${t}?view=${n}&maxRecords=100`;try{let h=null;try{console.log("Attempting to call Supabase Edge Function for Airtable enrichment...");const{data:e,error:t}=await D.supabase.functions.invoke("airtable-enrich",{body:{contactId:o.id}});if(t)throw console.error("Airtable enrichment function error:",t),new Error(`Supabase function error: ${t.message}`);console.log("Airtable enrichment successful:",e),h={success:!0,data:e}}catch(u){console.error("Failed to call Airtable enrichment function:",u),h={success:!1,error:u.message,stack:u.stack}}try{const u={Authorization:`Bearer ${"api_iXVeaUbmdKfQZjBrLtgN7MuGRNYwPsWk"}`,"Content-Type":"application/json"},y={Authorization:"Bearer patsAqQtI4eM71EIp.e42097d6cd529026d446be3da1b627c423ed3a5a7b59b0b38a9d77585e0909ea","Content-Type":"application/json"},v=await mM.get("https://app.picaos.com/api/proxy/hubspot/crm/v3/objects/companies",{headers:u,params:{limit:20}});let b={companies:null,contact:null};try{console.log("Attempting to fetch Airtable companies data via PicaOS...");const o=`https://app.picaos.com/api/proxy/airtable/v0/${e}/${t}?view=${n}&cellFormat=json`,r=await mM.get(o,{headers:u});var s;if(200===r.status)b.companies=r.data,console.log(`Successfully retrieved ${(null===(s=r.data.records)||void 0===s?void 0:s.length)||0} companies from Airtable via PicaOS`);else console.error("Companies request failed:",r.status),b.companies={error:`Airtable API error via PicaOS: ${r.status}`,details:r.data}}catch(p){console.error("Failed to fetch companies from Airtable via PicaOS:",p);try{console.log("Falling back to direct Airtable API call...");const o=await fetch(`https://api.airtable.com/v0/${e}/${t}?view=${n}&cellFormat=json`,{method:"GET",headers:y});if(o.ok){var l;const e=await o.json();b.companies=e,console.log(`Successfully retrieved ${(null===(l=e.records)||void 0===l?void 0:l.length)||0} companies from Airtable directly`)}else b.companies={error:`Direct Airtable API error: ${o.status}`,details:await o.text()}}catch(f){b.companies={error:"Both PicaOS and direct Airtable requests failed",picaError:p.message,directError:f.message}}}if(o.email)try{console.log("Attempting to find contact in Airtable by email via PicaOS...");const n=`https://app.picaos.com/api/proxy/airtable/v0/${e}/${r}?view=${i}&filterByFormula=${encodeURIComponent(`{Primary email}="${o.email}"`)}&cellFormat=json`,a=await mM.get(n,{headers:u});if(200===a.status)if(a.data.records&&a.data.records.length>0){if(b.contact=a.data.records[0],console.log("Successfully found contact in Airtable via PicaOS:",b.contact.id),b.contact.fields&&b.contact.fields.Company)try{const o=b.contact.fields.Company;if("string"===typeof o&&o.startsWith("rec")){console.log("Fetching linked company details via PicaOS:",o);const n=`https://app.picaos.com/api/proxy/airtable/v0/${e}/${t}/${o}?cellFormat=json`,r=await mM.get(n,{headers:u});var c,d;if(200===r.status)b.contactCompany=r.data,console.log("Successfully retrieved linked company via PicaOS:",null===(c=r.data)||void 0===c||null===(d=c.fields)||void 0===d?void 0:d.Name)}}catch(g){console.error("Failed to fetch linked company via PicaOS:",g),b.contactCompanyError=g.message}}else console.log("No matching contact found in Airtable via PicaOS"),b.contact={error:"No matching contact found"};else console.error("Contact search request failed via PicaOS:",a.status),b.contact={error:`Airtable API error via PicaOS: ${a.status}`,details:a.data}}catch(m){console.error("Failed to search for contact in Airtable via PicaOS:",m);try{console.log("Falling back to direct Airtable API for contact search...");const t=encodeURIComponent(`{Primary email}="${o.email}"`),n=await fetch(`https://api.airtable.com/v0/${e}/${r}?view=${i}&filterByFormula=${t}&cellFormat=json`,{method:"GET",headers:y});if(n.ok){const e=await n.json();e.records&&e.records.length>0&&(b.contact=e.records[0],console.log("Successfully found contact in Airtable directly:",b.contact.id))}else b.contact={error:"Both PicaOS and direct Airtable contact searches failed",picaError:m.message,directError:await n.text()}}catch(f){b.contact={error:"Both PicaOS and direct Airtable contact searches failed",picaError:m.message,directError:f.message}}}else b.contact={error:"No email provided to search with"};x({supabaseFunction:h,companiesDataFromHubspot:v.data,airtable:b,airtableConfig:{baseId:e,companiesTableId:t,companiesViewId:n,contactsTableId:r,contactsViewId:i,url:a}})}catch(p){console.error("Error fetching companies from Airtable:",p),x({supabaseFunction:h,companiesError:p.message||"Failed to fetch companies data",airtableConfig:{baseId:e,companiesTableId:t,companiesViewId:n,contactsTableId:r,contactsViewId:i,url:a}})}}catch(h){console.error("Error enriching from Airtable:",h),x({error:h.message||"Failed to enrich from Airtable"})}};return u?(0,N.jsx)("div",{style:{padding:"20px"},children:(0,N.jsx)("p",{style:{color:"black"},children:"Loading contact information..."})}):h?(0,N.jsx)("div",{style:{padding:"20px"},children:(0,N.jsx)("p",{style:{color:"red"},children:h})}):o?(0,N.jsxs)("div",{style:{padding:"20px",fontFamily:"monospace",color:"black",backgroundColor:"white",minHeight:"100vh"},children:[(0,N.jsxs)("h1",{style:{margin:"0 0 20px 0",color:"black"},children:["Contact Data: ",o.first_name," ",o.last_name]}),(0,N.jsxs)("div",{style:{marginBottom:"20px"},children:[(0,N.jsx)("button",{onClick:async()=>{await Promise.all([C(),_(),S()])},style:{padding:"10px 15px",marginRight:"10px",background:"black",color:"white",border:"none",cursor:"pointer"},children:"Enrich from All Sources"}),(0,N.jsx)("button",{onClick:C,style:{padding:"10px 15px",marginRight:"10px",background:"white",color:"black",border:"1px solid black",cursor:"pointer"},children:"HubSpot Only"}),(0,N.jsx)("button",{onClick:_,style:{padding:"10px 15px",marginRight:"10px",background:"white",color:"black",border:"1px solid black",cursor:"pointer"},children:"Apollo Only"}),(0,N.jsx)("button",{onClick:S,style:{padding:"10px 15px",background:"white",color:"black",border:"1px solid black",cursor:"pointer"},children:"Airtable Only"})]}),(0,N.jsxs)("div",{style:{border:"1px solid black",padding:"15px"},children:[(0,N.jsx)("h2",{style:{margin:"0 0 15px 0",borderBottom:"1px solid black",paddingBottom:"5px",color:"black"},children:"All Data"}),(0,N.jsx)("h3",{style:{color:"black"},children:"Contact Information"}),(0,N.jsx)("pre",{style:{background:"#f5f5f5",padding:"10px",overflow:"auto",color:"black"},children:JSON.stringify(o,null,2)}),(0,N.jsx)("h3",{style:{color:"black"},children:"Companies"}),(0,N.jsx)("pre",{style:{background:"#f5f5f5",padding:"10px",overflow:"auto",color:"black"},children:JSON.stringify(r,null,2)}),(0,N.jsx)("h3",{style:{color:"black"},children:"Cities"}),(0,N.jsx)("pre",{style:{background:"#f5f5f5",padding:"10px",overflow:"auto",color:"black"},children:JSON.stringify(s,null,2)}),(0,N.jsx)("h3",{style:{color:"black"},children:"Tags"}),(0,N.jsx)("pre",{style:{background:"#f5f5f5",padding:"10px",overflow:"auto",color:"black"},children:JSON.stringify(c,null,2)}),(0,N.jsx)("h3",{style:{color:"black"},children:"HubSpot Data"}),g?(0,N.jsx)("pre",{style:{background:"#f5f5f5",padding:"10px",overflow:"auto",color:"black"},children:JSON.stringify(g,null,2)}):(0,N.jsx)("p",{style:{color:"black"},children:"No HubSpot data - click button to fetch"}),(0,N.jsx)("h3",{style:{color:"black"},children:"Apollo Data"}),y?(0,N.jsx)("pre",{style:{background:"#f5f5f5",padding:"10px",overflow:"auto",color:"black"},children:JSON.stringify(y,null,2)}):(0,N.jsx)("p",{style:{color:"black"},children:"No Apollo data - click button to fetch"}),(0,N.jsx)("h3",{style:{color:"black"},children:"Airtable Data"}),b?(0,N.jsx)("pre",{style:{background:"#f5f5f5",padding:"10px",overflow:"auto",color:"black"},children:JSON.stringify(b,null,2)}):(0,N.jsx)("p",{style:{color:"black"},children:"No Airtable data - click button to fetch"})]})]}):(0,N.jsx)("div",{style:{padding:"20px"},children:(0,N.jsx)("p",{style:{color:"black"},children:"Contact not found"})})},vM=()=>{const[e,o]=(0,t.useState)(!1),[n,r]=(0,t.useState)(null),[i,a]=(0,t.useState)(null),[s,l]=(0,t.useState)(10),[c,d]=(0,t.useState)(0),[u,p]=(0,t.useState)(""),[h,f]=(0,t.useState)(null),[g,m]=(0,t.useState)(0),[y,v]=(0,t.useState)(0),[b,x]=(0,t.useState)([]),[w,C]=(0,t.useState)(!1);(0,t.useEffect)((()=>{const e=localStorage.getItem("hubspot_migration_key");e&&p(e)}),[]),(0,t.useEffect)((()=>{u&&localStorage.setItem("hubspot_migration_key",u)}),[u]);const _=async()=>{o(!0),r(null),a(null);try{console.log("Attempting migration with secret key:",u),console.log("Using limit:",s,"and offset:",c);try{const e=await mM.post("/.netlify/functions/companies-hubspot-supabase-migration",{limit:s,offset:c,scheduled:w},{headers:{Authorization:`Bearer ${u}`,"Content-Type":"application/json"}});r(e.data),e.data.stats&&(m((t=>t+e.data.stats.processed)),v((t=>t+e.data.stats.enriched))),x((t=>[{timestamp:(new Date).toISOString(),offset:c,limit:s,stats:e.data.stats,success:!0},...t.slice(0,9)])),e.data.remaining>0&&d(e.data.next_offset)}catch(p){var e,t,n,i;console.error("Error with function call:",p),console.log("Response error:",null===(e=p.response)||void 0===e?void 0:e.data),x((e=>{var t;return[{timestamp:(new Date).toISOString(),offset:c,limit:s,error:(null===(t=p.response)||void 0===t?void 0:t.data)||p.message,success:!1},...e.slice(0,9)]})),a({message:"Function request failed",status:null===(t=p.response)||void 0===t?void 0:t.status,statusText:null===(n=p.response)||void 0===n?void 0:n.statusText,data:null===(i=p.response)||void 0===i?void 0:i.data,originalError:p.message,path:"/.netlify/functions/companies-hubspot-supabase-migration"})}}catch(h){var l;console.error("Error running HubSpot migration:",h),a((null===(l=h.response)||void 0===l?void 0:l.data)||h.message)}finally{o(!1)}};return(0,N.jsxs)("div",{style:{padding:"20px",maxWidth:"900px",margin:"0 auto"},children:[(0,N.jsx)("h1",{children:"HubSpot Companies Migration Tool"}),(0,N.jsx)("p",{children:"Use this tool to enrich Supabase companies with data from HubSpot."}),(0,N.jsxs)("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:"20px",marginBottom:"20px"},children:[(0,N.jsxs)("div",{children:[(0,N.jsxs)("div",{style:{padding:"15px",backgroundColor:"#f8f9fa",borderRadius:"8px",border:"1px solid #dee2e6",marginBottom:"20px"},children:[(0,N.jsx)("h3",{style:{marginTop:0},children:"Configuration"}),(0,N.jsx)("div",{style:{marginBottom:"15px"},children:(0,N.jsxs)("label",{style:{display:"block",marginBottom:"5px",fontWeight:"bold"},children:["Secret Key:",(0,N.jsx)("input",{type:"password",value:u,onChange:e=>p(e.target.value),style:{width:"100%",padding:"8px",borderRadius:"4px",border:"1px solid #ccc",marginTop:"5px"},placeholder:"Enter your migration secret key"})]})}),(0,N.jsxs)("div",{style:{display:"flex",gap:"15px",marginBottom:"15px"},children:[(0,N.jsxs)("label",{style:{fontWeight:"bold"},children:["Batch Size:",(0,N.jsx)("input",{type:"number",value:s,onChange:e=>l(parseInt(e.target.value)||10),style:{width:"70px",padding:"8px",borderRadius:"4px",border:"1px solid #ccc",marginLeft:"8px"},min:"1",max:"100"})]}),(0,N.jsxs)("label",{style:{fontWeight:"bold"},children:["Offset:",(0,N.jsx)("input",{type:"number",value:c,onChange:e=>d(parseInt(e.target.value)||0),style:{width:"90px",padding:"8px",borderRadius:"4px",border:"1px solid #ccc",marginLeft:"8px"},min:"0"})]})]}),(0,N.jsx)("div",{style:{marginBottom:"15px"},children:(0,N.jsxs)("label",{style:{display:"flex",alignItems:"center"},children:[(0,N.jsx)("input",{type:"checkbox",checked:w,onChange:e=>C(e.target.checked),style:{marginRight:"8px"}}),"Mark as scheduled run (for logging purposes)"]})}),(0,N.jsxs)("div",{style:{display:"flex",gap:"10px"},children:[(0,N.jsx)("button",{onClick:_,disabled:e||!u,style:{padding:"10px 15px",backgroundColor:"#0070f3",color:"white",border:"none",borderRadius:"4px",cursor:e||!u?"not-allowed":"pointer",flex:"1"},children:e?"Running Migration...":"Run Migration"}),(0,N.jsx)("button",{onClick:async()=>{try{const e=await mM.post("/.netlify/functions/companies-hubspot-supabase-migration",{limit:1,offset:0,check_environment:!0},{headers:{Authorization:`Bearer ${u}`,"Content-Type":"application/json"}});f(e.data.env_vars_set||{status:"Unknown",message:"Could not determine environment variables status"})}catch(o){var e,t;console.error("Error checking environment:",o),f({status:"Error",message:(null===(e=o.response)||void 0===e||null===(t=e.data)||void 0===t?void 0:t.env_vars_set)||"Failed to check environment variables"})}},disabled:e||!u,style:{padding:"10px 15px",backgroundColor:"#6c757d",color:"white",border:"none",borderRadius:"4px",cursor:e||!u?"not-allowed":"pointer"},children:"Check Env"})]})]}),(0,N.jsxs)("div",{style:{padding:"15px",backgroundColor:"#f8f9fa",borderRadius:"8px",border:"1px solid #dee2e6"},children:[(0,N.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"10px"},children:[(0,N.jsx)("h3",{style:{margin:0},children:"Session Statistics"}),(0,N.jsx)("button",{onClick:()=>{m(0),v(0),x([])},style:{padding:"6px 12px",backgroundColor:"#6c757d",color:"white",border:"none",borderRadius:"4px",fontSize:"0.8rem"},children:"Reset"})]}),(0,N.jsxs)("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:"10px",marginBottom:"15px"},children:[(0,N.jsxs)("div",{style:{padding:"10px",backgroundColor:"#e2e3e5",borderRadius:"4px",textAlign:"center"},children:[(0,N.jsx)("div",{style:{fontSize:"0.9rem",fontWeight:"bold",color:"#495057"},children:"Total Processed"}),(0,N.jsx)("div",{style:{fontSize:"1.5rem",fontWeight:"bold",color:"#212529"},children:g})]}),(0,N.jsxs)("div",{style:{padding:"10px",backgroundColor:"#d1e7dd",borderRadius:"4px",textAlign:"center"},children:[(0,N.jsx)("div",{style:{fontSize:"0.9rem",fontWeight:"bold",color:"#0f5132"},children:"Total Enriched"}),(0,N.jsx)("div",{style:{fontSize:"1.5rem",fontWeight:"bold",color:"#0f5132"},children:y})]})]}),(0,N.jsx)("h4",{style:{marginBottom:"10px",borderBottom:"1px solid #dee2e6",paddingBottom:"5px"},children:"Run History"}),(0,N.jsx)("div",{style:{maxHeight:"200px",overflowY:"auto"},children:0===b.length?(0,N.jsx)("p",{style:{color:"#6c757d",textAlign:"center",fontStyle:"italic"},children:"No history yet"}):(0,N.jsx)("ul",{style:{listStyleType:"none",padding:0,margin:0},children:b.map(((e,t)=>(0,N.jsx)("li",{style:{padding:"8px",backgroundColor:e.success?"#f8f9fa":"#f8d7da",borderRadius:"4px",marginBottom:"5px",fontSize:"0.9rem"},children:(0,N.jsxs)("div",{style:{display:"flex",justifyContent:"space-between"},children:[(0,N.jsx)("span",{children:new Date(e.timestamp).toLocaleTimeString()}),(0,N.jsx)("span",{style:{fontWeight:"bold",color:e.success?"#0f5132":"#842029"},children:e.success?`Processed: ${e.stats.processed}, Enriched: ${e.stats.enriched}`:"Failed"})]})},t)))})})]})]}),(0,N.jsxs)("div",{children:[h&&(0,N.jsxs)("div",{style:{backgroundColor:"#cff4fc",color:"#055160",padding:"15px",borderRadius:"8px",marginBottom:"20px",border:"1px solid #b6effb"},children:[(0,N.jsx)("h3",{style:{marginTop:0},children:"Environment Variables Status"}),(0,N.jsx)("pre",{style:{whiteSpace:"pre-wrap",fontSize:"0.9rem"},children:JSON.stringify(h,null,2)})]}),i&&(0,N.jsxs)("div",{style:{backgroundColor:"#f8d7da",color:"#721c24",padding:"15px",borderRadius:"8px",marginBottom:"20px",border:"1px solid #f5c2c7"},children:[(0,N.jsx)("h3",{style:{marginTop:0},children:"Error:"}),(0,N.jsx)("pre",{style:{whiteSpace:"pre-wrap",fontSize:"0.9rem"},children:JSON.stringify(i,null,2)})]}),n&&(0,N.jsxs)("div",{style:{backgroundColor:"#d4edda",color:"#155724",padding:"15px",borderRadius:"8px",border:"1px solid #c3e6cb"},children:[(0,N.jsx)("h3",{style:{marginTop:0,borderBottom:"1px solid #c3e6cb",paddingBottom:"8px"},children:"Migration Results"}),(0,N.jsxs)("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:"10px",marginBottom:"15px"},children:[(0,N.jsxs)("div",{children:[(0,N.jsxs)("p",{children:[(0,N.jsx)("strong",{children:"Message:"})," ",n.message]}),(0,N.jsxs)("p",{children:[(0,N.jsx)("strong",{children:"Timestamp:"})," ",new Date(n.timestamp).toLocaleString()]})]}),(0,N.jsxs)("div",{children:[(0,N.jsxs)("p",{children:[(0,N.jsx)("strong",{children:"Next Offset:"})," ",n.next_offset]}),(0,N.jsxs)("p",{children:[(0,N.jsx)("strong",{children:"Remaining:"})," ",n.remaining," of ",n.total_count]})]})]}),(0,N.jsxs)("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr 1fr 1fr",gap:"10px",marginBottom:"15px"},children:[(0,N.jsxs)("div",{style:{padding:"10px",backgroundColor:"#e2e3e5",borderRadius:"4px",textAlign:"center"},children:[(0,N.jsx)("div",{style:{fontSize:"0.8rem",fontWeight:"bold",color:"#495057"},children:"Processed"}),(0,N.jsx)("div",{style:{fontSize:"1.2rem",fontWeight:"bold",color:"#212529"},children:n.stats.processed})]}),(0,N.jsxs)("div",{style:{padding:"10px",backgroundColor:"#d1e7dd",borderRadius:"4px",textAlign:"center"},children:[(0,N.jsx)("div",{style:{fontSize:"0.8rem",fontWeight:"bold",color:"#0f5132"},children:"Enriched"}),(0,N.jsx)("div",{style:{fontSize:"1.2rem",fontWeight:"bold",color:"#0f5132"},children:n.stats.enriched})]}),(0,N.jsxs)("div",{style:{padding:"10px",backgroundColor:"#fff3cd",borderRadius:"4px",textAlign:"center"},children:[(0,N.jsx)("div",{style:{fontSize:"0.8rem",fontWeight:"bold",color:"#664d03"},children:"Skipped"}),(0,N.jsx)("div",{style:{fontSize:"1.2rem",fontWeight:"bold",color:"#664d03"},children:n.stats.skipped})]}),(0,N.jsxs)("div",{style:{padding:"10px",backgroundColor:n.stats.errors>0?"#f8d7da":"#e2e3e5",borderRadius:"4px",textAlign:"center"},children:[(0,N.jsx)("div",{style:{fontSize:"0.8rem",fontWeight:"bold",color:n.stats.errors>0?"#842029":"#495057"},children:"Errors"}),(0,N.jsx)("div",{style:{fontSize:"1.2rem",fontWeight:"bold",color:n.stats.errors>0?"#842029":"#212529"},children:n.stats.errors})]})]}),(0,N.jsxs)("div",{children:[(0,N.jsx)("h4",{style:{marginBottom:"10px"},children:"Details:"}),(0,N.jsx)("div",{style:{maxHeight:"300px",overflow:"auto",border:"1px solid #c3e6cb",borderRadius:"4px",padding:"10px",backgroundColor:"#f8f9fa"},children:(0,N.jsx)("pre",{style:{whiteSpace:"pre-wrap",fontSize:"0.85rem"},children:JSON.stringify(n.details,null,2)})})]}),n.remaining>0&&(0,N.jsx)("div",{style:{marginTop:"15px",textAlign:"center"},children:(0,N.jsxs)("button",{onClick:_,disabled:e,style:{padding:"10px 20px",backgroundColor:"#28a745",color:"white",border:"none",borderRadius:"4px",cursor:e?"not-allowed":"pointer",fontWeight:"bold"},children:["Process Next Batch (",n.remaining," remaining)"]})})]})]})]})]})},bM=()=>{const[e,o]=(0,t.useState)(!1),[n,r]=(0,t.useState)(null),[i,a]=(0,t.useState)(null);return(0,N.jsxs)("div",{style:{padding:"20px",maxWidth:"800px",margin:"0 auto"},children:[(0,N.jsx)("h1",{children:"HubSpot API Test"}),(0,N.jsxs)("div",{style:{marginBottom:"20px"},children:[(0,N.jsx)("button",{onClick:async()=>{o(!0),r(null),a(null);try{const e=await mM.get("/.netlify/functions/test-hubspot");r(e.data)}catch(t){var e;console.error("Error testing HubSpot:",t),a((null===(e=t.response)||void 0===e?void 0:e.data)||t.message)}finally{o(!1)}},disabled:e,style:{padding:"10px 15px",marginRight:"10px",backgroundColor:"#0070f3",color:"white",border:"none",borderRadius:"4px",cursor:e?"not-allowed":"pointer"},children:"Test Direct Function"}),(0,N.jsx)("button",{onClick:async()=>{o(!0),r(null),a(null);try{const e=await mM.get("/.netlify/functions/hubspot-proxy/crm/v3/objects/contacts",{params:{limit:1}});r(e.data)}catch(t){var e;console.error("Error testing HubSpot proxy:",t),a((null===(e=t.response)||void 0===e?void 0:e.data)||t.message)}finally{o(!1)}},disabled:e,style:{padding:"10px 15px",backgroundColor:"#28a745",color:"white",border:"none",borderRadius:"4px",cursor:e?"not-allowed":"pointer"},children:"Test Proxy Function"})]}),e&&(0,N.jsx)("p",{children:"Loading..."}),i&&(0,N.jsxs)("div",{style:{backgroundColor:"#f8d7da",color:"#721c24",padding:"15px",borderRadius:"4px",marginBottom:"20px"},children:[(0,N.jsx)("h3",{children:"Error:"}),(0,N.jsx)("pre",{style:{whiteSpace:"pre-wrap"},children:JSON.stringify(i,null,2)})]}),n&&(0,N.jsxs)("div",{style:{backgroundColor:"#d4edda",color:"#155724",padding:"15px",borderRadius:"4px"},children:[(0,N.jsx)("h3",{children:"Success:"}),(0,N.jsx)("pre",{style:{whiteSpace:"pre-wrap"},children:JSON.stringify(n,null,2)})]})]})},xM=()=>(0,N.jsx)(fe,{children:(0,N.jsx)(i.sv,{})}),wM=()=>{const[e,o]=(0,t.useState)(null),[n,r]=(0,t.useState)(!0);if((0,t.useEffect)((()=>{const{data:{subscription:e}}=D.supabase.auth.onAuthStateChange(((e,t)=>{o(t),r(!1)}));return D.supabase.auth.getSession().then((e=>{let{data:{session:t}}=e;o(t),r(!1)})),()=>e.unsubscribe()}),[]),n)return(0,N.jsx)("div",{children:"Loading..."});const a=t=>{let{children:o}=t;return e?o:(0,N.jsx)(i.C5,{to:"/login"})},s=()=>e?(0,N.jsx)(i.C5,{to:"/"}):(0,N.jsx)(z,{}),d=(u=[{path:"/login",element:(0,N.jsx)(s,{})},{path:"/",element:(0,N.jsx)(a,{children:(0,N.jsx)(xM,{})}),children:[{path:"/",element:(0,N.jsx)(i.C5,{to:"/contacts"})},{path:"dashboard",element:(0,N.jsx)(ym,{})},{path:"new-contacts",element:(0,N.jsx)(vm,{})},{path:"contacts",element:(0,N.jsx)(i.C5,{to:"/contacts/interactions"})},{path:"contacts/simple",element:(0,N.jsx)(CC,{})},{path:"contacts/last-interactions",element:(0,N.jsx)(Zm,{})},{path:"contacts/keep-in-touch",element:(0,N.jsx)(_C.default,{})},{path:"contacts/introductions",element:(0,N.jsx)(Mw,{})},{path:"contacts/lists",element:(0,N.jsx)(Vw,{})},{path:"contacts/email-inbox",element:(0,N.jsx)(SC.default,{})},{path:"contacts/inbox",element:(0,N.jsx)(EC.default,{})},{path:"contacts/interactions",element:(0,N.jsx)(yS,{})},{path:"contacts/:id",element:(0,N.jsx)(xk,{})},{path:"contacts/edit/:id",element:(0,N.jsx)(Tk,{})},{path:"contacts/integrity/:id",element:(0,N.jsx)(lj,{})},{path:"contacts/workflow/:id",element:(0,N.jsx)(wR,{})},{path:"contacts/duplicate-manager",element:(0,N.jsx)(cj.default,{})},{path:"contacts/keep-in-touch-inbox",element:(0,N.jsx)(kC.default,{})},{path:"companies",element:(0,N.jsx)(AO,{})},{path:"companies/:id",element:(0,N.jsx)(hT,{})},{path:"companies/deals",element:(0,N.jsx)(jD,{})},{path:"companies/startups",element:(0,N.jsx)(OD,{})},{path:"companies/investors",element:(0,N.jsx)(PD,{})},{path:"planner",element:(0,N.jsx)(ZP,{})},{path:"inbox",element:(0,N.jsx)(Dm,{})},{path:"admin/hubspot-migration",element:(0,N.jsx)(vM,{})},{path:"admin/hubspot-test",element:(0,N.jsx)(bM,{})},{path:"admin/contact-enrichment",element:(0,N.jsx)(yM,{})}]},{path:"*",element:(0,N.jsx)(i.C5,{to:"/login"})}],p={future:{v7_startTransition:!0,v7_relativeSplatPath:!0}},(0,l.aE)({basename:null==p?void 0:p.basename,future:c({},null==p?void 0:p.future,{v7_prependBasename:!0}),history:(0,l.zR)({window:null==p?void 0:p.window}),hydrationData:(null==p?void 0:p.hydrationData)||h(),routes:u,mapRouteProperties:i.wE,dataStrategy:null==p?void 0:p.dataStrategy,patchRoutesOnNavigation:null==p?void 0:p.patchRoutesOnNavigation,window:null==p?void 0:p.window}).initialize());var u,p;return(0,N.jsxs)(N.Fragment,{children:[(0,N.jsx)(nt.l$,{position:"top-right",toastOptions:{style:{background:"#333",color:"#fff",borderRadius:"4px"},success:{duration:3e3,style:{background:"#000",color:"#00ff00",border:"1px solid #00ff00"}},error:{duration:4e3,style:{background:"#000",color:"#ff0000",border:"1px solid #ff0000"}}}}),(0,N.jsx)(Pm.N9,{theme:"dark"}),(0,N.jsx)(w,{router:d})]})},CM=(0,t.createContext)(),_M=e=>{let{children:o}=e;const[n,r]=(0,t.useState)(null),[i,a]=(0,t.useState)(!0);return(0,t.useEffect)((()=>{const{data:e}=D.supabase.auth.onAuthStateChange(((e,t)=>{r((null===t||void 0===t?void 0:t.user)||null),a(!1)}));return D.supabase.auth.getSession().then((e=>{let{data:{session:t}}=e;r((null===t||void 0===t?void 0:t.user)||null),a(!1)})),()=>{var t;null===e||void 0===e||null===(t=e.subscription)||void 0===t||t.unsubscribe()}}),[]),(0,N.jsx)(CM.Provider,{value:{user:n,loading:i},children:o})};(0,r.H)(document.getElementById("root")).render((0,N.jsx)(t.StrictMode,{children:(0,N.jsx)(_M,{children:(0,N.jsx)(wM,{})})}))})()})();
//# sourceMappingURL=main.b48588c5.js.map